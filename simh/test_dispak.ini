! rm -f log.txt
set console log=log.txt
set console debug=log
;set cpu debug
;set mmu debug
set drum debug

;
; Приводим барабаны в исходное состояние
;
! rm -f drum1x.bin
! cp drum20.bin drum2x.bin
attach drum0 drum1x.bin
attach drum1 drum2x.bin

;
; Запуск ОС ДИСПАК.
;
d 1 уиа -5(1), сч 7	; цикл на 6 страниц, на сумматоре слово обмена
d 2 увв 2, уиа 60000(2)
d 3 уи, цикл 3(2)	; цикл задержки
d 4 слц 6, цикл 2(1)	; увеличиваем номера зоны и страницы
d 5 стоп 1, пб 5	; готово, останов

d 6 0001 0004		; приращение для номеров зоны и страницы

; Постраничное чтение 0-го барабана.
; Начиная с 032-й зоны в 1-ю страницу.
d 7 01410150		; управляющее слово обмена

go 1

; Использование клавиатуры пульта БРУС при вызове ОС ДИСПАК.
;
; ТР1: 44, 43, 35 и 1-й разряды  = '1';
; 444 444 444 333  333 333 322 222  222	221 111	111  111
; 876 543 210 987  654 321 098 765  432	109 876 543  210 987 654 321
; 000 011 000 000  010 000 000 000  000 000 000 000  000 000 000 001
;  0   3   0   0    2	0   0	0    0	 0   0	 0    0	  0   0	  1
d 1 0300 2000 0000 0001

; ТР2: 32, 31, 26 и 25-й разряды = '1' - при работе с ,
; либо - 33 и 27-й разряды = '1' - при работе с ЭНМД-4;
; 444 444 444 333  333 333 322 222  222	221 111	111  111
; 876 543 210 987  654 321 098 765  432	109 876 543  210 987 654 321
; 000 000 000 000  000 011 000 011  000 000 000 000  000 000 000 000  ЭНМД-3
;                       3   0   3
; 000 000 000 000  000 100 000 100  000 000 000 000  000 000 000 000  ЭНМД-4
;                       4   0   4
d 2 0000 0303 0000 0000

; ТРЗ: 24  ÷ 17 и 4-й разряды = '1' - для чистки каталогов ОС;
; 444 444 444 333  333 333 322 222  222	221 111	111  111
; 876 543 210 987  654 321 098 765  432	109 876 543  210 987 654 321
; 000 000 000 000  000 000 000 000  111 111 110 000  000 000 001 000
;                                    7   7   6   0    0   0   1   0
d 3 7760 0010

; ТР7: 19, 18, 13, 7, 6 и 4-й разряды = '1' - 32-й тракт МБ 2.0 .
; 444 444 444 333  333 333 322 222  222	221 111	111  111
; 876 543 210 987  654 321 098 765  432	109 876 543  210 987 654 321
; 000 000 000 000  000 000 000 000  000 001 100 001  000 001 101 000
;                                    0   1   4   1    0   1   5   0

set disk debug
run 1

;br 4
;s 4000000
;! sleep 1

;dump mb20-z21.b6
;ex -x 76000-77777
;quit
