*^
*^
**********************************************^
*                                            *^
*    Д И А Л О Г О В А Я    С И С Т Е М А    *^
*                К  Р  А  Б                  *^
*                                            *^
*--------------------------------------------*^
*  ПРОГРАММА Ф2. ЧАСТЬ 2                     *^
*  РЕДАКТОР ТЕКСТОВ                          *^
**********************************************^
*^
*^
*^
*^
*^
*^
*  О Б Щ И Е   Б Л О К И   Р Е Д А К Т О Р А  *^
*                                             *^
***********************************************^
*^
*^
*^
*^
*^
*  БЛОК ВЫБОРА СИМВОЛА^
*  (УСКОРЕННЫЙ ВАРИАНТ)^
*----------------------^
*^
ВСБ НОП^
 ВХОДН ВСБ^
*^
*  ВХОДНЫЕ ЗНАЧЕНИЯ:^
*    М3  - АДРЕС СЛОВА^
*    М10 - НОМЕР БАЙТА^
*  ВЫХОДНЫЕ ЗНАЧЕНИЯ:^
*    СМ  - БЫБРАННЫЙ СИМВОЛ^
*  ВЫХОД ПО М15^
*^
 СЧ (М3)^
 СБР П377(М10)^
 МОДА (М15)^
 ЦИКЛ (М10)^
 СЛИА 1(М3)^
 УИА -5(М10)^
 ПБ (М15)^
*^
*  БЛОК ЗАПИСИ СИМВОЛА^
*  (УСКОРЕННЫЙ ВАРИАНТ)^
*----------------------^
*^
ЗСБ НОП^
 ВХОДН ЗСБ^
*^
*  ВХОДНЫЕ ЗНАЧЕНИЯ:^
*    СМ  - ЗАПИСЫВАЕМЫЙ БАЙТ^
*    М1  - АДРЕС СЛОВА^
*    М4  - НОМЕР БАЙТА^
*  ВЫХОД ПО М15^
*^
 РЗБ П377(М4)^
 ЗП РЯ1^
 СЧ (М1)^
 ИЛИ П377(М4)^
 НТЖ П377(М4)^
 ИЛИ РЯ1^
 ЗП (М1)^
 СЛИА -1(М11)^
 МОДА (М15)^
 ЦИКЛ (М4)^
 СЛИА 1(М1)^
 УИА -5(М4)^
 ПБ (М15)^
*^
* БЛОК ВЫБОРА ДИАПАЗОНА^
*----------------------^
*^
ВЫБZДП НОП^
 ВХОДН ВЫБZДП^
*^
*  ВЫХОДНЫЕ ЗНАЧЕНИЯ:^
*    НАЧАЛО - НОМЕР (8) НАЧ. КАРТЫ^
*    КОНЕЦ  - НОМЕР (8) КОН. КАРТЫ^
*    М5     - СПОСОБ ФОРМИРОВАНИЯ ДИАПАЗОНА^
*             0 - ДЛЯ ДИР-ВЫ ТИПА <ВЫД>^
*             1 - ДЛЯ ДИР-ВЫ ТИПА <ЗАМ>^
*  ВЫХОД М6^
*^
 СЧ Е1^
 ЗП НАЧАЛО^
 СЧ П77777^
 ЗП КОНЕЦ^
*^
 СЧ СИ^
 НТЖ П377^
 ПЕ ВЫБДП1 НЕ КОНЕЦ ТЕКСТА^
 ПИНО ОШДИАП(М5)^
 ПБ (М6)^
*^
* ВЫБОР ПЕРВОГО ПАРАМЕТРА^
ВЫБДП1 НОП^
 СЧ СИ^
 ВЧОБ П11^
 ПЕ ОШДИАП НЕ ЦИФРА^
 ПВ ВЫБZ10(М16)^
 ПВ ИЗ10В8(М17)^
 СЛЦ СМЕЩ(М2)^
 И П17777^
 ЗП НАЧАЛО^
 ПО ОШДИАП НАЧАЛО = 0^
 СЧ СИ1^
 ЗП РЯ5 РАЗДЕЛИТЕЛЬ^
*^
 СЧ СИ^
 НТЖ П377^
 ПЕ ВЫБДП2 НЕ КОНЕЦ ТЕКСТА^
 СЧ НАЧАЛО^
 ЗП КОНЕЦ^
 МОДА (М6)^
 ПИНО (М5) ВЫХОД^
 СЧ П77777^
 ЗП КОНЕЦ^
 ПБ (М6)^
*^
* ВЫБОР ВТОРОГО ПАРАМЕТРА^
ВЫБДП2 НОП^
 СЧ СИ^
 ВЧОБ П11^
 ПЕ ОШДИАП НЕ ЦИФРА^
 ПВ ВЫБZ10(М16)^
 ПВ ИЗ10В8(М17)^
 ЗП РЯ1^
 СЧ РЯ5^
 НТЖ П37^
 ПО ВЫБДП3 РАЗДЕЛИТЕЛЬ - ДВОЕТОЧИЕ^
 СЧ РЯ1^
 СЛЦ СМЕЩ(М2)^
 И П17777^
 ЗП КОНЕЦ^
 ВЧ НАЧАЛО^
 ПЕ ОШДИАП КОНЕЦ < НАЧАЛО^
 ПБ (М6)^
ВЫБДП3 НОП^
 СЧ РЯ1^
 ПО ОШДИАП ВТОРОЙ ПАРАМЕТР = 0^
 СЛЦ НАЧАЛО^
 ВЧ Е1^
 ЗП КОНЕЦ^
 ПБ (М6)^
*^
* БЛОК ПРИВЕДЕНИЯ ТЕКСТА К КАНОНИЧЕСКОМУ ВИДУ^
*--------------------------------------------^
*^
ФТЕКГР НОП ГРУППОВОЙ РЕЖИМ^
*^
*  ВЫХОДНЫЕ ЗНАЧЕНИЯ:^
*^
*  ПОЛНОМ:                        РАБПОЛ:^
*  .                   .          .                .^
*  ---------------------          .                .^
*  I NСТР I ДЛ I АДРЕС I-----     .                .^
*  ---------------------    I     .                .^
*  I       0           I    I     .                .^
*  ---------------------    I     ------------------^
*  .                   .    ----> I      ТЕКСТ     I^
*  ---------------------          .                .^
*  I 7 7 7 - КОНЕЦ     I          .                .^
*  ---------------------          ------------------^
*^
 УИА ПОЛНОМ(М7) ГРУППОВОЙ РЕЖИМ^
 УИА -5(М4)^
 УИА РАБПОЛ(М1)^
 СЧ 0^
 ЗП РЯ4^
 СЧ ВСЕЕД^
 ЗП ПОЛНОМ ОГРАНИЧИТЕЛЬ^
 ПБ ФТГР1^
*^
*^
*^
ФТЕКОД НОП ОДИНОЧНЫЙ РЕЖИМ^
 ВХОДН ФТЕКОД^
*^
*  ВЫХОДНЫЕ ЗНАЧЕНИЯ:^
*    ДЛИНА - ДЛИНА ПОЛУЧЕННОГО ТЕКСТА^
*^
 УИА (М7) ОДИНОЧНЫЙ РЕЖИМ^
 УИА ПД+6(М1)^
 УИА -5(М4)^
*^
ВЫБСИМ НОП^
 СЧ СИ^
 НТЖ П377^
 ПО КОНТ КОНЕЦ ТЕКСТА^
 СЧ СИ^
 НТЖ П17^
 ПО ФТПРОБ <ПРОБЕЛ>^
 СЧ СИ^
 НТЖ П214^
 ПО ФLF <LINЕ FЕЕD>^
 СЧ СИ^
 НТЖ П144^
 ПО ФСЕ  С Т R L , Е^
 СЧ СИ^
 СДА 64-40^
 ПВ ЗСБ(М15)^
 СЧ СИ^
 НТЖ ПРИЗКС(М2)^
 ПО ФСЕ^
 ПВ ВС(М15)^
 ПБ ВЫБСИМ^
ФСЕ СЧ ПП341^
 ПВ ЗСБ(М15)^
 ПВ ВС(М15)^
 ПБ ВЫБСИМ^
ФLF ПИО ФСЕ(М7) ОДИНОЧНЫЙ РЕЖИМ^
 ПБ КОНТ ГРУППОВОЙ РЕЖИМ^
*^
ФТПРОБ НОП УПЛОТНЕНИЕ ПОДРЯД ИДУЩИХ ПРОБЕЛОВ^
 СЧ Е1^
 ЗП СТР СЧЕТЧИК ПРОБЕЛОВ^
ФТПР1 ПВ ВС(М15)^
 ПО ЗАПРОБ^
 СЧ СИ^
 НТЖ П17^
 ПЕ ЗАПРОБ^
 СЧ СТР^
 СЛЦ Е1^
 ЗП СТР^
 ПБ ФТПР1^
ЗАПРОБ НОП ЗАПИСЬ ПРОБЕЛОВ^
 СЧ СТР^
 И П177^
 ИЛИ Е8^
 СДА 64-40^
 ПВ ЗСБ(М15)^
 ПБ ВЫБСИМ^
*^
* КОНЕЦ ТЕКСТА^
КОНТ НОП^
 СЧ ПП341^
 ПВ ЗСБ(М15)^
 УИИ М16(М4)^
 СЛИА 5(М16)^
 ПИНО КОНТ(М16)^
 ПИНО ФТLF(М7) ГРУППОВОЙ РЕЖИМ^
 СЛИА -6(М1)^
 СЧИ М1^
 ВЧ АПД^
 И П1777^
 ЗП ДЛИНА ДЛИНА ТЕКСТА^
 ПБ (М6)^
*^
* ЗАПИСЬ ДЛИНЫ ТЕКСТА^
ФТLF НОП^
 СЧИ М1^
 ЗП РЯ1^
 ВЧ РЯ4^
 И П1777^
 СДА 64-15^
 ИЛИ (М7)^
 ЗП (М7) ЗАПИСЬ ДЛИНЫ^
 СЧ РЯ1^
 ЗП РЯ4^
 СЛИА 2(М7)^
 СЧ ВСЕЕД^
 ЗП (М7) ЗАПИСЬ ОГРАНИЧИТЕЛЯ^
*^
* ВЫБОР НОМЕРА СТРОКИ^
ФТГР1 СЧ 0^
 ЗП РЯ1^
ФТГР2 НОП^
 СЧ СИ^
 НТЖ П377^
 ПО (М6) "Е Т Х"^
 СЧ СИ^
 НТЖ П214^
 ПО ФТГР3 "LINЕ FЕЕD"^
 СЧ СИ^
 НТЖ П17^
 ПО ФТГР3 ПРОБЕЛ^
 СЧ СИ^
 ВЧОБ П11^
 ПЕ (М6) НЕ ЦИФРА (ОШИБКА)^
 СЧ РЯ1^
 СДА 64-4^
 ИЛИ СИ^
 ЗП РЯ1^
 ПВ ВС(М15)^
 ПБ ФТГР2^
*^
* ЗАПИСЬ НОМЕРА СТРОКИ^
ФТГР3 НОП^
 ПВ ВС(М15)^
 СЧ РЯ1^
 ПО ФТГР1 НОМЕР ПУСТ^
 ПВ ИЗ10В8(М17)^
 СЛЦ СМЕЩ(М2)^
 И П17777^
 СДА 64-27^
 ЗП (М7) ЗАПИСЬ НОМЕРА КАРТЫ^
 СЧИ М1^
 ИЛИ (М7)^
 ЗП (М7) ЗАПИСЬ НАЧАЛА ТЕКСТА^
 ПБ ВЫБСИМ^
*^
*^
*^
*  БЛОК ПОИСКА КАРТЫ^
*-------------------^
*^
ИЩИКАР НОП^
 ВХОДН ИЩИКАР^
*^
*  ВХОДНЫЕ ЗНАЧЕНИЯ:^
*    М3     - АДРЕС СЛОВА НАЧАЛА МАССИВА^
*    НАЧАЛО - НОМЕР (8) ТРЕБУЕМОЙ КАРТЫ^
*  ВЫХОДНЫЕ ЗНАЧЕНИЯ:^
*    КООРДИНАТЫ ПЕРВОГО СИМВОЛА В КАРТЕ:^
*      М3  - АДРЕС СЛОВА (М3 = 0 - НЕТ КАРТЫ)^
*      М10 - НОМЕР БАЙТА^
*      И3И10 - В УПАКОВАНОМ ВИДЕ^
*  РАБОЧИЕ ЯЧЕЙКИ:^
*    РЯ1 - СЧЕТЧИК КАРТ^
*  ВЫХОД ПО М6^
*^
 СЧ 0^
 ЗП РЯ1^
 СЧИ М3^
 ЗП РЯИ^
 СЛИА 6(М3)^
*^
 УИА -5(М10)^
*^
ПКАР1 НОП СОХРАНЕНИЕ М3, М10^
 ВХОДН ПКАР1^
 СЧИ М3^
 СДА 64-15^
 ЗП И3И10(М2)^
 СЧИ М10^
 ИЛИ И3И10(М2)^
 ЗП И3И10(М2)^
*^
 ПВ ВСБ(М15)^
 НТЖ ПП341^
 ПЕ НОВКАР НОВАЯ КАРТА^
 СЧИ М3^
 ЗП РЯ4^
 СЧ РЯИ^
 СЛЦ СЛОВОК(М2)^
 ВЧ РЯ4^
 ПО ПКАР1 НЕ КОНЕЦ МАССИВА^
 УИА (М3)^
 ПБ (М6) НЕТ КАРТ^
*^
НОВКАР НОП НОВАЯ КАРТА^
 СЧ РЯ1^
 СЛЦ Е1^
 ЗП РЯ1^
 НТЖ НАЧАЛО^
 ПО НАШКАР КАРТА НАЙДЕНА^
НКАР2 ПВ ВСБ(М15)^
 НТЖ ПП341^
 ПЕ НКАР2 НЕ КОНЕЦ КАРТЫ^
 ПБ ПКАР1 КОНЕЦ КАРТЫ^
*^
НАШКАР НОП КАРТА НАЙДЕНА^
 СЧ И3И10(М2)^
 УИ М10 ВОССТ. М10^
 СДА 64+15^
 УИ М3 ВОССТ. М3^
 ПБ (М6) УХОД^
*^
*^
*^
*^
*^
*^
*  М И К Р О Д И Р Е К Т И В Ы   Р Е Д А К Т О Р А  *^
*                                                   *^
*****************************************************^
*^
*^
*^
*^
*^
* МИКРОДИРЕКТИВА "ДОПИСЬ"^
*------------------------^
*^
ДОПИСЬ НОП^
 ВХОДН ДОПИСЬ^
*^
*  ВХОДНЫЕ ЗНАЧЕНИЯ:^
*    ДЛИНА - ДЛИНА ТЕКСТА ДОПИСИ^
*  ВЫХОДНЫЕ ЗНАЧЕНИЯ:^
*    СМ > 0 - БУФЕР ПЕРЕПОЛНЕН^
*  ВЫХОД ПО М6^
*^
 СЧ ДЛИНА^
 СЛЦ СЛОВОК(М2)^
 ВЧ П7777^
 ПО (М6) БУФЕР ПЕРЕПОЛНЕН^
*^
 СЧ ДЛИНА^
 НТЖ П77777^
 СЛЦ Е2^
 УИ М16^
 УИА (М15)^
 СЧ СЛОВОК(М2)^
 ПЕ ДОПИС0 ДОПИСЫВАЕМ НЕ К ПУСТОМУ МАССИВУ^
 СЧ П5^
 ЗП СЛОВОК(М2)^
ДОПИС0 СЛЦ АСЛОВО^
 УИ М17^
ДОПИС1 МОДА ПД+6^
 СЧ (М15)^
 МОДА (М17)^
 ЗП 1(М15)^
 СЛИА 1(М15)^
 ЦИКЛ ДОПИС1(М16) НЕ ВСЕ ДОПИСАНО^
 СЧ СЛОВОК(М2)^
 СЛЦ ДЛИНА^
 ЗП СЛОВОК(М2) КОРРЕКЦИЯ ДЛИНЫ МАССИВА^
 ПБ (М6)^
*^
*  МИКРОДИРЕКТИВА "ОТМЕНА"^
*-------------------------^
*^
ОТМЕНА НОП^
 ВХОДН ОТМЕНА^
*^
*  ВХОДНЫЕ ЗНАЧЕНИЯ:^
*    М17    - АДРЕС НАЧАЛА МАССИВА^
*    НАЧАЛО - НОМЕР (8) НАЧ. КАРТЫ^
*    КОНЕЦ  - НОМЕР (8) КОН. КАРТЫ^
*  ВЫХОДНЫЕ ЗНАЧЕНИЯ:^
*    СМ = 77777 - НЕТ КАРТ^
* РЯКТЛ = 77..7 - ОТМЕНА ДО КОНЦА МАССИВА^
*  ВЫХОД ПО М6(ЗАПОМИНАЕТСЯ В РЯ17)^
*^
 СЧИ М6^
 ЗП РЯ17 ЗАП. АДРЕС ВЫХОДА^
*^
 УИИ М3(М17)^
 ПВ ИЩИКАР(М6)^
 СЧ П77777^
 МОД РЯ17^
 ПИО (М3) НЕТ НАЧ. КАРТЫ^
 СЧ И3И10(М2)^
 ЗП РЯ2 КООРД. 1 СИМВОЛА НАЧ. КАРТЫ^
 СЧ КОНЕЦ^
 НТЖ П77777^
 ПО ОТМН ОТМЕНА ДО КОНЦА^
 СЧ КОНЕЦ^
 СЛЦ Е2^
 ЗП НАЧАЛО^
 ПВ ПКАР1(М6) ПРОДОЛЖЕНИЕ ПОИСКА^
 СЧ РЯ2^
 УИ М4^
 СДА 64+15^
 УИ М1 ВОССТ. КООРД. 1 СИМВ. В НАЧ КАРТЕ^
 ПИО ОТМВ(М3) НЕТ КОН. КАРТЫ^
*^
* РАЗБОР ВАРИАНТОВ^
 СЧ И3И10(М2)^
 НТЖ РЯ2^
 И Е30П16^
 ПО ОТМА М3(НАЧ) = М3(КОН)^
 СЧ РЯ2^
 СЛЦ Е16^
 НТЖ И3И10(М2)^
 И Е30П16^
 ПО ОТМА М3(НАЧ) + 1 = М3(КОН)^
*^
* А ЗДЕСЬ НУЖНО РАБОТАТЬ БЫСТРО.^
* ПРИВЕДЕНИЕ МАССИВА К ВЫШЕ РАСМОТРЕННЫМ ВАРИАНТАМ^
 СЧИ М17^
 ЗП РЯ1^
 СЧИ М3^
 ВЧ РЯ1^
 ВЧ СЛОВОК(М2)^
 УИ М17 -(СЛОВОК-(М3-М17))  КОЛ-ВО ПОВТ. В ЦИКЛЕ^
 УИА (М15)^
ОТМ1А МОДА (М3)^
 СЧ (М15)^
 МОДА (М1)^
 ЗП 1(М15)^
 СЛИА 1(М15)^
 ЦИКЛ ОТМ1А(М17)^
 СЧИ М3^
 ЗП РЯ2^
 СЧИ М1^
 ВЧОБ РЯ2^
 ВЧОБ СЛОВОК(М2)^
 СЛЦ Е1^
 И П7777^
 ЗП СЛОВОК(М2) КОРРЕКЦИЯ ДЛИНЫ МАССИВА^
*^
 УИИ М3(М1)^
 СЛИА 1(М3)^
*^
ОТМА НОП^
 СЧ ПП341^
 ПВ ЗСБ(М15)^
 СЧИ М1^
 ЗП РЯ1^
 СЧИ М3^
 НТЖ РЯ1^
 ПЕ ОТМА^
ОТМА2 НОП^
 СЧИ М4^
 ЗП РЯ1^
 СЧИ М10^
 НТЖ РЯ1^
 ПО ОТМИР ВСЕ СДЕЛАЛИ, СЛАВА БОГУ!^
 СЧ ПП341^
 ПВ ЗСБ(М15)^
 ПБ ОТМА2^
*^
ОТМН НОП ОТМЕНА ДО КОНЦА^
 СЧ РЯ2^
 УИ М4^
 СДА 64+15^
 УИ М1^
*^
ОТМВ НОП ЕСЛИ КОН. КАРТА > ДЛИНЫ^
 И П7777^
 ЗП СЛОВОК(М2)^
 СЧ ВСЕЕД^
 ЗП РЯКТЛ(М2) ДЛЯ ДИР-ВЫ <ЗАМ> ПРИЗН. "ДОП"^
 УИИ М3(М1)^
 СЛИА 1(М3)^
 УИА -5(М10)^
 ПБ ОТМА^
*^
*  ЗАПОМИНАНИЕ КООРД. 1 СИМВОЛА В КОН. КАРТЕ^
*  ТРЕБУЕСЯ ДЛЯ ДИРЕКТИВЫ <ЗАМ>^
ОТМИР НОП^
 СЧИ М1^
 СДА 64-15^
 ЗП И3И10(М2)^
 СЧИ М4^
 ИЛИ И3И10(М2)^
 ЗП И3И10(М2)^
 МОД РЯ17^
 ПБ 0 УХОД^
*^
*^
*  МИКРОДИРЕКТИВА <ВСТАВЬ>^
*-------------------------^
*^
ВСТАВЬ НОП^
 ВХОДН ВСТАВЬ^
*^
*  ВХОДНЫЕ ЗНАЧЕНИЯ:^
*     И3И10 - КООРДИНАТЫ 1 СИМВОЛА В КАРТЕ,^
*             ПЕРЕД КОТОРОЙ НУЖНО ВСТАВИТЬ ТЕКСТ^
*    ДЛИНА  - ДЛИНА ВСТАВЛЯЕМОГО ТЕКСТА^
*  ВЫХОДНЫЕ ЗНАЧЕНИЯ:^
*    СМ > 0   -   БУФЕР ПЕРЕПОЛНЕН^
*  ВЫХОД ПО М6^
*^
 СЧ ДЛИНА^
 СЛЦ СЛОВОК(М2)^
 ВЧ П7777^
 ПО (М6) БУФЕР ПЕРЕПОЛНЕН^
*^
 СЧ И3И10(М2)^
 УИ М10^
 СДА 64+15^
 УИ М3^
*^
*  РАЗДВИЖКА МАССИВА^
 СЧ ДЛИНА^
 УИИ М15(М10)^
 СЛИА 5(М15)^
 ПИО РАЗДВ1(М15) ПЕРВЫЙ СИМВОЛ В ЯЧЕЙКЕ^
 СЛЦ Е1^
РАЗДВ1 ЗП РЯ4 ДЛИНА РАЗДВИЖКИ^
*^
 СЧ СЛОВОК(М2)^
 СЛЦ АСЛОВО^
 УИ М1 АДРЕС КОНЦА МАССИВА^
 СЛЦ РЯ4^
 УИ М16 АДРЕС БУДУЩЕГО КОНЦА^
 СЧИ М3^
 ВЧ АСЛОВО^
 ВЧ СЛОВОК(М2)^
 УИ М17  М3-СЛОВОК   КОЛ-ВО ПОВТ. В ЦИКЛЕ^
 УИА (М15)^
ВСТ1 НОП^
 МОДА (М1)^
 СЧ (М15)^
 МОДА (М16)^
 ЗП (М15)^
 СЛИА -1(М15)^
 ЦИКЛ ВСТ1(М17)^
*^
 УИИ М1(М3)^
 УИИ М4(М10)^
ВСТУП1 УИИ М15(М4)^
 СЛИА 5(М15)^
 ПИО ВСТУП2(М15)^
 СЧ ПП341^
 ПВ ЗСБ(М15)^
 ПБ ВСТУП1^
ВСТУП2 НОП^
 СЧИ М1^
 ЗП РЯ2^
 СЧИ М3^
 СЛЦ ДЛИНА^
 СЛЦ Е1^
 УИ М1^
ВСТУП3 СЧИ М4^
 ЗП РЯ1^
 СЧИ М10^
 НТЖ РЯ1^
 ПО ВСТУП4^
 СЧ ПП341^
 ПВ ЗСБ(М15)^
 ПБ ВСТУП3^
ВСТУП4 НОП^
*^
*  ВСТАВКА ТЕКСТА ИЗ ПОЛЯ ДОПОЛНЕНИЯ^
 СЧ ДЛИНА^
 НТЖ П77777^
 СЛЦ Е2^
 УИ М17  -ДЛИНА+1^
 УИА (М15)^
ВСТ2 НОП^
 МОДА ПД+6^
 СЧ (М15)^
 МОД РЯ2^
 ЗП (М15)^
 СЛИА 1(М15)^
 ЦИКЛ ВСТ2(М17)^
*^
 УИА -5(М10)^
 СЧИ М10^
 ЗП И3И10(М2)^
 СЧИ М15^
 СЛЦ РЯ2^
 СДА 64-15^
 ИЛИ И3И10(М2)^
 ЗП И3И10(М2) КООРД. ДЛЯ СЛЕД ВСТАВКИ^
*^
 СЧ СЛОВОК(М2)^
 СЛЦ РЯ4^
 ЗП СЛОВОК(М2)  КОРРЕКЦИЯ ДЛИНЫ МАССИВА^
 ПБ (М6) УХОД^
*^
*^
*^
*^
*  Д И Р Е Т И В Ы   Р Е Д А К Т И Р О В А Н И Я  *^
*                                                 *^
***************************************************^
*^
*^
*^
*^
*^
*^
*^
*---------------------------------------*^
*                                       *^
*   В ДИРЕКТИВАХ РЕДАКТИРОВАНИЯ РЯКТЛ:  *^
*       0 - ТИП ДИРЕКТИВЫ "ВСТАВЬ"      *^
*   7...7 - ТИП ДИРЕКТИВЫ "ДОПИСЬ"      *^
*                                       *^
*---------------------------------------*^
*^
*^
*^
*  ОБРАБОТКА ДИР-ВЫ <ДОП>^
************************^
*^
ДОП НОП^
 ВХОДН ДОП^
*^
 СЧ ВСЕЕД^
 ЗП РЯКТЛ(М2) ПРИЗНАК "ДОП"^
 СЧ ИМЯПР(М2)^
 ПО НЕБЫЛО НЕТ ИМЕНИ МАССИВА^
 СЧ ПРИЗНД(М2)^
 ИЛИ Е41^
 ИЛИ Е48^
 ЗП ПРИЗНД(М2)^
 УИА ДОПИР(М16) АДРЕС ПО ПРИЕМУ ТЕКСТА^
 УИА БУДЕТП(М15)^
 ПБ ДОПВХ^
*^
ДОПИР НОП^
 СЧ СИ^
 НТЖ П377^
 ПО БУДЕТП НЕТ ТЕКСТА ДЛЯ ДОПИСИ^
 ПВ ЧТСБ(М17)^
 ПВ ФТЕКОД(М6)^
*^
 ПВ ДОПИСЬ(М6)^
 ПО БПЕРЕП БУФЕР ПЕРЕПОЛНЕН^
 ПВ ЗПСБ(М17)^
 ПБ БУДЕТП^
*^
*^
*^
*  ОБРАБОТКА ДИР-ВЫ <ПАС>^
*************************^
*^
ПАСП НОП^
 ВХОДН ПАСП^
*^
*  ВЫХОДИТ НЕПОСРЕДСТВЕННО НА ДИР-ВЫ: <ДОП> ИЛИ <ВСТ>^
*^
*^
 СЧ ИМЯПР(М2)^
 ПО НЕБЫЛО^
 ПВ ЧТСБ(М17)^
 СЧ СЛОВОК(М2)^
 ПО ДОП ВЫХОД НА ДИР-ВУ <ДОП>^
 СЧ Е1^
 ЗП НАЧАЛО^
 ПБ ВСТПАС ВЫХОД НА ДИР-ВУ <ВСТ>^
*^
*^
*  ОБРАБОТКА ДИР-ВЫ <МАС>^
*************************^
*^
ВСТМАС НОП^
 ВХОДН ВСТМАС^
*^
 ЗП ПАРФН(М2)^
 УИА ПВМ(М16)^
 СЧ ИМЯПР(М2)^
 ПО ПП1 НЕТ ИМЕНИ ТЕК. МАССИВА^
 СЧ ПРИЗНД(М2)^
 И Е41^
 ПО ПП1 НЕ БЫЛО ДИРЕКТИВЫ РЕДАКТИРОВАНИЯ^
*^
 ПВ ВЫБZИ(М6)^
 ПВ ВЫБZХ(М6)^
 СЧ ИМЯПРН(М2)^
 ПО НЕБЫЛО^
 ПВ ПРОВИД(М6)^
 ПЕ ПЛИДЕН^
ВСТМА1 НОП^
 СЧ НОМАРХ(М2)^
 ПВ ЗАКМД(М17)^
 ПЕ ВНМД^
 СЧ БОБИНА^
 Э50 '115'^
 ПВ ИМЯЕС(М6) ПОИСК В КАТАЛОГЕ^
 УИА ЗК(М17)^
 СЧ ЗОНЫ^
 НТЖ ВСЕЕД^
 ПО ОСВ ЗАТЕРТ КАТАЛОГ^
 СЧ ЗОНЫ^
 УИА НВКТ(М16)^
 УИА ПП1(М17)^
 ПО ОСВ НЕТ В КАТАЛОГЕ^
 СЧ ХОЗФН(М2)^
 ЗП РЯПР^
 И Е46^
 ПЕ ВСТОБЩ МАССИВ ОБЩИЙ^
 ПВ ПРАВО(М17)^
 УИА НПРАВ(М17)^
 ПЕ ОСВ^
ВСТОБЩ НОП^
 УИА НТЕКСТ(М16)^
 УИА ПП1(М17)^
 СЧ ХОЗФН(М2)^
 И Е43^
 ПЕ ОСВ НЕТЕКСТОВЫЙ ФАЙЛ^
 СЧ ХОЗФН(М2)^
 И Е48^
 ПО ВСТМБП НЕТ ПАРОЛЯ^
 СЧ ПРИЗНД(М2)^
 И Е42^
 ПЕ ВСТМ1 ПАРОЛЬ ЗАПРОСИЛИ^
 ПВ ОСВ(М17)^
 УИА ВСТМА1(М16) АДРЕС ВХОДА ПОСЛЕ ПРИЕМА^
 ПБ ЗАППАР^
*^
ВСТМ1 НОП^
 ПВ ВЫБП(М17)^
 СЧ ПРИЗНД(М2)^
 ИЛИ Е42^
 НТЖ Е42^
 ЗП ПРИЗНД(М2)^
*^
ВСТМБП НОП^
 СЧ ЧТДМ^
 ПВ ОЗУДИС(М17)^
 СЧ БОБИНА^
 Э50 '116'^
 УИА ПД(М16)^
 ПВ ТЕСТ(М6)^
 ПЕ ВТЕСТ ОШИБКА В СЛУЖ. СЛОВАХ^
 МОДА ПД^
 СЧ 0^
 ПО МАСПУС ПУСТОЙ МАССИВ^
 ВЧ П5^
 ЗП ДЛИНА^
 ПВ ЧТСБ(М17)^
 УИА МАССБЗ(М6) ВЫХОД ИЗ "ВСТАВЬ"^
 СЧ РЯКТЛ(М2)^
 ПО ВСТАВЬ^
 ПВ ДОПИСЬ(М6)^
МАССБЗ НОП^
 ПО БПЕРЕП БУФЕР ПЕРЕПОЛНЕН^
 СЧ ПРИЗНД(М2)^
 ИЛИ Е41^
 НТЖ Е41^
 ИЛИ Е48^
 НТЖ Е48^
 ЗП ПРИЗНД(М2)^
 ПВ ЗПСБ(М17)^
 ПБ БУДЕТП^
*^
*  ОБРАБОТКА ДИР-ВЫ <ОТМ>^
*************************^
*^
ОТМКАР НОП^
 ВХОДН ОТМКАР^
*^
 СЧ ИМЯПР(М2)^
 ПО НЕБЫЛО^
 УИА 1(М5)^
 ПВ ВЫБZДП(М6) ВЫБОР ДИАПАЗОНА^
*^
 ПВ ЧТСБ(М17)^
 СЧ СЛОВОК(М2)^
 ПО МАСПУС ПУСТОЙ МАССИВ^
*^
 УИА СЛОВО(М17)^
 ПВ ОТМЕНА(М6)^
 НТЖ П77777^
 ПО НЕТКАР НЕТ КАРТ^
*^
 ПВ ЗПСБ(М17)^
 ПБ БУДЕТП^
*^
*  ОБРАБОТКА ДИР-ВЫ <ВСТ>^
*************************^
*^
ВСТКАР НОП^
 ВХОДН ВСТКАР^
*^
 СЧ ИМЯПР(М2)^
 ПО НЕБЫЛО НЕТ ИМЕНИ МАССИВА^
 УИА 1(М5)^
 ПВ ВЫБZДП(М6)^
*^
ВСТПАС НОП ВХОД ДЛЯ ДИР-ВЫ <ПАС>^
 СЧ 0^
 ЗП РЯКТЛ(М2) ПРИЗНАК "ВСТ"^
 ПВ ЧТСБ(М17)^
 СЧ СЛОВОК(М2)^
 ПО МАСПУС ПУСТОЙ МАССИВ^
*^
*  ПОИСК НУЖНОЙ КАРТЫ^
 УИА СЛОВО(М3)^
 ПВ ИЩИКАР(М6)^
 ПИО НЕТКАР(М3)  НЕТ КАРТ^
*^
 СЧ ПРИЗНД(М2)^
 ИЛИ Е41^
 ИЛИ Е48^
 ЗП ПРИЗНД(М2)^
 УИА ВСТК1(М16)^
 УИА БУДЕТП(М15)^
 ПБ ДОПВХ^
*^
ВСТК1 НОП ВХОД ПОСЛЕ ПРИЕМА^
 ПВ ФТЕКОД(М6)^
 ПВ ЧТСБ(М17)^
 ПВ ВСТАВЬ(М6)^
 ПО БПЕРЕП БУФЕР ПЕРЕПОЛНЕН^
 ПВ ЗПСБ(М17)^
 ПБ БУДЕТП^
*^
*^
*  ОБРАБОТКА ДИР-ВЫ <ВЗЯ>^
*************************^
*^
ВЗЯТЬ НОП^
 ВХОДН ВЗЯТЬ^
*^
 СЧ ИМЯПР(М2)^
 ПО НЕБЫЛО НЕТ ИМЕНИ МАССИВА^
 УИА 1(М5)^
 ПВ ВЫБZДП(М6)^
 ПВ ЧТСБ(М17)^
 СЧ СЛОВОК(М2)^
 ПО МАСПУС ПУСТОЙ МАССИВ^
*^
 СЧ НАЧАЛО^
 ЗП РЯ5^
 СЧ КОНЕЦ^
 СЛЦ Е1^
 ЗП НАЧАЛО^
 СЧ П77777^
 ЗП КОНЕЦ^
 УИА СЛОВО(М17)^
 ПВ ОТМЕНА(М6) ОТМЕНА КОНЦА МАССИВА^
*^
 СЧ РЯ5^
 НТЖ Е1^
 ПО ВЗЯЗАП ВЗЯТЬ С 1 КАРТЫ^
 СЧ РЯ5^
 ВЧ Е1^
 ЗП КОНЕЦ^
 СЧ Е1^
 ЗП НАЧАЛО^
 УИА СЛОВО(М17)^
 ПВ ОТМЕНА(М6) ОТМЕНА НАЧАЛА МАССИВА^
 НТЖ П77777^
 ПО НЕТКАР^
*^
ВЗЯЗАП НОП^
 ПВ ЗПСБ(М17)^
 ПБ БУДЕТП^
*^
*  ОБРАБОТКА ДИР-ВЫ <ЗАМ>^
*************************^
*^
ДИРЗАМ НОП^
 ВХОДН ДИРЗАМ^
*^
 ЗП РЯКТЛ(М2)^
 СЧ ИМЯПР(М2)^
 ПО НЕБЫЛО НЕТ ИМЕНИ МАССИВА^
 УИА 1(М5)^
 ПВ ВЫБZДП(М6) ВЫБОР ДИАПАЗОНА^
*^
 ПВ ЧТСБ(М17)^
 СЧ СЛОВОК(М2)^
 ПО МАСПУС ПУСТОЙ МАССИВ^
*^
 УИА СЛОВО(М17)^
 ПВ ОТМЕНА(М6)^
 НТЖ П77777^
 ПО НЕТКАР НЕТ КАРТ^
 ПВ ЗПСБ(М17)^
*^
 СЧ ПРИЗНД(М2)^
 ИЛИ Е41^
 ИЛИ Е48^
 ЗП ПРИЗНД(М2)^
 УИА ЗАМВХ1(М16) АДРЕС ВХОДА ПОСЛЕ ПРИЕМА^
 УИА БУДЕТП(М15)^
 ПБ ДОПВХ^
*^
ЗАМВХ1 НОП ВХОД ПОСЛЕ ПРИЕМА^
 ПВ ЧТСБ(М17)^
 ПВ ФТЕКОД(М6)^
 УИА ЗАМСБЗ(М6) ВЫХОД ИЗ "ВСТАВЬ"^
 СЧ РЯКТЛ(М2)^
 ПО ВСТАВЬ^
 ПВ ДОПИСЬ(М6)^
ЗАМСБЗ НОП^
 ПО БПЕРЕП БУФЕР ПЕРЕПОЛНЕН^
 ПВ ЗПСБ(М17)^
 ПБ БУДЕТП^
*^
*  ОБРАБОТКА ДИР-ВЫ <РЕД>^
*************************^
*^
РЕД НОП^
 ВХОДН РЕД^
*^
 СЧ ИМЯПР(М2)^
 ПО НЕБЫЛО^
 СЧ ПРИЗНД(М2)^
 ИЛИ Е42^
 ИЛИ Е40^
 ЗП ПРИЗНД(М2)^
 УИА ВХРЕД(М16)^
 УИА БУДЕТП(М15)^
 ПБ ДОПВХ^
*^
ВХРЕД НОП^
 СЧ ПРИЗНД(М2)^
 ИЛИ Е42^
 НТЖ Е42^
 ИЛИ Е40^
 НТЖ Е40^
 ЗП ПРИЗНД(М2)^
 ПВ ЧТСБ(М17)^
 СЧ СЛОВОК(М2)^
 ПО МАСПУС ПУСТОЙ МАССИВ^
*^
 ПВ ФТЕКГР(М6)^
 ПЕ НЕДИР1 НЕВЕРНО ЗАДАН НОМЕР^
 СЧ ПОЛНОМ^
 НТЖ ВСЕЕД^
 ПО БУДЕТП НЕТ ТЕКСТА^
*^
*  УПОРЯДОЧИВАНИЕ ПО УБЫВАНИЮ^
 УИА (М15)^
 УИА (М16)^
УПРЕД НОП^
 СЧ ПОЛНОМ(М15)^
 СДА 64+27^
 ЗП РЯ1^
 СЧ ПОЛНОМ(М16)^
 СДА 64+27^
 ВЧ РЯ1^
 ПО УПРЕД1^
 СЧ ПОЛНОМ(М15)^
 ЗП РЯ1^
 СЧ ПОЛНОМ+1(М15)^
 ЗП РЯ2^
 СЧ ПОЛНОМ(М16)^
 ЗП ПОЛНОМ(М15)^
 СЧ ПОЛНОМ+1(М16)^
 ЗП ПОЛНОМ+1(М15)^
 СЧ РЯ1^
 ЗП ПОЛНОМ(М16)^
 СЧ РЯ2^
 ЗП ПОЛНОМ+1(М16)^
УПРЕД1 НОП^
 СЛИА 2(М16)^
 СЧ ПОЛНОМ(М16)^
 НТЖ ВСЕЕД^
 ПЕ УПРЕД^
 СЛИА 2(М15)^
 УИА (М16)^
 СЧ ПОЛНОМ(М15)^
 НТЖ ВСЕЕД^
 ПЕ УПРЕД^
*^
*  РЕДАКТИРОВАНИЕ^
 УИА (М7)^
ДРЕД НОП^
 СЧ ПОЛНОМ(М7)^
 НТЖ ВСЕЕД^
 ПО РЕДВСЕ^
*  ОТМЕНА СТАРОЙ СТРОКИ^
 СЧ 0^
 ЗП РЯКТЛ(М2)^
 СЧ ПОЛНОМ(М7)^
 СДА 64+27^
 ЗП НАЧАЛО^
 ЗП КОНЕЦ^
 УИА СЛОВО(М17)^
 ПВ ОТМЕНА(М6)^
 НТЖ П77777^
 ПО НКРЕД НЕТ КАРТ^
*  ВСТАВКА НОВОЙ СТРОКИ^
 СЧ ПОЛНОМ(М7)^
 СДА 64+15^
 И П7777^
 ЗП ДЛИНА^
 ВЧОБ 0^
 УИ М17^
 СЛИА 1(М17)^
 УИА (М16)^
ПОДГТ МОД ПОЛНОМ(М7)^
 СЧ (М16)^
 МОДА ПД+6^
 ЗП (М16)^
 СЛИА 1(М16)^
 ЦИКЛ ПОДГТ(М17)^
*^
 УИА РЕД2(М6) ВЫХОД ИЗ "ВСТАВЬ"^
 СЧ РЯКТЛ(М2)^
 ПО ВСТАВЬ^
 ПВ ДОПИСЬ(М6)^
РЕД2 НОП^
 ПО БПЕРЕП БУФЕР ПЕРЕПОЛНЕН^
*^
 СЛИА 2(М7)^
 ПБ ДРЕД^
НКРЕД НОП^
 ЗП КТО Т.К. ИСПОРЧЕН БУФЕР^
 ПБ НЕТКАР^
РЕДВСЕ НОП^
 ПВ ЗПСБ(М17)^
 ПБ БУДЕТП^
*^
*^
*  ОБРАБОТКА ДИР-В ВЫДАЧИ НА ЭКРАН^
**********************************^
*^
* ЗДЕСЬ ЗНАЧЕНИЯ СЛЕДУЮЩИЕ:^
*    РЯКТЛ:^
*     Е1  - Е15 - НАЧАЛЬНАЯ КАРТА^
*     Е16 - Е30 - КОНЕЧНАЯ КАРТА^
*    ПРИЗНД (Е45):^
*      1 - КОНТЕКСТНЫЙ ПОИСК^
*      0 - ВЫДАЧА НА ЭКРАН^
*    ПРИЗНД (Е47-Е46):^
*     00 - ДИР <ВЫД>^
*     01 - ДИР <ВБН>^
*     10 - ДИР <РУЛ>^
*     11 - ДИР <РЛБ>^
*    М14  - АДРЕС Ф-ОБЛАСТИ (АБСОЛЮТНЫЙ)^
*    ТЕКСТ1  =0 - ПОЛНЫЙ ПОИСК^
*             1 - ПОИСК ДО ПЕРВОГО ВХОЖДЕНИЯ^
*    ХОЗФН:^
*     Е1 -  Е15 - НАЧАЛЬНАЯ ПОЗИЦИЯ^
*     Е16 - Е30 - КОНЕЧНАЯ ПОЗИЦИЯ^
*^
НАЙДИ НОП ВХОД ДЛЯ <НАЙ>^
 ВХОДН НАЙДИ^
*^
 ЗП ТЕКСТ1(М2)^
 СЧ Е1^
 ЗП НАЧПОЗ^
 СЧ П777^
 ЗП КОНПОЗ^
*^
* ВЫБОР ПАРАМЕТРОВ^
*-----------------^
*^
ПКОНТ НОП^
 СЧ СИ^
 НТЖ П377^
 ПО НЕДИР1 НЕТ ПАРАМЕТРОВ^
*^
 СЧ СИ^
 НТЖ БВЫД^
 ПО ПКВЫД БУКВА "В"^
*^
 СЧ СИ^
 НТЖ БП^
 ПО ПКПОЗ БУКВА "П"^
 ПЕ ЗАНФОБ^
*^
* ПРИЗНАК ПОИСКА ДО ПЕРВОГО ВХОЖДЕНИЯ^
ПКВЫД НОП^
 СЧ Е1^
 ЗП ТЕКСТ1(М2)^
 ПВ ВС(М15)^
 ПВ ПРОПР(М16)^
 ПБ ПКОНТ^
*^
*  ВЫБОР ПОЗИЦИЙ^
ПКПОЗ НОП^
 ПВ ВС(М15)^
 ПВ ПРОПР(М16)^
* ВЫБОР НАЧАЛЬНОЙ ПОЗИЦИИ^
 СЧ СИ^
 ВЧОБ П11^
 ПЕ НЕДИР1 НЕ ЦИФРА^
 ПВ ВЫБZ10(М16)^
 ПВ ИЗ10В8(М17)^
 И П77777^
 ЗП НАЧПОЗ НАЧ. ПОЗИЦИЯ^
* ВЫБОР КОНЕЧНОЙ ПОЗИЦИИ^
 СЧ СИ^
 ВЧОБ П11^
 ПЕ НЕДИР1 НЕ ЦИФРА^
 ПВ ВЫБZ10(М16)^
 ПВ ИЗ10В8(М17)^
 И П77777^
 ЗП КОНПОЗ КОН. ПОЗИЦИЯ^
 ПО НЕДИР1^
 СЧ НАЧПОЗ^
 ПО НЕДИР1^
 ВЧОБ КОНПОЗ^
 ПЕ НЕДИР1^
 ПБ ПКОНТ^
*^
*  ПОИСК СВОБОДНОЙ Ф-ОБЛАСТИ^
ЗАНФОБ НОП^
 СЧ СИ^
 ЗП СИ1 ОГРАНИЧИТЕЛЬ^
 УИА -КФОБЛ(М17)^
 УИА (М14)^
ЗФОБ1 СЧ ФОБЛ(М14)^
 ПО ВЫБКО1 Ф-ОБЛАСТЬ НАЙДЕНА^
 СЛИА ДЛФОБЛ(М14)^
 ЦИКЛ ЗФОБ1(М17)^
 УИА ТНФОБЛ(М16)^
 ПБ ПП1 НЕТ СВОБОДНЫХ Ф-ОБЛАСТЕЙ^
*^
*  ВЫБОР КОНТЕКСТА^
ВЫБКО1 НОП^
 УИИ М1(М14)^
 СЛИА ФОБЛ+1(М1)^
 УИА -5(М4)^
 УИА 6*ДЛФОБЛ-8(М17)^
 СЧИ М17^
 ВЧОБ 0^
 УИ М17 ДЛЯ ЦИКЛА^
ВЫБКОН ПВ ВС(М15)^
 ПО НЕДИР1 КОНЕЦ ТЕКСТА^
 СЧ СИ^
 НТЖ СИ1^
 ПО ЗАПТКН  ОГРАНИЧИТЕЛЬ^
 СЧ СИ^
 СДА 64-40^
 ПВ ЗСБ(М15)^
 ЦИКЛ ВЫБКОН(М17)^
 УИА ТДЛКОН(М16)^
 ПБ ПП1^
ТДЛКОН ТЕКСТ П'ДЛИНЫЙ КОНТЕ'^
 КОНД П'КСТ000'М16В'377'^
*^
ЗАПТКН НОП^
 ПВ ПРОПР(М16)^
 СЧ Е48П41^
 ПВ ЗСБ(М15) ЗАПИСЬ ОГРАНИЧИТЕЛЯ^
 СЧИ М14^
 СДА 64-15^
 ИЛИ ВЫХПР(М2)^
 ЗП ВЫХПР(М2) АДРЕС Ф-ОБЛАСТИ^
 СЧ ТЛФ(М2)^
 СДА 64-15^
 ЗП ФОБЛ(М14) ЗАНЯЛИ Ф-ОБЛАСТЬ^
 СЧ Е45^
 ПБ ВЫДАЧА^
РУЛОНБ НОП   ВХОД ДЛЯ <РЛБ>^
 ВХОДН РУЛОНБ^
 СЧ Е46^
РУЛОН  НОП   ВХОД ДЛЯ <РУЛ>^
 ВХОДН РУЛОН^
 ИЛИ Е47^
 ПБ ВЫДАЧА^
ВБN НОП ВХОД ДЛЯ <ВБН>^
 ВХОДН ВБN^
 СЧ Е46^
ВЫДАЧА НОП ВХОД ДЛЯ <ВЫД>^
 ВХОДН ВЫДАЧА^
 ЗП РЯ1^
 СЧ ПРИЗНД(М2)^
 И О47П45^
 ИЛИ РЯ1^
 ЗП ПРИЗНД(М2)^
 СЧ ИМЯПР(М2)^
 ПО НЕБЫЛО НЕТ ИМЕНИ МАССИВА^
 УИА (М5)^
 ПВ ВЫБZДП(М6)^
 СЧ    КОНЕЦ^
       СДА   64-15^
       ИЛИ   НАЧАЛО^
 ЗП РЯКТЛ(М2)    ДИАПАЗОН ВЫДАЧИ^
 СЧ КОНПОЗ^
 СДА 64-15^
 ИЛИ НАЧПОЗ^
 ЗП ХОЗФН(М2) ДИАПАЗОН ПОЗИЦИЙ ДЛЯ ДИР <НАЙ>^
*^
 ПВ    ЧТСБ(М17)^
*^
       СЧ    СЛОВОК(М2)^
 ПО МАСПУС ПУСТОЙ МАССИВ^
*^
 УИА СЛОВО(М3)^
 ПВ ИЩИКАР(М6) ПОИСК КАРТЫ^
 ПИО НЕТКАР(М3) НЕТ КАРТ^
 УИА ДОВЫД(М16) АДРЕС ДОВЫДАЧИ^
 СЧИ М16^
 СДА 64-15^
 ИЛИ АПРИЕМ^
 ЗП ВЫХВЫД(М2)^
*^
ДОВЫД НОП ВХОД ДЛЯ ПРОДОЛЖЕНИЯ ВЫДАЧИ^
 ПВ ЧТСБ(М17)^
 СЧ И3И10(М2)^
 УИ М10^
 СДА 64+15^
 УИ М3 ВОССТ. М3^
 СЧ ХОЗФН(М2)^
 И П77777^
 ЗП НАЧПОЗ^
 СЧ ХОЗФН(М2)^
 СДА 64+15^
 ЗП КОНПОЗ^
 СЧ 0^
 ЗП СТР  СЧЕТЧИК СТРОК ВЫДАЧИ^
 УИИ М1(М13)^
 УИА -5(М4)^
 УИА 6*199+2(М11)^
 СЧ ПРИЗНД(М2)^
 И Е45^
 ПО ВЫД1 НЕ КОНТ. ПОИСК^
 СЧ ВЫХПР(М2)^
 СДА 64+15^
 УИ М14^
 СЛИА ФОБЛ(М14) АДРЕС Ф-ОБЛАСТИ (АБСОЛЮТНЫЙ)^
 ПБ КОНТП^
*^
*  В Ы Д А Ч А    С Т Р О К И^
*^
ВЫД1 НОП^
 СЧИ М3^
 СДА 64-15^
 ЗП РЯ4^
 СЧИ М10^
 ИЛИ РЯ4^
 ЗП РЯ4 КООРДИНАТЫ 1 СИМВОЛА СТРОКИ^
 СЧ ПРИЗНД(М2)^
 И Е46^
 ПЕ ВЫДВN НОМЕР НЕ ПИСАТЬ^
 СЧ РЯКТЛ(М2)^
 И П77777^
 СЛЦ СМЕЩ1(М2)^
 И П17777^
 ПВ ПЕРЕВ(М17) ПЕРЕВОД НОМЕРА В 10 ВИД^
 СДА 64-16^
 ЗП РЯ2^
 УИА -3(М17)^
ЗАПНОМ СЧ РЯ2^
 ПВ ЗСБ(М15)^
 ПИО ВЫДСЕ0(М11)^
 СЧ РЯ2^
 СДА 64-8^
 ЗП РЯ2^
 ЦИКЛ ЗАПНОМ(М17)^
 СЧ ПП17^
 ПВ ЗСБ(М15) ЗАПИСЬ ПРОБЕЛА^
*^
ВЫДВN НОП^
 ПВ ВСБ(М15)^
 ЗП СИ^
 НТЖ ПП341^
 ПО ВЫДСЕ КОНЕЦ КАРТЫ^
*^
*  ПРОВЕРКА НА "НЕВЫДАВАЕМЫЙ" СИМВОЛ^
 УИА -КЗС(М15)^
ЗСИМ1 СЧ СИ^
 НТЖ ТЗС+КЗС+1(М15)^
 И Е48П41^
 ПО ЗАМСИМ НА ВЫДАЧУ ЭКВИВАЛЕНТА^
 ЦИКЛ ЗСИМ1(М15)^
 СЧ СИ^
 И Е48^
 ПЕ ВЫДПР0 <ПРОБЕЛ>^
 СЧ СИ^
 ПВ ЗСБ(М15)^
 ПИО ВЫДСЕ0(М11)^
 ПБ ВЫДВN ЗА СЛЕДУЮЩИМ СИМВОЛОМ^
ВЫДПР0 НОП^
 СЧ СИ^
 СДА 64+40^
 НТЖ Е8^
 НТЖ П77777^
 СЛЦ Е2^
 УИ М17^
ВПРОБ1 СЧ ПП17^
 ПВ ЗСБ(М15)^
 ПИО ВЫДСЕ0(М11)^
 ЦИКЛ ВПРОБ1(М17)^
 ПБ ВЫДВN ЗА СЛЕДУЮЩИМ СИМВОЛОМ^
ЗАМСИМ НОП^
 СЧ ТЗС+КЗС+1(М15)^
 СДА 64-32^
 ЗП РЯ2^
 УИА -1(М16)^
ЗСИМ2 И Е48П41^
 ПВ ЗСБ(М15)^
 ПИО ВЫДСЕ0(М11)^
 СЧ РЯ2^
 СДА 64-8^
 ЦИКЛ ЗСИМ2(М16)^
 ПБ ВЫДВN^
*^
*  КОНТЕКСТНЫЙ ПОИСК^
*^
КОНТП НОП^
*^
*  ЗДЕСЬ ЗНАЧЕНИЯ СЛЕДУЮЩИЕ:^
*    НАЧПОЗ - НОМЕР НАЧ. ПОЗИЦИИ^
*    КОНПОЗ - НОМЕР КОН. ПОЗИЦИИ^
*    М16,РЯ3- СЧЕТЧИКИ ПРОБЕЛОВ^
*    М14    - АДРЕС Ф-ОБЛАСТИ (АБСОЛЮТНЫЙ)^
*    М5,М6  - ДЛЯ ВС ИЗ Ф-ОБЛ.^
*    М7=0   - УКАЗАТЕЛЬ НА ПЕРВОМ СИМВОЛЕ^
*    РЯБ=0  - КОНТЕКСТ НАЙДЕН^
*^
*^
*  РАЗБОРКА ТЕКСТА ДО НАЧ. ПОЗИЦИИ^
 СЧ Е1^
 ЗП РЯБ^
 СЧ НАЧПОЗ^
 НТЖ Е1^
 ПО РДНАЧ4 1 ПОЗИЦИЯ^
 СЧ НАЧПОЗ^
 НТЖ П77777  -НАЧПОЗ+2 (КОЛ-ВО ПОВТ. В ЦИКЛЕ)^
 СЛЦ П3^
 УИ М17^
РДНАЧ НОП^
 ПВ ВСБ(М15)^
 ЗП СИ^
 НТЖ ПП341^
 ПО КОНТЕС <341>^
 СЧ СИ^
 И Е48^
 ПЕ РДНАЧ0 ПРОБЕЛ^
РДНАЧ2 ЦИКЛ РДНАЧ(М17)^
РДНАЧ4 НОП^
 СЧ 0^
 ЗП РЯ3^
 УИА (М16)^
 ПВ ВСБ(М15)^
 ЗП СИ^
 ПБ РВДИАП^
*^
*  ЗДЕСЬ ОБОЗНАЧЕНИЯ СЛЕДУЮЩИЕ:^
*    Т - НОМЕР БАЙТА В СТРОКЕ^
*        Т=М17+НАЧПОЗ-1^
*    N - КОЛ-ВО ПРОБЕЛОВ^
*        N=РЯ1^
*^
РДНАЧ0 НОП^
 СЧ СИ^
 СДА 64+40^
 НТЖ Е8^
 ЗП РЯ1  N^
 СЧИ М17^
 ВЧ Е1^
 СЛЦ РЯ1^
 ЗП РЯ2  М17-1+N^
 ПО РДНАЧ1  НАЧПОЗ 'LЕ' Т+N <==> М17-1+N < 0^
 СЧИ М17^
 СЛЦ РЯ1^
 ВЧ Е1^
 УИ М17^
 ПБ РДНАЧ2^
РДНАЧ1 НОП^
 СЧ РЯ2^
 СЛЦ РЯ1^
 ВЧ Е1^
 УИ М16  N-(НАЧПОЗ-Т)-1  <==>  N+М17-2^
 ЗП РЯ3^
 СЧ ПП17^
 ЗП СИ^
*^
*  РАЗБОРКА ТЕКСТА В ДИАПАЗОНЕ ПОЗИЦИЙ^
РВДИАП НОП^
 СЧ НАЧПОЗ^
 ВЧ КОНПОЗ^
 УИ М17^
 УИИ М5(М14)^
 СЛИА 1(М5)^
 УИА -4(М6)^
 СЧ 1(М14)^
 И Е48П41^
 ЗП СИ1 ПЕРВЫЙ СИМВОЛ^
 УИА (М7)^
 СЧ СИ^
 ПБ РВДП01^
РВДП0 НОП^
 ПВ ВСБ(М15)^
РВДП01 НОП^
 ЗП СИ^
 НТЖ ПП341^
 ПО КОНТЕС КОНЕЦ КАРТЫ^
 СЧ СИ^
 И Е48^
 ПЕ РВДПР ПРОБЕЛ^
 СЧ СИ^
РВДП00 НОП^
 НТЖ СИ1^
 ПЕ РВДП2 СИМВОЛ НЕ СОВПАЛ^
 СЧ (М5)^
 СБР П377(М6)^
 ЦИКЛ РВДП1(М6)^
 СЛИА 1(М5)^
 УИА -5(М6)^
РВДП1 НОП^
 НТЖ Е48П41^
 ПО КОННАЙ КОНТЕКСТ НАЙДЕН^
 НТЖ Е48П41^
 ЗП СИ1^
 ПИНО РВДП3(М7) УКАЗ. НЕ НА 1 СИМВОЛЕ^
 СЧИ М3^
 ЗП РЯ2    ЗАПОМ М3^
 СЧИ М10^
 ЗП РЯ2+1  ЗАПОМ М10^
 УИА 1(М7)^
 ПБ РВДП3^
РВДПР НОП^
 СЧ СИ^
 СДА 64+40^
 НТЖ Е8^
 ВЧ Е1^
 ЗП РЯ3^
 УИ М16^
 СЧ ПП17^
 ПБ РВДП00^
РВДП2 НОП^
 ПИО РВДП3(М7) УКАЗАТЕЛЬ НА 1 СИМВОЛЕ^
 УИА (М7)^
 УИИ М5(М14)^
 СЛИА 1(М5)^
 УИА -4(М6)^
 СЧ 1(М14)^
 И Е48П41^
 ЗП СИ1 ПЕРВЫЙ СИМВОЛ^
 СЧ РЯ2^
 УИ М3  ВОССТ М3^
 СЧ РЯ2+1^
 УИ М10 ВОССТ М10^
 СЧ РЯ3^
 УИ М16^
 ПО РВДП3 ПРОБЕЛЫ КОНЧИЛИСЬ^
 ВЧ Е1^
 ЗП РЯ3^
РВДП3 НОП^
 ПИНО РВДП4(М16) РАЗБОР ПРОБЕЛОВ^
 ЦИКЛ РВДП0(М17)^
 ПБ РДОКК^
РВДП4 СЛИА -1(М16)^
 СЧ ПП17^
 ЦИКЛ РВДП00(М17)^
*^
*  РАЗБОРКА ТЕКСТА ОТ КОН. ПОЗИЦИИ ДО КОНЦА КАРТЫ^
РДОКК ПВ ВСБ(М15)^
 НТЖ ПП341^
 ПЕ РДОКК^
*^
КОНТЕС НОП^
 СЧ РЯБ^
 ПЕ ВЫДСЕ1 КОНТЕКСТ НЕ НАЙДЕН^
 СЧ ТЕКСТ1(М2)^
 ПО КОНТ1 ПОЛНЫЙ ПОИСК^
 СЧ ПРИЗНД(М2)^
 НТЖ Е45^
 ЗП ПРИЗНД(М2)^
КОНТ1 НОП^
*  ВОССТАНОВЛЕНИЕ КООРДИНАТ 1 СИМВОЛА В СТРОКЕ^
 СЧ И3И10(М2)^
 УИ М10^
 СДА 64+15^
 УИ М3^
 ПБ ВЫД1 НА ВЫДАЧУ СТРОКИ^
КОННАЙ ЗП РЯБ РЯБ:=0^
 ПБ КОНТЕС^
*^
*  КОНЕЦ СТРОКИ^
*^
ВЫДСЕ0 НОП^
 СЧ ШАГ(М2)^
 ВЧ Е1^
 ЗП СТР^
 СЧ РЯКТЛ(М2)^
 ВЧ Е1^
 ЗП РЯКТЛ(М2)^
 СЧ РЯ4^
 УИ М10^
 СДА 64+15^
 УИ М3^
*^
ВЫДСЕ НОП^
 СЧ СТР^
 СЛЦ Е1^
 ЗП СТР  +1 --> СЧ. СТРОК^
 СЧ ПП144^
 ПВ ЗСБ(М15) ЗАПИСЬ <СТRL,Е>^
 СЧ ПП214^
 ПВ ЗСБ(М15) ЗАПИСЬ <LINЕ FIDЕ>^
ВЫДСЕ1 СЧИ М3^
 СДА 64-15^
 ЗП И3И10(М2)^
 СЧИ М10^
 ИЛИ И3И10(М2)^
 ЗП И3И10(М2) ЗАПОМИНАНИЕ М3, М10^
 ПВ ВСБ(М15)^
 НТЖ ПП341^
 ПО ВЫДСЕ1 НЕ КОНЕЦ КАРТЫ^
 СЧИ М3^
 ЗП РЯ4^
 СЧ АСЛОВО^
 СЛЦ СЛОВОК(М2)^
 ВЧ РЯ4^
 ПЕ ВЫДАНО ВЫДАН ВЕСЬ МАССИВ^
*^
 СЧ РЯКТЛ(М2)^
 СЛЦ Е1^
 ЗП РЯКТЛ(М2)^
*^
 СЧ СТР^
 НТЖ ШАГ(М2)^
 ПО ЗАПЭКР ЗАПОЛНЕН ВЕСЬ ЭКРАН^
*^
 СЧ РЯКТЛ(М2)^
 И П77777^
 ЗП РЯ1^
 СЧ РЯКТЛ(М2)^
 СДА 64+15^
 ВЧ РЯ1^
 ПЕ ВЫДАНО ВЫДАН ВЕСЬ ДИАПАЗОН^
*^
 СЧ И3И10(М2)^
 УИ М10^
 СДА 64+15^
 УИ М3 ВОССТ. М3, М10^
 СЧ ПРИЗНД(М2)^
 И Е45^
 ПЕ КОНТП КОНТЕКСТНЫЙ ПОИСК^
 ПБ ВЫД1^
*^
ВЫДАНО НОП ВЫДАНО ВСЕ^
 СЧ 0^
 ЗП ВЫХВЫД(М2)^
 ЗП И3И10(М2)^
 ЗП (М14) ОСВ. Ф-ОБЛАСТИ^
*^
ЗАПЭКР НОП ЗАПОЛНЕН ВЕСЬ ЭКРАН^
 СЧ Е48П41^
 ПВ ЗСБ(М15) ЗАПИСЬ <ЕТХ>^
 ПБ ЭКВ^
*^
