*FOREX
      SUBROUTINE A001PN
      INTEGER DDDAT(4),AST,CDA(3),T1(2),ICOM(14)
     * , CHINP1
      CHARACTER COM*4
      EQUIVALENCE (DDDAT,CDA,ICOM,COM)
      DATA KVANT/5/
     * , NSJ0,NPJ0/3,51/
     * , NSD0,NPD0/3,1/
     * , NST0,NPT0/13,1/
C=====
      ENTRY MONITO
C-----   OfOPMlEHiE 1-Oj CTPOKi
1     CALL DDRE(IBIT(O'766'),4,DDDAT)
      CALL POSOUT(DDDAT,24,1,1)
      CALL DACOD(CDA)
      CALL POSOUT(CDA(3),5,1,26)
      CALL POSOUT('pPiKAz:',7,1,40)
      CALL POSOUT(CDA,9,1,62)
C-----   iHiciAciq TAblO zAdA~
      CALL PAJOBI(NSJ0,NPJ0)
C-----   iHiciAciq TAblO diCKOB/lEHT
      CALL PADTI(NSD0,NPD0)
C-----   iHiciAciq TAblO TEPMiHAlx}iKOB
      CALL PATERI(NST0,NPT0)
C
C=====   g l A B H y j   c i K l
C
10    DO
C-----  KOPPEKciq ACTPOHOMi~ECKOgO BPEMEHi
        CALL DDRE(IBIT(O'542'),1,AST)
        CALL TICOD(AST,T1)
        CALL POSOUT(T1,8,1,72)
C-----  OCOBPEMEHiM TAblO zAdA~
        CALL PAJOB(NSJ0,NPJ0)
C-----  OCOBPEMEHiM TAblO diCKOB/lEHT
        CALL PADT(NSD0,NPD0)
C-----  OCOBPEMEHiM TAblO TEPMiHAlx}iKOB
        CALL PATER(NST0,NPT0)
C-----
        CALL POSOUT(':',1,1,46)
        CALL TEINP1
        CALL DDPAUS(KVANT)
        IF(CHINP1(1).NE.0) EXIT
      REPEAT
C
C=====   BBOd i AHAliz pPiKAzA
C
      CALL POSOUT(':           ',12,1,46)
      CALL POSOUT(':',1,1,46)
      CALL TEINP(ICOM,52)
      IF(COM.EQ.'STOP') THEN
        CALL POSOUT('KOHEc "PANNO"',13,22,1)
        CALL CLOSTE
        STOP
      ELSE IF(COM(1:3).EQ.'DT=') THEN
        CALL DECNU(ICOM,KV)
        IF(KV.EQ.0) GOTO 900
        KVANT=KV
      ELSE IF(COM.EQ.'CLEA') THEN
        CALL TECLEA $ GOTO 1
      ELSE $ GOTO 900
      END IF
      GOTO 10
900   CALL POSOUT('????',4,1,54)
      GOTO 10
      END
      SUBROUTINE A002PN(NS0,NP0)
C
C*****   C i C T E M A   "P A N N O"
C*       p/p  "PAJOBI"
C*
C*       iHiciAciq  p A H H O  z A d A ~
C*
      COMMON /TABJ/JOB0
      COMMON /WORK/JOB,STR,NAM,BP
      INTEGER JOB0(5,24),JOB(5,24),STR(5)
     * , NAM(3),BP(3)
      CHARACTER TSH*4,TNA*18,CS*30,TBP*14
      EQUIVALENCE (STR,CS),(ISH,TSH)
     * , (NAM,TNA),(BP,TBP)
C=====
      ENTRY PAJOBI
      DO (I=1,24)
        JOB0(1,I)=0
      REPEAT
      CALL POSOUT('z A d A ~ i',11,NS0,NP0+4)
      RETURN
C*
C*****   p/p   "PAJOB"
C*
C*       p A H H O   z A d A ~
C*
      ENTRY PAJOB
C=====
      CALL DDJOB(JOB)
      DO (J=1,24) $ NJ=JOB(1,J)
        NJ1=NJ $ IF(NJ.GT.32) NJ1=NJ-32
        NJ0=JOB0(1,J)
        IF(NJ0.GT.32) NJ0=NJ0-32
        CALL ENCSH(NJ1,ISH)
        M0=0 $ IF(NJ1.NE.NJ0) M0=1
        M1=0 $ IF(JOB(2,J).NE.JOB0(2,J)) M1=1
        M2=0 $ L=30
        DO (I=1,3)
          NAM(I)=JOB(I+2,J)
          IF(NAM(I).NE.JOB0(I+2,J)) M2=1
        REPEAT
        IF(M0.NE.0) THEN
C=====    {ifPy HE COBpAli
          IF(NJ.EQ.0) THEN
C.....      zAdA~A KOH~ilACx
            CS=' '
          ELSE IF(NJ.GT.32) THEN
C.....      i p z  B  pOdKA~KE
            CS=TSH(1:3) // '*'
          ELSE IF(NJ.GT.16) THEN
C.....      ClYvEbHAq  zAdA~A
            CS=TSH // TNA
          ELSE
C.....      pOlxzOBATElxCKAq zAdA~A
            CALL TICOD2(JOB(2,J),BP)
            CS=TSH//TBP//TNA(1:12)
          END IF
          CALL POSOUT(STR,L,NS0+J,NP0)
        ELSE
C=====    {ifPy COBpAli
          IF(NJ.EQ.0) EXIT
          L=27
          IF(NJ.GT.32) THEN
C.....      i p z  B  pOdKA~KE
            IF(JOB0(1,J).GT.32) THEN
              L=0
            ELSE
              CS(1:1)='*' $ L=1
            END IF
          ELSE IF(NJ.GT.16) THEN
C.....      ClYvEbHAq zAdA~A
            L=M2
            IF(L.NE.0) THEN
              CS=':'//TNA $ L=19
            END IF
          ELSE
C.....      pOlxzOBATElxCKAq zAdA~A
            IF(M1+M2.NE.0) THEN
              CALL TICOD2(JOB(2,J),BP)
              CS=':'//TBP//TNA(1:12)
              IF(M2.EQ.0) L=14
            ELSE
              L=0
            END IF
          END IF
          IF(L.GT.0)
     *      CALL POSOUT(STR,L,NS0+J,NP0+3)
        END IF
        DO (I=1,5) $ JOB0(I,J)=JOB(I,J) $ REPEAT
      REPEAT
      RETURN
      END
      SUBROUTINE A003PN(NS0,NP0)
C*
C*****   C i C T E M A   "P A N N O"
C*       p/p  "PADTI"
C*
C*       iHiciAciq   p A H H O   diCKOB/lEHT
C*
      COMMON /TABDT/TDT0
      COMMON /WORK/TDT,STR,IS1
      INTEGER TDT0(8,6),TDT(8,6),STR(9),IS1(2)
      CHARACTER TNJ*3,CIW*4,CS1*12,TS*54
      BIT*48 BIW
      EQUIVALENCE (IW,BIW,CIW),(IS1,CS1)
     * , (TS,STR),(INJ,TNJ)
C=====
      ENTRY PADTI
      DO (J=1,6) $ DO (I=1,8)
        TDT0(I,J)=0
      REPEAT $ REPEAT
      CALL POSOUT(
     *'  Md-3    Md-4    Mf-3    Mf-4    Mf-5    Mf-6'
     * , 46,NS0,NP0)
      DO (I=1,8) $ I1=I-1
        CALL ENCSH(I1,IW)
        TS=CIW(3:3)//
     *'*       *       *       *       *       *'
        CALL POSOUT(STR,42,NS0+I,NP0)
      REPEAT
      RETURN
C*
C*****   p/p  "PADT"
C*
C*       p A H H O   diCKOB / lEHT
C*
      ENTRY PADT
      CALL DDDITA(TDT)
      DO (J=1,6) $ DO (I=1,8)
        IW=TDT(I,J) $ NJ=IBIT(BIW(37:48))
        IF(IW.NE.TDT0(I,J)) THEN
          IF(IW.EQ.0) THEN
            CS1=' '
          ELSE IF(NJ.EQ.0) THEN
            CS1=CIW
          ELSE IF(NJ.EQ.32) THEN
            CS1=CIW // 'SYS'
          ELSE IF(NJ.EQ.64) THEN
            CS1=CIW // '-gT'
          ELSE
            CALL ENCSH(NJ,INJ)
            CS1=CIW//TNJ
          END IF
          CALL POSOUT(IS1,7,NS0+I,NP0+J*8-6)
          TDT0(I,J)=IW
        END IF
      REPEAT $ REPEAT
      RETURN
C=====
      END
      SUBROUTINE A004PN(NS0,NP0)
C*
C*****   C i C T E M A   "P A N N O"
C*       p/p  "PATERI"
C*
C*       iHiciAciq  TAblO  TEPMiHAlx}iKOB
C*
      COMMON /TABT/TER0
      COMMON /WORK/TER,STR,IS1
      INTEGER TER0(4,8,2),TER(4,8,2),STR(8)
     * , IS1(4),FI(2),TY
      CHARACTER CS1*24,FIC*12,TYC*6,CIW*4
      EQUIVALENCE (IS1,CS1),(FI,FIC),(TY,TYC)
     * , (IW,CIW)
C=====
      ENTRY PATERI
      DO (I=1,8)$DO (J=1,2)$DO (K=1,4)
        TER0(K,I,J)=0
      REPEAT $ REPEAT $ REPEAT
      CALL POSOUT(
     *'MYlxTiTAjp             PEdAKTOP'
     * , 31,NS0,NP0)
      CALL DDTERI
      RETURN
C*
C*****   p/p  "PATER"
C*
C*       TAblO  TEPMiHAlx}iKOB
C*
      ENTRY PATER
      CALL DDTER(TER)
      DO (J=1,2) $ DO (I=1,8)
        NC=TER(1,I,J) $ TY=TER(2,I,J)
        FI(1)=TER(3,I,J) $ FI(2)=TER(4,I,J)
        DO (K=1,4) $ M=K
          IF(TER(K,I,J).NE.TER0(K,I,J)) EXIT
          M=0
        REPEAT
        IF(M.NE.0) THEN
          IF(NC.EQ.0) THEN
            CS1=' '
          ELSE
            CALL ENCSH(NC,IW)
            CS1=CIW(2:3)//':'//TYC//' '//FIC
          END IF
          CALL POSOUT(IS1,22,NS0+I,NP0+(J-1)*23)
          DO (K=1,4)
            TER0(K,I,J)=TER(K,I,J)
          REPEAT
        ELSE
          IF(NC.EQ.0) EXIT
        END IF
      REPEAT $ REPEAT
      RETURN
C=====
      END
      SUBROUTINE A01DMP(KOD,ADR,MAC,LG)
       INTEGER KOD,ADR,MAC(LG),LG
       INTEGER IR $ BIT*48 BR
       EQUIVALENCE (IR,BR)
       COMMON /LISTS/ LIST1(1024),LIST2(1024)
C
      ENTRY COPMEM
       IR = ADR
       IAD = IBIT(BR(39:48))+1
       IZN = IBIT(BR(34:38))
       CALL READZN(IZN,KOD)
       DO (I=1,LG)
         IF (IAD .GT. 1024) THEN
           IZN = IZN+1
           IAD = 1
           CALL READZN(IZN,KOD)
         ENDIF
         IF (KOD .EQ. 1) THEN
           MAC(I) = LIST1(IAD)
         ELSE
           MAC(I) = LIST2(IAD)
         ENDIF
         IAD = IAD+1
       REPEAT
      END
      SUBROUTINE A02DMP
C
       COMMON /PARAM/ FLPAR,VER,DRUM
       INTEGER VER,DRUM,FLPAR
       DATA FLPAR /0/
C
       COMMON /PROTO/AP,NUNIT,NL,NF,INT,KAP(15)
C
       COMMON /bAzy/NZ1,NZ2,FDB(8),NZV,MB,NR1,NRL
C
       COMMON /FLGS/FLZK,FL1
       LOGICAL FLZK,FL1
C
       COMMON /LISTS/ LIST1(1024),LIST2(1024)
       INTEGER LST(2,1024)
       BIT*48 BLST(2,1024),BLI(1024)
       EQUIVALENCE (LST,LIST1,BLST,BLI)
C
       COMMON /TPp/ TRP(2,1024)
       INTEGER TRP $ BIT*48 BTRP(2,1024)
       EQUIVALENCE (BTRP,TRP)
C
       COMMON /TPp1/ TRP1(2,2)
       INTEGER TRP1
C
       RECORD /TTTT(AT)/ NMT,FLP,LGP,ADRES
       BIT FLP*18,LGP*15,ADRES*15
C
       RECORD /CTYC(AY)/NJ,RR,N{,Nli,RAD
       BIT NJ*6,RR*12,N{*15,Nli*5,RAD*10
     *   , Aipz*15,LEF*24,RIG*24
       EQUIVALENCE (Aipz,Nli),(LEF,NJ)
     * , (RIG(1:1),N{(7:7))
C
       INTEGER IR $ BIT*48 BR,BNPl
       EQUIVALENCE (IR,BR),(NPl,BNPl)
C
       INTEGER ANRPC,AYCy,ANRP1,ANRAB,ANPl
       INTEGER TNRPC(0:31),TYCy(0:47)
C
       INTEGER IS1(10),IC30(10),BLAN,dHz
       CHARACTER S1*60,S1C(60),S2(6)
     * , C30(2)*30,C60*60
       EQUIVALENCE (IS1,S1,S1C),(IS2,S2)
     * , (IC30,C30,C60)
C
       INTEGER N3(3) $ BIT*8 BN3(18)
       CHARACTER CN3(18)
       EQUIVALENCE (N3,CN3,BN3)
C
       INTEGER HEAD(10)
       INTEGER TITLE(9)
        DATA TITLE/
     + 'AdPEC   iMq    CME}.       D U M P  ' ,
     + '           |TAlOH'/
C
       DATA FLZK,FL1/2*.TRUE./
       DATA ANRPC,ANPl/9,63/ , BLAN/' '/
       DATA NYCy,NNRP1,NNRAB /
     +    O'12 71 43 37 00 00 00 00'
     +  , O'12 56 62 60 21 00 00 00'
     +  , O'53 57 50 50 07 40 00 00'
     +  /
C
      ENTRY DIFER
       CALL DIALOP(0) $ CALL CONBIL(0)
       IF (FLPAR .NE. 0) THEN
         IF ((DRUM .LT. 8) .OR. (DRUM .GT. 31)
     +       .OR. (VER .GT. 3)) THEN
           CALL DIALOG('HAbOP: <BEPCiq> <Mb>',24,-1)
           STOP
         ENDIF
         IR = VER
         MB = DRUM
         GOTO 10
       ENDIF
       DO
         CALL DIALOQ('HOMEP Mb DUMP''A ?',18,0)
         K=ITXTOB(KAP,1,24,MB,IBIT(O'27'))
         IF(K.EQ.0 .AND. MB.GE.8) EXIT
         CALL DIALOG('HE byBAET',9,-1)
       REPEAT
       DO
         CALL DIALOQ('N BEPCii OC ?',14,0)
         K=ITXTOB(KAP,1,24,IR,3)
         IF(K.EQ.0) EXIT
         CALL DIALOG('pOBTOPi',7,-1)
       REPEAT
 10    K = JFOCC('T9/MONSYS',FDB)
       IF (K .NE. 0) THEN
 30      CALL DIALOG(FDB(4),18,-1)
         CALL DIALOG('STOP',4,-1)
         STOP
       ENDIF
       CALL NEWNAM(IR,MB)
       MB = MB * 4096
       NZV = IBIT(O'440')+IR*32
C
C === fOPMiPOBAHiE TPp
C
       K=JFEX1(FDB,LIST1,30+NZV,'R')
     * + JFEX1(FDB,LIST2,31+NZV,'R')
       IF(K.NE.0) GOTO 30
C-----   ByBEdEM zAgOlOBOK
       CALL PUTTIT(0,0)
       CALL PRBLAN(2)
       CALL PRT('                       P A z H i c A',6)
       CALL PRBLAN(1)
       ENCODE (60,990,HEAD) IR
990    FORMAT(14X'p O   'I1' - j   B E P C i i   O C')
       CALL PRT(HEAD,10)
       CALL PRBLAN(2)
C-----   HAjdEM KOHEc zAdAHHOj TPp
       DO (I=1,1024) $ K = I
         IF (BTRP(1,I) .EQ. B'') EXIT
       REPEAT
C-----   pPOpYCTiM TPp PEzidEHTA MOHiTOPA
       DO (I=1,1024) $ K1 = I
         AT = ADDR(LST(1,I))
         IF(IBIT(ADRES).GE.IBIT(O'1000')) EXIT
       REPEAT
C-----   pEPEpi{EM TPp DD ClEdOM zA zAdAHHOj
       DO (I=K1,1024)
         TRP(1,K) = LST(1,I)
         TRP(2,K) = LST(2,I)
         IF(BLST(1,I).EQ.B'') EXIT
         K = K+1
       REPEAT
C
C-----   ByTA}iM KOE-~TO iz DUMP'A
C
C-----   TAblicY   " * Y C y "
       AYCy=METADR(NYCy,K,K)
       CALL COPMEM(1,AYCy,TYCy,48)
C-----   q~EjKY   "N P A b l i C T"
       CALL COPMEM(1,ANPl,NPl,1)
C-----   TAblicY HEPEzidEHTOB
       CALL COPMEM(1,ANRPC,TNRPC,32)
C-----   AdPECA : *NRP1 , KOHHiz
       ANRP1=METADR(NNRP1,K,K)
       ANRAB = METADR(NNRAB,K,K)
C-----   HEKOTOPyE HOMEPA liCTOB
       IR=ANRP1 $ NR1=IBIT(BR(34:38))
       IR=ANRAB $ NRL=IBIT(BR(34:38))
C
C*****   pE~ATx  2-X  ~ACTEj  PEzidEHTA
C
       LIMA=IBIT(O'500') $ IZA = IBIT(O'500')
100    IZ1=0 $ IZ2=NR1-1 $ IZD=0
       FL1 = .TRUE. $ CALL PUTTIT(TITLE,7)
       DO (M=1,2)
         ENCODE(60,1000,IS1) M
1000     FORMAT(18X'***   PEzidEHT - 'I1'   ***')
         CALL IFPAGE(5) $ CALL PRBLAN(1)
         CALL PRT(IS1,10)
         DO (IZ=IZ1,IZ2)
           CALL READZN(IZ,1)
           CALL READZN(IZ+IZD,2)
           DO (I=IZA,1024)
             IF (FL1 .AND. (I.GT.LIMA)) THEN
               FL1 = .FALSE.
               CALL PUTTIT(TITLE,9)
             ENDIF
             IF(LIST1(I) .NE. LIST2(I))
     *         CALL PRIDIF(IZ,I-1,LIST2(I),LIST1(I))
           REPEAT
           IZA = 1
         REPEAT
         IZ1=28 $ IZ2=31 $ IZD=NRL+1-IZ1
       REPEAT
C
C*****   pE~ATx  HEPEzidEHTHyX  liCTOB
C
       DO (M=NR1,NRL) $ IR=TNRPC(M)
         IZ=IBIT(BR(44:48))
         IF(IZ.NE.0) THEN
           NN=M-NR1+1 $ IZA=IZ*1024
           ENCODE(60,1010,IS1) NN,IZA
1010       FORMAT(16X'***   *NRP'I3'   fA='O5'   ***')
           CALL IFPAGE(6) $ CALL PRBLAN(1)
           CALL PRT(IS1,10)
           CALL READZN(IZ,1)
           CALL READZN(M,2)
           DO (I=1,1024)
             IF(LIST1(I).NE.LIST2(I))
     *       CALL PRIDIF(M,I-1,LIST2(I),LIST1(I))
           REPEAT
         END IF
       REPEAT
       CALL IFPAGE(100)
       FLZK= .NOT. FLZK $ IZA = 65
       IF(.NOT.FLZK) GOTO 100
C
C*****   pOpE~ATAEM   i p z
C
       DO (dHz=24,47) $ AY=ADDR(TYCy(dHz))
         IF(N{.NE.B'' .AND. Aipz.NE.B'') THEN
           IZ=IBIT(Nli) $ I{=IBIT(N{)
           CALL READZN(IZ,1)
           LL=128 $ IF(dHz.GE.32) LL=1024
           IB=IBIT(RAD)-2 $ IE=IB+LL-1
           DO (I=1,3) $ N3(I)=LIST1(IB+82+I) $ REPEAT
           DO (I=18,1,-1)
             IF(BN3(I).EQ.B'') CN3(I)=' '
           REPEAT
           I1=IBIT(LEF) $ I2=IBIT(RIG)
           ENCODE(60,1002,IS1) I{,I1,I2,N3
1002       FORMAT(3X'i p z  {'O2'  YC='O8,X,O8
     *          , 2X,3A6)
           CALL PRBLAN(1)
           CALL PUTTIT(IS1,10)
           DO (I=IB,IE) $ IR=LIST1(I)
             IF(BR.NE.B'') THEN
               NN=I-IB-3
               I1=IBIT(BR(1:24))
               I2=IBIT(BR(25:48))
               ENCODE(30,1003,IS1) NN,I1,I2
1003           FORMAT(X,O4':'O8,X,O8)
               CALL PRT4(IS1,5)
             END IF
           REPEAT
         END IF
       REPEAT
C
       IF(BNPl.NE.B'') THEN
C
C*****   BydA~A   0-gO  liCTA  MYlxTiTAjpA
C
         CALL IFPAGE(100) $ CALL PUTTIT(TITLE,7)
         CALL PRT(
     +    '****  0-j liCT  M Y l x T i T A j p A   ****',8,)
         DO (I=1,1024)
           TRP(1,I)=TRP1(1,I)
           TRP(2,I)=TRP1(2,I)
           IF(BTRP(1,I).EQ.B'') EXIT
         REPEAT
         IZ=IBIT(BNPl(34:38))
         CALL READZN(IZ,1) $ FL1=.TRUE.
         DO (I=32,1023)
           IF(BLI(I).NE.B'')
     *       CALL PRIDIF(0,I-1,0,LIST1(I))
         REPEAT
       END IF
C=====
       CALL PRTEND
       RETURN
      END
      INTEGER  FUNCTION A09DMP(/TXT/,NB,NE,BIN,MAX)
       RECORD /TEXT(TXT)/ SYM(80)
       CHARACTER SYM*1
       INTEGER BIN
C
      ENTRY ITXTOB
       A09DMP = 0
       BIN = 0
       DO (I=NB,NE)
         K = ICHAR(SYM(I))
         IF (K .EQ. 0) THEN
           IF (MAX .LT. 0) RETURN
           IF (BIN .GT. MAX) A09DMP = 1
           RETURN
         ENDIF
         IF (SYM(I) .NE. ' ') THEN
           IF ((SYM(I) .LT. '0') .OR.
     +         (SYM(I) .GT. '7')) THEN
             A09DMP = 1
           ELSE
             BIN = BIN*8 + K - ICHAR('0')
           ENDIF
         ENDIF
       REPEAT
       A09DMP = 1
      END
      INTEGER FUNCTION A08DMP(NAME,TIP,LG)
C
C   NAME - iMq Ob'EKTA B TPp
C   TIP  = 1 - iMq MOdYlq
C        = 2 - COMMON-blOK
C        = 3 - ENTRY
C   LG   - dliHA MOdYlq ili COMMON'A,
C          dlq ENTRY - iMq MOdYlq
C   METADR = 0 - HET iMEHi B TPp, iHA~E
C                AdPEC Ob'EKTA
C
       INTEGER NAME,TIP,LG
       INTEGER NMDL
       RECORD /TTTT(AT)/ NMT,FLP,LGP,ADRES
       INTEGER NMT
       BIT FLP*18,LGP*15,ADRES*15
C
       COMMON /TPp/ TRP(2,1024)
       INTEGER TRP
       BIT*48 BTRP(2,1024)
       EQUIVALENCE (BTRP,TRP)
C
C=== pOiCK B TPp
C
      ENTRY METARD
       A08DMP = 0
       DO (I=1,1024)
         IF (BTRP(1,I) .EQ. B'') EXIT
         AT = ADDR(TRP(1,I))
         IF (NMT .EQ. NAME) THEN
           A08DMP = IBIT(ADRES)
           LG = IBIT(LGP)
           IF(FLP .NE. B'') THEN
             TIP = 1
           ELSE IF(LGP.NE.B'') THEN
             TIP = 2
           ELSE
             TIP = 3
             DO
               IF(FLP.NE.B'') EXIT
               AT=RELOC(AT,-2)
             REPEAT
             LG = NMT
           ENDIF
           EXIT
         ENDIF
       REPEAT
      RETURN
      END
      SUBROUTINE A03DMP(IAD,NAME,SHF)
       INTEGER IAD,NAME,SHF
       RECORD /TTTT(AT)/ NMT,FLP,LGP,ADR
       BIT FLP*18,LGP*15,ADR*15
       COMMON /TPp/ TRP(2,1024)
       INTEGER TRP $ BIT*48 BTRP(2,1024)
       EQUIVALENCE (BTRP,TRP)
C
C=== pOiCK B TPp
C
      ENTRY NMTXT
       DO (I=1,1024)
         IF (BTRP(1,I) .EQ. B'') EXIT
         AT = ADDR(TRP(1,I)) $ IA1=IBIT(ADR)
         IF (IAD.LE.IA1) THEN
           IF(IAD.LT.IA1) AT=RELOC(AT,-2)
C-----     HAjdEM glABHyj BXOd
           DO
             IF(FLP.NE.B'' .OR. LGP.NE.B'') EXIT
             AT = RELOC(AT,-2)
           REPEAT
C-----
           NAME=NMT $ SHF=IAD-IBIT(ADR) $ EXIT
           EXIT
         ENDIF
       REPEAT
       RETURN
      END
      SUBROUTINE A04DMP(NZ,ADR,LS1,LSD)
       INTEGER NZ,ADR,LS1,LSD
C
       COMMON /FLGS/FLZK,FL1
       LOGICAL FLZK,FL1,FLIPZ
C
       INTEGER TXT(10),NAM(2),SHF
     *       , NAME,LTP,LGN,BLAN,TY(2)
       BIT*48 BR $ EQUIVALENCE (IR,BR)
       CHARACTER CNAM1,NAM6*6
       EQUIVALENCE (CNAM1,NAM,NAM6)
       DATA BLAN/' '/ , NMDL/0/ , TY/' ','=LC'/
C
      ENTRY PRIDIF
       IR=LS1
       IF(FLZK .AND. BR.EQ.B'') RETURN
       I1=IBIT(BR(1:24)) $ I2=IBIT(BR(25:48))
       IR=LSD
       I3=IBIT(BR(1:24)) $ I4=IBIT(BR(25:48))
       LADR=NZ*1024+ADR $ IDA=0
       IF(LADR.GE.IBIT(O'70000')) IDA=2048
       CALL NMTXT(LADR-IDA,NAME,SHF)
       LADR=LADR-SHF
       IR = METADR(NAME,LTP,LGN)
       CALL TXTASC(NAME,NAM)
       IF (LGN.LE.1.AND.LTP.EQ.2) THEN
         CALL IFPAGE(2) $ CALL PRBLAN(1)
         IF(.NOT.FL1) THEN
           ENCODE(60,1000,TXT) LADR,NAM,I3,I4,I1,I2
1000       FORMAT (O5,1X,A6,A2,' LC*1',2X,2(1X,O8),2X,2(1X,O8))
         ELSE
           ENCODE(60,1000,TXT) LADR,NAM,I3,I4
         END IF
         NMDL=0 $ CALL PRT(TXT,10)
         RETURN
       ELSE IF(NMDL.NE.NAME) THEN
         NMDL=NAME $ CALL IFPAGE(4) $ CALL PRBLAN(1)
         ENCODE (60,1001,TXT) LADR,NAM,LGN,TY(LTP)
1001     FORMAT (O5,1X,A6,A2,X,O4,A3)
         CALL PRT(TXT,10)
       ENDIF
       FLIPZ=CNAM1.EQ.'(' .OR. NAM6.EQ.'BUFTRA'
       IF(FL1 .OR. FLIPZ) THEN
         IF(FLIPZ) SHF=SHF-1
         ENCODE(60,1002,TXT) SHF,I3,I4
       ELSE
         ENCODE(60,1002,TXT) SHF,I3,I4,I1,I2
1002     FORMAT(15X,O4,2X,2(X,O8),2X,2(X,O8))
       END IF
       CALL PRT(TXT,10)
       RETURN
      END
      SUBROUTINE A05DMP(TXT,N)
       PARAMETER (MAXPAG=66,BIGPAG=MAXPAG-1)
       PARAMETER (P8=8)
       INTEGER TXT(10),N
       INTEGER ISTR,IPAGE,LPAGE,RET
       INTEGER PAG4(5,P8),STR(10),IST4
       LOGICAL FL4,FP2
       INTEGER NTIT,TIT(10)
       INTEGER BLAN $ DATA BLAN/'  '/
       LOGICAL FTIT
       DATA ISTR,IPAGE,LPAGE,NTIT, FTIT
     +    /   1,    0, BIGPAG, 0, .TRUE./
       DATA FL4 /.FALSE./
C
      ENTRY PRT
       ASSIGN 10 TO RET
       GOTO 444
 10    ASSIGN 11 TO RET
       GOTO 111
 11    CALL BILISN(TXT,N,1)
       IF (ISTR .EQ. LPAGE) ISTR = 0
       ISTR = ISTR + 1
       RETURN
C **********************
      ENTRY PUTTIT
C **********************
       FTIT = .TRUE. $ NTIT = N
       IF (NTIT .GT. 10) NTIT = 10
       IF (NTIT .LE. 0) THEN
         NTIT = 0 $ RETURN
       ENDIF
       DO (I=1,NTIT)
         TIT(I) = TXT(I)
       REPEAT
       RETURN
C **************************
      ENTRY PRT4
C **************************
       NTS = N
       IF (NTS .GT. 5) NTS = 5
       IF (.NOT. FL4) THEN
         FL4 = .TRUE.
         FP2 = .FALSE.
         IST4 = 1
         LRB = P8+1
         ASSIGN 20 TO RET
         GOTO 333
 20      ASSIGN 21 TO RET
         GOTO 111
 21      LRB = 1
         ASSIGN 22 TO RET
         GOTO 222
       ENDIF
 22    IF (FP2) THEN
         DO (J=1,5)
           STR(J) = PAG4(J,IST4)
         REPEAT
         DO (J=1,NTS)
           STR(5+J) = TXT(J)
         REPEAT
         CALL BILISN(STR,5+NTS,1)
         IF (ISTR .EQ. LPAGE) ISTR = 0
         ISTR = ISTR+1
       ELSE
         DO (J=1,5) $ PAG4(J,IST4)=BLAN $ REPEAT
         DO (J=1,NTS)
           PAG4(J,IST4) = TXT(J)
         REPEAT
       ENDIF
       IF (IST4 .EQ. P8) THEN
         IF (FP2) THEN
           FL4 = .FALSE.
         ELSE
           FP2 = .TRUE.
           IST4 = 1
         ENDIF
       ELSE
         IST4 = IST4+1
       ENDIF
       RETURN
C ************************
      ENTRY PRTEND( )
C ************************
       ASSIGN 40 TO RET
       GOTO 444
 40    CALL CONBIL(1)
       RETURN
C **************************
      ENTRY PRBLAN(NBL)
C **************************
       LRB = NBL
       ASSIGN 50 TO RET
       GOTO 444
 50    ASSIGN 51 TO RET
       GOTO 222
 51    RETURN
C ***************************
      ENTRY IFPAGE(NSTR)
C ***************************
       ASSIGN 60 TO RET
       GOTO 444
 60    LRB = NSTR
       ASSIGN 51 TO RET
       GOTO 333
C*****************************
C******  pOdpPOgPAMMy  *******
C*****************************
C ===
C === pE~ATx zAgOlOBKA CTPAHicy
C ===
 111   IF (ISTR .EQ. 1) THEN
         IPAGE = IPAGE+1
         FTIT = .TRUE.
         IF(IPAGE .GT. 2) LPAGE = MAXPAG
       ENDIF
       IF (FTIT .AND. (NTIT .NE. 0)) THEN
         IF (LPAGE-ISTR .LE. 5) THEN
           ISTR = 1
           CALL CONBIL(2)
           GOTO 10
         ENDIF
         IF (ISTR .NE. 1) THEN
           ISTR = ISTR+1
           CALL BILIST(-1)
         ENDIF
         CALL BILISN(TIT,NTIT,1)
         CALL BILIST(-1)
         ISTR = ISTR+2 $ FTIT = .FALSE.
       ENDIF
       GOTO RET
C ===
C === pYCTyE CTPOKi
C ===
 222   IF (ISTR .EQ. 1) GOTO RET
       IF (LPAGE-ISTR .LE. NBL) THEN
         CALL CONBIL(2)
         ISTR = 1
       ELSE
         CALL BILIST(-NBL)
         ISTR = ISTR+NBL
       ENDIF
       GOTO RET
C ===
C === PEzEPBiPOBAHiE MECTA HA CTPAHicE
C ===
 333   IF (LPAGE-ISTR .LT. LRB) THEN
         CALL CONBIL(2)
         ISTR = 1
       ENDIF
       GOTO RET
C ===
C === dOCbPOC MAlOgO bYfEPA
C ===
 444   IF (FL4) THEN
         IF (FP2) THEN
           DO (I=IST4,P8)
             CALL BILISN(PAG4(1,I),5,1)
           REPEAT
           FP2 = .FALSE.
           ISTR = ISTR+P8-IST4+1
         ELSE
           IF (ISTR .NE. 1) THEN
             CALL BILIST(-1)
             ISTR = ISTR+1
           ENDIF
           DO (I=1,IST4-1)
             CALL BILISN(PAG4(1,I),5,1)
           REPEAT
           ISTR = ISTR+IST4-1
         ENDIF
         FL4 = .FALSE.
         IST4 = 1
       ENDIF
       GOTO RET
      END
      SUBROUTINE A06DMP (ZONA,KOD)
C
C  KOD = 1 - ~TEHiE C DUMP'A
C  KOD = 2 - ~TEHiE C |TAlOHA
C
       INTEGER ZONA,KOD
       COMMON /bAzy/ NZ1,NZ2,FDB(8),NZV,MB
       COMMON /LISTS/ LIST1(1024),LIST2(1024)
C
      ENTRY READZN
       GOTO (10,20),KOD
 10    IF (NZ1 .EQ. ZONA) RETURN
       CALL RFE70(MB+ZONA,LIST1) $ NZ1 = ZONA
       RETURN
 20    IF (NZ2 .EQ. ZONA) RETURN
       IF (JFEX1(FDB,LIST2,NZV+ZONA,'R') .NE. 0) THEN
         CALL DIALOG(FDB(4),18,-1)
         ENCODE (18,100,FDB) ZONA
 100     FORMAT ('~iTAli zOHY ',O4)
         CALL DIALOG(FDB,18,-1)
         STOP
       ENDIF
       NZ2 = ZONA
      END
      SUBROUTINE A07DMP (/ATXT/,/AISO/)
       RECORD /PAR1(ATXT)/ TEXT(8)
       BIT*6 TEXT
C
       RECORD /PAR2(AISO)/ ISO(12)
       CHARACTER ISO
C
       CHARACTER ALF(64)
       INTEGER MALF(11)
       EQUIVALENCE (ALF,MALF)
       DATA MALF/
     1   ' !bcdfgi()*j'
     2  ,'lqv/01234567'
     3  ,'89x;p-+yzABC'
     4  ,'DEFGHIJKLMNO'
     5  ,'PQRSTUVWXYZ{'
     6  ,'|}~`  '
     +  /
C
      ENTRY TXTASC
       DO (I=1,8)
         K = IBIT(TEXT(I))
         ISO(I) = ALF(K+1)
       REPEAT
      END
*FTN
      SUBROUTINE BEGCAT(KDAT,KBOSS)
      COMMON /PAGE/ M(1024)
      COMMON /MER/ NER,MER(63)
      COMMON /LINK/ NAMDIS,NCHANA,MOD,NPATH,IFL,NR,KOPC
      COMMON /TD/NH,NPZ(5)
      DO 1 J=5,1024
    1 M(J)=0B
      M(1)=1744B
      IF(NH.EQ.20)M(1)=1747B
      M(2)=KBOSS
      M(3)=KDAT
      M(4)=1B
      NPATH=0$ CALL WRITE
      NPATH=2$ CALL WRITE
      DO 2 J=1,4
      M(J+1020)=M(J)
    2 M(J)=0B
      M(1020)=NER
      DO 3 I=1,NER
      J=1020-I
    3 M(J)=MER(I)
      NPATH=1$ CALL WRITE
      NPATH=3$ CALL WRITE
      RETURN
      END
      SUBROUTINE BEGDF
C
C  OpPEdElEHiE dATy pPOTOKOlA,
C KOl-BA zAHqTyX zOH
C B fAjlE iHv. CTATiCTiKi
C i pE~ATx zAgOlOBKA.
C
         INTEGER TY1,TY2
      COMMON/RGM61/LPFL(4)
     */TBUF/IB(10),LEN
      DATA(IBL=1H )
      COMMON/ONE/TY1,TY2(19)
      COMMON/NZON/NZON,NEL
      COMMON/PRISN/MEND(8)
      COMMON/GEN/{Ap(6),Y(30)
      EQUIVALENCE({Ap(3),IDAT)
        EQUIVALENCE(MEND(2),MNZ)
      DIMENSION MW(144)
       DIMENSION ID1(2),ID2(2)
      DATA IFLFT/0/
      CALL dAjH~1
   10 CALL dAj|l1
      IF(MNZ.EQ.0) GOTO 11
      NZON=NZON+1
      MNZ=0
   11 CONTINUE
      IF(MEND.NE.0) GOTO 100
      IF(IFLFT.EQ.0) GOTO 12
   13 IF(TY1.LE.8) GOTO 10
      NEL=NEL+1
      GOTO 10
   12 IDB=IDAT
      IFLFT=1
        GOTO13
  100 MEND=0
      IDE=IDAT
      IF(LPFL.EQ.0) GOTO 777
      IB=IBL $ LEN=1
      CALL PRT1
      CALL PRT1
      ENCODE(46,201,IB)
  201 FORMAT(19X,27(1H*))
      LEN=8
      CALL PRT1
      ENCODE(46,202,IB)
  202 FORMAT(19X,1H*,25X,1H*)
      CALL PRT1
      ENCODE(46,203,IB)
  203 FORMAT(19X,1H*,8X,'pPOTOKOl',9X,1H*)
      CALL PRT1
      ENCODE(46,204,IB)
  204 FORMAT(19X,1H*,2X,21HPAbOTy OC 'd Y b H A',2X,1H*)
      CALL PRT1
      IF(IDB.NE.IDE) GOTO 1000
      CALL KOddAT(IDB,ID1)
      ENCODE(46,99,IB)ID1
      CALL PRT1
      GOTO 1001
 1000 CALL KOddAT(IDB,ID1)
      CALL KOddAT(IDE,ID2)
  199 FORMAT(19X,1H*,3X'('A6,A2'-'A6,A2')'3X,1H*)
   99  FORMAT(19X,1H*,7X'('A6,A2')'8X,1H*)
      ENCODE(46,199,IB)ID1,ID2
      CALL PRT1
 1001 CONTINUE
      ENCODE(46,202,IB)
      CALL PRT1
      ENCODE(46,201,IB)
      CALL PRT1
      IB=IBL
      LEN=1
      DO 207 I=1,3
  207 CALL PRT1
 3000 FORMAT(1H1)
  777 CONTINUE
      RETURN
      ENTRY NEWPG
      PRINT 3000
      RETURN
      END
      SUBROUTINE ByBKAT(IOBJ)
C.
C...      pPOgPAMMA dlq OpPEdElEHiq i BydA~i XAPAKTEPiCTiK
C.
C.       LENTH          --   dliHA Ob'EKTA
C.       ITPKAT         --   Tip Ob'EKTA
C.       LADRES         --   AdPEC Ob'EKTA B OzY
C. --------------------------------------------------------
      COMMON /PAR42z/ IFRAG , ITYP  , KOD   , IGO   , IANSW(10)
     +,               LQUEST, I~Y{x , ITERMS, ITERMD, NO
     +,               IYES  , LENTH , ITPKAT, LANSW , LADRES
     +,               NAME(2),IQUEST(4,10),IDFLAS(10)
      DIMENSION IFRAG(15)
       DIMENSION STRI(15)
      DIMENSION LAdPEC(2), LdliHA(2)
      DATA LAdPEC /' AdPEC:'/
     +,     LdliHA /' dliHA: '/
       LADRES = JBYT(IOBJ,1,15)
       LENTH  = JBYT(IOBJ,16,15)
      IF (LADRES .GE. 26624)  LADRES=LADRES+2048
C
C
C
      CALL PUTH(STRI,NAME,1,8,M,IPOZ)
      CALL PUTH(0,LAdPEC,1,8,M,IPOZ)
      CALL PUTO(0,LADRES,1,5,5,IPOZ)
      CALL PUTH(0,LdliHA,1,8,M,IPOZ)
      CALL PUTO(0,LENTH,1,5,5,IPOZ)
      CALL DIALOG(STRI,36,-1)
      RETURN
      END
      SUBROUTINE CATINP
      COMMON /TYPE/ITYP,SHI(4),NFC,NFZ,NRJ
       COMMON /SHIT/MTSHI(12)
      COMMON /UPAS/X1,B(48),NAM(3),NAM1(3)
     * ,TIN,DIN(3),TUS,LPUS,NPMd
     * ,Ml(16),Md(16),Ml1(16),Md1(16)
     * ,LINK
      COMMON /OUTP/NByB(62),NAMO(3,62)
      INTEGER X1,B,DIN,TIN,TUS,TI1,TI2
     * ,TBy,TPMd,WR,SHI,TSHI(5)
     * ,BLAN,WR1,WR2,TER(2)
      COMMON /PTAB/ WR,I,WR1,WR2,TBy,TI1,TI2,TPMd,IM
      DATA ITYP/1/
     * ,TSHI/30H+++   {4:   {3:   {2:   {1:   /
     * ,BLAN/6H      /,TER/12HfAT.  blOK. /
     *,TT{/6HT{:   /
      CALL PRCI1
      CALL RECATO
      CALL RECATI
      DO 9 I=1,61
      CALL GIVPAS((I-1)*16)
      IF(B(48).EQ.B(37)) GO TO 9
      IF(B(46).EQ.1.AND.ITYP.EQ.0) GOTO 9
      CALL TICODM((TIN+30)/60,TI1)
      CALL TICODM(TUS,TI2)
      WR=6H
      IF(B(46).EQ.1) WR=TSHI
      DO 1 J=1,4
      IF(SHI(J).EQ.I) WR=TSHI(J+1)
    1 CONTINUE
       DO 111 J=1,12
       IF(MTSHI(J).EQ.I) WR=TT{
111    CONTINUE
      WR1=6H
      IF(B(17)+B(16).EQ.0) GOTO 21
      WR1=TER
      IF(B(17).EQ.1.AND.B(15).EQ.0) GOTO 21
      WR1=TER(2)
   21 WR2=6H
      IF(B(21).EQ.1) GOTO 22
      WR2=1HC
      IF(B(19).EQ.1) WR2=1HT
   22 TBy=6H
      IF(NByB(I).EQ.0B) GO TO 3
      DO 2 J=1,3
      IF(NAMO(J,I).NE.NAM1(J)) GO TO 3
    2 CONTINUE
      ENCODE (5,102,TBy)   NByB(I)
  102 FORMAT(2X,O2,X)
    3 TPMd=6H
      IF(NPMd.EQ.0) GO TO 5
      NPMd=NPMd*32
      ENCODE (6,104,TPMd)   NPMd
  104 FORMAT(X,O4,X)
    5 CONTINUE
      IF(LPUS.EQ.0) LPUS=24
      CALL PRCI2
      DO 7 IM=2,16
      IF(Ml(IM).EQ.BLAN.AND.Md(IM).EQ.BLAN) GO TO 8
      CALL PRCI3
    7 CONTINUE
    8 CONTINUE
    9 CONTINUE
      CALL PRCI4
      RETURN
      END
      SUBROUTINE CATOU
      CALL PRCO1
      CALL RECO
      CALL PRCO2
      CALL PRCO3
      CALL PRCO4
      RETURN
      END
      SUBROUTINE CHETAP
      COMMON /PARAM/IT,MT,Nb,NAM /COD/COD(2),TMAX
     *       /PAGE /LIS(1024),NZF(1024),NAMS(1024)/TIME/TR(512),TW(512)
      INTEGER RW,SW,COD,TEXT(6),TEXT1(854),ITE(1024)
     *       ,KTY(8),gTzp
     *       ,CTR(512),NZS(1024)
      EQUIVALENCE (NZS,LIS)
      EQUIVALENCE (CTR,TW)
      DATA TMAX,COD,KTY/
     * 2.5,
     * 2525 2525 2525 2525B,
     * 5252 5252 5252 5252B,
     * 48HgT    zp    ~T.   zp/~T ~T.   zp.   Cl.Cl.Cl.Cl.
     */
      DATA MREP/0/
      DATA J2C/6HCC    /
      DATA J3P/6H+++   /
      DATA J3M/6H---   /
      DATA JCOM/1H,/
      DATA NZ/6H  NZ  /
      DATA NT/6HTIME I/
      IF(MREP.NE.0) GO TO 100
      MREP=1
    1 CALL TELEGA(6HZSTART,1,NZ1)
      CALL TELEGA(6HZ END ,1,NZ2)
      IF(NZ2.EQ.0) NZ2=511
      ENCODE (30,900,TEXT)   Nb,MT,NZ1,NZ2,KTY(IT+3)
  900 FORMAT('b'A3',Mf'O2',Z1='O3',Z2='O3','A6)
      CALL TELEGA(TEXT,5,MAR)
      IF(MAR.NE.0) GO TO 1
  100 CONTINUE
      RW=1
      IF(IT.GT.3) GO TO 40
      IF(IT.EQ.1.OR.IT.EQ.3) RW=0
    3 DO 10 N=NZ1,NZ2
      IF(RW.EQ.1) GO TO 301
      DO 2 I=1,1024,2
      LIS(I)=COD
    2 LIS(I+1)=COD(2)
  301 CONTINUE
      T=TIM(1)
      CALL EXCH(N,RW)
    4 IF(IT.NE.2) CALL PAUSE
      MAR=gTzp(MT,RW)
      DT=TIM(1)-T
      IF(MEX(1).EQ.0) GO TO 5
      IF(DT.LT.TMAX.OR.N.EQ.NZ1) GO TO 4
      DT=-1 .
      CALL KILLTA
      IF(MAR.NE.0) GO TO 11
    5 IF(IT.EQ.2) CALL PAUSE
      IF(RW.EQ.1) GO TO 6
      IF(MAR.EQ.2) GO TO 11
      TW(N+1)=DT
      GO TO 10
    6 IF(DT.LT.0..OR.IT.NE.1) GO TO 9
      DO 7 I=1,1024,2
      IF(LIS(I).NE.COD.OR.LIS(I+1).NE.COD(2)) GO TO 8
    7 CONTINUE
      GO TO 9
    8 DT=0.
    9 TR(N+1)=DT
   10 CONTINUE
      IF(RW.EQ.1.OR.IT.EQ.3) RETURN
      RW=1
      GO TO 3
   11 NZ2=N
      ENCODE (18,101,TEXT)   MT,N,KTY(MAR)
  101 FORMAT('Mf'O2',Z2='O3'-'A2)
   43 CONTINUE
      CALL OPETEL(TEXT,3)
      IF(RW.EQ.1) GO TO 13
      TW(N+1)=DT
      IF(IT.NE.1) RETURN
      RW=1
   12 IF(gTzp(MT,RW).EQ.0) GO TO 3
      CALL PAUSE
      GO TO 12
   13 TR(N+1)=DT
      RETURN
   40 CALL EXCH(NZ1,3)
      N2=NZ1+NZ1+1
      DO 41 N=NZ1,NZ2
      DO 41 IN=1,2
      CALL RNAM(N2)
      IF(NZS(N2)/2.GT.NZ2) GO TO 42
   41 N2=N2+1
      RETURN
   42 ENCODE (18,101,TEXT)   MT,N,J2C
      NZ2=N
      GO TO 43
      ENTRY PRINT
      NB=0
      IF(IT.GT.3) GO TO 44
      IT1=IT+1
      DO 22 N=NZ1,NZ2
      ASSIGN 22 TO SW
      GO TO (16,20,16,21) , IT1
   15 ASSIGN 22 TO SW
   16 IR=6Hc
      IF(TR(N+1)) 18,17,19
   17 IR=6HH
   18 NB=NB+1
      ENCODE (6,102,ITE(NB))   IR,N
  102 FORMAT(A1,O3)
   19 GO TO SW
   20 ASSIGN 15 TO SW
   21 IR=6Hz
      IF(TW(N+1)) 18,18,19
   22 CONTINUE
      IF(IT.EQ.2) GO TO 27
   23 IF(NB.NE.0) GO TO 25
      ENCODE (12,103,TEXT)   Nb,MT,J3P
  103 FORMAT('b'A3',Mf'O2,A3)
   24 CALL OPETEL(TEXT,2)
      RETURN
   25 ENCODE (60,104,TEXT1)   (ITE(I),I=1,NB)
  104 FORMAT(12(X,A4))
   49 CONTINUE
      DO 26 N=1,NB,10
      L=NB-N+1
      IF(L.GT.10) L=10
      CALL OPETEL(TEXT1(N),L)
   26 CONTINUE
      ENCODE (12,103,TEXT)   Nb,MT,J3M
      GO TO 24
  27  PRINT 105,NZ,NT,NZ,NT,NZ,NT,NZ,NT,NZ,NT,NZ,NT
  105 FORMAT(10X'I',8(2A6))
      PRINT 106 , Nb,MT
  106 FORMAT(' b'A3'-Mf'O2)
      DO 30 N=NZ1,NZ2
      IR=6H OTK
      IF(TR(N+1)) 30,28,29
   28 IR=6HHCBp
      GO TO 30
   29 ENCODE (6,107,IR)   TR(N+1)
  107 FORMAT(F4.2)
   30 CTR(N+1)=IR
      NZE=NZ1+63
      IF(NZE.GT.NZ2) NZE=NZ2
      DO 31 N=NZ1,NZE
   31 PRINT 108 , (I,CTR(I+1),I=N,NZ2,64)
  108 FORMAT(10X'I',8(X,O3'- 'A4' I'))
      GO TO 23
   44 IF(IT.NE.4) GO TO 50
      NB=0
      IT1=0
      DO 48 N=NZ1,NZ2
      N2=N+N+1
      DO 47 IN=1,2
      IF(NAMS(N2).NE.NAM) GO TO 46
      IF(IT1.EQ.0) GO TO 47
      NZT=1H,
      IF(IT1.NE.1) NZT=1H-
      NB=NB+1
      ENCODE (4,110,ITE(NB))   NZW,NZT
  110 FORMAT(O3,A1)
      IF(IT1.EQ.1) GO TO 45
      NB=NB+1
      IT1=N-1
      ENCODE (4,110,ITE(NB))   IT1,JCOM
   45 IT1=0
      GO TO 47
   46 IT1=IT1+1
      IF(IT1.EQ.1) NZW=N
      GO TO 48
   47 N2=N2+1
   48 CONTINUE
      IF(NB.EQ.0) GO TO 23
      CALL OPETEL(6HiMEHA:,1)
      ENCODE (60,111,TEXT1)   (ITE(I),I=1,NB)
  111 FORMAT(15A4)
      GO TO 49
   50 IT=4
      GO TO 44
      END
      SUBROUTINE DFLTPR
C.
C...      YCTAHOBKA HEdOCTA`}iX pAPAMETPOB "pO YMOl~AHi`"
C.
      COMMON /PAR42z/ IFRAG , ITYP  , KOD   , IGO   , IANSW(10)
     +,               LQUEST, I~Y{x , ITERMS, ITERMD, NO
     +,               IYES  , LENTH , ITPKAT, LANSW , LADRES
     +,               NAME(2),IQUEST(4,10),IDFLAS(10)
      DIMENSION IFRAG(15)
      DO 10 I=4,LANSW
         IF (IANSW(I) .GT. 0)          GO TO    10
         IANSW(I) = IDFLAS(I)
   10 CONTINUE
      NGO = 5
      IF (IANSW(NGO) .GT. 0)            GO TO    99
      IANSW(NGO) = 1
      IANSW(NGO+1) = LENTH
   99 CONTINUE
      RETURN
      END
      SUBROUTINE DIASCA
C.
C...      zApPOC CTPOKi i BybOP pEPBOgO pAPAMETPA
C.
      COMMON /PAR42z/ IFRAG , ITYP  , KOD   , IGO   , IANSW(10)
     +,               LQUEST, I~Y{x , ITERMS, ITERMD, NO
     +,               IYES  , LENTH , ITPKAT, LANSW , LADRES
     +,               NAME(2),IQUEST(4,10),IDFLAS(10)
      DIMENSION IFRAG(15)
      COMMON /PROTO/ AP, NUNIT, NL, NF, INT, INSTR(15)
      CALL DIALOG(IQUEST(1,IGO),LQUEST,1)
      CALL SCANER(INSTR,IFRAG,2,ITYP,KOD,IPOZ)
      RETURN
      END
      SUBROUTINE ERRPRT
C.
C...      pPOgPAMMA PEAKcii HA O{ibO~HyE OTBETy
C.
      COMMON /PAR42z/ IFRAG , ITYP  , KOD   , IGO   , IANSW(10)
     +,               LQUEST, I~Y{x , ITERMS, ITERMD, NO
     +,               IYES  , LENTH , ITPKAT, LANSW , LADRES
     +,               NAME(2),IQUEST(4,10),IDFLAS(10)
      DIMENSION IFRAG(15)
      DIMENSION IERR2(2)
      DATA IERR1 /'~Y{x'/
      DATA IERR2 /'OpqTx ~Y{x'/
      IF (I~Y{x .GT. 0)               GO TO    30
      I~Y{x = I~Y{x + 1
C--
C-        pEPByj PAz "~Y{x"
C
      CALL DIALOG(IERR1,4,-1)
                                      GO TO    99
   30  CONTINUE
C--
C--       OpqTx "~Y{x"
C
      CALL DIALOG(IERR2,10,-1)
      STOP
   99 RETURN
      END
      SUBROUTINE GROUT
C*
C***   ~TEHiE gPAfiKi iz fAjlA ByBOdA
C*     BydA~A EE HA PAzHyE YCTPOjCTBA
C*
      COMMON /PROTO/ IAP(5),KAP(20)
      COMMON /SPLOT/ DX,DY
      COMMON /PLONAM/ NAME
      COMMON /PNUMB/ NPEN,NPOLD
      COMMON /LIST/ M(1024)
      COMMON /KOEF/ KOEF
      DIMENSION MTFDB(10),MBUF(1024)
      DIMENSION KK(4),MD(10),NAMUN(5),MASK(2)
      DIMENSION MTEXT(14),LETT(3),NZSCAL(32)
      DATA MASK/7677 7777 7777 7777B, 0677 7777 0077 7777B/
      DATA XOLD/-1./, YOLD/-1./
      DATA MD/'ObxEM gPAfiKi  = ',' ',' ',' bAjT.',' f10',0,0,0/
      DATA NAMUN/'EC9002','BESM6','WX4675','CALCOM','TX4012'/
      DATA LUN/3/, MTIS/0/, MTEXT/14(' ')/
      DATA LETT/'M','H','D'/
      DIMENSION KOPLO(5),PC(2,4)
      DATA KOPLO/' CALC-',' WX-',' TX-',' WX-',' '/
      DIMENSION PAGES(2,3),LCOM(8)
      DATA LCOM/0,0,0,1,4,4,6,0/
      DATA PAGES/34500.,26000.,60000.,27000.,21000.,16000./
      COMMON /OKHO/ X1(5),Y1(5),XOLD,YOLD,XNEW,YNEW,KX,KY,KXT,KYT,LC,IB
      EQUIVALENCE (X2,X1(2)),(Y2,Y1(3))
      DIMENSION MTK(210)
      DATA MTK/210(' ')/
C------------------------
      IT=0 $ CALL RZFOUT(0)
      DO 1000 I=1,63
      LET=M(5*I+1).SHIFT.39.AND.15.OR.0
      IF(LET.EQ.0.OR.M(5*I+3).EQ.0B) GOTO 1000
      LET1=M(5*I+1).AND.7700 0000B
      IF(LET1.EQ.0B) GOTO 1000
      LET1='*' $ IF(LET.GT.7) LET1=' '
      IP=M(5*I+1).SHIFT.45.AND.3.OR.0
      IF(IP.EQ.1) LET1='+' $ IF(IP.GT.1) LET1='/'
      LET=LET.AND.7.OR.0 $ IF(LET.EQ.0) LET=1
      IT=IT+1
      CALL PUTH(MTK(3*IT-2),KOPLO(LET),0,2,0,IP)
      CALL PUTH(0,LET1,0,1,0,IP)
      CALL PUTO(0,I,0,2,0,IP)
      CALL PUTH(0,'-',0,1,0,IP)
      DO 1001 J=1,18
      IF(IGETS(M(5*I+3),J-1).EQ.0B) GOTO 1002
 1001 N=J
 1002 IF(N.GT.11) N=11
      CALL PUTH(0,M(5*I+3),0,N,0,IP)
 1000 CONTINUE
      IF(IT.EQ.0) CALL DIALOG(' HET gPAfiKOB.',15,-1)
      IF(IT.EQ.0) STOP
      CALL DIALOG(' gPAfiKi B fAjlE ByBOdA:',24,-1)
      I=1 $ NJOB=1
 1004 IF(MTK(I).EQ.' ') GOTO 1
      CALL DIALOG(MTK(I),72,-1)
      I=I+12 $ GOTO 1004
C---
      ENTRY DELFIL
      NJOB=2
  1   CALL DIALOQ('HOMEP pO fAjlY ByBOdA:',24,KAP)
      CALL SCANER(KAP,N,4,IT,KOD,IP)
      N=N.OR.0 $ NLIS=N
      IF(IT.NE.1.OR.N.LT.1.OR.N.GT.64) GOTO 1
      CALL NTOIPZ(N)
      DO 2 I=1,32
  2   NZSCAL(I)=0B
      CALL RZFOUT(0) $ IF(NJOB.EQ.2) GOTO 3
  7   CALL DIALOQ('KYdA BydABATx:',14,KAP)
      CALL SCANER(KAP,NPL,0,IT,KOD,IP)
      LUN=JSEART(NAMUN,1,5,NPL)
      IF(LUN.EQ.0) CALL DIALOG('O{ibKA',6,-1)
      IF(LUN.EQ.0) GOTO 7
      CALL PLOTIN(LUN)
C---    OTMETiM B {KAlE |lEMEHT KATAlOgA
  3   ICAT=5*N+1
      NBIT=N.AND.3.OR.0
      NWORD=N.SHIFT.2.AND.17B.OR.0
      JB=4000 0000 0000 0000B .SHIFT. NBIT
      NZSCAL(NWORD+1)=NZSCAL(NWORD+1).OR.JB
      NZ=M(ICAT).AND.777B.OR.0
      MOWN=M(ICAT)
      NS=-1 $ NW=0
      MAX=0
      KS=0
      NAME=NAMUN(LUN)
      CALL PUTH(MD(7),' f',0,2,0,IP)
      CALL PUTO(0,N,0,2,0,IP)
      DO 333 I=1,3
 333  MD(I+7)=M(ICAT+I+1)
      MFIN=1
 334  MSKIP=0B
      IF(NJOB.EQ.2.OR.LUN.LT.3) GOTO 4
      CALL DIALOQ('C KAKOgO liCTA:',16,KAP)
      CALL SCANER(KAP,MSKIP,3,IT,KOD,IP)
      IF(IT.EQ.4.AND.KOEF.GT.1) IT=0
      IF(IT.EQ.2.OR.IT.EQ.4) GOTO 335
      CALL DIALOG('O{ibKA',6,-1) $ GOTO 334
 335  IF(KOEF.GT.1) GOTO 1500
      IF(IT.EQ.2.AND.MSKIP.EQ.1) MSKIP=0B
      IF(MSKIP.EQ.0B) GOTO 4
C
C---    pPOpYCK HA~AlA gPAfiKi :
C
 500  ASSIGN 501 TO MGS $ GOTO 100
 501  LCNT=LCOM(LET+1)
      IF(LCNT.EQ.0) GOTO 500
      LET1=LET $ LABEL=0B
      DO 502 II=1,LCNT
      ASSIGN 502 TO MGS $ GOTO 100
 502  CALL IPUTS(LET,LABEL,II-1)
      IF(LET1.EQ.3) NPEN=LABEL.SHIFT.40.OR.0
      IF(LET1.NE.6) GOTO 500
      IF(LABEL.NE.MSKIP) GOTO 500
C---
  4   ASSIGN 5 TO MGS
      IF(NJOB.EQ.2) GOTO 101
C---    blOK "dAj CiMBOl"
 100  IF(NS.LT.0) GOTO 101
      LET=IGETS(MBUF,NS)
      KS=KS+1
      NS=NS+1 $ IF(NS.GE.MAX) NS=-1
 199  GOTO MGS,(5)
C---    BybOPKA HOBOj pOPcii iz bYfEPA ByBOdA
 101  MAX=0 $ ASSIGN 102 TO MGW $ GOTO 120
 102  LET=IWORD.SHIFT.40
      IF(IWORD.EQ.7777 7777 7777 7777B) GOTO (900,1900) MFIN
      IF(LET.EQ.376B) GOTO 110
      ASSIGN 103 TO MGW
 103  LET=IWORD.AND.377B $ IF(LET.NE.176B) GOTO 120
      GOTO 101
 110  ITYP=IWORD.SHIFT.32.AND.377B
      LEN=IWORD.AND.77777B.OR.0
      LEN=LEN+1
      DO 111 I=1,LEN
      ASSIGN 111 TO MGW
C---    ~TEHiE ClOBA iz fAjlA ByBOdA
 120  IF(NW.GT.0) GOTO 129
      CALL RZFOUT(NZ)
      J=LEXOR(M,MOWN).AND.77 77 77 000 000B
      IF(J.NE.0B) GOTO (900,1900) MFIN
C---    HAKOplEHiE {KAly pPO~iTAHHyX zOH
      NBIT=NZ.AND.37B.OR.0
      NWORD=NZ.SHIFT.5.AND.17B.OR.0
      JB=4000 0000 0000 0000B .SHIFT. NBIT
      NZSCAL(NWORD+17)=NZSCAL(NWORD+17).OR.JB
      NW=11 $ NZ=M(1).AND.777B.OR.0
 129  IWORD=M(NW) $ NW=NW+1
      IF(NW.GT.1024) NW=-1
      GOTO MGW,(111,102,103)
 111  MBUF(I)=IWORD
      IF(ITYP.NE.40B) GOTO 101
      MAX=6*LEN $ NS=0
      GOTO 100
C
C---    AHAliz gPAfi~ECKOj KOMAHdy
C     0 - pYCTAq
C     1 - CMEHA liCTA
C     2 - YCTAHOBKA pEPA B HA~AlO
C     3 - CMEHA pEPA
C     4 - dBivEHiE bEz PiCOBAHiq
C     5 - dBivEHiE C PiCOBAHiEM
C     6 - MAPKiPOBKA gPAfiKi
C
  5   IF(NJOB.EQ.2.OR.LET.EQ.0) GOTO 4
      IF(LET-6) 6,600,9999
  6   IF(LUN.LT.3) GOTO 700
      GOTO (10,20,30,40,50) LET
  10  IF(MSKIP.EQ.0B) NAME='WXHOME'
  20  JOB=0 $ KX=0 $ KY=0 $ GOTO 60
  30  ASSIGN 31 TO MGS $ GOTO 100
  31  NPEN=LET $ GOTO 4
  40  JOB=-1 $ GOTO 51
  50  JOB=1 $ MSKIP=0B
  51  DO 52 II=1,4
      ASSIGN 52 TO MGS $ GOTO 100
  52  KK(II)=LET
      KX=256*KK(1)+KK(2)
      KY=256*KK(3)+KK(4)
  60  IF(LUN.LT.3) GOTO 760
      CALL PLOT51(KX,KY,JOB)
      GOTO 4
C
C---    pEPEpiCx gPAfiKi HA Ml EC ili b6
C
 700  IF(MTIS.NE.0) GOTO (710,720,730,40,50) LET
 701  IF(LUN.NE.1) CALL DIALOQ('fAjl(zOHA):',12,KAP)
      IF(LUN.NE.1) GOTO 1701
      CALL DIALOQ('HOMEP bObiHy (4 cifPy ) :',26,KAP)
      KAP(1)=KAP(1).SHIFT.16.OR.' H'
      KAP(2)='/NO CH' $ KAP(3)='ECK,W4'
      KAP(4)='1'
 1701 J=JFOCC(KAP,MTFDB)
      IF(J.EQ.0) GOTO (702,706) LUN
      CALL DIALOG(MTFDB(4),18,-1)
      GOTO 701
 702  J=MT9(1,7)
 703  CALL DIALOQ('CKOlxKO fAjlOB pPOpYCTiTx:',27,KAP)
      CALL SCANER(KAP,NFIL,0,IT,KOD,IP)
      IF(IT.NE.2.OR.NFIL.LT.0) GOTO 703
      IF(NFIL.EQ.0) GOTO 705
      DO 704 II=1,NFIL
 704  J=MT9(1,5)
 705  MER=0
      MTIS=1 $ GOTO 700
 706  MTIS=MTFDB(2).SHIFT.-12.OR.(MTFDB(3).AND.7777B)
      CALL WBEGIN(MTIS) $ GOTO 705
C---   CMEHA liCTA
 710  XOLD=-1. $ YOLD=-1. $ MER=0
      MTEXT='NEW' $ IF(LUN.EQ.2) GOTO 721
      ASSIGN 4 TO MTRET
C---   dOCbPOC bYfEPA (EC)
 790  CALL S160(MTIS,0,0)
      J=MT9(MTIS,9) $ J=MT9(MTIS,9)
      J=MT9(MTIS,4) $ NFIL=NFIL+1
      CALL PUTG(KK,NFIL,1,4,0,IP)
      CALL PUTH(0,'-j fAjl zApiCAH.',0,18,0,IP)
      CALL DIALOG(KK,IP,-1)
      GOTO MTRET,(4,999)
C---   BydA~A "HOME"
 720  MTEXT=LETT(2) $ MER=0
      XOLD=0. $ YOLD=0.
C---   Ob}ij blOK zApiCi CTPOKi
 721  NS1=0 $ NS2=0
      MTEXT(5)=0240 0000 0000 0000B
 722  LET1=IGETS(MTEXT,NS1)
      NS1=NS1+1 $ IF(LET1.EQ.32) GOTO 722
      CALL IPUTS(LET1,MTEXT,NS2)
      NS2=NS2+1 $ IF(LET1.NE.0) GOTO 722
      IF(LUN.EQ.1) CALL W160S(MTIS,MTEXT,NS2)
      IF(LUN.EQ.1) GOTO 723
      NS2=NS2-2
      DO 725 NS1=NS2,31
 725  CALL IPUTS(32,MTEXT,NS1)
      CALL WRCARD(MTEXT)
 723  DO 724 NS1=1,5
 724  MTEXT(NS1)=6H
      GOTO 4
C---   CMEHA pEPA
 730  ASSIGN 731 TO MGS $ GOTO 100
 731  MTEXT=LET.SHIFT.-32.OR.'J0'
      GOTO 721
C---   BydA~A KOOPdiHAT
 760  IF(MER.NE.0) JOB=-1
      X=0.1*KX $ Y=0.1*KY
      IF(X.EQ.XOLD.AND.Y.EQ.YOLD) GOTO 4
      MER=0
      IF(X.LT.0.0.OR.X.GT.3450.) MER=1
      IF(Y.LT.0.0.OR.Y.GT.2600.) MER=1
      MTEXT=LETT(JOB+2)
      MTEXT(3)=','
      CALL PUTG(MTEXT(2),X,0,4,0,IP)
      CALL PUTG(MTEXT(4),Y,0,4,0,IP)
      XOLD=X $ YOLD=Y
      IF(MER.NE.0) GOTO 4
      GOTO 721
C
C---   BybOPKA MAPKEPA :
C
 600  LABEL=0B
      DO 601 II=1,6
      ASSIGN 602 TO MGS $ GOTO 100
 602  CALL IPUTS(LET,LABEL,II-1)
 601  CONTINUE
      GOTO 4
C---
 9999 CALL DIALOG('O{.gPAf.KOMAHdA',16,-1)
      GOTO 4
C
C---    PiCOBAHiE C PACTqvEHiEM :
C      CXEMA HYMEPAcii liCTOB dlq
C      KO|ff-TA PACTqvEHiq = 3 :
C         I=================I
C         I  7  :  8  :  9  I
C         I-----:-----:-----I
C         I  4  :  5  :  6  I
C         I-----:-----:-----I
C         I  1  :  2  :  3  I
C         I=================I
C
 1500 MFIN=2
      NZBEG = NZ
      XW=PAGES(1,LUN-2)
      YW=PAGES(2,LUN-2)
      KOEF2=KOEF*KOEF
      IF(MSKIP.LE.KOEF2.AND.KOEF.LE.5) GOTO 1501
      CALL DIALOG('TAKOgO liCTA HET.',18,-1)
      STOP
C---
 1501 DO 1599 IPART=MSKIP,KOEF2
      I=IPART/KOEF $ J=IPART-I*KOEF
      IF(J.NE.0) I=I+1
      IF(J.EQ.0) J=KOEF
      X1=XW*(J-1) $ X2=X1+XW
      Y1=YW*(I-1) $ Y2=Y1+YW
      X1(3)=X2 $ X1(4)=X1 $ X1(5)=X1
      Y1(2)=Y1 $ Y1(4)=Y2 $ Y1(5)=Y1
      KXT=X1 $ KYT=Y1 $ ISLIN=0
      XTEK=X1 $ YTEK=Y1
      NS=-1 $ NW=0 $ MAX=0 $ KS=0
      NZ = NZBEG
      GOTO 1504
C---    OTPAbOTKA "HOME"
 1503 KXT=0 $ KYT=0
C---    BybOPKA ClEdY`}Ej KOMAHdy
 1504 ASSIGN 1505 TO MGS $ GOTO 100
 1505 LET1=LET+1 $ LABEL=0B
      LCNT=LCOM(LET1)
      IF(LCNT.EQ.0) GOTO 1507
      DO 1506 II=1,LCNT
      ASSIGN 1506 TO MGS $ GOTO 100
 1506 CALL IPUTS(LET,LABEL,II-1)
 1507 IF(LET1.GT.6) GOTO 1504
      GOTO (1504,1504,1503,1530,1540,1550) LET1
 1530 NPEN=LABEL.SHIFT.40.OR.0 $ GOTO 1504
C---    iCpOlHEHiE KOMAHd :
 1540 JOB=-1 $ GOTO 1551
 1550 JOB=1
 1551 KX=KXT $ KY=KYT
      KXT=LABEL.SHIFT.32.OR.0
      KYT=LABEL.SHIFT.16.AND.177777B.OR.0
      KXT=KOEF*KXT $ KYT=KOEF*KYT
      IF(JOB.LT.0) GOTO 1504
      XOLD=KX $ YOLD=KY
      XNEW=KXT $ YNEW=KYT
      IF(XOLD.EQ.XNEW) GOTO 1570
      IF(YOLD.EQ.YNEW) GOTO 1580
      IB1=INBOX(XOLD,YOLD)
      IB2=INBOX(XNEW,YNEW)
      IBMULT=IB1*IB2
C---     pOdC~ET ~iClA pEPECE~EHij C gPAHicAMi OKHA
      J=1
      DO 1559 I=1,4
      LC=LCROSS(XOLD,YOLD,XNEW,YNEW,X1(I),Y1(I),X1(I+1),Y1(I+1),
     *      PC(1,J),PC(2,J))
      IF(LC.EQ.4) J=J+1
 1559 CONTINUE
      GOTO (1560,1561,1562,1563,1564) J
 1560 IF(IBMULT.LT.4) GOTO 1504
      GOTO 1555
 1561 IF(IBMULT.LT.3) GOTO 1504
      IF(IB1.EQ.1) GOTO 1569
      IF(IB1.EQ.2) GOTO 1555
      XNEW=PC(1,1) $ YNEW=PC(2,1) $ GOTO 1555
 1562 IF(IBMULT.EQ.2) GOTO 1504
      XNEW=PC(1,2) $ YNEW=PC(2,2)
 1569 XOLD=PC(1,1) $ YOLD=PC(2,1) $ GOTO 1555
 1563 CONTINUE
 1564 XOLD=PC(1,1) $ YOLD=PC(2,1)
      J=J-1 $ DO 1565 I=2,J
      XNEW=PC(1,I) $ YNEW=PC(2,I)
      IF(ABS(XNEW-XOLD)+ABS(YNEW-YOLD).GT.1.) GOTO 1555
 1565 CONTINUE
C---
 1555 CONTINUE
      IF(IBMULT.GE.4) GOTO 1556
      IF(ABS(XTEK-XOLD)+ABS(YTEK-YOLD).LE.
     *   ABS(XTEK-XNEW)+ABS(YTEK-YNEW)) GOTO 1556
      XTEK=XOLD $ XOLD=XNEW $ XNEW=XTEK
      YTEK=YOLD $ YOLD=YNEW $ YNEW=YTEK
 1556 CALL PLOT51(XOLD-X1,YOLD-Y1,-1)
      CALL PLOT51(XNEW-X1,YNEW-Y1,1)
      XTEK=XNEW $ YTEK=YNEW
      ISLIN=1 $ GOTO 1504
C---    BEPTiKAlx
 1570 IF(YOLD.EQ.YNEW) GOTO 1504
      IF(XNEW.GT.X2.OR.XNEW.LT.X1) GOTO 1504
      IF(YOLD.LE.Y1.AND.YNEW.LE.Y1) GOTO 1504
      IF(YOLD.GE.Y2.AND.YNEW.GE.Y2) GOTO 1504
      IF(YOLD.LT.Y1) YOLD=Y1
      IF(YOLD.GT.Y2) YOLD=Y2
      IF(YNEW.LT.Y1) YNEW=Y1
      IF(YNEW.GT.Y2) YNEW=Y2
      GOTO 1555
C---    gOPizOHTAlx
 1580 IF(XOLD.EQ.XNEW) GOTO 1504
      IF(YNEW.GT.Y2.OR.YNEW.LT.Y1) GOTO 1504
      IF(XOLD.LE.X1.AND.XNEW.LE.X1) GOTO 1504
      IF(XOLD.GE.X2.AND.XNEW.GE.X2) GOTO 1504
      IF(XOLD.LT.X1) XOLD=X1
      IF(XOLD.GT.X2) XOLD=X2
      IF(XNEW.LT.X1) XNEW=X1
      IF(XNEW.GT.X2) XNEW=X2
      GOTO 1555
C---    KOHEc O~EPEdHOgO pPOXOdA
 1900 NPEN=1
      CALL PLOT51(0,0,0)
      IF(ISLIN.NE.0.AND.IPART.NE.KOEF2) NAME='WXHOME'
 1599 CONTINUE
C
C---    KOHEc fAjlA ByBOdA
C
 900  NPEN=1 $ IF(NJOB.EQ.1) CALL PLOT51(0,0,0)
      ASSIGN 999 TO MTRET
      CALL RCFOUT
      M(ICAT)=M(ICAT).AND.MASK(NJOB)
      IF(NJOB.EQ.2) M(ICAT+2)=0B
      DO 901 I=1,32
 901  M(I+976)=M(I+976).OR.NZSCAL(I)
      CALL WCFOUT
      IF(MTIS.EQ.0.AND.NJOB.EQ.1) GOTO 999
      IF(NJOB.EQ.1) GOTO (790,902,999,999,999) LUN
      MD(6)='iCKl:' $ CALL DIALOG(MD(6),30,-1)
      STOP
 902  MTEXT(1)='*READ' $ MTEXT(2)='OLD'
      CALL WRCARD(MTEXT) $ CALL WRIEND
 999  CALL PUTG(MD(4),KS,0,12,0,IP)
      CALL DIALOG(MD,60,-1)
      STOP
      END
      SUBROUTINE HAVERS(LD)
C     pOdpPOgPAMMA pOdgOTOBKi TAblic COCTOqHiq
C     MAgHiTOfOHOB i diCKOB:
C       2) TAblicA OCBObOdiB{iXCq YCTPOjCTB - SV
C       3) TAblicA COCTOqHiq KAvdOgO YCTPOjCTBA -
C     TABLE
C-------------------------------------------------
C       LD=0 - Ml
C       LD=1 - Md
C--------------------------------------------------
      COMMON /UPAS/ X1,B(48),A(6),TIN,DIN(3),TUS
     1,KP(2),RST(32),LDRS(32)
      COMMON /RESURS/ SV(32)
     1,TABLE(32,2)
      COMMON /PAR/ ID,ID1
      COMMON /UST/ MOD(32),TMOD(32)
      COMMON /TIME/ IT5,IT6
      COMMON /TYPE/ ITYP,SHI(4),NFZ,NPJ
      COMMON /TUST/ DTAP(32),DMOD(16)
      INTEGER SHI
      DIMENSION TSHI(4),MLMD(96)
      INTEGER TUS,HR,THR,B
     1,RES5,RES6,RES7,SV,TABLE
     2,TSHI,TPR
     3,TMOD
     4,X1,TIN,DIN
     5,DTAP,DMOD
      DATA (TSHI=24HB PE{. CBOb.B KAT. CiCT.)
      DATA TPR/1H /
      CALL RECATO
      CALL RECATI
      CALL REWR(LD)
      CALL PLAN(ID1)
      DO 100 I=1,32
      SV(I)=0
      DO 100 J=1,2
  100 TABLE(I,J)=TPR
      NSV=1
      IT=1
      JT=1
      NUL=1
      IF(LD.EQ.1) GO TO 42
      DO 50 I=1,32
   50 DTAP(I)=MOD(I)
      N=32
      MD=0
      GO TO 43
   42 N=16
      MD=16
      DO 51 I=1,16
   51 DMOD(I)=MOD(I)
   43 CONTINUE
      DO 2 K=1,N
      IR7=0
      IRC=0
      IF(LD.EQ.1) GO TO 30
      IF(MOD(K).EQ.2245125251224512B) GO TO 13
      CALL SLML(MOD(K),IND)
      GO TO 31
   30 KP=K+23
      IF(MOD(K).EQ.0B) GO TO 13
      CALL SLMD(KP,IND)
   31 CONTINUE
      IF(IND.NE.0) GO TO 14
      TABLE(IT,1)=TMOD(K)
      TABLE(IT,2)=TSHI(4)
      GO TO 101
   14 DO 3 I=1,62
      CALL GIVPAS((I-1)*16)
      IF(B(48).EQ.B(37))  GO TO 3
      IF(B(46).EQ.1) GO TO 3
      L=38
      IF(LD.EQ.0) L=42
      KL=B(L)+B(L+1)*2+B(L+2)*(2**2)+B(L+3)*(2**3)
      IF(KL.EQ.0) GO TO 3
      DO 4 J=1,KL
      IF(MOD(K).EQ.LDRS(MD+J)) GO TO 5
    4 CONTINUE
      GO TO 3
    5 CONTINUE
   21 IR7=1
    3 CONTINUE
      M=K-1
      CALL LDSHI(LD,M)
         M=48-M
       IF(M.GE.48)GO TO 41
      IRC=1
   41 CONTINUE
      IF(IRC.EQ.0) GO TO 11
      ENCODE(5,412,NSHI) M
  412 FORMAT(' {-',O2)
      TABLE(IT,2)=NSHI
      GO TO 101
   11 IF(IR7.EQ.0) GO TO 8
      TABLE(IT,2)=TSHI(3)
      GO TO 101
    8 CONTINUE
   10 TABLE(IT,2)=TSHI(2)
      SV(NSV)=K+23
      NSV=NSV+1
  101 TABLE(IT,1)=TMOD(K)
   13 IT=IT+1
    2 CONTINUE
      SV(NSV)=0
      RETURN
      END
      FUNCTION INBOX(X,Y)
      COMMON /OKHO/ X1,X2(4),Y1(2),Y2(3),XOLD(9),IB
C*
C***  pPObA pOpAdAHiq TO~Ki  (X,Y)  B OKHO.
C*           PEzYlxTAT :
C*        1 - BHE OKHA
C*        2 - HA gPAHicE
C*        3 - BHYTPi OKHA
C*
      IB=1
      IF(X.LT.X1.OR.X.GT.X2) GOTO 1
      IF(Y.LT.Y1.OR.Y.GT.Y2) GOTO 1
      IB=2
      IF(X.EQ.X1.OR.X.EQ.X2.OR.Y.EQ.Y1.OR.Y.EQ.Y2) GOTO 1
      IB=3
  1   INBOX=IB
      RETURN
      END
      FUNCTION INSTEP(IGO)
C.
C...      BXOd B O~EPEdHOj {Ag 'IGO'
C.
C.        PEzYlxTAT:
C.        ----------
C.       -1      --      'CpPOCiM'
C.        0      --      pPOdOlviM PAbOTY
C.        1      --      PAbOTAEM pO 'YMOl~AHi`'
C.
C. ---------------------------------------------------
C
      COMMON /PAR42z/ IFRAG , ITYP  , KOD   , NGO   , IANSW(10)
     +,               LQUEST, I~Y{x , ITERMS,ITERMD , NO
      DIMENSION IFRAG(15)
C
      I~Y{x = 0
      IANSW(IGO) = 0
      IF (KOD .EQ. ITERMS .OR. KOD .EQ. 0)  GO TO   105
      IF (KOD .EQ. ITERMD)                  GO TO   110
      CALL SCANER(0,IFRAG,2,ITYP,KOD,IPOZ)
C
      INSTEP = 0
                                            GO TO   999
  105 INSTEP = -1
                                            GO TO   999
  110 INSTEP =  1
  999 CONTINUE
      RETURN
      END
      SUBROUTINE ITCOPY
      COMMON /IT/ T IT(8),C IT(5)
      COMMON /CN IT/ TEXT(2),NT,ITUJ,TT BUF(9),TDEC(6)
      INTEGER TDEC,TEXT,TT BUF,T IT, C IT
      DATA CIT/30HCOPY:C 0000(00) HA 0000(00)   /
      DECODE (8,100,TEXT)   TDEC
  100 FORMAT (4A1,2X,2A1)
      IF (NT.NE.0B) GO TO 1
      ENCODE (12,103,C IT(2)) TDEC
  103 FORMAT(' '4A1'('2A1') HA')
      ENCODE (10,104,TT BUF) TDEC
  104 FORMAT('C '4A1'('2A1')')
      GO TO 99
1     ENCODE(9,105,C IT(4)) TDEC
105   FORMAT(' '4A1'('2A1')')
      ENCODE (11,106,TT BUF) TDEC
  106 FORMAT('HA '4A1'('2A1')')
   99 RETURN
      END
      SUBROUTINE ITTECT
      COMMON /IT/ T IT(8), C IT(5)
      COMMON /LINK/HH(3),MOPT
      COMMON /CN IT/ TEXT(2),NT,ITUJ,TT BUF(9),TDEC(6)
      INTEGER TDEC,CPT(4),CKT(4),CPR(3),CL(2),TEXT,TT BUF,T IT,C IT
      INTEGER REG(4),TDEC5(5),TDEC2(2)
      DATA CPT/24HpOCl.pMAKC.pClY~.pOdB.  /
      DATA T IT/48H~TEHiE,0000(00),D=00000-30710,3=00,pp,KC ,OpT,H /
      DATA CKT/24HKC pOCKT pOCKC+pEPKT+pEP/
      DATA CPR/18Hbp~   OpT   AcpY  /
      DATA CL/12HHET c.ciKl  /
      DATA REG/24Hzp/CP zApiCxCPABH.~TEHiE/
      ENTRY ITTEST
      GO TO (1,2,3,4,5,6,7,8) , ITUJ
C.....
    1 T IT(1)=REG(NT)
      TTBUF(1)=REG(NT)
      GO TO 98
C.....
    2 DECODE (8,100,TEXT)   TDEC
  100 FORMAT(4A1,2X,2A1)
  101 FORMAT(2A1)
      ENCODE (12,102,T IT(2)) TDEC
  102 FORMAT(','4A1'('2A1'),D=')
      ENCODE (8,103,TTBUF) TDEC
  103 FORMAT(4A1,'('2A1')')
      GO TO 97
C.....
    3 DECODE (5,104,TEXT) TDEC5
  104 FORMAT(5A1)
      IF (NT.NE.0B) GO TO 10
      ENCODE (12,105,TT BUF) TDEC5
  105 FORMAT('HA~AlO-'5A1)
      ENCODE (6,106,T IT(4)) TDEC5
  106 FORMAT(5A1,'-')
      GO TO 97
   10 ENCODE (12,107,TT BUF) TDEC5
  107 FORMAT('KOHEc-'5A1)
      ENCODE (6,108,T IT(5)) TDEC5
  108 FORMAT(5A1',')
      GO TO 97
C.....
    4 DECODE (2,101,TEXT) TDEC2
      ENCODE (5,109,TT BUF) TDEC2
  109 FORMAT('zd='2A1)
      ENCODE (6,110,T IT(6)) TDEC2
  110 FORMAT('z='2A1',p')
      GO TO 98
C.....
    5 DECODE (6,111,T IT(7)) TDEC
  111 FORMAT(6A1)
      DECODE (1,112,CPT(NT)) TDEC(1)
  112 FORMAT(A1)
      ENCODE (6,113,T IT(7)) TDEC
  113 FORMAT(6A1)
      TTBUF(1)=CPT(NT)
      TTBUF(2)=CPT(4)
      GO TO 97
C.....
    6 DECODE (6,111,T IT(7)) TDEC
      DECODE (3,114,CKT(NT))   (TDEC(I),I=3,5)
      ENCODE (6,113,T IT(7)) TDEC
      TT BUF=CKT(NT)
      GO TO 98
C.....
    7 DECODE (6,111,T IT(8)) TDEC
      DECODE (3,114,CPR(NT))   (TDEC(I),I=1,3)
  114 FORMAT(3A1)
      ENCODE (6,113,T IT(8)) TDEC
      TTBUF(1)=CPR(NT)
      MOPT=NT-3
      GO TO 98
C.....
    8 DECODE (6,111,T IT(8)) TDEC
      DECODE (1,112,CL(NT)) TDEC(5)
      ENCODE (6,113,T IT(8)) TDEC
      TTBUF(1)=CL(NT)
   98 TTBUF(2)=0B
   97 TTBUF(3)=0B
   99 RETURN
      END
      SUBROUTINE KOdBP(T1,RES,TYP)
      DIMENSION RES(2,4),T1(4)
      INTEGER RES,TYP,SYM,IN(6)
      DATA CYT/86400./
      NL=1
   10 DO 7 L=1,NL
      T=T1(L)+.5
      IF(TYP.EQ.0) GO TO 4
C*****    pPiBEdEHiE ACTPOH. BPEMEHi
C            K CYTO~HOMY diApAzOHY
      SYM=1H
    1 IF(T) 2,4,3
    2 T=T+CYT
      SYM=1H*
      GO TO 1
    3 IF(T.LT.CYT) GO TO 4
      T=T-CYT
      GO TO1
    4 I=6 $ D=10.
    5 NU=T/D
      IN(I)=T-NU*D
      T=NU
      D=16.-D
      I=I-1
      IF(I.GT.1) GO TO 5
      IF(TYP.EQ.0) GO TO 6
      IF(I.EQ.1) GO TO 5
C.....    KOdiPOBKA ACTPOH. BPEMEHi
      ENCODE(12,100,RES(1,L))   IN,SYM
  100 FORMAT(X,2I1'.'2I1'.'2I1,A1)
      GO TO 7
C.....    KOdiPOBKA AbCOl. BPEMEHi
    6 IN(2)=IN(2)+T*10.
      ENCODE(12,101,RES(1,L)) (IN(I),I=2,6)
  101 FORMAT (I4,'.'2I1'.'2I1)
    7 CONTINUE
      RETURN
      ENTRY KOdBP4
      NL=3
      GO TO 10
      END
      SUBROUTINE LPR
      COMMON /NMOD/ NMOD(8) /L/ L,LL
      COMMON /PAR/ ID,ID1 /TEXT/ ITEXT(14)
      COMMON /RESURS/ SV(32),T(32,2)
      COMMON/T/ITT(14)
      INTEGER T
      IF(ID-1) 2,1,3
 1    PRINT 1000
 1000 FORMAT(//14X,29HYCTAHOBlEHHyE MAgHiTHyE lEHTy//)
      RETURN
2     I=0
      IT=2HMf
      RETURN
    3 CONTINUE
      ENCODE(80,30,ITT)
   30 FORMAT(9X'*** COCTOqHiE Mf ***'19X,
     * '00/00/00'4X'00.00.00'12X)
  200 CALL DATIME
      CALL VTPRI(ITT,14)
      ENCODE(80,35,ITT)
   35 FORMAT(X,78(1H-))
  201 CALL VTPRI(ITT,14)
      RETURN
      ENTRY DPR
      IF(ID-1) 5,4,6
 4    PRINT 1004
 1004 FORMAT(//14X,29HYCTAHOBlEHHyE diCKOByE pAKETy//)
      RETURN
5     I=0
      IT=2HMd
      RETURN
    6 CONTINUE
      ENCODE(80,60,ITT)
   60 FORMAT(9X'*** COCTOqHiE Md ***'19X,
     * '00/00/00'4X'00.00.00'12X)
      GOTO 200
      ENTRY LDPR
      IF(ID-1) 8,7,9
 7    PRINT 1007,(NMOD(K),K=1,8),
     *(T(K,1),K=L,LL),
     *(T(K,2),K=L,LL)
 1007 FORMAT(57(1H-)/
     *1HI,8(2X,O2,2X,1HI)/
     *57(1H-)/
     *1HI,8(1X,A4,1X,1HI)/
     *57(1H-)/
     *1HI,8(A6,1HI)/
     *57(1H-))
      RETURN
8     DO 100 J=1,8
      IF(NMOD(J).EQ.ID1) GO TO 101
100   CONTINUE
      RETURN
101   J=L+J-1
      IF(T(J,1).EQ.1H ) RETURN
      ENCODE(17,102,ITEXT) IT,ID1,T(J,1),T(J,2)
      CALL FTTPRI(ITEXT,3)
      I=1
      RETURN
102   FORMAT(A2,1H-,O2,1H:,A4,X,A6)
    9 CONTINUE
      ENCODE(80,90,ITEXT)(NMOD(K),K=1,8)
   90 FORMAT(8(2X'- 'O2' -  '))
      CALL VTPRI(ITEXT,14)
      ENCODE(80,91,ITEXT)((T(K,J),J=1,2),K=L,LL)
   91 FORMAT(8(A4,A6))
      CALL VTPRI(ITEXT,14)
      RETURN
      ENTRY LPR1
      IF(ID-1) 11,10,12
 10   PRINT 1010
 1010 FORMAT(//19X,18HMAgHiTHyX lEHT HET)
      RETURN
11    IF(I.EQ.1) RETURN
      ENCODE(10,103,ITEXT) IT,ID1
103   FORMAT(A2,1H-,O2,5H:pYCT)
      CALL FTTPRI(ITEXT,2)
      RETURN
   12 CONTINUE
      ENCODE(80,127,ITT)
  127 FORMAT('MAgHiTHyX lEHT HET'62X)
      GOTO 201
      ENTRY DPR1
      IF(ID-1) 14,13,15
 13   PRINT 1013
1013  FORMAT(//18X,20HdiCKOByX pAKETOB HET)
      RETURN
14    GO TO 11
   15 CONTINUE
      ENCODE(80,157,ITT)
  157 FORMAT('diCKOByX pAKETOB HET',60X)
      GOTO 201
      ENTRY LDPRST
      ENCODE(80,35,ITT)
      GOTO 201
      END
      SUBROUTINE MAIN42
C.
C...      pOdpPOgPAMMA PACpE~ATKi OblACTi pAMqTi'
C.           zAdAHHOj iMEHEM pO TAblicE  g P p
C.
C*****     01.06.82g.         fAjH B.|.
C*
C*        42 ClYvEbHAq zAdA~A (dObABKA)
C*        OCY}ECTBlqET ByBOd HA TEPMiHAl OblACTi MOzY,
C*        zAdAHHOj iMEHEM B TAblicE  T P p.
C*
C*             OpiCAHiE diAlOgA:
C*             ------- ---------
C*     N   TEKCT BOpPOCA     CTPYKTYPA     pPiME~AHiE
C*                             OTBETA
C*
C*     1  <{ApKA zAdA~i>
C*     2  <dAj iMq>           iMq
C*                            OblACTi
C*     3  pAPAMETPy HAjdEHHOj
C*        OblACTi
C*     4  <pOCMOTPiM?>        dA/HET    YKAzyBAET HA
C*                                      vElAHiE pOdPObHO
C*                                      iCClEdOBATx OblACTx
C*     5  <C KAKOgO |lEMEHTA?>~iClO:
C*                            cElOE ili
C*                            BOCxMEPi~.
C*     6  <CKOlxKO?>           - " -
C*     7  <B KAKOM KOdE?>     <CiMBOl>  YKAzyBAET fOPMAT
C*                                      BydA~i
C*                                      (pOKA HE PEAlizOBAH)
C*     8  <pPOdOlviM?>        dA/HET    "dA" pEPEXOd HA p.4
C*                                      pOzBOlqET pPOCMATPiBATx
C*                                      PAzHyE Y~ACTKi
C*                                      OdHOj i TOj vE OblACTi
C*     9  <zAKOH~iM?>         dA/HET    "HET" pEPEXOd HA p.2
C*                                      pOzBOlqET zA OdiH
C*                                      CEAHC pPOCMOTPETx
C*                                      PAzli~HyE OblACTi
C*    10  <KOH~ili.>                    KOHEc PAbOTy pPOgPAMMy
C*
C*        pPiME~AHiq:
C*        ----------
C*             1.   ECli O~EPEdHOj OTBET zAKAH~iBAETCq
C*                  CiMBOlOM ";", TO OTBETy HA OCTAB{iECq
C*                  BOpPOCy YCTAHABliBA`TCq "pO YMOl~AHi`.
C*
C*             2.   dOpYCKAETCq HAbOP B OdHOj CTPOKE
C*                  pPOizBOlxHOgO ~iClA OTBETOB HA BOzMOvHyE
C*                  BOpPOCy.
C*                  pPi |TOM:
C*                       A)   OTBETy OTdElq`TCq dPYg OT dPYgA
C*                            CiMBOlOM ","
C*                       b)   OTBETA HA p.4 BOOb}E BydABATx
C*                            HE TPEbYETCq, EgO zHA~EHiE
C*                            OpPEdElqETCq iz KOHTEKCTA
C*                       B)   BMECTO OTBETA "dA" HA p. 8
C*                            HAbiPAETCq B KA~ECTBE PAzdEliTElq
C*                            CiMBOl ":"
C*                       g)   BMECTO OTBETA "HET" B p. 9
C*                            HAbiPAETCq CiMBOl "$".
C*
      COMMON /PAR42z/ IFRAG , ITYP  , KOD   , IGO   , IANSW(10)
     +,               LQUEST, I~Y{x , ITERMS, ITERMD, NO
     +,               IYES  , LENTH , ITPKAT, LANSW , LADRES
     +,               NAME(2),IQUEST(4,10),IDFLAS(10)
     +,               IDIVNU, IDIVNA
      DIMENSION IFRAG(15)
      COMMON /TPp42z/ ITBMEM(2,1024)
      KOD = ITERMS
  100 IGO = 1
      CALL DIALOG(IQUEST(1,IGO),LQUEST,-1)
C--
C--       2.   BOpPOC:  "dAj iMq"
C--
  200 IGO = 2
      CALL VZERO(IANSW(IGO),LANSW-IGO+1)
      IF (INSTEP(IGO))                    205,208,230
  205 CONTINUE
      CALL DIASCA
  208 CONTINUE
C--
C--       2.1. ObPAz pPABidxHyj?
C
      IF (ITYP .EQ. 4)                 GO TO   300
  230 CONTINUE
C
      CALL ERRPRT
                                        GO TO   205
C
C==========================================================
C
C--
C--       3.  i}EM iMq
C
  300 IGO = 3
      NAME(1) = IFRAG(1)
      NAME(2) = IFRAG(2)
      IANSW(IGO-1) = ISOTEX(IFRAG)
      DO 305 J=1,1024
          IEXAM = ITBMEM(1,J)
          IF (IANSW(IGO-1) .EQ. IEXAM) GO TO   320
          IF (IEXAM .EQ. 0)            GO TO   310
  305 CONTINUE
C--
C--       3.1. HE HA{li
C
  310 CALL DIALOG(IQUEST(1,IGO),LQUEST,-1)
                                       GO TO   900
C--
C--       3.2. HA{li
C
  320 CALL ByBKAT(ITBMEM(2,J))
      IANSW(IGO) = IEXAM
C
C===========================================================
C
C--
C--       4.   BOpPOC: "pOCMOTPiM"
C
  400 IGO = 4
      IF (KOD .EQ. ITERMD)             GO TO   715
      IF (KOD .NE. ITERMS .AND. KOD .NE. 0)
     *                                   GO TO   500
      IF (NOYES(IGO) .EQ. 0)             GO TO  900
C
C===========================================================
C
C--
C--       5.   BOpPOC:  "C KAKOgO |lEMEHTA?"
C
  500 IGO = 5
      CALL VZERO(IANSW(IGO),LANSW-IGO+1)
      IF (INSTEP(IGO))                   505,508,715
  505 CALL DIASCA
  508 IF(ITYP .EQ. 2 .OR. ITYP .EQ. 1) GO TO   510
      IF (ITYP .NE. 5)                 GO TO   530
      IFRAG = 0
C--
C--       5.1. BydATx BECx ObxEKT
C
  510 CONTINUE
      IANSW(IGO) = JBYT(IFRAG,1,24)
      IF (IANSW(IGO) .GT. 0)           GO TO   520
      IANSW(IGO) = 1
      IANSW(IGO+1) = LENTH
C--
C--       pOjdEM CPAzY zA KOdOM
C
                                       GO TO   700
C--
C--       5.2. pPOBEPiM diApOzOH
C
  520 CONTINUE
      IF (IANSW(IGO) .GE. 1 .AND. IANSW(IGO) .LE. LENTH)
     *                                 GO TO   600
  530 CALL ERRPRT
                                       GO TO   505
C
C===========================================================
C
C--
C--       6.   BOpPOC:  "CKOlxKO?"
C
  600 IGO = 6
      IF (INSTEP(IGO))                   605,608,715
  605 CALL DIASCA
  608 IF (ITYP .EQ. 1 .OR. ITYP .EQ. 2)GO TO   610
      IF (ITYP .NE. 5)                 GO TO   620
      IANSW(IGO) = 1
                                       GO TO   700
C--
C--       6.1. pPOBEPiM OTBET
C
  610 CONTINUE
      IANSW(IGO) = JBYT(IFRAG,1,24)
      IF (IANSW(IGO-1)+IANSW(IGO)-1 .LE. LENTH)
     *                                 GO TO   700
  620 CALL ERRPRT
                                       GO TO   605
C
C===========================================================
C
C--
C--       7.   BOpPOC: "B KAKOM KOdE?"
C
  700 IGO = 7
C************* BPEMEHHAq zAglY{KA, pOClE PEAlizAcii - YbPATx *****
      IF (KOD .EQ. ITERMD)              GO TO   715
                                        GO TO   712
C*****************************************************************
      IF (INSTEP(IGO))                   705,708,715
  705 CALL DIASCA
  708 IF (ITYP .EQ. 4)                 GO TO   712
  710 CALL ERRPRT
                                       GO TO   705
C--
C--       OpPEdElEHiE HOMEPA iCpOlHiTElq
C
  712 CALL SRNPRT(IANSW(7))
                                       GO TO   720
  715 CALL DFLTPR
  720 NPRINT = IANSW(7)
      IF (NPRINT .LE. 0)               GO TO   710
      CALL WRKPRT(NPRINT)
C
C===========================================================
C
C--
C--       8.   BOpPOC: 'pPdOlviM?'
C
  800 IGO = 8
      IF (KOD .EQ. IDIVNU)       IANSW(IGO) = 1
      IF (KOD .EQ. IDIVNA)       IANSW(IGO) = 2
      IF (NOYES(IGO) .EQ. 1)             GO TO  500
C--
C--        9.   BOpPOC: 'zAKOH~iM?'
C
  900 IGO = 9
      IF (KOD .EQ. IDIVNA)       IANSW(IGO) = 2
      IF (NOYES(IGO) .EQ. 0)             GO TO   200
 1000 CONTINUE
      IGO = 10
      CALL DIALOG(IQUEST(1,IGO),LQUEST,-1)
      CALL QEND
      STOP
      END
      SUBROUTINE NEEDRS
C------------------------------------------------
C     pOdpPOgPAMMA pOdgOTOBKi i pE~ATi
C     HA TT COOb}EHiq O TPEbY`}iXCq
C     MAgHiTHyX lEHTAX i diCKAX.
C------------------------------------------------
      COMMON /STREAM/ ASTR5,ASTR6,ASTR7,ASTRA,TSTRE(62)
      COMMON /UPAS/ X1,B(48),NAM(3),NAM1(3)
     1,TIN,DIN(3),TUS,LPUS,NPMD
     2,ML1(16),MD1(16),ML(16),MD(16)
     3,PUST
     4,KKKK
      COMMON /TUST/ DTAP(32),DMOD(16)
      COMMON /RESURS/ SV(32),TABLE(32,2)
      COMMON /KONF/ U5,U6,U7
      COMMON /PAR/ ID,ID1000
      COMMON /TEXT/ ITEXT(14),TPRINT(9)
      DIMENSION KTABL(24)
      DIMENSION TABL(24)
     1,DEC(40)
      INTEGER ASTR5,ASTR6,ASTR7,ASTRA,TSTRE,TPRINT,DEC
     1,B,RES,ASTRE,ASTR,RESU,TABL,U5,U6,U7,U
     2,DTAP,DMOD
     4,SV,TABLE,TIN,DIN,TUS,X1
      DATA(B=48(0))
      DATA KT/1H /
      DATA (U5=32),(U6=4),(U7=2)
      LD=0
      CALL HAVERS(LD)
      LD=1
      CALL HAVERS(LD)
      KLU=1
      KDU=1
      DO 20 K=1,24
   20 TABL(K)=KT
      DO 1 K=1,3
      GO TO (100,101,102),K
  100 ASTR=ASTR7
      ASTRE=ASTRA
      U=U7
      GO TO 103
  101 ASTR=ASTR6
      ASTRE=ASTR7
      U=U6
      GO TO 103
  102 ASTR=ASTR5
      ASTRE=ASTR6
      U=U5
  103 CONTINUE
   23 CONTINUE
   24 CONTINUE
      DO 200 II=1,U
    4 IF(ASTR.EQ.ASTRE) GO TO 1
      CALL GIVPAS((TSTRE(ASTR)-1)*16)
      ASTR=ASTR+1
      KL=B(42)+B(43)*2+B(44)*4+B(45)*8
      KD=B(38)+B(39)*2+B(40)*4+B(41)*8
      IF(KLU.GT.16.AND.KDU.GT.8) GO TO 1000
      IF(KLU.GT.16) GO TO 10
      IF(KL.EQ.0) GO TO 10
      DO 5 I=1,KL
      IF(ML(I).EQ.7777 7777 7777 7777B) GO TO 5
      ENCODE(16,500,DEC) ML(I)
      DECODE(12,501,DEC) III
  500 FORMAT(O16)
  501 FORMAT(O12)
      IF(III.EQ.0B) GO TO 5
      DO 6 L=1,32
      IF(ML(I).EQ.DTAP(L)) GO TO 5
    6 CONTINUE
    7 IF((KLU-1).NE.0) GO TO 8
   21 TABL(KLU)=ML1(I)
      KTABL(KLU)=ML(I)
      KLU=KLU+1
      GO TO 5
    8 DO 9 L=1,KLU
      IF(ML(I).EQ.KTABL(L)) GO TO 5
    9 CONTINUE
      GO TO 21
    5 CONTINUE
   10 IF(KDU.GT.8) GO TO 25
      IF(KD.EQ.0) GO TO 25
      DO 11 I=1,KD
      DO 14 L=1,16
      IF(MD(I).EQ.DMOD(L)) GO TO 11
   14 CONTINUE
   13 IF((KDU-1).NE.0) GO TO 15
   22 TABL(KDU+16)=MD1(I)
      KTABL(KDU+16)=MD(I)
      KDU=KDU+1
      GO TO 11
   15 DO 16 L=1,KDU
      IF(MD(I).EQ.KTABL(L+16)) GO TO 11
   16 CONTINUE
      GO TO 22
   11 CONTINUE
   25 CONTINUE
  200 CONTINUE
    1 CONTINUE
 1000 I=1
      DO 40 L=1,24
      DECODE(6,54,TABL(L)) (DEC(LL),LL=1,6)
   40 ENCODE(5,55,TABL(L)) (DEC(LL),LL=2,6)
   54 FORMAT(6A1)
   55 FORMAT(5A1)
      IF(KLU.NE.1.OR.KDU.NE.1) GO TO 130
      CALL PRUS4
      RETURN
  130 CALL PRUS1
      DO 105 K=1,3
      GO TO (110,111,112),K
  110 IF(KLU.EQ.1) GO TO 105
      IF(KLU.LE.8) GO TO 70
      J=8
      GO TO 113
   70 J=KLU-1
      GO TO 113
  111 IF(KLU.LE.8) GO TO 105
      J=KLU-1
      GO TO 113
  112 IF(KDU.EQ.1) GO TO 105
      J=KDU+15
  113 CONTINUE
      DO 60 I=1,9
   60 TPRINT(I)=KT
      I=8*K-7
      M=1
      DO 106 L=I,J
      IF(K.EQ.3) GO TO 120
      DECODE(5,55,TABL(L)) DEC(M),DEC(M+1),DEC(M+2),DEC(M+3),DEC(M+4)
      M=M+5
      GO TO 106
  120 CONTINUE
      DECODE(4,50,TABL(L)) DEC(M),DEC(M+1),DEC(M+2),DEC(M+3)
      M=M+4
  106 CONTINUE
   50 FORMAT(4A1)
      M1=M-1
      M2=(M1/4-1)+M1+5
      IF(K.EQ.3) GO TO 107
      M=(M1+M1/5+4)/6+1
      M2=(M1/5-1)+M1+5
      ENCODE(M2,51,TPRINT) (DEC(LL),LL=1,M1)
      GO TO 108
  107 CONTINUE
      M=(M1+M1/4+4)/6+1
      ENCODE(M2,52,TPRINT) (DEC(LL),LL=1,M1)
  108 CONTINUE
   51 FORMAT('Ml - ',5A1,7(',',5A1))
   52 FORMAT('Md - ',4A1,7(',',4A1))
      IF(M.LT.9) TPRINT(M+1)=KT
      CALL PRUS2
  105 CONTINUE
      CALL PRUS3
      RETURN
      END
      FUNCTION NOYES(IGO)
C.
C...      OpPEdElEHiE OTBETA TipA: 'dA/HET' HA {AgE 'IGO'
C.
C. -------------------------------------------------------
C
      COMMON /PAR42z/ IFRAG , ITYP  , KOD   , NGO   , IANSW(10)
     +,               LQUEST, I~Y{x , ITERMS, ITERMD, NO
     +,               IYES  , LENTH , ITPKAT, LANSW , LADRES
      DIMENSION IFRAG(15)
C
      I~Y{x = 0
      IF (IANSW(IGO) .GT. 0)                GO TO   130
  105 CALL DIASCA
      IF (ITYP .NE. 4)                      GO TO   110
      IANSW(IGO) = 0
C
      IF (IFRAG .EQ. NO)      IANSW(IGO) = 2
      IF (IFRAG .EQ. IYES)    IANSW(IGO) = 1
      IF (IANSW(IGO) .GT. 0)                GO TO   130
C
  110 CALL ERRPRT
                                             GO TO   105
  130 NOYES = 2-IANSW(IGO)
      RETURN
      END
      SUBROUTINE ObPACT
C
C*****    ObPAbOTKA iHvEHEPHOj CTATiCTiKi
C
C
C*****    zAdEjCTBOBAHHyE KOdy COOb}EHij
C         ( 1-q cifPA : Tip 1 ,
C           2-q cifPA : Tip 2 )
C
C     00 - zApYCK diCpET~EPA
C     01 - CbPOC  diCpET~EPA
C     02 - ACTPOHOMi~ECKOE BPEMq
C     03 - METKA BPEMEHi
C     04 - KOHEc zAdA~i
C     05 - zApYCK zAdA~i
C     1* - O{ibKi Mb
C     20 - pOqBilACx Ml
C     21 - CHqli Ml
C     22 - O{ibKi Ml
C     30 - pOqBilCq dp
C     31 - CHqli dp
C     3* - O{ibKi Md
C     4* - O{ibKi p|M
C     5* - O{ibKi : K~ bPz
C     6* - O{ibKi : K~ MOzY
C     7* - O{ibKi : KK
C     8* - ObHYlEHiE CTATiCTiKi
C
      COMMON /PRISN/MEND,MNZ,TYPE,DAT(2),DAT1(2),TYPE2,NCM,NFM
      COMMON /ONE/TY1,TY2,ADR,XA(16),LXA
      COMMON /GEN/{Ap(6),YCTP(3,10)
      COMMON/TABLE/HBP(4),IDATB,IDATE,ND
     * ,KbPz,bPz(8),K~,KK,NJOB,pi(81,4),Mb(4,512)
     * ,MlCT(7,32),MdCT(11,16),NMO,MOzO{(2,256)
     * ,MlCb,MlO{(5000),MdCb,MdO{(5000)
      COMMON/XAPMld/NMl,NZON,KO{(9),NHAPb
      COMMON /JOBS/ JNC(3),JNR(3),NMB,JNS(3),JNS0(3),JKS(3),JCS(3)
     *         ,JKS0(3),JCS0(3),JKM(3),JCM(3) ,NJM(3)
      COMMON /JOBS1/ NEJC(3),NEJK(3),NEJC1(3),NEJK1(3),TJSC(23),TJSK(23)
      REAL NEJC,NEJK,NEJC1,NEJK1
      REAL JKS,JCS,JKS0,JCS0
     * ,JKM,JCM,JDM,JWM
      DIMENSION TIMD(4,200),AT(2)
     * ,Ml(4,512),HBPM(2),RMl(4,512),Md(4,200),RMd(4,200),YTEPBP(3)
     * ,CTMl(7,32),CTMd(11,16)
     * ,MlgT(32),MdgT(16),NRJ(2),PBP(2)
      INTEGER TYPE,TYPE2,DAT,DAT1,TY1,TY2,YCTP
     * ,SW1,SW2,SW3, BP(8),pi
     * ,FIRST,ADR,bPz,NbPz(8)
      INTEGER MOzY(5),TMOz(5),zAgOlY(18),TEXTY(3),TY,piT(4)
     * ,Mb1(16),Mb2(16),MbT(4)
     * ,MlT (9),MdT(12),MOzA(7),MOzK(7)
     * ,NYTEP(2)
      EQUIVALENCE ({Ap,Td),({Ap(2),Tv)
     * ,({Ap(3),IDAT)
     * ,({Ap(5),MAXP),({Ap(6),NBAD)
     * ,(XA,TD),(XA(2),TW),(XA(3),NAMl)
     * ,(Ml,RMl),(Md,RMd)
     * ,(HBP(1),TdC),(HBP(2),TvC)
     * ,(HBP(3),TJB),(HBP(4),TJC)
     * ,(MlT,MdT)
     * ,(MlCT,CTMl),(MdCT,CTMd)
     * ,(MlT,NYTEP),(NMl,NMd)
      DATA FIRST,NMO,KbPz,KK,K~,bPz/1,12*0/
     * ,NbPz/0,1,2,3,4,5,6,7/
     * ,TMOz/30HbPz/MOzY - HET
     * /
      DATA NTY/3/,YTEPBP/0.2,0.143,2.25/
     * ,TEXTY/18H  YBBK  AcpY   p|M/,zAgOlY/
     * 29HI  BBEdEHO  IzAMqlOI CbOjCi I,
     * 29HI pE~.liCTOBICbOjCiIiHTEPBAlI,
     * 29HIOTpEPfOPiP.IHEgOT.I  bPAK  I/
      DATA MbT/24H AdP   O{M   ObM   KC   /
      DATA HBP/4*0./,ND,NJOB/2*0/
     * ,pi,Mb,MlCT,MdCT,NMO,MlCb,MdCb
     * /324*0,2048*0,224*0,176*0,3*0/
     * ,Ml,Md/2048*0,800*0/
     * ,MEND,MNZ,NZN,MlY,MdY,NCOOb/6*0/
     * ,YCTP/30*0/
     * ,MlgT,MdgT/48*0B/
      DATA JNS,JNS0,JNC,JNR,NMB,NJM/16*0/
     * ,JKS,JCS,JKS0,JCS0/12*0./
      DATA NEJC,NEJK,NEJC1,NEJK1,TDM,TWM/14*0./
     * ,TJSC,TJSK/46*0./
C-----
      IF(TYPE2.EQ.63) GO TO 3000
    1 FORMAT(1H1)
      IF(TYPE.GT.5) STOP
      IF(TYPE.LE.1) GO TO 5
      CALL READST
      GO TO 999
    5 CONTINUE
      CALL dAjHA~
C
C*****    OCHOBHOj ciKl HAKOplEHiq
C
   10 CALL dAj|l
      IF(MNZ.EQ.0) GO TO 11
      NZN=NZN+1
      MNZ=0
   11 CONTINUE
      IF(MEND.NE.0) GO TO 998
      IF(FIRST.EQ.1) DAT=IDAT
      FIRST=0
      TD=TD-TDM
      NCOOb=NCOOb+1
      IF(TY1.GT.8) GO TO 10
      SW1=TY1+1
      GO TO (100,200,300,400,500,600,700,800,900),SW1
C
C*****    Tip 1 = 0 (Ob}iE fAKTy)
C
  100 IF(TY2.GT.5) GO TO 10
      SW2=TY2+1
      GO TO (110,120,130,140,150,160) , SW2
C-----
C     zApYCK diCpET~EPA
C-----
  110 ND=ND+1
      MAT=0
      DO 111 I=1,4
  111 TIMD(I,ND)=0
      JN=0$TDM=0.$TWM=0.
  112 CONTINUE
C.....   ObHYlEHiE pOTEPx
      DO 113 I=1,3
      JKM(I)=0.
  113 JCM(I)=0.
      DO 114 I=1,NCM
      TJSK=0.
  114 TJSC=0.
      GO TO 10
C-----
C     diCpET~EP CKOH~AlCq
C-----
  120 IF(TD.EQ.0) GO TO 10
C.....   Y~ET pOTEPqHHyX BPEMEH
      DO 125 I=2,3
      JNS0=JNS0+NJM(I)$JNS0(I)=JNS0(I)+NJM(I)
      JKS0=JKS0+JKM(I)$JKS0(I)=JKS0(I)+JKM(I)
      JCS0=JCS0+JCM(I)$JCS0(I)=JCS0(I)+JCM(I)
  125 CONTINUE
      DO 1125 I=1,NCM
      TJSK(I)=0.
 1125 TJSC(I)=0.
  121 CONTINUE
C.....   Y~ET TdiCp. , TvdY
      TW=TW-TWM
      IF(ND.EQ.0) ND=1
      TIMD(1,ND)=TD
      TIMD(2,ND)=TW
      TdC=TdC+TD
      TvC=TvC+TW
      IF(MAT.EQ.0) GO TO 122
      TS=AT-AT(2)
      TIMD(3,ND)=TS+TDM
      TIMD(4,ND)=TS+TD+TDM
C.....   HAPAbOTKA pO lEHTAM
  122 DO 123 I=1,MlY
      IF(RMl(4,I).NE.0.) GO TO 123
      RMl(3,I)=RMl(3,I)+TD
      NMl=Ml(1,I)-23
      CTMl(1,NMl)=CTMl(1,NMl)+TD
      IF(MEND.EQ.0) MlgT(NMl)=0B
      RMl(4,I)=1.
  123 CONTINUE
C.....   HAPAbOTKA pO diCKAM
      DO 124 I=1,MdY
      IF(RMd(4,I).NE.0.) GO TO 124
      RMd(3,I)=RMd(3,I)+TD
      NMd=Md(1,I)-23
      CTMd(1,NMd)=CTMd(1,NMd)+TD
      IF(MEND.EQ.0) MdgT(NMd)=0B
      RMd(4,I)=1.
  124 CONTINUE
C.....
      IF(MEND) 1999,10,1999
C-----
C     ACTPOHOMi~ECKOE BPEMq
C-----
  130 AT=XA(2)
      AT(2)=TD
      MAT=1
      GO TO 10
C-----
C     METKA BPEMEHi
C-----
  140 CONTINUE
C.....   zApOMiHAEM BPEMEHA zAdA~ HA METKY BPEMEHi
      NMB=NMB+1
      DO 141 I=1,2
      CALL PCp2BP(XA(I+1),XA(15),NJ)
      JNC=JNC+NJ
      NS=I+1
      JNC(NS)=JNC(NS)+NJ
      NJM(NS)=NJ
      JKM(NS)=XA(15)$JCM(NS)=XA(16)
  141 CONTINUE
      CALL RDJOBS(XA(4),NRJ)
      JNR=JNR+NRJ+NRJ(2)
      JNR(2)=JNR(2)+NRJ(1)
      JNR(3)=JNR(3)+NRJ(2)
      GO TO 10
C-----
C     KOHEc zAdA~i
C-----
  150 NJOB=NJOB+1
      CALL PCp2BP(XA(2),XA(15),NS)
      NJ=NS-NFM+1
      NS=ITYPJ(NS)
       XA(3)=XA(15)
       XA(4)=XA(16)
C.....   C~ET~iKi zAdA~
      JNS=JNS+1$JNS(NS)=JNS(NS)+1
C.....   KOM.BPEMEHA zAdA~
      JKS=JKS+XA(3)$JKS(NS)=JKS(NS)+XA(3)
C.....   C~ET.BPEMEHA zAdA~
      JCS=JCS+XA(4)$JCS(NS)=JCS(NS)+XA(4)
C.....   gACiM HAbPAHHyE BPEMEHA
      NJM(NS)=NJM(NS)-1
      IF(NJM(NS).LT.0) NJM(NS)=0
      JKM(NS)=JKM(NS)-XA(3)
      JCM(NS)=JCM(NS)-XA(4)
      IF(JKM(NS).GT.0.) GO TO 151
      JKM(NS)=0. $ JCM(NS)=0.
  151 CONTINUE
      IF(TJSK(NJ).EQ.0.) GO TO 152
      NEJK1=NEJK1+TJSK(NJ)
      NEJC1=NEJC1+TJSC(NJ)
      NEJK1(NS)=NEJK1(NS)+TJSK(NJ)
      NEJC1(NS)=NEJC1(NS)+TJSC(NJ)
      TJSK(NJ)=0.
      TJSC(NJ)=0.
  152 GO TO 10
C-----
C     zApYCK zAdA~i
C-----
  160 GO TO 10
C
C*****    Tip 1 = 1 (Mb-fAKTy)
C
  200 CALL AdPMb(XA(2),NTP)
      CALL Y~O{Mb(XA(3),Mb(1,NTP+1))
      GO TO 10
C
C*****    Tip 1 = 2 (Ml-fAKTy)
C
  300 CALL AdPMl(XA(2),NMl,NZON)
      NMf=NMl-23
       IF(TY2.EQ.0.AND.MlgT(NMf).NE.0B
     *.OR.TY2.EQ.0.AND.KOddBd(NAMl).EQ.0
     1.OR.TY2.EQ.1.AND.MlgT(NMf).EQ.0B)
     2 GO TO 10
      IF(TY2.EQ.0) GO TO 301
      IF(TY2.GT.1) XA(4)=XA(3)
      NAMl=MlgT(NMf)
      IF(TY2.GT.1.AND.NAMl.EQ.0B) GO TO 330
  301 DO 302 I=1,MlY
      IF(NMl.EQ.Ml(1,I).AND.NAMl.EQ.Ml(2,I)) GO TO 304
  302 CONTINUE
      IF(MlY.EQ.512) MlY=0
      MlY=MlY+1
      I=MlY
  304 SW2=TY2+1
      J=SW2
      IF(SW2.GT.3) SW2=3
      GO TO (310,310,330) , SW2
C-----
C     pOqBilACx Ml
C-----
  310 Ml(1,I)=NMl
      Ml(2,I)=NAMl
      IF(SW2.EQ.2) GO TO 320
      MlgT(NMf)=NAMl
      RMl(3,I)=RMl(3,I)-TD
      CTMl(1,NMf)=CTMl(1,NMf)-TD
      RMl(4,I)=0.
      GO TO 10
C-----
C     pPOpAlA Ml
C------
  320 RMl(4,I)=TD
      RMl(3,I)=RMl(3,I)+TD
      MlgT(NMf)=0B
      CTMl(1,NMf)=CTMl(1,NMf)+TD
      GO TO  10
C-----
C     O{ibKi pO Ml
C-----
  330 CALL Y~O{Ml(XA(4),KO{)
      DO 331 I=1,6
      IF(KO{(I).EQ.0) GO TO 331
      MlCT(I+1,NMf)=MlCT(I+1,NMf)+KO{(I)
  331 CONTINUE
      IF(NAMl.EQ.0B) GO TO 10
      NHAPb=0
      CALL O{MlMd(0,0)
      GO TO 10
C
C*****    Tip 1 = 3 (Md-fAKTy)
C
  400 CALL AdPMd(XA(2),NMd)
      NMf=NMd-23
       IF(TY2.GT.1.AND.MdgT(NMf).EQ.0B) GO TO 430
      DO 402 I=1,MdY
      IF(NMd.EQ.Md(1,I).AND.NAMl.EQ.Md(2,I)) GO TO 403
  402 CONTINUE
      IF(MdY.EQ.200) MdY=0
      MdY=MdY+1
      I=MdY
  403 SW2=TY2+1
      IF(SW2.GT.3) SW2=3
      GO TO (410,410,430) , SW2
C-----
C     pOqBilCq dp
C-----
  410 Md(1,I)=NMd
      Md(2,I)=NAMl
      IF(SW2.EQ.2) GO TO 420
      MdgT(NMf)=NAMl
      RMd(3,I)=RMd(3,I)-TD
      CTMd(1,NMf)=CTMd(1,NMf)-TD
      RMd(4,I)=0.
      GO TO 10
C-----
C     pPOpAl dp
C------
  420 RMd(4,I)=TD
      RMd(3,I)=RMd(3,I)+TD
      MdgT(NMf)=0B
      CTMd(1,NMf)=CTMd(1,NMf)+TD
      GO TO 10
C-----
C      O{ibKi pO Md
C-----
  430 CALL Y~O{Md(XA(4),KO{)
      DO 431 I=1,9
      IF(KO{(I).EQ.0) GO TO 431
      MdCT(I+1,NMf)=MdCT(I+1,NMf)+KO{(I)
  431 CONTINUE
       IF(MdgT(NMf).EQ.0B) GO TO 10
       NZON=0
      NHAPb=0
      CALL O{MlMd(1,0)
      GO TO 10
C
C*****    Tip 1 = 4 (pi-fAKTy)
C
  500 CALL Y~O{pi(XA(2),pi(1,2*TY2+1))
      GO TO 10
C
C*****    Tip1 = 5 (KOHTPOlx ~iClA - bPz)
C
  600 KbPz=KbPz+1
      bPz(TY2+1)=bPz(TY2+1)+1
      GO TO 10
C
C*****    Tip1 = 6 (KOHTPOlx ~iClA - MOzY)
C
  700 K~=K~+1
  701 NADR=ADR+TY2*32768
      CALL O{MOzY(NADR,1)
      GO TO 10
C
C*****    Tip1 = 7 (KOHTPOlx KOMAHdy)
C
  800 KK=KK+1
      GO TO 701
C
C*****    Tip1 = 8 (ObHYlEHiE CTATiCTiKi)
C
  900 TDM=TD$TWM=TW
      IF(IFLZ.EQ.1) GO TO 911
      DO 910 I=1,3
      NJM(I)=0
      JKM(I)=0.
  910 JCM(I)=0.
  911 IFLZ=1
      L1=LXA-1
      DO 901 I=1,L1
      CALL PCp2BP(XA(I+2),PBP,NS)
      NJ=NS-NFM+1
      NS=ITYPJ(NS)
      TJSK(NJ)=PBP(1)
      TJSC(NJ)=PBP(2)
      NJM(NS)=NJM(NS)+1
      JKM(NS)=JKM(NS)+PBP(1)
      JCM(NS)=JCM(NS)+PBP(2)
  901 CONTINUE
      GO TO 112
C
C*****    dO{li dO KOHcA CTATiCTiKi
C
  998 TD=Td-TDM
      TW=Tv
      GO TO 121
 1999 CONTINUE
      IF(TYPE.NE.1) GO TO 1995
      DO 1993 I=1,32
      IF(MlgT(I).EQ.0B) GO TO 1993
      CALL gOTMl(MlgT(I),I+23)
 1993 CONTINUE
      DO 1994 I=1,16
      IF(MdgT(I).EQ.0B) GO TO 1994
      CALL gOTMd(MdgT(I),I+23)
 1994 CONTINUE
 1995 IDATB=DAT
      IDATE=IDAT
      DO 1998 I=1,MlY
      NMl=Ml(1,I)
      NAMl=Ml(2,I)
      NHAPb=RMl(3,I)
      CALL CbHAPb(0,0)
 1998 CONTINUE
      DO 1997 I=1,MdY
      NMd=Md(1,I)
      NAMl=Md(2,I)
      NHAPb=RMd(3,I)
      CALL CbHAPb(1,0)
 1997 CONTINUE
      IF(TYPE.GT.1) GO TO 999
      DO 2997 I=1,NCM
      NEJK=NEJK+TJSK(I)
      NEJC=NEJC+TJSC(I)
      NS=ITYPJ(I+NFM-1)
      NEJK(NS)=NEJK(NS)+TJSK(I)
      NEJC(NS)=NEJC(NS)+TJSC(I)
 2997 CONTINUE
  999 CALL MA{HOM(Nb|CM)
      PRINT 98 , Nb|CM
   98 FORMAT(18X,27('*')/18X'*'25X'*'/
     * 18X'*  iHvEHEPHAq CTATiCTiKA  *'/
     * 18X'*       pO b|CM-6/'I1,7X'*')
      IF(IDATB.NE.IDATE) GO TO 1000
      CALL KOddAT(IDATB,DAT)
      PRINT 99 , DAT
   99 FORMAT(18X'*'8X'('A6,A2')'7X'*'/
     * 18X'*'25X'*'/18X,27('*')//)
      GO TO 1001
 1000 CALL KOddAT(IDATB,DAT)
      CALL KOddAT(IDATE,DAT1)
      PRINT 4100,DAT,DAT1
 4100 FORMAT(18X'*   ('A6,A2'-'A6,A2')   *'/
     * 18X'*'25X'*'/18X,27('*')//)
 1001 IF(TYPE.GT.1) GO TO 1004
      PRINT 101
  101 FORMAT(19X'BPEMEHA PAbOTy diCpET~EPA '//
     * 6X'N ByzOBAI  T diCp. I   T vdY  I'
     * '  HA~AlO  I  KOHEc   I'/6X,53('-'))
      DO 1003 I=1,ND
      DO 1002 J=1,4
 1002 CALL KOdBP(TIMD(J,I),BP(2*J-1),1)
      PRINT 102 , I , BP
  102 FORMAT(I13,X,4('I'A6,A4),'I')
 1003 CONTINUE
      PRINT 103
  103 FORMAT(6X,52('-')//)
 1004 CALL PRHEAD
      CALL PRTIMS
      IF(KbPz+K~+KK.EQ.0) GO TO 990
      PRINT 97
   97 FORMAT(1H1)
      IF(KbPz.EQ.0) GO TO 996
      DO 989 J=1,8
      INT=6H
      IF(bPz(J).EQ.0) GO TO 989
      ENCODE(6,4115,INT)  bPz(J)
  989 bPz(J)=INT
      PRINT 96 , NbPz,bPz
   96 FORMAT(22X'KOHTPOlx ~iClA - bPz'//
     * 8X,8(':bPz-'I1)':'/8X,49('-')/
     * 8X,8(':     ')':'/8X,8(':'A5)':'/
     * 8X,8(':     ')':'/8X,49('-')//)
  996 IF(K~+KK.EQ.0) GO TO 990
      PRINT 95
   95 FORMAT(22X'CBOdKA CbOEB MOzY'//
     * 6X,51('-'))
      PRINT 94
   94 FORMAT(6X'I')
      J=1 $ KY=128
  995 IF(J.GT.NMO) GO TO 991
      KY1=MOzO{(1,J)/32768
      IF(KY.EQ.KY1) GO TO 994
      KY=KY1
      PRINT 93 ,KY1
   93 FORMAT(6X'I KYb -'I2)
  994 DO 993 IP=1,7
      IF(J.GT.NMO) GO TO 992
      IF(KY1.NE.MOzO{(1,J)/32768)GO TO 992
      MOzA(IP)=MOzO{(1,J)-KY1*32768
      MOzK(IP)=MOzO{(2,J)
      J=J+1
  993 CONTINUE
      IP=8
  992 CONTINUE
      IP=IP-1
      PRINT 92,(MOzA(I),I=1,IP)
      PRINT 91,(MOzK(I),I=1,IP)
      PRINT 94
   92 FORMAT(6X'I'8X,7(X,O5,X))
   91 FORMAT(6X,'I'8X,7(X,I5,X))
      GO TO 995
  991 CONTINUE
      PRINT 90
   90 FORMAT(6X,51('-'))
  990 CONTINUE
C
C*****    PACpE~ATKA CTATiCTiKi pO YBBK,AcpY,p|M
C
      CALL DATAPR
      PRINT 106
  106 FORMAT(/16X'KPATKAq CBOdKA O PAbOTE  '
     * 'YBBK , AcpY , p|M'//)
      IN=1
      DO 1009 TY=1,NTY
      I1=(TY-1)*5+1
      I2=I1+4
      PRINT 107 , (zAgOlY(I),I=I1,I2)
  107 FORMAT(22X,5A6'  pOTEPi '/14X,48('-'))
      DO 1008 NY=1,2
      pOTEPq=(YCTP(2,IN)+YCTP(3,IN))*YTEPBP(TY)
      CALL KOdBP(pOTEPq,NYTEP,0)
      NYC=YCTP(1,IN)
      IF(IN.EQ.3.OR.IN.EQ.4) NYC=(NYC+36)/72
      PRINT 108 , TEXTY(TY),NY,NYC,(YCTP(I,IN),I=2,3),NYTEP
  108 FORMAT(14X,A6'-'I1'I'I10' I'I5' I' I7' I'A6,A4'I')
 1008 IN=IN+1
      PRINT  109
  109 FORMAT(14X,48('-')//)
 1009 CONTINUE
      IF(YCTP(3,5)+YCTP(3,6).EQ.0) GO TO 1015
      PRINT 4110
 4110 FORMAT(18X,28HpPi~iHy OTbPAKOBKi HA p|M'AX,///
     * 16X'I'5X'p | M - 1'5X'I'5X'p | M - 2'5X'I'/
     * 7X'N KOlOHKiI'19('-')'I'19('-')'I'/
     * 16X,2('IHEXBATAETI  li{HEE ')'I'/
     * 7X,50('-'))
      DO 1013 I=1,80
      DO 1010 J=1,4
      IF(pi(I,J).NE.0) GO TO 1011
 1010 CONTINUE
      GOTO 1013
 1011 DO 1012 J=1,4
      piT(J)=6H
      IF(pi(I,J).EQ.0) GO TO  1012
      ENCODE(6,4111,piT(J))  pi(I,J)
 4111 FORMAT(I6)
 1012 CONTINUE
      PRINT 4112,I,piT
 4112 FORMAT(I15,4(' I  'A6),' I')
 1013 CONTINUE
      PRINT 4113
 4113 FORMAT(7X,50('-'))
 1015 CONTINUE
C
C*****    PACpE~ATKA CTATiCTiKi pO Mb
C
      DO 986 I=1,4
      DO 986 J=1,512
      IF(Mb(I,J).NE.0) GO TO 987
  986 CONTINUE
      GO TO 988
  987 CONTINUE
      DO 1020 ITP=1,32
      IT1=ITP-1
      IF(IT1*(IT1-16).NE.0) GO TO 1016
      CALL DATAPR
      IT2=IT1+15
      PRINT 4114, IT1,IT2
 4114 FORMAT(/34X'CBOdKA O COCTOqHii Mb'/
     * 38X'(TPAKTy: 'O2'-'O2')'//
     * 6X'1-0I 1-1I 1-2I 1-3I 1-4I 1-5I 1-6I 1-7I '
     *   '2-0I 2-1I 2-2I 2-3I 2-4I 2-5I 2-6I 2-7I'/
     * 4X,81('-'))
 1016 IN=0
      DO 1019 I3=ITP,512,32
      IN=IN+1
      Mb1(IN)=4H
      Mb2(IN)=0
      DO 1018 J3=1,4
      IF(Mb(J3,I3).EQ.0) GO TO 1018
      Mb2(IN)=Mb2(IN)+Mb(J3,I3)
      IF(Mb1(IN).NE.4H    ) GO TO 1017
      Mb1(IN)=MbT(J3)
      GO TO 1018
 1017 Mb1(IN)=4H ---
 1018 CONTINUE
      INT=4H
      IF(Mb2(IN).EQ.0) GO TO 1019
      INT=4H****
      IF(Mb2(IN).GE.9999) GO TO 1019
      ENCODE(6,4115,INT)  Mb2(IN)
 4115 FORMAT(I4)
 1019 Mb2(IN)=INT
      PRINT 4116, IT1,Mb1,IT1,Mb2
 4116 FORMAT(X,O2'-I',16(A4'I')'-'O2/
     * 4X,16('I'A4),'I'/4X,16('I----')'I')
 1020 CONTINUE
C
C*********   PACpE~ATKA CTATiCTiKi pO Ml
C
  988 CONTINUE
      CALL DATAPR
      PRINT 4117
 4117 FORMAT(/15X'CBEdEHiq O PAbOTAB{iX MAgHiTOfOHAX'//
     * 4X'N Mf I HAPAbOTKAI O{MBY I zp-O{MIO{.ClClI'
     * 'KOH.ObMI  K C  I CbOjCiI'
     * /4X,65('-'))
      DO 1031 NMT=24,55
      NMT1=NMT/8
      NMT2=NMT-NMT1*8
      ENCODE(6,4118,MlT(1))  NMT1,NMT2
 4118 FORMAT(I1'-'I1)
      IND=NMT-23
      IF(CTMl(1,IND)) 1022,1031,1023
 1022 MlT(2)=6H
      MlT(3)=6H
      GO TO 1024
 1023 CALL KOdBP(MlCT(1,IND),MlT(2),0)
 1024 CONTINUE
      DO 1028 J6=2,7
      INT=6H
      IF(MlCT(J6,IND).EQ.0) GO TO 1028
      ENCODE(6,4111,INT)  MlCT(J6,IND)
 1028 MlT(J6+2)=INT
      PRINT 4120, MlT
 4120 FORMAT(5X,A4'I'A6,A4'I',10(A6' I'))
 1031 CONTINUE
      PRINT 4122
 4122 FORMAT(4X,65('-'))
      CALL PRMlMd(0)
C
C*****    PACpE~ATKA CTATiCTiKi pO diCKAM
C
      DO 1131 I=1,16
      DO 1131 K=2,10
      IF(MdCT(K,I).NE.0) GO TO 1132
 1131 CONTINUE
      GO TO 1040
 1132 CALL DATAPR
      PRINT 4121
 4121 FORMAT(/33X'CBEdEHiq O PAbOTAB{iX diCKOByX '
     * 'MOdYlqX '///
     * 3X'N MOd.I HAPAbOTKAI O { M IKC,AdP.I O{.YBYI O{.~T I'
     *' O{.BybIzApP.zpI O{.pK IKAlibP.I A C d I'/
     * 3X,90('-'))
      DO 1038 NMD=24,39
      NMT1=NMD/8
      NMT2=NMD-NMT1*8
      ENCODE(6,4118,MdT(1))  NMT1,NMT2
      IN3=NMD-23
      IF(CTMd(1,IN3)) 1032,1032,1033
 1032 MdT(2)=6H
      MdT(3)=6H
      GO TO 1034
 1033 CALL KOdBP(MdCT(1,IN3),MdT(2),0)
 1034 CONTINUE
      DO 1035 J7=2,10
      INT=6H
      IF(MdCT(J7,IN3).EQ.0) GO TO 1035
      ENCODE(6,4111,INT)  MdCT(J7,IN3)
 1035 MdT(J7+2)=INT
      PRINT 4120, MdT
 1038 CONTINUE
      PRINT 4123
 4123 FORMAT(3X,90('-'))
 1040 CONTINUE
      CALL PRMlMd(1)
      IF(TYPE.GT.1) GO TO 2000
      PRINT 80,NCOOb,NZN,NBAD,MAXP
   80 FORMAT(//15X,31('-')//
     * 16X'ObPAbOTAHO COOb}EHij-'I8/
     * 16X'KOl-BO zAHqTyX zOH  -'I8/
     * 16X'HEpPiHqTyX COOb}EHij-'I8/
     * 16X'MAKCiMAlxHOE KOl-BO'/
     * 16X'B OpEPAT. pAMqTi    -'I8//
     * 15X,31('-')//)
 2000 CONTINUE
      IF(TYPE.EQ.0) GO TO 2010
      CALL SUMWRS
      IF(TYPE.EQ.1)CALL CLESTA
 2010 STOP
 3000 CALL dAjHA~
 3001 CALL dAj|l
      IF(MNZ.EQ.0) GO TO 3010
      NZN=NZN+1
      MNZ=0
 3010 CONTINUE
      IF(MEND.NE.0) GO TO 3100
      NCOOb=NCOOb+1
      IF(TY1.GT.8) TY1=9
      IF(TY2.GT.5) TY2=6
      LL=TY1*100+TY2*10+(LXA+2)
      DO 3002 I=1,MdY
      IF(LL-Md(1,I)) 3005,3004,3002
 3002 CONTINUE
      I=MdY+1
 3003 MdY=MdY+1
      Md(1,I)=LL
 3004 Md(2,I)=Md(2,I)+1
      Md(3,I)=Md(3,I)+(LXA+2)
      GO TO 3001
 3005 J=MdY
 3006 IF(J.LT.I) GO TO 3008
      DO 3007 K=1,3
 3007 Md(K,J+1)=Md(K,J)
      J=J-1
      GO TO 3006
 3008 DO 3009 K=1,3
 3009 Md(K,I)=0
      GO TO 3003
 3100 CONTINUE
      LLS=0
      PRINT 3200,NCOOb,NZN
 3200 FORMAT(/' COOb}EHij -'I5' , zOH-'I2)
      DO 3101 I=1,MdY
      PRINT 3201 , (Md(J,I),J=1,3)
 3201 FORMAT(/' XC='I3' , NC='I5' , LC='I5)
 3101 LLS=LLS+Md(3,I)
      PRINT 3202,LLS
 3202 FORMAT(/' KOl-BO ClOB-'I5)
      STOP
      END
      SUBROUTINE O{MOzY(NADR,KOl)
C     CbOP O{ibOK pO MOzY
C     NADR-AdPEC pAMqTi
C     KOl-KOli~ECTBO O{ibOK
      COMMON/TABLE/HBP(4),IDATB,IDATE,ND
     * ,KbPz,bPz(8),K~,KK,NJOB,pi(81,4),Mb(4,512)
     * ,MlCT(7,32),MdCT(11,16),NMO,MOzO{(2,256)
     * ,MlCb,MlO{(5000),MdCb,MdO{(5000)
      DO 10 I=1,NMO
      IF(MOzO{(1,I  )-NADR)10,1,2
    1 MOzO{(2,I)=MOzO{(2,I)+KOl
      RETURN
    2 IF(NMO.EQ.256) GO TO 12
      NMO=NMO+1
      L=NMO
    3 MOzO{(1,L)=MOzO{(1,L-1)
      MOzO{(2,L  )=MOzO{(2,L-1)
      L=L-1
      IF(L.NE.I) GO TO 3
    4 MOzO{(1,I  )=NADR
      MOzO{(2,I)=KOl
      RETURN
   10 CONTINUE
      IF(NMO.EQ.256) NMO=0
      NMO=NMO+1
   11 I=NMO
      GO TO 4
   12 NMO=1
      GO TO 11
      END
      SUBROUTINE P1Z(ID,NP,NCH)
      COMMON /TD/ NH,NPZ,NZINC,NT,NMS /PAGE/ MAR(1024),MSTABL(1015)
      COMMON /LINK/NAMDIS, NCHANA,MOD,NPATH,IFL,NR
      COMMON /KODA/KD(2)
      DATA KD /2525252525252525B,
     *         5252525252525252B/
      DATA MSTABL /1015*0/
      NTI=1-ID+ID*NT$ NPZ=3-NH/10$ KMS=NMS+1
      DO 5 J=1,KMS
      DO 1 I=1,NPZ
      NPTH=NP*NPZ-1+I
      NR=NCH*NPZ-1+I
      CALL PREPPA(J,NPTH,ID)
      NPATH=NP+(I-1)*2048
      CALL CRHEAD
      IF(IFL.EQ.1)GO TO 1
      CALL PRERR(J-1,I,ID,NCH)
      CALL plOObM
    1 CONTINUE
      NPATH=NP
      DO 2 K=2,1022,2
      MAR(K-1)=KD(1)
   2  MAR(K)=KD(2)
      MAR(1023)=7777777777777777B
      DO 3 I=1,NTI
      MAR(1024)=I$ CALL WRITE
      IF (IFL.NE.1) GO TO 4
      CALL COMP
      IF (IFL.NE.1) GO TO 4
      CALL READ
      IF (IFL.NE.1) GO TO 4
    3 CONTINUE
      IF (J.EQ.1) RETURN
      LW=NPATH/4$ LP=NPATH-4*LW
      MSTABL(LW+1)=MSTABL(LW+1)+(J-1)*256**LP
      RETURN
    4 NTI=NT
    5 CALL PRERR(J-1,I,ID,NCH)
      RETURN
      END
      SUBROUTINE PAMET
C   p/p PAzMETKi OdHOgO pAKETA Md.
C   COMMON /TD/:   NH - ~iClO gOlOBOK HMd,   NPZ - ~iClO dOPOvEK HA Od-
C   HY zOHY,   NZINC - ~iClO zOH B ciliHdPE,   NT - ~iClO pPOBEPOK HE
C   O~EHx XOPO{iX zOH,   NMS - dOpYCTiMOE CME}EHiE zAgOlOBKA.
C   NOCH - flAg blOKiPOBKi zAMEH (1 OzHA~AET blOKiPOBKY).
C    COMMON /LINK/:   NAMDIS - iMq pAKETA,   NCHANA - HOMEP HApPABlE-
C   Hiq,   MOD - HOMEP MOdYlq,   NPATH - HOMEP dOPOvKi dlq ObMEHA,
C   IFL - flAg ABPii ObMEHA,   NR - HOMEP dOPOvKi zAMEHy.
C   KOPC - KOpiq PEgiCTPA COCTOqHij.
      COMMON /MER/ MAER(64)
      COMMON /TD/ NH,NPZ,NZINC,NT,NMS,NOCH
      COMMON /LINK/ NAMDIS,NCHANA,MOD,NPATH,IFL,NR,KOPC
      COMMON /PAGE/ IIPAG2(2048)
      DIMENSION NREZP(61)
      DATA NT,NMS /5,10/
      DATA NREZP /61*0/
      CALL SETNAM
      NPZ=3-NH/10$ NZINC=35-15*NPZ
      KC=200*NZINC$ KR1=KC+1$ KR2=KC+3*NZINC
      JB=0$ JR=1
      DO 2 N=KR1,KR2
      CALL P1Z(0,N-1,0)
      IF (IFL.NE.1) GO TO 1
      NREZP(JR)=N$ JR=JR+1$ GO TO 2
    1 MAER(JB+2)=N-1$ JB=JB+1
    2 CONTINUE
      JR=0
      DO 3 N=1,KC
      CALL P1Z(0,N-1,0)
      IF (IFL.EQ.1) GO TO 3
      MAER(JB+2)=N-1$ JB=JB+1
      IF (NOCH.EQ.1) GO TO 3
      JR=JR+1$ MAER(JB+1)=MAER(JB+1)+NREZP(JR)*4096-4096
      IF (NREZP(JR).EQ.0) CALL plOpAK
      CALL P1Z(1,N-1,NREZP(JR)-1)
      IF (IFL.NE.1) CALL plOpAK
    3 CONTINUE
      MAER(1)=JB$ RETURN
      END
      SUBROUTINE PECH
      COMMON/TAbl/TAbl(4)
      COMMON/K/K
      GO TO(1,2,3,4,5,6),K
 1    PRINT 10
      J=0
      GO TO7
2     PRINT13,(TAbl(I),I=1,4)
      J=1
      PRINT 14
      RETURN
3     PRINT 12
7     PRINT 11
      PRINT 14
      RETURN
5     PRINT15,(TAbl(I),I=1,4)
      PRINT14
      RETURN
6     PRINT16,(TAbl(I),I=1,3)
      PRINT14
      PRINT 11
      RETURN
4     CONTINUE
      IF(J.EQ.0) PRINT 17
      PRINT 11
      RETURN
10    FORMAT(//1X,22HCiCTEMHyE i PAbO~iE Ml//)
11    FORMAT(24(1H-))
12    FORMAT(//8X,9HSCR-fAjly//)
13    FORMAT(3HI  ,A6,A5,2X,O2,2X,A1,3H  I)
14    FORMAT(1HI,22X,1HI)
15    FORMAT(3HI  ,A1,O2,2X,O2,2X,O4,8H       I)
16    FORMAT(3HI  ,A6,A6,O6,3H  I)
17    FORMAT(1HI,9X,3HHET,10X,1HI/1HI,22X,1HI)
      END
      SUBROUTINE PECH1
      COMMON/TEXT/TEXT(4)
      COMMON/K/K(1)
      IF(K)1,3,1
 3    PRINT 10
      PRINT 11
 1    PRINT 12,(TEXT(I),I=1,3)
      K=K+1
      PRINT 13
      GO TO 2
      ENTRY PCHER
 4    PRINT 11
 10   FORMAT(//3X,15HMOdEli Ml HA Md//)
 11   FORMAT(22(1H-))
12    FORMAT(3HI  ,2A6,A4,3H  I)
 13   FORMAT(1HI,20X,1HI)
 2    RETURN
      END
      SUBROUTINE PLAN(ID)
      COMMON /TIME/ TIME5,TIME6
      COMMON /STREAM/ ASTR5,ASTR6,ASTR7,ASTRA,TSTRE(62)
      COMMON /UPAS/ X1,B(48),NAM(3),NAM1(3)
     1,TIN,DIN(3),TUS,LPUS,NPMD
     3,ML(16),Md(16),Ml1(16),Md1(16)
      DIMENSION TIME(62)
     1,INPD(62)
      INTEGER ASTR5,ASTR6,ASTR7,ASTRA,TSTRE
     1,TIME5,TIME6
     2,TIME,B,TIN,DIN,TUS,X1
     3,TSHI
      I=1
      M=1
      IF(ID.NE.1) GO TO 104
      ASTR5=M
      TSHI=10000
      LSHI=0
      GO TO 103
  104 DO 1 K=1,3
      M=M+I-1
      I=1
      GO TO (100,101,102),K
  100 TSHI=TIME5
      LSHI=0
      ASTR5=M
      GO TO 103
  101 TSHI=TIME6
      LSHI=TIME5
      ASTR6=M
      GO TO 103
  102 TSHI=10000
      LSHI=TIME6
      ASTR7=M
  103 DO 2 J=1,61
      CALL GIVPAS((J-1)*16)
      IF(B(48).EQ.B(37)) GO TO 2
      IF(B(46).EQ.1) GO TO 2
      IF(TUS.GT.TSHI.OR.TUS.LE.LSHI) GO TO 2
      CALL PDAT(DIN)
      IF(I.NE.1) GO TO 3
      TIME(1)=TIN
      INPD(1)=DIN
      TSTRE(M)=J
      GO TO 6
    3 N=I
      N1=M+I-1
      DO 4 L=1,61
      IF(DIN.GT.INPD(N-1)) GO TO 5
      IF(TIN.GE.TIME(N-1)) GO TO 5
      TIME(N)=TIME(N-1)
      INPD(N)=INPD(N-1)
      TSTRE(N1)=TSTRE(N1-1)
      N=N-1
      N1=N1-1
      GO TO 4
    5 TIME(N)=TIN
      INPD(N)=DIN
      TSTRE(N1)=J
      GO TO 6
    4 CONTINUE
    6 I=I+1
    2 CONTINUE
      IF(ID.EQ.0) GO TO 1
      ASTR6=M+I-1
      ASTR7=ASTR6
      GO TO 106
    1 CONTINUE
  106 CONTINUE
      ASTRA=M+I-1
      RETURN
      END
      SUBROUTINE PRCI1
      COMMON /TYPE/ ITYP,SHI(4),NFC,NFZ,NRJ
      COMMON /UPAS/ X1,B(48),NAM(3),NAM1(3)
     * ,TIN,DIN(3),TUS,LPUS,NPMd
     * ,Ml(16),Md(16),Ml1(16),Md1(16)
     * ,LINC
      COMMON /OUTP/ NByB(62),NAMO(3,62)
      COMMON /PTAB/ WR,I,WR1,WR2,TBy,TI1,TI2,TPMd,IM
      COMMON /TEXT/ ITEXT(14) /PAR/ ID,ID1
      COMMON/T/ITT(14)
      DIMENSION INF(13,5,6)
      INTEGER WR,WR1,WR2,TBy,TI1,TI2,TPMd
     * ,TIN,DIN,TUS
      IF(ID-1) 1,2,3
1     J=0
      RETURN
2     PRINT 100
100   FORMAT(X,96('-')/
     * '  N BB IO{ BBICBqzxI *NAME'13X'I  BPEMq BBOdA I'
     * 'N ByBI BPEMq IpE~ATxI  Ml  I  Md  IPAb.MdI')
1082  FORMAT(7X'I'2(5X'I'),19X'I'14X'I'5X'I'7X'I'4(6X'I'))
1081  FORMAT(X'------I'2('-----I'),19('-')'I'14('-')
     * ,'I-----I-------I'4('------I'))
      J=0
      RETURN
    3 CONTINUE
      ENCODE(80,301,ITT)
  301 FORMAT(7X,'*** KATAlOg BBOdA ***'20X
     *'00/00/00'4X'00.00.00'12X)
      CALL DATIME
      CALL VTPRI(ITT,14)
      ENCODE(80,302,ITT)
  302 FORMAT(79(1H-),X)
      CALL VTPRI(ITT,14)
      DO 303 L=1,13
      DO 303 M=1, 5
      DO 303 N=1, 6
  303 INF(L,M,N)=1H
      II=1 $ JJ=1
      RETURN
      ENTRY PRCI2
      IF(ID-1) 4,5,6
4     CONTINUE
      IF(I.LT.ID1) RETURN
      IF(J.GT.7) RETURN
      ENCODE(21,4004,ITEXT) I,NAM
4004  FORMAT(O2':'3A6)
      CALL FTTPRI(ITEXT,4)
      J=J+1
      RETURN
5     PRINT 1081
      PRINT 106,WR,I,WR1,WR2,NAM,TI1,DIN(1),DIN(2),TBy
     * ,TI2,LPUS,Ml(1),Md(1),TPMd
106   FORMAT(X,A3,O2,X,2('I'A5)'I '3A6'I'A6'/'A2'.'A2'/ I'
     * ,A5'I'A6' I'I5' I',3(A6'I'))
      J=1
      RETURN
    6 CONTINUE
      INF(II,JJ,1)=WR2
      IF(WR.EQ.1H ) GOTO 607
       IF(WR.EQ.3H+++) GOTO 606
      INF(II,JJ,2)=1H/
      GOTO 607
  606 INF(II,JJ,2)=1H*
  607 CONTINUE
      ENCODE(6,605,INF(II,JJ,3))I
  605 FORMAT(O2,4X)
      INF(II,JJ,4)=2H00
      IF(TBy.NE.1H ) DECODE(6,602,TBy) INF(II,JJ,4)
  602 FORMAT(2X,A2,2X)
      INF(II,JJ,5)=NAM(1)
      INF(II,JJ,6)=NAM(2)
      IF(II.EQ.13) GOTO 603
      II=II+1
      RETURN
  603 II=1 $ JJ=JJ+1
      RETURN
      ENTRY PRCI3
      IF(ID-1) 7,8,9
7     RETURN
8     PRINT 108,Ml(IM),Md(IM)
108   FORMAT(7X'I'2(5X'I'),19X'I'14X'I'5X'I'7X'I'6X'I'
     * ,2(A6'I'),6X'I')
      RETURN
9     RETURN
      ENTRY PRCI4
      IF(ID-1) 10,15,12
10    IF(J.NE.0) RETURN
      ENCODE(3,4010,ITEXT)
4010  FORMAT('HET')
      CALL FTTPRI(ITEXT,1)
      RETURN
 15   CONTINUE
      IF(J.EQ.0) PRINT 1082
      PRINT 110
  110 FORMAT(X,96('-')/)
      PRINT 112,NFC,NFZ
  112 FORMAT(25X'CBObOdHO : pACpOPTOB - 'O2' , zOH - 'O3/)
      IF(NRJ.NE.0) GO TO 11
      PRINT 114
  114 FORMAT(25X'gOTOByX zAdA~ HET !!!')
      GO TO 13
   11 WR=6H
      IF(NRJ.LE.3) WR=6HBCEgO
      PRINT 116,WR,NRJ
  116 FORMAT(25X'gOTOByX zAdA~ 'A6'-'I3)
   13 CONTINUE
      RETURN
   12 CONTINUE
      DO 1202  JS=1,13
      ENCODE(80,101,ITEXT)(((INF(IK,JK,KK),KK=1,6),
     * JK=1,5),IK=JS,JS)
  101 FORMAT(5(A1,A1,A2,A2,X,A6,A2,X))
      IF(ITEXT.EQ.1H ) GOTO 1202
      CALL VTPRI(ITEXT,14)
 1202 CONTINUE
      RETURN
      END
      SUBROUTINE PRCO1
      COMMON/OUTCAT/ LNK(63),IRD(63),NBB(63),NM(189)
      COMMON/T/ITT(14)
      COMMON/TEXT/ITEXT(14)/PAR/ID,ID1
        DIMENSION INF(13,5,6)
      IF(ID-1)1,2,3
    1 RETURN
    2 RETURN
    3 CONTINUE
      IF(ID-3)300,200,298
  200 CONTINUE
      RETURN
  298 CONTINUE
      IF (ID1.GE.4) CALL END
      ENCODE (80,290,ITT)
      GOTO 299
  290 FORMAT (7X'*** KATAlOg gPAf-ByBOdA',
     *' i dAHHyX ***'5X,
     * '00/00/00'4X'00.00.00'12X)
  300 CONTINUE
      ENCODE(80,301,ITT)
  301 FORMAT(7X'*** KATAlOg ByBOdA ***'19X,
     * '00/00/00'4X'00.00.00'12X)
  299 CONTINUE
      CALL DATIME
      CALL VTPRI(ITT,14)
      IF (ID.LT.4) GOTO 304
      IF (ID1-2) 309,310,311
C  308 - pPiKAz gPA/
C    309 - pPiKAz 1gPA/
  309 ENCODE (80,3090,ITT)
 3090 FORMAT (7X'*** ~ACTx 1.   HOMEPA 001 - 077B ***'37X)
      GOTO 305
C    310 - pPiKAz 2gPA/
  310 ENCODE (80,3100,ITT)
 3100 FORMAT (7X'*** ~ACTx 2.   HOMEPA 101 - 177B ***'37X)
      GOTO 305
C    311 - pPiKAz 3gPA/
  311 ENCODE (80,3110,ITT)
 3110 FORMAT (7X'*** ~ACTx 3.   HOMEPA 201 - 277B ***'37X)
      GOTO 305
  304 CONTINUE
      ENCODE(80,302,ITT)
  302 FORMAT(79(1H-),X)
  305 CONTINUE
      CALL VTPRI(ITT,14)
      DO 303 L=1,13
      DO 303 M=1, 5
      DO 303 N=1, 6
  303 INF(L,M,N)=1H
      II=1 $ JJ=1
      RETURN
      ENTRY PRCO2
      IF(ID-1) 4,5,6
    4 RETURN
    5 RETURN
    6 CONTINUE
      DO 611 KS=1,63
      IF(LNK(KS).EQ.0) GOTO 611
      IF(LNK(KS).EQ.4) GOTO 604
      INF(II,JJ,1)=1HC
      IF(LNK(KS).EQ.1) INF(II,JJ,1)=1HT
  604 CONTINUE
      ISWI=IRD(KS)+1
      GOTO (641,641,643,643,645,645,
     *607,607,607,650,643,643),ISWI
  641 CONTINUE
      I=1H*
      GOTO 606
  643 CONTINUE
      I=1H+
      GOTO 606
  645 CONTINUE
      I=1H/
      GOTO 606
  650 CONTINUE
      I=1Hb
      GOTO 606
  606 CONTINUE
      INF(II,JJ,2)=I
  607 CONTINUE
      IF (NBB(KS)-63)590,590,500
  500 CONTINUE
      ISWI=NBB(KS)-400
      GOTO (401,402,403,404,405,406,407,
     *407,407,407,407,407,407,407,415),ISWI
  401 CONTINUE
      I=2HMZ
      GOTO 520
  402 CONTINUE
      I=2HMH
      GOTO 520
  403 CONTINUE
      I=2HSR
      GOTO 520
  404 CONTINUE
      I=2HSP
      GOTO 520
  405 CONTINUE
      I=2HSU
      GOTO 520
  406 CONTINUE
      I=2HSA
      GOTO 520
C  PEzEPB  TipOB
  407 CONTINUE
      I=2H
      GOTO 520
C
  415 CONTINUE
      I=2HdB
  520 INF(II,JJ,3)=I
      GOTO 599
  590 CONTINUE
      ENCODE(6,605,INF(II,JJ,3))NBB(KS)
  605 FORMAT(O2,4X)
  599 CONTINUE
      ENCODE(6,605,INF(II,JJ,4))KS
       INF(II,JJ,5)=NM(3*KS-2)
      INF(II,JJ,6)=NM(3*KS-1)
      IF(INF(II,JJ,5).EQ.1H ) INF(II,JJ,6)=1H
      IF(II.EQ.13) GOTO 603
      II=II+1
      GOTO 611
  603 II=1 $ JJ=JJ+1
  611 CONTINUE
      RETURN
      ENTRY PRCO3
      IF(ID-1) 7,8,9
    7 RETURN
    8 RETURN
    9 RETURN
      ENTRY PRCO4
      IF(ID-1) 10,11,12
   10 RETURN
   11 RETURN
   12 CONTINUE
      DO 1202  JS=1,13
      ENCODE (80,101,ITEXT)(((INF(IK,JK,KK),KK=1,6),
     * JK=1,5),IK=JS,JS)
  101 FORMAT(5(A1,A1,A2,A2,X,A6,A2,X))
      IF(ITEXT.EQ.1H ) GOTO 1202
      CALL VTPRI(ITEXT,14)
 1202 CONTINUE
      RETURN
      END
      SUBROUTINE PREPPA(NS,NP1,IDENT)
C   pOdpPOgPAMMA OPgAHizAcii pOlYliCTA B KOMMOHE /PAGE/
C         dlq PAzMETKi.
C         NS - ~iClO ClOB CME}EHiq OT HA~AlA + 1.
C         NP1 - HOMEP dOPOvKi,IDENT - idEHTifiKATOP.
C         NP2 B KOMMOHE /LINK/ - dOPOvKA zAMEHy pPi IDENT=1.
C         NHEADS B KOMMOHE /TD/ = ~iClY gOlOBOK
      COMMON /TD/ NHEADS
      COMMON /PAGE/ IPAGE(1024)
      COMMON /LINK/ SKIP(5), NP2
      COMMON /FLDUB/FLDUB
      LOGICAL FLDUB
      LOGICAL FL3
      DIMENSION IH(42,2)
      DIMENSION JOB1(50),JOB2(5,10)
      DATA IH /6*1,5*0,1,30*0,6*1,5*0,1,30*0/
      M=NP1/NHEADS
      CALL PABIT(M,JOB1)
      DO 1 I=1,8
    1 IH(I+14,1)=JOB1(I+42)
      IH(13,1)=IDENT/2
      IH(14,1)=IDENT-2*IH(13,1)
      M=NP1-M*NHEADS
      FL3=NHEADS.EQ.20
      IF(FLDUB)FL3=.FALSE.
      IF(FL3)GO TO 888
      M5P=M/10
      M=M-M5P*10
 888  CONTINUE
      CALL PABIT(M,JOB1)
      IF(FL3) GO TO 64
      DO 2 I=1,4
      IH(I+22,1)=JOB1(I+46)
    2 IH(I+26,1)=0
      IH(27,1)=M5P
      GO TO 65
 64    CONTINUE
      DO 1111 I=1,4
 1111 IH(I+26)=0
      M5P=3-NHEADS/10$KK=23$DO 1112 I=M5P,5
      IH(KK,1)=JOB1(I+45)$KK=KK+1
 1112 CONTINUE
 65    CONTINUE
      M5P=0
      DO 21 I=1,6
      M=M5P+IH(I+12,1)+IH(I+24,1)
      M5P=M/2
   21 IH(I+36,1)=1+2*M5P-M
      DO 22 I=7,12
      M=M5P+IH(I+12,1)
      M5P=M/2
   22 IH(I+24,1)=1+2*M5P-M
      IF (IDENT.NE.1) GO TO 52
      IH(13,2)=1
      IH(14,2)=1
      IF(FL3)GO TO 890
      M=NP2/NHEADS
      M5P=NP2-M*NHEADS
       L = M5P / 10
       M5P = M5P - L*10
       CALL PABIT(2048*L+10*M+M5P,JOB1)
      GO TO 891
 890  CONTINUE
      M=NP2/2$M=M+2048*(NP2-2*M)$CALL PABIT(M,JOB1)
 891  CONTINUE
      DO 51 I=1,12
      IH(I+14,2)=JOB1(I+38)
   51 IH(I+30,2)=1-JOB1(I+38)
      GO TO 3
   52 DO 53 I=13,42
   53 IH(I,2)=IH(I,1)
    3 N1=NS-1
      IF(FL3)N1=N1+11
      IF(N1.LT.1) GO TO 5
      DO 4 N=1,N1
    4 IPAGE(N)=0B
    5 N=NS
      IF(FL3)N =N1+1
      L=0
      DO 10 KW=1,3
      DO 9 K1=1,5
      DO 9 K2=2,10
      L1=L/42+1
      L=L+1
      M=0
      GO TO (6,9,7,8),L1
    6 M=IH(L,1)
      GO TO 9
    7 M=IH(L-84,2)
      GO TO 9
    8 M=1
    9 JOB2(K1,K2)=M
      CALL CBBIT(IPAGE(N),JOB2)
   10 N=N+1
      N1=N
      DO 11 N=N1,512
   11 IPAGE(N)=7777777777777777B
      RETURN
      END
      SUBROUTINE PRERR(KZ,KCHECK,ID,NCHPA)
      COMMON /LINK/ S0,CHAN,MOD,PATH,S2(2),KOPC
      COMMON /TD/ NH,NPZ,NZC
      INTEGER CHAN,PATH,PIN,PC(20)
      INTEGER TKO(6)
      DATA PIN/-1/
      DATA TKO /3H***,3H PA,3H ~T,3H CP,3H***,3H zp/
      IF (PIN.EQ.-1) PRINT 50
      IF (PIN.NE.PATH) PRINT 51
      PIN=PATH$ PC(20)=KOPC
      DO 1 I=1,19
      J=20-I
      PC(J)=PC(J+1)/2
    1 PC(J+1)=PC(J+1)-2*PC(J)
      KK=PC(1)
      PC(1)=TKO(KK+1)
      NCIL1= PATH/NZC$ NP1=( PATH-NCIL1*NZC)*NPZ
      NCIL2=NCHPA/NZC$ NP2=(NCHPA-NCIL2*NZC)*NPZ
      PRINT 52, NCIL1,NP1,NCIL2,NP2,KZ,KCHECK,ID,PC
      RETURN
   50 FORMAT('0 dOPOvKA  zAMEHA  CM pPO  id KOp AdP  KC O{M OpK O{b',
     1       ' HBM BKl zzp 1Pg POf  KA Cpi CpA C~A ACd  AB PCK',
     2       '  pH  gd')
   51 FORMAT(2H I,107(1H-),1HI)
   52 FORMAT(2H I,2(I4,1H,I2,1H:),3(I2,2H :),A3,19(1H:,I2,1H ),1HI)
      END
       SUBROUTINE PRHEAD
      COMMON /PRISN/DUM1(2),TYPE
      INTEGER TYPE
       COMMON /TABLE/ HBP(4),IDATB,IDATE,ND
      COMMON /GEN/ {Ap(6),BB1(3),BB2(3),AcpY(6),pi1(3),pi2(3)
     * ,RES(3)
     * ,KObM(3),KpPiOP,KpOdK,KCTP
      INTEGER BB1,BB2,pi1,pi2
      COMMON /JOBS/ DUM2(16),TCS
      COMMON /JOBS1/NEJC(6),NEJC1(6)
      REAL NEJC,NEJC1
      DIMENSION TKM(4),TCM(4)
      INTEGER NJM(4),BP(4),INF(16)
      EQUIVALENCE (RINF,INF),(TdC,HBP),(TvC,HBP(2))
      EQUIVALENCE (RINFD,INF(2))
      DATA INF/16*0/
      TCM=0.
      IF(TYPE.GT.1) GO TO 1
      CALL TIMTAS(NJM,TKM,TCM)
    1 TCM=TCM+TCS-(NEJC+NEJC1)
      RINF=TdC-(TCM+TvC)
      RINFD=TdC
      DO 2 I=1,6
    2 INF(I+2)=KObM(I)
      KBB=BB1+BB2$INF(9)=KBB
      Kpi=pi1+pi2$INF(10)=Kpi
       DO 5 J=1,2
    5  CALL KOdBP(HBP(J),BP(2*J-1),0)
      PRINT 100,ND,(BP(I),I=1,4)
     * ,KObM,KBB,KCTP,Kpi,KpOdK,KpPiOP
  100 FORMAT(16X,31('-')//
     * 16X'ByzOBOB diCpET~EPA  -'I8/
     * 16X'diCpET~EP PAbOTAl   -'A6,A4/
     * 16X'BPEMq vdY}EgO TECTA -'A6,A4/
     * 16X'ObMEHOB: Mb         -'I8/
     * 16X'         Md         -'I8/
     * 16X'         Ml         -'I8/
     * 16X'BBEdEHO KAPT        -'I8/
     * 16X'OTpE~ATAHO CTPOK    -'I8/
     * 16X'OTpEPfOPiPOBAHO     -'I8/
     * 16X'pOdKA~EK            -'I8/
     * 16X'pOdC~ET pPiOPiTETOB -'I8//
     * 16X,31('-')//)
      RETURN
      END
      SUBROUTINE PRIDST
      COMMON /TD/ NH,NPZ,NZINC /MER/ NER,MER(63)
      COMMON /PAGE/ JAR(30),M(4),SKIP(990),MTAB(1015)
      PRINT 50
      DO 2 I=1,NER
      M(4)=MER(I)/4096$ M(2)=MER(I)-4096*M(4)
      DO 1 J=2,4,2
      M(J-1)=M(J)/NZINC
    1 M(J)=M(J)-M(J-1)*NZINC
    2 PRINT 51,M
      PRINT 52
      NBEGR=200*NZINC$ K=0$ NW=0$ I=4
      NZOND=203*NZINC
      DO 10 L=1,NZOND
      NZ=L-1
      IF(I.NE.4) GO TO 4
      NW=NW+1$ M(1)=MTAB(NW)
      DO 3 I=1,3
      M(I+1)=M(I)/256
    3 M(I)=M(I)-M(I+1)*256
      I=0
    4 I=I+1
      IF(M(I).LT.1) GO TO 10
      JAR(K+5)=M(I)
      JAR(K+3)=NZ/NZINC
      JAR(K+4)=(NZ-JAR(K+3)*NZINC)*NPZ
      IF(NZ-4) 5,6,6
    5 JAR(K+1)=1HK$ JAR(K+2)=NZ$ GO TO 9
    6 IF(NZ-NBEGR) 7,8,8
    7 JAR(K+1)=1H $ JAR(K+2)=NZ-4    $ GO TO 9
    8 JAR(K+1)=1Hz$ JAR(K+2)=NZ-NBEGR
    9 K=K+5
      IF(K.NE.30) GO TO 10
      K=0
      PRINT 53, JAR
   10 CONTINUE
      IF(K.NE.0) PRINT 53,(JAR(J),J=1,K)
      RETURN
   50 FORMAT(1H0,5X,'CpiCOK zAMEH')
   51 FORMAT(6X,2I3,3H - ,3I3)
   52 FORMAT(1H0,52X,'CpiCOK CME}EHij')
   53 FORMAT(6(4X,A1,O4,I4,I3,I4))
      END
       SUBROUTINE PRIHIS(IB)
       DIMENSION LINE(20),IB(1),NAME(8)
       DIMENSION IDIAGN(5,9)
       COMMON/CODERR/NERR
       DATA NAME/2HCB,3HKO=,3HPz=,3HOb=,2Hpp,2Hpc,3HBp=,3HBc=/
       DATA IDIAGN/6HHET pY,6HC-p il,6Hi HE C,6HbPO{EH,6H BzB-p
     + ,
     2 6HHEpPAB,6HilxHyj,6H ByzOB,1H ,1H ,
     3 6HBCTPE~,6HHyj By,6HzOB   ,1H ,1H ,
     4 6HHET gO,6HT-p   ,1H ,1H ,1H ,
     5 6HO{ibKA,6H pO ~E,6HTHOCTi,6H B MAC,6HCiBE  ,
     6 6HO{ibKA,6H pO ~E,6HTHOCTi,6H B bAj,6HTE    ,
     7 6HHET KO,6HHcA Ob,6HMEHA  ,1H ,1H ,
     8 6HHET Bz,6HB-p   ,1H ,1H ,1H ,
     9 6HHET pY,6HC-p il,6Hi HE C,6HbPO{EH,6H BzB-p/
       IF(IB.EQ.0B) GOTO 1000
       LBEG=2 $ LEND=461
       J=IB $ I=1
       PRINT 30
30     FORMAT(1H1,127(1H=))
      ITERR=FITERR(NERR)
      IF(ITERR.EQ.0)GOTO 40
      PRINT 31,(IDIAGN(L,ITERR),L=1,5),NERR
      PRINT 32,(IDIAGN(L,ITERR),L=1,5),NERR
      PRINT 301
31    FORMAT(X'>>>>  CbOj CBqzi  -  '5A6,47X'RES='O16)
32     FORMAT(1H+,'>>>>  CbOj CBqzi  -  '5A6,47X'RES='O16)
301    FORMAT(X,127(1H=)/)
40    CONTINUE
       CALL FUN71B
       PRINT 777
777    FORMAT(/)
       NS=0
20     CONTINUE
       DO 5 K=1,10
        LINE(2*K-1)=1H $ LINE(2*K)=0B
5      CONTINUE
       DO 1 K=1,20,2
       IF(I.EQ.LEND)GOTO 100
       IF(J.GT.LEND)J=LBEG
       IT=FIT(IB(J))
       IF(IT.EQ.0) GOTO 2
       LINE(K)=NAME(IT)
       LINE(K+1)=IB(J)
2      I=I+1 $ J=J+1
1      CONTINUE
100    PRINT 10,NS,LINE,NS
10     FORMAT(X,I3,10(X,A3,O8),X,I3)
       IF(I.EQ.LEND)GOTO 778
       NS=NS+10
       GOTO 20
778    PRINT 301
       RETURN
1000   PRINT 1001
1001   FORMAT(/' ***  HET zAdA~i CBqzi ili OHA COBCEM plOXAq')
        RETURN
        END
      SUBROUTINE PRINLR
      COMMON /LINK/MAC(1024)
      DIMENSION ML(3), MC(3)
      DATA (NS=953), (NL=977), (NZ=1001)
      PRINT 10
   10 FORMAT(10X,'PAzME}EHiE bibliOTEK OC. >dYbHA<'/)
      PRINT 11
      PRINT 56
   56 FORMAT (12X,': N  :   iMq  Ml    : zOHA :')
   11 FORMAT (12X,28('-'))
      DO 12 I=1,23
      PRINT 14
      CALL dAjiMq(MAC(NL+I),ML)
      CALL dAjzOH(I,ML)
      PRINT 13,I,ML
   13 FORMAT (12X,': ',O2,' : ',2A6,' : ',O4,' :')
   14 FORMAT (12X,':----:--------------:------:')
   12 CONTINUE
      PRINT 11
      RETURN
      END
      SUBROUTINE PRMlMd(IFL)
C     pE~ATx CBEdEHij O  Ml(IFL=0) i dp(IFL=1).
      COMMON/TABLE/HBP(4),IDATB,IDATE,ND
     * ,KbPz,bPz(8),K~,KK,NJOB,pi(81,4),Mb(4,512)
     * ,MlCT(7,32),MdCT(11,16),NMO,MOzO{(2,256)
     * ,MlCb,MlO{(5000),MdCb,MdO{(5000)
      COMMON/ONE/M(5),NAMl
      COMMON/XAPMld/NMl,NZON,KO{(9),NHAPb
      DIMENSION MO{(9),MlT(9),KHAPT(2),MlplOX(2,3)
     1 , MO{1(9)
      DATA(Npl=3)
      LO{=6
      IF(IFL.EQ.1) GO TO 10
      IF(MlCb.EQ.0) RETURN
      CALL DATAPR
      PRINT 1000
      GO TO 11
   10 IF(MdCb.EQ.0) RETURN
      LO{=9
      CALL DATAPR
      PRINT 1001
 1000 FORMAT(/15X'CBEdEHiq O MAgHiTHyX lEHTAX'//
     * 4X,'N bOb.I HAPAbOTKAI O{MBY I zp-O{MIO{.ClClI'
     * 'KOH.ObMI  K C  I CbOjCiI'
     * /4X,66('-'))
 1001 FORMAT(/33X'CBEdEHiq O diCKOByX pAKETAX'//
     * 4X,'N pAK.IN MOdI HAPAbOTKAI O { M IKC,AdP.I O{.YBYI O{.~T I'
     * ' O{.BybIzApP.zpI O{.pK IKAlibP.I A C d I'
     * /4X,96('-'))
   11 DO 12 I=1,Npl
   12 MlplOX(2,I)=0
      IPREND=0
      IBX=IFL+1
      GO TO 31
   30 IF(IEND.EQ.0) GO TO 31
      IPREND=1
      GO TO 50
   31 CALL ERONEZ(IBX,IEND)
      IF(IBX.NE.0) GO TO 40
      IF(NAMl.NE.Ml) GO TO 50
      IF(NMl.NE.NMl0.AND.LO{.NE.6) GO TO 50
      DO 35 I=1,LO{
   35 MO{(I)=MO{(I)+KO{(I)
      KHAPb=KHAPb+NHAPb
      NHAPb=0
      GO TO 30
   40 IBX=0
   41 DO 42 I=1,LO{
   42 MO{1(I)=KO{(I)
      CALL KOdbOb(NAMl,NbObT,0)
   46 DO 45 I=1,LO{
   45 MO{(I)=KO{(I)
      KHAPb=NHAPb
      NHAPb=0
      Ml=NAMl
      NMl0=NMl
      KFO{=0
      GO TO 30
   50 CONTINUE
      BP=KHAPb
      CALL KOdBP(BP,KHAPT,0)
      DO 55 I=1,LO{
      INT=6H
      IF(MO{(I).EQ.0) GO TO 55
      ENCODE(6,1003,INT) MO{(I)
 1003 FORMAT(I6)
   55 MlT(I)=INT
      IF(LO{.NE.6) GO TO 51
      PRINT 1004,NbObT,KHAPT,(MlT(I),I=1,LO{)
 1004 FORMAT(5X,A5'I'A6,A4'I',9(A6' I'))
      DO 56 I=1,LO{
   56 KFO{=KFO{+MO{(I)
   57 CONTINUE
      DO 60 I=1,Npl
      IF(KFO{.LE.MlplOX(2,I)) GO TO 60
      INT1=MlplOX(1,I)
      INT2=MlplOX(2,I)
      MlplOX(1,I)=Ml
      MlplOX(2,I)=KFO{
      Ml=INT1
      KFO{=INT2
   60 CONTINUE
      GO TO 65
   51 NMT1=NMl0/8
      NMT2=NMl0-NMT1*8
      ENCODE (6,1007,MfT)   NMT1,NMT2
      PRINT 1008,NbObT,MfT,KHAPT,(MlT(I),I=1,LO{)
      NbObT=6H
      IF(NAMl.NE.Ml) GO TO 53
      DO 52 I=1,LO{
   52 MO{1(I)=MO{1(I)+MO{(I)
      IF(IEND.EQ.0) GO TO 46
      IPREND=1
   53 DO 54 I=1,LO{
   54 KFO{=KFO{+MO{1(I)
      GO TO 57
   65 IF(IPREND.EQ.0) GO TO 41
      IF(LO{.EQ.6) PRINT 4066
      IF(LO{.NE.6) PRINT 4096
 4066 FORMAT (4X,66('-'))
 4096 FORMAT (4X,96('-'))
      IF(MlplOX(2,1).EQ.0) RETURN
      IF(IFL.EQ.1) GO TO 70
      CALL DATAPR
      PRINT 1005
 1005 FORMAT(/20X'CBEdEHiq O HEKOTOPyX plOXiX MAgHiTHyX lEHTAX'//
     * 4X,'N bOb.I N MfI HAPAbOTKAI N Y~. I O{MBY I zp-O{MIO{.ClClI'
     * 'KOH.ObMI  K C  I CbOjCiI'
     */4X,80('-'))
      GO TO 80
   70 CALL DATAPR
      PRINT 1006
 1006 FORMAT(/35X'CBEdEHiq O HEKOTOPyX plOXiX diCKOByX pAKETAX'//
     * 4X,'N pAK.IN MOdI HAPAbOTKAI       I'
     * ' O { M IKC,AdP.I O{.YBYI O{.~T I O{.BybIzApP.zpI'
     * ' O{.pK IKAlibP.I A C d I'
     * /4X,104('-'))
   80 CONTINUE
      DO 89 I=1,Npl
      NAMl=MlplOX(1,I)
      IF(MlplOX(2,I).EQ.0) GO TO 89
      Mf=-1
      CALL ERNMld(IFL+1,IEND)
      CALL KOdbOb(NAMl,NbObT,0)
      GO TO 82
   81 CALL ERNMld(0,IEND)
   82 MfT=6H
      KHAPT=6H
      KHAPT(2)=6H
      IF(NMl.EQ.Mf) GO TO 83
      NMT1=NMl/8
      NMT2=NMl-NMT1*8
      ENCODE(6,1007,MfT) NMT1,NMT2
 1007 FORMAT(I1'-'I1)
      Mf=NMl
      BP=NHAPb
      CALL KOdBP(BP,KHAPT,0)
   83 CONTINUE
      DO 84 N=1,LO{
      IF(KO{(N).NE.0) GO TO 85
   84 CONTINUE
      NZONT=6H
      GO TO 86
   85 ENCODE(6,1009,NZONT) NZON
 1009 FORMAT(2X,O2)
      IF(IFL.EQ.1) NZONT= 6H
   86 DO 87 N=1,LO{
      INT=6H
      IF(KO{(N).EQ.0) GO TO 87
      ENCODE(6,1003,INT) KO{(N)
   87 MlT(N)=INT
      PRINT 1008,NbObT,MfT,KHAPT,NZONT,(MlT(N),N=1,LO{)
 1008 FORMAT(5X,A5,'I 'A3' I'A6,A4'I  'A5'I',10(A6' I'))
      NbObT=6H
      IF(IEND.EQ.0) GO TO 81
   89 CONTINUE
      IF(LO{.EQ.6) PRINT 4080
      IF(LO{.NE.6) PRINT 4104
 4080 FORMAT (4X,80('-'))
 4104 FORMAT (4X,104('-'))
      RETURN
      END
      SUBROUTINE PRSV1
      COMMON/T/ ITT(14)
      COMMON /PAR/ ID /TEXT/ ITEXT(14),MTEXT(9),M TEXTD(9)
      IF(ID-1) 1,2,3
 1    RETURN
 2    PRINT 4002
4002  FORMAT(//16X,25HOCBObOdiB{iECq YCTPOjCTBA//
     *58(1H-)/1HI,56X,1HI)
      RETURN
    3 CONTINUE
      ENCODE(80,30,ITT)
   30 FORMAT(2X'*** OCBObOdiB{iECq YCTPOjCTBA ***',
     * 13X'00/00/00'4X'00.00.00'12X)
      CALL DATIME
      CALL VTPRI(ITT,14)
  101 ENCODE(80,127,ITT)
  127 FORMAT(69(1H-),11X)
  100 CALL VTPRI(ITT,14)
      RETURN
      ENTRY PRSV2
      IF(ID-1) 4,5,6
 4    CALL FTTPRI(MTEXT,9)
      RETURN
 5    PRINT 4005,(MTEXT(I),I=1,9)
4005  FORMAT(2HI ,9A6,2H I/
     *1HI,56X,1HI)
      RETURN
    6 CONTINUE
      MTEXT=6H   Mf:
      ENCODE(80,60,ITT)(MTEXT(I),I=1,9)
      GOTO 100
      ENTRY PRSV3
      IF(ID-1) 7,8,9
 7    CALL FTTPRI(MTEXTD,9)
      RETURN
 8    PRINT 4005,(MTEXTD(I),I=1,9)
      RETURN
    9 CONTINUE
      MTEXTD=6H   Md:
      ENCODE(80,60,ITT)(MTEXTD(I),I=1,9)
   60 FORMAT(9A6,26X)
      GOTO 100
      ENTRY PRSV4
      IF(ID-1) 10,11,12
 10   RETURN
 11   PRINT 4011
4011  FORMAT(58(1H-))
      RETURN
   12 CONTINUE
      GOTO 101
      ENTRY PRSV5
      IF(ID-1) 13,14,15
13    ENCODE(3,4013,ITEXT)
4013  FORMAT(3HHET)
      CALL FTTPRI(ITEXT,1)
 14   RETURN
   15 CONTINUE
      ENCODE(80,150,ITT)
  150 FORMAT(28HOCBObOdiB{iXCq YCTPOjCTB HET,52X)
      GOTO 100
      END
      SUBROUTINE PRTIMS
      COMMON /PRISN/ MEND,MNZ,TYPE
      COMMON /TABLE/ TdC,TvC
      COMMON /JOBS/ JNC(3),JNR(3),NMB,JNS(3),JNS0(3),JKS(3),JCS(3)
     *         ,JKS0(3),JCS0(3),JKM(3),JCM(3) ,NJM(3)
      COMMON /JOBS1/ NEJC(3),NEJK(3),NEJC1(3),NEJK1(3),TJSC(23),TJSK(23)
      REAL NEJC,NEJK,NEJC1,NEJK1,TNK(4),TNC(4)
      REAL JKS,JCS,JKS0,JCS0,JKM,JCM
      INTEGER pOCT(2),pOTT(2),C~iT(2),BPK(6),BPC(6),JM(3),TYPE
     * ,zAgP(2)
      DATA (pOCT=12HpOC~iTAHO:  )
     * ,(pOTT=12HpOTEPqHO :  )
     * ,(C~iT=12HC~iTA`TCq:  )
     * ,(zAgP=12HzAgPYzKA :  )
      REAL IASF
      IASF(TX)=TX/TdC*100.
      PRINT 100,pOCT
  100 FORMAT(6X,A6,A4,6X'CYM.       TEPMiH.   pOTOK')
      DO 2 I=1,3
      TNK(I)=JKS(I)-NEJK1(I)
    2 TNC(I)=JCS(I)-NEJC1(I)
      CALL KOdBP4(TNK,BPK,0)
      CALL KOdBP4(TNC,BPC,0)
      PRINT 101,JNS,BPK,BPC
  101 FORMAT(8X'KOl-BO :'3I10/8X'K.BPEMq:'3X,3(A6,A4)/
     * 8X'C.BPEMq:'3X,3(A6,A4)/)
      PRINT 100,pOTT
      CALL KOdBP4(JKS0,BPK,0)
      CALL KOdBP4(JCS0,BPC,0)
      PRINT 101,JNS0,BPK,BPC
      IF(TYPE.GT.1) GO TO 10
      CALL TIMTAS(JM,JKM,JCM)
      PRINT 100,C~iT
      DO 3 I=1,3
      JKM(I)=JKM(I)-NEJK(I)
    3 JCM(I)=JCM(I)-NEJC(I)
      CALL KOdBP4(JKM,BPK,0)
      CALL KOdBP4(JCM,BPC,0)
      PRINT 101,JM,BPK,BPC
   10 IF(NMB.EQ.0) GO TO 20
      PRINT 100,zAgP
      BM=FLOAT(NMB)
      DO 15 I=1,3
      TNK(I)=FLOAT(JNC(I))/BM
   15 TNK(I+3)=FLOAT(JNR(I))/BM
      PRINT 102,(TNK(I),I=1,6)
  102 FORMAT(6X'K-BO zAdA~'3F10.1/
     * 4X'K-BO gOTOByX'3F10.1/)
   20 CONTINUE
      TPR=JCS+JCS0-NEJC1
      TPR=TPR+JCM
      TOC=TdC-(TPR+TvC)
      pPOP=IASF(TdC-TvC)
      pPPR=IASF(TPR)
      pPvd=IASF(TvC)
      pPOC=IASF(TOC)
      CALL KOdBP (TdC,BPK(1),0)
      CALL KOdBP (TPR,BPK(3),0)
      CALL KOdBP (TvC,BPK(5),0)
      CALL KOdBP (TOC,BPK(7),0)
      PRINT 103,(BPK(I),I=1,8),pPOP,pPPR,pPvd,pPOC
  103 FORMAT(16X,31('-')//16X'BPEMEHA:'/
     * 16X'ACTPOHOMi~ECKOE     -'A6,A4/
     * 16X'pPOcECCOPHOE        -'A6,A4/
     * 16X'vdY}EgO TECTA       -'A6,A4/
     * 16X'pOTEPi OC           -'A6,A4//
     * 16X'pPOcEHTy BPEMEH:'/
     * 16X'OpEPATOPHOgO        -'F10.1/
     * 16X'pPOcECCOPHOgO       -'F10.1/
     * 16X'vdY}EgO TECTA       -'F10.1/
     * 16X'pOTEPx OC           -'F10.1//
     * 16X,31('-')//)
      RETURN
      END
      SUBROUTINE PRUS1
      COMMON/T/ ITT(14)
      COMMON /PAR/ ID /TEXT/ ITEXT(14),TPRINT(9)
      INTEGER TPRINT
      IF(ID-1) 1,2,3
 1    RETURN
 2    PRINT 4002
4002  FORMAT(//18X,21HHEObXOdiMO YCTAHOBiTx//,
     *58(1H-)/1HI,56X,1HI)
        RETURN
    3 CONTINUE
      ENCODE(80,30,ITT)
   30 FORMAT(5X,28H*** TPEbYETCq YCTAHOBiTx ***,15X,
     * '00/00/00'4X'00.00.00'12X)
      CALL DATIME
      CALL VTPRI(ITT,14)
  308 ENCODE(80,307,ITT)
  307 FORMAT(69(1H-),11X)
      CALL VTPRI(ITT,12)
      RETURN
      ENTRY PRUS2
      IF(ID-1) 4,5,6
 4    CALL FTTPRI(TPRINT,9)
      RETURN
 5    PRINT 4005,(TPRINT(I),I=1,9)
4005  FORMAT(1HI,2X,9A6,1HI/
     *1HI,56X,1HI)
      RETURN
    6 CONTINUE
      ENCODE(64,60,ITEXT)(TPRINT(I),I=1,9)
   60 FORMAT(9A6,10X)
  100 CALL VTPRI(ITEXT,11)
      RETURN
      ENTRY PRUS3
      IF(ID-1) 7,8,9
 7    RETURN
 8    PRINT 4008
4008  FORMAT(58(1H-))
      RETURN
    9 CONTINUE
      GOTO 308
      ENTRY PRUS4
      IF(ID-1) 10,11,12
 10   ENCODE(6,4010,TPRINT)
4010  FORMAT(6HHE~EgO)
      CALL FTTPRI(TPRINT,1)
 11   RETURN
   12 CONTINUE
      ENCODE(64,120,ITEXT)
  120 FORMAT(19HHi~EgO HE TPEbYETCq,45X)
      GOTO 100
      END
      SUBROUTINE QEND
      RETURN
      END
      SUBROUTINE RANGE(JXT,JYT,JZT,JXL,JYL,JZL,JXR,JYR,JZR)
      IF(JXT.LT.JXL) JXL=JXT
      IF(JXT.GT.JXR) JXR=JXT
      IF(JYT.LT.JYL) JYL=JYT
      IF(JYT.GT.JYR) JYR=JYT
      IF(JZT.LT.JZL) JZL=JZT
      IF(JZT.GT.JZR) JZR=JZT
      RETURN
      END
      SUBROUTINE READST
      COMMON/PRISN/MEND,MNZ,TYPE
      COMMON/GEN/{Ap(6),YCTP(3,10)
      COMMON/TABLE/HBP(4),IDATB,IDATE,ND
     * ,KbPz,bPz(8),K~,KK,NJOB,pi(81,4),Mb(4,512)
     * ,MlCT(7,32),MdCT(11,16),NMO,MOzO{(2,256)
     * ,MlCb,MlO{(5000),MdCb,MdO{(5000)
      COMMON /JOBS/ JNC(3),JNR(3),NMB,JNS(3),JNS0(3),JKS(3),JCS(3)
     *         ,JKS0(3),JCS0(3),JKM(3),JCM(3) ,NJM(3)
      COMMON /JOBS1/ NEJC(3),NEJK(3),NEJC1(3),NEJK1(3)
      REAL JKS,JCS,JKS0,JCS0,JKM,JCM
      DIMENSION IYCTP(30),NDEQ(13),Ipi(324)
     * ,MbEQ(2048),CTMl(7,32),CTMd(11,16)
     * ,IBUF(2)
      EQUIVALENCE(YCTP,IYCTP),(ND,NDEQ)
     * ,(pi,Ipi),(Mb,MbEQ),(MlCT,CTMl)
     * ,(MdCT,CTMd),(IBUF,BUF)
      INTEGER TYPE,YCTP
C
C     ~TEHiE CTATiCTiKi iz 1 ili 2 O-l-i
C
      IW=0
      IF=TYPE/2
      IF(IF*2.NE.TYPE) IW=1
      CALL dAj~TH(IF,IW,NO)
      IF(NO.EQ.0) GO TO 5
      CALL PRNTTT
      STOP
    5 CALL dAjClB(YCTP,30)
      CALL dAjClB(HBP,4)
      CALL dAjClB(IDATB,15)
      CALL dAjClB(pi,324)
      CALL dAjClB(Mb,2048)
      CALL dAjClB(MlCT,224)
      CALL dAjClB(MdCT,176)
      CALL dAjClB(NMO,1)
      CALL dAjClB(MOzO{,NMO*2)
      CALL dAjClB(MlCb,1)
      CALL dAjClB(MlO{,MlCb)
      CALL dAjClB(MdCb,1)
      CALL dAjClB(MdO{,MdCb)
      CALL dAjClB(JNS,25)
      RETURN
C
C     ClOvEHiE CTATiCTiKi iz
C     dBYX OblACTEj i zApiCx
C
      ENTRY SUMWRS
      IF(TYPE.EQ.1.OR.TYPE.EQ.3) GO TO 10
      RETURN
   10 IF=TYPE/2+1
      CALL dAj~TH(IF,0,NO)
      IF(NO.EQ.1) GO TO 30
      DO 11 I=1,30
      CALL dAjClB(IBUF,1)
   11 IYCTP(I)=IYCTP(I)+IBUF
      DO 12 I=1,4
      CALL dAjClB(BUF,1)
   12 HBP(I)=HBP(I)+BUF
      CALL dAjClB(IBUF,2)
      IDATE=IBUF(2)
      DO 13 I=1,13
      CALL dAjClB(IBUF,1)
   13 NDEQ(I)=NDEQ(I)+IBUF
      DO 14 I=1,324
      CALL dAjClB(IBUF,1)
   14 Ipi(I)=Ipi(I)+IBUF
      DO 15 I=1,2048
      CALL dAjClB(IBUF,1)
   15 MbEQ(I)=MbEQ(I)+IBUF
      DO 17 I=1,32
      CALL dAjClB(BUF,1)
      CTMl(1,I)=CTMl(1,I)+BUF
      DO 16 K=2,7
      CALL  dAjClB(IBUF,1)
   16 MlCT(K,I)=MlCT(K,I)+IBUF
   17 CONTINUE
      DO 19 I=1,16
      CALL dAjClB(BUF,1)
      CTMd(1,I)=CTMd(1,I)+BUF
      DO 18 K=2,11
      CALL dAjClB(IBUF,1)
   18 MdCT(K,I)=MdCT(K,I)+IBUF
   19 CONTINUE
      CALL dAjClB(NW,1)
      DO 20 I=1,NW
      CALL dAjClB(IBUF,2)
   20 CALL O{MOzY(IBUF,IBUF(2))
      CALL dAjClB(NW,1)
      CALL SMERTD(0,NW)
      CALL dAjClB(NW,1)
      CALL SMERTD(1,NW)
      DO 21 I=1,13
      CALL dAjClB(IBUF,1)
   21 JNC(I)=JNC(I)+IBUF
      DO 22 I=1,12
      CALL dAjClB(BUF,1)
   22 JKS(I)=JKS(I)+BUF
C     zApiCx TAblic
   30 CONTINUE
      CALL dAjzAp(IF)
      CALL HAClB(YCTP,30)
      CALL HAClB(HBP,4)
      CALL HAClB(IDATB,15)
      CALL HAClB(pi,324)
      CALL HAClB(Mb,2048)
      CALL HAClB(MlCT,224)
      CALL HAClB(MdCT,176)
      CALL HAClB(NMO,1)
      CALL HAClB(MOzO{,NMO*2)
      CALL HAClB(MlCb,1)
      CALL HAClB(MlO{,MlCb)
      CALL HAClB(MdCb,1)
      CALL HAClB(MdO{,MdCb)
      CALL HAClB(JNS,25)
      CALL KOHzAp
      RETURN
      END
      SUBROUTINE SRNPRT(ICODE)
C.
C...      OpPEdElEHiE fOPMATA pE~ATi
C.
C.         HOMEP           KOd         pPiME~AHiE
C.         -----           ---         ----------
C.
C.           1                         BOCxMEPi~Hyj
C.           2             -"-         KOd - TEXT
C.           3             -"-         ISO - KOd
C.           4             -"-         BYNARY - dBOi~Hyj, pObiTHyj
C.           5             -"-         KOd dlq AcpY - GOST
C.           6             -"-         cElyE ~iClA
C.           7             -"-         fOPMAT MA{. KOMAHd
C.--------------------------------------------------------------------
      ICODE = 1
      RETURN
      END
      SUBROUTINE STAPRT
C
C  CObCTBEHHO PACpE~ATKA pPOTOKOlA
C  i BPEMEHi COOb}EHij
C
      COMMON/PRISN/ MEND,MNZ,TYPE,DAT(2),DAT1(2),TYPE2
      COMMON/ONE/TY1,TY2,ADR,XA(16),LXA
      COMMON/FLTXT/IFLT
      COMMON/TX/ITIME(4)
      COMMON/NZON/NZON,NEL
       COMMON/TBUF/IB(10),LEN
      COMMON/RGM61/LPFL,NP,TBEG,TEND
     */NSK/NSK,NTER
      DIMENSION IXA(16)
      EQUIVALENCE(XA,IXA)
      DIMENSION BT(2),BISO(2)
      DATA(BL=6H      )
      DATA(BT=0B,0B)
      DATA(ITIME=6H00.00.,2H00,1H ,1H )
      DATA(IBL=6H      )
      DATA(ISL=6H////  )
      DATA MEND,MNZ,NZON,NEL,LPFL,NP,IFLAG/7*0/
      DATA(ISTR=1H*)
      DATA TBEG,TEND/2*0./
      DATA NSK,NOUT,ISO1/2*0,0020040100200401B/
      INTEGER TY1,TY2,ADR
      J=0 $ J15=0
      IF(NP.NE.0) GOTO 600
       ITE0=0
       IF(TEND.NE.0.) GO TO 11
       TEND=86400.
       ITE0=1
      GOTO 11
C
C      BydA~A DAYFILE'ApO CTPAHicAM.
C      NP - KOl-BO CTPAHic pO 15 CTPOKOT KOHcA
C
  600 CONTINUE
      NSKIP=NEL-15*NP
   11 CALL dAjH~1
C
C      OCHOBHOj ciKl.
C      C~iTyBAHiE OdHOgO |l-TA iHf-cii,
C      PACpAKOBKA i pE~ATx.
C
   10 CALL dAj|l1
      IF(MEND.NE.0) GOTO 998
      IF(TY1.LE.8) GOTO 10
      J=J+1
      IF(NSK.EQ.0) GOTO 6601
      NSK=NSK-1
      GOTO 10
 6601 CONTINUE
      IF(NP.EQ.0)GOTO 601
      IF(J.LE.NSKIP) GOTO 10
       GO TO 78
C
C      BydA~A D/F pO BPEMEHi
C
  601 CONTINUE
       IF(ITE0.EQ.1.AND.IFLAG.EQ.1) GO TO 78
      IF(XA(2).EQ.0..AND.IFLAG.EQ.1) GOTO 78
      IF(TEND.LT.TBEG) GOTO 602
      IF(XA(2).GE.TBEG.AND.XA(2).LE.TEND) GOTO 78
      GOTO 10
  602 CONTINUE
      IF(XA(2).GE.TBEG.OR.XA(2).LE.TEND) GOTO 78
      GOTO 10
C
C      PEdAKTiPOBAHiE TEKCTA COOb}EHiq
C
   78 CONTINUE
      IFLAG=1
C
       IF(LPFL.EQ.1) GO TO 700
        J15=J15+1
       IF(J15.LE.15) GOTO 700
       CALL WAIT
      IF(NTER.NE.0) GO TO 6670
      IB(1)=IBL
      LEN=1
      CALL OPTTPR(IB,LEN,1)
 6670 CONTINUE
      IF(NSK.NE.0) GOTO 7701
       J15=1
  700  CONTINUE
      NOUT=NOUT+1
      CALL TIMETR
      LXA=LXA+1
       IF(TY2.EQ.1.OR.TY2.EQ.3) GOTO 300
C --- YbiPAEM ClOBA iz OdHiX '1 '
      I=3
  377 CONTINUE
      IF(IXA(I).NE.ISO1) GOTO 378
      LXA=LXA-1
      IF(I.EQ.LXA+1) GOTO 376
      DO 379 K=I,LXA
  379 IXA(K)=IXA(K+1)
      GOTO 377
  378 CONTINUE
      I=I+1
      IF(I.LE.LXA) GOTO 377
  376 CONTINUE
C ---
      CALL REDISO(XA(3),LXA-2)
      GOTO 200
 7701 CONTINUE
      NSK=15*NSK-1
      J15=0
      GOTO 10
  300 CONTINUE
      CALL SHIFTM
      BT(1)=XA(3)
      CALL TEXISO(BT,BISO)
      XA(3)=BISO(1)
      XA(4)=BISO(2)
      LXA=LXA+1
  200 CONTINUE
C
C      pOdgOTOBKA bYfEPA(IB) dlq
C      pE~ATi HA AcpY ili VT
C
      LXA1=LXA
       IF(LXA.GT.9) LXA1=9
      IB(1)=ITIME(1)
      IB(2)=ITIME(2)
      DO 611 I=3,LXA1
  611  IB(I)=IXA(I)
       LEN=LXA1
C
C      BydA~A CTPOKi
C
      IF(LPFL.EQ.0) CALL OPTTPR(IB,LEN,1)
      IF(LPFL.NE.0) CALL PRT1
      IF(LXA.LE.9) GOTO 10
      DO 6620 I=1,3
 6620 IB(I)=IBL
      DO 6621 I=10,LXA
 6621 IB(I-6)=IXA(I)
       LEN=LXA-6
C
C      BydA~A XBOCTA CTPOKi
C
      IF(LPFL.EQ.0) GOTO 722
      CALL PRT1
      GOTO 10
  722 CONTINUE
      CALL OPTTPR(IB,LEN,1)
      J15=J15+1
      GOTO 10
  998 IF(LPFL.EQ.0) GOTO 660
      IB=IBL $ LEN=1
      CALL PRT1
      ENCODE(34,21,IB)NOUT
       LEN=6
      CALL PRT1
   21 FORMAT('********    BydAHO 'I5' COOb}EHij')
      ENCODE(44,721,IB) J,NZON
      LEN=8
  721 FORMAT('********    BCEgO  'I5' COOb}EHij ('I3' zOH)')
      CALL PRT1
      CALL EPRT1
      GOTO 7777
  660 CONTINUE
      ENCODE(19,7721,IB)
 7721 FORMAT('= KOHEc pPOTOKOlA =')
      CALL OPTTPR(IB,4,1)
 7777 CONTINUE
      RETURN
      END
      SUBROUTINE SVML
C----------------------------------------
C     pE~ATx COOb}EHij
C     Ob OCBCbOdiB{iXCq Mf,Md
C----------------------------------------
      COMMON /UPAS/ KKKK(128)
      COMMON /DECI/ K(48)
      COMMON /PAR/ ID
       COMMON /TEXT/ ITEXT(14),MTEXT(9),MTEXTD(9)
      DATA(KP=1H )
      LD=0
      CALL HAVERS(LD)
      CALL TABLSV
      I1=0
      IF(K(1).EQ.KP) I1=1
      ENCODE(54,10,MTEXT) (K(I),I=1,48)
   10 FORMAT(6HCB Mf:,48A1)
      LD=1
      CALL HAVERS(LD)
      CALL TABLSV
      I2=0
      IF(K(1).EQ.KP) I2=1
       ENCODE(54,11,MTEXTD) (K(I),I=1,48)
   11 FORMAT(6HCB Md:,48A1)
      IF(I1.EQ.0.OR.I2.EQ.0) GO TO 1
       CALL PRSV5
      RETURN
 1    CALL PRSV1
      IF(I1.EQ.0) CALL PRSV2
      IF(I2.EQ.0) CALL PRSV3
      CALL PRSV4
      RETURN
      END
      SUBROUTINE TABLSV
      COMMON /RESURS/ SV(32)
      COMMON /DECI/ K(48)
      INTEGER SV
      DIMENSION NUSTR(8),NP(3)
      DATA (NUSTR(1)=1H0)
      DATA (NUSTR(2)=1H1)
      DATA (NUSTR(3)=1H2)
      DATA (NUSTR(4)=1H3)
      DATA (NUSTR(5)=1H4)
      DATA (NUSTR(6)=1H5)
      DATA (NUSTR(7)=1H6)
      DATA (NUSTR(8)=1H7)
      DATA (NP(1)=1H-)
      DATA (NP(2)=1H,)
      DATA (NP(3)=1H )
      DO 1 N=1,48
    1 K(N)=NP(3)
      J=1
      L=0
      DO 2 I=1,32
      IF(SV(I).EQ.0) GO TO 11
      IF(I.EQ.1) GO TO 3
      IF((SV(I)-1).NE.SV(I-1)) GO TO 4
      IF(L.EQ.0) GO TO 13
      L=L+1
      GO TO 5
   13 CONTINUE
      K(J)=NP(1)
      J=J+1
      L=L+1
      GO TO 5
    4 IF(L.EQ.0) GO TO 6
      IF(L.NE.1) GO TO 7
      K(J-1)=NP(2)
    7 CONTINUE
      M=SV(I-1)/8+1
      K(J)=NUSTR(M)
      M=SV(I-1)-(M-1)*8+1
      K(J+1)=NUSTR(M)
      J=J+2
      L=0
    6 K(J)=NP(2)
      J=J+1
    3 M=SV(I)/8+1
      K(J)=NUSTR(M)
      M=SV(I)-(M-1)*8+1
      K(J+1)=NUSTR(M)
      J=J+2
    5 IF(J.EQ.49) GO TO 10
    2 CONTINUE
   11 IF(L.EQ.0) RETURN
      IF(L.NE.1) GO TO 12
      K(J-1)=NP(2)
   12 M=SV(I-1)/8+1
      K(J)=NUSTR(M)
      M=SV(I-1)-(M-1)*8+1
      K(J+1)=NUSTR(M)
   10 RETURN
      END
      SUBROUTINE TASK57
C
C
C               57/
C
C    *************************************************
C    pPOgPAMMA pPOBEPKi p/lEHTy, pPObiTOj B YpPABlq`}iX
C    KOdAX CTAHKA 'ADMAP'. pPOBEPqETCq BOzBPAT B iCXOdHOE
C    pOlOvEHiE iCpOlHiTElxHyX YzlOB 'ADMAP'A. zHA~EHiE
C    pPOBEPqEMyX KOdOB (dECqTi~HyX) ClEdY`}EE:
C     '1'- CME}EHiE +X,  '2'- CME}EHiE -X,
C     '4'- CME}EHiE +Y,  '5'- CME}EHiE +X+Y,
C     '6'- CME}EHiE -X+Y,'7'- YMEHx{.diAfPAgMY,
C     '8'- CME}EHiE -Y,  '9'- CME}EHiE +X-Y,
C     '10'-CME}EHiE-X-Y, '14'-YBEli~.diAfPAgMY,
C     '15'-CBEPlEHiE,    '16'-OCTAHOB,
C     '17'-BKl`~.lAMp,   '19'-MAlyj {Ag,
C     '24'-ByKl. lAMp,   '28'-bOlx{.{Ag.
C    **************************************************
      DIMENSION JM(6)
C
      J = INDEX1(0)
      IF( J.NE.0 ) CALL PTCHEK(J)
      PRINT 101
  101 FORMAT(1H1)
      J=JOPER('iMq plATy',2,1)
      IF(J.NE.' ') GO TO 500
  600 CONTINUE
      J=JOPER('KAKOj MACCiB',2,1)
      IF(J.NE.' ') GO TO 601
  102 CONTINUE
      JXT=0$JYT=0$JZT=0
      JXL=0$JYL=0$JZL=0
      JXR=0$JYR=0$JZR=0
      JH=10
 1111 K=INPSPT(8)
      IF(K.EQ.16) GO TO 77
      IF(K.EQ.0.OR.K.EQ.15.OR.K.EQ.17.OR.K.EQ.24) GO TO 1111
      IF(K.EQ.32.OR.K.EQ.64.OR.K.EQ.96) GO TO 1111
      IF(K.EQ.1) GO TO 1
      IF(K.EQ.2) GO TO 2
      IF(K.EQ.4) GO TO 4
      IF(K.EQ.8) GO TO 8
      IF(K.EQ.5) GO TO 5
      IF(K.EQ.9) GO TO 9
      IF(K.EQ.6) GO TO 6
      IF(K.EQ.10) GO TO 10
      IF(K.EQ.14) GO TO 14
      IF(K.EQ.7) GO TO 7
      IF(K.EQ.28) GO TO 28
      IF(K.EQ.19) GO TO 19
      GO TO 70
    1 JXT=JXT+JH
      GO TO 111
    2 JXT=JXT-JH
      GO TO 111
    4 JYT=JYT+JH
      GO TO 111
    8 JYT=JYT-JH
      GO TO 111
    5 JXT=JXT+JH$JYT=JYT+JH
      GO TO 111
    9 JXT=JXT+JH$JYT=JYT-JH
      GO TO 111
    6 JXT=JXT-JH$JYT=JYT+JH
      GO TO 111
   10 JXT=JXT-JH$JYT=JYT-JH
      GO TO 111
   14 JZT=JZT+JH
      GO TO 111
    7 JZT=JZT-JH
  111 CALL RANGE(JXT,JYT,JZT,JXL,JYL,JZL,JXR,JYR,JZR)
      GO TO 1111
   28 JH=10
      GO TO 1111
   19 JH=1
      GO TO 1111
  500 CONTINUE
      DECODE(6,510,J) JM
  510 FORMAT(6A1)
      PRINT 501,JM
  501 FORMAT(25X,'plATA  ',6A2)
      GO TO 600
  601 CONTINUE
      DECODE(6,610,J) JM
  610 FORMAT(6A1)
      PRINT 611,JM
  611 FORMAT(/25X,'MACCiB  ',6A2)
      GO TO 102
   70 PRINT 170
      PRINT 71
   71 FORMAT(40X,'O{ibKi HA p.lEHTE')
      J=JOPER('O{ibKA',1,0)
      GO TO 777
   77 PRINT 170
  170 FORMAT(10X,'lEHTA pPOBEPEHA')
      IF(JXT.EQ.0.AND.JYT.EQ.0.AND.JZT.EQ.0) GO TO 20
      PRINT 71
      GO TO 22
   20 PRINT 171
  171 FORMAT(10X,'O{ibOK HET')
   22 CONTINUE
      PRINT 177,JXT,JYT,JZT
  177 FORMAT(10X,2HX=,I5,3H Y=,I5,3H Z=,I5)
      PRINT 201,JXL,JXR
  201 FORMAT(10X,7HX(MIN)=,I5,1X,7HX(MAX)=,I5)
      PRINT 202,JYL,JYR
  202 FORMAT(10X,7HY(MIN)=,I5,1X,7HY(MAX)=,I5)
      PRINT 203,JZL,JZR
  203 FORMAT(10X,7HZ(MIN)=,I5,1X,7HZ(MAX)=,I5)
  777 CONTINUE
      J=JOPER('~TO dElATx',2,1)
      IF(J.EQ.'PUSK') GO TO 600
      IF(J.EQ.'STOP') GO TO 100
      J=JOPER('HAdO PUSK ili STOP',3,0)
      GO TO 777
  100 CONTINUE
        STOP
      END
      SUBROUTINE TICODM(INT,OUT)
      INTEGER OUT,DI(4),TK(4),T
      DATA TK/600,60,10,1/
      T=INT
      DO 1 I=1,4
      DI(I)=T/TK(I)
    1 T=T-TK(I)*DI(I)
      ENCODE (6,200,OUT)   DI
  200 FORMAT(X,2I1'.'2I1)
      RETURN
      END
      SUBROUTINE TMDH
C*****   pE~ATx zAgOlOBKA
      COMMON NZ,NC,NG
      COMMON /CNIT/TEXT(4),TTBUF(9),TU(6)
      COMMON /COMER/NER,TER,TERS(19)
     *,MERS(19),NERS(19),NN
     * ,NEX1,NEX0
      COMMON /PC/ PMP
      COMMON /IT/TIT(8),CIT(5)
      COMMON /LINK/DAT,TIM,MCOP,MOPT,NMOD
     *,MFH,MFR,NLO
      INTEGER HEAD(4),TP(2),DP(2),TU
     *,DAT,TIM,SW1,SW2,TER,PMP,TTBUF
     * , TP1(2)
      DIMENSION CT(6)
C
      DATA HEAD/
     * 12HT E C T  M d
     *,12H CEPBiC  Md
     */
      DATA MOPT,MFH /-1,0/
      DATA CT/36000.,3600.,600.,60.,10.,1./
      EQUIVALENCE (TEXT(4),MRW)
C
      IF(MFH.NE.0) GO TO 5
      STIM=TIM
      IF(MOPT.NE.0) GO TO 8
      PRINT 99
   99 FORMAT(1H1)
      MFH=1
      M=1
      IF(MCOP.NE.0) M=3
    1 ASSIGN 4 TO SW2
    2 T=TIM+.5
      DO 3 I=1,6
      TU(I)=T/CT(I)
    3 T=T-TU(I)*CT(I)
      ENCODE (8,100,TP) TU
  100 FORMAT(2I1'.'2I1'.'2I1)
      DECODE (6,101,DAT) TU
  101 FORMAT(6A1)
      ENCODE (8,102,DP) TU
  102 FORMAT(2A1'.'2A1'.'2A1)
      GO TO SW2
    4 PRINT  92,HEAD(M),HEAD(M+1),TP,DP
   92 FORMAT(X,52('-')/X'I'17X,16('*'),17X'I'/
     * ' I   BPEMq'9X'* '2A6' *'10X'dATA   I'/
     * ' I 'A6,A2,8X,16('*'),8X,A6,A2' I'/
     * X,52('-'))
    5 PRINT 103
  103 FORMAT(X,52('-'))
    6 IF(MCOP.NE.0) GO TO 7
      PRINT 104,TIT
  104 FORMAT(' I '8A6' I')
      GO TO 8
    7 PRINT 105,CIT
  105 FORMAT(' I'10X,5A6,10X'I')
    8 MFR=0
      NN1=0
      NLO=1
      NEX1=0
      RETURN
      ENTRY TMDER
C*****   BydA~A COOb}EHiq Ob O{ibKE
      IF(MOPT.EQ.-2) GO TO 11
      CALL ZBCG
      NZM=NZ-4
      ASSIGN 9 TO SW2
      GO TO 2
    9 IF(MCOP.NE.0) GO TO 15
C.....   O{ibKA HA TECTE
      IF(MOPT.NE.0) GO TO 12
C.....   BydA~A HA AcpY
      IF(MFR.NE.0) GO TO 10
      MFR=1
C.....   pE~ATx {ApKi O{ibOK
      PRINT 106
  106 FORMAT(X,52('-')/' I   BPEMq  I'
     * 'I zOHA I cil.IgOl.II O{ibKA'
     * 'I    P C   II'/' I'10('-')
     * 'II------I-----I----II'7('-')
     * 'I'10('-')'II')
   10 PRINT 107,TP,NZM,NC,NG,TER,PMP
  107 FORMAT(' I 'A6,A2' II 'O4' I 'O3
     * ' I 'O2' II 'A5' I 'O8' II')
   11 NERS(NER)=NERS(NER)+1
      NN=NN+1
      NN1=NN1+1
      RETURN
C.....   BydA~A HA OpEP.TEPM.
   12 ENCODE (24,108,TTBUF)
     * NMOD,NZM,NC,NG,TER
  108 FORMAT('Md-'O2','O4'('O3'/'O2')-'A5)
   13 TTBUF(5)=0B
   14 CALL OT OUT(TTBUF,0)
      GO TO 11
C.....   O{ibKA HA COPY
   15 IREG=6HO{.~T
      IF(MRW.NE.0B) IREG=6HO{.zp
      IF(MOPT.NE.0) GO TO 17
      IF(MFR.NE.0) GO TO 16
      MFR=1
C.....   pE~ATx {ApKi O{ibOK
      PRINT 109
  109 FORMAT(X,52('-')/5X'I zOHA(cil/gOl)I'
     * 'I PEviM I O{ibKAI    P C   I'/
     * 5X'I'14('-')'II'7('-')'I'7('-')'I'10('-')'I')
   16 PRINT 110,NZM,NC,NG,IREG,TER,PMP
  110 FORMAT(5X'I 'O4'('O3'/'O2') II '
     * A6'I 'A6'I 'O8' I')
      GO TO 11
   17 ENCODE (22,111,TTBUF)
     * NMOD,NZM,IREG,TER
  111 FORMAT('Md-'O2','O4'='A5'-'A5)
      GO TO 13
      ENTRY TMDLOO
C*****   KOHEc ciKlA
      NLO=NLO+1
      RETURN
      ENTRY TMDSTO
C*****   OCTAHOB PEviMA
      IF(MOPT.EQ.-2) RETURN
      CALL ZBCG
      NZM=NZ-4
      IF(MOPT.NE.0) GO TO 18
C.....   BydA~A HA AcpY
      PRINT 112,NLO,NZM,NC,NG
  112 FORMAT(X,52('-')/' I  PEviM CHqT ,'
     * ' ciKl ='I5' , zOHA ='O4
     * ' ('O3','O2')  I')
      GO TO 11
C.....   BydA~A HA OpEP.TEPM.
   18 ENCODE (18,113,TTBUF)   NLO,NZM
  113 FORMAT('CTOp:c='I4',z='O4)
      TTBUF(4)=0B
      GO TO 14
      ENTRY TMDREG
C*****   iTOg PEviMA
      NEX0=NEX0+NEX1
      IF(MOPT.NE.0) RETURN
      PRINT 114,NN1,NEX1
114   FORMAT(X,52('-')/' I '
     * 'ObHAPYvEHO O{ibOK -'I6,2X
     * '~iClO ObMEHOB -'I6' I')
   19 PRINT 103
      RETURN
      ENTRY TMDEND
C*****   pE~ATx KOHE~HOj {ApKi
      IF(MOPT.NE.0) RETURN
      PRINT 115 , (TERS(I),I=1,10)
     *,(NERS(I),I= 1,10),(TERS(I),I=11,19)
     *,(NERS(I),I=11,19)
  115 FORMAT(/X,60('*')/
     * 19X'C B O d K A  O { i b O K'/
     * X'-----'/3X,10(A5,X)/X,10(I5,X)/
     * X'-----'/3X, 9(A5,X)/X, 9(I5,X)/
     * X,60('*')/)
   20 RETURN
      END
      SUBROUTINE TMLMD(LD)
C----------------------------------------
C     pE~ATx TAblic YCTAHOBlEHHyX Ml,dp
C----------------------------------------
      COMMON /UPAS/ KKKK(128)
      COMMON /RESURS/ SV(32),TABLE(32,2)
      COMMON /NMOD/ NMOD(8) /L/ L,LL
      COMMON /PAR/ ID,ID1
      INTEGER TABLE
      DATA(KONST=1H )
      IF(LD.EQ.1) GO TO 22
   21 I=4
      GO TO 23
   22 I=2
   23 CALL HAVERS(LD)
      IFL=0
      DO 1 J=1,I
      DO 2 K=1,8
      L=(J-1)*8+K
      IF(TABLE(L,1).NE.KONST) GO TO 3
    2 CONTINUE
      GO TO 1
    3 IF(IFL.NE.0) GO TO 4
      IF(LD.EQ.1) GO TO 6
      CALL LPR
      GO TO 4
6     CALL DPR
    4 IFL=1
      DO 9 K=1,8
9     NMOD(K)=(J+2)*8+K-1
      L=(J-1)*8+1
      LL=L+7
      CALL LDPR
    1 CONTINUE
      IF(IFL.EQ.1) GO TO 24
      IF(LD.EQ.1) GO TO 13
      CALL LPR1
      GO TO 20
 13   CALL DPR1
      GO TO 20
   24 IF(ID.EQ.0) CALL LPR1
      IF(ID.EQ.2) CALL LDPRST
   20 CONTINUE
      RETURN
      END
      SUBROUTINE VZERO(IA,N)
      DIMENSION IA(2)
      IF (N .LE. 0)    GO TO   99
      DO 10 I=1,N
   10 IA(I) = 0
   99 CONTINUE
      RETURN
      END
      SUBROUTINE WHATIS
          COMMON/FL/IFLPL
          COMMON/NZ1/NZ1
      COMMON/NAME/NAME(2),NFL
      EQUIVALENCE (IFLPL,NZ2)
      DATA(NAME=6H       ,6H       )
      COMMON /CLNEWS/ MTTEK,NZC,LW,LINE(84),LASTZI
     *       ,IFLOLD,LT1C
      COMMON /id/ MTID(2)
      DIMENSION IPICT(12)
      DATA (IPICT=1H*,1HR,1HE,1HA,1HD,1H ,1HO,1HL,1HD,3(1H ))
      LT1C=0B
      CALL bObHOM
      PRINT 101,MTID(2),MTID(1),NZC,LASTZI
      LASTZI=I10T8(LASTZI)+1
      NZC=I10T8(NZC)-1
      MAINFL=NZ1
    1 IF(NEWSTR(1023).NE.1) GO TO 3
      NZCOLD=NZC
          GO TO 21
    2 IF(NZC+1.NE.LASTZI) GO TO 1
      RETURN
    3 PRINT 201,NZC,(LINE(II),II=1,80)
      NZCOLD=NZC
    4 NEW=NEWSTR(LW)
      IF(NEW.EQ.1) GO TO 6
      IF(NEW.EQ.3) GOTO 11
      IF(MAINFL.EQ.0) GO TO 7
      CALLHEADLT(LINE(1))
      IF(NFL.EQ.1)PRINT 601,NZC,NAME,(LINE(II),II=1,80)
    7 CONTINUE
      NZCOLD=NZC
      DO 5 J=1,12
      IF(LINE(J).NE.IPICT(J)) GO TO 4
    5 CONTINUE
      PRINT 301,NZC
      GO TO 2
    6 PRINT 401,NZC
  11  IF(NZC.EQ.LASTZI) RETURN
      IF(NZC.NE.NZCOLD) IFLOLD=1
  21  NZCOLD=NZC
      CALL READCG
      IF(NZC.NE.NZCOLD)IFLOLD=1
          IF(IFLPL.EQ.1) PRINT 501,NZ1
      IF(IFLPL.EQ.2)PRINT 100,NZ1
      IF(IFLPL.EQ.3)PRINT 99,NZ1
          IF(NZ2.EQ.1)IFOLD=0B
          IFLPL=0
      GO TO 2
   99 FORMAT('+  COMMON:  B ',O4,'-1')
  100 FORMAT('+  OVERLAY: B ',O4)
  101 FORMAT(' HA lEHTE ',A4,'/',A6,' B zOHAX',X,O4,'-',O4,' ObHAPYvEHO:
     * '/)
  201 FORMAT('   TEKCT   OT 'O4'  1-Aq KAPTA: '80A1,1H.)
  301 FORMAT('           dO 'O4)
  401 FORMAT('   iCpOP~EH B 'O4/)
  501 FORMAT(1H+'  PERSO:   B 'O4)
  601 FORMAT(10X,O4,2X,2A6,2X,2H: ,80A1,1H.)
      END
      SUBROUTINE WRKPRT(ICODE)
C.
C...      pE~ATx Ob'EKTOB B zAdAHHOM fOPMATE
C.
C.         IANSW(3)            --     iMq Ob'EKTA
C.         IANSW(5)            --     HA~AlxHyj HOMEP BHYTPi Ob'EKTA
C.         IANSW(6)            --     ~iClO BydABAEMyX |lEMEHTOB
C.         ITPKAT              --     Tip (COM,ENTRY,SUB i T.p.)
C.         LADRES              --     AdPEC Ob'EKTA B OzY
C.         LENTH               --     PAzMEP Ob'EKTA B OzY
C. ---------
C.
C.         ICODE               --     HOMEP fOPMATA dlq ByBOdA
C.
      COMMON /PAR42z/ IFRAG , ITYP  , KOD   , IGO   , IANSW(10)
     +,               LQUEST, I~Y{x , ITERMS, ITERMD, NO
     +,               IYES  , LENTH , ITPKAT, LANSW , LADRES
     +,               NAME(2),IQUEST(4,10),IDFLAS(10)
      DATA ASS /0/
      DIMENSION IFRAG(15)
      COMMON /PROTO/ AP, NUNIT, NL, NF, INT, NSTR(15)
      DIMENSION STRI(15), SHAPKA(12)
      DATA LSTR /4/
      DATA IBLAN / ':'/
      DATA SHAPKA /1H ,1H ,1H1,1H ,1H ,1H2,1H ,1H ,1H3,1H ,1H ,1H4/
      IF (ICODE .GT. 7)           ICODE=8
      GO TO (100,200,300,400,500,600,700,800), ICODE
C--
C--       pE~ATx B BOCxMEPi~HOM fOPMATE
C
  100 CONTINUE
      IFIRST = IANSW(5)
      ILAST  = IFIRST + IANSW(6) - 1
C--
C--       ByBOd {ApKi
C
      CALL PUTO(STRI,LADRES-1,1,5,5,IPOZ)
      CALL PUTH(0,SHAPKA,1,24,M,IPOZ)
      CALL PUTH(0,SHAPKA(5),1,24,M,IPOZ)
      CALL PUTH(0,SHAPKA(9),1,24,M,IPOZ)
      CALL DIALOG(STRI,77,-1)
C
      DO 120 J=IFIRST,ILAST,LSTR
           JADR = J-1
           CALL VBLANK(STRI,15)
           CALL PUTO(STRI,JADR,1,5,5,IPOZ)
           CALL PUTH(0,IBLAN,1,3,M,IPOZ)
           ICOUNT = LSTR
           IF (ILAST-JADR .LT. LSTR)      ICOUNT = ILAST-JADR
           DO 110 I=1,ICOUNT
               JOBC = JEXTRA(ASS,63B,LADRES+JADR+I-1)
               CALL PUTO(0,JOBC,1,16,16,IPOZ)
               CALL PUTH(0,IBLAN,1,2,M,IPOZ)
  110      CONTINUE
           CALL DIALOG(STRI,78,-1)
  120 CONTINUE
                                        GO TO   999
  200 CONTINUE
  300 CONTINUE
  400 CONTINUE
  500 CONTINUE
  600 CONTINUE
  700 CONTINUE
  800 CONTINUE
  999 CONTINUE
      RETURN
      END
      SUBROUTINE ZBCG
      COMMON // NZ,NC,NG
     *  ,ITYP
      NC=NZ/5
      NG=NZ*2-NC*10
      IF(ITYP.EQ.0) RETURN
C  dlq Md 29 MEgAbAjT
      NC=NZ/20
      NG=NZ-NC*20
      RETURN
      ENTRY CGBZ
      NZ=NC*5+NG/2
      IF(ITYP.EQ.0) RETURN
C  dlq Md 29 MEgAbAjT:
      NZ=NC*20+NG
      RETURN
      END
      SUBROUTINE iHi42z
C.
C...      fOPMiPOBAHiE YpPABlq`}iX TAblic
C.
      COMMON /PAR42z/ IFRAG , ITYP  , KOD   , IGO   , IANSW(10)
     +,               LQUEST, I~Y{x , ITERMS, ITERMD, NO
     +,               IYES  , LENTH , ITPKAT, LANSW , LADRES
     +,               NAME(2),IQUEST(4,10),IDFLAS(10)
     +,                IDIVNU, IDIVNA
      DIMENSION IFRAG(15)
C
      DATA LANSW     / 10 /
     +,    LQUEST    / 24 /
     +,    ITERMS    /' '/
     +,    ITERMD    / ';'/
     +,    NO        /'N'/
     +,    IYES      /'Y'/
     +,    IDIVNU    /':'/
     +,    IDIVNA    /'$'/
C--
C--       zHA~EHiq pO YMOl~AHi` dlq  IANSW
C--
C--        HOMEP {AgA       zHA~.       pPiM.
C--            IGO
C--
C--             1           pYCTO        OpPEd.MECTO T P p
C--             2           pYCTO        "dAj iMq" --
C--                                       iMq Ob'EKTA dlq pOiCKA
C--             3            NAME         iMq, HAjdEHHOE pO T P p
C--             4            1 = 'dA'     'pOCMOTPiM'
C--             5            0            'C KAKOgO |lEMEHTA'
C--             6              1          'CKOlxKO'
C--             7              1          'KOd BOCxMEPi~Hyj'
C--            8            2 = 'HET'    'pPOdOlviM'
C--            9            1 = 'dA '    'zAKOH~iM'
C
C--------------------------------------------------------------------
      DATA IDFLAS / 0,0,0,1,0,1,1
     +,             2
     +,             0
     +,             0
     + /
      DATA IQUEST / 24H-pPOCMOTP MOzY pO iMEHi-
     2,              24HdAj iMq
     3,              24HHET TAKOgO
     4,             24HpOCMOTPiM?  (Y/N)
     5,             24HC KAKOgO |lEMEHTA?
     6,             24HCKOlxKO?
     7,             24HB KAKOM KOdE?
     8,             24HpPOdOlviM?  (Y/N)
     9,             24HzAKOH~iM?   (Y/N)
     *,             24HKOH~ili.
     */
      ITERMS = JBYT(ITERMS,41,8)
      ITERMD = JBYT(ITERMD,41,8)
      IDIVNU = JBYT(IDIVNU,41,8)
      IDIVNA = JBYT(IDIVNA,41,8)
      RETURN
       END
*FULL
*MADLEN,L=R.
 *COMER*:,NAME,.
 ,INT,1
 ,ISO,6H
 ,BSS,
C------
 ,ISO,6HpPO~.
 ,ISO,6HMdO{M
 ,ISO,6HMdKC
 ,ISO,6HMdAdP
 ,BSS,
C------
 ,ISO,6HO{pK
 ,ISO,6HO{b
 ,ISO,6HBKl
 ,ISO,6Hgd
 ,ISO,6HpH
 ,ISO,6Hzzp
 ,ISO,6HACd
 ,ISO,6HCpid
 ,ISO,6HKA
 ,ISO,6HYCT.0
 ,ISO,6HCPABH
 ,ISO,6HCpA
 ,ISO,6H1PCK
 ,ISO,6HPC~A
 ,ISO,6HAB
 ,BSS,
C------
 ,LOG,.
 ,OCT,00000001.Md-O{M
 ,OCT,00000002.Md-KC
 ,OCT,00000004.Md-AdP
C------
 ,LOG,40000000 40000000.O{pK
 ,LOG,20000000 20000000.O{b
 ,LOG,04000000 00000001.BKl
 ,LOG,00000400 00000001.gd
 ,LOG,00001000 00001000.pH
 ,LOG,0200 0000 0200 0002.zAp
 ,LOG,00010000 00010001.ACd
 ,LOG,00100000 00100000.Cpid
 ,LOG,00200000 00200000.KA
 ,LOG,00440000 00400001.YCT.0
 ,LOG,00440000 00440000.CPABH
 ,LOG,00040000 00040000.CpA
 ,LOG,00002000 00002000.1PCK
 ,LOG,00020000 00020000.PC~A
 ,LOG,00004000 00004000.AB
C------
 NERS:,BSS,19.
C------
 ,BSS,1.
 ,BSS,2
 ,DATA,.
 INT0:,INT,0.
 :1,SET,INT0.
 22,,NERS
 ,END,.
 *IDUE10:,NAME,.lOpATKO 19/04/81
C  TAblicA CiMBOlOB dlq pEPEKOdiPOBKi
C  ISO(dYbHA) - EBCDIC(EC-1010)
 ,ISO,6H''''''''''''.0-3
 ,ISO,6H'''''175'''''''.4-7
 ,ISO,6H''''''''''''.10-13
 ,ISO,6H''''''''''''.14-17
 ,ISO,6H''''''''''''.20-23
 ,ISO,6H''''''''''''.24-27
 ,ISO,6H'''173'''''''''.#
 ,ISO,6H'''''''''137'''.^
 ,ISO,6H'''100''117''177'''''. !"
 ,ISO,6H'''133''154''120''175'''.$%&'
 ,ISO,6H'''115''135''134''116'''.()*+
 ,END,
 *TABLE//:,NAME,
 ,LOG,60
 ,LOG,61.1
 ,LOG,62
 ,LOG,63
 ,LOG,64
 ,LOG,65
 ,LOG,66
 ,LOG,67
 ,LOG,70
 ,LOG,71
 ,LOG,53.+
 ,LOG,55.-
 ,LOG,57./
 ,LOG,54.,
 ,LOG,56..
 ,LOG,40.
 ,LOG,105.Op 10
 ,LOG,136.CTPElKA
 ,LOG,50.(
 ,LOG,51.)
 ,LOG,52.YMHOviTx
 ,ISO,6H''''''''''=
 ,ISO,6H'''''''''';
 ,LOG,133.[
 ,LOG,135.]
 ,LOG,52.*
 ,LOG,47.'
 ,LOG,47.'
 ,LOG,43.#
 ,ISO,6H''''''''''<
 ,ISO,6H''''''''''>
 ,LOG,72.:
 ,ISO,6H''''''''''A
 ,ISO,6H''''''''''b
 ,ISO,6H''''''''''B
 ,ISO,6H''''''''''g
 ,ISO,6H''''''''''d
 ,ISO,6H''''''''''E
 ,ISO,6H''''''''''v
 ,ISO,6H''''''''''z
 ,ISO,6H''''''''''i
 ,ISO,6H''''''''''j
 ,ISO,6H''''''''''K
 ,ISO,6H''''''''''l
 ,ISO,6H''''''''''M
 ,ISO,6H''''''''''H
 ,ISO,6H''''''''''O
 ,ISO,6H''''''''''p
 ,ISO,6H''''''''''P
 ,ISO,6H''''''''''C
 ,ISO,6H''''''''''T
 ,LOG,165.Y
 ,ISO,6H''''''''''f
 ,ISO,6H''''''''''X
 ,ISO,6H''''''''''c
 ,ISO,6H''''''''''~
 ,ISO,6H''''''''''{
 ,ISO,6H''''''''''}
 ,ISO,6H''''''''''y
 ,ISO,6H''''''''''x
 ,ISO,6H''''''''''|
 ,ISO,6H''''''''''`
 ,ISO,6H''''''''''q
 ,ISO,6H''''''''''D
 ,ISO,6H''''''''''F
 ,ISO,6H''''''''''G
 ,ISO,6H''''''''''I
 ,ISO,6H''''''''''J
 ,ISO,6H''''''''''L
 ,ISO,6H''''''''''N
 ,ISO,6H''''''''''Q
 ,ISO,6H''''''''''R
 ,ISO,6H''''''''''S
 ,ISO,6H''''''''''U
 ,ISO,6H''''''''''V
 ,ISO,6H''''''''''W
 ,ISO,6H''''''''''Z
 ,LOG,136.^
 ,ISO,6H''''''''''<
 ,ISO,6H''''''''''>
 ,LOG,77.BMECTO ili
 ,LOG,46.'AND'
 ,LOG,77.BMECTO BlE~ET
 ,LOG,137.BMECTO OTPicAHiq
 ,LOG,134.BMECTO cEl.dElEH.
 ,ISO,6H''''''''''=
 ,LOG,45.%
 ,LOG,44.dOllAP
 ,ISO,6H''''''''''I.BEPT ~EPTA
 ,ISO,6H''''''''''-.gOP. ~EPTA
 ,LOG,137.pOd~EPK
 ,LOG,41.BOCKl zHAK
 ,LOG,42.KABy~Ki
 ,LOG,47.TBEPdyj zHAK
 ,LOG,100.gPAdYC
 ,LOG,47.ApOCTOPOf.134-j KOd!
 ,LOG,41.
 ,LOG,41.
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41.
 ,LOG,41.
 ,LOG,41.150
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,60.160
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41
 ,LOG,41.170
 ,LOG,41.
 ,LOG,41
 ,LOG,12.173
 ,LOG,15.174
 ,LOG,12
 ,LOG,15
 ,LOG,74.
 ,END,
 /DECODER:,NAME,.CAXAPOB
 TABLE2*:,SUBP,.
 *CARDS:LC,BLOCK,INC(24)
 ,CONT,(20)
 ,CONT,OUTC(25)
 ,CONT,(99)
 ,ITA,2.
 ,ITS,3.
 ,ITS,4.
 ,ITS,5
 ,ITS,13.
 ,ITS,  .
 2,VTM,-24
 ZZ:2,ATX,OUTC+24
 2,VLM,ZZ.
 2,VTM,-24
 3,VTM,40.
 4,VTM,OUTC.
 5,VTM,-48.
 NEW:2,XTA,INC+24.
 3,UTM,-8.
 3,ASN,64.
 ,AAX,=377.
 ,ATX,SYM.
 3,VIM,*1.
 3,VTM,40.
 2,UTM,1
 2,VZM,BCE.
 *1:,BSS,.
 ,UZA,NEW.
 ,ACX,.
 ,AAX,=1
 ,UZA,ERRUPP.
 ,XTA,SYM.
 ,AAX,=177.
 ,ATI,13.
 ,NTR,3
 ,A-X,=134
 ,UZA,ERRUPP.
 13,XTA,TABLE2*.
 5,UTM,8.
 5,ASN,64.
 4,AOX,.
 4,ATX,.
 5,VIM,NEW.
 5,VTM,-48.
 4,UTM,1
 ,UJ,NEW.
 BCE:,XTA,=12
 5,ASN,64+8
 4,AOX,.
 4,ATX,.
 ,XTA,=6HO'47'KEY'41'
 EXIT:,STX,OUTC+24.
 ,STI,13.
 ,STI,5.
 ,STI,4.
 ,STI,3.
 ,ATI,2.
 ,XTA,OUTC+24
 ,NTR,6.
 13,UJ,.
 ERRUPP:,XTA,.
 ,UJ,EXIT.
 SYM:,BSS,1.
 ,END,/DECODER.
   ADDTEXT:,NAME,.07.05.79
C   ClOvEHiE BypOlHqETCq pO MOdYlqM,
C   zAdAHHyM dlq KAvdOj cifPy ClAgAEMyX B
C   COMMON ClOBAX: MACKE MS i iHBEPTiPOBAHHOj MACKE INVMS
C   ClAgAEMOE OdHO - B COMMON OP 32-1PP,
C   BTOPOE - HA CYMMATOPE B 32-1PP
C  PEzYlxTAT - 4 CiMBOlA HA CYMMATOPE B
C  CTAP{iX(48-17)PP B KOdE  ISO-'060'
C   p/p PAbOTAET pPi YCTAHOBlEHHOM ,NTR,3
  *MACKi*:LC,BLOCK,MS,INVMS,OP
 ,NTR,7.
  ,AAX,=6H'''''17''17''17''17'
     ,ARX,OP
   ,AAX,=6H'''''17''17''17''17'
  14,VTM,-2
  L:,ATX,R.
C   zApOMHiM MECTA pEPEHOCA B dECqTKi
   ,ARX,INVMS
  ,AAX,=6H'''''200''200''200''200'
 ,ATX,R1.zdECx pEPEHOCy
C   By~iCliM OCTATKi B EdiHicAX
 ,AEX,=6H'''''200''200''200''200'
 ,ASN,64+7
 ,ARX,=6H'''''177''177''177''177'
 ,AAX, MS
 ,X-A,R.OCTATKi
C YBEli~iM dECqTKi B MECTAX pEPEHOCA
 ,XTS,R1
 ,ASN,64-1
 15,ARX,. dE CqTKi
C ciKl pO BCEM cifPAM ClAgAEMyX
 14,VLM,L
 ,ASN, 64-16
 13,UJ,
 R:,BSS,1.
 R1:,BSS,1.
 ,END,
 AdPMl:,NAME,
 *ONE*:LC,BLOCK,(1),TY2
 C:8,BASE,*
 ,STX,A NZ
 9,VTM,0. OT Ml
 Ml/Md:,STX,A NY
 ,ATI,10. N Ml ili KYC
 ,XTA,TY2
 ,AEX,INT0
 ,ASN,64+1
 ,UZA,gT/HgT. pO i10-N Ml
 10,XTA,
 ,APX,PAM 1. pOlY~EHiE
 ,ASN,64+42. HOMEPA YCTP.
 ,AOX,INT0. iz KYC'A
 WR NY:,WTC,A NY
 ,ATX,. EgO zApiCx
 9,V1M,RET. - HE Ml
 10,XTA,
 ,AAX,BIT iMq
 ,UZA,MAK NZ
 HET NZ:,XTA,INTM1
 ,UJ,WR NZ
 MAK NZ:10,XTA,
 ,ASN,64+25
 ,ARX,C1774.
 ,ASN,64+6
 ,AAX,C17.HOMEP Y~ACTKA
 ,AOX,INT0
 WR NZ:,WTC, A NZ
 ,ATX,
 RET:,STX,
 13,UJ,
 gT/HgT:10,XTA,
 ,AOX,INT0
 10,VTM,BIT iMq
 ,UJ,WR NY
 AdP Md:,ENTRY,
 8,BASE,C
 9,VJM,Ml/Md
 AdPMb:,ENTRY,
 8,BASE,C
 ,STX,A NY
 ,ATI,10
 10,XTA,
 ,APX,PAM 2
 ,ASN,64+39
 ,AOX,INT0
 9,VJM,WR NY
 8,BASE,C
 ,ATI,14
 14,XTA,
 ,AAX,=40
 ,ASN,64+5
 ,AOX,INT0
 13,UJ,
 BIT iMq:,LOG,20
 PAM 1:,LOG,70 0000 0000 1600
 PAM 2:,LOG,20 0000 0000 1774
 C17:,LOG,17.
 C1774:,LOG,1774.
 INT0:,INT,0
 INTM1:,INT,-1
 A NY:,BSS,1
 A NZ:,BSS,1
 ,END,
 BATCHINP:,NAME,.............
C
C******   pETPOB - 22.02.76 - iA|
C
C         pOdpPOgPAMMA zApiCi zAdA~i
C         B fAjl BBOdA.
C
C         ObPA}EHiE - CALL BATCHINP(A,B,C,D)
C         A - AdPEC pp BydA~i pEPfOKAPTy
C         B - 1-8 PP HOMEP lAbOPOTOPii B
C            pOziciOHHOM KOdE
C  B MHOgO{ifPOBOM DD iCpOlxzY`TCq
C  TOlxKO 6 CTAP{iX PAzPqdOB, pPi~EM
C  dlq MYlxTiTAjpA B=4 (3-j PAzPqd)
C         C.EQ.0B - KAPTA KOdiPOBAHA
C         C.NE.0B - BINARY-KAPTA
C         D.EQ.0B - pO *NAME, pOCTYpiB{Ej
C         dO diCpET~EPCKOgO KOHcA, zApiCx
C         3AdA~i (BBOd pAKETA 3AdA~D
C         D.NE.0B - YHi~TOvEHiE BBEdEHHOgO
C
C         pPi3H. diCp. KOHcA - i14=0
C
C         BCE O BBOdE B MAgA3iHE :
C            XAPAKTEPiCTiKA
C            iMq - 3 q~.
C            iMq - 2q~.
C            iMq - 1 q~.
C         .................
C         .................
C            XAPAKTEPiCTiKA
C            iMq
C            iMq
C            iMq
C         0 - BINARY
C
C         1-15 PP XAPAKTEPiCTiKi :
C            .EQ.0 - XOPO{O
C            .EQ.1 - O{. BBOdA
C            .EQ.2 - O{. B pACpOPTE
C            .EQ.3 - HET pK *NAME
C            .EQ.4 - q CKOH~AlACx
C         25-31PP XAP-Ki - HOMEP
C         3AdA~i BFAjlE BBOdA
C
C          BINARY-KAPTA B INC,
C          KOdiPOBAHHAq B OUTC
C         COMMON-A *CARDS
C******
 *CARDS:LC,BLOCK,INC(24),(20)
 ,CONT,OUTC(25)
 ,CONT,UNPC(84),(15)
 *CODES:,LC,4
 *ERRORS:LC,BLOCK,FLBLER,(2)
 ,CONT,*ER/TEX,(2),*ER/BIN
 ,CONT,*ER/CM,*ER/COS
 INF/BA:LC,BLOCK,(1),T/NAM(6)
 *DECLARA:LC,BLOCK,TAPE VOL,DISC VOL,
 ,CONT,NAME(3),TIPASCRA,
 ,CONT,REG/DEN
 ,CONT,VOLUMES(50)
 COTKAZPV:,LC,1
 *FLAG*:LC,BLOCK,MER,(12)
 *ORDEN:,LC,128
 *SPCCMN:,LC,3
 OUT*OUT:,LC,1
 MONCARD/:,LC,14
 TABLE2*:,SUBP,
 STARSTA:,LC,1
 MIST10*:,LC,3
 *MONCRD*:,LC,12
 A/ipd  :,EQU,760B.
 {/FULL  :,EQU,11B.
 SC/PLAN :,EQU,75B.
 SC/FREE :,EQU,1720B.
 N JOBS  :,EQU,1772B.
 LIST:,PC,1024
 CATALOG:,PC,1024.
 STAT:,EQU,0
 TIM/PAS:,EQU,1
 LEN/COD:,EQU,1
 NL:,P/P,(LIST)16
 INITCODE:,SUBP,
 ATIME:,EQU,542B
 AgYC:,EQU,502B
 ASTMT:,EQU,520B
 RDSC:,EQU,1
 MN*TL:,EQU,1067B
 ,UTC,KOD7.
 BATCHIN1:,ENTRY,.............
 ,XTS,.
 ,STX,KZ.
 9,VJM,PAR.
 9,VTM,1-7.
 UPR:9,ITA,7. - YpPqTyBAHiE
 9,ATX,IR+6.
 9,VLM,UPR....
 ,XTA,. - METKA
 15,ATX,. MAgAziHA
 ,ATX,BNLAB
 ,ITA,13.
 ,ATX,RET.
 3,VTM,0.
 ,XTA,K UJ.AdP. pEPEXBATA
 ,CTX,20B.|74
 14,VTM,20B.
 ,ITA,14
 ,FUN,74B.
 ,WTC,NLAB. - pOlY~EHiE
 ,XTA,. 8-pi~HOgO
 ,ASN,64-40. HOMEPA
 ,AAX,=:77
 ,UZA,BEGIN
 ,ANX,. lAbOPATOPii
 ,ATX,BNLAB....
 BEGIN:,BSS,.
 ,NTR,6. - 3ACE~KA
 ,FUN,70100B-1B.
 ,ATX,STIME. - C~ETHOE
 ,FUN,70100B+110B.
 ,ATX,CTIME . - KOMEP~ECKOE
C         fOPMiPOBAHiE
C         pEPBOHA~AlxHOgO
C         pACpOPTA
  1,VJM,GIVCAT
 ,XTA,DEK.zApPOC |l.
 13,VJM,dAj PEC.KATAlOgA
 ,UZA,ERR2.HET |l.
 ,AEX,B48.
 ,ATX,NBK.
 2,VTM,1-16.
 ,XTA,DZ2
 13,VJM,dAj PEC.zApP. zOHy
 ,UZA,ERR2.HET zOHy
 ,AEX,B48.
 ,ATX,NZ.
 ,XTA,NBK.fOPMiPOBAHiE
 ,ASN,64-4.pEPBi~HOgO
 ,ATI,5.pACpOPTA
 5,UTM,CATALOG.
 ,XTA,.ObHYlEHiE
 RD8:5,UTC,.
 2,ATX,15.
 2,VLM,RD8....
 ,FUN,114B.
 ,ASN,64-13.XAP-KA 2.
 ,AAX,B48/30.
 5,ATX,TIM/PAS
 ,*63,ATIME.
 ,NTR,3.
 ,A+X,=I0
 ,ASN,64-12
 ,AAX,B29/13.
 5,AOX,TIM/PAS
 5,ATX,TIM/PAS
 ,XTA,NBK.fOPMiPOBAHiE
 ,ARX,B1.XAPAKTEPiCTiKi 1
 ,ASN,64-24.N B KAT.
 ,ATX,REL NZ.
 ,WTC,NLAB. - HOMEP
 ,XTA,. lAbOPATOPii
 ,ASN,64-16
 ,AAX,=7700 0000.24-19
 ,AOX,REL NZ.
 ,ATX,REL NZ.N HA4. zOHy
 ,AOX,NZ.
 5,ATX,STAT
 13,VJM,TAKCAT....
C         BBOd, pEPEKOdiPOBKA i
C         zApiCx HA Ml
 ,XTA,.
 ,ATX,FL NAME.
 4,VTM,LIST+2.
 7,VTM,.fl.BBOdA pACp.
 9,MTJ,1.
 ,CALL,INITCODE.
  6,VTM,1.C~-K KAPT
  ,CALL,ORD INIT
 14,VTM,-1.
 3,V1M,CODE.pOClE OTKAzA
 NEW C:,WTC,AREAD. - zA
 13,VJM,. KAPTOj
 10,VTM,NEW C. - KAPTA
 ,WTC,DCOD. KOdiPOBAHA
 ,XTA,.
 ,UZA,WRITE/.
 CODE:,BSS,.
 9,MTJ,1.
 ,CALL,DECODER.HA pEPEKOdiPOBKY
 1,MTJ,9.
 14,UJ,KL.
 KL:,BSS,.pEPEKl`4ATElx
 ,UJ,END F.
 :10,VTM,CODE.
 ,UJ,WRITE.
 :,UJ,NEW C.
 :10,VTM,NEW C.
 ,UJ,WRITE....
 WRITE/:14,VZM,ENDF.
 ,UJ,WRITE.
C-----     zApiCx pEPEKOdiPOBAHOj KAPTy
 WRITE:,XTA,OUTC.
 ,ASN,64+40.pPizHAK :
 ,ATI,3.TEXT/NONTEXT
 1,VTM,OUTC.
 2,VTM,1-14.
 ,U1A,WR 1. - TEKCT
 1,XTA,.
 ,ATI,2.
C         pEPEpiCx PEzYlxTATA
 WR 1:4,UTM,-LIST-1024.pOME}AETCq
 4,VZM,WRITE Z. - HET
 4,UTM,LIST+1025.
 1,XTA,.
 4,ATX,-1.
 1,UTM,1.
 3,VZM,WR 2. - HE TEKCT
 ,AAX,=377.
 ,AEX,=12.KOHEc TEKCTA
 ,UZA,END C. - dA
 WR 2:2,VLM,WR 1.
 END C:,BSS,.
 6,UTM,-1.
 7,V1M,FIN R.
 3,V1M,PASP.
 ,XTA,OUTC.
 ,AAX,=77777 00000.
 3,VTM,OUTC.diAgHOCTiKA
 ,UZA,ORD7. - HET
 10,UJ,. - dA
 PASP:,BSS,.
 3,VTM,OUTC.YpAKOBKA KAPTy
 ,ITS,3.dlq p/p
 ,CALL,COSYTISO.*ORDERS
 ORD7:9,MTJ,1.
 10,MTJ,2.
 ,ITS,3.
 ,CALL,ORDERS*.
 1,MTJ,9.
 2,MTJ,10.
 ,XTA,FL NAME.pEPBAq KAPTA
 ,U1A,ORD3.HET
 ,XTA,B1.
 ,ATX,FL NAME.
 ,XTA,MER.
 ,UZA,ORD3.KAPTA *NAME
 ,WTC,BNLAB. - N lAb
 ,XTA,CNLAB-1. B COOb}EHiE
 ,ATX,TT NAME.
 12,VTM,TT NAME.COOb}.
 13,VJM,TTPR.NAME HET
 10,VJM,HA.BOzBP.zAXB.
 ,XTS,.
 ,CALL,ORDERS*
 14,VTM,3
 ,XTA,=3. - HET pK
 15,ATX,. *NAME
 ,UJ,RETURN....
 ORD3:14,V1M,FIN R.
 7,UTM,1.pACpOPT
 ,XTA,*ER/TEX.KOH4ilCq
 ,AOX,*ER/BIN.O{. B KAPTAX
 ,ATX,*ER/BIN.pACp. -fATAlxHAq
 FIN R:,BSS,
 10,UJ,.
C         zApiCx zOHy fAjlA zAdA~i
 WRITE Z:,BSS,.
 ,XTA,DZ2.zApPOC
 13,VJM,dAj PEC.zOHy
 ,UZA,ERR2.HET zOHy
 ,AEX,B48.
 ,ATX,NZ+1.
 1,VJM,WRZ.
 6,VTM,1.C~ET~iK KAPT
 4,VTM,LIST+2.
 ,XTA,NZ+1.
 ,ATX,NZ.
 ,UJ,WRITE....
 ERR2:12,VTM,ER1.
 ,UJ,TELL1....
C         zApiCx pOClEdHEj
C         zOHy fAjlA i dO
C         fOPMiPOBAHiE
C         KATAlOgA
 END F:,XTA,OUT C.HOByj *NAME
 ,AEX,NAMEM.
 ,AAX,=7777 7777 7777 7400
 ,U1A,HE OTK. - HET
 7,V1M,NEP. HE pACpOPT
 ,XTS,. - CbPOC
 ,CALL,ORDERS*.
 NEP:,BSS,
 11,VTM,0. - BBOdiTx HOBY` z
 3,VTM,3. 1-q pK BBEdEHA
 ,WTC,OTK. - pO HOBOMY
 ,XTA,. *NAME-OTKAz
 ,UZA,PREN. - HET
 ,UJ,RP....
 RP:,BSS,
 10,VTM,END PAC.COOb}EHiE
 ,UJ,HA.BOzBPAT zAXB.
 HE OTK:11,VTM,-1.
 3,VTM,0.
 ,XTA,COTKAZPV.
 ,UZA,PREN.
 3,VTM,3.
 10,VTM,END PAC.
 ,UJ,HA.
 PREN:,BSS,.KOHEc KOlOdy
 ,XTA,
 ,ATX,NZ+1
 1,VJM,WRZ.....
 1,VJM,GIVCAT.
C-----     zApiCx pACpOPTA B KATAlOg
 14,VTM,0.
 ,XTA,*ER/BIN.
 ,AOX,*ER/CM.
 ,AOX,MER.
 ,UZA,CHER 1.
 14,UTM,20000B.fAT.O{ibKA-B14
 CHER 1:,XTA,*ER/COS.
 ,AOX,*ER/TEX.
 ,UZA,CHER 2.
 14,UTM,10000B.HE fAT.O{ibKA-B13
 CHER 2:14,MTJ,4.O{.BBOdA
 ,XTA,FLBLER.
 ,UZA,CHER 3.
 14,UTM,4000B.blOK.O{.-B12
 CHER 3:,ITA,14.
 ,ASN,64-3.17-15 PP
 ,XTS,TAPE VOL.KOl-BO lEHT
 ,ASN,64-41. - b45/42
 15,AOX,.
 ,XTS,DISC VOL.KOl-BO dp
 ,ASN,64-37. - B41/38
 15,AOX,.
 ,AOX,B48.BBOd zAKOH~EH
 ,AOX,REL NZ.KOl-BO zOH
 ,AOX,B18.iHf.KOdiP.
 5,AOX,STAT.XAP-KA 1
 5,ATX,STAT.gOTOBA
 1,VTM,1-5.
 WR NAME:1,XTA,NAME+4.iMq
 5,UTC,.zAdA~i
 1,ATX,6.
 1,VLM,WR NAME....
 6,VTM,7.
 5,J+M,6.
 7,VTM,VOLUMES.
C-----     zApiCx iHf. O PECYPCAX
 1,VTM,1-9.
 WR RES:7,XTA,.
 ,UZA,ALLES.BCE
 6,ATX,.
 6,UTM,1.
 7,UTM,1.
 1,VLM,WR RES....
  7,XTA,
  ,UZA,ALLES
 ,XTA,DEK.HEXBATilO MECTA
 13,VJM,dAj PEC.E}E |l-T
 ,UZA,ERR2.HET |lEMEHTA
 ,AEX,B48.
 ,ATX,P.
 ,ARX,B1.
 ,ASN,64-30.
 5,AOX,STAT
 5,ATX,STAT
 5,MTJ,6.
 ,XTA,P.
 ,ASN,64-4.
 ,ATI,5.
 5,UTM,CATALOG....
 1,VTM,1-16.
 ,XTA,.
 W2:5,UTC,.ObHYlEHiE
 1,ATX,15.
 1,VLM,W2.
 6,XTA,.XAP. 1 B pACp.
 ,AAX,MASKX.pPOdOlvEHiq
 ,AOX,B37.biT pACp. pPOdOlv.
 5,ATX,STAT
 6,VTM,1.
 5,J+M,6.
 1,VTM,1-15.HA pPOdOlv.
 ,UJ,WR RES....
 ALLES:2,VTM,CATALOG.
 2,XTA,N JOBS.
 ,ARX,B1.
 2,ATX,N JOBS.
C         BPEMEHA BBOdA B pACpOPT
 ,XTA,NBK. - AdPEC
 ,ASN,64-4. pACpOPTA
 ,ATI,5.
 ,FUN,70100B-1B.
 ,NTR,6. BPEMq
 ,A-X,STIME.
 ,A+X,=R0.5
 ,NTR,3.
 ,A+X,=I0.
 ,AAX,=77.
 5,UTC,CATALOG.
 ,AOX,6.
 5,UTC,CATALOG.
 ,ATX,6
 ,FUN,70100B+110B.
 ,NTR,6. BPEMq
 ,A-X,CTIME.
 ,A+X,=R0.5
 ,NTR,3 .
 ,A+X,=I0.
 ,AAX,=1777.
 ,ASN,64-6.
 5,UTC,CATALOG.
 ,AOX,6.
 5,UTC,CATALOG.
 ,ATX,6
 ,*76,Bzz.
 END PAC:,WTC,BNLAB. - HOMEP
 ,XTA,CNLAB-1. lAbOPATOPii
 ,ATX,TT BB. B COOb}EHiE
 3,VZM,E6. BCEgdA BBEdEHA
 ,XTA,COTKAZPV.
 ,UZ A,E7.
 ,XTA,.
 ,ATX,COTKAZPV.
 ,UJ,OTKAZ.
 E7:,BSS,
 ,XTA,OTK.
 ,UZA,E6. - HET OTKAzA
 OTKAZ :,XTA,CNLAB+3. - OTKA|
 ,ATX,TT BB+1. N B KATAlOgE
 ,ATX,TT BB+2. HE pE~ATATx
 ,ATX,TT BB+3.
 ,UJ,E5....
 E6:,BSS,
 ,XTA,NBK.COOb}EHiE O
 ,ARX,=1.KOHcE BBOdA
 ,ASN,64-42.zAdA~i
 ,ATX,P.
   ,UTC,CATALOG+NJOBS.
 ,XTA,.
 ,ASN,64-33.
 ,AOX,P.
 ,AUX,CP.
 ,AAX,MASK.
 ,AOX,C TT.
 ,ATX,TT BB+2.
 ,XTA,CTT+1.
 ,ATX,TT BB+1.
 ,XTA,CTT+2.
 ,ATX,TT BB+3.
 1,VTM,1-3.
 ,UJ,E4....
 E5:1,VTM,1-3.
 3,VZM,E4.HOPM. KOHEc
 2,VTM,OTKAz.HE BBEdEHA
 ,UJ,TRAN E.
 E4:,XTA,MER.
 ,UZA,E2.HET O{. pACp.
 2,VTM,TER1.
 4,VTM,2.
 ,UJ,TRAN E.
 E2:4,VZM,T NAME.
 2,VTM,TER2.O{ibKi BBOdA
 TRAN E:2,XTA,.pEPEpiCx
 ,ATX,TT BB+4.TEKCTA O{.
 2,XTA,1.
 ,ATX,TT BB+5.
 4,VTM,1.
 ,UJ,E3.
 T NAME:,BSS,.
 ,XTA,CNLAB+3. - HE pE~ATATx
 ,ATX,TT BB+4. O{ibKi
 ,ATX,TT BB+5.
 E3:,XTA,KZ.
 ,UIA,ZANIC1
 1,XTA,NAME+2.
 1,ATX,TT BB+8.
 15,ATX,. B MAgA3iH
 1,VLM,E3
 E33:,BSS,
 ,XTA,.
 ,ATX,TT BB+9.
 12,VTM,TT BB.
 13,VJM,TTPR
 ,XTA,KZ
 ,UIA,ZANIC
 ,XTA,NBK. - XAP-KA
 ,ASN,64-24. 3AdA~i
 ,ATX,P.
 ,ITA,4.
 ,AOX,P.
 15,ATX,.
 ,UJ,PRRET.
 ZANIC1:,BSS,
 1,XTA,NAME+2
 1,ATX,TTBB+8
 1,VLM,ZANIC1
 ,UJ,E33
 ZANIC:,XTA,NBK.
 4,MTJ,14.
 15,ATX,.
 PRRET:11,VZM,BEGIN.
 ,UJ,RETURN....
C        YCTAHOBKA pPizHAKA
C         BOzMOvHOCTi zApYCKA
C         zAdA~i B flpOTOKA
 Bzz:,BSS,.
 14,REL,*.
 ,WTC,A/ipd.
 ,XTA,{/FULL.
 ,WTC,A/ipd.
 ,ATX,SC/PLAN.
C --- pOdTAlKiBAHiE plAHiPOB}iKA
 ,WTC,AgYC
 2,VTM,
 ,WTC,ASTMT
 13,VTM,
 2,XTA,RDSC
 13,AOX,-1
 2,ATX,RDSC
 ,XTA,
 13,ATX,-1
C---- ObHYlEHiE CAT63 ====
 2,VTM,-31.
 ,XTA,.
 N:2,ATX,CAT63+31.
 2,VLM,N.
 ,REL,.
 ,ITA,32B.
 ,ATI,13.
 14,VTM,TAKCAT....
 14,MTJ,32B.
 ,MTJ,27B.
 2,IJ,.HA zAp KATAlOgA
C         KOHEc i COOb}.
C         OpEPATOPY
 TELL1:10,VJM,HA.
 TELL:4,VTM,4. - HET PECYPCOB
 13,VJM,TTPR
 TELL2:,XTA,.OTKAz OT
 ,FUN,74B.pEPEXBATA |74
 4,MTJ,14.
 ,ITA,4. - XAP-KA
 15,ATX,. 3AdA~i
C         BOzBPAT
 RETURN:12,VTM,1-7.
 VR:12,XTA,IR+6. - BOCCTAH.
 12,ATI,7. PEgiCTPy
 12,VLM,VR.
 ,WTC,RET.
 ,UJ,....
C      dEjCTBiq pO pEPEXBATY |74
 AB:4,VTM,4.
 , UJ,TELL1.
C         BOzBPAT zAXBA~EHOgO
 HA:,BSS,
 1,VJM,GIVCAT.
 T2:2,VTM,-31.
 ,MTJ,6.
 T1:2,XTA,CAT63+31.
 ,UTC,CATALOG.
 2,AOX,SC/FREE+31
 ,UTC,CATALOG.
 2,ATX,SC/FREE+31.
 ,XTA,.
 2,ATX,CAT63+31.
 2,VLM,T1....
        13,VJM,TAKCAT.
 10,UJ,....
C         zAXBAT PECYPCOB
 dAj PEC:,BSS,.zApP. zOHy ili         |lEMEHTA
 ,ATX,IW.
 ,*57,7.
 ,ATX,P.
 ,UZA,END1.
 ,XTA,IW.
 ,ASN,64+44.
 ,AAX,B1..........
 ,ATI,1.
 ,XTA,P.
 1,AAX,MAS/R.
 ,ATI,14
 1,XTA,MAS/R.
 ,ASN,64+24.
 ,AAX,=1000
 ,ARX,P.
 1,ASX,MAS/R.
 ,ATI,1.
 ,XTA,B48.
 14,ASN,64.
 1,AOX,CAT63.
 1,ATX,CAT63.
 END1:,XTA,P.
 13,UJ,........
C         zAHECEHiE ClYvEbHOj
C         iHf. B zOHY BBOdA
 WRZ:,ITA,6.
 ,ASN,64-24.
 ,AOX,KOD.
 2,VTM,LIST
 2,ATX,LEN/COD
 ,XTA,NZ+1
 ,AOX,REL NZ
 2,ATX,STAT
 ,XTA,REL NZ.
 ,ARX,B10.
 ,ATX,REL NZ.
 ,XTA,OB.
 ,AOX,NZ.
 ,*57,7.zApiCx zOHy
 2,XTA,. fiKC. KO
 1,UJ,...
C         zApiCx KATAlOgA
 TAKCAT:,BSS,.
 ,XTA,HOB.
 :9,VTM,
 ,*57,7.zApiCx KATAlOgA
 13,UJ,........
C         ~TEHiE KATAlOgA
 GIVCAT:,BSS,.
 ,XTA,DOB.
 :9,VTM,-1.
 ,*57,7.~TEH KATAlOgA
 ,UZA,OSH.
 1,UJ,.
 OSH:12,VTM,ER2...
 ,UJ,TELL....
C         BydA~A HA TT
 TTPR:,BSS,
 ,ITA,12
 ,AOX,MN*TL
 ,FUN,76B
 13,UJ,
C --- BybOPKA pAPAMETPOB
 PAR:,STX,OTK
     ,STX,DCOD
     ,STX,NLAB
     ,STX,AREAD
 9,UJ,
C         KOHCTAHTy i PAbO~iE
C         q~EjKi
 KZ:,BSS,1
 ,LOG,
 NBK:,BSS,1
 NZ:,BSS,2
 B18:,LOG,400 000
 KOD7:,LOG,7777 7777 7777 7777
 P:,BSS,1
 CAT63:,BSS,32.
 CP:,LOG,0160 3407 0160 3407
 MASK:,LOG,7777 7400 7777 7400
 C TT:,ISO,6H00(00)
 ,ISO,6H'1''1''1''1''1'B
 ,ISO,6H-'1''1''1''1''1'
 TT BB:,LOG,
 ,ISO,6H'1''1''1''1''1'B
 ,ISO,6H
 ,ISO,6H-'1''1''1''1''1'
 ,BSS,8
 MASK1:,LOG,17 7777
 C TT1:,ISO,6H~ - 00
 TT END:,ISO,6HgOTOBy
 ,ISO,6HX zAdA
 ,ISO,6H
 ,LOG,
 TT END B:,ISO,12HKOHEc BBOdA''
 ,LOG,
 B48:,OCT,4
 KOD:,LOG,2002
 K UJ:12,VTM,TT END B
 ,UJ,AB
 DOB:9,,.
 ,Z00,CATALOG.
 HOB:10,,.
 ,Z00,CATALOG.
 DEK:12,,.
 ,Z00,CATALOG.
 DZ2:13,,.
 ,Z00,CATALOG.
 MAS/R:8,Z10,.
 ,,3.
 :8,Z24,1000B.MY MISTAKE (bb)
 ,,37B
 IW:,BSS,1
 ER1:,ISO,6HpEPEp.
 ER2:,ISO,12HMl. BBOdA '41'
 ,LOG,
 OB:11,,NL.ClOBO
 ,,.dlq |K57
 REL NZ:,BSS,1
 B48/30:,OCT,7777 774
 B29/13:,LOG,37 7777 0000
 B10:,LOG,1000
 FL NAME:,BSS,1
 TTNAME:,LOG,
 ,ISO,12HHET pK NAME''
 ,LOG,
 B1:,LOG,1
 B37:,OCT,0001
 MASKX:,LOG,7760 0077 7777 7777
 TER1:,ISO,12HO{.pACp.-'1''1''1'
 TER2:,ISO,12HO{.BB.-'1''1''1''1''1'
 OTKAz:,ISO,12HHE BB.-'1''1''1''1''1'
 NAMEM:,ISO,6H*NAME
 RET:,BSS,1
 BNLAB:,BSS,1
 OTK:,BSS,1
 DCOD:,BSS,1
 NLAB:,BSS,1
 AREAD:,BSS,1
 CNLAB:,ISO,6HlBTA-'1'
       ,ISO,6H-PXl-'1'
 ,ISO,6HOHMY-'1'
 ,ISO,6H'1''1''1''1''1''1'
 ,BSS,4
 IR:,BSS,7
 STIME:,BSS,1
 CTIME:,BSS,1
 ,END,
 CBBIT:,NAME,
 B:12,BASE,*
 ,STI,10.ARRAY
 ,ATI,11.WORD
 14,VTM,1-48
 L:14,UTC,48-1
 10,XTA,2
 ,AAX,=1
 11,XTS,
 ,ASN,64-1
 15,AOX,
 11,ATX,
 14,VLM,L
      RET:,STX,
 ,NTR,6
 13,UJ,
 PABIT:,ENTRY,
 12,VTM,B
 ,STI,10
 ,ATI,11
 14,VTM,48
 11,XTA,
 ,ATX,R
 L1:,AAX,=1
 ,AOX,=:64
 14,UTM,-1
 14,UTC,
 10,ATX,2
 ,XTA,R
 ,ASN,64+1
 ,ATX,R
 14,V1M,L1
 ,UJ,RET
 R:,BSS,1
 ,END,
 CLESTA:,NAME,.~iCTKA CTAT.
 *LIST*:,PC,1024
 IW70:,LC,1
 NL:,P/P,(*LIST*)16
 LSTA:,EQU,527B
 8,BASE,*
 ,XTA,
 ,UTC,*LIST*
 ,ATX,
 ,*63,LSTA
 ,AEX,=77777
 ,ARX,=2
 ,ATI,9
 ,UTC,IW70
 ,XTA,
 ,AEX,=:001
 ,ATX,IW
 LOOP:,BSS,
 ,*70,IW
 ,XTA,IW
 ,ARX,=1
 ,ATX,IW
 9,VLM,LOOP
  14,VTM,TT
 ,ITA,14
 ,*50,76B
 13,UJ,
 IW:,LOG,
 TT:,ISO,H/**CTATiCTiKA O~i}EHA**''/
 ,END,
 COSYGOST:,NAME,
 BUF/MT:,SUBP,.
 FINJOB:,SUBP,.
 FINWORK:,SUBP,.
 *TABLE//:,SUBP,
 *LINE:,EQU,300B.
 ,ITS,14.
 14,VTM,1-14.
 L/SR:14,ITS,14.
 14,VLM,L/SR.CpACli PEgiCTPy
 ,NTR,3.
 15,WTC,-14.
 ,XTA,-1.INF
 ,ASN,64+20
 ,AAX,=17
 ,ATI,1.PEgiCTP B INF.
 1,VZM,NO MOD.bEz MOdifiKATOPA
 15,UTC,
 1,XTA,-14.
 ,ATI,1.
 NO MOD:15,WTC,-14.
 ,WTC,-1.
 1,UTM,.A HA~AlA TEKCTA COSYGOST.
 ,ITA,1.
 ,AEX,=77777.
 ,UZA,WRCATA.
   1,VZM,INIT.
 1,UTM,-1.
   1,VZM,CbPOC.
 ,XTA,=6HS
 ,ATX,*LINE.
 ,XTA,=6H
 8,VTM,-20.
 L/CS:8,ATX,*LINE+21.~iCTKA CTPOKi
 8,VLM,L/CS.
 1,XTA,1.
 ,ASN,64+40.
 ,ATI,8.~iClO pPOTqvEK
 8,VZM,PLUS.iX HET!
 8,UTM,-377B
 8,VZM,NPAG.HOByj liCT
 8,UTM,377B-1.
 L/ZS:8,VZM,SIMPL.KOH~ili pPOgOH
 9,VJM,BUFSTR.zApiCx pYCTOj CTPOKi
 8,UTM,-1.
 ,UJ,L/ZS.pPOgOH
 PLUS:,UTC,S/PL-S/1.
 NPAG:,XTA,S/1.
 ,ATX,*LINE.
 SIMPL:13,VTM,40
 12,VTM,*LINE.
 11,VTM,-40.
C     OCHOBHOj ciKl pEPEKOdiPOBKi
 L/TR:13,UTM,-8.
 1,XTA,1.
 13,ASN,64.
 15,ATX,
 ,AAX,=200
 ,STI,10.
 ,AAX,=177.
 ,ATI,8.
 13,VIM,*1.
 1,UTM,1.
 13,VTM,48.
 *1:10,VIM,COSY/S.CiMB. COSY
 8,UTM,-176B.
 8,VZM,EOS.BCq CTPOKA
 8,XTA,*TABLE//+176B.
 11,UTM,8.
 11,ASN,64.
 ,XTS,=377.
 11,ASN,64.
 ,AEX,=7777 7777 7777 7777
 12,AAX,.
 15,AOX,
 12,ATX,
 11,VIM,L/TR.
 11,VTM,-48.
 12,VLM,L/TR.ClEd. ClOBO
 COSY/S: ,BSS,
 11,UTM,8
 11,VIM,*5.
 12,UTM,1.
 11,VTM,-48.
 *5:8,VZM,L/TR.
 8,UTM,-1.
 ,UJ,COSY/S
 EOS:,BSS,.BCq CTPOKA
  9,VTM,EXIT.
 BUFSTR:,BSS,.bYffEPizAciq CTPOKi.
 9,MTJ,13.
 ,UJ,BUF/MT.
 CbPOC:13,VTM,EXIT.
 ,UJ,FINJOB.
 WRCATA:,UJ,FINWORK.
 INIT:,*64,.
 EXIT:14,VTM,13.
 15,XTA,.
 L/RR:14,STI,.
 14,UTM,-1
 14,VIM,L/RR.
 ,STI,14.
 ,NTR,6
 14,UJ,.
 S/1:,ISO,6H1
 S/PL:,ISO,6H+
 ,END,COSYGOST.
 DATE*STA:,NAME,
C-------------------------------------------
C PEzYlxTAT - dATA HA CYMMATOPE
C B BidE TPiHAdcATi 2/10-cifP
C PACpPEdElEHiE pOlEj : DD MM YY HH MM SS T
C                       24 44 44 24 44 44 4
C pPEvHEE COdEPviMOE CYMMATOPA - B MAgAziHE
C-------------------------------------------
C---------------------------------------
C
C DATE*STA iCpOlxzYETCq dlq
C pOlY~EHiq BPEMEHi B |TOM
C fOPMATE iz REAL LC *TS*
C---------------------------------------
 *TS*:,LC,1
 DATA*:,LC,2.
 A/I0:LC,BLOCK,INT.
 ,ITS,13
 13,BASE,*
 15,ATX,
 ,RTE,77B
 ,XTS,DATA*.
 ,APX,DM.
 ,XTS,DATA*+1.
 ,APX,DM+1.
 ,ASN,64+14.
 15,AOX,.
 15,ATX,
 ,UTC,*TS*
 ,XTA,
 ,NTR,
 ,A*X,MOD+2
 ,A*X,MOD+2
 14,VTM,-6
 LOOP1:,BSS,
 ,XTS,MOD
 14,ASN,64+47
 ,AAX,C1
 15,XTS,-2
 ,NTR,2
 15,WTC,
 ,A/X,MOD+1
 ,NTR,3
 ,A+X,INT
 15,ATX,
 14,VLM,LOOP1
 14,VTM,-6
 LOOP2:,ASN,64-4
 ,XTS,MOD
 14,ASN,64+35
 ,AAX,C1
 15,XTS,-3
 15,WTC,
 ,A*X,MOD+3
 ,YTA,64
 15,X-A,-3
 15,AOX,
 15,UTM,-2
 14,VLM,LOOP2
 ,AEX,INT
 ,ASN,64+4.
 15,AOX,
 15,XTR,
 15,WTC,
 ,UJ,
 DM:,GOST,6H3 0  0.
 ,GOST,6H  0000.
 C1:,BSS,
 MOD:,OCT,5340 7240 0000 0001
 ,REAL,6.
 ,REAL,10.
 ,LOG,4000 0000 0000 0006
 ,LOG,4000 0000 0000 0012
 ,END,DATE*STA
 DATIME:,NAME,
 *T*:,LC,14
 11,BASE,*
 ,ITA,13
 ,ATX,R13
 ,CALL,DATE*
 ,ATX,DATE
 ,AUX,MASK1
 ,ATX,R
 ,XTA,MASK12
 ,UTC,*T*+8
 ,AAX,
 ,AOX,R
 ,UTC,*T*+8
 ,ATX,
 ,XTA,DATE
 ,ASN,64-14
 ,AUX,MASK2
 ,ATX,R
 ,XTA,MASK22
 ,UTC,*T*+9
 ,AAX,
 ,AOX,R
 ,UTC,*T*+9
 ,ATX,
 ,XTA,DATE
 ,ASN,64-22
 ,AUX,MASK1
 ,ATX,R
 ,XTA,MASK12
 ,UTC,*T*+10
 ,AAX,
 ,AOX,R
 ,UTC,*T*+10
 ,ATX,
 ,XTA,DATE
 ,ASN,64-36
 ,AUX,MASK2
 ,ATX,R
 ,XTA,MASK22
 ,UTC,*T*+11
 ,AAX,
 ,AOX,R
 ,UTC,*T*+11
 ,ATX,
 ,STI,
 ,WTC,R13
 ,UJ,
 MASK1:,OCT,0060740003607400
 MASK2:,OCT,0360740000000000
 MASK12:,OCT,7717037774170377
 MASK22:,OCT,7417037777777777
 R13:,BSS,1
 R:,BSS,1
 DATE:,BSS,1
 ,END,
 DEBUG7:,NAME,
 AYCOB:,EQU,502B
 Aipd :,EQU,760B
 OPERANDS:,SUBP,
 *0:,BLOCK,
 ,CONT,XNF,XNFM,(2),XNW
 ,CONT,(1),XNCM,(2),{/FULL(2)
 ,CONT,{/pYCK(2),{/ClY(29)
 ,CONT,OUTJOBSC,(7),FLERBUZ
 ,CONT,EXTSC(2)
 ,CONT,pAPTizAH,blOKAcpY
  ,CONT,MOvHOKA~,{Kp
  ,CONT,SCDEBUG
C--------
 NvdY:,EQU,60B
 NLMAT:,EQU,NvdY-1
C--------
 NSHI:,EQU,20B
 *STR*: LC,BLOCK,NTER,STR(13)
 *ERRDEB*:LC,BLOCK,ERR
 NJ  :,EQU,NSHI-1
C--------
 BITS:,EQU,677B
C--------
 ASC71:,EQU,561B
 AipK :,EQU,761B
 ASCCLTA:,EQU,520B
 ALBUF  :,EQU,435B
 TABNT  :,EQU,1700B
 *0:,BLOCK,SCALCLTA
 ,CONT,(4),SCSTOP
C--------
C
C*****   iCpOlxzYEMAq B ipz pAMqTx
C
 S33:,EQU,3
 S27:,EQU,5
 S34:,EQU,26B
 S35:,EQU,27B
 TMATH:,EQU,30B
 REGSCAL:,EQU,100B
  iP/34:,EQU,563B
 PEg34:,EQU,iP/34
 READ :,EQU,iP/34
 fREAD:,EQU,iP/34
 WRIT :,EQU,iP/34
 SCJOTl:,EQU,564B
 iP/35:,EQU,iP/34
 *635:B,BLOCK,D/SW
 ,CONT,R/R,W/W,O/A/
 ,CONT,IDENTI/(2),ISUB/(2)
 Nl ipz:,EQU,30B
 Nlipz/:,EQU,=:0000 30
 Aipz1:,P*P,(Nlipz)1024
 Aipz :,EQU,Aipz1+3
 *0:,BLOCK,SC71,REDY71,SCTER
 ,CONT,SCAL67,SC{Ag,SCB71
 *1:,BLOCK,B,C,PP,R,NT,W,N,CA,W1,W2
 ,CONT,AI,M,T
 AI:I,BLOCK,S,AS.
 M1:,EQU,C
 *0:,BLOCK,gYC,RDSCAL
C --   H A ~ A l O
C
 14,VTM,1-13
 :14,ITS,13
 14,VLM,*
 ,ITS,
 B,BASE,*
C
C.........   pOiCK YK pO TAblicE
 ,XTA,STR
 ,ATX,WS
 14,VTM,1-2
 AN0:W,VTM,
 W1,VTM,CO CA.
 AN1:W1,XTA,.
 ,UIA,AN2
 14,VLM,AN7
 T,VTM,2
 ,UJ,RONE
 AN2:,ATX,WS1.
 ,AEX,WS.
 ,AAX,=6H'377''377''377'''''''
 ,UZA,AN3
 W,UTM,1.
 ,XTA,WS1.
 ,ASN,64-24.
 ,U1A,AN2.2-q pOlOB.
 W1,VLM,AN1.ClEd.ClOBO
 AN3:,BSS,
 W,UJ,CC SW
 AN7:W,VTM,
 W1,VTM,COCA1
 ,UJ,AN1
 CC SW:,BSS,.
C------------------
  :T,VTM,zACl.zAp
  ,UJ,NJ C ipz
 :T,VTM,zACl
 ,UJ,NJ C ipz
 :W,VTM,OCT pO AdP.OCA
   ,UJ,OTlAdKA
 :W,VTM,OCT zAp.OzA
   ,UJ,OTlAdKA
 :W,VTM,OCT ~TEH.O~T
   ,UJ,OTlAdKA
 :W,VTM,OPEN JOB.idi
   ,UJ,OTlAdKA
    :T,VTM,PEgiCTPy.PEg
   ,UJ,NJ C ipz
 :W,VTM,OCT WORD.Mq~
   ,UJ,OTlAdKA
 :W,VTM,KOCB ~T.MqK
  ,UJ,OTlAdKA
 :W,VTM,fiz ~T.fq~
  ,UJ,OTlAdKA
  :T,VTM,{Agi.{Ag
  ,UJ,NJ C ipz
 :W,VTM,DEC ~iC.dEC
 ,UJ,OTlAdKA
C------------------
C
C-----   pPiKAz : d E C
C
 DEC~iC:,BSS,
 ,XTA,=:4
 ,AEX,
 W2,*53,R/R
 ,UJ,OCTWORD
C
C-----   p/p pPiKAzOB OTlAd~iKA
C
   OTlAdKA:,BSS,
 T,VJM,NJ C ipz
 ,XTA,STR
  ,ASN,64-32
  ,UZA,BADR
   ,AAX,=:76
  ,AEX,=:14
  ,U1A,IDENOTL
   BADR:,BSS,
  T,VTM,8
  R,VJM,OPERANDS
  ,ATX,WS
 ,XTA,ERR
 W,UZA,
 ,ATI,T
 ,UJ,RONE
 NJ C ipz:W1,VTM,1-NSHI
C pOiCK  HA{ {ifP-KAHAl
 ,*65,AipK
 ,ATI,M1
 LOOP:,BSS,
 M1,UTC,
 W1,*65,NJ
 ,ATX,WS2
 ,AAX,=20 0000.B17
 ,UZA,LOOP/
 ,XTA,WS2
 ,ASN,64+36
 ,AEX,NTER
 ,AAX,=17
   ,UZA,HA{KAH
 LOOP/:,BSS,
  W1,VLM,LOOP
 T,VTM,1
 ,UJ,RONE
   HA{KAH:,BSS,
 W1,UTM,NLMAT
 W1,*65,BITS
 ,ATX,BIT
 ,ITA,T
 ,ATX,WS2
 T,VJM,dAj ipz
 ,*65,Aipd
 ,ATI,M1
 M1,*65,FLERBUZ
 ,AAX,BIT
  ,U1A,SECOND
  W2,*65,SCJOTl
  ,U1A,SECOND
 ,WTC,WS2
 ,UJ,
C.....   pEPEpiCx ipz HA liCT MT
 dAj ipz:R,VTM,B48
 ,UJ,dAj/HA
 dAjipz B:R,VTM,=:6
 ,UJ,dAj/HA
 HA ipz:R,VTM,
 T,VTM,EXIT
 dAj/HA:,BSS,
 ,ITA,W1
 ,ASN,64-9
 ,AOX,=50
 R,AOX,
 ,AOX,Nlipz/
 ,FUN,212B
 ,ATI,W2
 R,XTA,
 ,AAX,=:2
 T,UZA,
 W2,VTM,A ipz
 T,UJ,
C
C-----   pPiKAz : O C A
C
   OCTpOAdP:,BSS,
  ,XTA,WS
  W2,*52,PEg34
  ,XTA,B48
  ,UJ,pPiOT
C
C-----   pPiKAz : O z A
C
   OCTzAp:,BSS,
  ,XTA,WS
  W2,*52,iP/35
  ,XTA,=:1
  ,UJ,pPiOT
C
C-----   pPiKAz : O ~ T
C
   OCT~TEH:,BSS,
  ,XTA,WS
  W2,*52,iP/35
  ,XTA,=:2
  ,UJ,pPiOT
C
C-----   pPiKAz : i d i
C
   OPENJOB:,BSS,
  ,UZA,MAT
 W2,*65,S27
  ,AAX,=14
  ,U1A,plOX
  MAT:,BSS,
 ,*65,ASCCLTA
 ,ATI,M1
 M1,*65,SCSTOP
 ,AAX,BIT
 ,UZA,plOX
 M1,*65,SCSTOP
 ,AEX,BIT
 M1,*52,SCSTOP
 ,XTA,WS
 ,UZA,TOlKHEM
  ,AEX,FULWOR
  ,UZA,idid
   ,XTA,WS
 W2,*52,S33
 ,XTA,
 W2,*52,S27
 ,UJ,OTKPOEM
 TOlKHEM:,BSS,
  W2,*65,REGSCAL
 ,AAX,=10 00000
 ,UZA,CHqTxK
 W2,*65,S35
 ,ASN,64-15
 W2,*52,S35
 CHqTxK:W2,*65,S34
 ,AAX,=77777
 ,UZA,YCTfl
 W2,*65,S34
 ,ASN,64-15
 W2,*52,S34
 YCTfl:,BSS,
 ,*65,ASC71
 ,ATI,M1
 M1,*65,SCAL67
 ,AOX,BIT
 M1,*52,SCAL67
 OTKPOEM:,BSS,
 ,*65,ASC71
 ,ATI,M1
 M1,*65,SC{Ag
 ,AAX,BIT
 ,UZA,GO
 ,*65,ASCCLTA
 ,ATI,M1
 M1,*65,SCSTOP
 ,AAX,BIT
 ,UZA,HA ipz
 M1,*65,SCSTOP
 ,AEX,BIT
 M1,*52,SCSTOP
  GO:,BSS,
 ,XTA,BIT
   ,*76,OTKP
 ,UJ,HA ipz
  idid:,BSS,
 ,XTA,=:01
 ,AEX,
 W2,*53,R/R
  ,XTA,BIT
  ,*76,OTKP
  ,XTA,WS
    W2,*52,READ
    ,XTA,=:002
  ,AEX,
  W2,*53,SCJOTl
 ,*65,Aipd
 ,ATI,M1
  ,XTA,BIT
  ,AEX,
 M1,*53,SCDEBUG
  ,UJ,HA ipz
   OTKP:,BSS,
 ,WTC,AYCOB
 ,AOX,RDSCAL
 ,WTC,AYCOB
   ,ATX,RDSCAL
   ,MTJ,27B
   2,IJ,
C
C-----   pPiKAz : P E g
C
   PEgiCTPy:,BSS,
 AS,VTM,STR
   AS,XTA,
   ,AAX,=0000 0000 0017 7777
  ,UZA,SUMIR
  ,XTA,=:004
  ,UJ,pPiOT
  SUMIR:,BSS,
  ,XTA,=:01
  pPiOT:,BSS,
  ,AEX,
  W2,*53,SCJOTl
 ,*65,Aipd
 ,ATI,M1
  ,XTA,BIT
  ,AEX,
 M1,*53,SCDEBUG
 ,*65,ASCCLTA
 ,ATI,M1
 M1,*65,SCSTOP
 ,AAX,BIT
 ,*76,OTKP
  ,UJ,HA ipz
C
C-----   pPiKAz : M q K
C
  KOCB~T:,BSS,
  ,XTA,=0000 0000 0400 0000
 ,AEX,
 W2,*53,R/R
C
C-----   pPiKAz : M q ~
C
   OCT WORD:,BSS,
  ,XTA,WS
  ,AEX,FULWOR
  ,UZA,NO AD
 R,VJM,pPOB ~l
  NO AD:,BSS,
    ,XTA,WS
  W2,*52,READ
  ,XTA,=:002
  ,UJ,pPiOT
 pPOB ~l:,XTA,WS
 ,ASN,64+10
 ,ATI,T
 T,UTC,
 W2,*65,TMATH
 ,ASN,64+30
  R,U1A,
  plOX:R,VTM,.OCBOb-E
  T,VJM,dAj/HA.ipz
 T,VTM,2
 ,UJ,RONE
C
C-----   pPiKAz : { A g
C
  {Agi :,BSS,
 ,*65,ASC71
 ,ATI,M1
 M1,*65,SC{Ag
 ,AOX,BIT
 M1,*52,SC{Ag
 ,XTA,=4 00000
 ,AEX,
 W2,*53,REGSCAL
  ,UJ,TOlKHEM
C
C-----   pPiKAz : f q ~
C
  fiz~T:,BSS,
  ,XTA,WS
  W2,*52,fREAD
  ,XTA,=:001
  ,UJ,pPiOT
C
C-----   pPiKAz : z A p
C
 zACl:,BSS,
  T,VTM,8
  R,VJM,OPERANDS
 ,ATX,WS
 ,XTA,ERR
 ,UZA,WW
 ,ATI,T
 ,UJ,RONE
 WW:,XTA,WS
 W2,*52,W/W
 zAp~A:,ITA,T
  ,ATX,WS
 R,VJM,pPOB ~l
  zAp~A1:,BSS,
  ,XTA,WS
  W2,*52,WRIT
  ,XTA,=:0004
  ,UJ,pPiOT
   IDENOTL:,BSS,
 ,ITA,W1
 ,ATX,WNW
 R,VTM,
 W2,*65,O/A/
 ,ATX,O/A
 AS,VTM,STR
 ,XTA,
 R,ATX,IDENTI
 R,ATX,IDENTI+1
 R,ATX,ISUB
 R,ATX,ISUB+1
  AS,XTA,
  ,ASN,64-32
 SIMVOL:,ATX,WS
 ,AAX,=:776
 ,AEX,=:130
 ,UZA,NEXT ADR
 ,AEX,=:130
 ,ASN,64+40
 R,AOX,ISUB
 R,ATX,ISUB
 ,AAX,=:776
 ,UZA,TYdA vE
 R,UTM,1
 TYdA vE:,BSS,
 R,XTA,ISUB
 ,ASN,64-8
 R,ATX,ISUB
 AFTERTOO:,BSS,
 ,XTA,WS
 ,ASN,64-8
 ,U1A,SIMVOL
 AS,XTA,
  ,AAX,=377
 ,UZA,KOH TEKC
  AS,UTM,1
 AS,XTA,
 ,UZA,KOH TEKC
 ,UJ,SIMVOL
 NEXT ADR:,BSS,
 14,VTM,AFTERTOO
 R,VTM,
 FORM ID:,BSS,
 R,XTA,ISUB
 R,ATX,IDENTI
 R,XTA,ISUB+1
 R,ATX,IDENTI+1
 ,XTA,
 R,ATX,ISUB
 R,ATX,ISUB+1
 14,UJ,
 KOH TEKC:,BSS,
 R,VTM,
 R,XTA,IDENTI
 ,U1A,bylO  dBA
 14,VJM,FORM ID
  bylO dBA:,BSS,
C.....   HOPMAlizAciq BlEBO
 R,VTM,-3
 14,VTM,
 bd 1:14,XTA,IDENTI
 ,UZA,bd 2
 ,AAX,=:776
 ,U1A,bd 2
 14,XTA,IDENTI
 ,ASN,64-8
 14,ATX,IDENTI
 ,UJ,bd 1
 bd 2:14,UTM,1
 R,VLM,bd 1
  R,XTA,ISUB
  ,UZA,FINISH
  ,AAX,=:776
  ,AOX,=:002
  ,AEX,=:162
  ,UZA,DECIM
  R,XTA,ISUB
  ,AAX,=:76
  ,AEX,=:14
  ,UZA,MAYBEOCT
  FINISH:,BSS,
 R,VTM,-4
 W2,MTJ,W1
 FIN:R,XTA,ISUB+1
 W1,*52,O/A/
 W1,UTM,1
 R,VLM,FIN
  ,XTA,FULWOR
  ,ATX,WS
 ,WTC,WNW
 W1,VTM,
 W,UJ,.
  O{ibKA:,BSS,
  ,XTA,
  R,ATX,ISUB
 T,VTM,2
  ,UJ,RONE
  SBM:,OCT,0000 0000 0000 0102
  MAYBEOCT:,BSS,
  R,XTA,ISUB
  ,ATX,WS
  SIMB:,BSS,
  ,AAX,=377
  ,AEX,SBM
  ,UZA,OCTA
  ,XTA,WS
  ,ASN,64+8
  ,ATX,WS
  ,U1A,SIMB
  DECIM:,BSS,
   R,XTA,ISUB
  ,AAX,=377
 14,VTM,-5.
  ,U1A,pO~ETyPE
  R,XTA,ISUB
  ,ASN,64+8
  R,ATX,ISUB
  ,UJ,DECIM
  pO~ETyPE:,BSS,
  R,XTA,ISUB
  ,ATX,WS
  ~iClO li:,BSS,
  ,AAX,=377
  ,UZA,pO4
  ,AEX,=60
  ,AAX,=370
  ,UZA,NO
  ,XTA,WS
  ,AAX,=377
  ,AOX,=1
  ,AEX,=71
  ,U1A,O{ibKA
  NO:,BSS,
  ,XTA,WS
  ,ASN,64+8
  ,ATX,WS
 14,VLM,~iClO li
  pO4:,BSS,
  R,XTA,ISUB
  ,APX,=0360 7417 0360 7417
  R,ATX,ISUB
 14,VTM,1-6
  TO dEC:,BSS,
  R,XTA,ISUB
  ,ASN,64-4
  ,YTA,
 ,ARX,O/A
 ,ATX,O/A
  R,XTA,ISUB
     ,ASN,64-4
  R,ATX,ISUB
 14,VZM,FINISH
 ,XTA,O/A
  ,ASN,64-3
  ,ATX,WS
 ,XTA,O/A
  ,ASN,64-1
  ,ARX,WS
 ,ATX,O/A
 14,VLM,TO dEC
  ,UJ,FINISH
  OCTA:,BSS,
 14,VTM,1-5
  ,XTA,WS
 pPOBEPKA:,ASN,64+8
  R,ATX,ISUB
  ,AAX,=377
  ,UZA,pEPEBOd
  ,AEX,=60
  ,AAX,=370
  ,U1A,O{ibKA
  R,XTA,ISUB
 14,VLM,pPOBEPKA
  pEPEBOd:,BSS,
  ,XTA,
  R,ATX,ISUB
  ,XTA,WS
  ,ASN,64+8
  ,ATX,WS
  ,APX,=0160340701603407
  ,ASN,64+30
 ,ATX,O/A
  ,UJ,FINISH
 EXIT:T,VTM,
 RONE:,BSS,
 ,ITA,T
 ,ATX,ERR
 14,VTM,13
 ,STI,
 REG:14,STI,
 14,UTM,-1
 14,VIM,REG
 13,UJ,
  SECOND:R,VTM,.OCBOb-E
  T,VJM,dAj/HA.ipz
 T,VTM,3
 ,UJ,RONE
  FUL WOR:,LOG,7777 7777 7777 7777.
C-----
 COCA1:,BSS,
 ,ISO,3H/WA
 ,CONT,3H/WA
 ,CONT,3H/SA
 ,CONT,3H/SW
 ,CONT,3H/SR
 ,CONT,3H/GO
 ,CONT,3H/RR
 ,CONT,3H/RA
 ,CONT,3H/RC
 ,CONT,3H/RW
 ,CONT,3H/SS
 ,CONT,3H/RD
 ,OCT,
 CO CA:,BSS,.
 ,ISO,3HzAp
 ,CONT,3HzAp
   ,CONT,3HOCA.OCTAHOB pO N KOMAHdy
   ,CONT,3HOzA.OCTAHOB pO zApiCi
   ,CONT,3HO~T.OCTAHOB pO ~TEHi`
    ,CONT,3Hidi
   ,CONT,3HPEg
  ,CONT,3HMq~
  ,CONT,3HMqK
  ,CONT,3Hfq~
  ,CONT,3H{Ag
 ,CONT,3HdEC
 ,OCT,.
 WS1:,BSS,1
 WS2:,BSS,1
 WS :,BSS,1
 BIT:,BSS,1
 B48:,OCT,4
 WNW:,BSS,1
 O/A:,BSS,1
 IDENTI:,BSS,2
 ISUB  :,BSS,2
 ,END,.
 DELJOB:,NAME,.CAXAPOB
 MN*TL:,EQU,1067B
 *SCALS*:LC,BLOCK,INF/BA,N/LAB(528)
 *PAGE*:PC,BLOCK,
 ,CONT,BUF(1024)
 ,CONT,CAT(1024)
 STAT:,EQU,0
 SC/FREE:,EQU,1720B.
 NJOBS  :,EQU,1772B.
 NP/BUF:,P/P,(BUF)16
 *9:,BLOCK,
 ,CONT,AW
 ,CONT,T
 ,CONT,B
 ,CONT,A
 *PAGES:,EQU,*PAGE*
 *C:,BSS,.HA~AlO
 AW,VTM,BEGBATCH.
C----------------------------------------
 '   HEKAq Ob}Aq ~ACTx dlq BCEX BXOdOB '
C----------------------------------------
 B,BASE,*C
 REACATAL:,BSS,.............
 ,XTA,RCAT.~TEHiE
 ,*57,7.KAT. BBOdA
           , UZA ,HET OB  ............
 AW,UJ,.HA OCHOBHY`          ~ACTx
 HET OB:,BSS,.OTCYTCTB.OB
 14,VTM,MlBB.
 ,ITA,14.
 ,FUN,76B.
 ,FUN,211B.pOdzAKPOEMCq
 ,UJ,REACATAL
C----------------------------------------
 '    KOHEc PAbOTy C OblACTx` BBOdA    '
C----------------------------------------
 ENDBATCH:,BSS,.
 ,UTC,CAT.
 ,XTA,NJOBS.
 14,VTM,-31
  ,UZA,CS/FREE
 ,ARX,=77
 ,AAX,=77
 ,UTC,CAT.
 ,ATX,NJOBS.
 CS/FREE:14,UTC,SCAL/FR.
 ,XTA,31.
 14,UTC,CAT.
      ,AOX,SC/FREE+31.
 14,UTC,CAT.
      ,ATX,SC/FREE+31.
 14,VLM,CS/FREE.
 ,XTA,WCAT
 ,*57,7.zp.KAT."OB"
 ,XTA,ERR.
 13,UIA,.
 ,XTA,INF/BA.
 ,ASN,64-42.
 ,AUX,=6H'''''7''7'''''
 ,AOX,fiCK.
 ,ATX,fiCK.
 14,VTM,fiCK.
 TERM:,BSS,
 ,ITA,14.
 ,AOX,MN*TL.
 ,FUN,76B.
 ,*62,.
C----------------------------------------
C   pOdgOTOBKA BBOdA iz  "OB"
C----------------------------------------
 BEGBATCH:,BSS,
 ,XTA,INF/BA
 ,ATX,INF BA
 ,ASN,64-4
 ,ATI,13
 ,XTA,.
 13,UTC,CAT-16
 ,ARX,
 ,U1A,DIAGN.HET fAjlA
 ,ATX,XAP1.
 ,AAX,B46
 ,UIA,CBOpAC*.pACpOPTA YvE
C                          .CBObOdHy
C---  pOdgOTOBKA {KAly CBObOdHyX |l-TOB KAT-gA --
 P/FREE:,XTA,INF BA.
 ,ARX,=77
 ,AAX,=77
 14,VJM,FR/PEC.OCBObOvdEHiE
C                          .PECYPCA
 13,UTC,CAT-16.
 ,XTA,STAT
 ,ASN,64+30
 ,AAX,=77
 ,ATX,INF BA.
 ,ASN,64-4
 ,ATI,13.
 13,VIM,P/FREE.
CBObOdHyE |lEMEHTy KATAlOgA zAfiKCiPOBAHy
 ,UJ,CBOpAC.
 CBOpAC*:,BSS,.
 ,XTA,INF/BA.
 ,ASN,64-42.
 ,AUX,=6H'''''7''7'''''
 ,AOX,TREPI.
 ,ATX,TREPI.
 14,VTM,TREPI.
 ,UJ,TERM
 CBOpAC:,XTA,INF/BA
 ,ASN,64-4
 ,ATI,13
 13,UTM,CAT-16.
 13,XTA,STAT
 ,AAX,=77 77 000 000.NBB,NlAb
 ,ATX,REN Z.dlq KOHTPOlq
 13,XTA,STAT
 ,AOX,B46.OCB.pACp.
 ,AOX,B48
 13,ATX,STAT.Bzqli zAdA~Y
 14,VTM,-2
 W/NAM:13,XTA,2
 14,ATX,T/NAM+2
 13,UTM,1
 14,VLM,W/NAM.
 ,XTA,XAP1
 ,UJ,READ/ZON.
C----------------------------------------
C   fiKCAciq PECYPCOB zAdA~i pO "OB"
C----------------------------------------
 FR/PEC:,BSS,.OCB. |l-TOB KAT.
 ,XTS,MAS/R
 ,UJ,FR/SCA.
 :,XTS,MAS/R+1
 ,UJ,FR/SCA.
 FR/SCA:,STX,MAS/W
 ,ATX,P.
 ,AAX,MAS/W.
 ,ATI,AW.
 ,XTA,MAS/W.
 ,ASN,64+24.
 ,AAX,=1000.
 ,ARX,P
 ,ASX,MAS/W.
 ,ATI,T.
 ,XTA,B48
 AW,ASN,64
 T,UTC,SCAL/FR
 ,AOX,.
 T,UTC,SCAL/FR.
 ,ATX,.
 14,UJ,.biT B {KAlY          zApiCAH
C----------------------------------------
C  TO,~TO PAHx{E HAzyBAlOCx "NEWREAD"
C----------------------------------------
 LOZO:,BSS,.ciKl pO zOHAM
 ,UTC,BUF
 ,XTA,STAT.pOClEdH.zOHA
 READ/ZON:,BSS,.~TEHiE iz "OB"
 ,AAX,C777. HOMEPA
 ,UZA,LASTZON.-dA,HOPMA
 ,AOX,INF0.ClEd.zOHy
 ,ATX,INF
 ,*57,7.
 ,XTA,RENZ.
 ,UTC,BUF
 ,AEX,STAT
 ,AAX,MSK CHZ.
 ,UIA,BADCASE.OHA-HE HA{A
 ,XTA,RENZ.
 ,ARX,=1000
 ,ATX,RENZ.
 ,XTA,INF.
 ,AAX,C777
 14,VJM,FR/PEC+1.
 ,UJ,LOZO.
 LASTZON:,BSS,.@
C......   HOPMAlxHyj KOHEc BybOPKi
C  pPizHAK: CYM = 0
 BADCASE:,BSS,.
C......   ObHAPYvEHA '~YvAq zOHA'
C         pPizHAK |TOgO : CYM.NE.0
 ,ATX,ERR.
 13,VJM,ENDBATCH.
 DIAGN:,BSS,
 ,XTA,INF/BA.
 ,ASN,64-42.
 ,AUX,=6H'''''7''7'''''
 ,AOX,TYvE.
 ,ATX,TYvE.
 14,VTM,TYvE.
 ,UJ,TERM
 RCAT:9,,.
 ,Z00,CAT.
 WCAT:10,,.
 ,Z00,CAT.
 MAS/R:8,Z10,.
 ,,3.
 8,24,1000B.
 ,,37B
 INF0:11,010,NP/BUF.
 ,,.
C......   KOHCTAHTy
 MSKCHZ:,LOG,77 77 037 000.NBB,NlAb,KzOH
 C777:,LOG,777.
 TYvE:,ISO,12Hf-00 OTKAz'41'''
 MlBB:,ISO,12HMl BBOdA'41'''''''
 TREPI:,ISO,12Hf-00 YvE iCK
 ,LOG,.
 fiCK:,ISO,12Hf-00 iCKl`~
 T/NAM:,BSS,3
 ,OCT,.
 B48:,OCT,4
 B47:,OCT,2
 B46:,OCT,1
C......   PAbO~iE q~EjKi
 INF BA  :,BSS,1.
 XAP1    :,BSS,1
 INF     :,BSS,1
 RENZ    :,BSS,1
 SCAL/FR :,BSS,32.
 MAS/W:,BSS,1.
 P    :,BSS,1.
 ERR:,BSS,1.
 ,END,.
  DISIDENT:,NAME,
C*
C*   pOiCK B TPp diCpET~EPA
C*   zAdAHHOgO HA CYMMATOPE
C*   B KOdE  TEXT  iMEHi
C*   diCpET~EPCKOgO ObxEKTA.
C*   PEzYlxTAT HA CYMMATOPE :
C*   fiz.AdPEC ili 0.
C*   iCpOlxzYETCq 37 liCT.
C*
   12,BASE,*
  ,ATX,NAME.
  11,VTM,-1
  ,*63,523B
  ,ATI,14.DISPBASE
  14,*63,1
  ,AOX,=0014 3700 0000 0036
  ,ATX,INF
  *1:10,VTM,76000B
  ,*70,INF
  *2:10,XTA,
  ,AEX,NAME
  ,UZA,IS
  10,UTM,2
  10,VIM,*2
  ,XTA,INF
  ,ARX,=1
  ,ATX,INF
  11,VLM,*1
  ,XTA,
  13,UJ,
  IS:10,XTA,1
  13,UJ,
  NAME:,BSS,1
  INF :,BSS,1
  ,END,
 E10IDU:,NAME,TAblicA CiMBOlOB 01/82 lOpATKO B.b.
C
C   TAblicA CiMBOlOB dlq pEPEKOdiPOBKi
C       EBCDIC(EC-1010) - ISO(dYbHA)
C
 ,ISO,6H''''''''''''.     00-03
 ,ISO,6H''''''''''''.     04-07
 ,ISO,6H''''''''''''.     08-0B
 ,ISO,6H''''''''''''.     0C-0F
 ,ISO,6H''''''''''''.     10-13
 ,ISO,6H''''''''''''.     14-17
 ,ISO,6H''''''''''''.     18-1B
 ,ISO,6H''''''''''''.     1C-1F
 ,ISO,6H''''''''''''.     20-23
 ,ISO,6H''''''''''''.     24-27
 ,ISO,6H''''''''''''.     28-2B
 ,ISO,6H''''''''''''.     2C-2F
 ,ISO,6H''''''''''''.     30-33
 ,ISO,6H''''''''''''.     34-37
 ,ISO,6H''''''''''''.     38-3B
 ,ISO,6H''''''''''''.     3C-3F
 ,ISO,6H'' ''''''''.      40-43
 ,ISO,6H''''''''''''.     44-47
 ,ISO,6H''''''[.''.       48-4B
 ,ISO,6H''<(+!''.         4C-4F
 ,ISO,6H'''046'''''''''.  50-53
 ,ISO,6H''''''''''''.     54-57
 ,ISO,6H'''''']'044'''.   58-5B
 ,ISO,6H''*);^''.         5C-5F
 ,ISO,6H''-/''''''.       60-63
 ,ISO,6H''''''''''''.     64-67
 ,ISO,6H''''''|,''.       68-6B
 ,ISO,6H''%_>''''.        6C-6F
 ,ISO,6H''''''''''''.     70-73
 ,ISO,6H''''''''''''.     74-77
 ,ISO,6H'''''':#''.       78-7B
 ,ISO,6H''@'047'="''.     7C-7F
 ,ISO,6H''''''''''''.     80-83
 ,ISO,6H''''''fg''.       84-87
 ,ISO,6H''Xi''''''.       88-8B
 ,ISO,6H''''''''''''.     8C-8F
 ,ISO,6H''''jKl''.        90-93
 ,ISO,6H''MHOp''.         94-97
 ,ISO,6H''qP''''''.       98-9B
 ,ISO,6H''''''''''''.     9C-9F
 ,ISO,6H''''~CT''''.      A0-A3
 ,ISO,6H''YvBx''.         A4-A7
 ,ISO,6H''yz''''''.       A8-AB
 ,ISO,6H''''''''''''.     AC-AF
 ,ISO,6H''''''''''''.     B0-B3
 ,ISO,6H''''''''''''.     B4-B7
 ,ISO,6H''''''''''''.     B8-BB
 ,ISO,6H''''''''''''.     BC-BF
 ,ISO,6H''{ABC''.         C0-C3
 ,ISO,6H''DEFG''.         C4-C7
 ,ISO,6H''HI`A''.         C8-CB
 ,ISO,6H''bcdE''.         CC-CF
 ,ISO,6H''}JKL''.         D0-D3
 ,ISO,6H''MNOP''.         D4-D7
 ,ISO,6H''QR''''''.       D8-DB
 ,ISO,6H''''''''''''.     DC-DF
 ,ISO,6H'''077'''ST''.    E0-E3
 ,ISO,6H''UVWX''.         E4-E7
 ,ISO,6H''YZ''''''.       E8-EB
 ,ISO,6H''''''''''''.     EC-EF
 ,ISO,6H''0123''.         F0-F3
 ,ISO,6H''4567''.         F4-F7
 ,ISO,6H''89''''''.       F8-FB
 ,ISO,6H'''''''''177'''.  FC-FF
 ,END,
 ELINE:,NAME,
C
C************************************
C*   S C R E E N    E D I T O R     *
C*              AUTOR               *
C*             M.POPOV              *
C*  MADE IN USSR, J.I.N.R., DUBNA   *
C************************************
C
C*** THE MAIN USER'S BLOCK DEFINITION
C
 *0:,BLOCK,DISCOM
 ,CONT,(20)
 ,CONT,CURSOR
 ,CONT,STRUP,SCREEN(16),STRDWN
 ,CONT,STRING(14)
 ,CONT,WACNT,CNTINP,CNTOUT
 ,CONT,DRVWORD
 ,CONT,IOWORD
 ,CONT,CURWORD
 ,CONT,SWINP
 ,CONT,OUTFDB(0)
 ,CONT,INFO
 ,CONT,QWARTO
 ,CONT,RCNTO
 ,CONT,MNO
 ,CONT,MAXO
 ,CONT,PGPNTO
 ,CONT,OUT1
 ,CONT,OUT2
 ,CONT,INPFDB(0)
 ,CONT,INFI
 ,CONT,QWARTI
 ,CONT,RCNTI
 ,CONT,MNI
 ,CONT,MAXI
 ,CONT,PGPNTI
 ,CONT,INP1
 ,CONT,INP2
 ,CONT,SAVINP(8)
 ,CONT,TEMFDB(0)
 ,CONT,INFT
 ,CONT,QWARTT
 ,CONT,RCNTT
 ,CONT,MNT
 ,CONT,MAXT
 ,CONT,PGPNTT
 ,CONT,TEM1
 ,CONT,TEM2
 ,CONT,FILEDEF(64)
 ,CONT,IORET
 ,CONT,EDFUN
 ,CONT,CARDRET
 ,CONT,CDLOCK
 ,CONT,POSCNT
  ,CONT,DRVRET
  ,CONT,LINERET
 ,CONT,DISMAX
 ,CONT,MAXPNT
 ,CONT,CHAN
 ,CONT,ILFLAG
 ,CONT,LISTFLG
 ,CONT,BRKLINE
 ,CONT,PRTCNT
 ,CONT,EDITEND
 ,CONT,UNLRET
 ,CONT,UNLWORD
 ,CONT,LINECNT
 ,CONT,TABEDIT(2)
 ,CONT,REGS(13)
 ,CONT,POSTYPE
 ,CONT,POSFL,POSMASK,POSFRAG(14)
 ,CONT,DELTYPE
 ,CONT,DELFL,DELMASK,DELFRAG(14)
 ,CONT,TIMEABS
 ,CONT,TIMECP(2)
 ,CONT,TIMEWT
 ,CONT,SAVEFL
 ,CONT,CHANINIT
 ,CONT,SCREENBF(256)
 ,CONT,BLOCKLWA
C
C*** INPUT/OUTPUT BUFFERS
C
 FLBUF:,EQU,1024
 OUTPUT:,EQU,1024
 INPUT:,EQU,2048
C
 FILECNT:,EQU,4
C
C*** THE SUB BLOCK COORDINATE
C
 *0:,BLOCK,COTYPE
 ,CONT,COFL
 ,CONT,COMASK
 ,CONT,COFRAG
C
C*** THE SUB BLOCK FILEFDB
C
 *0:,BLOCK,INFOR
 ,CONT,QWARTA
 ,CONT,RCOUNT
 ,CONT,MNUM
 ,CONT,MAXFL
 ,CONT,PGPNT
 ,CONT,RFILE1
 ,CONT,RFILE2
C
C*** THE SUB BLOCK FILEDEF
C
 *0:,BLOCK,FILENAME(2)
 ,CONT,FILEREQ(6)
 ,CONT,FILEFDB(0)
 ,CONT,FILEANS
 ,CONT,FILENUM
 ,CONT,FILELEN
 ,CONT,FILEERRS(3)
 ,CONT,FILEREG
 ,CONT,FILETYPE
C
C*** SOME CONSTANT
C
 MAXBIT:,EQU,=:000002
 LINEBIT:,EQU,=:000001
 CTRLBIT:,EQU,=:0000004
 COMPLETE:,EQU,=:0001
 CHBREAK:,EQU,=:00004
 LBIT:,EQU,=:4
 DBIT:,EQU,=:2
 CATPNT:,EQU,10000B.4 liCT
 FIRSTBL:,EQU,=12000.5 liCT
 MAXSEAR:,EQU,=2000.1024 KAPT
 OURUNIT:,SUBP,
C
C     MACRO DEFINITION
C
 DISLN:,MACRO,
 1,UTC,
 13,VTM,STRING
 ,ITA,13
 ,ITS,1
 ,CALL,ISUNP
 ,NTR,3
 1,MTJ,10
 ,ITA,10
 13,VJM,LINEOUT1
 1,XTA,DRVWORD
 ,AAX,CHBREAK
 DISLN:,ENDM,
C
C***   E D I T O R  S T A R T  H E R E
C
 START:,BSS,
 ,XTA,
 14,VTM,-7
 :14,ATX,FDB+7
 14,VLM,*
 14,VTM,OURUNIT
 ,ITA,14
 14,VTM,FDB
 ,ITS,14
 ,CALL,JFOCC
 ,ASN,64-8
 ,U1A,BADSTART
 ,XTA,FDB+1
 ,ASN,64-12
 ,ATX,SAVUNIT
 ,XTA,FDB+2
 ,AAX,=7777
 ,ATX,UNITFL
 13,VJM,INITSPAC
 ,XTA,INF50
 ,*50,50B
 ,NTR,3
 ,UJ,MLOOP2
 BADSTART:,BSS,
 ,*74,
C
C*** END OF I/O EXCHANGE PROC
C
 INF50:8,Z00,
 ,Z01,*+1
 13,XTA,13
 ,AOX,I/OEND
 ,ATX,I/OEND
 13,XTA,13
 ,AEX,I/OSCALE
 ,AAX,I/OSCALE
 ,ATX,I/OSCALE
 ,*50,60B.INTER.RET
 ENDI/O:14,REL,*
 ,WTC,502B
 ,WTC,
 13,VTM,
 13,XTA,112B
 ,AOX,I/OEND
 ,ATX,I/OEND
 13,XTA,112B.d.{.
 ,AEX,I/OSCALE
 ,AAX,I/OSCALE
 ,ATX,I/OSCALE
 13,XTA,112B
 ,AAX,C177777
 13,ATX,112B
 13,VTM,-7
 :13,ATX,7
 13,VLM,*
 ,MTJ,27B
 2,IJ,
C
 SETI/O:14,REL,*
 ,AOX,I/OSCALE
 ,ATX,I/OSCALE
 ,ATX,
 ,ATX,1
 ,ATX,2
 ,ATX,3
 ,ATX,4
 ,ATX,5
 ,ATX,6
 ,ATX,7
 ,MTJ,27B
 2,IJ,
C
 ,REL,
C
C*** {KAlA liCTOB zAKPyTyX pO |70
 I/OSCALE:,OCT,
 I/OEND:,OCT,
 I/OERROR:,OCT,
C
 C177777:,LOG,177777
C
 INITSPAC:,XTA,
 14,VTM,-1023
 12,VTM,CATPNT
 :14,UTC,1023
 12,ATX,
 14,VLM,*-1
 ,XTA,=:4
 ,WTC,UNITFL
 14,VTM,
 13,UTC,
 14,VZM,
 12,VTM,CATPNT
 :12,ATX,
 12,UTM,1
 14,UTM,-1
 14,V1M,*-1
 12,VTM,CATPNT
 14,VTM,-9
 ,XTA,=:2
 :14,UTC,9
 12,ATX,
 14,VLM,*-1
  ,*65,764B.pOKOlEHiE DD
  ,AEX,
  13,UZA,.OLD DD
C
C..  B diCpET~EPE pOClE 1.1.87
C    |KCTPAKOdY 061 HOMEP TEPMiHAlA
C    pOdAETCq HE B 48-45,  A
C    B 45-41 PAzPqdAX.  PAbOTA BEdETCq
C    C 24-PAzPqdHyMi {KAlAMi TEPMiHAlOB.
C
  ,XTA,=:7777 7777
  ,ATX,MASK61
  ,XTA,=377
  ,ATX,MASKNCH
 13,UJ,
C
  MASK61:,OCT,77777
  MASKNCH:,LOG,17
 SAVUNIT:,OCT,
 UNITFL :,OCT,
 FDB:,BSS,8
C*
C*   PUSH-DOWN-STACK
C*
 PUSHD:,BSS,
 1,ATX,CURWORD
 2,UTM,-FLBUF
 2,VZM,WRITEOUT
 2,UTC,FLBUF
 1,ATX,OUTPUT
 2,UTM,FLBUF+1
 1,XTA,WACNT
 ,ARX,=1
 1,ATX,WACNT
 6,UJ,
 POPD:,BSS,
 2,VZM,READOUT
 2,UTC,
 1,XTA,OUTPUT-1
 2,UTM,-1
 1,ATX,CURWORD
 1,XTA,WACNT
 ,ARX,=7777 7777
 ,AAX,=7777 7777
 1,ATX,WACNT
 1,XTA,CURWORD
 6,UJ,
C*
C*  PUSH-UP-STACK
C*
 POPU:,BSS,
 3,UTM,-FLBUF
 3,VZM,READINP
 3,UTC,FLBUF
 1,XTA,INPUT
 3,UTM,FLBUF+1
 1,ATX,CURWORD
 6,UJ,
 PUSHU:,BSS,
 1,ATX,CURWORD
 3,VZM,WRITEINP
 3,UTC,
 1,ATX,INPUT-1
 3,UTM,-1
 6,UJ,
C*
C*   WRITE COSY CARD TO OUTPUT
C*
 PUTO:,BSS,
 1,XTA,MNO
 7,UZA,
 8,VTM,1-14
 1,XTA,CNTOUT
 ,ARX,=1
 1,ATX,CNTOUT
 PUTO1:8,UTC,13
 1,XTA,STRING
 6,VJM,PUSHD
 1,XTA,CURWORD
 ,AEX,=12
 ,AAX,=377
 7,UZA,
 8,VLM,PUTO1
 7,UJ,
C*
C*   READ COSY CARD FROM INPUT
C*
 GETI:,BSS,
 1,XTA,CNTINP
 7,UZA,
 ,ARX,=7777 7777
 ,AAX,=7777 7777
 1,ATX,CNTINP
 8,VTM,-13
 6,VJM,POPU
 GETI1:8,UTC,13
 1,ATX,STRING
 ,AEX,=12
 ,AAX,=377
 7,UZA,
 8,VLM,POPU
 1,AEX,STRING+13
 1,ATX,STRING+13
 7,UJ,
C*
C*   WRITE COSY CARD TO INPUT
C*
 PUTI:,BSS,
 8,VTM,-1
 1,XTA,CNTINP
 ,ARX,=1
 1,ATX,CNTINP
 PUTI1:8,UTM,1
 8,UTC,
 1,XTA,STRING
 ,AEX,=12
 ,AAX,=377
 ,U1A,PUTI1
 PUTI2:8,UTC,
 1,XTA,STRING
 6,VJM,PUSHU
 7,UTC,
 8,VZM,
 8,UTM,-1
 ,UJ,PUTI2
C*
C*   READ COSY CARD FROM OUTPUT
C*
 GETO:,BSS,
 1,XTA,CNTOUT
 7,UZA,
 ,ARX,=7777 7777
 ,AAX,=7777 7777
 1,ATX,CNTOUT
 6,VJM,POPD
 8,VTM,13
 ,AEX,=12
 ,AAX,=377
 1,AEX,CURWORD
 1,ATX,STRING+13
 GETO1:1,XTA,WACNT
 ,UZA,GETO3
 8,VZM,GETO3
 6,VJM,POPD
 ,AEX,=12
 ,AAX,=377
 ,UZA,GETO2
 8,UTM,-1
 1,XTA,CURWORD
 8,UTC,
 1,ATX,STRING
 ,UJ,GETO1
 GETO2:1,XTA,CURWORD
 6,VJM,PUSHD
 GETO3:7,UTC,
 8,VZM,
 8,MTJ,9
 9,UTM,-13
 10,VTM,
 GETO4:8,UTC,
 1,XTA,STRING
 10,UTC,
 1,ATX,STRING
 10,UTM,1
 8,UTM,1
 9,VLM,GETO4
 7,UJ,
C*
C*   INPUT-OUTPUT FUNCTIONS
C*
 DOI/O:1,ATX,IOWORD
 ,ASN,64+30
 ,AAX,=37
 ,ATI,14
 ,XTA,=:4
 14,ASN,64
  ,*76,SETI/O
 1,*70,IOWORD
 ,UJ,MAINLOOP
C
 READOUT:1,XTA,RCNTO
 ,ARX,=7777
 ,AAX,=7777
 1,ATX,RCNTO
 1,XTS,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 1,AOX,MNO
 15,AOX,
 13,VJM,GETR
 1,ATX,OUT1
 1,XTA,IOWORD
 ,ARX,=1
 13,VJM,RETR
 1,XTA,PGPNTO
 ,ASN,64-20
 ,AOX,SAVUNIT
 1,ARX,OUT1
 ,AOX,=:001
 1,ATX,INFO
 2,VTM,FLBUF
 13,VTM,POPD
 ,UJ,DOI/O
C
 WRITEOUT:,BSS,
 1,XTA,INFO
 ,AOX,=:001
 ,AEX,=:001
 1,ATX,INFO
 13,VJM,DOI/O
 1,XTA,RCNTO
 ,ARX,=1
 ,AAX,=7777
 1,ATX,RCNTO
 1,XTS,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 1,AOX,MNO
 15,AOX,
 13,VJM,GETW
 1,ATX,OUT1
 1,XTA,PGPNTO
 ,ASN,64-20
 ,AOX,SAVUNIT
 1,ARX,OUT1
 1,ATX,INFO
 1,XTA,CURWORD
 ,UJ,PUSHD
 OUTPNT:,,
 ,Z00,OUTFDB
C
 READINP:,BSS,
 1,XTA,SWINP
 ,UZA,READINP1
 1,WTC,SWINP
 ,UJ,
 READINP1:,BSS,
 1,XTA,RCNTI
 ,ARX,=1
 ,AAX,=7777
 1,ATX,RCNTI
 1,XTS,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 1,AOX,MNI
 15,AOX,
 13,VJM,GETR
 1,ATX,INP1
 1,XTA,RCNTI
 ,ARX,=7777
 ,AAX,=7777
 1,AEX,IOWORD
 ,AAX,=7777
 1,AEX,IOWORD
 13,VJM,RETR
 1,XTA,PGPNTI
 ,ASN,64-20
 ,AOX,SAVUNIT
 1,ARX,INP1
 ,AOX,=:001
 1,ATX,INFI
 13,VTM,POPU
 ,UJ,DOI/O
C
 WRITEINP:,BSS,
 1,XTA,INFI
 ,AOX,=:001
 ,AEX,=:001
 1,ATX,INFI
 13,VJM,DOI/O
 1,XTA,RCNTI
 ,ARX,=7777
 ,AAX,=7777
 1,ATX,RCNTI
 1,XTS,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 1,AOX,MNI
 15,AOX,
 13,VJM,GETW
 1,ATX,INP1
 1,XTA,PGPNTI
 ,ASN,64-20
 ,AOX,SAVUNIT
 1,ARX,INP1
 1,ATX,INFI
 3,VTM,FLBUF
 1,XTA,CURWORD
 ,UJ,PUSHU
 INPPNT:,,
 ,,INPFDB
C
 GETR:1,ATX,IOWORD
 12,VTM,CATPNT
 14,VTM,-1023
 GETR1:14,UTC,1023
 12,XTA,
 13,UZA,
 1,AEX,IOWORD
 ,UZA,GETR2
 14,VLM,GETR1
 GETR*:,BSS,
 ,XTA,
 13,UJ,
 GETR2:1,XTA,IOWORD
 14,UTC,1023
 12,ATX,
 14,UTM,1023
 ,ITA,14
 13,UJ,
C
 GETW:1,ATX,IOWORD
 14,VTM,-1023
 12,VTM,CATPNT
 GETW1:14,UTC,1023
 12,XTA,
 ,UZA,GETW*
 1,AEX,IOWORD
 ,UZA,GETW2
 14,VLM,GETW1
 GETW*:,BSS,
 14,VTM,-1023
 :14,UTC,1023
 12,XTA,
 ,UZA,NOTSPACE
 ,AEX,=:4
 ,UZA,GETW2
 14,VLM,GETW*+1
 NOTSPACE:,BSS,
 13,UJ,
 GETW2:1,XTA,IOWORD
 14,UTC,1023
 12,ATX,
 14,UTM,1023
 ,ITA,14
 13,UJ,
C
 RETR:1,ATX,IOWORD
 14,VTM,-1023
 12,VTM,CATPNT
 RETR1:14,UTC,1023
 12,XTA,
 13,UZA,
 1,AEX,IOWORD
 ,UZA,RETR2
 14,VLM,RETR1
 13,UJ,
 RETR2:,XTA,=:4
 14,UTC,1023
 12,ATX,
 13,UJ,
C*
C*   SCREEN SIMULATE FUNCTIONS
C*
 DODWN:1,XTA,CURSOR
 ,AEX,=20
 ,UZA,ROLLUP
 1,XTA,CURSOR
 ,ARX,=1
 1,ATX,CURSOR
 13,UJ,
 ROLLUP:14,VTM,1-16
 ROLLU1:14,UTC,15
 1,XTA,SCREEN
 14,UTC,14
 1,ATX,SCREEN
 14,VLM,ROLLU1
 1,XTA,STRUP
 ,AAX,=77777
 1,ATX,SCREEN+15
 13,UJ,
 DOUP:1,XTA,CURSOR
 ,AEX,=1
 ,UZA,ROLLDWN
 ,NTR,3
 1,XTA,CURSOR
 ,A-X,=1
 1,ATX,CURSOR
 13,UJ,
 ROLLDWN:14,VTM,1-16
 10,VTM,15
 ROLLD1:10,UTC,
 1,XTA,SCREEN
 10,UTC,1
 1,ATX,SCREEN
 10,UTM,-1
 14,VLM,ROLLD1
 1,XTA,STRDWN
 ,AAX,=77777
 1,ATX,SCREEN
 13,UJ,
 DODL:1,XTA,CURSOR
 ,ATI,14
 ,AEX,=20
 ,UZA,DODL2
 14,UTC,-1
 1,XTA,SCREEN
 ,AAX,=77777
 1,ATX,STRUP
 14,UTM,-15
 DODL1:14,UTC,15
 1,XTA,SCREEN
 14,UTC,14
 1,ATX,SCREEN
 14,VLM,DODL1
 1,XTA,STRUP
 1,ATX,SCREEN+15
 13,UJ,
 DODL2:1,XTA,SCREEN+15
 ,AAX,=77777
 1,ATX,SCREEN+15
 13,UJ,
 DOIL:1,XTA,CURSOR
 ,ATI,14
 14,UTM,-16
 10,VTM,15
 DOIL1:10,UTC,
 1,XTA,SCREEN
 10,UTC,1
 1,ATX,SCREEN
 10,UTM,-1
 14,VLM,DOIL1
 1,XTA,STRDWN
 ,AAX,=77777
 1,WTC,CURSOR
 1,ATX,SCREEN-1
 13,UJ,
 DOSET:1,UTC,
 12,VTM,SCREENBF
 14,VTM,1-16
 DOSET1:,ITA,12
 14,UTC,15
 1,ATX,SCREEN
 12,UTM,16
 14,VLM,DOSET1
 ,XTA,
 1,ATX,STRUP
 1,ATX,STRDWN
 13,UJ,
C
 UNLOAD:1,WTC,CURSOR
 1,XTA,SCREEN-1
 1,ATX,UNLWORD
 ,ITA,13
 1,ATX,UNLRET
 1,XTA,UNLWORD
 ,AAX,LBIT
 ,UZA,UNLOAD3
 UNLOAD1:13,VJM,DOIL
 1,XTA,STRDWN
 1,AEX,UNLWORD
 ,UZA,UNLOAD2
 1,XTA,STRDWN
 ,AAX,LBIT
 7,VTM,UNLOAD1
 ,U1A,WRCDINP
 7,UJ,
 UNLOAD2:1,XTA,STRDWN
 ,AAX,LBIT
 ,UZA,UNLOAD3
 7,VJM,WRCDINP
 UNLOAD3:13,VJM,ROLLUP
 1,XTA,STRUP
 ,AAX,LBIT
 7,VTM,UNLOAD3
 ,U1A,WRITECD
 13,VJM,DOSET
 1,WTC,UNLRET
 ,UJ,
C*
C*   MAIN SCREEN PROCESSOR
C*
C*       FUNCTIONS:
C*   0-AUTO-LINE-FEED
C*   1-LINE-FEED
C*   2-CURSOR DOWN
C*   3-CURSOR UP
C*   4-DELETE LINE
C*   5-INSERT LINE
C*   6-ERASE SCREEN
C*   7-GO HOME
C*
 DOEDIT:1,WTC,EDFUN
 ,UJ,*+1
 FUN0:,UJ,AUTOPROC
 FUN1:,UJ,LFPROC
 FUN2:,UJ,CDPROC
 FUN3:,UJ,CUPROC
 FUN4:13,VTM,DLPROC
 ,UJ,DODL
 FUN5:,UJ,ILPROC
 FUN6:,UJ,ERAPROC
 FUN7:,UJ,HOMPROC
C*
C*   DELETE LINE PROCESS
C*
 DLPROC:1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AAX,LBIT
 ,U1A,DLPROC3
 7,VJM,READCD
 1,XTA,CNTINP
 ,U1A,DLPROC1
 7,VJM,BLCARD
 DLPROC1:7,VJM,TOISO
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AOX,LBIT
 1,WTC,CURSOR
 1,ATX,SCREEN-1
 ,ATI,10
 14,VTM,1-14
 DLPROC2:14,UTC,13
 1,XTA,STRING
 14,UTC,13
 10,ATX,
 14,VLM,DLPROC2
 DLPROC3:,BSS,
 ,XTA,PRDLFUN
 13,VJM,DRVOUT
 ,UJ,AUTPROC1
C*
C*   CUPSOR UP PROCESS
C*
 CUPROC:1,XTA,CURSOR
 ,AEX,=1
 1,AOX,CNTOUT
 ,UZA,DRVIN
 13,VJM,DOUP
 7,VTM,CUPROC1
 1,XTA,STRDWN
 ,AAX,LBIT
 ,U1A,WRCDINP
 CUPROC1:1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AAX,DBIT
 ,U1A,CUPROC3
 7,VJM,GETO
 7,VJM,TOISO
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AOX,LBIT
 1,WTC,CURSOR
 1,ATX,SCREEN-1
 ,ATI,10
 14,VTM,1-14
 CUPROC2:14,UTC,13
 1,XTA,STRING
 14,UTC,13
 10,ATX,
 14,VLM,CUPROC2
 ,XTA,PRILFUN
 13,VJM,DRVOUT
 13,VJM,LINEOUT
 CUPROC3:,BSS,
 ,XTA,CUFUN
 13,VTM,DRVIN
 ,UJ,DRVOUT
C*
C*   AUTO-LINE-FEED PROCESS
C*
 AUTOPROC:,BSS,
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AOX,DBIT
 1,WTC,CURSOR
 1,ATX,SCREEN-1
 13,VJM,DODWN
 1,XTA,STRUP
 ,AAX,LBIT
 7,VTM,AUTPROC1
 ,U1A,WRITECD
 AUTPROC1:1,XTA,ILFLAG
 ,U1A,ILPROC
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AAX,LBIT
 ,U1A,AUTPROC4
 7,VTM,AUTPROC2
 1,XTA,CNTINP
 ,U1A,READCD
 ,UJ,BLCARD
 AUTPROC2:7,VJM,TOISO
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AOX,LBIT
 1,WTC,CURSOR
 1,ATX,SCREEN-1
 ,ATI,10
 14,VTM,1-14
 AUTPROC3:14,UTC,13
 1,XTA,STRING
 14,UTC,13
 10,ATX,
 14,VLM,AUTPROC3
 AUTPROC4:1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AAX,DBIT
 ,U1A,DRVIN
 13,VJM,LINEOUT
 13,VJM,DODWN
 1,XTA,STRUP
 ,AAX,LBIT
 7,VTM,AUTPROC5
 ,U1A,WRITECD
 AUTPROC5:13,VJM,DOUP
 ,XTA,CUFUN
 13,VTM,DRVIN
 ,UJ,DRVOUT
C*
C*   LINE-FEED PROCESS
C*
  LFPROC:,BSS,
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,ATI,8
 1,XTA,POSCNT
 ,ATI,9
 ,AEX,=1
 ,UZA,DRVIN
 ,XTA,=:776
 ,ATX,MASK
 10,VTM,1
 11,VTM,
 LFPROC1:9,UTM,-1
 9,VZM,LFPROC2
 ,XTA,MASK
 ,ASN,64+8
 ,ATX,MASK
 ,U1A,LFPROC1
 8,UTM,1
 ,XTA,=:776
 ,ATX,MASK
 ,UJ,LFPROC1
 LFPROC2:8,XTA,
 ,AAX,MASK
 ,UZA,LFPROC4
 ,AEX,=6H
 ,AAX,MASK
 ,UZA,LFPROC3
 10,MTJ,11
 8,AEX,
 8,ATX,
 LFPROC3:10,UTM,1
 ,XTA,MASK
 ,ASN,64+8
 ,ATX,MASK
 ,U1A,LFPROC2
 8,UTM,1
 ,XTA,=:776
 ,ATX,MASK
 ,UJ,LFPROC2
 LFPROC4:11,VZM,LFPROC5
 ,ITA,11
 13,VTM,AUTOPROC
 ,UJ,OUTBLK
 LFPROC5:,XTA,LFFUN
 13,VTM,AUTOPROC
 ,UJ,DRVOUT
C*
C*   CURSOR DOWN PROCESS
C*
  CDPROC:,BSS,
 13,VJM,DODWN
 1,XTA,STRUP
 ,AAX,LBIT
 7,VTM,CDPROC2
 ,U1A,WRITECD
 CDPROC2:1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AAX,DBIT
 ,U1A,CDPROC3
 1,XTA,CNTINP
 ,UZA,CDPROC4
 ,XTA,CDPRFUN
 13,VTM,AUTPROC1
 ,UJ,DRVOUT
 CDPROC3:,XTA,CDFUN
 13,VTM,AUTPROC1
 ,UJ,DRVOUT
 CDPROC4:,XTA,CDPRFUN
 13,VJM,DRVOUT
 13,VTM,CUPROC3
 ,UJ,DOUP
C*
C*   INSERT LINE PROCESS
C*
 ILPROC:,BSS,
 ,XTA,=1
 1,ATX,ILFLAG
 13,VJM,DOIL
 1,XTA,STRDWN
 7,VTM,ILPROC1
 ,AAX,LBIT
 ,U1A,WRCDINP
 ILPROC1:14,VTM,-13
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AOX,LBIT
 ,AOX,DBIT
 1,WTC,CURSOR
 1,ATX,SCREEN-1
 ,ATI,10
 ,XTA,=6H
 ILPROC2:14,UTC,13
 10,ATX,
 14,VLM,ILPROC2
 ,XTA,ILFUN
 13,VJM,DRVOUT
 ,UJ,DRVIN
C*
C*   ERASE SCREEN PROCESS
C*
 ERAPROC:,BSS,
 13,VJM,UNLOAD
 ,XTA,
 1,ATX,LINECNT
 ERAPROC1:7,VJM,READCD
 1,XTA,CNTINP
 ,UZA,HOME
 7,VJM,PUTO
 1,XTA,LINECNT
 ,ARX,=1
 1,ATX,LINECNT
 ,AEX,=20
 ,U1A,ERAPROC1
 ,UJ,HOME
C*
C*   GO HOME PROCESS
C*
 HOMPROC:,BSS,
 13,VJM,UNLOAD
 ,XTA,
 1,ATX,LINECNT
 HOMPROC1:1,XTA,WACNT
 ,UZA,HOME
 7,VJM,GETO
 7,VJM,PUTI
 1,XTA,LINECNT
 ,ARX,=1
 1,ATX,LINECNT
 ,AEX,=20
 ,U1A,HOMPROC1
C
 HOME:,XTA,ERFUN
 13,VJM,DRVOUT
 ,XTA,=1
 1,ATX,CURSOR
 7,VJM,READCD
 1,XTA,CNTINP
 ,U1A,HOME1
 7,VJM,BLCARD
 HOME1:7,VJM,TOISO
 14,VTM,1-14
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AOX,LBIT
 1,WTC,CURSOR
 1,ATX,SCREEN-1
 ,ATI,8
 HOME2:14,UTC,13
 1,XTA,STRING
 14,UTC,13
 8,ATX,
 14,VLM,HOME2
 13,VJM,LINEOUT
 ,XTA,CUFUN
 13,VTM,DRVIN
 ,UJ,DRVOUT
C*
C*   M I S C E L A N I U S
C*
C
C*** READ FORMAT COSY CARD FROM INPUT
C
 READCD:1,XTA,CNTINP
 7,UZA,
 ,ITA,7
 1,ATX,CARDRET
 7,VJM,GETI
 1,XTA,STRING
 ,AEX,=6H*READ'201'
 ,ASN,64+8
 ,U1A,READCD1
 1,XTA,STRING+1
 ,AEX,=6HOLD
 ,ASN,64+24
 ,U1A,READCD1
 1,ATX,CNTINP
 READCD1:1,WTC,CARDRET
 ,UJ,
C
C*** DUMMY INSERT BLANK CARD
C
 BLCARD:,XTA,=6H*READ
 1,ATX,STRING
 ,XTA,=6HOLD'312''12''12'
 1,ATX,STRING+1
 7,UJ,
C
C*** WRITE FORMAT COSY CARD TO OUTPUT
C
 WRITECD:1,XTA,STRUP
 ,ATI,10
 ,XTA,
 1,ATX,STRUP
 14,VTM,1-14
 WRITECD1:14,UTC,13
 10,XTA,
 14,UTC,13
 1,ATX,STRING
 14,VLM,WRITECD1
 WRITECD2:,BSS,
 ,ITA,7
 1,ATX,CARDRET
 7,VJM,COSY
 7,VJM,PUTO
 1,WTC,CARDRET
 ,UJ,
C
C*** WRITE FORMAT COSY TO INPUT
C
 WRCDINP:1,XTA,STRDWN
 ,ATI,10
 ,XTA,
 1,ATX,STRDWN
 14,VTM,-13
 WRCDINP1:14,UTC,13
 10,XTA,
 14,UTC,13
 1,ATX,STRING
 14,VLM,WRCDINP1
 WRCDINP2:,BSS,
 ,ITA,7
 1,ATX,CARDRET
 7,VJM,COSY
 7,VJM,PUTI
 1,WTC,CARDRET
 ,UJ,
C
C*** OUTPUT BLANK STRING
C
 OUTBLK:,BSS,
 ,AAX,=377
 ,ASN,64-16
 ,AOX,BLKFUN
 ,AOX,OUTFUN
 1,ATX,DRVWORD
 ,ITA,13
 1,ATX,LINERET
 1,XTA,DRVWORD
 13,VJM,DRVOUT
 1,XTA,POSCNT
 ,AEX,=1
 ,UZA,OUTBLK1
 ,XTA,LFFUN
 13,VJM,DRVOUT
 OUTBLK1:1,WTC,LINERET
 ,UJ,
C
C*** DECOMPRESION CARD
C
 TOISO:,BSS,
 14,VTM,-13
 1,UTC,
 8,VTM,STRING
 1,MTJ,11
 :14,UTC,13
 8,XTA,
 14,UTC,13
 11,ATX,
 14,VLM,TOISO+2
 ,ITA,11
 ,ITS,8
 ,CALL,ISUNP
 ,NTR,3
 1,XTA,STRING+13
 ,AAX,=:77777400
 1,ATX,STRING+13
 7,UJ,
C
C*** COMPRESION CARD
C
 COSY:,BSS,
 1,UTC,
 8,VTM,STRING
 1,MTJ,11
 14,VTM,1-14
 COSY1:14,UTC,13
 8,XTA,
 14,UTC,13
 11,ATX,
 ,ARX,=6H'177''177''177''177''177''177'
 ,AAX,=6H'200''200''200''200''200''200'
 ,AEX,=6H'200''200''200''200''200''200'
 ,U1A,COSY3
 14,VLM,COSY1
 COSY2:11,XTA,13
 ,AAX,=377
 ,AEX,=12
 11,AEX,13
 11,ATX,13
 ,ITA,11
 ,ITS,8
 ,CALL,ISPACK
 ,NTR,3
 7,UJ,
 COSY3:,ASN,64+2
 14,UTC,13
 8,AOX,
 14,UTC,13
 11,ATX,
 ,XTA,=6H
 14,VLM,COSY4
 ,UJ,COSY2
 COSY4:14,UTC,13
 11,ATX,
 14,VLM,COSY4
 ,UJ,COSY2
C
C*** CALL NRESLINE FOR OUTPUT
C
 DRVOUT:,BSS,
 1,AOX,CHAN
 ,*61,-1
 1,ATX,DRVWORD
 ,ITA,13
 1,ATX,DRVRET
 DRVOUT1:1,XTA,DRVWORD
 ,AAX,COMPLETE
 13,VTM,DRVOUT2
 ,UZA,SETWAIT
 1,XTA,DRVWORD
 ,ASN,64+16
 ,AAX,=377
 1,ATX,POSCNT
 1,WTC,DRVRET
 13,VTM,
C
C*** CLEAR WAIT DRV FLAG
C
 CLRWAIT:,BSS,
 1,XTA,CHAN
  ,AUX,MASKNCH
 ,ATI,14
 ,XTA,=:4
 14,ASN,64-1
 ,AEX,=7777 7777 7777 7777
 ,AAX,WAITDRV
 ,ATX,WAITDRV
 13,UJ,
 DRVOUT2:1,XTA,CHAN
 ,AOX,STAFUN
 1,ATX,DRVWORD
 ,*61,-1
 1,ATX,DRVWORD
 ,UJ,DRVOUT1
C
C*** CALL NRESLINE FOR INPUT
C
 DRVIN :,BSS,
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AAX,=77777
 1,AOX,CHAN
 ,AOX,INPFUN
 1,XTS,MAXPNT
 ,ASN,64-24
 15,AOX,
 ,*61,-1
 1,ATX,DRVWORD
 DRVIN1:1,XTA,DRVWORD
 ,AAX,COMPLETE
 13,VTM,DRVIN2
 ,UZA,SETWAIT
 1,XTA,DRVWORD
 ,AAX,=377
 ,ATI,13.LAST CHAR.
 1,XTA,DRVWORD
 ,ASN,64+16
 ,AAX,=377
 1,ATX,POSCNT
 1,XTA,DRVWORD
 ,AAX,LINEBIT
 14,VTM,
 ,U1A,SETED
 1,XTA,DRVWORD
 ,AAX,CTRLBIT
 ,UZA,DRVIN3
 13,UTM,-3B.ETX
 13,VZM,CHECKIL
 13,UTM,-7B.LF
 14,VTM,1
 13,VZM,SETED
 13,UTM,-1.IL
 14,VTM,5
 13,VZM,SETED
 13,UTM,-1.HOME
 14,VTM,7
 13,VZM,SETED
 13,UTM,-1.CR
 13,VZM,COMMAND
 13,UTM,-14B.CU
 14,VTM,3
 13,VZM,SETED
 13,UTM,-1.CD
 14,VTM,2
 13,VZM,SETED
 13,UTM,-4.DL
 14,VTM,4
 13,VZM,SETED
 13,UTM,-1.ERASE
 14,VTM,6
 13,VZM,SETED
 DRVIN3:1,XTA,DRVWORD
 ,AAX,MAXBIT
 ,UZA,DRVIN
 DRVIN3*:,BSS,
 ,XTA,INP1FUN
 1,AOX,CHAN
 ,*61,-1
 1,ATX,DRVWORD
 DRVIN4:1,XTA,DRVWORD
 ,AAX,COMPLETE
 13,VTM,DRVIN5
 ,UZA,SETWAIT
 1,XTA,DRVWORD
 ,AAX,=377
 ,ATI,14
 14,UTM,-10B.C.LEFT
 14,VZM,DRVIN
 14,UTM,-1.H.TAB.
 14,V1M,DRVIN3*
C********
 ,UJ,DRVIN
 DRVIN5:,XTA,STAFUN
 1,AOX,CHAN
 ,*61,-1
 1,ATX,DRVWORD
 ,UJ,DRVIN4
 DRVIN2:,XTA,STAFUN
 1,AOX,CHAN
 ,*61,-1
 1,ATX,DRVWORD
 ,UJ,DRVIN1
C
 CLRIL:,XTA,
 1,ATX,ILFLAG
 SETED:,ITA,14
 1,ATX,EDFUN
 ,ASN,64+1
 13,VTM,DOEDIT
 ,UZA,CLRWAIT
 1,XTA,ILFLAG
 ,U1A,DRVIN
 ,UJ,CLRWAIT
C
 CHECKIL:1,XTA,ILFLAG
 14,VTM,1.LF
 ,UZA,SETED
 1,XTA,POSCNT
 ,AEX,=1
 ,U1A,CLRIL
 14,VTM,4.DL
 ,UJ,CLRIL
C
C*** OUTPUT STRING ON DISPLAY
C
 LINEOUT:,BSS,
 1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,ATI,10
 LINEOUT1:,BSS,
 ,ATI,8
 1,WTC,DISMAX
 14,VTM,
 11,VTM,
 12,VTM,1.XOTq by OdiH
 ,XTA,
 1,ATX,BRKLINE
 ,XTA,=:776
 ,ATX,MASK
 LOUT1:8,XTA,
 11,UTM,1
 ,AAX,MASK
 ,UZA,LOUT3+1
 ,AEX,=6H
 ,AAX,MASK
 ,UZA,LOUT2
 11,MTJ,12
 LOUT2:,BSS,
 ,XTA,MASK
 ,ASN,64+8
 ,ATX,MASK
 ,U1A,LOUT3
 ,XTA,=:776
 ,ATX,MASK
 8,UTM,1
 LOUT3:14,UTM,-1
 14,V1M,LOUT1
 :,ITA,10
 1,ATX,DRVWORD
 ,ITA,13
 1,ATX,LINERET
 ,ITA,12
 ,ASN,64-16
 1,AOX,DRVWORD
 ,AOX,OUTFUN
 13,VJM,DRVOUT
 1,XTA,DRVWORD
 ,AAX,CHBREAK
 1,ATX,BRKLINE
 1,XTA,POSCNT
 ,AEX,=1
 ,UZA,LOUT4
 ,XTA,LFFUN
 13,VJM,DRVOUT
 1,XTA,DRVWORD
 1,AOX,BRKLINE
 1,ATX,DRVWORD
 LOUT4:1,WTC,CURSOR
 1,XTA,SCREEN-1
 ,AOX,DBIT
 1,WTC,CURSOR
 1,ATX,SCREEN-1
 1,WTC,LINERET
 ,UJ,
C
C****************************************
C*      THE MAIN LOOP OF EDITOR         *
C*  SCANNING CONNECTED CHANNELS AND     *
C*     NEW CHANNEL INICIALIZATION       *
C****************************************
C
 SETWAIT:1,XTA,CHAN
  ,AUX,MASKNCH
 ,ATI,14
 ,XTA,=:4
 14,ASN,64-1
 ,AOX,WAITDRV
 ,ATX,WAITDRV
 MAINLOOP:14,VTM,1-13
 ,NTR,3
 MLOOP1:14,ITA,13
 1,UTC,REGS
 14,ATX,12
 14,VLM,MLOOP1
 ,*50,70210B
 ,NTR,2
 1,A-X,TIMECP+1
 1,A+X,TIMECP
 1,ATX,TIMECP
 ,NTR,3
 MLOOP2:,*76,ENDI/O
 ,XTA,CONCHAN
 ,UZA,MLOOP4
 ,ANX,
 ,ATI,14
 ,YTA,
 14,ASN,64
 ,ATX,CONCHAN
 14,MTJ,2
 ,XTA,=:7777 7777
 ,*50,76217B.AAX+ATX
 2,XTA,CHANPNT-1
 ,ATI,1
 ,ASN,64+10
 ,ATI,12
 ,ASN,64+17.BpiCyBAEM
  ,AAX,=1777
  :,U1A,*+1
  ,XTA,=1
 :,*50,74217B.NPASS B ipz
 2,MTJ,14
 ,XTA,=:7
 12,ASN,64
 ,AAX,I/OSCALE
 ,U1A,SETWI/O
 ,XTA,=:4
 14,ASN,64-1
 ,AEX,WAITI/O
 ,AAX,WAITI/O
 ,ATX,WAITI/O
 14,VTM,1-13
 MLOOP3:1,UTC,REGS
 14,XTA,12
 14,ATI,13
 14,VLM,MLOOP3
 13,UJ,
 MLOOP4:,XTA,REQCONCH
 ,*61,-1
  ,AAX,MASK61
 ,ATX,CONCHAN
 ,AAX,WAITI/O
 ,ATX,WAITI/O
 ,XTA,CONCHAN
 ,AOX,INITCHAN
 ,ATX,CONCHAN
  ,*50,70217B
 ,ARX,
 ,U1A,MLOOP5
 13,VJM,INITCH
 MLOOP5:,XTA,WAITDRV
 ,AOX,WAITI/O
 ,AEX,CONCHAN
 ,U1A,MLOOP2
 ,XTA,WAITFUN
 ,*61,-1
  ,AAX,MASK61
 ,UZA,MLOOP2
 ,ATX,CONCHAN
 ,UJ,MLOOP2
 SETWI/O:,XTA,=:4
 14,ASN,64-1
 ,AOX,WAITI/O
 ,ATX,WAITI/O
 ,UJ,MLOOP2
 INITCH:,BSS,
 ,*50,70217B
 ,ASN,64+39
  ,AAX,=37
 ,ATI,12
 ,XTA,CONCHAN
 ,ACX,
 ,ASN,64+3
 13,U1A,
 ,XTA,CHANCNT
 ,ANX,
 ,ATI,14
 ,YTA,
 14,ASN,64
 ,ATX,CHANCNT
 14,UTM,-1
 ,ITA,14
 ,ASN,64-10
 ,ARX,FIRSTBL
 12,ATX,CHANPNT-1
 ,ATI,1
 14,VTM,1-1024
 ,XTA,
 INITCH1:1,UTC,
 14,ATX,1023
 14,VLM,INITCH1
 ,ITA,12
  ,APX,MASKNCH
 1,ATX,CHAN
 ,*50,70210B
 1,ATX,TIMECP+1
 ,*63,542B
 1,ATX,TIMEABS
 ,*50,70217B
 ,AAX,=:0000 1777
 ,ASN,64-3
 12,AOX,CHANPNT-1
 12,ATX,CHANPNT-1
C
C    B  37-28 P.P. CHANPNT -
C    - NPASS KliEHTA.
C
 ,ITA,12
 ,ASN,64-15
 ,ITS,12
 15,AOX,
 1,ATX,CHANINIT
 ,XTA,
 ,*50,72217B
 ,XTA,=:4
 12,ASN,64-1
 ,AOX,INITCHAN
 ,ATX,INITCHAN
 ,AOX,CONCHAN
 ,ATX,CONCHAN
 14,VTM,INITCH2
 ,ITA,14
 1,ATX,REGS+12
 ,ITA,1
 1,ATX,REGS
 ,ARX,=2000
 1,ATX,PGPNTO
 ,ARX,=2000
 1,ATX,PGPNTI
 ,XTA,=120
 1,ATX,DISMAX
 13,UJ,
 INITCH2:,BSS,
  1,XTA,CHAN
  ,AUX,MASKNCH
  ,ATI,14
  14,XTA,CHANPNT-1
  ,ASN,64+27
  ,AAX,=1777
  ,AOX,CONFUN
 1,AOX,CHAN
 ,*61,-1
 1,AEX,CHAN
 ,ASN,64+24
 ,U1A,SETWAIT
 13,VJM,CLRWAIT
C... CLEAR CHANNEL FROM INITCHAN SCALE
 1,XTA,CHANINIT
 ,ASN,64+15
  ,AAX,=37
 ,ATI,14
 ,XTA,=:4
 14,ASN,64-1
 ,AAX,INITCHAN
 ,AEX,INITCHAN
 ,ATX,INITCHAN
 ,XTA,=10000
 1,ATX,MNO
 1,XTA,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 1,AOX,MNO
 13,VJM,GETW
 ,ARX,SAVUNIT
 1,XTS,PGPNTO
 ,ASN,64-20
 15,AOX,
 1,ATX,INFO
 3,VTM,
 ,XTA,=20000
 1,ATX,MNI
 1,XTA,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 1,AOX,MNI
 13,VJM,GETW
 ,AOX,SAVUNIT
 1,XTS,PGPNTI
 ,ASN,64-20
 15,AOX,
 ,AOX,=:001
 1,ATX,INFI
 2,VTM,
 ,XTA,CTRLFUN
 1,AOX,CHAN
 ,*61,-1
 ,XTA,=:00001
 1,ATX,TABEDIT
 ,XTA,=200
 1,ATX,TABEDIT+1
 ,XTA,INITFUN
 13,VJM,DRVOUT
 ,UJ,COMMAND1
 INITFUN:,Z00,42000B
 5,Z00,INITEXT
 INITEXT:,ISO, H"'37'   | K P A H H y j   P E d A K T O P      "
 ,CONT,6HBEPCiq
 ,CONT,6H 1.1C
 ,CONT,2H'12''0'
 INITCHAN:,OCT,
C
 COMMAND:1,XTA,ILFLAG
 ,U1A,DRVIN
 13,VJM,UNLOAD
 ,XTA,COMFUN
 13,VJM,DRVOUT
 COMMAND1:14,VTM,TABCOM
 ,ITA,14
 ,AOX,TABFUN
 1,AOX,CHAN
 ,*61,-1
 COMMAND0:,BSS,
 ,XTA,
 1,ATX,LISTFLG
 ,XTA,HASHFUN
 13,VJM,DRVOUT
 ,XTA,=1H#
 ,ATX,COMMBF
 COMMAND2:,XTA,CINPFUN
 1,AOX,CHAN
 ,*61,-1
 1,ATX,DRVWORD
 COMMAND3:1,XTA,DRVWORD
 ,AAX,COMPLETE
 13,VTM,COMMAND4
 ,UZA,SETWAIT
 13,VJM,CLRWAIT
 1,XTA,DRVWORD
 ,AAX,LINEBIT
 ,U1A,GETCOM
 1,XTA,DRVWORD
 ,AAX,=377
 ,ATI,14
 1,XTA,DRVWORD
 ,ASN,64+16
 ,AAX,=377
 1,ATX,POSCNT
 14,UTM,-12B
 14,VZM,GETCOM
 14,UTM,-3.CR
 14,V1M,COMMAND2
 1,XTA,POSCNT
 ,AEX,=2
 ,U1A,COMMAND2
 1,ATX,SAVEFL
 1,UTC,
 14,VTM,TABEDIT
 ,ITA,14
 ,AOX,TABFUN
 1,AOX,CHAN
 ,*61,-1
 13,VJM,DOSET
 ,UJ,HOME
 COMMAND4:,XTA,STAFUN
 1,AOX,CHAN
 ,*61,-1
 1,ATX,DRVWORD
 ,UJ,COMMAND3
 TABCOM:,LOG,0037 7777 7777 7777
 ,LOG,0037 7777 7777 7777
 COMMBF:,BSS,15
C
 GETCH:,ITA,9
 1,AEX,POSCNT
 14,UZA,
 8,XTA,
 ,ASN,64-8
 8,ATX,
 ,YTA,
 8,XTS,
 ,U1A,GETCH1
 8,UTM,1
 GETCH1:15,XTA,
 9,UTM,1
 14,UJ,
C
 HOLL:11,XTA,
 ,ASN,64-8
 ,ITS,12
 15,AEX,
 11,ATX,
 ,AAX,=:776
 14,UZA,
 11,UTM,1
 ,XTA,
 11,ATX,
 14,UJ,
C
 NUMI:,ITA,12
 ,AAX,=17
 11,XTS,
 ,ASN,64-1
 15,ATX,
 ,ASN,64-2
 15,ARX,
 15,ARX,
 11,ATX,
 14,UJ,
C
 NUMB:,ITA,12
 ,AAX,=7
 11,XTS,
 ,ASN,64-3
 15,AEX,
 11,ATX,
 14,UJ,
C
 GETCOM:,BSS,
 8,VTM,COMMBF
 9,VTM,1
 14,VJM,GETCH
 ,AEX,=43.#
 ,U1A,ERCOM
 ,XTA,=2
 1,ATX,LINECNT
 14,VJM,GETCH
 ,UZA,POSOLD
 ,ATI,12
 ,AEX,=133.[
 ,UZA,OPENH
 ,AEX,=6.]
 ,UZA,CLOSEH
 ,ITA,12
 ,ASN,64+6
 ,U1A,KEYWORD
 FORLIST:,BSS,
 12,UTM,-53B.+
 12,VZM,POSPL
 12,UTM,-2B.-
 12,VZM,POSMI
 12,UTM,-20B.=
 12,VZM,CALLH
 12,UTM,-2B.?
 12,VZM,ANSWER
 ,UJ,ERCOM
 KEYWORD:1,MTJ,11
 ,XTA,
 11,ATX,
 13,VTM,
 KEYWORD1:14,VJM,HOLL
 13,UTM,1
 14,VJM,GETCH
 ,ATI,12
 ,UZA,CHECKEY
 ,ASN,64+6
 ,U1A,KEYWORD1
 CHECKEY:,ITA,13
 ,A-X,=7
 ,UZA,ERCOM
 13,J+M,13
 13,J+M,13
 13,J+M,13
 13,UTM,-48
 1,XTA,
 13,ASN,64
 1,ATX,
 ,XTA,=7777 7777 7777 7777
 13,ASN,64
 1,ATX,1
 14,VTM,
 CHECKEY1:14,XTA,KEYWT
 ,UZA,ERCOM
 1,AEX,
 1,AAX,1
 14,UZA,KEYSW
 14,UTM,1
 ,UJ,CHECKEY1
 KEYWT:,ISO,6HLIST
 :,ISO,6HDELETE
 :,ISO,6HEDIT
 :,ISO,6HSAVE
 :,ISO,6HFILE
 :,ISO,6HSCREEN
 :,ISO,6HTAB
 :,ISO,6HEND
 :,ISO,6HRETURN
 :,ISO,6HUSE
 :,ISO,6HKILL
 :,ISO,6HTEACH
 :,ISO,6HINSERT
 :,LOG,
C
 KEYSW:1,ATX,SAVEFL
 ,UJ,LIST
 :1,ATX,SAVEFL
  ,UJ,DELETE
  :1,ATX,SAVEFL
  ,UJ,EDIT
 :,UJ,SAVE
 :,UJ,FILE
 :,UJ,SCREMAX
 :,UJ,TABULATE
 :,UJ,ENDRUN
 :,UJ,RETURN
 :1,ATX,SAVEFL
  ,UJ,USE
 :,UJ,ENDRUN1.WITHOUT SAVE
 :,UJ,TEACH
 :1,ATX,SAVEFL
 ,UJ,INSERT
C
 FILE:12,VZM,ERCOM
 12,UTM,-72B.:
 12,V1M,ERCOM
 13,VTM,-6
 ,XTA,
 1,MTJ,11
 11,ATX,
 FILE1:14,VJM,GETCH
 ,ATI,12
 ,UZA,FILES
 ,AEX,=54.,
 ,UZA,FILE2
 14,VTM,FILE1
 13,VLM,HOLL
 ,UJ,FILEER4
 FILE2:,XTA,=6H             .!!!!
 1,MTJ,11
 11,UTM,1
 11,ATX,
 ,XTA,
 11,ATX,1
 11,UTM,1
 1,XTA,
 ,UZA,FILEER1
 :1,XTA,
 ,AAX,=:776
 ,U1A,FILE3
 1,XTA,
 ,ASN,64-8
 ,AOX,=40
 1,ATX,
 ,UJ,*-3
 FILE3:14,VJM,GETCH
 ,UZA,FILE4
 ,ATI,12
 14,VTM,FILE3
 ,UJ,HOLL
 FILE4:11,XTA,
 ,UZA,REQFILE
 12,VTM,40B
 14,VTM,FILE4
 ,UJ,HOLL
 FILES:,XTA,=6HS(40)
 1,ATX,2
 1,XTA,
 ,UZA,FILEER1
 ,XTA,=6H
 1,ATX,1
 :1,XTA,
 ,AAX,=:776
 ,U1A,REQFILE
 1,XTA,
 ,ASN,64-8
 ,AOX,=40
 1,ATX,
 ,UJ,*-3
 REQFILE:,BSS,
 1,XTA,
 13,VJM,SEARFILE
 ,UZA,FILEER2
 ,ARX,
 ,U1A,FILEER5
 ,ATI,11
 ,ATX,CURFILE
 14,VTM,-7
 REQFILE1:14,UTC,7
 1,XTA,
 14,UTC,7
 11,ATX,
 14,VLM,REQFILE1
 14,VTM,-7
 ,XTA,
 :14,UTC,7
 11,ATX,FILEFDB
 14,VLM,*-1
 11,MTJ,14
 14,UTM,FILEREQ
 ,ITA,14
 14,UTM,FILEFDB-FILEREQ
 ,ITS,14
 ,CALL,JFOCC
 ,ASN,64-8
 ,UZA,FILEOK
 ,WTC,CURFILE
 11,VTM,
 ,XTA,=6H'12'
 11,ATX,FILELEN
 11,MTJ,14
 ,XTA,
 11,ATX,FILENAME
 14,UTM,FILELEN
 FILEER:,ITA,14
 ,AOX,FERFUN
 13,VTM,NEXTCOM
 ,UJ,DRVOUT
 FILEOK:,WTC,CURFILE
 11,VTM,
 11,XTA,FILEANS
 ,AEX,=I1
 ,UZA,NEXTCOM
 ,XTA,
 11,ATX,FILENAME
 ,UJ,FILEER3
 FERFUN:,Z00,42000B
 2,Z20,
 FILEER1:14,VJM,FILEER
 :,ISO,H+'12'  HET iMEHi fAjlA'0'+
 FILEER2:14,VJM,FILEER
 :,ISO,H+'12'  ~iClO fAjlOB bOlx{E 4'0'+
 FILEER3:14,VJM,FILEER
 :,ISO,H+'12'  O{ibO~Hyj zAKAz'0'+
 FILEER4:14,VJM,FILEER
 :,ISO,H+'12'  plOXOE iMq fAjlA''+
 FILEER5:14,VJM,FILEER
 :,ISO,H+'12'  TAKOE iMq fAjlA YvE ECTx''+
 FILEER6:14,VJM,FILEER
 :,ISO,H+'12'  pPEBy{EH PAzMEP fAjlA''+
 FILEER7:14,VJM,FILEER
 :,ISO,H+'12'  zApiCx HA fAjl zApPE}EHA''+
C
 CURFILE:,BSS,1
 SEARFILE:,BSS,
 ,ATX,SEAFILE*
 ,XTA,
 ,ATX,SEAFILE/
 14,VTM,1-FILECNT
 1,UTC,
 12,VTM,FILEDEF
 SEAFILE1:12,XTA,FILENAME
 ,UZA,SEAFILE4
 ,AEX,SEAFILE*
 ,UZA,SEAFILE3
 SEAFILE2:12,UTM,16
 14,VLM,SEAFILE1
 ,XTA,SEAFILE/
 13,UJ,
 SEAFILE3:,ITA,12
 13,UJ,
 SEAFILE4:,ITA,12
 ,AOX,=:4
 ,ATX,SEAFILE/
 ,UJ,SEAFILE2
 SEAFILE*:,BSS,1
 SEAFILE/:,BSS,1
C
 ERCOM:,XTA,LFFUN
 13,VJM,DRVOUT
 9,UTM,-1
 9,VZM,ERCOM1
 9,UTM,-1
 9,VZM,ERCOM1
 ,ITA,9
 ,AAX,=377
 ,ASN,64-16
 ,AOX,BLKFUN
 ,AOX,OUTFUN
 13,VJM,DRVOUT
 ERCOM1:,XTA,ERCFUN
 13,VTM,NEXTCOM
 ,UJ,DRVOUT
 ERCFUN:,Z00,42000B
 1,Z20,ERCOMT
 ERCOMT:,ISO,24H^  O{ibKA B KOMAHdE '0'
C
 POSPL:7,VTM,POSSET
 ,UJ,PCOORDP
 POSMI:7,VTM,POSSET
 ,UJ,PCOORDM
 POSSET:14,VTM,-16
 :14,UTC,16
 1,XTA,
 14,UTC,16
 1,ATX,POSTYPE
 14,VLM,POSSET+1
 ,UJ,POSOLD
C
C*** GET POSITION COORDINATE
C
C ANSWER:DISCOM-0 TYPE
C               1 N
C               2 MASK
C            3-16 FRAGMENT
C       TYPE:0 +N
C            1 -N
C            2 +>
C            3 ->
C
 PCOORD:12,UTM,-53B.+
 12,VZM,PCOORDP
 12,UTM,-2.-
 12,V1M,ERCOM
 PCOORDM:,UTC,=1
 PCOORDP:,XTA,
 1,ATX,
 ,XTA,
 1,ATX,1
 1,ATX,2
 1,ATX,3
 14,VJM,GETCH
 ,UZA,POSMAX
 ,ATI,12
 ,A-X,=60
 ,U1A,PCOORDF
 ,A-X,=12
 ,UZA,PCOORDF
 1,MTJ,11
 11,UTM,1
 13,VTM,-5
 PCOORDN:14,VJM,NUMI
 14,VJM,GETCH
 ,ATI,12
 ,UZA,PCOORDN1
 ,A-X,=60
 ,U1A,ERCOM
 ,A-X,=12
 ,UZA,ERCOM
 13,VLM,PCOORDN
 ,UJ,ERCOM
 PCOORDN1:1,XTA,1
 ,A-X,MAXSEAR
 ,UZA,ERCOM
 7,UJ,
 POSMAX:,XTA,MAXSEAR
 ,ASN,64-2
 1,ATX,1
 7,UJ,
 PCOORDF:,ITA,12
 1,ATX,1
 13,VTM,
 1,MTJ,11
 ,XTA,=7777 7777 7777 7777
 11,ATX,2
 11,UTM,3
 PCOORDF1:14,VJM,GETCH
 ,UZA,ERCOM
 ,ATI,12
 1,AEX,1
 ,UZA,PCOORDF2
 13,UTM,1
 14,VTM,PCOORDF1
 ,UJ,HOLL
 PCOORDF2:11,XTA,
 ,UZA,PCOORDF3
 1,XTA,2
 ,ASN,64-8
 1,ATX,2
 12,VTM,
 14,VTM,PCOORDF2
 ,UJ,HOLL
 PCOORDF3:13,VZM,ERCOM
 ,ITA,1
 ,ITS,11
 15,A-X,
 ,A-X,=4
 1,ATX,1
 13,VTM,=2
 PCOORDF4:1,XTA,
 13,AOX,
 1,ATX,
 7,UJ,
C
 POSOLD:,BSS,
 1,XTA,POSTYPE
 ,AAX,=2
 ,U1A,POSOLDF
 1,XTA,POSFL
 ,UZA,NEXTCOM
 1,ATX,LINECNT
 1,XTA,POSTYPE
 ,AAX,=1
 ,UZA,POSPLU0
 1,XTA,LISTFLG
 ,UZA,POSMIN
 ,XTA,ERFUN
 13,VJM,DRVOUT
 ,XTA,CDFUN
 13,VTM,POSMIN
 ,UJ,DRVOUT
 POSPLU0:1,XTA,LISTFLG
 ,UZA,POSPLU
 ,XTA,LFFUN
 13,VJM,DRVOUT
 POSPLU:1,XTA,CNTINP
 ,UZA,DISEOI
 7,VJM,READCD
 1,XTA,LINECNT
 ,ARX,=7777 7777
 ,AAX,=7777 7777
 1,ATX,LINECNT
 7,VTM,POSPLULT
 ,U1A,PUTO
 7,VJM,PUTI
 POSDIS:1,XTA,LISTFLG
 ,U1A,POSDIS0
 ,XTA,LFFUN
 13,VJM,DRVOUT
 POSDIS0:,BSS,
 7,VJM,TOISO
 1,UTC,
 10,VTM,STRING
 ,ITA,10
 13,VTM,COMMAND0
 ,UJ,LINEOUT1
 POSPLULT:1,XTA,LISTFLG
 ,UZA,POSPLU
 ,DISLN,
 ,UZA,POSPLU
 7,VJM,GETO
 7,VTM,COMMAND0
 ,UJ,PUTI
 DISBOI:,UTC,BOIFUN-EOIFUN
 DISEOI:,XTA,EOIFUN
 13,VTM,COMMAND0
 ,UJ,DRVOUT
 BOIFUN:,Z00,42000B
 1,Z20,*+1
 :,ISO,H+'12'--- HA~AlO TEKCTA ---'12'''+
 EOIFUN:,Z00,42000B
 1,Z20,*+1
 :,ISO,H+'12'--- KOHEc  TEKCTA ---'12'''+
 POSMIN:1,XTA,CNTOUT
 ,UZA,DISBOI
 7,VJM,GETO
 7,VJM,PUTI
 1,XTA,CNTOUT
 ,UZA,POSMIN0
 1,XTA,LINECNT
 ,ARX,=7777 7777
 ,AAX,=7777 7777
 1,ATX,LINECNT
 ,U1A,POSMINLT
 POSMIN0:1,XTA,LISTFLG
 ,UZA,POSDIS
 ,XTA,CPRILFUN
 13,VJM,DRVOUT
 ,DISLN,
 ,UJ,POSMINL1
 POSMINLT:1,XTA,LISTFLG
 ,UZA,POSMIN
 ,XTA,CPRILFUN
 13,VJM,DRVOUT
 ,DISLN,
 ,UZA,POSMIN
 POSMINL1:,XTA,CUCUFUN
 13,VTM,COMMAND0
 ,UJ,DRVOUT
 POSOLDF:,BSS,
 ,XTA,
 1,ATX,LINECNT
 1,XTA,POSTYPE
 ,AAX,=1
 ,UZA,POSOLDF0
 1,XTA,LISTFLG
 ,UZA,POSOLDF2
 ,XTA,ERFUN
 13,VJM,DRVOUT
 ,XTA,CDFUN
 13,VTM,POSOLDF2
 ,UJ,DRVOUT
 POSOLDF0:1,XTA,LISTFLG
 ,UZA,POSOLDF1
 ,XTA,LFFUN
 13,VJM,DRVOUT
 POSOLDF1:1,XTA,CNTINP
 ,UZA,DISEOI
 7,VJM,READCD
 1,UTC,
 13,VTM,STRING
 ,ITA,13
 1,MTJ,13
 13,UTM,2
 ,ITS,13
 ,CALL,ISUNP
 ,NTR,3
 1,XTA,LINECNT
 1,UTC,
 5,VTM,POSTYPE
 8,VTM,
 ,UZA,PPFIRST
 7,VJM,LIMAGE
 PPFIRST:  8,V1M,POSOLDF3
 1,XTA,LINECNT
 ,ARX,=1
 1,ATX,LINECNT
 ,AEX,MAXSEAR
 13,VTM,POSOLDF3
 ,UZA,NOTFRAG
 7,VTM,POSOLDF1
 1,XTA,LISTFLG
 ,UZA,PUTO
 ,DISLN,
 ,UZA,PUTO
 POSOLDF3:7,VTM,POSDIS
 ,UJ,PUTI
 POSOLDF2:1,XTA,CNTOUT
 ,UZA,DISBOI
 7,VJM,GETO
 1,UTC,
 13,VTM,STRING
 ,ITA,13
 1,MTJ,13
 13,UTM,2
 ,ITS,13
 ,CALL,ISUNP
 ,NTR,3
 1,XTA,LINECNT
 1,UTC,
 5,VTM,POSTYPE
 8,VTM,
 ,UZA, PMFIRST
 7,VJM,LIMAGE
 PMFIRST:8,V1M,POSOLDF4
 1,XTA,LINECNT
 ,ARX,=1
 1,ATX,LINECNT
 ,AEX,MAXSEAR
 13,VTM,POSOLDF4
 ,UZA,NOTFRAG
 7,VTM,POSOLDF2
 1,XTA,LISTFLG
 ,UZA,PUTI
 7,VJM,PUTI
 ,XTA,CPRILFUN
 13,VJM,DRVOUT
 ,DISLN,
 ,UZA,POSOLDF2
 ,UJ,POSMINL1
 POSOLDF4:1,XTA,LISTFLG
 7,VTM,POSMIN0
 ,U1A,PUTI
 7,VTM,POSDIS
 ,UJ,PUTI
 NOTFRAG:1,XTA,LISTFLG
 13,U1A,
 ,XTA,NOTFFUN
 ,UJ,DRVOUT
 NOTFFUN:,Z00,42000B
 2,Z00,*+1
 :,ISO,H+'12'CPEdi 1024 KAPT ObPAzA HET''+
 CPRILFUN:,Z00,42000B
 ,Z06,=3H'31''27''13'
 CUCUFUN:,Z00,42000B
 ,Z06,=3H'31''31''36'
C
 LIMAGE:,BSS,
 1,MTJ,11
 5,XTA,CO FRAG
 ,AAX,=:776
 14,VTM,-4
 ,ATX,WORD
 :,ASN,64+8
 ,AOX,WORD
 ,ATX,WORD
 14,VLM,*-1
 8,VTM,-13
 LIMAGE2:11,XTA,2
 ,UZA,LIMAGE4
 ,AEX,WORD
 ,ARX,=6H'177''177''177''177''177''177'
 ,AAX,=6H'200''200''200''200''200''200'
 ,AEX,=6H'200''200''200''200''200''200'
 ,UZA,LIMAGE3
 ,ANX,
 ,X-A,=1
 ,ATI,14
 12,VTM,CHECKL
 13,VJM,LEFT
 14,VTM,-8
 12,VTM,LIMAGE2
 ,UJ,LEFT
 LIMAGE3:11,UTM,1
 8,VLM,LIMAGE2
 LIMAGE4:8,VTM,0
 7,UJ,
 LIMAGE5:8,VTM,1
 7,UJ,
 WORD:,BSS,1
C
 LEFT:15,MTJ,9
 10,VTM,-13
 11,MTJ,15
 15,UTM,2
 11,XTA,2
 LEFT1:14,ASN,64
 15,ATX,
 ,YTA,
 15,AOX,-2
 15,STX,-2
 15,XTS,
 ,UZA,LEFT2
 10,VLM,LEFT1
 LEFT2:9,MTJ,15
 12,UJ,
C
 CHECKL:5,XTA,CO FL
 9,VTM,
 11,MTJ,12
 ,UZA,CHECK2
 ,ATI,14
 CHECK1:12,XTA,2
 9,UTC,
 5,AEX,CO FRAG
 13,U1A,
 9,UTM,1
 12,UTM,1
 14,UTM,-1
 14,V1M,CHECK1
 CHECK2:12,XTA,2
 9,UTC,
 5,AEX,CO FRAG
 5,AAX,CO MASK
 ,UZA,LIMAGE5
 13,UJ,
 ,UJ,NEXTCOM
 CALLH :,BSS,
 ANSWER:,BSS,
 1,UTC,
 11,VTM,FILEDEF
 12,VTM,1-FILECNT
 14,VTM,ANSHEAD
 ,ITA,14
 ,AOX,ANSFUN
 13,VJM,DRVOUT
 ANSWER1:11,XTA,FILENAME
 ,UZA,ANSWER2
 ,XTA,LFFUN
 13,VJM,DRVOUT
 ,ITA,11
 ,AOX,ANSFUN
 13,VJM,DRVOUT
 ANSWER2:11,UTM,16
 12,VLM,ANSWER1
 ,UJ,NEXTCOM
 ANSFUN:,Z00,42000B
 3,Z20,
 ANSHEAD:,ISO,H+'12'iMq fAjlA---zAKAz fAjlA-----''+
 LIST  :,BSS,
 ,XTA,=1
 1,ATX,LISTFLG
 12,VZM,POSOLD
 ,UJ,FORLIST
C     INSERT LINES BEFORE CURRENT LINE
 INSERT:,BSS,
 ,XTA,LFFUN
 13,VJM,DRVOUT
 INSLOOP:,BSS,
 14,VTM,-13
 ,XTA,=6H
 :14,UTC,13
 1,ATX,STRING
 14,VLM,*-1
 1,UTC,STRING
 14,VTM,
 ,ITA,14
 ,AOX,INPFUN
 1,AOX,CHAN
 ,*61,-1
 1,ATX,DRVWORD
 INSLOOP0:1,XTA,DRVWORD
 ,AAX,COMPLETE
 13,VTM,INSLOOP2
 ,UZA,SETWAIT
 13,VJM,CLRWAIT
 1,XTA,DRVWORD
 ,AAX,=377
 ,ATI,14
 1,XTA,DRVWORD
 ,ASN,64+16
 ,AAX,=377
 1,ATX,POSCNT
 1,XTA,DRVWORD
 ,AAX,LINEBIT
 ,U1A,INSLOOP1
 14,UTM,-12B
 14,VZM,INSLOOP1
 14,UTM,-15B+12B
 14,VZM,INSLOOP1
 14,UTM,-3B+15B
 14,V1M,INSLOOP
 INSLOOP1:1,XTA,POSCNT
 ,AEX,=1
 ,UZA,INSLOOP3
 7,VJM,WRITECD2
 ,UJ,INSERT
 INSLOOP2:,XTA,STAFUN
 1,AOX,CHAN
 ,*61,-1
 1,ATX,DRVWORD
 ,UJ,INSLOOP0
 INSLOOP3:,BSS,
 7,VJM,GETI
 7,VJM,PUTI
 7,VJM,TOISO
 1,UTC,
 10,VTM,STRING
 ,ITA,10
 13,VTM,COMMAND0
 ,UJ,LINEOUT1
C     DELETE LINES
 DELETE:,BSS,
 7,VJM,PCOORD
 14,VTM,-16
 DELETE1:14,UTC,16
  1,XTA,
 14,UTC,16
 1,ATX,DELTYPE
 14,VLM,DELETE1
 1,XTA,DELTYPE
 ,AAX,=2
 ,U1A,DELETEF
 1,XTA,DELFL
 ,UZA,NEXTCOM
 5,VTM,
 DELETE2:1,ATX,LINECNT
 1,XTA,DELTYPE
 ,AAX,=1
 ,U1A,DELMIN
 DELPLU:1,XTA,CNTINP
 ,UZA,DISEOI
 7,VJM,READCD
 5,VZM,DELPLU1
 1,UTC,
 13,VTM,STRING
 ,ITA,13
 1,MTJ,13
 13,UTM,2
 ,ITS,13
 ,CALL,ISUNP
 ,NTR,3
 8,VTM,
 7,VJM,LIMAGE
 8,V1M,POSDIS
 DELPLU1:1,XTA,LINECNT
 ,ARX,=7777 7777
 ,AAX,=7777 7777
 1,ATX,LINECNT
 ,U1A,DELPLU
 ,UJ,POSDIS
 DELMIN:1,XTA,CNTOUT
 ,UZA,DISBOI
 7,VJM,GETO
 1,XTA,CNTOUT
 ,UZA,POSDIS
 5,VZM,DELMIN1
 1,UTC,
 13,VTM,STRING
 ,ITA,13
 1,MTJ,13
 13,UTM,2
 ,ITS,13
 ,CALL,ISUNP
 ,NTR,3
 8,VTM,
 7,VJM,LIMAGE
 8,V1M,POSDIS
 DELMIN1:1,XTA,LINECNT
 ,ARX,=7777 7777
 ,AAX,=7777 7777
 1,ATX,LINECNT
 ,U1A,DELMIN
 ,UJ,POSDIS
 DELETEF:1,UTC,
 5,VTM,DELTYPE
 ,XTA,MAXSEAR
 ,UJ,DELETE2
 EDIT:,BSS,
 7,VJM,FCOORD
 13,VJM,CLOSE
 ,XTA,
 1,ATX,EDITEND
 1,XTA,
 13,VJM,SEARFILE
 ,UZA,FILEER4
 ,ARX,
 ,UZA,FILEER4
 ,ATI,12
 ,NTR,3
 12,XTA,FILELEN
 ,AAX,=7777
 1,A-X,1
 ,U1A,FILEER6
 ,AEX,
 ,UZA,FILEER6
 1,A-X,2
 ,U1A,FILEER6
 12,XTA,FILELEN
 ,AAX,=7777
 1,ATX,QWARTT
 12,XTA,FILENUM
 ,ASN,64-12
 1,AOX,1
 1,ATX,MNT
 1,XTA,2
 ,AAX,=7777
 1,ATX,MAXT
 1,XTA,PGPNTI
 1,ATX,PGPNTT
 ,ASN,64-20
 1,AOX,MNT
 ,AOX,=:001
 1,ATX,INFT
 ,XTA,
 1,ATX,RCNTT
 ,XTA,=:7777 7777 7777
 1,ATX,IORET
 1,XTA,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 ,AOX,=20000
 13,VJM,CLRSPACE
 ,ITA,2
 1,ATX,OUT1
 1,XTA,CNTOUT
 ,ASN,64-24
 1,XTS,WACNT
 ,AAX,=7777 7777
 15,AOX,
 1,ATX,OUT2
 14,VTM,-7
 :14,UTC,7
 1,XTA,OUTFDB
 14,UTC,7
 1,ATX,SAVINP
 14,VLM,*-2
 ,XTA,=20000
 1,ATX,MNO
 2,VTM,
 3,VTM,
 ,XTA,
 1,ATX,RCNTI
 1,ATX,RCNTO
 1,XTA,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 1,AOX,MNO
 13,VJM,GETW
 ,AOX,SAVUNIT
 1,XTS,PGPNTO
 ,ASN,64-20
 15,AOX,
 1,ATX,INFO
 ,ARX,=:0010 0100
 1,ATX,INFI
 ,XTA,=4000 0000
 1,ATX,CNTINP
 14,VTM,READEDIT
 ,ITA,14
 1,ATX,SWINP
 1,XTA,INFT
 13,VJM,DOI/O
 EDIT1:7,VJM,GETI
 1,UTC,
 13,VTM,STRING
 ,ITA,13
 ,ITS,1
 ,CALL,ISUNP
 ,NTR,3
 ,X-A,=I5
 ,U1A,EDIT2
 1,XTA,EDITEND
 ,U1A,EDIT2
 1,XTA,
 ,AEX,=6H*READ
 ,U1A,EDIT11
 1,XTA,1
 ,AEX,=6HOLD
 ,UZA,EDIT2
 EDIT11:7,VTM,EDIT1
 ,UJ,PUTO
 EDIT2:,XTA,
 1,ATX,SWINP
 1,XTA,CNTINP
 ,AEX,=3777 7777
 ,AAX,=3777 7777
 1,ATX,CNTINP
 3,VTM,
 13,VJM,CLOSE
 1,XTA,INFI
 13,VJM,DOI/O
 14,VTM,-7
 :14,UTC,7
 1,XTA,SAVINP
 14,UTC,7
 1,ATX,OUTFDB
 14,VLM,*-2
 1,XTA,OUT1
 ,ATI,2
 1,XTA,OUT2
 ,AAX,=7777 7777
 1,ATX,WACNT
 1,XTA,OUT2
 ,ASN,64+24
 1,ATX,CNTOUT
 1,XTA,INFO
 ,AOX,=:001
 1,ATX,INFO
 13,VTM,NEXTCOM
 ,UJ,DOI/O
 READEDIT:1,XTA,RCNTT
 ,ARX,=1
 1,ATX,RCNTT
 1,AEX,MAXT
 ,UZA,READED*
 1,XTA,INFT
 ,ARX,=1
 1,ATX,INFT
 1,AEX,QWARTT
 ,AAX,=7777
 ,UZA,READED*
 1,XTA,INFT
 13,VTM,POPU
 ,UJ,DOI/O
 READED*:,XTA,=12
 1,ATX,INPUT
 1,ATX,EDITEND
 ,UJ,POPU
C
C*** BybOPKA pAPAMETPOB EDIT,SAVE
C  OTBET B DISCOM:
C     0 - FILENAME
C     1 - FIRST ZONE
C     2 - FILE FL
C     3 -'CONT'
C     4 - MASK
C
 FCOORD:12,VZM,ERCOM
 12,UTM,-72B.:
 12,V1M,ERCOM
 13,UTM,-6
 ,XTA,
 1,MTJ,11
 11,ATX,
 11,ATX,1
 11,ATX,2
 11,ATX,3
 11,ATX,4
 FCOORD1:14,VJM,GETCH
 ,ATI,12
 ,UZA,FCOORD2
 ,AEX,=54.,
 ,UZA,FCOORD2
 14,VTM,FCOORD1
 13,VLM,HOLL
 ,UJ,FILEER4
 FCOORD2:1,XTA,
 ,UZA,FILEER1.HET iMEHi
 :1,XTA,
 ,AAX,=:776
 ,U1A,FCOORD21
 1,XTA,
 ,ASN,64-8
 ,AOX,=40
 1,ATX,
 ,UJ,*-3
 FCOORD21:12,VZM,FCOORD7
 1,MTJ,11
 11,UTM,1
 13,VTM,-4
 FCOORD3:14,VJM,GETCH
 ,ATI,12
 ,UZA,FCOORD7
 ,AEX,=54.,
 ,UZA,FCOORD4
 ,ITA,12
 ,A-X,=60
 ,U1A,ERCOM
 ,A-X,=10
 ,UZA,ERCOM
 14,VTM,FCOORD3
 13,VLM,NUMB
 ,UJ,ERCOM
 FCOORD4:13,VTM,-4
 11,UTM,1
 FCOORD5:14,VJM,GETCH
 ,ATI,12
 ,UZA,FCOORD7
 ,AEX,=54.,
 ,UZA,FCOORD6
 ,ITA,12
 ,A-X,=60
 ,U1A,ERCOM
 ,A-X,=10
 ,UZA,ERCOM
 14,VTM,FCOORD5
 13,VLM,NUMB
 ,UJ,ERCOM
 FCOORD6:11,UTM,1
 :14,VJM,GETCH
 ,ATI,12
 ,UZA,FCOORD7
 14,VTM,FCOORD6+1
 ,UJ,HOLL
 FCOORD7:,XTA,=7777 7777 7777 7777
 1,ATX,4
 1,XTA,3
 7,UZA,
 FCOORD8:,AAX,=:776
 7,U1A,
 1,XTA,4
 ,ASN,64-8
 1,ATX,4
 1,XTA,3
 ,ASN,64-8
 1,ATX,3
 ,UJ,FCOORD8
 TABULATE:12,VZM,ERCOM
 12,UTM,-72B.:
 12,V1M,ERCOM
 ,XTA,
 1,ATX,
 1,ATX,1
 1,ATX,2
 1,ATX,3
 1,MTJ,11
 TABUL1:13,VTM,-2
 ,XTA,
 11,ATX,
 TABUL2:14,VJM,GETCH
 ,ATI,12
 14,VTM,TABUL4
 ,UZA,TABUL3
 ,AEX,=54.,
 14,VTM,TABUL1
 ,UZA,TABUL3
 ,ITA,12
 ,A-X,=60
 ,U1A,ERCOM
 ,A-X,=12
 ,UZA,ERCOM
 14,VJM,NUMI
 13,VLM,TABUL2
 ,UJ,ERCOM
 TABUL3:11,XTA,
 14,UZA,
 1,A-X,3
 ,U1A,TABUL30
 11,XTA,
 1,ATX,3
 TABUL30:11,XTA,
 ,A-X,=50.40 pOz.
 ,U1A,TABUL31
 ,XTA,=:001
 11,WTC,
 ,ASN,64-40
 1,AOX,2
 1,ATX,2
 14,UJ,
 TABUL31:,XTA,=:001
 11,WTC,
 ,ASN,64
 1,AOX,1
 1,ATX,1
 14,UJ,
 TABUL4:1,XTA,1
 1,ATX,TABEDIT
 1,XTA,2
 1,ATX,TABEDIT+1
 1,XTA,3
 1,ATX,MAXPNT
 ,UJ,NEXTCOM
C
 SCREMAX:12,VZM,ERCOM
 12,UTM,-72B.,
 12,V1M,ERCOM
 13,VTM,-2
 1,MTJ,11
 ,XTA,
 11,ATX,
 SCREMAX1:14,VJM,GETCH
 ,ATI,12
 ,UZA,SCREMAX2
 ,A-X,=60
 ,U1A,ERCOM
 ,A-X,=12
 ,UZA,ERCOM
 14,VJM,NUMI
 13,VLM,SCREMAX1
 ,UJ,ERCOM
 SCREMAX2:11,XTA,
 ,U1A,*+2
 ,XTA,=120
 :1,ATX,DISMAX
 ,UJ,NEXTCOM
C
C*** CLOSE OUTPUT FILE
C
 CLOSE:,ITA,13
 1,ATX,LINERET
 14,VTM,-7
 :14,UTC,7
 1,XTA,OUTFDB
 14,UTC,7
 1,ATX,TEMFDB
 14,VLM,*-2
 ,ITA,2
 1,ATX,TEM2
 1,XTA,CNTOUT
 ,ASN,64-24
 1,XTS,WACNT
 ,AAX,=7777 7777
 15,AOX,
 1,ATX,TEM1
 ,XTA,=6H*READ
 1,ATX,STRING
 ,XTA,=6HOLD'312''12''12'
 1,ATX,STRING+1
 7,VJM,PUTO
 7,VJM,PUTO
 2,VZM,CLOSE1
 1,XTA,INFO
 ,AOX,=:001
 ,AEX,=:001
 13,VJM,DOI/O
 CLOSE1:14,VTM,-7
 :14,UTC,7
 1,XTA,TEMFDB
 14,UTC,7
 1,ATX,OUTFDB
 14,VLM,*-2
 1,XTA,TEM2
 ,ATI,2
 1,XTA,OUT1
 ,AAX,=7777 7777
 1,ATX,WACNT
 1,XTA,OUT1
 ,ASN,64+24
 1,ATX,CNTOUT
 1,XTA,INFO
 1,ATX,OUT2
 ,AOX,=:001
 1,ATX,INFO
 13,VJM,DOI/O
 1,XTA,OUT2
 1,ATX,INFO
 1,WTC,LINERET
  ,UJ,
 ENDRUN:1,XTA,SAVEFL
 ,UZA,ENDRUND
 ENDRUN1:,BSS,
 14,VTM,1-FILECNT
 1,UTC,
 12,VTM,FILEDEF
 ,XTA,
 1,ATX,
 ENDRUN2:12,XTA,FILENAME
 ,UZA,ENDRUN3
 ,XTA,=:4
 12,WTC,FILENUM
 ,ASN,64-30B
 1,AOX,
 1,ATX,
 ENDRUN3:12,UTM,16
 14,VLM,ENDRUN2
 1,XTA,
 ,*57,4000B.RETURN FILES
 ,XTA,=:777777
 1,ATX,IORET
 1,XTA,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 13,VJM,CLRSPACE
 ,XTA,GOODFUN
 13,VJM,DRVOUT
C*** DROP CHANNEL
 ,XTA,DRPFUN
 1,AOX,CHAN
 ,*61,-1
 ,ITA,1
 ,A-X,FIRSTBL
 ,ASN,64+10
 ,ATI,14
 ,XTA,=:4
 14,ASN,64
 ,AOX,CHANCNT
 ,ATX,CHANCNT
 ,XTA,REQCONCH
 ,*61,-1
  ,AAX,MASK61
 ,AOX,INITCHAN
 ,U1A,MLOOP2
 ,*50,70217B
  ,AAX,=:4
 ,U1A,MLOOP4
 ,*62,.DROP EDITOR
 ENDRUND:,XTA,=1
 1,ATX,SAVEFL
 ,XTA,NOTSAVED
 13,VTM,NEXTCOM
 ,UJ,DRVOUT
 GOODFUN:,Z00,42000B
 1,Z20,*+1
 :,ISO,H+'12' K O H E c'12'''+
 NOTSAVED:,Z00,42000B
 1,Z20,*+1
 :,ISO,H+'12' A gdE KOMAHdA SAVE ?''+
C
C*** CLEAR USER'S FILE IN SPACE CATALOG
C
 CLRSPACE:1,ATX,IOWORD
 12,VTM,CATPNT
 14,VTM,-1023
 CLRSPAC1:14,UTC,1023
 12,XTA,
 13,UZA,
 1,AEX,IOWORD
 1,AAX,IORET
 ,U1A,CRLSPAC2
 ,XTA,=:4
 14,UTC,1023
 12,ATX,
 CRLSPAC2:14,VLM,CLRSPAC1
 13,UJ,
 RETURN:,BSS,
 12,VZM,ERCOM
 12,UTM,-72B
 12,V1M,ERCOM
 RETURN0:13,VTM,-6
 1,MTJ,11
 ,XTA,
 11,ATX,
 RETURN1:14,VJM,GETCH
 ,ATI,12
 ,UZA,RETURN4
 ,AEX,=54
 ,UZA,RETURN3
 14,VTM,RETURN1
 13,VLM,HOLL
   ,UJ,FILEER4
 RETURN2:1,XTA,
 13,UZA,
 :1,XTA,
 ,AAX,=:776
 13,U1A,
 1,XTA,
 ,ASN,64-8
 ,AOX,=40
 1,ATX,
 ,UJ,*-3
 RETURN3:13,VJM,RETURN2
 1,XTA,
 ,UZA,RETURN0
 13,VJM,SEARFILE
 ,UZA,RETURN0
 ,ARX,
 ,UZA,RETURN0
 RETURN5:,ATI,12
 ,XTA,=:4
 12,WTC,FILENUM
 ,ASN,64-30B
 ,*57,4000B
  ,XTA,
 12,ATX,FILENAME
 13,V1M,RETURN0
 ,UJ,ANSWER
 RETURN4:13,VJM,RETURN2
 1,XTA,
 ,UZA,ANSWER
 13,VJM,SEARFILE
 ,UZA,ANSWER
 ,ARX,
 ,UZA,ANSWER
 13,VTM,
 ,UJ,RETURN5
 USE   :,BSS,
      ,UJ,TEACH
 SAVE:,BSS,
 7,VJM,FCOORD
 13,VJM,CLOSE
 1,XTA,
 13,VJM,SEARFILE
 ,UZA,FILEER4
 ,ARX,
 ,UZA,FILEER4
 ,ATI,12
 ,NTR,3
 12,XTA,FILELEN
 ,AAX,=7777
 1,A-X,1
 ,U1A,FILEER6
 ,AEX,
 ,UZA,FILEER6
 1,A-X,2
 ,U1A,FILEER6
 12,XTA,FILENUM
 ,ASN,64-12
 1,AOX,1
 1,ATX,MNT
 12,XTA,FILELEN
 ,AAX,=7777
 1,ATX,QWARTT
 12,XTA,FILEREG
 ,AEX,=1HW
 ,U1A,FILEER7
 1,XTA,2
 ,U1A,SAVE20
 ,XTA,=3777
 SAVE20:1,ATX,MAXT
 1,XTA,CHANINIT
 ,ASN,64-30
 ,AAX,=:077777
 ,AOX,=10000
 1,ATX,RCNTT
 1,XTA,PGPNTO
 1,ATX,PGPNTT
 ,ASN,64-20
 15,ATX,
 1,AOX,MNT
 1,STX,MNT
 ,AOX,SAVUNIT
 ,AOX,=:001
 1,ATX,TEM1
 SAVE3:1,XTA,RCNTT
 13,VJM,GETR
 ,UZA,SAVE5
 1,AOX,TEM1
 1,ATX,INFT
 13,VJM,DOI/O
 1,XTA,MAXT
 ,UZA,SAVE4
 ,ARX,=7777
 ,AAX,=7777
 1,ATX,MAXT
 1,XTA,MNT
 1,ATX,INFT
 ,AAX,=7777
 1,AEX,QWARTT
 ,UZA,SAVE4
 1,XTA,INFT
 13,VJM,DOI/O
 1,XTA,RCNTT
 ,ARX,=1
 1,ATX,RCNTT
 1,XTA,MNT
 ,ARX,=1
 1,ATX,MNT
 ,UJ,SAVE3
 SAVE4:,BSS,
 ,XTA,LTLFUN
 13,VJM,DRVOUT
 SAVE5:,BSS,
 1,XTA,RCNTT
 ,ASN,64-36
 ,AUX,=6H'7''7''7''7'''''
 ,AOX,=6H0000 '177'
 ,ATX,SAVFUN+3
 ,XTA,SAVFUN
 13,VJM,DRVOUT
 1,XTA,INFO
 1,ATX,OUT2
 ,AOX,=:001
 1,ATX,INFO
 13,VJM,DOI/O
 1,XTA,OUT2
 1,ATX,INFO
 ,XTA,=1
 1,ATX,SAVEFL
 ,UJ,NEXTCOM
 SAVFUN:,Z00,42000B
 1,Z20,*+1
 :,ISO,H+'12'  zApiCAHO 0000 '177'zOH''+
 LTLFUN:,Z00,42000B
 1,Z20,*+1
 :,ISO,H+'12'  MAlO MECTA''+
 TEACH :,BSS,
 OPENH:,BSS,
 CLOSEH:,BSS,
 ,XTA,DUMFUN
 13,VTM,NEXTCOM
 ,UJ,DRVOUT
 DUMFUN:,Z00,42000B
 ,Z14,=6H'12'O.K.
 NEXTCOM:,XTA,LFFUN
 13,VJM,DRVOUT
 ,UJ,COMMAND0
C
C*** {KAlA KAHAlOB vdY}iX ObMEHA
C
 WAITI/O:,OCT,
C
C*** {KAlA KAHAlOB vdY}iX |61,-1
 WAITDRV:,OCT,
C
C*** {KAlA pPiBqzAHHyX KAHAlOB
 CONCHAN:,OCT,
C
C*** CCylKi HA diCKPipTOPy KAHAlOB
 CHANPNT:,BSS,24
 CHANCNT:,OCT,44444444
C
C*** MAKCiMAlxHOE ~iClO fAjlOB = 4
 MASK:,OCT,
 CDFUN:,Z00,42000B
 ,Z02,=1H'32'
 LFFUN:,Z00,42000B
 ,Z02,=1H'12'
 CDPRFUN:,Z00,42000B
 ,Z04,=2H'32''27'
 INPFUN:,Z00,41400B
 5,Z00,
 INP1FUN:,Z00,40400B
 ,Z00,
 WAITFUN:,Z00,45400B
 ,Z00,
 REQCONCH:,Z00,47400B
 ,Z00,
 ERFUN:,Z00,42000B
 ,Z02,=1H'37'
 STAFUN:,Z00,03400B
 ,Z00,
 OUTFUN:,Z00,42000B
 ,Z00,
 PRDLFUN:,Z00,42000B
 ,Z04,=2H'27''36'
 ,Z02,=1H'36'
 ILFUN:,Z00,42000B
 ,Z02,=1H'13'
 PRILFUN:,Z00,42000B
 ,Z04,=2H'13''27'
 CUFUN:,Z00,42000B
 ,Z02,=1H'31'
 HMFUN:,Z00,42000B
 ,Z02,=1H'14'
 CONFUN:,Z00,44000B
 ,Z00,
 DRPFUN:,Z00,04400B
 ,Z00,
 TABFUN:,Z00,02400B
 ,Z00,
 CTRLFUN:,Z00,03000B
 ,Z00,=:77477774714
 COMFUN:,Z00,42000B
 ,Z06,=3H'14''31''36'
 HASHFUN:,Z00,42000B
 ,Z02,=1H#
 CINPFUN:,Z00,41400B
 5,Z00,COMMBF
 LINE:,BSS,14
 BLKFUN:,,
 ,Z00,BLK80
 BLK80:,ISO,80H
 ,END,
 EPRT1:,NAME,
 PRINT8//:,SUBP,
 ,ITA,13
 ,UTC,I13
 ,ATX,
 13,VJM,PRINT8//+1
 ,WTC,I13
 ,UJ,
 I13:,BSS,1
 ,END,
 ERONEZ:,NAME,
C
C     BydA~A O{ibOK pO Ml i dp
C     zA OdiH ByzOB BydA`TCq O{ibKi OdHOj zOHy
C
C     ObPA}EHiE CALL ERONEZ(IBX,IEND)
C     IBX=1-HA~AlO, BydABATx iz MlO{
C     IBX=2-HA~AlO, BydABATx iz MdO{
C     IBX=0-BydABATx C TEKY}EgO MECTA
C     IEND-BOzBPA}AEMyj pAPAMETP
C     IEND=1-TAblicA iC~EPpAHA
C     IEND=0-HET
C
 *TABLE*:LC,BLOCK,(3304),MlCb,MlO{(5000),MdCb,MdO{(5000)
 *XAPMld*:LC,BLOCK,NMf,NZON,KO{(9),KHAPb
 *ONE*:LC,BLOCK,(5),NAMl
 C:8,BASE,*
 9,VTM,
 BEGIN:,STX,IEND
 ,ATI,10.IBX
 ,NTR,3
 11,VTM,-3
 LSAV:11,ITA,1+3
 11,ATX,SAVM+3
 11,VLM,LSAV
 ,ITA,9
 ,ATX,FLERN.Tip ENTRY
 10,XTA,
 ,ATI,10
 10,MTJ,12
 10,VZM,CONT.IBX=0
 ,ATX,FLMl/Md.Tip Ml ili dp
 CHMld:10,UTM,-1
 10,V1M,DISC.O{ibKi pO dp
 1,VTM,MlO{
 2,VTM,MlCb
 ,XTA,=6.KOli~ECTBO BOzMOvHyX
 ,ATX,LO{.O{ibOK.
 2,XTA,
 ,UJ,BEGJ
 CONT:,BSS,.pPOdOlvEHiE C
 ,XTA,FLMl/Md.TEKY}EgO MECTA.
 ,ATI,10
 ,UJ,CHMld.HA YCTAHOBKY.
 DISC:1,VTM,MdO{
 2,VTM,MdCb
 ,XTA,=11
 ,ATX,LO{
 2,XTA,
 BEGJ:1,MTJ,4.YKAzATElx pO TAblicE.
 ,ATI,9.C~ET~iK TAblicy.
 9,VZM,RETEND.TAblicA pYCTA.
 12,VZM,CONT1.IBX=0
 ,XTA,FLERN.pPi{li iz
 ,U1A,pOiMEHi. ERMld.
C     pEPECylKA iMEHi Ml ili dp
 TNAME:4,XTA,
 ,UTC,NAMl
 ,ATX,
 4,UTM,1
C     pEPECylKA N Mf i HAPAbOTKi
 TNMf:,BSS,
 4,XTA,
 ,AAX,=777.KOl.-BO ClOB
 ,ATX,CO{. C O{ibKAMi.
 4,XTA,
 ,ASN,64-7
 ,ASN,64+16
 ,AOX,=I0
 ,UTC,KHAPb
 ,ATX,.HAPAbOTKA
 4,XTA,
 ,ASN,64+41
 ,AAX,=77
 ,AOX,=I0
 ,UTC,NMf
 ,ATX,.N Mf ili dM.
 ,ITA,4
 ,ATX,ADRMf
 4,UTM,1
 ZTFZ:,XTA,.flAg 1-Oj O{ibKi
 ,ATX,FZON.HA zOHE.
 ,WTC,LO{
 9,VTM,
 10,VTM,
 ,XTA,=I0
 LTZ:,UTC,KO{
 10,ATX,
 9,UTM,-1
 10,UTM,1
 9,V1M,LTZ
 ,UTC,NZON
 ,ATX,
 CHCO{:,XTA,CO{.HA dAHHOM YCTPOjCTBE
 ,UZA,EXO{.iC~EPpAli BCE O{ibKi.
 ,A-X,=1
 ,ATX,CO{
 ,XTA,FZON
 ,U1A,NOFZ
 4,XTA,
 ,AAX,=1777
 ,AOX,=I0
 ,UTC,NZON
 ,ATX,
 ,ATX,FZON
 ,UJ,PACp
 NOFZ:4,XTA,
 ,UTC,NZON
 ,AEX,
 ,AAX,=1777.
 ,UZA,PACp.TA vE zOHA
C     pO{li O{ibKi dPYgOj zOHy
 ,XTA,CO{.
 ,ARX,=1.BOCCTAHOBlEHiE
 ,ATX,CO{.C~ET. O{.ClOB
 ,UJ,EXO{.
C     PACpAKOBKA i pEPECylKA O{ibOK.
 PACp:9,VTM,-2
 4,XTA,
 ,ASN,64+10
 LPACp:,ATX,R
 ,AAX,=17
 ,UZA,ELPp.bOlx{E HET.
 ,ATI,11.HOMEP O{ibKi.
 ,X-A,LO{
 ,U1A,~Y{x
 ,XTA,R
 ,ASN,64+4
 ,AAX,=377
 ,UTC,KO{
 11,ARX,-1
 ,UTC,KO{
 11,ATX,-1
 ~Y{x:,BSS,
 ,XTA,R
 ,ASN,64+12
 9,VLM,LPACp
 ELPp:4,UTM,1. HA PACpAKOBKY
 ,UJ,CHCO{. ClEdY`}EgO ClOBA.
C     iC~EPpAHy O{ibKi OdHOj zOHy
C     YCTAHOBKi dlq ClEdY`}EgO BXOdA
 EXO{:9,VTM,ZTFZ.
 ,XTA,CO{.ECTx E}E
 ,U1A,RET2.O{ibKi.
 9,VTM,TNMf
 ,WTC,ADRMf
 ,XTA,
 ,ARX,.O{ibKi HA ClEdY`}EM
 ,U1A,RET2.YCTPOjCTBE.
 9,VTM,TNAME.O{ibKi dAHHOj
 ,XTA,FLERN.Ml(dp) iC~EPpAHy.
 ,U1A,RETEND.dlq ERNMld KOHEc.
 14,VJM,CHCNT
 ,U1A,RETEND.TAblicA iC~EPpAHA.
 RET2:,XTA,=I0
 ,UJ,RET1
 RETEND:,XTA,=I1
 RET1:,WTC,IEND
 ,ATX,
 ENDJ:,ITA,4.dlq
 ,ATX,ADRCONT.bYdY}EgO.
 ,ITA,9
 ,ATX,TipCONT
C     BOzBPAT iz pOdpPOgPAMMy.
 RET:11,VTM,-3
 ,NTR,6
 LRSV:11,XTA,SAVM+3
 11,ATI,1+3
 11,VLM,LRSV
 ,STX,
 13,UJ,
C     pPOdOlvEHiE C TEKY}EgO MECTA
 CONT1:,XTA,ADRCONT
 ,ATI,4
 14,VJM,CHCNT
 ,U1A,RETEND
 ,WTC,TipCONT
 ,UJ,
C     pPOBEPKA iC~EPpAHiq TAblicy.
 CHCNT:,ITA,4
 ,ITS,1
 15,X-A,
 ,ARX,=1
 ,AOX,=I0
 2,X-A,
 14,UJ,
C
 ERNMld:,ENTRY,
C
C     BydA~A O{ibOK dlq OdHOj Ml(dp) pO NAMl.
C     ByzOB CALL ERNMld(IBX,IEND)
C     IBX,IEND TE vE,~TO B glABHOM BXOdE.
C     dOpOlHiTElxHO IEND=-1,ECli Ml(dp) HE HAjdEHA
C
 8,BASE,C
 9,VTM,1
 ,UJ,BEGIN
C     pOiCK Ml ili dp B TAblijE.
 pOiMEHi:4,XTA,
 ,UTC,NAMl
 ,AEX,
 ,UZA,TNAME.HA{li
 4,UTM,1
 LMf:4,XTA,.KOl-BO ClOB
 ,AAX,=777.C O{ibKAMi
 ,ATI,9
 4,MTJ,10
 4,UTM,1
 LERR:9,VZM,ELER.BCE O{ibKi
 4,UTM,1
 9,UTM,-1
 ,UJ,LERR
 ELER:10,XTA,
 ,ARX,
 ,U1A,LMf.ClEd.YCTPOjCTBO
 14,VJM,CHCNT
 ,UZA,pOiMEHi.ClEd. Ml ili dp
 ,XTA,=I-1.HE HA{li
 ,WTC,IEND
 ,ATX,
 ,UJ,RET
 IEND:,BSS,1
 SAVM:,BSS,4
 FLERN:,BSS,1
 FLMl/Md:,BSS,1
 LO{:,BSS,1
 CO{:,BSS,1
 ADRMf:,BSS,1
 FZON:,BSS,1
 R:,BSS,1
 ADRCONT:,BSS,1
 TipCONT:,BSS,1
 ,END,
 EXCH:,NAME,.
 *PARAM*:LC,BLOCK,(1),MT
 *PAGE *:PC,BLOCK,LI(0),NZS(1024),NZF(1024),NAMS(1024)
 NP:,P/P,(LI)16
 MP:,P/P,(LI)1024
 C:8,BASE,*.
 ,ATI,14.~T/zp
 14,XTA,.
 ,ASN,64-39.
 ,AOX,INF0.
 ,STX,INF.
 ,ATI,14.N zOHy
 14,WTC,.
 14,VTM,.
 ,ITA,14.
 ,AOX,INF.
 ,XTS,MT.
 ,ASN,64-12.
 15,AOX,.
 ,ATX,INF.
 ,TAPE,INF.
 ,STX,.
 13,UJ,.
  INF0:2,004,NP
 ,,.
 INF:,BSS,1.
 RNAM:,ENTRY,.
 8,BASE,C.
 ,ATI,9.
 9,WTC,.
 9,VTM,-1.
 ,XTA,MT.
 ,ASN,64-12.
 ,AOX,INF0.
 ,AOX,=:005.
 ,ATX,INF.
 ,TAPE,INF.
 9,ATX,NAMS.
 ,*63,504B.
 ,ATI,10.
  ,*63,505B
  ,ITS,10
  15,ARX,
  ,ASN,64+1.AdPEC T2MT
  ,ATI,10
  ,WTC,MT
  10,*63,-30B.T2MT
 ,ATX,INF.
 ,ARX,=7770.
 ,AAX,=7777.
 ,AOX,=I0.
 9,ATX,NZF.
 ,XTA,INF.
 ,ASN,64+12.
 ,ARX,=7770.
 ,AAX,=7777.
 ,AOX,=I0.
 9,STX,NZS.
 13,UJ,.
 PAUSE:,ENTRY,.
 ,*57,3.
 13,UJ,.
 TIM:,ENTRY,.
 8,BASE,C.
 ,*63,542B.
 ,NTR,2.
 ,A+X,=:4.
 13,UJ,.
 MEX:,ENTRY,.
 8,BASE,C.
 ,*76,CHE.
 ,AOX,=I0.
 13,UJ,.
 CHE:14,REL,*.
 ,WTC,502B.
 ,WTC,.
 9,VTM,.
 9,XTA,30B+MP.
 ,ASN,64+30.
 ,AAX,=177
 ,ATI,9.
 9,VZM,CH1.
 ,WTC,503B.
 9,XTA,.
 ,ASN,64+6.
 ,AAX,757B.
 CH1:,MTJ,27B.
 2,IJ,.
 gTzp:,ENTRY,.
 8,BASE,C.
 ,STI,9.
 9,WTC,.
 9,VTM,.zp/~T
 ,ATI,11.
 11,XTA,.
  ,ATI,10.N Mf
  ,*63,505B
  ,ATI,11
  10,UTC,-30B
  11,*63,.iMq Ml
  ,*57,400B
  ,ASN,64+46
  ,ATX,SC
  ,AAX,=1
  ,UIA,END
  9,VIM,END
  ,XTA,SC
  ,AAX,=2
  END:,AOX,=I0
 13,UJ,.
 SC:,BSS,1.
 ,END,.
 FICT:,NAME,
 ,BSS,70B
 ,END,
 FIT:,NAME,
 12,VTM,
 BEG:,ATI,14
 14,XTA,
 12,VIM,ERRT
 ,AAX,=:776
 ANX:,ANX,
 ,AOX,=I0
 13,UJ,
 ERRT:,ASN,64+5
 ,ASN,64-39
 ,UJ,ANX
 FITERR:,ENTRY,
 12,VTM,1
 ,UJ,BEG
 FUN71B:,ENTRY,
 ,FUN,71B
 13,UJ,
 ,END,
 FIXE:,NAME,.
 *PAGE*:,PC,1024.
 NP:,P/P,(*PAGE*)1024
 ADTRAPHY:,EQU,513B
 *LINK*:LC,BLOCK,DNAME,NCH,NMOD,NPATH
 ,CONT,IF,(1),KOPC
 ,XTS,=3053 4576 1634 0112
 ,*76,1.
 11,VTM,NP.MAT.N liCTA
 ,*63,503B.
 ,ATI,9.AdP.TPHYS
 ,*76,FIX.
 ,ITA,8.
 ,ASN,64+7
 ,YTA,.fiz.N liCTA
 ,AUX,=1 4037 0000
 ,AOX,=10 0100 0064
 ,STX,CINF.
 ,NTR,6.
 13,UJ,.
 WRITE:,ENTRY,.
 ,XTS,CINF.
 ,AEX,=1
 ,UJ,GRW.
 WRCOMP:,ENTRY,
 ,XTS,CINF
 ,UJ,GRW
 READ:,ENTRY,.
 ,XTS,CINF.
 ,AEX,=40 0006
 GRW:13,MTJ,8
 ,XTS,NCH
 ,AAX,=4.(HApPABl.-3)*4
 ,ASN,64-9
 15,AOX,
 ,XTS,NMOD.HOMEP MOdYlq
 ,ASN,64-7.
 15,AOX,
 ,XTS,NPATH.HOMEP dOPOvKi
 ,ASN,64-25
 15,ARX,
 ,ATX,INF.
 ,NTR,6.
 ,*76,TOTRA.
 15,ATX,
 ,YTA,
 ,APX,=70377 7417
 ,ASN,64+29
 ,AOX,=I0
 ,XTS,INF
 ,AAX,=7
 ,ASN,64-19
 15,AOX,
 ,STX,KOPC
 ,UZA,RETT
 ,XTA,=I1
 RETT:,STX,IF
 8,UJ,.
 COMP:,ENTRY,
 ,XTS,CINF
 ,AEX,=7
 ,UJ,GRW
 CRHEAD:,ENTRY,
 ,XTS,CINF
 ,AEX,=140 0005
 ,UJ,GRW
 TOTRA:14,REL,*.
 13,VTM,INF.
 ,WTC,ADTRAPHY.
 14,VJM,.
 RETMAC:,BSS,
 ,MTJ,27B.
 2,IJ,.
 FIX:14,REL,*
 ,WTC,502B
 ,XTA,.gYC
 ,ATI,10.AdP. ipz
 ,ITA,14.
 ,ASN,64+10.
 ,ATI,8.
 9,J+M,8.
 ,XTA,=1.
 8,AOX,.
 8,ATX,.
 ,24,2000B.
 ,XTA,*PAGE*
 ,24,2003B.
 10,UTC,30B.
 11,XTA,.
 ,ASN,64+30.
 ,ATI,8.fiz.HOMEP
 8,J+M,9.
 ,XTA,=1.
 9,AOX,.
 9,ATX,.
 ,UJ,RETMAC
 CINF:,BSS,1.
 INF:,BSS,1.
 ,END,.
 FORMPAR:,NAME,
C      fOPMiPOBAHiE pAPAMETPOB
C      iz TEKCTA TT i I1
 ,ITA,13
 ,ATX,SI13
 ,ITA,1
 ,ATX,SI1
 1,VTM,0.gA{EHiE
 ,CALL,OCTPARAM
 ,ITA,1
 ,ASN,64-3
 ,AOX,SI1
 ,ATI,1
 ,UJ,EPAR
 PARAM:,ENTRY,
C          fOPMiPOBAHiE pAPAMETPOB
C               iz I1
 *PAR*:LC,BLOCK,ID,ID1
 ,ITA,13
 ,ATX,SI13
 EPAR:,BSS,
 ,ITA,1
 ,ASN,64+3
 ,AOX,=I0
 ,UTC,ID1.
 ,ATX,.
 ,ITA,1
 ,AAX,=7.
 ,ARX,=I0
 ,UTC,ID
 ,ATX,
 ,WTC,SI13
 ,UJ,
 13,UJ,
 SI1:,BSS,1
 SI13:,BSS,1
 ,END,
 FTTPR2:,NAME,
C
C*****   pE~ATx HA OpEP. TPMiHAlE
C******   C gA{EHiEM XBOCT. pPObElOB
C******   ObPA}EHiE:
C******    CALL FTTPR2(TXT,L,IBL)
C******    TXT-TEKCT
C******      L-dliHA TEKCTA
C******    IBL-pPizHAK blOKiPOBKi zApi-
C******        Ci TEKCTA B DAYFILE
C******        (0-zApiCx,1-HET)
C
C
 MN*TL:,EQU,1067B
 *9:,BLOCK,B,N,A,T
C--------
 BAS:B,BASE,BAS
 ,STI,T
 ,STI,N
 N,WTC,
 N,VTM, .dliHA TEKCTA
 ,ATI,A. AdPEC
 T,XTA,
 ,ASN,64-39
 ,AOX,MN*TL
 ,ATX,NUMTL
 T,VTM,BUF
 TRAN:N,VZM,TRAN 1. pEPEpiCx TEKCTA
 A,XTA, .BO BHYTPEH.
 T,ATX,.bYfEP
 T,UTM,1
 N,UTM,-1
 A,VLM,TRAN
 TRAN 1:,XTA,
 T,ATX,
 TR 1:T,UTM,-1.YPEzAHiE
 T,XTA,.cElyX ClOB
 ,AEX,FULBLN
 ,UIA,TR 2
 T,ATX,
 ,UJ,TR 1
 TR 2:,ATX,WS.YPEzAHiE
 ,AAX,C377.pPObElOB
 ,UIA,TR 3.B pOCl.ClOBE
 ,XTA,WS
 ,ASN,64+8
 N,UTM,-8
 ,UJ,TR 2
 TR 3:,XTA,FULBLN
 N,ASN,64+48
 T,AEX,
 T,ATX,
 T,VTM,BUF
 ,ITA,T
 ,AOX,NUMTL
 ,FUN,76B
 ,STX,
 13,UJ,. BOzBPAT
 OPTTPR:,ENTRY,.KAdAHcEB
 ,STI,.
 VTPRI:,ENTRY,.KAdAHcEB C`dA XOdiT
 14,VTM,=I1
 ,ITS,14.
 ,UJ,BAS.
 FTTPRI:,ENTRY,.A C`dA XOdqT TOlpAMi
 ,XTS,.
 ,UJ,BAS.
 FUL BLN:,ISO,6H
 C377:,LOG,377
 WS:,BSS,1
 BUF:,BSS,25
 NUMTL:,BSS,1
 ,END,
 GEN*GR*C:,NAME,.lBb 25.11
 PAGEBG:PC,BLOCK,LIST(1024)
C  |lEMEHTy  X01-X77B (X=0,1,2)
C  BCEgO (64-1) * 3 ~ACTi = 189
C  zOHy 1-777B
 SCFRC:,EQU,LIST+1720B
 SCFRZ:,EQU,LIST+1740B
 LASTW:,EQU,LIST+1775B
 MARK:,EQU,LIST+1777B
 |K*57:,SUBP,
 ,ITA,13
 ,XTS,PP
 ,AOX,=:12
 ,ATX,W CAT
 ,XTA,PP
 ,AOX,=:06.~T.KAT
 14,VJM,|K*57
 13,VTM,-1023
 ,XTA,.HYliM KAT
 L:13,ATX,LIST+1023
 13,VLM,L
 13,VTM,-15.gEHEP.{KAl
 14,VTM,-16
 L CZ:14,UTM,16.*20B
 ,ITA,14
 ,AAX,=300
 ,AEX,=300
 ,UZA,ONLY ZON
 ,ITA,14
 ,AOX,=:77777 4.48-33
 13,ATX,SCFRC+15
 ONLY ZON:,BSS,
 ,ITA,14
 ,ASN,64-1.*40B
 ,AOX,=:7777 7777 776.48-17
 13,ATX,SCFRZ+15
 13,VLM,LCZ
 14,VTM,1720B
 ,ITA,14
 ,ATX,LASTW.POINT |l.KAT
 14,VTM,1740B
 ,ITA,14
 ,ATX,LASTW+1.POINT zOH
C blOKiPOBKA ClYv.:
 ,XTA,SCFRC
 ,AAX,Z48
 ,ATX,SCFRC.HE iCp.
 ,XTA,SCFRC+4
 ,AAX,Z48
 ,ATX,SCFRC+4
 ,XTA,SCFRC+10B
 ,AAX,Z48
 ,ATX,SCFRC+10B
 ,XTA,SCFRZ
 ,AAX,Z48
 ,ATX,SCFRZ.dlq KAT.
 ,XTA,=6HD78OUT.iMq
 ,ATX,MARK
 ,XTA,W CAT
 15,WTC,
 14,VTM,
 ,UJ,|K*57.BOzBPAT pO iP14
 PP:,Z00,
 ,Z00,LIST
 Z48:,LOG,3777 7777 7777 7777
 W CAT:,BSS,1
 ,END,
 GENJOB:,NAME,.07.05.79
C
C
C FLO{=/=0 - O{ibKi B pACpOPTE zAdA~i OC diCpAK
  *pACp*:LC,BLOCK,FLO{
 ,CONT,(1)
 ,CONT,{(2)
 ,CONT,ITIME.TEKCT ~~MMCC
 ,CONT,IPAGE.TEKCT METPy AcpY
 ,CONT,MTABLE(32)
C 1-OE ClOBO - 30, 32-OE - 67 MAT.HOMEPAM  Y
C 48-41PP - W-ECTx zApiCx, 0 - HET
C 40-33PP - C - SCRATCH, 0 - HET
C 32-1PP - TEKCT HOMEPA Ml ili ~iClA 40-{EK SCRATSH"A
C
C
 *CARDS:LC,BLOCK,(44)
 ,CONT,OUTC(25)
 ,CONT,(99)
C
C
  *MACKi*:LC,BLOCK,MS,INVMS,OP
C
C
 MN*TL:,EQU,1067B.
 ,ITA,13.
 ,ATX,60B.
 ,XTA,FLO{
 ,U1A,RET.B pACp.O{ibKi
C
C  gEHEPAciq  *PASS:<COOb}EHiE=OpEPATOPA>
C
  ,*65,7.  7TP 30P
  ,AAX,=4 000 000 000
  ,UZA,HEHYvEH.*PASS
  14,CALL,MAK*TRT.AdPEC zAdA~i
  ,ATX,NAME
 ,XTA,{
 ,ATX,NAME+4
 ,XTA,{+1
 ,ATX,NAME+5
  14,VTM,NAME
  ,ITA,14
 ,AOX,MN*TL.
C  BydATx zApPOC PASS"A HA OpEP.TEPMiHAl
  ,FUN,76B
C  vdATx COOb}EHiE OpEPATOPA
  ,ITA,14. CM=/=0
  ,FUN,66B
C  pEPEKOdiPOBATx iz TEXT B ISO
  ,ASN,64+12
  ,ASN,64-12
 ,ATX,61B
 14,VTM,-4
 LNOR:,BSS,.
 ,AAX,=:77
 ,UIA,ENOR.
 ,XTA,61B.
 ,ASN,64-6
 ,ATX,61B.
 14,VLM,LNOR.
 ENOR:,BSS,
 ,XTA,61B.
  15,ATX,
  14,VTM,TPASS
  ,ITS,14
  ,CALL,q6I
C  pEPEpiCATx B OUTC
  ,XTA,=6H*PASS:
  ,ATX,OUTC
   ,XTA,TPASS
  ,ATX,OUTC+1
  ,XTA,=6H'307''12'   '12'.KOHEc COSY
  ,ATX,OUTC+2
  ,CALL,WRITECRD
  HEHYvEH:,BSS,
C
C gEHEPAciq YK *TIME:~~.MM pO PAzdElY BPE ~~MMCC^
C
C pPOBEPKA HA CTAHdAPTHOE BPEMq (pO zC2^)
C
 ,XTA,ITIME
 ,U1A,GTIME
 ,XTA,=6H 00.07.CTAHdAPT
 ,UJ,STNDTIME
 GTIME:,BSS,
 ,ASN,64+16.OpEPAHd
 ,ATX,OP
 ,XTA,=6H'''''12''12''6''12'
 ,ATX,MS.MACKi
 ,XTA,=6H'''''166''166''172''166'
 ,ATX,INVMS
 ,XTA,=6H''''''''''4.KOMMEP~ECKAq HAdbABKA
 ,CALL,ADDTEXT
  ,AUX,=6H'''377''377''''377''377'
 ,AOX,=6H 00.00
 STNDTIME:,BSS,
 ,ATX,OUTC+1
C dOpi{EM {ApKY i XBOCT
 ,XTA,=6H*TIME:
 ,ATX,OUTC
 ,XTA,=6H'307''12'   '12'.KOHEc COSY
 ,ATX,OUTC+2
 ,CALL,WRITECRD
C gEHEPAciq YK *PAGE:SSSS pO PAzdElY Acp MMM^
C
C pPOBEPKA HA CTAHdAPTHyj zAKAz METPOB AcpY (pO zC2^)
C
 ,XTA, IPAGE
 ,U1A,GPAGE
 ,XTA,=6H0010'311''12'
C  |TO CTAHdAPT OC dYbHA
 ,UJ,STNDPAGE
 G PAGE:,BSS,.
 ,XTA,=6H'''''12''12''12''12'
 ,ATX,MS.MACKi dlq ADDTEXT
 ,XTA,=6H'''''166''166''166''166'
 ,ATX,INVMS
 ,XTA,IPAGE
 ,ATX,OP
 ,CALL,ADDTEXT.2*OP
   ,ASN,64+16.
  ,CALL,ADDTEXT.3*OP
 ,AOX,=6H0000'311''12'.KOHEc COSY
 STNDPAGE:,BSS,
 ,ATX,OUTC+1
C dOpi{EM {ApKY
 ,XTA,=6H*PAGE:
 ,ATX,OUTC
 ,CALL,WRITECRD
C
C gEHEPAciq HAbOPA YK *TAPE: NNNN/DISPAC,MM,W(R)
C libO             YK *FILE:SCRATCH,MM,W,ZZZ
C pO TAblicE MTABLE(32)
C
 11,VTM,-37B . MM=30-67
 LMT:,BSS,
 ,UTC,MTABLE
 11,XTA,37B
 ,UZA,ClEdMl
 ,ATX,TMT
 ,AAX,=6H'''377'''''''''
 ,AEX,=6H''C''''''''
 ,UZA,SCRATCH
C dObyTx HOMEP Ml: NNNN
 ,XTA,TMT
  ,AAX,=6H'''''377''377''377''377'
 ,ASN,64-8
 ,AOX,=6H 0000/
 ,ATX,OUTC+1
C dOpiCATx {ApKY i iMq Ml
 ,XTA,=6H*TAPE:
 ,ATX,OUTC
 ,XTA,=6HDISPAC
 ,ATX,OUTC+2
C dOpiCATx PEviM W ili R
 ,XTA,TMT
  ,AAX,=6H'317'''''''''''.ObPATHyj 0(060)
 ,UZA,READ
 ,XTA,=6H,00,W'274'
 ,UJ,RR
  READ:,XTA,=6H,00,R'274'
  RR:,ATX,OUTC+3
C dOpiCATx MAT HOMEP Ml: MM
  11,MTJ,13
 13,UTM,67B
 ,ITA,13
  ,ASN,64-42
 ,AUX,=6H'''7''7'''''''
 ,AOX,OUTC+3
 ,ATX,OUTC+3
C dOpiCATx KOHEc COSY
 ,XTA,=6H'12'    '12'
  ,ATX,OUTC+4
 ,ATX,OUTC+4
 ,UJ,WRC
C
 SCRATCH:,BSS,
C CYMMiPYEM 40-{Ki pO iX ~iClY B 32-1PP
C
 ,XTA,TMT
  ,ASN,64-45.iz 8 B ISO
  ,AUX,=6H'''3''4'''''''.~iClO 40-{EK
 ,AOX,=6H,000'275''12'
 ,ATX, OUTC+3
C dOpiCATx MAT.HOMEP Ml: MM
  11,MTJ,13
 13,UTM,67B
 ,ITA,13
  ,ASN,64-42
 ,AUX,=6H'''''7''7'''''
 ,AOX,=6HH,00,W
 ,ATX,OUTC+2
C dOpiCATx {ApKY
 ,XTA,=6H*FILE:
 ,ATX,OUTC
  ,XTA,=6HSCRATC
 ,ATX,OUTC+1
 WRC:,CALL,WRITECRD
C
 ClEd Ml:,BSS,
 11,VLM,LMT
  RET:,BSS,
 ,WTC,60B.
 ,UJ,. BOzBPAT
  NAME:,BSS,1.AdPEC
  ,ISO,12HzAdAjTE PASS
 ,ISO,6H dlq
 ,OCT,
 ,OCT,
  ,OCT,
  TPASS:,BSS,2
 TMT:,BSS,1
 ,END,
 HEADCIN:,NAME,
 *TYPE*:,LC,8.
 *INFOP*:LC,BLOCK,ENAM,NBEG,NPRI(2)
 *SCALS*:LC,BLOCK,NJOB(529)
 CATINP  :,SUBP,.
 CATOU   :,SUBP,.
 TMLMD   :,SUBP,.
 SPRAV   :,SUBP,.
 PRCATI  :,SUBP,.
 NEEDRS  :,SUBP,.
 SVML    :,SUBP,.
 PARAM   :,SUBP,.
 FORMPAR :,SUBP,.
 *PAGE*:,PC,2048
 RECATO:,SUBP,
 13,VTM,CIN.
 ,UJ,FORMPAR.
 HEADCOUT:,ENTRY,.
 13,VTM,COUT.
 ,UJ,FORMPAR.
 HEADD:,ENTRY,..........
 13,VTM,D.
 ,UJ,FORMPAR.
 HEADGZ:,ENTRY,.
 13,VTM,GZ.
 ,UJ,FORMPAR
 HEADL:,ENTRY,........
 13,VTM,L.
 ,UJ,FORMPAR.
 HEADRS:,ENTRY,.......
 13,VTM,RS.
 ,UJ,PARAM.
 HEADSV:,ENTRY,......
 13,VTM,SV.
 ,UJ,PARAM.
 HEADMOD:,ENTRY,.....
 13,VTM,MOD.
 ,UJ,PARAM.
 HEADDJ:,ENTRY,.
 ,ITA,1.
 ,AOX,INT0.
 ,ATX,NJOB.
 ,CALL,DELJOB.
 *62:,*62,.
 CIN:,XTA,=I1.
 CI1:,ATX,*TYPE*
 13,VTM,*62.
 ,UJ,CATINP.
 COUT:13,VTM,*62.
 ,UJ,CATOU.
 D:,UTC,=I1  - INT0
 L:14,VTM,INT0
 ,ITS,14.
 13,VTM,*62
 ,UJ,TMLMD.
 GZ:,XTA,INT0.cElyj HOlx
 ,UJ,CI1.
 MOD:13,VTM,*62.
 ,UJ,SPRAV
 RS:13,VTM,*62.
 ,UJ,NEEDRS.
 SV:13,VTM,*62.
 ,UJ,SVML.
 HEADNM:,ENTRY,.............
 ,ITA,1.
 ,ATX,*TYPE*
 12,VTM,*|T.
 ,CALL,OTCONT.
 ,XTA,|T+1.
 ,ATX,ENAM.
 13,VTM,*62.
 ,UJ,PRCATI.
 INT0:,INT,0
 *|T:,Z00,|T.
     ,Z00,TiHf.
 ,LOG,.
 TiHf:,ISO,6HNAME'41'''
 |T:,BSS,2
 ,DATA,.
 *NBEG:,INT,1
 *NPRI:,INT,4
 :2,SET,*NBEG
 1,,     NBEG.
 ,END,HEADSALL
 HEADNM:,NAME,
C
C*******  pE~ATx HA TL iHfOPMAcii
C         O zAdA~AX i, zAdAHHyX
C         lEByM ObPAzOM'NAME'
C
 *INFOP*:LC,BLOCK,ENAM,NBEG,NPRI,(1)
 *TYPE*:LC,BLOCK,ITYP,(6)
 OTCONT:,SUBP,
 RECATO:,SUBP,
 *DUM1:,LC,
 *PAGE*:,PC,2048
C
 ,ITA,1
 ,ATX,ITYP
 12,VTM,*|T
 ,CALL,OTCONT
 ,XTA,|T+1
 ,ATX,ENAM
 ,CALL,PRCATI
 ,SJ,
 *|T:,Z00,|T
 ,Z00,TiHf
 ,LOG,
 TiHf:,ISO,6HNAME!''
 |T:,BSS,2
 ,DATA,
 *NBEG:,INT,1
 *NPRI:,INT,4
 :2,SET,*NBEG
 1, ,NBEG
 ,END,
  ISO T:,NAME,
C
C*****   pEPEKOdiPBKA ISO-TEXT
C*****   ObPA}EHiE :
C*****   CALL ISOTEX(ISO,LENGTH,TEXT)
C*****   (LENGTH - KOl-BO ISO -CiMBOlOB)
C
 *7:,BLOCK,LI,B,T,LT,I,ML
C
 :B,BASE,*
 ,ITS,13 .CpACEHiE
 ,ATX,S13 .PEgiCTPOB
 ,ITA,LI .
 ,STX,SLI .
 ,STI,T.AdPEC TEXT
 T,UTM,-1.
 LT,VTM, .CdBig TEXT
 ,STI,ML
 ML,WTC,
 ML,VTM,.glABHyj ciKl
 ,ATI,I.AdPEC ISO
 I,UTM,-1
 LI,VTM,   .CdBig ISO
 R ISO:,BSS,
C......   ~TEHiE ISO-CiMBOlA
 ,XTA,
 ML,VZM,END .KOHEc pO dliHE
 ML, UTM,-1
 LI,VIM,RISO 1 .-CTAPOE ClOBO
 LI, VTM,48. HOBOE
 I,UTM,1. ISO- ClOBO
 RISO 1:LI,UTM,-8
 I,XTA,
 LI,ASN,64
 ,AAX,C377 .ISO-CiMBOl
 ,UZA,RET.KOHEc pO CiMB.
C.......   CObCTBEHHO pEPEKOdiPOBKA
 15,ATX,
 ,ASN,64+3
 ,ATI,13.AdPEC pO TAbl.
 ,ASN,64-3.
 15,AEX,  .bAjT pO ClOBY
 15,ATX,
 ,ASN,64-1 .
 15,ARX, .N bAjTA
 ,ASN, 64-1. * 6
 ,AEX,C77777
 ,ATI,14 .CdBig ClOBA
 13,XTA,TABLE-4
 14,ASN,64+1
 ,AAX,B48/43
C.......   zApiCx TEXT-CiMBOlA
 ,UZA,R ISO.CiMBOl-pYCTOj
 LT,VIM,WR TEX.
 LT,VTM,-48
 T,UTM,1
 ,XTS,
 T,STX,
 WR TEX:LT,UTM,6
 LT,ASN,64+42
 T,AOX, .TEXT-CiMBOl
 T,ATX,  .B ClOBO
 ,UJ,R ISO
 END :LT,V1M,RET
 T,ATX,1
 RET:,XTA,SLI
 ,STI,LI
 ,WTC,S13
 ,UJ,
 B48/43:,OCT,77
 C77777:,LOG,77777
 C377:,LOG,377
 TABLE:,BSS,
C........   TAblicA pEPEKOdiPOBKi ISO-TEXT
 040,TEXT,8H
 050,CONT,8H*     I
 060,CONT,8H01234567
 070,CONT,8H89
 100,CONT,8H ABCDEFG
 110,CONT,8HHIJKLMNO
 120,CONT,8HPQRSTUVW
 130,CONT,8HXYZ
 140,CONT,8H` bcd fg
 150,CONT,8H ij l
 160,CONT,8Hpq
 170,CONT,8H
 SLI:,BSS,1
 S13:,BSS,1
 ,END,
 KILLTA:,NAME,.
 *PAGE*:PC,BLOCK,P(1024)
 BITS:,EQU,677B.
 BIT1:,EQU,757B.
 MP:,P/P,(P)1024
 A OUT:,EQU,566B
 8,BASE,*.
 ,*76,KI.
 13,UJ,.
 KI:14,REL,*.
C.........   pPObA: HE OKOH~ilCq li ObMEH
 ,WTC,502B.
 ,WTC,.
 12,VTM,.
 12,XTA,30B+MP.
 ,ASN,64+30.
 ,AAX,=177
 ,ATI,12.
 12,VZM,RET.
 ,WTC,503B.
 12,XTA,.
 ,ASN,64+6.
 ,AAX,BIT1.
 ,UZA,RET.
C.........
 ,ITA,14.fiKCAciq
 ,ASN,64+10.
 ,ATI,12.
 ,WTC,503B.
 12,XTA,.
 ,AOX,BIT1.
 ,WTC,503B.
 12,ATX,....
 ,WTC,502B.
 ,XTA,.
 ,ATX,YC.HA{ YC
 ,ASN,64+42.
 ,ATX,dHz.HA{ dHz
 ,ATI,12.
 ,WTC,A OUT
 ,XTA,.Ml-zAKAzA
 12,AOX,BITS.
 ,WTC,A OUT
 ,ATX,....
 ,MOD,101B.CBEPTKA KOMAHd
 ,ATI,.
 ,XTA,574B.pEPEXBAT
 ,ATX,OLD.|K KOHcA
 ,ITA,14.
 ,ASN,64-24.
 ,AOX,NEW.
 ,ATX,574B....
 12,VTM,-7.
 By1:,ATX,1.
 12,VLM,By1.
 ,24,2000B.
 ,XTA,P.
 RESET:,WTC,dHz.BOCCTAHOBlEHiE
 12,VTM,.diCpET~EPA
 ,WTC,A OUT
 ,XTA,.
 12,AOX,BITS.
 12,AEX,BITS.
 ,WTC,A OUT
 ,ATX,.
 ,XTA,OLD.
 ,MOD,101B.
 ,ATI,.
 ,ATX,574B....
 12,VTM,-7.
 By2:,ATX,1.
 12,VLM,By2.
 RET:,MTJ,27B.BOzBPAT
 2,IJ,.
 |K74:,WTC,502B.
 ,XTA,.
 ,AEX,YC.
 ,ASN,64+42.b |K KOHcA:
 ,UIA,OLD. - HE My
 ,UJ,RESET. - My
 NEW:14,VTM,.
 ,UJ,|K74.
 OLD:,BSS,1.
 YC :,BSS,1.
 dHz:,BSS,1.
 ,END,.
 KOdbOb:,NAME,.
 C:,BSS,
 8,BASE,*.
 ,STI,9.
 9,WTC,.
 9,VTM,.Tip KOdiPOBKi
 ,STI,10.KYdA piCATx
 ,ATI,11.iMq Ml/dp
 11,XTA,.
 ,AEX,STNAME.
 14,VTM,TNAM.
 ,UZA,SPECN.iMq-CTAHdAPT.KOd
 11,XTA,.
 ,AEX,NCNAME.
 14,VTM,TNCH.
 ,UZA,SPECN.iMq-NO CHECK
 11,XTA,.
 ,AAX,C7777.
 13,MTJ,11.
 ,CALL,TOMAN*.
 11,MTJ,13.
 ,AOX,CON1.
 9,VZM,RET.
C.....   TRANSLATION TEXT TO DECIMAL
 ,ATX,TNU.
 ,XTA,.
 9,VTM,1-4.
 ,NTR,2.
 LNUM:,BSS,.
 ,A*X,REAL10.
 ,ATX,BNU.
 ,XTA,TNU.
 ,ASN,64-8.
 ,ATX,TNU.
 ,YTA,.
 ,AAX,C17.
 ,AOX,INT0.
 ,A+X,BNU.
 9,VLM,LNUM.
 ,NTR,3.
 ,A+X,INT0.
 ,NTR,18.
 ,UJ,RET.
 SPECN:9,VIM,OLD1.dB.-dEC.
 14,XTA,.
 RET:,BSS,.
 10,STX,.
 13,UJ,.
 OLD1:,AOX,INT0.
 ,UJ,RET.
 KOddBd:,ENTRY,.
C*****   fYHKciq pOlY~EHiq HOMEPA Ml
 8,BASE,C.
 ,ATI,10.iMq Ml
 10,XTA,.
 ,AAX,C7777.
 ,AOX,INT0.
 13,UJ,.
C
C----- pEPEBOd dATy iz 4TP B ISO
C
 KOddAT:,ENTRY,
 8,BASE,C
 ,STI,10
 ,ATI,9
 9,XTA,
 ,ASN,64-16
 ,AUX,UPM2
 ,AOX,CD2
 10,ATX,1
 9,XTA,
 ,ASN,64-5
 ,AUX,UPM3
 ,AOX,CD3
 ,UJ,RET
 MA{HOM:,ENTRY,
C
C----- BydA~A HOMEPA MA{iHy
C
 ,ATI,9.
 ,*63,7.
 8,BASE,C
 ,ASN,64+33.
 ,AAX,C7.
 ,AOX,INT0.
 9,STX,.
 13,UJ,.
 UPM3:,GOST,6H3 01 0
 UPM2:,GOST,6H  0000
 CD3:,ISO,6H00.00.
 CD2:,ISO,6H00
 STNAME:,LOG,2245 1252 5122 4512.
 CON1:,ISO,6H0000
 C7777:,LOG,7777.
 C7:,LOG,7.
 INT0:,INT,0.
 NCNAME:,TEXT,8HNO CHECK
 TNAM:,ISO,6HSPEC
 TNCH:,ISO,6HNCHK
 REAL10:,REAL,10..
 C17:,LOG,17.
 TNU:,BSS,1.
 BNU:,BSS,1.
 ,END,.
 LDSHI:,NAME,
C----------------------------------------
C         pPOgPAMMA OpPEdElEHiq
C---------zAHqTOCTi PECYPCA
C----------------------------------------------
 A/ipK1 :,EQU,762B.
 A/ipd  :,EQU,760B.
 XNF:,EQU,0.dHz 1-j ClYv.zAd
 XNC:,EQU,5.~iClO {ifPOB(BCEgO)
 12,BASE,*
 ,STX,ANUM. - pAPAMETPy
 ,ATX,ALD.
 14,VTM,1-3.
 L:14,ITA,10.
 14,ATX,SI+2.
 14,VLM,L.
 ,WTC,ALD.
 ,XTA,.
 ,AEX,=I0.
 ,U1A,DISC.
C------   MAgHiTHyE lEHTy
 ,*63,504B.
 ,ATI,8.
 ,WTC,ANUM.
 ,WTC,.
 8,*63,. - HA{A Ml
 ,AAX,=:77.
 ,UZA,RETNO. - HE zAHqTA
 ,ASN,64+42.
 ,AOX,=I0.
 ,UJ,RETYES.
 RETNO:,XTA,=I0.
 RETYES:,WTC,ANUM.
 ,STX,.
 14,VTM,1-3.
 LL:14,XTA,SI+2.
 14,ATI,10.
 14,VLM,LL.
 13,UJ,....
C------   MAgHiTHyE diCKi
 DISC:,*65,A/ipd.
 ,ATI,9.
 9,*65,XNF
 ,ATI,10
 9,*65,XNC.
 ,ATX,NC.~iClO {ifPOB
 ,NTR,3.
 ,X-A,=1
 ,ATI,8.1-~iCl.{ifPOB
 ,NTR,6
 ,*65,A/ipK1.
 ,ARX,NC
 ,ARX,NC.
 ,ATX,NCWOR.
 ,XTA,=:4
 ,WTC,ANUM
 ,WTC,.
 ,ASN,64
 ,ATX,R.
 LOOP:,WTC,NCWOR.
 8,*65,-1.
 ,AAX,R.
 ,UZA,NOD.CBObOdEH
 ,WTC,NC.
 8,UTM,-1.
 10,J+M,8.
 ,ITA,8.
 ,AOX,=I0
 ,UJ,RETYES.
 NOD:8,VLM,LOOP.
 ,UJ,RET NO.
 NC:,BSS,1.
 NCWOR:,BSS,1.
 R:,BSS,1
 ANUM:,BSS,1
 ALD:,BSS,1
 SI:,BSS,3
 ,END,
 MAK*TRT:,NAME,.pOlY~.TEPM
 ,ITA,14.
 ,UJ,BEGIN*.
 MAKTRT :,ENTRY,.
 ,ITA,13
 ,UJ,BEGIN*.
  INDEX1:,ENTRY,. N = INDEX1(0)
  ,ITA,1
  ,UTC,=I0
  ,AOX,
  13,UJ,
 BEGIN*:,BSS,.
 ,ITS,.
 ,*65,502B.
 ,ATI,14
 14,*65,.
 ,ASN,64+15
 ,ASN,64-42.
 15,ATX,.
 ,ASN,64+6.
 15,AOX,
 ,UTC,=6H'''7''7''''77'''
 ,AUX,
 ,UTC,=6H{00('100')
 ,AOX,
 ,NTR,6.
 15,WTC,
 ,UJ,.
 ,END,.
 NEWSTR:,NAME,
  NOLISFL*:,LC,1
  *NZ1*:,LC,1
  *P*:,PC,2048
 Q:,P/P,(*P*)16
 *CLNEWS*:LC,BLOCK,TT,Z,F,ONE(84),LZ
 ,CONT,FLOLD,LT
 W:I,BLOCK,(1),U,S
  C:8,BASE,C
 ,ATI,9
 13,MTJ,12
 ,NTR,6
 11,VTM,*P*.PAGE'S BASE
 ,XTA,LT
 ,U1A,NC1.NOT 1-ST CALL
 ,XTA,TT
 ,APX,=6H'7''7'''''''''
 ,ASN,64+30.MATH. NUMBER
 ,AOX,CIN.INF. WORD
 ,ATX,LT.WITHOUT N ZONE
 NC1:9,XTA,.PAGE'S POINT
 9,VTM,-84
 LOOPW:,ARX,=1.INCREMENTING
 ,AAX,=I1023.THE POINT BY
 ,ATX,F.RING WAY
 ,ASN,64-4
 ,U1A,NOTB.NOT BORD
 ,XTA,FLOLD
 ,U1A,ZONEIS
  14,VTM,*3
  13,VTM,TAPE
  GIVEME:,ENTRY,
  8,VTM,C
 ,NTR,7
 ,XTA,Z.CURRENT N ZONE
 ,A+X,=I1
 ,ATX,Z
 ,AEX,LZ
 ,NTR,6
  14,UZA,
 ,XTA,Z
 ,AEX,LT
 ,ATX,W.INF WORD
  13,UJ,
  TAPE:,BSS,
   ,UTC,*NZ1*
   ,ATX,
 ,TAPE,W
 ZONEIS:,XTA,
 ,ATX,FLOLD
 NOTB:,WTC,F
 11,XTA,.NEW WORD
 ,UZA,NOTTEX
 LOOPS:,UZA,NEWW.FOR NEW WORD
 ,ASN,64-8
 ,ATX,U
 ,YTA,
 ,ATX,S.NEW SYMBOL
 ,AEX,=12
 12,UZA,.NL,NORM.RETURN
 ,XTA,S
 ,ARX,=7777 7777 7777 7740
 ,UZA,NOTTEX.S.LT.40B
 ,ARX,=7777 7777 7777 7637
 ,U1A,BLANKS.S.GE.200B
 ,XTA,S
 ,ASN,64-40.CREATING THE
 ,AOX,=1H''.(1H)TYPE WORD
 14,VJM,WRW
 TONEWS:,XTA,U.FOR NEXT
 ,UJ,LOOPS.SYMBOL
 BLANKS:,ATI,10.N BLANKSH1
  ,XTA,=1H
 14,VTM,LOOPBL
 LOOPBL:10,UTM,-1
 10,VZM,TONEWS.THERE ARE NOT
 WRW:9,VZM,NOTTEX.SUBROUTINE
 9,ATX,ONE+84.FOR WRITE
 9,UTM,1.ONE SYMBOL
 14,UJ,.WITH PLACE TEST
 NEWW:,XTA,F
 ,UJ,LOOPW.FOR NEXT WORD
 NOTTEX:,XTA,=I1.RETURN WHEN
 12,UJ,.IT ISN'T TEXT
  *3:,XTA,=I3
  12,UJ,
 CIN:13,010,Q
 ,000,
 I10T8:,ENTRY,
 ,ATI,14
  8,VTM,C
   ,XTA,=I0
 14,AOX,
  ,XTS,=I1
   ,XTS,NOLISFL*
   ,UZA,SETFL
   ,XTA,=1
   SETFL:,BSS,
   15,AEX,
   ,UTC,*NZ1*
  ,STX,
  ,NTR,6
 13,UJ,
 W:,BSS,3
 ,END,
 OCT/P:,NAME,
 END:,SUBP,
 RE:,EQU,13
 TEL/P:,LC,1
C            pEPEBOd TEXT-OCT
 ,XTA,TEL/P.
 ,ATX,TEL.
 ,XTA,.
 ,ATX,NJOB. - PEzYlxTAT
 LP:,XTA,TEL. - O~EPEdHOj
 ,ASN,64-6. CiMBOl
 ,ATX,TEL. B PMP
 ,YTA,.
 RE,UZA,. - BCE CiMBOly
 ,ATX,J.
 ,NTR,3. - pPOBEPKA
 ,A-X,C20. cifPA li
 ,U1A,END. - HET
 ,A-X,NU.
 ,UZA,END. - HET
 ,XTA,NJOB. - MECTO pOd
 ,ASN,64-3. O4EPEdHY`
 ,ATX,NJOB. cifPY
 ,XTA,J. - O4PEdHY`
 ,AAX,=7. cifPY
 ,AOX,NJOB. B NJOB
 ,ATX,NJOB.
 ,ATI,1.
 ,UJ,LP. - zA ClEd. cifPOj
 NJOB:,BSS,1
 TEL:,BSS,1.
 J:,BSS,1
 C20:,LOG,20
 NU:,LOG,10
 ,END,
 OPERANDS:,NAME,
 *2:,BLOCK,C,(1),R,S,(1),N
 ,CONT,(1),W1,SW,K,L,T,P,TT
 SPACE:,EQU,40B.
 PLUS:,EQU,53B
 COMMA:,EQU,54B.
 SLASH:,EQU,57B.
 TWOP:,EQU,72B
 *STR*:LC,BLOCK,NTER,STR(13)
 *ERRDEB*:LC,BLOCK,FLER
C==============================
 :3,BASE,*
 ,ITA,SW
 ,ATX,S/SW
 'HA~AlO'
 N,VTM,STR
 SW,VTM,FIRST.HA~.CTPOKi
 ,XTA,.
 ,ATX,ACC.HAKOpiTElx
 R WORD:N,XTA,.TEK. ClOBO
 K,VTM,1 - 6.6 CiMBOlOB
 READ:,ASN,64 - 8.
 ,ATX,WORD.OCTATOK
 ,YTA,.
 ,ATI,S.TEK. CiMBOl
 SW,U1A,.HE KOHEc CTPOKi
 'ByXOd'    ---------
 ,XTA,
 ,ATX,FLER
 ,XTA,ACC
 OUT:,BSS,
 ,WTC,S/SW
 SW,VTM,.
 R,UJ,.
C   --------------------
 FIRST:S,UTM,-SPACE
 S,VIM,STEP
 ,UJ,T8
 STEP:,XTA,WORD.
 K,VLM,READ.
 N,VLM,R WORD.
 T8:,BSS,
 L,VTM,-5
 SW,VJM,STEP
 FIGURE:S,UTM,-COMMA
 S,VZM,FCOMMA
C         ----------------
 DIGIT:,ATI,S.ObPAb. cifP
 S,UTM,- 60B.
 ,ITA,S.
 ,AAX,=7 000.MiHYC
 ,UIA,IF SP.MAlO
 ,ITA,S.
 ,ARX,TYPE
 ,AAX,=7 000.MiHYC
 ,UZA,ERROR.BEliKO
 JOB:,XTA,ACC.HAKOplEHiE
 ,ASX,TYPE
 ,ATX,ACC.
 ,ITA,S.
 ,AOX,ACC.
 ,ATX,ACC.
 L,VLM,STEP
 ,UJ,ERROR.dliHA BEliKA
 IF SP:S,UTM,60B - SPACE.
 S,VZM,STEP.pPObEl
 ERROR:,XTA,=2
 ,ATX,FLER
 ,UJ,OUT
 FCOMMA:L,VTM,-16
 ,XTA,ACC
 ,ATI,T
 ,XTA,
 ,ATX,ACC
 SW,VTM,DIGIT
 ,UJ,STEP
 TYPE:,BSS,
 2,OCT,3640 0000 0007 7770
 ACC:,BSS,1
 WORD:,BSS,1
 S/SW:,BSS,1
 ,END,
 OT CONT:,NAME,.
C
C******   OPgAHizAciq CBqzi C OpEPAT.TEPMiHAlOM
 '        CEPiq BOpPOCOB i OTBETOB
C
C         i12 - XAPAKT.MACCiB(pPizHAK KOHcA - 0)
C
 *8:,BLOCK,B,L,T,IN
C
 BAS:B,BASE,*.
 ,ITA,13.
 ,ATX,I13.BOzBPAT
 MN*TL:,EQU,1067B
C------   BydA~A HA OpEPATOPCKij TEPMiHAl
 LOOP:12,XTA,.
 ,UZA,RET.
 ,ATI,L.A BydA~i
 ,ASN,64+24.
 ,ATI,IN.A BBOdA
 L,VZM,REQ.- HET BydA~i
 T,VTM,T/OUT.BHYTP.bYfEP
 MOV:L,XTA,. TEKCT BO
 T,ATX,.BHYTP.bYfEP
 ,UZA,E MOV. - KOHEc pOPcii
 T,UTM,1.
 12,XTA,.TEKCT
 ,AAX,B ONEW.B OdHO ClOBO
 ,UZA,E MOV. - dA
 L,VLM,MOV.
 E MOV:T,ATX,.pPizHAK KOHcA
 T,UTM,-T/OUT.
 EM 1:T,VZM,REQ.- HET BydA~i
 T,UTM,-1.
 T,XTA,T/OUT.
 ,AEX,BLAN.
 14,VTM,.
 ,U1A,EM 2.
 T,ATX,T/OUT.
 ,UJ,EM 1.
 EM 2:,ASN,64-8.
 14,UTM,8.
 ,U1A,EM 2
 ,XTA,FULWOR.
 14,ASN,64-48.
 T,AAX,T/OUT.
 EM 3:T,ATX,T/OUT.
 13,VTM,T/OUT
 ,ITA,13
 ,AOX,MN*TL
 ,FUN,76B
C------   BBOd C OpEPATOPCKOgO TEPMiHAlA
 REQ:IN,VZM,RET.
 ,ITA,L
 ,FUN,66B
 ,ATX,TEL
 ,UIA,TEL IS
 L,VZM,RET W
 TEL IS:12,XTA,.
 ,ASN,64+39.
 ,AAX,C17.
 ,ATI,T.Tip KOdiPOBKi
 ,XTA,.
 IN,ATX,1.PEzYlxTAT
 ,XTA,=H
 T,VZM,TI 1.
 ,XTA,=6H000000.
 TI 1:IN,ATX,.iCXOd.ISO
 ,XTA,TEL.
 ,ASN,64+12.gA{EHiE '.N'
C......   HOPMAlizAciq TExT BlEBO
 L,VTM,1-8.
 TI 2:,ATX,TEL.
 ,AAX,B48/43.pEPByj CiMBOl
 ,UIA,TI 3. - HE HOlx
 ,XTA,TEL.
 ,ASN,64-6
 L,VLM,TI 2.
C         COOb}EHiE - pYCTOE
 E LOOP:12,UTM,1.
 ,UJ,LOOP.HA ClEd.zAKAz
C------   KOdiPOBKA pPiHqTOgO COOb}EHiq
 TI 3:T,VIM,TI 4.
 L,VTM,1-6. ISO - 6 CiMB.
 ,XTA,TEL.dlq T=ISO
 IN,ATX,1.HOPMAl. TEXT
 TI 4:,XTA,TEL.
 ,ASN,64-6.
 ,ATX,TEL.OCTATOK ClOBA
 ,YTA,.
 ,ATX,SYM.CiMBOl TEXT
 T,VZM,ISO.
 ,NTR,3.KOdy-cifPOByE
 ,A-X,C20.
 ,UIA,REPEAT.T-CiMB.LT.20
 T,A-X,NU2-1.
 ,UZA,REPEAT.T-CiMB.GT.27/31
 IN,XTA,1.zApiCx
 T,ASX,SHI-1.O~EPEdHOj
 IN,ATX,1.cifPy
 ,XTA,SYM.
 ,AAX,C17.
 IN,AOX,1.
 IN,ATX,1.
C......   pEPEBOd TExT - ISO
 ISO:,XTA,SYM.
 ,ASN,64+2.
 ,ATI,14.
 ,ASN,64-2.
 ,AEX,SYM.
 ,ASN,64-3.
 ,ATI,13.CdBig dlq CiMB.
 14,XTA,TABL.
 13,ASN,64+16.
 ,AAX,C377.
 ,ATX,SYM.ISO-CiMBOl
 IN,XTA,.
 ,ASN,64-8.zApiCx
 ,AOX,SYM.ISO-CiMBOlA
 IN,ATX,.
 L,VLM,TI 4.
 ,UJ,E LOOP.K ClEd.zAKAzY
 REPEAT:T,VTM,.O{ibKA B
 12,XTA,.
 ,ATI,L.
 ,XTA,.
 ,ATX,T/OUT+1.
 ,XTA,ERTEXT.
 ,UJ,EM 3.
 RET W:12,XTA,.ObHYlEHiE
 ,ASN,64+24.q~EjKi
 ,ATI,IN.pPiEMA
 ,XTA,.
 IN,ATX,.
 IN,ATX,1.
 RET:,WTC,I13.
 ,UJ,.
 OT OUT:,ENTRY,.
C*****   BydA~A HA OpEP.TEPM.
 B,BASE,BAS.
 ,XTS,.
 OT 1:,STX,*W.
 ,ATI,L.
 L,WTC,.
 L,VTM,.~iClO ClOB
 T,VTM,B*OUT.
 L,VZM,OT 2.
 ,ITA,L.
 ,ARX,C4.
 ,ASN,64+4.
 ,UZA,OT 3.
 OT 2:L,VTM,11.
 OT 3:,STX,.
 ,ATI,IN.A BydA~i
 OT 4:IN,XTA,.
 T,ATX,.
 ,UZA,OT 5.
 IN,UTM,1.
 T,UTM,1.
 L,UTM,-1.
 L,V1M,OT 4.
 ,XTA,.
 OT 5:T,ATX,.
 ,XTA,*W.
 ,AOX,*W/OUT.
 ,UJ,OT 7.
 OT CHEK:,ENTRY,.
C*****   OpPOC : HET li COOb}EHiq
 B,BASE,BAS.
 T,VTM,OT7.
 OT 6:,ATI,14.
 ,AAX,C17.
 ,ASN,64-15.
 15,AOX,
 ,ASN,64-24.
 T,UJ,.
 OT 7:,STX,*W.
 12,VTM,*W.
 ,UJ,BAS.
 OT EXCH:,ENTRY,.
C*****   zApPOC/OTBET C OpEP.TEPM.
 T,VTM,OT 1.
 ,UJ,OT 6.
 ERTEXT:,ISO,6HO{ibKA
 BLAN:,ISO,6H
 FULWOR:,LOG,7777 7777 7777 7777.
 *W/OUT:,,.
 ,Z01,B*OUT.
 B ONEW:,LOG,1 00000.
 NU2:,LOG,10.
 ,LOG,12.
 SHI:,OCT,364.
 ,OCT,36.
 M OWN:,TEXT,8H      ``
 T OWN:,TEXT,8H      '10'N
 TX:,TEXT,8H      0N
 B48/43:,OCT,77.
 C377:,LOG,377.
 C20:,LOG,20.
 C17:,LOG,17.
 C4:,LOG,4
 TABL:,BSS,.
C......   TAblicA pEPEKOdiPOBKi TEXT-ISO
 00,ISO,6Hcb
 04,CONT,6Higfd
 10,CONT,6Hj* .
 14,CONT,6H/vql
 20,CONT,6H3210
 24,CONT,6H7654
 30,CONT,6H:x98
 34,CONT,6Hy+-p
 40,CONT,6HCBAz
 44,CONT,6HGFED
 50,CONT,6HKJIH
 54,CONT,6HONML
 60,CONT,6HSRQP
 64,CONT,6HWVUT
 70,CONT,6H{ZYX
 74,CONT,6H`~}|
 I13:,BSS,1.
 TEL:,BSS,1.
 SYM:,BSS,1.
 T/OUT:,BSS,12.
 *W:,BSS,2.
 B*OUT:,BSS,12.
 ,END,
 OURUNIT:,NAME,
C*
C*   OpiCATElx fAjlA, C KOTOPyM
C*   PAbOTAET |KPAHHyj PEdAKTOP.
C*
 :,ISO,18HT11/LINBUF,W
 ,END,
 O{MlMd:,NAME,
C
C     CbOP O{ibOK pO Ml i Md
C     ByzOB CALL O{MlMd(Ml/Md,BEG/CONT)
C     Ml/Md=0-O{ibKi pO Ml
C          =1-pO Md
C      BEG/CONT=0-pPOCMOTP TAblic C HA~AlA
C             =1-C TEKY}EgO MOMEHTA
C
 *TABLE*:LC,BLOCK,(3304),MlCb,MlO{(5000),MdCb,MdO{(5000)
 *XAPMld*:LC,BLOCK,NMf,NZON,KO{(9),KHAPAb
 *ONE*:LC,BLOCK,(5),NAMl
C
C     B MlO{ i MdO{ XAPAKTEPiCTiKi pO Ml i dp
C     PACpOlOvEHiE pO BOzPACTAHi` HOMEPOB Ml i dp
C     1-ClOBO-pOlHOE iMq Ml ili dp
C     dAlx{E dlq KAvdOgO Mf i dM:
C     1OE ClOBO:
C        1-9PP.-KOl-BO ClOB C O{ibKAMi
C        10-41PP.-HAPAbOTKA
C        42-47PP.-N Mf ili dM
C        48P=1-pOClEd ij Mf ili dM.
C     dAlx{E N ClOB(N.LE.3) C O{ibKAMi:
C        1-10P-N-zOHy
C        3 PAzA pO:
C        4P-N-O{ibKi
C        8P-KOli~ECTBO O{ibOK.
C
 C:8,BASE,*
 11,VTM,.pPizHAK BXOdA O{MlMd
 BEGIN:,NTR,3
 ,ATI,10
 10,XTA,
 ,AAX,=1
 ,ATX,FLBEG/C
 ,STI,10
 ,ATI,9
 9,XTA,
 ,AAX,=1
 ,ATX,FLMl/Md
 ,ATI,9
 ,XTA,
 ,ATX,CYpAK
 ,ATX,CPACp
 ,ITA,11
 ,ATX,FLHAPAb
 ,XTA,C48P
 ,ATX,FLEND
 11,VTM,-3
 LSAV:11,ITA,1+3.CpACEHiE MOdifiKATOPOB
 11,ATX,SAVM+3
 11,VLM,LSAV
 ,ITA,13
 ,ATX,M13
 1,VTM,MlO{.YCTAHOBKA dlq Ml
 2,VTM,MlCb
 3,VTM,KO{
 ,XTA,=6.KOli~ECTBO TipOB
 ,ATX,LKO{.O{ibOK
 9,VZM,Ml
 1,VTM,MdO{.HE Ml
 2,VTM,MdCb
 ,XTA,=11
 ,ATX,LKO{
 Ml:,BSS,
 1,MTJ,4.dlq dBivEHiq pO TAblicE
 10,VZM,BEGJ
 ,XTA,ADRNAM.pPEdydY}ij PAz
 ,ATI,4.OCTAHOBiliCx zdECx
 BEGJ:,BSS,
 2,XTA,
 ,AEX,=I0
 ,UZA,BTAbl.TAblicA E}E pYCTAq
C
C     KYdA by zAHETi.
C
 MAINL:,BSS,
 4,XTA,.i}EM pO iMEHi
 ,UTC,NAMl.Ml ili dp
 ,AEX,
 ,UZA,CTAPAq.YvE bylA
 4,MTJ,14.OpPEdElqEM HOMEP
 ,ITS,14.bObiHy ili pAKETA
 14,VTM,R1.pOlY~AEM
 ,ITS,14.B R1
 14,VTM,=I1
 ,ITS,14
 ,CALL,KOdbOb
 14,VTM,NAMl.HOMEP pOlY~EHHOj
 ,ITS,14.bObiHy ili pAKETA
 14,VTM,R2. B R2
 ,ITS,14
 14,VTM,=I1
 ,ITS,14
 ,CALL,KOdbOb
 8,BASE,C
 ,NTR,3
 ,XTA,R1
 ,X-A,R2
 ,U1A,TOCdBig. HA{li MECTO
 EML:,BSS,.pEPEXOd K ClEdY`}Ej
 4,UTM,1.lEHTE ili pAKETY
 4,XTA,
 ,AAX,=777.~iClO ClOB
 ,ATI,9.C O{ibKAMi
 4,XTA,
 9,J+M,4.CdBig BHiz
 ,ARX,
 ,U1A,EML.ClEdY`}ij Mf ili dM
 4,UTM,1.ClEdY`}Aq lEHTA
 ,ITA,4
 ,ARX,=1
 ,ITS,1
 15,X-A,.MECTO
 ,AOX,=I0.B TAblicE
 2,X-A,
 ,UZA,MAINL.
C
C     pOCMOTPEli BC` TAblicY
C
 BTAbl: 13,VJM,YpAK.YpAKOBKA O{ibOK
 ,XTA,CYpAK
 ,ARX,=2
 2,ARX,
 2,ATX,
 ,X-A,MAXL
 ,U1A,pEPEpOlH.MAlA TAblicA
C     zAHECEHiE iMEHi
 zAHECEH:,BSS,
 ,UTC,NAMl
 ,XTA,
 4,ATX,
 ,ITA,4.dlq
 ,ATX,ADRNAM.bYdY}EgO
 4,UTM,1
C     zAHECEHiE HAPAbOTKi i N Mf
 zAHECMf:,BSS,
 ,UTC,NMf
 ,XTA,
 ,ASN,64-41
 ,AOX,CYpAK
 ,AOX,FLEND
 ,UTC,KHAPAb
 ,XTS,
 ,AAX,=177 7777 7777
 ,ASN,64-9
 15,AOX,
 4,ATX,
 ,ITA,4
 ,ATX,ADRMf
 4,UTM,1
C     zAHECEHiE O{ibOK
 zAHECO{:,XTA,CYpAK
 ,ATI,10
 10,VZM,RET.HETY
 9,VTM,BUFYpAK
 LpEPEp:9,XTA,.pEPEpiCyBAEM
 4,ATX,
 9,UTM,1
 4,UTM,1
 10,UTM,-1
 10,V1M,LpEPEp
 ,UJ,RET.pO{li dOMOj
C     OpPEdElqEM BEli~iHY CdBigA
 TOCdBig:13,VJM,YpAK
 ,XTA,=2.dObABOK K O{ibKAM
 13,VTM,zAHECEH
 ,UJ,CdBig
C     HA{li iMq, CMOTPiM dAlx{E
 CTAPAq:4,MTJ,9
 4,UTM,1
 ,XTA,FLBEG/C
 ,UZA,HECKA~
 ,ITA,9
 ,AEX,ADRNAM
 ,U1A,HECKA~
 ,WTC,ADRMf
 4,VTM,
 HECKA~:,BSS,
 ,ITA,9
 ,ATX,ADRNAM
 pOiCKMf:,BSS,
 4,XTA,
 ,ASN,64+41
 ,AAX,=77
 ,AOX,=I0.HOMEP Mf
 ,ATX,R1
 ,UTC,NMf
 ,A-X,
 ,U1A,HivE
 ,XTA,R1
 ,UTC,NMf
 ,AEX,
 ,UZA,TOTMf
C     HA{li MECTO, Mf-pEPByj PAz
 ,XTA,
 ,ATX,FLEND
 TOYpAK:13,VJM,YpAK.
 ,XTA,=1.gOTOBiMCq
 13,VTM,zAHEC Mf.K CdBigY
C     CdBig TAblicy BHiz
C     {Ag CdBigA-CYpAK+CYMMATOP
 CdBig:,BSS,
 ,ITS,4
 ,ITS,1
 15,X-A,
 ,AOX,=I0
 2,X-A,
 ,STI,9
 2,WTC,
 11,VTM,
 ,ARX,CYpAK
 2,ARX,.pPABiM
 2,ATX,.C~ET~iK
 ,ATI,10
 ,X-A,MAXL
 ,U1A,pEPEpOlH
 13,UTC,.HAXOdiMCq HA
 9,VZM,.KOHcE TAblicy.
 ,ITA,10
 ,ITS,11
 15,AEX,
 13,UZA,
 1,J+M,10
 1,J+M,11
 LSHIFT:11,XTA,-1.pEPEpiCx
 10,ATX,-1
 10,UTM,-1
 11,UTM,-1
 9,UTM,-1
 9,V1M,LSHIFT
 13,UJ,
C     pEPEXOd K ClEd. Mf
 HivE:4,XTA,
 ,AAX,=777.KOl-BO ClOB
 ,ATI,9.C O{ibKAMi
 4,MTJ,10
 9,J+M,4
 4,UTM,1
 10,XTA,
 ,ARX,
 ,U1A,pOiCKMf
 ,AEX,C48P.pOClEdHij Mf
 10,ATX,
 ,UJ,TOYpAK
C     Mf YvE byl.
 TOTMf:4,XTA,
 ,AAX,=777
 ,ATI,9
 ,ITA,4
 ,ATX,ADRMf
 ,UTC,KHAPAb
 ,XTA,
 ,ASN,64-9
 4,ARX,
 ,AAX,=0037 7777 7777 7000
 4,XTS,
 ,AAX,=7740 0000 0000 0777
 15,AOX,
 4,ATX,
 4,UTM,1
C     i}EM zOHY
 LCHZ:9,VZM,CdBO{
 4,XTA,
 ,AAX,=1777
 ,AOX,=I0
 ,ATX,R1.HOMEP zOHy
 ,UTC,NZON
 ,X-A,
 ,U1A,CdBO{.HA{li MECTO
 ,XTA,R1
 ,UTC,NZON
 ,AEX,
 ,UZA,COBpzOH
 4,UTM,1
 9,UTM,-1
 ,UJ,LCHZ.CMOTPiM HivE
C     TAKAq zOHA bylA
 COBpzOH:,XTA,FLHAPAb
 ,U1A,YpO{.HAPAbOTKA.
 4,MTJ,10.PACpAKOBKA
 ,WTC,ADRMf.O{ibOK.
 ,XTA,.KOl-BO ClOB
 ,AAX,=777.C O{ibKAMi.
 ,ITS,4
 ,A-X,ADRMf.N ClOBA C O{.
 15,X-A,
 ,ATI,9.OCTAlOCx ClOB
 9,UTM,1.C O{ibKAMi.
 LPACp:10,XTA,
 ,UTC,NZON
 ,AEX,
 ,AAX,=1777
 14,VTM,
 ,U1A,EPACp.HE TA zOHA
 10,XTA,
 ,ASN,64+10
 11,VTM,-2.3 O{ibKi
 LPACp1:,ATX,R1.B ClOBE.
 ,AAX,=17.HOMEP
 ,ATI,12.O{ibKi.
 ,UZA,EPACp.bOlx{E HET.
 14,VTM,1
 ,XTA,R1
 ,ASN,64+4
 ,AAX,=377.KOl-BO O{ibOK.
 3,UTC,.KO{
 12,ARX,-1
 3,UTC,
 12,ATX,-1
  ,AEX,=I0
  ,ASN,64+8
  ,UZA,NO OVF
  ,XTA,=I255
  3,UTC,
  12,ATX,-1
  NO OVF:,BSS,
 ,XTA,R1
 ,ASN,64+12
 11,VLM,LPACp1
 10,UTM,1
 KOPCPp:,ITA,14
 ,ARX,CPACp
 ,ATX,CPACp
 9,UTM,-1
 9,V1M,LPACp
 ,UJ,YpO{
 EPACp:9,VTM,1
 ,UJ,KOPCPp
 YpO{:13,VJM,YpAK
 ,XTA,CYpAK
 ,UZA,RET
 ,AEX,CPACp
 ,UZA,zAHECO{.PABHy
 ,XTA,CYpAK
 15,ATX,
 ,A-X,CPACp. dlq CdBigA
 ,ATX,CYpAK.TAblicy.
 ,AAX,=777
 13,VTM,BCTCYp
 pPABKA:,BSS,
 ,WTC,ADRMf.pPABKA
 ,ARX,.dliHy
 ,WTC,ADRMf.O{ibOK
 ,ATX,
 ,XTA,
 ,UJ,CdBig
 BCTCYp:,BSS,
 ,STX,.BOCCTAHOBlEHiE
 ,ATX,CYpAK.C~ET~iKA O{ibOK
 ,UJ,zAHECO{
C     zOHA BpEPByE
 CdBO{:13,VJM,YpAK
 ,XTA,CYpAK
 ,UZA,RET
 13,VTM,zAHECO{
 ,UJ,pPABKA
C     pEPEpOlHEHiE TAblicy
 pEPEpOlH:,XTA,=I0
 2,ATX,
 RET:11,VTM,-3.BOCCTAHOBlEHiE
 ,NTR,6.PEviMA i
 LRSV:11,XTA,SAVM+3.MOdifiKATOPOB
 11,ATI,1+3
 11,VLM,LRSV
 ,XTA,M13
 ,STI,13
 13,UJ,.pO{li dOMOj.
C     YpAKOBKA O{ibOK
 YpAK:,XTA,FLHAPAb
 13,U1A,.HAPAbOTKA
 9,VTM,1
 LYp:,XTA,.YpAKOByBAEM
 ,ATX,R1.B R1
 LYp1:10,VTM,+3.3 O{ibKi
 11,VTM,.B OdHO ClOBO
 LYpAK:,UTC,KO{.MACCiB O{i=OK
 9,XTA,-1
 ,AAX,=377.KOl. O{ibOK
 ,UZA,ELYpAK.HYlx
 ,ASN,64-4
 ,ITS,9.HOMEP O{ibKi
 15,AOX,
 11,ASN,64.CdBig
 ,AOX,R1
 ,ATX,R1
 11,UTM,-12
 10,UTM,-1
 ELYpAK:,ITA,9
 ,AEX,LKO{.pPOCMOTPEli
 ,UZA,EYpAK.BCE
 9,UTM,1.HE BCE
 10,V1M,LYpAK
 KOPCYp:,XTA,CYpAK.KOl-BO
 ,ATI,10.YpAKOBAHHyX
 ,ARX,=1.ClOB
 ,ATX,CYpAK
 ,UTC,NZON.HOMEP
 ,XTA,.zOHy
 ,AAX,=1777
 ,XTS,R1
 ,ASN,64-10
 15,AOX,
 ,UTC,BUFYpAK.pEPECylKA
 10,ATX,.B bYfEP YpAKOBKi.
 13,UTC,
 9,VZM,.BCE O{ibKi
 ,UJ,LYp
 EYpAK:,ATI,9.KOH~ili
 ,XTA,R1.YpAKOBATx.
 13,UZA,.B pOClEdHEM ClOBE
 ,UJ,KOPCYp.O{ibKi ECTx.
C
 CbHAPb:,ENTRY,
C
C     CbOP HAPAbOTKi-~iClA pPOjdEHHyX
C     pOd MAgH. gOlOBKOj zOH.
C
C     ByzOB-CALL CbHAb(Ml/Md,BEG/CONT)
C
 8,BASE,C
 11,VTM,1.flAg CbHAPb
 ,UJ,BEGIN
C
 MAXL:,INT,5000.MAX.dliHA TAblic
 C48P:,OCT,4
 FLBEG/C:,BSS,1
 FLMl/Md:,BSS,1
 FLHAPAb:,BSS,1
 FLEND:,BSS,1
 CYpAK:,BSS,1
 CPACp:,BSS,1
 SAVM:,BSS,4
 M13:,BSS,1
 LKO{:,BSS,1
 ADRNAM:,BSS,1
 ADRMf:,BSS,1
 R1:,BSS,1
 R2:,BSS,1
 BUFYpAK:,BSS,3
 ,END,
 PAC:,NAME,
C----------------------------------------
C         gOlOBHAq pPgPAMMA
C         pE~ATi CbOPKi TAblic
C         CEPBiCA OpEPATOPA
C----------------------------------------
 *TYPE*:,LC,8.4-E {ifPA
 *PAGE*:,PC,2048.
 RECATO:,SUBP,.
 1,VTM,1
 ,CALL,PARAM
 ,XTA,=I0.
 ,ATX,*TYPE*.
 ,CALL,CATINP.
 ,CALL,TASK60LP.(izObPETEHO KAdAHcEByM C.g.)
 14,VTM,=I0
 ,ITS,14
 ,CALL,TMLMD
 14,VTM,=I1
 ,ITS,14
 ,CALL,TMLMD
 1,VTM,1.
 ,CALL,PARAM.
 ,CALL,SVML.
 1,VTM,11B
 ,CALL,PARAM.
 ,CALL,NEEDRS.
 ,CALL,PRMl
 ,SJ,
 ,END,
 PDAT:,NAME,
C----------------------------------------
C          pOdgOTOBKA dATy BBOdA
C         B BidE cElOgO ~iClA
C----------------------------------------
 12,BASE,*
 ,ATI,14.
 ,ITA,13.
 ,ATX,SI13.
 14,XTA,.
 ,APX,MASK.
 ,ATX,R.
 ,XTA,.
 ,ATX,R1.
 14,VTM,.
 13,VTM,1-3.
 PD1:,XTA,R.
 ,ASN,64-8.
 ,ATX,R.
 ,YTA,.
 14,ASN,64.
 ,AOX,R1.
 ,ATX,R1.
 14,UTM,-8.
 13,VLM,PD1....
 ,AOX,=I0.
 ,STX,.
 ,WTC,SI13.
 ,UJ,.....
 SI13:,BSS,1
 MASK:,GOST,6H'17''17''17''17''17''17'
 R:,BSS,1
 R1:,BSS,1
 ,END,
      PRCATI     :,NAME,
      *INFOP*    :,LC,  4
      *TYPE*     :,LC,  7
      *UPAS*     :,LC,  177B
      *OUTP*     :,LC,  370B
      FT*611     :,SUBP,
      FT*002     :,SUBP,
      FT*003     :,SUBP,
      FTTPRI     :,SUBP,
      ISOT     :,SUBP,
      GIVPAS     :,SUBP,
      RECATI     :,SUBP,
      RECATO     :,SUBP,
      PREPTL     :,SUBP,
      I*MUI*     :,SUBP,
      I*MU*I     :,SUBP,
LL332:,EQU,        *UPAS*    +1
LL325:,EQU,        *TYPE*    +1
LL334:,EQU,        *UPAS*    +64B
LL337:,EQU,        *OUTP*    +76B
LL333:,EQU,        *UPAS*    +61B
            14 ,  VTM,   *00001
                 , UJ,   *00255
 *00001    :13 ,  VJM,  PREPTL
            13 ,  VJM,  RECATO
            13 ,  VJM,  RECATI
             7 ,  XTA,  1
             7 ,  ATX,  9
                 ,NTR,  3
L                ,UTC,   *INFOP*   +1
                 ,XTA,
             7 ,  ATX,  10
            13 ,  VJM,   *00237
                 ,NTR,  22B
                 , UJ,   *00221
 *00011    : 7 ,  XTA,  10
                 ,NTR,  3
             7 ,  A-X,  2
            14 ,  VTM,   *00303
            13 ,  VJM,  I*MU*I
             7 ,  ATX,  8
            14 ,  VTM,   BSS+ 0000B
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,  GIVPAS
L                ,UTC,   L332     +44B
                 ,XTA,
                 ,ITS,
L                ,UTC,   L332     +57B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00023
                 , UJ,   *00024
 *00023    :     , UJ,   *00215
                 ,UTC,
 *00024    : 7 ,  XTA,  2
                 ,ITS,
L                ,UTC,   L332     +23B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00030
                 , UJ,   *00035
                 ,UTC,
 *00030    : 7 ,  XTA,  1
                 ,ITS,
                 ,UTC,  *TYPE*
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00034
                 , UJ,   *00035
                 ,UTC,
 *00034    :     , UJ,   *00215
                 ,UTC,
 *00035    : 7 ,  XTA,  1
                 ,ITS,
L                ,UTC,   *INFOP*   +3
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00041
                 , UJ,   *00042
                 ,UTC,
 *00041    :     , UJ,   *00054
                 ,UTC,
L*00042    :14 ,  VTM,   *UPAS*    +64B
                 ,ITS,  14
L           14 ,  VTM,   *INFOP*   +3
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0003B
                 ,ITS,  14
            13 ,  VJM,  ISOT
                 ,NTR,  3
                 ,NTR,  22B
             7 ,  XTA,  11
                 ,ITS,
                 ,UTC,  *INFOP*
                 ,XTA,
            15 ,  AEX,
                 ,UIA,   *00053
                 , UJ,   *00054
                 ,UTC,
 *00053    :     , UJ,   *00215
                 ,UTC,
 *00054    : 7 ,  XTA,  1
                 ,ITS,
L                ,UTC,   L332     +23B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00060
                 , UJ,   *00061
                 ,UTC,
 *00060    :     , UJ,   *00163
                 ,UTC,
 *00061    : 7 ,  XTA,  22B
             7 ,  ATX,  12
                 ,NTR,  3
             7 ,  XTA,  2
             7 ,  ATX,  13
            13 ,  VJM,   *00251
                 ,NTR,  22B
                 ,UTC,
 *00065    : 7 ,  XTA,  10
                 ,ITS,
                 ,WTC,   BSS+ 0005B
             1 ,  VTM,
L            1 ,  UTC,   L325     +77777B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00072
                 , UJ,   *00076
                 ,UTC,
 *00072    :     ,WTC,   BSS+ 0005B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0012B
                 ,XTA,
             7 ,  ATX,  12
                 ,NTR,  3
                 ,NTR,  22B
                 ,UTC,
 *00076    : 7 ,  XTA,  13
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  13
            13 ,  VJM,   *00251
             7 ,  X-A,  3
                 ,NTR,  22B
                 ,UZA,   *00065
             7 ,  XTA,  1
             7 ,  ATX,  14
                 ,NTR,  3
             7 ,  XTA,
                 ,ITS,
                 ,WTC,   BSS+ 0002B
             1 ,  VTM,
L            1 ,  UTC,   *OUTP*    +77777B
                 ,XTA,
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00111
                 , UJ,   *00112
 *00111    :     , UJ,   *00134
                 ,UTC,
 *00112    : 7 ,  XTA,  2
             7 ,  ATX,  13
                 ,NTR,  3
            13 ,  VJM,   *00251
                 ,NTR,  22B
                 ,UTC,
 *00115    :     ,WTC,   BSS+ 0005B
             1 ,  VTM,
L            1 ,  UTC,   L334     +77777B
                 ,XTA,
                 ,ITS,
                 ,WTC,   *00275
             2 ,  VTM,
L            2 ,  UTC,   L337     +77774B
                 ,XTA,
            15 ,  AEX,
                 ,UIA,   *00123
                 , UJ,   *00124
 *00123    :     , UJ,   *00134
                 ,UTC,
 *00124    : 7 ,  XTA,  13
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  13
            13 ,  VJM,   *00251
             7 ,  X-A,  3
                 ,NTR,  22B
                 ,UZA,   *00115
                 ,WTC,   BSS+ 0002B
             1 ,  VTM,
L            1 ,  UTC,   *OUTP*    +77777B
                 ,XTA,
             7 ,  ATX,  14
                 ,NTR,  3
                 ,NTR,  22B
 *00134    :14 ,  VTM,   *00304
                 ,ITS,  14
            14 ,  VTM,   *00270
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0016B
                 ,ITS,  14
            13 ,  VJM,  FT*611
            14 ,  VTM,   BSS+ 0004B
                 ,ITS,  14
            13 ,  VJM,  FT*002
                 ,NTR,  3
            14 ,  VTM,   BSS+ 0002B
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,  FT*002
             7 ,  XTA,  10
                 ,NTR,  3
            13 ,  VJM,   *00237
            14 ,  VTM,   BSS+ 0006B
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,  FT*002
                 ,NTR,  3
             7 ,  XTA,  2
             7 ,  ATX,  15
                 ,NTR,  22B
 *00153    :     ,WTC,   BSS+ 0007B
             1 ,  VTM,
L            1 ,  UTC,   L333     +77777B
            14 ,  VTM,
                 ,ITS,  14
            13 ,  VJM,  FT*002
             7 ,  XTA,  15
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  15
             7 ,  X-A,  3
                 ,NTR,  22B
                 ,UZA,   *00153
            13 ,  VJM,  FT*003
                 , UJ,   *00204
                 ,UTC,
 *00163    :14 ,  VTM,   *00304
                 ,ITS,  14
            14 ,  VTM,   *00273
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0016B
                 ,ITS,  14
            13 ,  VJM,  FT*611
            14 ,  VTM,   BSS+ 0002B
                 ,ITS,  14
            13 ,  VJM,  FT*002
             7 ,  XTA,  10
                 ,NTR,  3
            13 ,  VJM,   *00237
             7 ,  XTA,  2
             7 ,  ATX,  15
                 ,NTR,  22B
                 ,UTC,
 *00175    :     ,WTC,   BSS+ 0007B
             1 ,  VTM,
L            1 ,  UTC,   L333     +77777B
            14 ,  VTM,
                 ,ITS,  14
            13 ,  VJM,  FT*002
             7 ,  XTA,  15
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  15
             7 ,  X-A,  3
                 ,NTR,  22B
                 ,UZA,   *00175
            13 ,  VJM,  FT*003
 *00204    :14 ,  VTM,   BSS+ 0016B
                 ,ITS,  14
            14 ,  VTM,   *00302
                 ,ITS,  14
            13 ,  VJM,  FTTPRI
             7 ,  XTA,  9
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  9
L                ,UTC,   *INFOP*   +2
                 ,A-X,
                 ,NTR,  22B
                 ,UZA,   *00214
                 , UJ,   *00215
                 ,UTC,
 *00214    :     , UJ,   *00231
                 ,UTC,
 *00215    : 7 ,  XTA,  10
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  10
            13 ,  VJM,   *00237
                 ,NTR,  22B
                 ,UTC,
 *00221    : 7 ,  X-A,  7
                 ,UZA,   *00011
             7 ,  XTA,  1
                 ,ITS,
             7 ,  XTA,  9
            15 ,  AEX,
                 ,UZA,   *00225
                 , UJ,   *00231
 *00225    :14 ,  VTM,   *00267
                 ,ITS,  14
            14 ,  VTM,   *00266
                 ,ITS,  14
            13 ,  VJM,  FTTPRI
                 ,NTR,  3
                 ,NTR,  22B
 *00231    :     , UJ,   *00263
                 ,UTC,
 *00232    : 7 ,  XTA,  3
             7 ,  A+X,  77777B
             7 ,  ATX,  77777B
             7 ,  XTA,  2
             7 ,  A+X,  20B
             7 ,  ATX,  20B
            13 ,   UJ,
                 ,UTC,
                 , UJ,   *00232
                 ,UTC,
 *00237    : 7 ,  A-X,  20B
             7 ,  ATX,  20B
             7 ,  XTS,  3
            14 ,  VJM,  I*MUI*
             7 ,  A+X,  77777B
             7 ,  ATX,  77777B
             7 ,  XTA,  10
             7 ,  ATX,  20B
            13 ,   UJ,
                 ,UTC,
 *00244    : 7 ,  XTA,  2
             7 ,  A+X,  77777B
             7 ,  ATX,  77777B
             7 ,  XTA,  2
             7 ,  A+X,  21B
             7 ,  ATX,  21B
            13 ,   UJ,
                 ,UTC,
                 , UJ,   *00244
                 ,UTC,
 *00251    : 7 ,  A-X,  21B
             7 ,  ATX,  21B
             7 ,  A+X,  77777B
             7 ,  ATX,  77777B
             7 ,  XTA,  13
             7 ,  ATX,  21B
            13 ,   UJ,
                 ,UTC,
 *00255    : 7 ,  MTJ,  8
            14 ,  MTJ,  10
             7 ,  VTM,   *00276
                 ,ITS,  13
                 ,ITS,  1
                 ,ITS,  2
                 ,ITS,  8
                 ,ITS,
                 ,NTR,  3
                 ,NTR,  2
            10 ,   UJ,
                 ,UTC,
 *00263    :     ,STI,
                 ,STI,  7
                 ,STI,  2
                 ,STI,  1
                 ,STI,  8
             8 ,   UJ,
 *00266    :,     LOG,  64000000 00000001.
 *00267    :,     LOG,  22042524 10020040.
 *00270    :,     LOG,  12040463 13031117.
            ,     LOG,  14423472 11631501.
            ,     LOG,  15424440 10020040.
 *00273    :,     LOG,  12054054 23631047.
            ,     LOG,  16423463 20233051.
 *00275    :,     LOG,  64000000 00000000.
 *00276    :,     LOG,  00000000 00000000.
            ,     LOG,  64000000 00000000.
            ,     LOG,  64000000 00000001.
            ,     LOG,  64000000 00000003.
 *00302    :,     LOG,  64000000 00000005.
 *00303    :,     LOG,  64000000 00000020.
 *00304    :,     LOG,  64000000 00000032.
            ,     LOG,  64000000 00000076.
 BSS       :     ,BSS,  23B
       ,DATA,.  :,ENTRY,
 *00306    :,     LOG,  10020055 10020040.
            ,     LOG,  36632455 10020040.
            ,     LOG,  36633055 10020040.
            ,     LOG,  36633455 10020040.
                4,SET,   *00306
                1,   ,   BSS+ 0012B
      ,END,
 PREPTL: ,NAME,
C
C*******   OpPEdElEHiE KOl-BA CiMBOlOB ObPAzA
C         dOpOlH. BBOd HOMEPOB
C         ObPA}EHiE : CALL PREPTL
C
 *INFOP*:LC,BLOCK,ENAM,NBEG,NPRI,LL
 *TYPE*:LC,BLOCK,ITYP,(6)
 ,CONT,(1).dObABO~KA pETPOBY
 *8: ,BLOCK,B,L
C         OpPEdElEHiE dliHy ObPAzA
 BAS: ,BSS,
 ,XTA,ENAM
 L,VTM,
 DEF: ,UZA,STEP2. KOHEc ObPAzA
 ,ASN,64-6
 L,UTM,1
 ,UJ,DEF
 STEP2: ,BSS,
 B,BASE,BAS
 ,ITA,L
 ,AOX,INTO
 ,ATX,LL .dliHA ObPAzA
 ,XTA,ITYP
 ,ATI,L
 ,AAX,B1
 ,AOX,INTO
 ,ATX,ITYP
 ,ITA,L
 ,ASN,64+1
 ,UZA,RET
 ,ITA,13
 ,XTS,
 12,VTM,*NN   . BBOd
 ,CALL,OTCONT . HOMEPOB
 ,STX,
 ,ATI,13
 ,XTA,NN+1
 ,UZA,RET
 ,ASN,64+6
 ,AAX,C77.
 ,UZA,PUT NB
 ,AOX,INTO
 ,ATX,NPRI.OgPAHi~.pE~ATi
 PUTNB:,XTA,NN+1
 ,AAX,C77
 ,UZA,RET
 ,AOX,INTO
 ,ATX,NBEG . HA~. N pPOCMOTPA
 RET: ,BSS,
 13,UJ,
 *NN: ,Z01,NN
 ,Z00,TNN
 ,LOG,
 TNN:,ISO,6HNN-!''
 NN: ,BSS,2
 INTO: ,INT,0
 C77: ,LOG,77
 B1: ,LOG,1
 ,END,
 PRMl:,NAME,
 *K*:,LC,1
 *TAbl*:,LC,4
 1,VTM,-47
 2,VTM,-7
 ,XTA,
 ,ATX,YCTP
 ,XTA,ISOCON+6
 ,ATX,*TAbl*+3
 ,XTA,=1
 ,ATX,NApP
 ,ATX,*K*
 ,CALL,PECH
 ,XTA,=2
 ,ATX,*K*
 ,*63,505B
 ,ATI,5
 5,UTM,-16
 *C4:1,VZM,*C2
 ,XTA,YCTP
 ,AEX,=10
 ,U1A,*C3
 ,XTA,
 ,ATX,YCTP
 ,XTA,NApP
 ,ARX,=1
 ,ATX,NApP
 *C3:,BSS,
 2,VTM,-7
 1,UTC,47
 5,*63,
 ,AAX,CONS5
 ,ATX,iMq
 *C6:2,XTA,CTEXT+7
 ,AEX,iMq
 ,UZA,*C5
 2,UTM,1
 2,V1M,*C6
 2,VTM,-7
 ,XTA,YCTP
 ,ARX,=1
 ,ATX,YCTP
 1,VLM,*C4
 ,UJ,*C2
 *C5:,BSS,
 1,UTM,1
 ,XTA,NApP
 ,ARX,=1
 ,AAX,KB
 ,UZA,*C1
 ,XTA,NApP
 ,ASN,64-3
 ,AOX,YCTP
 ,ATX,NOMf
 ,ASN,64-3
 ,AOX,CONS6
 ,*57,400B
 ,AAX,CONS7
 ,U1A,*C4
 2,XTA,ISOCON+7
 ,ATX,*TAbl*
 1,UTC,+46
 5,*63,
 ,CALL,TO MAN*
 ,ASN,64+8
 ,AOX,C1
 ,ATX,*TAbl*+1
 ,XTA,NOMf
 ,ATX,*TAbl*+2
 ,XTA,ISOCON+6
 ,ATX,*TAbl*+3
 ,CALL,PECH
 ,XTA,YCTP
 ,ARX,=1
 ,ATX,YCTP
 ,UJ,*C4
 *C1:,*63,504B
 ,ATI,6
 6,UTM,-16
 1,UTC,+46
 6,*63,
 ,AAX,CONS1
 ,ATI,4
 ,*65,576B.
 ,ATI,7
 4,UTC,
 7,*63,-1
 ,AAX,CONS3
 ,U1A,*C3
 4,UTC,
 7,*63,-1
 ,AAX,CONS2
 ,ASN,64+30
 ,ATX,*TAbl*+2
 2,XTA,ISOCON+7
 ,ATX,*TAbl*
 ,XTA,CONd
 ,ATX,*TAbl*+3
 1,UTC,+46
 5,*63,
 ,CALL,TO MAN*
 ,ASN,64+8
 ,AOX,C1
 ,ATX,*TAbl*+1
 ,XTA,YCTP
 ,ARX,=1
 ,ATX,YCTP
 13,VTM,*C4
 ,UJ,PECH
 *C2:,XTA,
 ,ATX,CR
 ,ATX,R2
 ,ATX,fAil
 ,XTA,=4
 ,ATX,*K*
 ,CALL,PECH
 ,XTA,=3
 ,ATX,*K*
 ,CALL,PECH
 ,XTA,=5
 ,ATX,*K*
 ,XTA,
 ,ATX,CR1
 3,VTM,-7
 ,*65,575B.
 ,ATI,1.
 1,UTM,34.
 *C9:,BSS,
 ,XTA,fAil
 ,ARX,=1
 ,ATX,fAil
 3,UTC,+7
 1,*63,
  ,UZA,*C10
 ,AAX,CONS4
 ,ASN,64+15
 ,ATI,4
 4,UTC,
 7,*63,-1
 ,UZA,*C10
 ,ATX,R1
 ,AAX,CONS3
 ,UZA,*C8
 *C10:3,VLM,*C9
 ,UJ,KOHEc
 *C8:,XTA,CR
 ,ARX,=1
 ,ATX,CR
 ,XTA,R1
 ,AAX,CONS2
 ,ASN,64+30
 ,ATX,*TAbl*+2
 3,UTC,+7
 1,*63,
 ,AAX,CONS8
 ,AEX,CONS8
 ,ATX,*TAbl*+3
 ,ARX,CR1
 ,ATX,CR1
 ,XTA,fAil
 ,ATX,*TAbl*+1
 ,XTA,Kf
 ,ATX,*TAbl*
 ,CALL,PECH
 3,VLM,*C9
 KOHEc:,XTA,=6
 ,ATX,*K*
 ,XTA,CR1
 ,ATX,*TAbl*+2
 ,XTA,SUMMA
 ,ATX,*TAbl*
 ,XTA,S
 ,ATX,*TAbl*+1
 ,CALL,PECH
 ,SJ,
 NApP:,BSS,1
 iMq:,BSS,1
 NOMf:,BSS,1
 fAil:,BSS,1
 YCTP:,BSS,1
 R1:,BSS,1
 R2:,BSS,1
 R3:,BSS,1
 CR:,BSS,1
 CONST:,BSS,1
 SUMMA:,ISO,6HSUMMA
 S:,ISO,6HSCR-f=
 C1:,ISO,6H/00000
 CONS1:,LOG,77777
 CONS2:,OCT,0000 77
 CONS3:,GOST,6H00'020'000
 CONS4:,GOST,6H'377''377''377''377''200'0
 CONS5:,GOST,6H'377''377''377''377''360'0
 CONS6:,GOST,6H'377''377''377''377''376'0
 CONS7:,GOST,6H'100'00000
 CONS8:,GOST,6H0000'177''377'
 KB:,GOST,6H'377''377''377''377''377''374'
 K1:,GOST,6H00000'001'
 Kf:,ISO,1Hf
 CONd:,ISO,1Hd
 ISOCON:,ISO,6HLIBRAR
 ,CONT,6HD73INP
 ,CONT,6HD73OUT
 ,CONT,6HD73LIB
 ,CONT,6HD73STA
 ,CONT,6HM
 ,CONT,6H
 CTEXT:,TEXT,8HLIBRAR'0''0'
 ,CONT,8HD73INP'0''0'
 ,CONT,8HD73OUT'0''0'
 ,CONT,8HD73LIB'0''0'
 ,CONT,8HD73STA'0''0'
 ,CONT,8HM     '0''0'
 ,CONT,8H      '0''0'
 CR1:,BSS,1
 ,END,
 PRT1:,NAME,
 *TBUF*:LC,BLOCK,BUF(10),L
 *REGIM//:LC,BLOCK,REGIM///
 ,XTA,
 ,UTC,REGIM///
 ,ATX,
 ,ITA,13
 ,ATX,I13
  14,VTM,BUF
 ,ITS,14
 ,WTC,L
 14,VTM,BUF-1
 ,ITS,14
 14,VTM,1
 ,ITS,14
 ,CALL,PRINT8//
 ,WTC,I13
 ,UJ,
 I13:,BSS,1
 ,END,
 PULT:,NAME,
 TABLGO2:,SUBP,
 ,ITA,1.
 ,ATX,R.
 ,AAX,=777.
 ,ATI,13.
 13,UTM,-1.
 ,*63,3
 ,ATI,1.
 13,UJ,TABLGO2
 R:,BSS,1
 ,END,
  RBG:,NAME,.16 06 80 lBb
C  +++  lBb 02.10.80
C  CALL RBG('')  lBb 23.10.80
 NEL*:,LC,1
 NZ:,LC,1
 PAGEBG:PC,BLOCK,P(1024)
 STAT:,EQU,0
 TIM/TYP:,EQU,1
 LEN:,EQU,1
 HEAD:,EQU,8
 BEGIN:,EQU,15.=8 + 7(42 bAjTA)
 *C:,ITS,13
 13,VTM,12
 SAV/I:13,ITS,.13-1PP
 13,UTM,-1
 13,V1M,SAV/I
 1,BASE,*C
 ,XTS,
 ,RTE,77B
 ,ATX,RG
 15,WTC,-14.SUM
 ,XTA,
 ,ATX,BUF
 4,VTM,NEL*
 4,XTA,.
 ,U1A,CHECK
 ,MOD,.HET pAPAMTPA
C  vdEM pPiKAz 'ALL '
 W ALL:14,VTM,BUF
 2,VJM,READ
 CHECK:,XTA,BUF
 ,AEX,ALL
 ,U1A,W ALL
C OTKPOEM gPAf-ByBOd:
 ,CALL, RB OPEN
 11,XTA,.=NZ
 ,UZA,OUT
 12,XTA,STAT.iz KAT
 ,ASN,64+36.44-37PP
 ,AAX,C377.N PiC.
 ,ASN,64-24.3-j bAjT
 4,XTS,.18-10
 ,ASN,64+9.NEL
 ,AAX,C377
 ,ASN,64-16.NByB 4-j bAjT
 15,AOX,
 ,AOX,=6H'377''377'''''''''
 ,ATX,BCEgO
 12,XTA,TIM/TYP.YpP.iz KAT
 ,ATX,BCEgO+1.TIME
 5,VTM,0.flAg HEAD
 ~T zOHy:3,VTM,P
 ,CALL,RB NEXT
 10,XTA,.=NEL*
 ,UZA,BCE.-O{.CpiCKA
 5,V1M,~T zOH
 3,XTA,BEGIN
 ,ASN,64+8.iz 4-5 bAjTOB
 ,AAX,C177777.5,6 bAjTy
 ,AOX,BCEgO.X,Y
 3,ATX,HEAD
 ,XTA,BCEgO+1
 3,ATX,HEAD+1
C  HEAD+1 = TIME  DDMMYYHHMMSS i 4 Ml.PP=0
C     2-3 = fiO   /ISO
C     4-6 = NAME  /ISO
C  BEGIN  iMEET CTPYKTYPY:
C  bAjTy HYMEPOBAHy BpPABO: 123456
C  bAjTy 1-2= CpEc.KOd 177777B
C         3 = HA~AlO gPAfiKA: KOd 300B
C         4 = dliHA gPAfiKA C HAdpiCqMi
C             pO PYlOHY B CM
C         5 = {iPiHA gPAfiKA C HAdpiCqMi Y
C         6 = HE iCp.(=0)
 ~T zOH:,ITA,3
 ,ARX,B4
 ,ATX,AdP
 3,XTA,LEN
 ,ATX,dliHA
 ,ATX,BCEgO
 NEXT:,XTA,dliHA
 5,VTM,NZ
 ,NTR,3
 ,A-X,C360
 ,U1A,OCTATOK
 ,ATX,dliHA
C BydAEM O~EPEdHOj blOK:
 ,XTS,AdP
 14,VTM,C360.KOl-BO
 ,ITS,14
 6,VTM,CdBig
 SEND:,BSS,.p/p BydA~i
 ,CALL,LINK*W
C vdEM OTBET: 'GIVE'
 14,VTM,BUF
 2,VJM,READ
 ,XTA,BUF
 ,AEX,GIVE
 6,UZA,.GIVE
 ,UJ,CHECK
C CdBiHEMCq pO liCTY-bYfEPY:
 CdBig:,BSS,
 ,XTA,AdP
 ,ARX,C50
 ,ATX,AdP
 ,UJ,NEXT
 OCTATOK:,A+X,C360
 ,AAX,C177777
 ,UZA,BCE.-Hi~EgO
 ,ATX,XBOCT
C pOCylAEM XBOCT C liCTA:
 ,XTS,AdP
 14,VTM,XBOCT
 ,ITS,14
 6,VJM,SEND
C  pPOBEPKA: ECTx li E{E ByBOd:
 5,XTA,
 ,U1A,~T zOHy.-ECTx
C fAjl BydAH BECx:
 BCE:,CALL,RB CLOS
 OUT:15,WTC,-14.SUM
 ,XTA,
 ,AEX,ALL
 ,UZA,BOCCT
C BydAEM 'ALL ':
 14,VTM,ALL
 ,ITS,14
 14,VTM,C4
 ,ITS,14
 ,CALL,LINK*W
 14,V1M,W ALL
 BOCCT:,XTR,RG
C  BOCCT. 1-13 iP i PEviMA AY:
 ,STX,
 14,VTM,-12
 UP/I:14,STI,13
 14,VLM,UP/I.
 ,STX,.1 OpEP
 13,UJ,
  READ:,ITS,14
 14,VTM,C4
 ,ITS,14
 14,VTM,RL
 ,ITS,14
 ,CALL,LINK*R
 2,UJ,
 B4:,LOG,10
 B1:,LOG,1
 C4:,LOG,4
 C7:,LOG,7
 C50:,LOG,50
 C360:,LOG,360
 C377:,LOG,377
 C177777:,LOG,177777
 ALL:,ISO,6HALL ''''
 GIVE:,ISO,6HGIVE''''
 RG:,BSS,1
 BCEgO:,BSS,1
 dliHA:,BSS,1
 AdP:,BSS,1
 XBOCT:,BSS,1
 BUF:,BSS,1
 RL:,BSS,1
 ,END,
 READCG:,NAME,
  *P*:,PC,2048
  *CAT*:,EQU,*P*
 *NZ1*:,LC,1
 *FL*:,LC,1
 11,BASE,*
 ,ITA,13
 ,ATX,I13
 14,VTM,*P*+1762B.
 14,XTA,.
 ,AEX,=6HOVERLA
 ,UIA,NOOV.
 14,XTA,1.
 ,AEX,=4HY OT
 ,UIA,NOOV.
 ,XTA,=I2
 ,UTC,*FL*
 ,ATX,
 ,UJ,PRINT.
 NOOV:,UTC,*P*.
 ,XTA,1400B.
 ,AEX,MONAM
 ,UIA,NO SYS.
 ,XTA,=I3
 ,UTC,*FL*.
 ,ATX,.
 14,VTM,*P*+1776B.
 ,UJ,PRINT.
 NO SYS:,BSS,.
 12,VTM,*CAT*-2
 12,XTA,2
 ,AAX,=2000000
 ,UZA,KAPUT
 12,XTA,2
 ,AAX,=70 0000
 ,UZA,KAPUT
 12,XTA,2
 ,AAX,=7777 7777 7000 0037
 ,U1A,KAPUT
 12,XTA,3
 ,U1A,KAPUT
  14,VTM,END
  ,CALL,GIVEME
  ,ARX,=:0000 0100
  ,ATX,WRW
  ,ATX,FL
  ,*70,WRW
 COUNT:12,XTA,2
 12,UTM,2
 12,MTJ,14
 14,UTM,-2048-*CAT*
 14,VZM,KAPUT
 ,UZA,*CON
 ,UJ,COUNT
 *CON:,BSS,
 12,XTA,1
 ,AEX,=7777 7777 7777 7777
 ,U1A,KAPUT
 12,MTJ,14
 14,UTM,2
 14,XTA,
 ,AEX,TE
 ,U1A,KAPUT
 14,XTA,1
 ,AEX,TE+1
 ,U1A,KAPUT
 ,XTA,=6400 0000 0000 0001
 ,UTC,*FL*
 ,ATX,
 PRINT:,ITS,14
 14,UTM,12
 ,ITS,14
  ,XTS,=32
 ,CALL,PRINT8
 END:,BSS,
  KAPUT:,BSS,
  ,XTA,FL
  ,UZA,RET
  ,XTA,
  ,ATX,FL
  14,VTM,1-1024
  13,VTM,*CAT*
  12,VTM,*CAT*+1024
  COPY:,BSS,
   14,UTC,
  12,XTA,1023
  14,UTC,
  13,ATX,1023
   14,VLM,COPY
  RET:,BSS,
 ,XTA,I13
 ,ATI,13
 13,UJ,
 MONAM:,TEXT,8HMONITOR*.
  FL:,OCT,
 TE:,ISO,12HLIBRARY OT
 WRW:,BSS,1
 I13:,BSS,1
 ,END,READCG
 RE CAT G:,NAME,.lBb 15 06 80
C +++ lBb 23.10.80
 NEL*:,LC,1
 NZ:,LC,1
 TYPE:,LC,1
 PAGEBG:PC,BLOCK,P(1024)
 NP:,P/P,(PAGEBG)1024
 NP1:,P*P,(NP)64.liCT ~T
C
 STAT:,EQU,0
 TIM/TYP:,EQU,1
 SCFRC:,EQU,1720B
 SCFRZ:,EQU,1740B
 |K*57:,SUBP,
C  |TOT BXOd - ObqzATElxHyj YCTAHOBO~Hyj ByzOB
C OfOPMiM iHf.ClOBA
 *C:8,BASE,*C
 ,XTA,PP
C PP - AdPEC liCTA KATAlOgA - PEz-T
 ,ITS,13
 ,XTS,PP
 ,AOX,=:12
 ,ATX,WCAT
 ,XTA,RNP1
 ,AOX,=:16
 ,ATX,RZ
 ,XTA,PP
 ,AOX,=:02
 ,XTS,PP
 ,AOX,=:06
C ~iTAEM KATAlOg:
 ,ATX,RCAT
 14,VJM,|K*57
  ,STX,.MNPL-OFF
 14,VJM,|K*57
 11,VTM,0.ADR REZ
 ,UJ,OUT
 A/EL:,ENTRY,
 A/EL:10,VTM,NEL*
 10,XTA,
 ,ASN,64-2
 10,ARX,
 ,ASN,64+9.NEL*5
 ,UTC,PP
 ,AOX,.+ bAzA
 ,ATI,12.=AEL
 13,UJ,
 RB OPEN:,ENTRY,
 ,ITS,13
 8,BASE,*C
 ,XTS,
C By~.AdPECA EL
 13,VJM,A/EL
C HAjdEM HA{ gPAf:ByBOd
 12,XTA,STAT
 10,AEX,.NEL
 ,AAX,C18/10
 11,VTM,NZ
 ,U1A,ER.HE HA{ EL
 12,XTA,2
 ,UZA,ER.NAME=0
 12,XTA,TIM/TYP
 ,AEX,TYPE
 ,AAX,C17.Tip dAHHyX
 ,U1A,ER.-HE HA{
 12,XTA,STAT
 ,AAX,B47
 ,U1A,ER.HE gOTOB
 12,XTA,STAT
 ,AAX,M/CTRL
C  N BB,  N lAb,  N ByB
 ,ATX,CONTROL
 ,UJ,Z SC FR
 NEW SC Z:,ENTRY,
 ,ITS,13
 8,BASE,*C
 ,XTS,
 11,VTM,0
 12,VTM,P
 Z SC FR:13,VTM,0.HOMEPA zOH
C HYliM {KAlY iCpOlxzOBAHHyX zOH:
 14,VTM,-15
 L0:,BSS,
 ,ITA,13
 14,UTC,15
 ,ATX,SCFR
 13,UTM,32
 14,VLM,L0
 12,XTA,STAT
 OUT:,AAX,=777.NZ
 11,STX,
 ,STI,13
 13,UJ,
  RB NEXT:,ENTRY,
 ,ITS,13
 8,BASE,*C
 11,VTM,NZ
 11,XTS,
 10,VTM,NEXT Z
 ,UJ,TO SC Z
 GNZ:,ENTRY,
C  zAXBAT HOBOj zOHy
 ,ITS,13
 8,BASE,*C
 ,XTS,PP
 11,VTM,NZ
 ,AOX,=:26.GIV Z
 14,VJM,|K*57
 ,UZA,OUT.HET
 11,ATX,
 10,VTM,OUT
 TO SC Z:,BSS,
C  HAKOplEHiE iCpOlxzOBAHHyX zOH:
 ,ASN,64+5
 ,ATI,14
 ,ASN,64-5
 11,AEX,
 ,ATI,13
 ,XTA,B48
 13,ASN,64
 ,UTC,SCFR
 14,AOX,
 ,UTC,SCFR
 14,ATX,
 11,XTA,.=NZ
 10,UJ,
 SAVE SC Z:,ENTRY,
 14,VTM,-15
 LOOP SC:,UTC,SC FR
 14,XTA,15
 ,UTC,SC Z
 14,ATX,15
 14,VLM,LOOP SC
 13,UJ,
 NUMBER Z:,ENTRY,
C  By~iClEHiE HOMEPA zOHy pO {KAlE
 ,ITS,13
 8,BASE,*C
 ,XTS,
 11,VTM,NZ
 12,VTM,-15
 IN1:,BSS,
 ,UTC,SC Z
 12,XTA,15
 ,AAX,=:77777 77777 6
 ,U1A,IN2
 12,VLM,IN1
 ,UJ,OUT.HET zOH
 IN2:,BSS,
 ,ANX,=77777
 ,ATI,13
 13,*65,700B.BIT I
 ,UTC,SC Z
 12,AEX,15
 ,UTC,SC Z
 12,ATX,15.gA{EHiE
 ,ITA,13
 ,UTC,SC Z
 12,ARX,15.HOMEP zOHy
 ,UJ,OUT
 NEXT Z:,BSS,
C  ~TEHiE O~EPEdHOj zOHy:
 10,VTM,NEL*
 12,VTM,P
 11,XTA,
 ,AOX,RZ
 14,VJM,|K*57
 12,XTA,STAT
 ,AEX,CONTROL
 ,AAX,M/CTRL
 ,U1A,ER.~YvAq zOHA
 12,XTA,STAT
 ,UJ,OUT
  RB CLOS:,ENTRY,
 ,ITS,13
 8,BASE,*C
C ~iCTKi B KATAlOgE:
 ,XTS,RCAT
 14,VJM,|K*57
 13,VJM,A/EL
 12,XTA,STAT
 ,UZA,ER
 ,AAX,B48/47
 ,UZA,WC.YvE O~i}EH
C ~iCTKA {KAly |lEMEHTOB:
 10,XTA,.NEL
 11,VTM,P
 ,ASN,64-30.18-10PP
 ,AUX,=37 00017.1+(4+4)
 ,ATI,13
 ,ASN,64+15
 ,ATI,14
 ,XTA,B48
 13,ASN,64
 14,UTC,
 11,AOX,SCFRC
 14,UTC,
 11,ATX,SCFRC
C  ~iCTKA {KAly zOH gPAf-ByBOdA:
 14,VTM,-15
 LZ: 14,UTC,15
 ,XTA,SCFR
 14,UTC,15
 11,AOX,SCFRZ
 14,UTC,15
 11,ATX,SCFRZ
 14,VLM,LZ
C ~iCTKA |lEMEHTA:
 12,XTA,STAT
 ,ASN,64-3
 ,ASN,64+3
 12,ATX,STAT.48-46PP:=0
C  zApiCx B KATAlOg:
 WC:,BSS,
 ,XTA,WCAT
 14,VTM,OUT
 ,UJ,|K*57
 ER:,XTA,
 10,ATX,.gA{Y NEL*
 ,UJ,OUT
 PP:,Z00,
 ,Z00,P
 RNP1:,Z01,NP1.~T.HA NP1
 ,Z00,
 C18/10:,LOG,777 000
 B48:,OCT,4
 B47:,OCT,2
 B48/47:,OCT,6
 C17:,LOG,17
 M/CTRL:,LOG,77 77 777 000
 WCAT:,BSS,1
 RCAT:,BSS,1
 RZ:,BSS,1
 AEL:,BSS,1
 CONTROL:,BSS,1
 SCFR:,BSS,16
 SC Z:,BSS,16
 ,END,
 RECATO:,NAME,.
C
C******   CEPBiCHyE pPOcEdYPy BydA~i
C         iHfOPMAcii iz KATAlOgOB
C
 A/ipK:,EQU,761B.
 MN*TL:,EQU,1067B
 *TYPE*:LC,BLOCK,(8)
 *0:,BLOCK,(1),SHI(4),NFC,NFZ,NRJ
 *SHIT*:,LC,12
 *OUTP*:LC,BLOCK,NByB(62),NAMO(186)
 *OUTCAT*:LC,BLOCK,CBqzx(63),READY(63)
 ,CONT,NBB(63),*NAME(189)
 WNU:,EQU,0.
 STAT:,EQU,0
 TIM/TYP:,EQU,1
 *UPAS*:LC,BLOCK,(128)
 *0:,BLOCK,X1,BIT(48),NAM(3),NAM1(3)
 ,CONT,TIN,DIN(3),TUS,LPUS,NPMd
 ,CONT,Ml(16),Md(16),MlE(32)
 ,CONT,LINK
 *PAGE*:PC,BLOCK,CAT(1024),(1024)
 BUSYSC:,EQU,CAT+1720B.
 NJOBS:,EQU,CAT+1772B.
 NPCA:,P/P,(CAT)16
 A TMT:,EQU,504B.
  ATNMT:,EQU,505B
 *8:,BLOCK,B,IO(0),AC
 ,CONT,T(0),R(0),AP
 ,CONT,L,A,NI
 ,XTA,
 ,UTC,WS
 ,ATX,
 BAS:,XTA,.
 14,VTM,1-248.
 CL OUT:14,UTC,NByB+247.
 ,ATX,.
 14,VLM,CL OUT.
 B,BASE,BAS.
 ,ITA,13.
 ,ATX,I13.
 *PAR*:LC,BLOCK,ID,ID1
 END:,SUBP,.ENTRY TASK75
 14,VTM,ID
 14,XTA,
 ,AAX,=4
 ,UZA,OUTJ
 14,ARX,1.ID1=0,1,2,3
 ,ATI,IO.=4-7
 ,XTA,RCG
 |K*57:,SUBP,
 14,VJM,|K*57.READ CAT GRAF
 ,XTA,FCG
 14,VJM,|K*57.FREE CAT
 ,UJ,ANALIZ
 OUTJ:,BSS,
 IO,VTM,1.~TEHiE
 R,VJM,EXCH.KATAl.ByBOdA
 ANALIZ:,BSS,
 ,UZA,RET. - EgO HET
 A,VTM,CAT.
 ,XTA,WS
 ,UIA,RECO
 L,VTM,1-63.
 L OUT:A,XTA,WNU.
 ,ASN,64+24
 ,AAX,=77.HOMEP
 ,UZA,LO 2
 ,ATI,NI.pO BBOdY
 L,UTC,62
 14,VTM,.N ByBOdA
 ,ITS,14.
 ,AOX,INT0.
 NI,UTC,NByB-1.
 ,STX,.
 15,ATX,.
 ,ASN,64-1.
 15,ARX,.
 ,ATI,NI.
 14,VTM,1-3.
 LO 1:A,UTC,2.
 14,XTA,2.
 NI,UTC,NAMO-3.
 14,ATX,2.
 14,VLM,LO 1.
 LO 2:A,UTM,5.
 L,VLM,L OUT.
 ,UJ,RET
 RECO:,BSS,
 L,VTM,1-63
 A,UTM,5
 IO,UTM,-1
 IO,VZM,RECO1.KAT ByBOdA
 IO,UTM,-3
 IO,VZM,RECO1.4-gPA
 IO,UTM,-1
 IO,VZM,RECO1.5-1gPA
 A,UTM,320
 IO,UTM,-1
 IO,VZM,RECO1.6-2gPA
 IO,UTM,-1
 IO,V1M,END.O{ibKA
 A,UTM,320.7-3gPA
 RECO1:,BSS,
C  Tip dAHHyX:
C  401 - MZ ( c|C )
C  402 - MH ( liCiH )
C  403 - SR ( POMb )-BBOd
C  404 - SP ( YBfi-pEPgAMEHT )
C  405 - SU ( YBB )
C  406 - SA ( AMd )
C  407-414 - PEzEPB
C  415 - dPYgOj dBOi~Hyj BBOd
 A,XTA,TIM/TYP
 ,AAX,=7777 7777 7777 6000
 ,UZA,RECO2.AcpY-ByBOd
  ,AEX,=6HFOUT'200'''
  ,UZA,RECO2
 A,XTA,TIM/TYP
 ,AAX,C17
 ,UZA,RECO2.gPAfOP
 ,AOX,=I400.401 - 415
C---  bylO: ,UJ,RECO3
C    dOlOj lOpATKOBCKiE {TYKi !
 RECO2:,BSS,
 A,XTA,WNU
 ,ASN,64+24.
 ,AAX,=77
 ,AOX,INT0.N BB
 RECO3:,BSS,
 L,UTC,62
 14,VTM,
 14,UTC,NBB
 ,ATX,
 A,XTA,WNU.
 ,ASN,64+18
 ,AAX,=77.N lAb
 ,AOX,INT0
 14,UTC,CBqzx
 ,ATX,
 A,XTA,WNU.
 ,ASN,64-4.NEW,BUF,PR,LIST
 ,YTA,
 ,AOX,INT0
 14,UTC,READY
 ,ATX,
 ,ITA,14
 15,ATX,
 ,ASN,64-1
 15,ARX,
 ,ATI,NI
 14,VTM,1-3
 RENA:A,UTC,2
 14,XTA,2
 ,ARX,C177*
 ,AAX,C200*
 ,AEX,C200*
 ,ASN,64+2
 A,UTC,2
 14,AOX,2
 NI,UTC,*NAME
 14,ATX,2
 14,VLM,RENA
 A,UTM,5
 L,VLM,RECO1
 RET:,BSS,.
 ,WTC,I13.
 ,UJ,.
 RECO:,ENTRY,
 ,UTC,B1
 ,XTA,
 ,UTC,WS
 ,ATX,
 ,UJ,BAS
 RECATI:,ENTRY,.
C
C******   ~TEHiE i izBlE~EHiE Ob}Ej
C         iHfOPMAcii iz KATAl.BBOdA
C
 B,BASE,BAS.
 ,ITA,13.
 ,ATX,I13.
C--- KOByPqHiE C {ifPAMi HA pOTOKE ---
 ,*65,A/ipK.
 ,ATX,WS+1.
 A,VTM,-3.
  LI 1:,WTC,WS+1.
 A,*65,3+12
 ,ASN,64+24.
 ,AAX,=77
 ,AOX,INT0.
 ,UTC,*TYPE*
 A,ATX,SHI+3.
 A,VLM,LI 1.
 A,VTM,1-12
 LI1/:,WTC,WS+1
 A,*65,11
 ,ASN,64+24
 ,AAX,=77.N BB
 ,AOX,INT0
 ,UTC,*SHIT*
 A,ATX,11
 A,VLM,LI1/
 IO,VTM,.~TEHiE
 R,VJM,EXCH.KATAl.BBOdA
 ,UZA,HET Ml.
 T,VTM,*TYPE*.
 ,XTA,INT0.
 T,ATX,NFC.
 T,ATX,NFZ.
 14,VTM,-15.
C--- KOByPqHiE CO {KAlAMi zAHqTOCTi ---
 LI 2:,BSS,.
 14,UTC,BUSYSC.
 ,XTA,15.
 ,AAX,=:74
 T,ACX,NFC.
 T,ATX,NFC.
 14,UTC,BUSYSC.
 ,XTA,31.
 ,AAX,=:7777 7777 776
 T,ACX,NFZ
 T,ATX,NFZ.
 14,VLM,LI 2.
 ,UTC,NJOBS.
 ,XTA,.
 ,AOX,INT0.~iClO gOTOByX
 T,ATX,NRJ. zAdA~
 14,VTM,-60
 T,VTM,CAT
 LI3:T,XTA,
 ,AAX,=:3001
 ,UZA,ELI3
 T,XTA,
 ,AOX,=:4
 T,ATX,
 ELI3:T,UTM,16
 14,VLM,LI3
 ,UJ,RET.
 EXCH:,BSS,.
 IO,XTA,IWCAT.
 ,*57,7.
 IO,XTA,SEM/IO.
 ,FUN,210B.OTKP.Obl
 ,XTA,=1
 R,UJ,.
  GIV PAS:,ENTRY,.
C
C******   BydA~A iHfOPM. pO OdHOj zAdA~E
C         iz KATAlOgA BBOdA
C
 B,BASE,BAS.
 ,ATI,AC.
 ,ITA,13.
 ,ATX,I13.
 AC,WTC,.
 AC,VTM,CAT.
 AP,VTM,*UPAS*.
 AC,XTA,.
 AP,ATX,X1.
 14,VTM,1-48.
 GP 1:AC,XTA,.
 14,ASN,64+47.
 ,AAX,B1.
 ,AOX,INT0.
 AP,UTC,.
 14,ATX,BIT+47.
 14,VLM,GP 1.
 AP,XTA,BIT+47.
 AP,AEX,BIT+36.
 ,UZA,RET1.
 AC,MTJ,NI.
 A,VTM,*LPAS.
 14,VTM,1-16.
 FP 1:14,UTC,15.
 NI,XTA,.
 A,ATX,.
 A,UTM,1.
 14,VLM,FP 1.
 NI,XTA,.
 ,AAX,B36/31.
 ,UZA,FP 2.
 ,ASN,64+26.
 ,ATI,NI.
 NI,UTM,CAT-16.
 14,VTM,1-15.
 ,UJ,FP 1.
 FP 2:14,VTM,1-3.
  GP 2:14,XTA,*NAM+2. NAME
 AP,UTC,.
 14,ATX,NAM1+2.
 14,VLM,GP 2....
 14,VTM,1-3.
 GP 3:14,XTA,*NAM+2.dOpOlHEHiE
 ,ARX,C177*
 ,AAX,C200*
 ,AEX,C200*
 ,ASN,64+2
 14,AOX,*NAM+2
 AP,UTC,.
 14,ATX,NAM+2.
 14,VLM,GP 3....
 ,XTA,*XINP.dATA BBOdA
 ,AUX,UPM DAT.
 ,AOX,SIX0.
 AP,ATX,DIN.
 ,ASN,64-16.
 AP,ATX,DIN+1.
 ,ASN,64-16.
 AP,ATX,DIN+2....
 ,XTA,*XINP.BPEMq BBOdA
 ,ASN,64-19.
 ,ASN,64+31.
 ,AOX,INT0.
 AP,ATX,TIN....
 ,XTA,*LIMUS.zAKAz BPEMEHi
 ,ASN,64+36.
 ,AOX,INT0.
 AP,ATX,TUS....
 ,XTA,*LIMUS.zAKAz bYMAgi
 ,ASN,64+24.
 ,AAX,C7777.
 ,AOX,INT0.
 AP,ATX,LPUS....
 ,XTA,*LIMUS.zAKAz PAb.Md
 ,AAX,C7777.
 ,AOX,INT0.
 AP,ATX,NPMd....
 ,XTA,FULBLN.
 14,VTM,1-32.
 CL EXT:AP,UTC,.
 14,ATX,Ml+31.
 14,VLM,CL EXT.
 ,XTA,*X1.
 ,ASN,64+41.
 ,AAX,C17.
 ,ATI,L.KOl-BO Ml
 AC,VTM,*MlMd.
 AP,VTM,Ml+*UPAS*.
 TRA MT:L,VZM,DISC.
 13,VJM,CTOMAN.
 AP,XTA,-1.
 ,AAX,B48/9.
 AP,ATX,-1.
 ,XTA,*REGW/R.
 ,APX,CX.
 ,ASN,64+46.
 ,ATI,13.
 ,XTA,*REGW/R.-PEviM zp/~T
 ,ASN,64-1. +NbOb
 ,ATX,*REGW/R.
 13,XTA,CREG.
 AP,AOX,-1.
 AP,ATX,-1.
 L,UTM,-1.
 AC,VLM,TRA MT.
 DISC:AC,XTA,.
 ,ATX,WS.
 ,XTA,*X1.
 ,ASN,64+37.
 ,AAX,C17.
 ,ATI,L.KOl-BO dp
 AP,VTM,Md+*UPAS*.
 AC,UTM,1.
 TRA MD:L,VZM,END DI.
 13,VJM,CTOMAN.
 AC,XTA,1.
 ,ARX,.diCK-MOHOpOlxHO
 ,UIA,NO MNPL. - HET
 AP,XTA,-1.zAMEHA
 ,AEX,C155.pPObElA
 AP,ATX,-1. HA M
 NO MNPL:,XTA,WS.
 ,ASN,64-1.
 ,ASN,64-4.
 ,ATX,WS.
 ,YTA,.
 ,ATI,14.
 14,UTC,.
 AC,UTM,2.
 L,UTM,-1.
 ,UJ,TRA MD.
 END DI:,BSS,.
 AP,VTM,*UPAS*.
 ,XTA,INT0.
 AP,ATX,LINK.
 RET1:,STX,.
 ,UJ,RET.
 CTOMAN:,ITA,13.
 ,ATX,I13*.
 AC,XTA,.
 AP,ATX,MlE-Ml.
 ,AAX,C7777.
 ,CALL,TOMAN*.
 ,ASN,64+8.
 ,AOX,C NN.
 AP,ATX,.HOMEP bObiHy
 ,WTC,I13*.
 AP,VLM,.
 HET Ml:12,VTM,TMl.
 ,ITA,12
 ,AOX,MN*TL
 ,FUN,76B
 ,SJ,.
 IW CAT:9,,.
 ,,CAT.
 :1,,.
 ,,CAT.
 RCG:1,Z20,
 ,,CAT
 FCG:,Z20,
 ,,CAT
 SEM/IO:,,.BBOd
 ,,3.
 :,,.ByBOd
 ,,2.
 T Ml:,ISO,10HMl BBOdA!''
 ,LOG,.
 UPM DAT:,GOST,6H3 1
 SIX0:,ISO,6H000000
 UPM NN:,GOST,6H00   0
 CNN:,ISO,6H 0000
 FULBLN:,ISO,6H
 INT0:,INT,0.
 CREG:,ISO,6H''''''''''
 ,ISO,6H''''''''''
 ,ISO,6H''''''''''R
 ,ISO,6H''''''''''W
 C177*:,ISO,6H'177''177''177''177''177''177'
 C200*:,ISO,6H'200''200''200''200''200''200'
 CX:,OCT,4000 02
 B48/9:,OCT,7777 7777 7777 74
 B48/17:,OCT,7777 7777 776.
 B16/1:,LOG,17 7777.
 B48/41:,OCT,776.
 B36/31:,OCT,0000 77.
 C7777:,LOG,7777.
 C155:,LOG,155.
 C17:,LOG,17.
 B1:,LOG,1.
  I13:,BSS,1.
 I13*:,BSS,1.
 INF:,BSS,1.
 MAS:,BSS,1.
 WS :,BSS,1.
 :,BSS,1.WS+1
 *LPAS:,BSS,.
 *X1:,BSS,1.
 *XINP:,BSS,1.
 *NAM:,BSS,3.
 *LIMUS:,BSS,1.
 *REGW/R:,BSS,1
 *MlMd:,BSS,56.
 ,END,.
 REDISO:,NAME,
C
C   PEdAKTiPOBAHiE TEKCTA (ISO)
C   ObPA}EHiE: CALL REDISO(IT,L)
C              IT-TEKCT
C              L -dliHA TEKCTA
C
 *RGM61*:LC,BLOCK,LPFL(4)
C
C   LPFL.EQ.1-zAMEHA 1 HA 0, 12 HA 40
C   LPFL.EQ.0-zAMEHA 12 HA 40
C
 8,BASE,*
 ,STI,12
 ,ATI,11.AdP.TEKCTA
 12,WTC,.
 12,VTM,.L
 ,WTC,LPFL.
 10,VTM,
 WORDLOOP:,BSS,
 12,VZM,END
 9,VTM,1-6.
 SYMLOOP:,BSS,
 11,XTA,.
 9,APX,MASK+5
 ,AEX,C12
 ,UZA,WC12.SYM-'12'
 10,VZM,CHLOOP.LPFL=0
 ,AEX,C13.
 ,UIA,CHLOOP.SYM.NE.'1'
C --- zAMEHA '1' HA '0'
 9,XTA,MASK+5
 ,AEX,FULLW
 11,AAX,
 11,ATX,.
 ,UJ,CHLOOP
C --- zAMEHA '12' HA '40'
 WC12:,BSS,
 9,XTA,MASK+5
 ,AEX,FULLW
 11,AAX,
 11,ATX,
 ,XTA,C40
 9,AUX,MASK+5
 11,AOX,
 11,ATX,
 CHLOOP:,BSS,
 9,VLM,SYMLOOP
 12,UTM,-1
 11,VLM,WORDLOOP
 END:,BSS,
 ,STX,
 13,UJ,
 MASK:,BSS,
 ,ISO,6H'377''0''0''0''0''0'
 ,ISO,6H'0''377''0''0''0''0'
 ,ISO,6H'0''0''377''0''0''0'
 ,ISO,6H'0''0''0''377''0''0'
 ,ISO,6H'0''0''0''0''377''0'
 ,ISO,6H'0''0''0''0''0''377'
 C1:,ISO,6H'1''0''0''0''0''0'
 C12:,ISO,6H'12''0''0''0''0''0'
 C13:,ISO,6H'13''0''0''0''0''0'
 C40:,ISO,6H'40''0''0''0''0''0'
 FULLW:,OCT,7777 7777 7777 7777
 ,END,
 REWR:,NAME,
C         pOdpPOgPAMMA pOdgOTOBKi iHfOPMAcii
C         dlq p-p 'HAVERS' : fOPMiPOBAHiE
C         HOMEPOB YCTAHOBlEHHyX Ml i dp
C         (dB-dEC. B MOD i ISO B MOD1),
C         KOHCTAHT BPEMEHHyX diApAzOHOB
C         plAHiPOB}iKA.
C--------------------------------------------
C         ObPA}EHiE CALL REWR(LD)
C            LD=0 - lEHTy
C           LD=1 - diCK
C--------------------------------------------
 *TIME*:LC,BLOCK,TIME5,TIME6
 *UST*:LC,BLOCK,MOD(32),TMOD(32)
 12,BASE,*
 ,ATI,14. - AdP. LD
 ,ITA,13. - CpACEHiE
 ,ATX,SI13. M13
 ,ITA,11.
 ,ATX,SI11.
 14,XTA,. - Ml ili
 ,AEX,=I0. Md
 ,U1A,MD. - Md
 ,*63,760B.AdPEC
 ,ASN,64+24."STATUSMT"
 ,ARX,=1.MACCiB "OLD"
 ,ATX,ATABLE.
 ,XTA,.
 ,ATX,ASM.
 13,VTM,1-4.
 M3:11,VTM,1-8
 ,WTC,ATABLE.
 13,*63,3.
 ,ASN,64+8.
 ,ATX,R.
 M2:,XTA,R.
 ,ASN,64+1.
 ,ATX,R.
 ,YTA,.
 ,UZA,M1.
 ,XTA,CNG.
 ,WTC,ASM.
 ,UTC,MOD
 ,ATX,
 ,UJ,M6.
 M1:,XTA,.
 ,WTC,ASM.
 ,UTC,MOD
 ,ATX,
 M6:,XTA,ASM.
 ,ARX,=1.
 ,ATX,ASM.
 11,VLM,M2
 13,VLM,M3....
 13,VTM,1-32. - dliHA TAblicy
 ,*63,505B.Ml
 ,ARX,=37.
 ,ATX,ATABLE. - AdPEC TAblicy
 ,XTA,=37.
 ,UJ,BN....
 MD:13,VTM,1-16.
 ,XTA,.
 M4:,UTC,MOD
 13,ATX,15
 13,VLM,M4....
 13,VTM,1-16.
 ,*63,575B. Md
 ,ARX,=17.
 ,ATX,ATABLE. - AdPEC TAblicy
 ,XTA,=17.
 BN:,ATX,ASM.
 LOOP:,WTC,ASM.
 ,UTC,MOD
 13,XTA,
 ,AEX,CNG.
 ,UZA,M5.
 ,WTC,ATABLE.
 13,*63,. pEPEpiCi
 ,WTC,ASM.
 ,UTC,MOD.
 13,ATX,. dB-dEC.HOMER
 ,ITA,13.
 ,ATX,SI13A.
 ,WTC,ASM.
 ,UTC,MOD.
 13,XTA,.
 ,CALL,TO MAN*.
 ,ATX,R.
 ,XTA,SI13A.
 ,ATI,13.
 ,XTA,R.
 ,WTC,ASM.
 ,UTC,TMOD.
 13,ATX,. ISO-HOMER
 M5:13,VLM,LOOP....
 13,VTM,TIME5.
 ,XTA,=I5. - zApiCx
 13,ATX,.pAPAMETPOB
 ,XTA,=I10. plAHiPOBKi
 13,ATX,1.pO BPEMEHi
 ,XTA,SI11.
 ,ATI,11.
 ,STX,.
 ,WTC,SI13. - BOzBPAT
 ,UJ,....
 SI13:,BSS,1
 SI13A:,BSS,1
 SI11:,BSS,1
 ATABLE:,BSS,1
 ASM:,BSS,1
 R:,BSS,1
 CNG:,OCT,2245 1252 5122 4512
 ,END,
 SETNAM:,NAME,
 *LINK*:LC,BLOCK,DNAM,NCH,MOD
 ,XTA,NCH
 ,ASN,64-3
 ,ARX,MOD.N HMd+1
 ,ATI,12
 ,XTA,DNAM
 ,UTC,WR
 ,*76,.
 ,NTR,6
 13,UJ,
 WR:,WTC,575B
 12,ATX,-31B
 ,MTJ,27B
 2,32,
 ,END,
 SHIFTM:,NAME,
C---------------------------------------
C
C CdBig TEKCTA, HAXOdq}EgOCq
C B MlAd{iX PAzPqdAX MES,
C B CTAP{iE PAzPqdy(KOd-TEXT)
C
C---------------------------------------
 *ONE*:LC,BLOCK,(5),MES
 11,BASE,*
 ,UTC,MES
 ,XTA,
 13,UZA,
 L:,ATX,R
 ,AAX,MASK
 ,U1A,END
 ,XTA,R
 ,ASN,64-6
 ,UJ,L
 END:,XTA,R
 ,UTC,MES
 ,ATX,
 13,UJ,
 R:,BSS,1
 MASK:,OCT,77
 ,END,
 SLMD:,NAME,
C-----------------------------------
C        PACpOzHABAHiE ClYvEbHyX Md
C        ObPA}EHiE - CALL SLMD(A,B)
C        B=1 - HET
C        B=0 - Cl. Md
C        A - HOMEP MOdYlq
C-----------------------------------
 A/ipd:,EQU,760B.
 L/FATA:,EQU,20B.dliHA FATA
 A/FATA:,EQU,576B.
 12,BASE,*
 ,STX,AIND.
 ,ATX,AMOD.
 ,ITA,13.
 ,ATX,SI13.
 ,*65,A/ipd.
 ,ATI,14.
 14,*65,L/FATA.
 15,ATX,.
 ,NTR,3
 ,X-A,=1
 ,ATI,13.C~ ciKlA
 ,*65,A/FATA.
 15,ARX,.
 ,ATX,ATABLE.
 ,NTR,6
 LP:,WTC,ATABLE. - pPOCMOTP
 13,*65,-1.
 ,ATX,R.
 ,AAX,=77 0000 0000 0000.
 ,U1A,ELP. - HE CiCT.f.
 ,XTA,R.
 ,ASN,64+30.
 ,WTC,AMOD.
 ,AEX,.
 ,AAX,=77.
 ,UZA,OKEY. - CiCT.f.
 ELP:13,VLM,LP. HA MOdYlE
 ,XTA,=I1.
 ,UJ,RET.
 OKEY:,XTA,=I0.
 RET:,WTC,AIND.
 ,STX,.
 ,WTC,SI13.
 ,UJ,.
 SI13:,BSS,1.
 AIND:,BSS,1.
 AMOD:,BSS,1.
 R:,BSS,1.
 ATABLE:,BSS,1.
 ,END,
 SL ML:,NAME,
C         PACpOzHABAHiE ClYvEbHyX Ml
C----------------------------------------------
C           B=1 - HET
C           B=0 - ClYv. Ml
C           A - iMq Ml
C         ObPA}EHiE CALL SLML(A,B)
C----------------------------------------------
  LENT:,EQU,ECN-CNAME
 12,BASE,*
 ,STX,AIND. - BybOPKA
 ,ATX,ANAME. pAPAMETPOB
 ,ITA,13.
 ,ATX,SI13.
 13,VTM,-LENT.
  LOOP:13,UTC,LENT
  ,XTA,CNAME
 ,WTC,ANAME. CPABHEHiq
 ,AEX,. CO CTAHdAPTHyMi
 ,AAX,=:7777 7777 7777. iMEHAMi
 ,UZA,RETJ
 13,VLM,LOOP....
 ,XTA,=I1. - HE ClYv.
 ,UJ,RETURN. lEHTA
 RETJ:,XTA,=I0. - ClYv. Ml
 RETURN:,WTC,AIND. - BOzBPAT
 ,STX,.
 ,WTC,SI13.
 ,UJ,....
 SI13:,BSS,1
 AIND:,BSS,1
 ANAME:,BSS,1.
C         iMEHA ClYvEbHyX lEHT
 CNAME:,TEXT,8HMONSYS
 ,TEXT,8HUSESTA
 ,TEXT,8HROLLIB
 ,TEXT,8HD73INP
 ,TEXT,8HD73OUT
 ,TEXT,8HD73LIB
 ,TEXT,8HD73STA
 ,TEXT,8HLIBRAR
  ,TEXT,8HLINBUF
  ECN:,BSS,
 ,TEXT,8HM
 ,END,
 SMERTD:,NAME,
C     pOlY~EHiE i PACCylKA O{ibOK
C     bO Ml i dp
C     CALL SMERTD(I,NW)
C     I=0 - O{ibKi pO Ml
C     I=1 - O{ibKi pO dp
C     NW-dliHA TAblicy O{ibOK
C
 *XAPMld*:LC,BLOCK,NMf,NZON,KO{(9),KHAPAb
 *ONE*:LC,BLOCK,(5),NAMl
 dAjClB:,SUBP,
 C:,STI,11.NW
 ,ATI,9.I
 ,NTR,3
 10,VTM,-2
 LSAV:10,ITA,1+2.CpACEHiE
 ,UTC,SAVM.M1-M3
 10,ATX,2
 10,VLM,LSAV
 1,BASE,C
 ,ITA,13
 ,ATX,M13
 11,WTC,.C~ET~iK
 2,VTM,.pO TAblicE
 ,XTA,=I0
 ,ATX,B/C
 9,XTA,
 ,ATI,9
 ,ATX,pAPAM
 ,XTA,=6.MAX.KOl-BO
 ,ATX,LO{.O{ibOK pO Ml.
 9,VZM,TNAME.
 ,XTA,=11.pO dp
 ,ATX,LO{
 TNAME:2,VZM,RET.TAbl. iC~EPpAHA
C     iMq Ml ili dp
 14,VTM,NAMl
 13,VTM,AFTNAM
 ,UJ,TAKW
 AFTNAM:2,UTM,-1
 TNMf:2,VZM,RET
C     N Mf i HAPAbOTKA
 14,VTM,R
 13,VTM,AFTMf
 ,UJ,TAKW
 AFTMf:,XTA,R
 ,AAX,=777.KOl-BO ClOB
 ,ATI,3.C O{ibKAMi
 ,XTA,R
 ,ASN,64-7
 ,ASN,64+16
 ,AOX,=I0
 ,UTC,KHAPAb
 ,ATX,.HAPAbOTKA
 ,XTA,R
 ,ASN,64+41
 ,AAX,=77
 ,AOX,=I0
 ,UTC,NMf
 ,ATX,
 2,UTM,-1
 11,VTM,LTERR
C     pO{li O{ibKi
 TERR:,BSS,
 ,XTA,
 ,ATX,FLERR
 ,XTA,LO{
 ,ATI,9
 10,VTM,
 ,XTA,=I0
 LZ:,UTC,KO{.~iCTKA
 10,ATX,.KO{
 9,UTM,-1
 10,UTM,1
 9,V1M,LZ
 3,VZM,ENDERR
 11,UJ,
 LTERR:2,VZM,RET
 14,VTM,R1
 13,VTM,AFTERR
 ,UJ,TAKW
 AFTERR:,XTA,FLERR
 ,U1A,NOFZ
 ,XTA,R1.pEPBAq O{ibKA
 ,AAX,=1777.HA zOHE
 ,AOX,=I0
 ,UTC,NZON
 ,ATX,
 ,ATX,FLERR
 ,UJ,TNZ
 NOFZ:,UTC,NZON
 ,XTA,
 ,AEX,R1
 ,AAX,=1777
 ,U1A,ENDZ.ClEd.zOHA
C     PACpAKOBKA O{ibOK
 TNZ:,BSS,
 9,VTM,-2
 ,XTA,R1
 ,ASN,64+10
 LPACp:,ATX,R2
 ,AAX,=17
 ,UZA,ELPp
 ,ATI,11.Tip O{ibKi.
 ,X-A,LO{
 ,U1A,~Y{x
 ,XTA,R2
 ,ASN,64+4
 ,AAX,=377.KOl-BO.
 ,UTC,KO{
 11,ARX,-1
 ,UTC,KO{
 11,ATX,-1
 ~Y{x:,BSS,
 ,XTA,R2
 ,ASN,64+12
 9,VLM,LPACp
 ELPp:2,UTM,-1
 3,UTM,-1
 3,V1M,LTERR
 ENDZ:,BSS,.KOHEc zOHy.
 ENDERR:,BSS,.KOHEc O{ibOK
 14,VTM,pAPAM
 ,ITS,14
 14,VTM,B/C.zAHECEHiE
 ,ITS,14.BHOBY`
 ,CALL,O{MlMd.TAblicY.
 ,XTA,=I0
 ,UTC,KHAPAb
 ,ATX,
 ,NTR,3
 ,XTA,=I1
 ,ATX,B/C
 11,VTM,AFTERR
 3,V1M,TERR
 ,XTA,R.ECTx E}E
 ,ARX,
 ,U1A,TNMf.YCTPOjCTBA.
 ,UJ,TNAME.HET.
 RET:10,VTM,-2.BOzBPAT.
 ,NTR,6
 ,XTA,M13
 ,ATI,13
 LRSAV:,UTC,SAVM
 10,XTA,2
 10,ATI,1+2
 10,VLM,LRSAV
 ,STX,
 13,UJ,
C     ~TEHiE ClOBA
 TAKW:,ITS,14
 14,VTM,=I1
 ,ITS,14
 ,UJ,dAjClB
 LO{:,BSS,1
 FLERR:,BSS,1
 pAPAM:,BSS,1
 R:,BSS,1
 R1:,BSS,1
 R2:,BSS,1
 M13:,BSS,1
 SAVM:,BSS,3
 B/C:,BSS,1
 ,END,
 SPRAV:,NAME,
 MN*TL:,EQU,1067B
 7,BASE,*
 *TEXT*:,LC,4
 *K*:,LC,1
 *PAR*:LC,BLOCK,IND
 ,ITS,13
 ,ITS,
 ,XTA,=I0
 ,UTC,*K*
 ,ATX,
 ,*63,505B
 ,ATI,1
 1,UTM,-16
 3,VTM,10B
 2,VTM,1-16
 NACH:2,UTC,15
 1,*63,
 ,ATX,A
 ,AEX,=2245125251224512
 ,UZA,IZAD
  14,VTM,A
  ,ITS,14
  14,VTM,*TEXT*
  ,ITS,14
  ,CALL,TEXISO
 ,XTA,A
 ,CALL,TO MAN*
 ,ASN,64+8
 ,AOX,C1
 ,UTC,*TEXT*+1
 ,ATX,
 ,ITA,3
 ,ASN,64-42
 ,AUX,=6H'''''7''7'''''
 ,AOX,C2
 ,UTC,*TEXT*+2
 ,ATX,
 ,XTA,IND
 ,AEX,=I0
 ,U1A,PRTT
 13,VTM,1-4
 L:,UTC,*TEXT*
 13,XTA,3
 13,ATX,TEXT+3
 13,VLM,L
 13,VTM,TEXT
 ,ITA,13
 ,AOX,MN*TL
 ,FUN,76B
 ,UJ,IZAD
 PRTT:,CALL,PECH1
 IZAD:3,UTM,1
 2,VLM,NACH
 ,XTA,IND
 ,AEX,=I0
 ,UZA,FIN
 ,CALL,PCHER
 FIN:,STI,
 ,STI,13
 13,UJ,
 TEXT:,BSS,4
 A:,BSS,1
 C1:,ISO,6H/0000
 C2:,ISO,6H- 00''''
 ,DATA,
 1,SET,0
 1,,*TEXT*+3
 ,END,
 STOP*:,NAME,.qHB 1979(Oiqi)
 FMRTAPE:,ENTRY,
 BCDPUN :,ENTRY,
 EBCDPUN:,ENTRY,
 ISOICTTR:,ENTRY,
 ,*62,.
 GIVETIME:,ENTRY,
 ,STX,
 LIBRARY/:,ENTRY,.
 13,UJ,.
 ,END,STOP*   .
 STRISO:,NAME,
 *BUFMT9*:LC,BLOCK,INC(14)
 *CARDS  :LC,BLOCK,(44),OUTC(14)
 *8:,BLOCK,T,L,S1,S2,AT,R,ST
C ------------------------------
 T,VTM,-1.C~ET~.ClOB
 L,VTM,80.C~ET~.CiMB.
 S1,VTM,.CdBig ClOBA INC
 S2,VTM,.CdBig ClOBA OUTC
C ---
 RSYM:,BSS,
 L,VZM,END
 L,UTM,-1
 S1,VIM,RSYM1
 S1,VTM,48
 T,UTM,1
 RSYM1:,BSS,
 S1,UTM,-8
 T,XTA,INC
 S1,ASN,64+1
 ,AAX,=177
 15,ATX,
 ,ASN,64+2
 ,ATI,AT
 ,ASN,64-2
 15,AEX,
 ,ASN,64-3
 ,ATI,ST
 AT,XTA,TAB
 ST,ASN,64
 ,AAX,=377
 ,UIA,OK
 ,XTA,BADSYM
 OK:,BSS,
 S2,VIM,WSYM
 S2,VTM,-48
 ,XTS,
 T,STX,OUTC
 WSYM:,BSS,
 S2,UTM,8
 S2,ASN,64
 T,AOX,OUTC
 T,ATX,OUTC
 ,UJ,RSYM
 END:,BSS,
 ,XTA,ENDC
 T,AOX,OUTC
 T,ATX,OUTC
 R,UJ,
 BADSYM:,ISO,6H'''''''''''041'
 ENDC:,ISO,6H''''   '012'
 TAB:,BSS,
 ,ISO,6H''''` '100'''
 ,ISO,6H''''p0P''
 ,ISO,6H''''X(H''
 ,ISO,6H''''x8X''
 ,ISO,6H''''d'044'D''
 ,ISO,6H''''T4T''
 ,ISO,6H''''l,L''
 ,ISO,6H''''|'074'/''
 ,ISO,6H''''b'047'B''
 ,ISO,6H''''P2R''
 ,ISO,6H''''j*J''
 ,ISO,6H''''z:Z''
 ,ISO,6H''''f'046'F''
 ,ISO,6H''''v6V''
 ,ISO,6H''''H.N''
 ,ISO,6H''''~'076'''''
 ,ISO,6H''''A'041'A''
 ,ISO,6H''''q1Q''
 ,ISO,6H''''i)I''
 ,ISO,6H''''y9Y''
 ,ISO,6H''''E'045'E''
 ,ISO,6H''''Y5U''
 ,ISO,6H''''M-M''
 ,ISO,6H''''}='135'''
 ,ISO,6H''''c'030'C''
 ,ISO,6H''''C3S''
 ,ISO,6H''''K+K''
 ,ISO,6H''''{'073''133'''
 ,ISO,6H''''g'047'G''
 ,ISO,6H''''B7W''
 ,ISO,6H''''O/O''
 ,ISO,6H'''''''077'''''
 ,END,
 SUBTABL:,NAME,
C            pPi BKl`4EHii B CEPBiC
C           HOByX pPOgPAM izMEHEHiq
C           BHOCqTCq B |Ti
C           TAblicy.
C-------------------------------------
C            MACKi i |TAlOHy pPiKAzOB
 ,TEXT,8H````TAbl
 ,TEXT,8H ``` YCT
 ,TEXT,8H````YCTB
 ,TEXT,8H````YCTA
 ,TEXT,8H ``` TP/
 ,TEXT,8H  ``  CB
 ,TEXT,8H ``` CBA
 ,TEXT,8H ``` CB/
 ,TEXT,8H````iCKl
 ,TEXT,8H  ``  BB
 ,TEXT,8H ``` BB/
 ,TEXT,8H````ByB/
 ,TEXT,8H ``` gPA.
 ,TEXT,8H  ``  gz
 ,TEXT,8H ``` gzA
 ,TEXT,8H ``` HOM
 ,TEXT,8H  ``  Mf
 ,TEXT,8H  ``  Md
 ,TEXT,8H ``` MfA
 ,TEXT,8H ``` MdA
 ,TEXT,8H ``` Mf/
 ,TEXT,8H ``` Md/
 ,TEXT,8H ``` MOd
 ,TEXT,8H````MOdA
 :,TEXT,8H  ``  Tz.TEPM. zAdA~i
 ,TEXT,8H ``` INF
 :,TEXT,8H  ``  Mz
 :,TEXT,8H ``` BPM
 :,TEXT,8H  ``  Bz
 :,TEXT,8H ``` BPB
 :,TEXT,8H  ``  BP.BCE zAdA~i
 :,TEXT,8H  ``  Cz
 ,TEXT,8H ``` BPC.
 :,TEXT,8H ``` BPT.TEPM zAdA~i
 ,TEXT,8H ``` Tfz.TPEK-fAjl,zOHA
 ,LOG,.KOHEc TAblicy
 TABLGO1:,ENTRY,.
C         pEPEXOdy pO TT
C----------------------------------------
 ,CALL,PAC.TAbl
C----------------------------------------
 :1,VTM,
 ,CALL,HEADRS.YCT
C----------------------------------------
 :1,VTM,10B
 ,CALL,HEADRS.YCTB
C----------------------------------------
 :1,VTM,11B
 ,CALL,HEADRS.YCTA
C---------------------------------------
 :1,VTM,12B
 ,CALL,HEADRS.TP/
C----------------------------------------
 :1,VTM,
 ,CALL,HEADSV.CB
C----------------------------------------
 :1,VTM,1
 ,CALL,HEADSV.CBA
C---------------------------------------
 :1,VTM,2
 ,CALL,HEADSV.CB/
C----------------------------------------
 HEADDJ:,SUBP,
 OCTPARAM:,SUBP,
 13,VTM,HEADDJ.iCKl
 ,UJ,OCTPARAM
C----------------------------------------
 :1,VTM,1.BB
 ,CALL,HEADCIN
C---------------------------------------
 :1,VTM,2.BB/
 ,CALL,HEADCIN
C---------------------------------------
 :1,VTM,2.ByB/
 ,CALL,HEADCOUT
C -------------------------------------
 :1,VTM,4.XgPA X=0,1,2,3
 ,CALL,HEADCOUT
C----------------------------------------
 :1,VTM,.gz
 ,CALL,HEADGZ
C-  -- ------------------------------ -----
 :1,VTM,1.gzA
 ,CALL,HEADGZ
C----------------------------------------
 ,CALL,HEADNM.HOM
C-  -- ------------------------------ -----
 :1,VTM,.Mf
 ,CALL,HEADL
C-  -- ------------------------------ -----
 :1,VTM,.Md
 ,CALL,HEADD
C-  -- ------------------------------ -----
 :1,VTM,1.MfA
 , CALL,HEADL
C-  -- ------------------------------  ----
 :1,VTM,1.MdA
 ,CALL,HEADD
C---------------------------------------
 :1,VTM,2.Mf/
 ,CALL,HEADL
C---------------------------------------
 :1,VTM,2.Md/
 ,CALL,HEADD
C------------------------------------------
 :1,VTM,.MOd
 ,CALL,HEADMOD
C------------------------------------------
 :1,VTM,1.MOdA
 ,CALL,HEADMOD
C-------------------------------------------
 :1,VTM,7.
 ,CALL,TASK60.
C--------------------------------
 :,CALL,PAC.INF
C----------------------------------------
 :1,VTM,4.Mz
 ,CALL,TASK60
 :1,VTM,0.BPM
 ,CALL,TASK60
C----------------------------------------
 :1,VTM,1.Bz
 ,CALL,TASK60
 :1,VTM,1.BPB
 ,CALL,TASK60
 :1,VTM,1.Bcp
 ,CALL,TASK60
C----------------------------------------
 :1,VTM,2.Cz
 ,CALL,TASK60
 :1,VTM,2.BPC
 ,CALL,TASK60
 :1,VTM,3.
 ,CALL,TASK60.
 ,CALL,TR*F*Z.Tfz
 TABLGO2:,ENTRY,
C         pEPEXOdy pO TP
C-----------------------------------------
 :,CALL,PAC
C----------------------------------------
 :13,VTM,HEADRS.
 ,UJ,OCTPARAM.
C------------------------------------------
 :13,VTM,HEADSV.
 ,UJ,OCTPARAM.
C------------------------------------------
 :13,VTM,HEADDJ.
 ,UJ,OCTPARAM.
C------------------------------------------
 :1,VTM,1.
 ,CALL,HEADCIN.
C------------------------------------------
 1,VTM,1
 ,CALL,HEADGZ
C----------------------------------------
 ,CALL,HEADNM
C-------------------------------------------
 ,CALL,HEADMOD
C-------------------------------------------
 :1,VTM,1.
 ,CALL,TASK60.
 ,END,
  SYMTRA:,NAME,.lBb 17/04/81
C   +++ 21/09/81
C
C pEPEKOdiPOBKA GOST - ISO(dYbHA)
C      pO TAblicE GOST/ISO
C
C pEPEKOdiPOBKA ISO(dYbHA) - EBCDIC
C      pO TAblicE *IDUE10
C  iP8-14 pOPTqTCq bEz COXPAHEHiq
C
C  ByzOB:   CALL SYMTRA(ASTR,AN,ATAB)
C    ASTR - AdPEC pEPEBOdiMOj CTPOKi
C    AN   - AdPEC INTEGER N > 0 - KOl-BO CiMBOlOB
C    B pEPEBOdiMOj CTPOKE
C    ATAB - AdPEC TAblicy CiMBOlOB
C           YpAKOBAHHyX "0123"
C                       "4567" i T.d.
C
 ,STI,8
 ,STI,11
 ,STI,12
 ,ITA,7
 7,BASE,LOOP
 11,XTS,
 ,AAX,=377
 ,NTR,3
 ,X-A,=1
 ,ATI,11.B dOp.KOdE
 R WORD:12,XTA,
 14,VTM,-48
 R SYM:,ASN,64-8
 ,ATX,XBOCT
 ,YTA,
 15,ATX,
 ,AAX,=3
 ,X-A,=3
 ,ASN,64-3
 ,STI,10.HOMEP ''0123''
 ,ASN,64+2
 ,ATI,9.HOMEP ClOBA
 8,UTC,.TAblicA
 9,XTA,
 10,ASN,64+8.CdBig iz-zA TAbl.
 ,AAX,=377.KOd EBCDIC
 14,ASN,64+8.=-40,..-8,0
 ,XTS,=377
 14,ASN,64+8
 12,AAX,
 12,AEX,.~iCTKA pOlq
 15,AOX,
 12,ATX,
 11,VLM,LOOP
 15,WTC,
 7,VTM,
 13,UJ,.ByXOd
 LOOP:14,UTM,8
 ,XTA,XBOCT
 14,V1M,R SYM
 12,VLM,R WORD
 XBOCT:,BSS,1
 ,END,IDUE10
 SYSCOP*:,NAME,
 MN*TL:,EQU,1067B
 TTPR:,SUBP,
 ZFTZM:,SUBP,
 PRINT8:,SUBP,
 *100:B,BLOCK,
 ,CONT,NM/FR
 ,CONT,NM/TO
 ,CONT,IR
 ,CONT,IW
 ,CONT,IR/
 ,CONT,iMq
 ,CONT,TYP
 ,CONT,ANS
 ,CONT,W(2)
 ,CONT,ERCOUNT
 EX:,EQU,20 000B.2 liCTA,CM.KORR:
 N/EX:,P/P,(EX)16
 REP RE:,EQU,4-1.KOl-BO pOBT.~T.
C*
C*   KOpiPOBAHiE CiCTEMHyX diCKOB
C*
C*      HA TP 3 B 48-43 PP. dOlvEH byTx
C*      pOdTBEPvdEH HOMEP MOdYlq KYdA +
C*      K TOMY - PAzPE{EHiE...
C*   pEPEd pOCTAHOBKOj KOpii HA diCKOBOd
C*   dOlvEH byTx BydAH pPiKAz  dHO
C***************************************
C
 14,CALL,MAK*TRT
 ,ATX,HEAD+1.
 12,VTM,HEAD
 ,CALL,TTPR
 2,VTM,-REPRE
 14,VTM,HEAD+2
 ,ITA,14
 ,FUN,64B."NAME"
 ,XTA,
 ,ATX,ERCOUNT
 '=== BybOPKA "OTKYdA" ===
 HA~AlO :,BSS,
 :11,VTM,*.dlq pOBT.BOpPOCA
 12,VTM,T/FR
 13,VJM,DIAL
 14,VJM,CONT/NM
 ,XTA,ANS
 ,APX,=707
 ,ASN,64+42
 ,ATX,NM/FR
 '=== BybOPKA " KYdA " ===
 :11,VTM,*
 12,VTM,T/TO
 13,VJM,DIAL
 14,VJM,CONT/NM
 ,XTA,ANS
 ,APX,=707
 ,ASN,64+42
 ,ATX,NM/TO
 ,*65,3
 ,ASN,64+42
 ,AEX,NM/TO
 ,UIA,HE lEzx
 '=== BybOPKA N pAKETA-"KYdA" ===
 :11,VTM,*
 12,VTM,T/N pAK
 13,VJM,DIAL
 ,ARX,=606 0606
 ,AAX,=4040 4040
 ,UIA,~Y{x
 ,XTA,ANS
 ,APX,=1717 1717
 ,ASN,64+32
 ,FUN,203B.B "XiTPyj" KOd
 ,ATX ,iMq
 '=== BybOPKA iMEHi pAKETA-"KYdA" ===
 dAj iMq:,BSS,
 12,VTM,T/iMpAK
 13,VJM,DIAL
 11,VTM,-4
 ,ASN,64-12
 ,ATX,ANS
 HOPM:,AAX,=:77
 ,UIA,lEpiM
 ,XTA,ANS
 ,ASN,64-6
 ,ATX,ANS
 11,VLM,HOPM
 ,UZA,dAj iMq
 lEpiM:,XTA,ANS
 ,AOX,iMq
 ,ATX,iMq
 '=== HA~AlxHyE iHf.ClOBA *70 ===
 ,XTA,NM/FR
 ,ASN,64-12
 ,AOX,R*PHIS
 ,ATX,IR
 ,XTA,NM/TO
 ,ASN,64-12
 ,AOX,W*PHIS
 ,ATX,IW
 '=== pPOBEPKA, TOT li pAKET HA NM/TO ===
 ,AEX,=:0010 0006
 10,VTM,NM/TO
 13,VJM,READ
 ,UZA,O~ plOXO
 ,AEX,iMq
 ,UIA,HE TOT pAK
 '=== TEXHiKA bEzOpACHOCTi ===
 14,VTM,KILL
 ,ITA,14
 ,FUN,74B
 '=== iMq/HOMEP B TAblicY iMEH dp ===
 ,*65,575B.A DISC
 ,ARX,NM/TO
 ,ATI,7.AdPEC pOXPAHiM
 ,XTA,iMq
 7,*52,-30B.zApiCAli
 '=== KAKiE pAKETy : 7 ili 29 ===
 ,*65,551B.A SCDI
 ,ATI,12
 ,XTA,NM/FR
 ,ASN,64+3
 ,ATI,11
 11,UTC,
 12,*65,
 ,ATX,TYP
 ,XTA,NM/TO
 ,ASN,64+3
 ,ATI,11
 11,UTC,
 12,*65,
 ,AEX,TYP
 ,UIA,PAzHyE
 ,XTA,TYP
 ,UZA,/7/
 '-- KAK Y bb B TASK43 --'
 ,UTC,1750B-7624B
 /7/:,BSS,
 1,VTM,1-1750B.C~ET~iK ciKlA
 ,XTA,NM/FR
 4,VTM,CBOdKA+1
 3,VJM,B CBOdKY
 ,XTA,NM/TO
 4,VTM,CBOdKA+6
 3,VTM,Tip
 B CBOdKY:,BSS,
 ,ATI,11
 ,APX,=77
 ,AUX,M77
 ,AOX,IS/77
 4,ATX,.
 ,*65,575B.A/DNAM
 ,ATI,14
 14,UTC,
 11,*65,-30B
 ,ATX,iMq
 ,FUN,202B.iz T1MT B ISO
 ,ASN,64-8
 ,AOX,=6H(0000/
 4,ATX,1
 14,VTM,iMq
 ,ITS,14
 14,VTM,W
 ,ITS,14
 ,CALL,TEXISO
 ,XTA,W
 4,ATX,2
 3,UJ,
 Tip:,BSS,
 ,XTA,TYP
 ,UZA,*7Mb
 ,UTC,=6H)29 Mb - =6H) 7 Mb
 *7Mb:,XTA,=6H) 7 Mb
 ,ATX,CBOdKA+9
 12,VTM,CBOdKA
 13,VJM,TTPR
 12,VTM,T/TAK li
 13,VJM,DIAL
 ,UIA,HA~AlO.KliEHT pPOTiB
 ,CALL,PREPDAT
 14,VTM,CBOdKA
 ,ITS,14
 14,VTM,=12
 ,ITS,14
 ,CALL,REDISO
 ,PRINT,{ApKA
 14,VTM,CBOdKA
 ,ITS,14
 14,VTM,CBOdKA+9
 ,ITS,14
 ,XTS,=30
 ,CALL,PRINT8
 '
 '=== HA~iHAEM pEPEpiCx ===
 '
 COPY:,BSS,
 ,XTA,IR
 13,VJM,READ
 ,XTS,IR
 14,VJM,KORR
 ,STX,IR
 ,UZA,plOXO
 ,XTA,IW
 13,VJM,READ.zApiCx
 ,UZA,plOXO.HE pPO{lA
 *2:,XTA,IW
 14,VJM,KORR
 ,ATX,IW
 1,VLM,COPY
 13,VTM,gOTOBO
 CKOlxKO:,BSS,
 ,XTA,IW
 ,ARX,=4.KATAlOg
 ,AAX,=7777
 ,NTR,3
 ,A-X,ERCOUNT
 ,APX,=7777
 ,AUX,MDIG
 ,AOX,MDIG+1
 ,ATX,NZC
 14,VTM,T/CKO
 ,ITS,14
 14,VTM,NZC+1
 ,ITS,14
 ,XTS,=1
 ,UJ,PRINT8
 gOTOBO:,BSS,
 12,VTM,T/pEPE
 ,UJ,DIAGNOS
 END:,BSS,
 ,XTA,
 7,*52,-30B.ObHYlili iMq
 ,*62,
 plOXO:,BSS,
C------- HE pPO{El ObMEH, gT ECTx
 ,XTA,IR/
 ,AAX,=7770.ECli |TO
 ,AEX,=7770.KATAlOg
 ,UZA,O~ plOXO
 ,XTA,IR/
 ,AAX,=:001.BIT 40
 ,U1A,TOTO.~TEHiE
 ,UTC,TEzp-TE~T
 TOTO:,XTA,TE~T
 ,ATX,TplOXO
 ,XTA,IR/
 ,APX,=77 0000
 ,AUX,MMOD
 ,AOX,/MOD
 ,ATX,TplOXO+1.MOdYlx
 14,VTM,IR/
 ,ITS,14
 14,VTM,NF
 ,ITS,14
 14,VTM,NZ
 ,ITS,14
 ,CALL,ZFTZM
 ,UZA,CATR.HE ~iT KATAl
 ,XTA,NF
 ,AEX,=H
 ,U1A,*3
 ,XTA,=5H'47'PAb'47'
 ,ATX,NF
 *3:,BSS,
 ,XTA,NZ
 ,ASN,64-36
 ,AUX,MDIG
 ,AOX,MDIG+1
 ,ATX,NZ
 ,XTA,=1
 ,ARX,ERCOUNT
 ,ATX,ERCOUNT
 14,VTM,TplOXO
 ,ITS,14
 14,UTM,5
 ,ITS,14
 14,VTM,2
 ,ITS,14
 13,VTM,*2
 ,UJ,PRINT8
C-----------------------
 CATR:,XTA,TKAT
 ,ATX,NF
 ,XTA,IR/
 ,ARX,=4
 ,ATX,NZ
 ,UJ,*3
C====
 DIAL:,BSS,
C====  BOpPOC - OTBET ====
 ,ITA,12
 ,AOX,MN*TL
 ,FUN,76B
 ,ITA,13
 ,FUN,66B
 ,ASN,64+12
 ,ATX,ANS
 13,UJ,
 CONT/NM:,BSS,
 ,ARX,=0300
 ,AAX,=7670
 ,AEX,=2620
 14,UZA,
 ~Y{x:12,VTM,T~Y{x
 11,MTJ,13
 ,UJ,TTPR
 HE lEzx:,BSS,.CO CBiHyM PylOM
 12,VTM,T HEpOl
 ,UJ,DIAGNOS
 PAzHyE:,BSS,
 12,VTM,T PAzHyE
 ,UJ,DIAGNOS
 HETOTpAK:,BSS,
 12,VTM,T HE TOT
 ,UJ,DIAGNOS
 DIAGNOS:,BSS,
 13,VTM,END
 ,UJ,TTPR
 KORR:,BSS,
 ,ATX,W
 ,ARX,=1
 ,AAX,=7777
 ,XTS,W
 ,ASN,64+12
 ,ASN,64-12
 15,AOX,
 14,UJ,
 READ:,BSS,
 '=== p/p ~TEHiq (C BOzM.pOBTOPOM) ===
 ,ATX,IR/
 E}E:,*70,IR/
 ,U1A,RET R
 ,XTA,IR/
 ,AAX,=77 0000.MOD
 ,AOX,IREADY
 ,ATX,W
C   pPOBEPiM gOTOBHOCTx MOdYlq
 PRD:,*70,W
 ,U1A,LOOP.ECTx gOT
 ,XTA,W
 ,APX,=77 0000
 ,AUX,MMOD
 ,AOX,/MOD
 ,ATX,TRD+1
 14,VTM,TRD
 ,ITA,14
 ,AOX,MN*TL
 ,FUN,76B.OpEPATOPY
C  COOb}ili i pOdOvdEM
 ,XTA,TWAIT
 ,*57,13B
 ,UJ,PRD.pPOB.gOT.
 LOOP:,XTA,.CYMM=0 -HEYdA~A
 2,VLM,E}E
 RETR:2,VTM,-REP RE
 13,UJ,
 O~ plOXO:,BSS,
 12,VTM,T O~ pl
 ,XTA,IR/
 ,ASN,64-30
 ,AUX,=6H'7''7'''''''''
 ,AOX,=6H00-KAT
 12,ATX,
 ,UJ,DIAGNOS
 KILL:,BSS,
 13,VJM,CKOlxKO
 12,VTM,T/KILL
 ,UJ,DIAGNOS
 '=== KOHCTAHTO~Ki , TEKCTiKi ===
 M77:,GOST,6H077000
 IS/77:,ISO,6H 00 '1''1'
 R*PHIS:1,014,N/EX+22B
 ,,7774B
 W*PHIS:1,004,N/EX+24B.C KOHTPOlEM
 ,,7774B
 IREADY:1,Z00,40067B
 ,Z00,
 MMOD:,GOST,6H000770
 /MOD:,ISO,6HMd 00
 TRD:,ISO,6HHEgOT
 ,BSS,1
 ,LOG,0
 TE~T:,ISO,6HHE ~T
 TEzp:,ISO,6HHE zp
 TKAT:,ISO,6H*KAT**
 T plOXO:,BSS,2
 ,ISO,6HfAjl:
 NF:,OCT,
         ,ISO,6H zOHA
 NZ:,OCT,
 MDIG:,GOST,6H777700
      ,ISO ,4H0000
 T O~ pl:,ISO,24H47-KATAlOg HE pPO~ECTx!''
 {ApKA:,Z00,TKOpCd
 ,Z00,TKOpCd
 ,,
 8,,
 TKOpCd:,GOST,H+KOpiPOBAHiE +
 ,CONT,H+CiCTEMHyX +
 ,CONT,H+diCKOB'214''200''12'+
 ,CONT,H+17/06/85'231'+
 CBOdKA:,BSS,
 0,ISO,6HC MOd'1'
 1,ISO,6H 37 '1''1'
 2,ISO,6H(2048/
 3,ISO,6HDISPAC
 4,ISO,6H) '1''1''1''1'
 5,ISO,6HHA MOd
 6,ISO,6H 41 '1''1'
 7,ISO,6H(0001/
 8,ISO,6HDUBNA
 9,ISO,6H)100Mb
 ,OCT,
 T/TAK li:,ISO,7HTAK li'77'
 ,CONT,5H''''''''''
 T HEpOl:,ISO,H/BAM |TO HE pOlOvEHO!''/
 T/CKO  :,ISO,H/CKOpiPOBAHO/
 NZC:,BSS,1
 ,ISO,6HTPEKOB
 T HE TOT:,ISO,24H"KYdA" - HE TOT pAKET''''''
 T PAzHyE:,ISO,24HPAzHyE pAKETy : 7 i 29''''
 T/pEPE:,ISO,12H pEPEpiCAHO''
 T/KILL:,ISO,H/pPiKOH~ili!''/
 T ~Y{x:,ISO,6 H~Y{x!''
 HEAD:,ISO,6H'31'***'32''27'
 ,BSS,1
 ,ISO,18HKOpiP.CiCT.diCKOB''
 T/FR:,ISO,12HOTKYdA'77'''''''''''
 T/TO:,ISO, 6HKYdA'77'''
 T/NpAK:,ISO,12HN pAKETA'77'''''
 T/iMpAK:,ISO,6HiMq '77'''
 TWAIT:,REAL,30.
 ,END,
 TAPE/OUT:,NAME,
C     CPiCOBAHO C TAPEPRNT diCpET~EPA
C*****   zAdA~A PAzgPYzKi fAjlA ByBOdA
C
C        |KBiBAlEHTHOCTi pO AdPECAM diCpET~EPA
 *0  :  ,BLOCK,(1),RDSCAL
 *0  :  ,BLOCK,(46),SNOZON
C.....   N CTPOKi HA~AlA HOPMAlxHOj CTPAHicy
 CMIS:,EQU,=4
C.....   pPizHAK {ApKi KOHcA
 C*END:,EQU,=6H '136''274''136''176''176'
C.....
 AWR:,EQU,72100B
 CAT:,EQU,4000B
 SC/CAT:,EQU,CAT+1720B
 PLIST:,EQU,6000B
 NEXZ:,EQU,2000B
 CATSTEP:,EQU,5.
 OUTSTAT:,EQU,0
 C77:,EQU,=77
 BIT1:,EQU,=1
 *10:B,BLOCK,A/*ipd,A/STATUS
 A/gYC:,EQU,502B.
 BITREADY:,EQU,BIT48
 ISPR:,EQU,BIT46
 MlAb0:,EQU,=7700 0000
C.....   |KBiBAlEHTHOCTi PEgiCTPOB
 M1:,EQU,4
 B :,EQU,6
 T :,EQU,7
 M2:,EQU,10
 M3:,EQU,11
C.....   PAbO~iE q~EjKi , flAgi
 NUMLIST:,LC,1.
 Mf/FLG :,LC,1.
 *100:B,BLOCK,
 ,CONT,N1(0),NTEK,N2,NTEK*,ACAT
 ,CONT,FL1(0),N*
 ,CONT,GFL(0),LPF,PUF
 ,CONT,F,RP,F1,RP1
 ,CONT,PFLAG,TipYC,NOFIRST,ClOBO
 ,CONT,SM6,WL,WL1
 ,CONT,SDFL,DFL
 ,CONT,SSM6,ONS,FNP
 ,CONT,FFP,NPP,MlAb,Bpf(5)
 ,CONT,EXT,CHEW
 ,CONT,SCFREE(32)
 ,CONT,NSTR,NPAG,T2,NPA,NP1
 ,CONT,dHz/1
 ,CONT,BUFT(3)
 ,CONT,STRING(22)
 TA/PAR: LC,BLOCK,(2),NAME(3).
C****************************************
C  BMECTO |KCTPAKOdA *64 iCpOlxzYEM
C  pOdpPOgPAMMY COSYGOST
C  ByzOB KOTOPOj
C        :14,31,COSYGOST
C         iP,Z00,AdP.
C  gdE iHdEKCiPOBAHHyj AdPEC zAdAET
C  HA~AlO COSYGOST CTPOKi  ili CpEc-HO:
C  iCp. AdPEC PABHyj -1 - KOHEc PAbOTy
C               =     0 - HA~AlO PAbOTy
C               =     1 - KOHEc liCTiHgA
C****************************************
 ABOCT:,SUBP,.
 COSYGOST:,SUBP,.
C.....
 *BAS/:    B,BASE,*
 ,*65,760B.
 ,ATX,A/*ipd.
 ,ASN,64+24.
 ,ATX,A/STATUS.
 ,*65,502B.
 ,ATI,11.
 11,*65,.
 ,ASN,64+42.
 ,ATX,dHz/1
 14,VTM,ABOCT....
 ,ITA,14.
 ,FUN,74B.PEAKciq HA KOHEc
 ,XTA,END PR
 ,CTX,20B
 ,XTA,=3053 4576 1634 0112
 ,*76,1.
C.....   HA~AlxHAq YCTAHOBKA flAgOB
 11,*65,.
 ,APX,=77 00000
 15,ATX,
 ,ASN,64+6
 15,AOX,
 ,AUX,=6H'''7''7''''77'''
 ,AOX,=6H{00('100')
 ,ATX,HEAD.
 11,VTM,HEAD
 ,ITA,11.
 ,FUN,76B
 11,VTM,HEAD+1
 ,ITA,11
 ,FUN,64B.iMq
 ,UJ,ObXOd//...........BPEMEHHO, OTlAdKA
 ZAK/MT:,ENTRY,.
C*******************************************
C   zAKAz Mf EC  C ByCOKOj plOTHOCTx`
C   zApiCi.
C*******************************************
 :B,VTM,*BAS/.
 ,*65,760B
 ,ASN,64+24.
 ,ATX,A/STATUS.
 dAj Mf:14,VTM,T dAj.
 ,ITA,14.
 ,FUN,76B
 ,ITA,B
 ,FUN,66B.OTBET
 ,ASN,64+12.
 ,ATX,SM6.TEKCT OTBETA
 ,AEX,=20 20
 ,AAX,=70 70
 ,UIA,~Y{x1.
 ,XTA,SM6.
 ,ARX,=01 00
 ,AAX,=04 00
 ,UZA,~Y{x1.
 ,XTA,SM6.
 ,APX,=07 07
 15,ATX,.
 ,AUX,=6H'''''''''7''7'
 ,AOX,=6H Mf-00
 ,STX,HEAD+2.
 ,ASN,64-9 .!
 ,YTA,.
 13,VTM,40053B.MAT HOMEP-53
 ,AOX,=:7777 7777 7777 7
 ,*57,2170B
 ,ATI,13.
 13,VZM,~Y{x2.
 ,AAX,=:74
 ,UIA,~Y{x2.
 ,ITA,13.
 ,ASN,64+3
 ,ATI,13.
 ,WTC,A/STATUS.
 13,*65,20-3.q~EjKi pPizHAKi EC
 ,AAX,=377
 1,UIA,.zAKAz pPABilxHyj
 ,UTC,Mf3-Mf2
 ~Y{x2:,UTC,Mf2-Mf1
 ~Y{x1:14,VTM,Mf1.
 ,ITA,14.
 ,FUN,76B
 ,UJ,dAj Mf.
 ObXOd//:,BSS,.
 11,VTM,HEAD+1
 ,FUN,64B.
 11,VTM,N1-NP1
 ,XTA,
 INIT:11,ATX,NP1
 11,VLM,INIT
 ,XTA,MlAb0
 ,ATX,MlAb
C.....
 ,UTC,NUMLIST.~TO BydABATx
 ,XTA,    .
 ,ASN,64+6
 ,ATX,NTEK
 ,YTA,
 ,ASN,64+42
 ,UZA,PUT N2.zApYCK HA dEvYPCTBO
 ,ARX,=1
 PUT N2:,ATX,N2.KOHEc pO HOMEPY
 :14,31,COSYGOST.
 ,,.HA~AlO PAbOTy
 NEWL:,XTA,.
 ,ATX,NPP
C.....   dOCbPOC pEPfOPAcii pPEdyd.zAdA~i
 ,XTA,NEXBUF0
    ,AEX,NEXBUF
    ,UZA,OL3
    8,VJM,*C
 OL3:,XTA,PFLAG
 ,UZA,*OL
 ,XTA,
    ,ATX,PFLAG
 11,VTM,1-3.
 10,VTM,Bpf.
 TT1: ,XTA,=6Hpf-EC-
 10,ATX,
 TT0:,WTC,ACAT.
 11,XTA,4.
 11,ATX,Bpf+3.
 11,VLM,TT0.
 TT:11,VTM,1-120
 ,ITA,10
 ,FUN,76B
 TT2:,BSS,.
 3,VJM,TELL
 ,UZA,*OL.
 ,*65,6
 ,AAX,=400
 ,U1A,*OL
 ,*57,3.
 11,VLM,TT2.
 ,UJ,TT.
     *OL:,BSS,
C.... OTKAz OT pf/pl
  ,*71,=:001.pK
  ,*71,=1.pl
 ,XTA,NOFIRST.
 ,UZA,CONTL.
 ,XTA,IRCAT
 ,*57,7
 ,XTA,ACAT.
 ,ATI,M2.
C.....   OCBObOvdATx li zAHqTyE PECYPCy
  ,XTA,DFL
  ,AAX,BIT1
C   ECli pE~ATx HE~ETHyX CTPAHic -
C   - OCBObOvdATx E}E PAHO !
  ,U1A,REF.HE~ET
 ,UTC,Mf/FLG.
 ,XTA,
 ,UZA,REF.
 M2,XTA,OUTSTAT.
 ,AOX,ISPR
 ,AEX,ISPR
 M2,ATX,OUTSTAT
 ,AAX,BITREADY
 ,UZA,REF . = HET
 M2,AEX,OUTSTAT
 M2,ATX,OUTSTAT.
 M2,VTM,1-32
 SCFL:M2,XTA,SCFREE+31
 M2,AOX,SC/CAT+31
 M2,ATX,SC/CAT+31
 M2,VLM,SCFL.
 ,XTA,IWCAT
 ,*57,7
C.....   OTKPyTiE zAdA~, vdY}iX PECYPCOB
 ,WTC,A/*ipd.
 11,VTM,SNOZON
 ,*76,PUT SC
 ,UJ,REF OA
 REF:,BSS,
 ,XTA,IWCAT
 ,*57,7
C
C*****   BybOP zAdA~i dlq ByBOdA
C
 REF OA:,BSS,
 ,XTA,NTEK*.
 ,UZA,CONT0.
 ,ATX,NTEK.
 ,XTA,.
 ,ATX,NTEK*.
 CONT0:,XTA,N*.
 ,UZA,CONT1.
 ,XTA,NTEK.
 ,ARX,=77
 ,AAX,=7777 7777 7770 0077
 ,ATX,NTEK*.
 ,XTA,N*.CfOPMiPOBAHO pO |KCpPECC pPiKAzY
 ,ASN,64+15
 ,AAX,=77777
 ,UZA,CONT01
 ,AOX,=I0
 ,ATX,NPP.HA~AlxHAq CTPAHicA
 ,XTA,SDFL
 ,UZA,CONT01.
 ,ATX,DFL.pPizH. dBYCTOP. pE~ATi. HEObPATiM.
 CONT01:,XTA,N*
 ,UJ,CONT2.
 CONT1:,BSS,.
 ,XTA,NTEK.
 ,ARX,=1.
 CONT2:,BSS,.
 ,AAX,=7777 7777 7770 0077
 ,ATX,NTEK.
 CONTL:,BSS,
 ,XTA,=1.
 ,ATX,NOFIRST.
 ,XTA,NTEK.
 ,ATI,M3.
 ,ASN,64-2.
 ,ARX,NTEK.
 ,ATI,M2.
 M2,UTM,CAT.
  RCAT:,BSS,
 ,XTA,IRCAT
 ,*57,7
 ,XTA,CAT.
 M1,VTM,-63.
 SEARCH:,BSS,.
 ,XTA,N*
 ,AOX,N2
 ,U1A,CHE N*2
 ,XTA,DFL
 ,U1A,DENT.dBYCTOP.pE~ATx TOlxKO pO EdiHi~HOMY zAKAzY
 ,XTA,MlAb
 ,UZA,SRCH1.BCE lAbOP.
 M2,XTA,OUTSTAT
 ,AAX,=:04
 ,U1A,MORE1.HE pE~ATATx
 M2,XTA,OUTSTAT
 ,AAX,=5 000 000.pB ili MT
 ,AAX,MlAb
 ,U1A,SRCH1
 M2,XTA,2
 ,AEX,S/ISO
 ,AAX,=7760 0000 0000 0000
 ,UIA,MORE1
 SRCH1:,BSS,
 ,XTA,BITREADY
 ,AOX,ISPR
 M2,AAX,OUTSTAT
 ,AEX,BITREADY
 ,UZA,PRINTJOB
 MORE1:M3,UTM,-77B
 M3,V1M,NOCEND
 M3,VTM,-100B
 M2,VTM,CAT-CATSTEP
 NOCEND:M3,UTM,100B
 M2,UTM,CATSTEP
 M1,VLM,SEARCH
 DENT:,BSS,
 M1,VTM,-9.
 ,XTA,
 ,FUN,AWR+82
 ,XTA,I/DMNPL
 ,FUN,210B
 3,VJM,TELL.
 ,XTA,N*.
 ,U1A,CONT0
 WLP:,*57,3
 M1,VLM,WLP
  ,UJ,RCAT
C.....   PAzHOBidHOCTi zApYCKA pO HOMEPAM
 SEL0:,ATX,N*
 ,UJ,REF OA
 CHE N*2:,BSS,
 ,XTA,N*
 ,U1A,PRINTJ
 ,XTA,N2
 ,AEX,NTEK
 ,AAX,=77
 ,UZA,END PR
C
C*****   ByBOd BybPAHHOj zAdA~i
C
 PRINTJOB:,ITA,M3
 ,ATX,NTEK
 PRINTJ:,ITA,M2
 ,ATX,ACAT
 M2,XTA,OUTSTAT
 ,UZA,SEL 0
 ,AOX,ISPR
 M2,ATX,OUTSTAT
 ,AAX,=777
 ,ATX,EXT.
 ,XTA,IWCAT
 ,*57,7
 14,VTM,-2.
 L///:14,UTC,2.
  M2,XTA,1.
 14,UTC,NAME.
 ,ATX,2.
 14,VLM,L///.zApiCAli NAME
 M2,XTA,OUTSTAT
 ,AAX,=77 77 77 000 000.NByB,NBB,NlAb
 ,ATX,CHEW
 ,XTA,.
 M3,VTM,-31
 ZS:M3,ATX,SCFREE+31
 M3,VLM,ZS.
 ,ATX,F1
 ,ATX,FFP
 ,ATX,N*
 1,VJM,RT 0
 NEWSTR:,BSS,
 8,VTM,-21.
 3,VJM,TELL.      OpPOC pPiKAzA i ObPAbOTKA
 ,UZA,SCHEND.pPOpYCK liCTiHgA
 3,VJM,GIVSYM
 ,AEX,=77777777 77777777.
 ,UZA,CHDFL.KOHEc liCTiHgA
 ,ASN,64+40
 ,AEX,=1
 ,UZA,PUNCH
 ,XTA,SM6
 ,AAX,=:776
 ,ATX,RP1.~iClO pPOTqvEK
 ,AEX,SM6
 ,ATX,SM6
 ,XTA,F1
 ,U1A,BL.HE HA~AlO liCTiHgA
 ,ATX,RP1
 ,XTA,CMIS.N CTPOKi HA~AlA liCTiHgA
C*****   pEPBAq CTPOKA idET pOClE
C*****   pPObElOB, CPAzY pOClE CgibA
 ,ATX,ONS.CTAPyj HOMEP CTPOKi
 ,ATX,NSTR
 ,XTA,=I0
 ,ATX,NPAG
 ,ATX,F1
 ,XTA,F
 ,UZA,FIRST PR
 :14,31,COSYGOST.HA~AlO PACpE~ATKi
  ,,T3.
 FIRST PR:,XTA,=1
 ,ATX,F
 BL:,XTA,SM6.
 8,ATX,STRING+21.
 ,AAX,=377.
 ,AEX,=176.
 ,UZA,PRINT.
 3,VTM,BL
 8,VLM,GIVSYM.
 ,UJ,CbPOC
 CHDFL:14,31,COSYGOST.
 ,,1.CbPOC liCTiHgA
      :,XTA,DFL
 ,UZA,NEWL.Oby~HAq pE~ATx
 ,AEX,NPAG
 ,AAX,BIT1
 ,UZA,NEWL.bYMAgA B pOPqdKE pOClE pE~ATi pOClEdHEj CTPAHicy
 9,VTM,T1
 :14,31,COSYGOST.YCTAHOBKA bYMAgi pO liHEjKE
 9,,.
 ,UJ,NEWL.pOdgOTOBKA K HOBOj PAbOTE
 PRINT:,BSS,
C
C-----   pE~ATx iCXOdHOj CTPOKi
C-----   BEdEHiE C~ET~iKA CTPOK
C-----   HYMEPAciq CTPAHic
C
 ,XTA,NTEK.pE~ATx-blOKiP.
 ,AAX,BIT48.- HA fAjl
 ,AOX,LPF.- BOOb}E
 ,U1A,NEWSTR. = dA
 ,NTR,3
 ,XTA,RP1.~iClO pPOTqvEK
 ,ASN,64+40
 ,ATX,RP
 ,ARX,NSTR
 ,ATX,NSTR
 ,XTA,NPAG
 ,ASN,64-7
 14,VTM,PRIH
 ,UZA,CORNP.N CTPAHicy E}E 0
 ,XTA,NSTR
 ,A-X,=110
 ,U1A,*2. My BHYTPi CTPAHicy
 ,ATX,NSTR
 ,XTA,=112. Y~iTyBAEM N CTPOKi C N CTPAHicy
 ,A-X,ONS. Y~iTyBAEM pOlOvEHiE bYMAgi
 ,ATX,RP1. pPOTqvKi pEPEd pE~ATx` N CTPAHicy
 ,XTA,=110
 ,ATX,FNP.pPizHAK HOBOj CTPAHicy
 CORNP:,XTA,NPAG
 ,ARX,=1
 ,ATX,NPAG
C.....   KOdiPOBKA B GOST HOMEPA CTPAHicy
 PRIH:,XTA,NPP.HA~AlxHAq CTPAHicA pE~ATi
 ,UZA,PRIH1
 ,AEX,NPAG
 ,U1A,NEWSTR. HA~AlO E}E HE HAjdEHO
 ,ATX,RP1. ~iCTKA pPOTqvEK B HA~AlE pE~ATi
 PRIH1:,ATX,NPP
 ,XTA,DFL.pPizHAK dBYCTOPOHHEj pE~ATi
C.....    TAM vE HOMEP HA~. CTPAHicy HA CTOPOHE
 ,UZA,HOPM
 ,AEX,NPAG
 ,AAX,BIT1
 ,U1A,NEWSTR. HE TA ~ETHOCTx
 HOPM:,BSS,
 ,XTA,NSTR
 ,A-X,CMIS
 ,U1A,*2. HEgdE HApE~ATATx HOMEP
 ,NTR,2
 ,XTA,NPAG
 ,A+X,=I0
 ,ATX,WL1
 ,XTA,
 ,ATX,NPA
 14,VTM,-2
 CDP:,XTA,WL1
 ,ATX,WL
 ,A/X,=R10.
 ,NTR,3
 ,A+X,=I0
 ,NTR,2
 ,A+X,=I0
 ,ATX,WL1
 ,A*X,=R10.
 ,X-A,WL
 ,NTR,3
 ,A+X,=I0
 ,ASN,64-40
 ,AOX,NPA
 ,ASN,64+8
 ,ATX,NPA
 ,NTR,2
 14,VLM,CDP
 ,AOX,T2/2
 ,ATX,NPA
 ,XTA,FFP
 ,U1A,PRIH2
 ,XTA,T2/1
 ,ATX,FFP
 ,XTA,NTEK
 ,ASN,64-34
 ,AUX,UCP
 ,AOX,CP
 PRIH2:,ATX,T2
 ,XTA,RP1
 ,ASN,64-40
 ,AOX,T2
 ,ATX,T2
 :14,31,COSYGOST
 ,,T2.
 ,XTA,=2. pOlOvEHiE bYMAgi pOClE N CTPAHicy
 ,ATX,ONS. OLD NUMBER OF STRING
 ,XTA,
 ,ATX,FNP.gA{EHiE pPizHAKA HOBOj CTPAHicy
 *2:,XTA,NPP
 ,U1A,NEWSTR
 ,NTR,3
 ,XTA,DFL
 ,UZA,HOPM1
 ,AEX,NPAG
 ,AAX,BIT1
 ,U1A,NEWSTR
 HOPM1:,BSS,
 ,XTA ,NSTR
 ,A+X,FNP.0 ili 110
 ,A-X,ONS.
 POS:,ATX,RP. ~iClO pPOTqvEK pEPEd HOBOj CTPOKOj
 ,XTA,
 ,ATX,FNP
 ,XTA,NSTR
 ,ATX,ONS. zApOMiHAEM pOlOvEHiE bYMAgi
 ,XTA,RP
 ,ASN,64-40
 ,AOX,STRING
 ,ATX,STRING
 :14,31,COSYGOST.
 ,,STRING.
 WRN 1:,XTA,HEAD+2
 ,FUN,AWR+81
 ,XTA,NTEK
 ,ASN,64-42
 ,AUX,=6H'''7''7'''''''
 ,AOX,=6H:00''''''
 ,FUN,AWR+82
 ,UJ,NEW STR.HA ClEd.CTPOKY
 RT 0:,BSS,
C.....   OCBObOvdEHiE |lEMEHTA KATAlOgA
 ,XTA,NTEK
 ,ASN,64-42
 ,AUX,=17 00003
 ,ATI,M2
 ,ASN,64+15
 ,ATI,M1
 ,XTA,BIT48
 M2,ASN,64
 M1,AOX,SCFREE
 M1,ATX,SCFREE
 RT:,BSS,
C.....   ~TEHiE zOHy iz OblACTi ByBOdA
 ,XTA,EXT
 ,AOX,EXT0
  ,ATX,ClOBO
 ,*57,7
 2,VTM,2012B
 ,XTA,NEXZ.
 ,AAX,=777
 ,ATX,EXT
 ,XTA,NEXZ
 ,AEX,CHEW
 ,AAX,CHEM
   ,UZA,CNZ
 :14,31,COSYGOST.
 ,,T1.
 ,UJ,CbPOC
   CNZ:,BSS,
C.....   OCBObOvdEHiE zOHy BO BHYTP.{KAlAX
 ,XTA,ClOBO
 ,ASN,64-39
 ,AUX,=17 00037
 ,ATI,M2
 ,ASN,64+15
 ,ATI,M1
 ,XTA,BIT48
 M2,ASN,64
 M1,AOX,SCFREE+16
 M1,ATX,SCFREE+16
 SZ:,BSS,
C.....
 ,XTA,CHEW
 ,ARX,=1000
 ,ATX,CHEW
    1,UJ,
 GIVSYM:,BSS,
 ,ITA,2
 ,AAX,=1777
 ,U1A,OK
 1,VJM,RT
 OK:,BSS,
 2,XTA,
 2,UTM,1
 ,ATX,SM6
 3,UJ,
 TELL:,BSS,
C
C*****   BBOd i AHAliz pPiKAzOB
C
C.....   pPObA : pPiKAz C HOMEPOM AcpY
 ,XTA,   .bEz zAKPyTiq
 ,*50,66B
 ,UZA,NEG RET. HET COOb}EHiq
 ,ASN,64+12.
 ,ATX,SM6
 ,AEX,TEX/0
 ,AAX,=77
 T,VTM,TTB
 ,UZA,CHd.= ...'0P'
 CH LP:,BSS,
C.....   K HAM li OTHOCiTCq pPiKAz
 ,UJ,OUR
 ALL:,BSS,
C.....   zAdAHiE ByBOdA BCEX lAbOPATOPij
 ,AEX,MlAb0
 ,ATX,MlAb
 ,UZA,ALL1
 ,UTC,TlBTA-TTAL
 ALL1:T,VTM,TTAL
 ,ITA,T
 ,FUN,76B
C.....
 NEG RET:,XTA,=1
 3,UJ,
 CHd:,XTA,DFL
 ,U1A,ER ORD.dBYCT.pE~ATx TOlxKO C N AcpY
 OUR:,BSS,
C.....   pPiKAz OTHOCiTCq K HAM
 13,VTM,FOR-LOR
 ,XTA,SM6
 ,UZA,POSRET.pPiKAz (NY)P
C.....   pOiCK Kl`~EBOgO CiMBOlA
 SEAR:13,XTA,LOR
 ,AEX,SM6
 ,AAX,=77
 ,U1A,E SEAR
 ,XTA,SM6
 ,ASN,64+6
 13,UJ,E SW.= pEPEKl`~ATElx
 E SEAR:13,VLM,SEAR.
 ,UJ,ER ORD.= HE HA{li
C.....
 SW:13,VTM,1.blOKiP.
 ,UJ,blOK.pEPfOP.
 :13,VTM,.blOKiP.
 ,UJ,blOK. AcpY
 :,XTA,MlAb. BydA~A
 ,UJ,ALL.pO lAbOP.
 :,UJ,END PR.= KOHEc
 :,UJ,POS RET.= Bzqli pf
 :,UZA,ER ORD
  ,UJ,DEX.dBYCTOPOHHqq pE~ATx
 E SW:,UZA,ER ORD.|KCpPECC-
 ,UJ,EXPRES. BydA~A
C-----   blOKiPOBKi
 blOK:,U1A,bl
 ,XTA,=1
 13,ATX,GFL
 ,XTA,
 ,UJ,OUT TL
 EXPRES:,ATX,SSM6
 ,XTA,DFL
 ,U1A,ER ORD.ObPATHO HElxzq
 ,XTA,SSM6
 DEX:,BSS,
 13,VTM,2
 T,VTM,TTEX
 bl:,AAX,=7070
 ,AEX,=2020
 ,UZA,bl1
 ,XTA,SM6
 ,ASN,64+12
 ,U1A,ER ORD
 bl1:,XTA,SM6
 ,APX,=70700
 ,ASN,64+42
 13,AOX,BIT48
 ,ATX,FL1.OH vE N*
 ,ASN,64-42
 ,AUX,=6H'7''7'
 ,AOX,B12IZ
 ,NTR,3
 OUT TL:,ATX,BUFT+2
 13,XTA,Tbl
 ,ATX,BUFT+1
 T,XTA,
 ,ATX,BUFT
 ,XTA,A BUFT
 ,FUN,76B
 13,VZM,NEG RET
 ,XTA,BUFT+2
 ,UZA,NEG RET
C.....   pEPEKOdiPOBKA HOMEPA CTPAHicy
 13,VTM,1-3
 ,XTA,
 ,ATX,NP1
 ,XTA,SM6
 ,ATX,SSM6
 ,ASN,64-12
 DECNP:,ASN,64-6
 ,ATX,SM6
 ,YTA,
 14,VTM,1-10
 ,UZA,DEC1
 ,A-X,TEX/0
 ,U1A,ER ORD
 ,A-X,=12
 ,UZA,ER ORD
 ,A+X,=12
 DEC1:,ARX,NP1
 14,VLM,DEC1
 ,ATX,NP1
 ,XTA,SM6
 13,VLM,DECNP
 ,XTA,NP1      . N HA~AlxHOj CTPAHicy
 ,ASN,64-15
 ,UZA,pd
C.....   bylA blOKiPOBKA pf pPi pE~ATi HE C HA~AlA liCTiHgA
 ,AOX,FL1
 ,ATX,FL1.
 pd:,XTA,SSM6
 ,AEX,TEX/d
 ,AAX,C77
 ,U1A,NEGRET.
 ,XTA,NP1
 ,UZA,ER ORD.dBYCT. pE~ATx TOlxKO C N CTPAHicy
 ,ATX,SDFL.pPizHAK XPAHiTCq dO HA~AlA PAbOTy
 ,UJ,NEG RET
C.....   pPOpYCK BydA~i / zAbPAli pf
 POS RET:,XTA,NTEK
 ,ASN,64-42
 ,AUX,=6H'7''7'
 ,AOX,B12IZ
 14,VTM,TTM
 14,ATX,1
 ,ITA,14
 ,FUN,76B
 ,XTA,
 3,UJ,
C.....   O{ibO~Hyj pPiKAz
 ER ORD:,XTA,A TTE
 ,FUN,76B
 ,XTA,
 ,ATX,FL1
 ,XTA,=1
 3,UJ,
     PUNCH:,BSS,
C
C-----   pEPfOPAciq  pK  i  pfl
C
C.....   KOl-BO ClOB pEPfOPAcii
 2,XTA,-1.
    ,AAX,=77777
     ,AEX,=77777
    ,ARX,=1
    ,ATI,11
C.....   AdPEC pO liCTY pEPfOPAcii
 ,XTA,NEXBUF
 ,ATI,12
C.....   HA bYf.liCTE ~TO ECTx
 14,VTM,PLIST.
 ,ITA,14.
 ,AEX,NEXBUF.
 ,UZA,*P0. - HET
C.....   COBpAdAET li Tip (pK/pl)
 2,XTA,-1.
 ,AAX,=:001.
 ,AEX,TipYC.
 ,UZA,*P0. - dA
 8,VJM,*C.
 *P0:,BSS,.
 2,XTA,-1.
    ,AAX,=10000000000000
    ,ATX,TipYC
    *LOOP:,BSS,
 8,VTM,PLIST+1760B
 3,VJM,GIVSYM
 12,ATX,
 ,XTA,NPP
 ,U1A,BLP. blOK pf pOKA i}ETCq CTPAHicA
 ,XTA,DFL
 ,AAX,BIT1
 ,U1A,BLP. blOK.pf pPi pE~ATi HE~ETHyX CTPAHic
 12,UTM,1
 BLP:,BSS,
 ,XTA,TipYC.
 ,UZA,*pl0.
 ,XTA,SM6
    ,AAX,=7760000000000000
      ,U1A,CbPOC
 *pl0:,BSS,.
    ,ITA,12
    ,ATX,NEXBUF
 ,ITA,8
    ,AEX,NEXBUF
 ,U1A,*EL
 8,VJM,*C
    *EL:11,VLM,*LOOP
    ,UJ,NEWSTR
   *C:,BSS,
 ,XTA,NEXBUF
 ,ATI,12
 ,XTA,
 12,ATX,
 12,ATX,1
 3,VJM,TELL
 ,UZA,SCHEND
 ,XTA,NTEK
 ,AAX,BIT47
 ,AOX,PUF
 ,U1A,INITBP
 ,XTA,=1
 ,ATX,PFLAG
 ,XTA,TipYC
 ,UZA,*pl
 ,*71,I1
 ,UJ,INITBP
 *pl:12,UTM,-1
 ,*71,I2
 INITBP:,BSS,
    12,VTM,PLIST
    ,ITA,12
   ,ATX,NEXBUF
    8,UJ,
 SCHEND:,BSS,
 :14,31,COSYGOST
  ,,T4.
 SCH1:,BSS,
 3,VJM,GIVSYM
 ,AEX,=7777 7777 7777 7777
 ,UZA,CbPOC
 ,AEX,=7777 7777 7777 7777
 ,AEX,C*END
 ,AAX,=17 7777 7777 7777
 ,U1A,SCH1
 ,UJ,NEWSTR
     CbPOC:,BSS,
 :14,31,COSYGOST.
 ,,1.CbPOC liCTiHgA
 ,XTA,
 ,ATX,PFLAG
 8,VTM,NEWL
 ,UJ,INITBP
 END PR:14,31,COSYGOST.
 ,Z00,77777B
C.....   OTKPyTiE zAdA~ pO {KAlAM
 PUT SC:14,REL,*
 11,XTA,
 ,WTC,A/gYC
 ,AOX,RDSCAL
 ,WTC,A/gYC
 ,ATX,RDSCAL
 ,XTA,
 11,ATX,
 ,MTJ,27B
 2,IJ,
C.....
 INFT:9,,
 9,,
 ,Z00,
 8,Z00,
     I1:,Z01,PLIST
 12,,
    I2:,Z00,PLIST
 12,,
 INF:,Z10,STRING.
 ,Z00,
 INFT2:,Z10,T2
 ,,
C-----   (
 BIT48:,OCT,4
 BIT47:,OCT,2
 ,LOG,
C-----   )
  CHEM:,LOG,77 77 77 777 000
 EXT 0:,OCT,1410 01
 BIT46:,OCT,1
 IRCAT:1,,
 ,Z00,CAT
 IWCAT:2,,
 ,Z00,CAT
 I/DMNPL:,LOG,1 00002
C-----
 A BUFT:,,
 ,Z00,BUFT
 A TTE:,,
 ,Z00,TTE
 NEXBUF:,,
 ,Z00,PLIST
 NEXBUF0:,,
 ,Z00,PLIST
C-----
 CP:,GOST,6H'377''201'f00'264'
 UCP:,GOST,6H'377'00770
 T1:,GOST,6H'377''127''127''127'.'176'
 T2/1:,GOST,6H'377''201''200''200''200''264'
 T2/2:,GOST,6H-000-'176'
 T3:,GOST,2H'377''176'000'176'
 T4:,GOST,4H'377'*'223'*
 ,CONT,20H  pPOpY}EHA BydA~A
 ,CONT,6H*'223'*'176''176''176'
 ,BSS,
C-----   (
 FOR:,TEXT,8H       l
 ,TEXT,8H       p
 ,TEXT,8H       B
 ,TEXT,8H       K
 ,TEXT,8H       f
 TEX/d:,TEXT,8H       d
 LOR:,TEXT,8H       |
 ,BSS,
C-----   )
 TEX/P:,TEXT,8HP
 TEX/0:,TEXT,8H       0
 ,BSS,
C-----   (
 Tbl:,ISO,6HAcpY-'1'
 ,ISO,6Hpf-'1''1''1'
 ,ISO,6H'1''1''1''1''1''1'
 ,BSS,
 B12IZ:,ISO,6H00''''''''
C-----   )
 TTB:,ISO,6HblOK-'1'
 TTEX:,ISO,6H|KCpP-
 TTM:,ISO,6HpPOp-'1'
 ,BSS,1
 TTAL:,ISO,12HBCE lAbOP,''''
 TlBTA:,ISO,12HByBOd lBTA''''
 TTE:,ISO,12HO{.pPiKAz''''''
 ,BSS,
C-----
 S/ISO:,ISO,1HS
 HEAD:,ISO,30H{01(A) ByBOd Mf-EC      ''''''''''''
 Mf3:,ISO,18HMAgHiTOfOH HE EC'41'''
 Mf2:,ISO,12HPEviM Mf'41'''''''
 Mf1:,ISO,12HO{. HAbOP'41'''''
 T dAj:,ISO,18HMf PAzgPYzKi'77'''''''''''
 ,END,
 TASK11:,NAME,
C  zABEdEHO iCKl`~iTElxHO B cElqX |KOHOMii
C  pAMqTi.
 P:,PC,0
 TAPEPRNT:,SUBP,
 NUMFOR:,SUBP,
 ,UJ,TAPEPRNT
 ,END,
