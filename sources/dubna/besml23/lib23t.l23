 JERR:,NAME,
C
C****************** E.Д.ФEДЮHЬKИH 13/10/81
C*
C*   FUNCTION JERR(N)
C*   ПEPEXBAT PEAKЦИИ HA OШИБOЧHЫЙ PEKOPД
C*   ПPИ ФOPMATHOM BBOДE ИЗ ФOPTPAHA (ИЛИ
C*   ПPИ OПEPAЦИИ DECODE).
C*   PEAKЦИЯ HA OШИБOЧHЫЙ OПEPATOP FORMAT
C*   HE ПEPEXBATЫBAETCЯ.
C*   ЗAKAЗ ПEPEXBATA: N=I, ГДE I - ЦEЛOE,
C*   OTЛИЧHOE OT HYЛЯ. ФYHKЦИЯ BOЗBPAЩAET
C*   ЗHAЧEHИE HYЛЬ.
C*   OTKAЗ OT ПEPEXBATA: N=0. ФYHKЦИЯ BOЗ-
C*   BPAЩAET ЗHAЧEHИE HYЛЬ.
C*   ПPИ OШИБKE YПPABЛEHИE ПEPEДAETCЯ ПOД
C*   ФYHKЦИЮ, ПPИЧEM ЗHAЧEHИE ФYHKЦИИ PAB-
C*   HO I. ПPИ HECKOЛЬKИX ЗAKAЗAX ПEPEXBA-
C*   TA ДEЙCTBИTEЛЬHЫM OKAЗЫBAETCЯ ПOCЛEД-
C*   HИЙ. K JERR CЛEДYET OБPAЩATЬCЯ ИЗ ГO-
C*   ЛOBHOЙ ПPOГPAMMЫ И ГOЛOBHOГO PAЗДEЛA.
C*   CПACAETCЯ ДBA CЛOBA MAГAЗИHA.
C*
C*   ПPИMEP ИCПOЛЬЗOBAHИЯ:
C*
C*      IF(JERR(1).EQ.0) GO TO 100
C*      <PEAKЦИЯ HA OШИБKY>
C* 100  <HOPMAЛЬHOE ПPOДOЛЖEHИE>
C*
C
 JERRIO*:,LC,1
 ,ATI,14
 14,XTA,
 10,VTM,BAS+5
 10,ATX,-4
 10,AAX,-5
 12,VTM,JERRIO*
 ,U1A,SET
 12,ATX,
 10,XTA,-4
 13,UJ,
 SET:10,AEX,-4
 ,ITS,13
 10,ATX,-3
 14,VTM,ERR
 ,ITA,14
 12,ATX,
 ,XTA,44B
 ,ASN,64+15
 ,NTR,3
 ,X-A,
 ,ATI,11
 ,ITA,
 ,E-N,
 10,ATX,-1
 10,ATX,-2
 15,J+M,11
 11,UTM,-2
 11,VZM,R
 15,XTA,-2
 10,ATX,-1
 11,UTM,-1
 11,VZM,R
 15,XTA,-3
 10,ATX,-2
 R:15,UTM,-1
 ,ITA,15
 14,VTM,8
 10,MTJ,15
 :14,UTM,-1
 14,ITS,
 14,V1M,*-1
 10,WTC,
 15,VTM,1
 15,XTA,
 :,NTR,6
 13,UJ,
 ERR:10,VTM,BAS+12
 10,XTA,
 10,MTJ,15
 14,VTM,-6
 :14,STI,7
 14,VLM,*
 ,STI,14
 ,NTR,13B
 :,UZA,*+1
 14,UTC,-1
 :,STX,
 ,NTR,13B
 ,UZA,*+1
 14,UTC,-2
 :,STX,
 ,STI,13
 14,MTJ,15
 ,UJ,ERR-1
 BAS:,LOG,37777777777777
 ,BSS,12
 ,END,
  JFOCC : ,NAME,
C*
C********** 02.07.81  A.П.CAПOЖHИKOB
C*
C*     FUNCTION  JFOCC (STR,FDB)
C*   ЗAXBAT TOMA MAГHИTHOГO HOCИTEЛЯ,
C*   YKAЗAHHOГO B TEKCTOBOЙ CTPOKE STR
C*   B OДHOM ИЗ CЛEДYЮЩИX ФOPMATOB :
C*
C*  (1)  ПO HOMEPY YCTPOЙCTBA :
C*     D(ISK=)31  - MAГHИTHЫЙ ДИCK
C*     T(APE=)62  - MAГHИTHAЯ ЛEHTA
C*     H(TAPE=)63 - MЛ HA BЫCOKOЙ ПЛOTH.
C*     E(TAPE=)51 - ЛEHTA B PEЖИME EC
C*     DRUM=21    - MAГHИTHЫЙ БAPAБAH
C*  (2)  ПO HOMEPY БOБИHЫ/ПAKETA :
C*     D(ISK=)28   T(APE=)362  H(TAPE=)9
C*     E(TAPE=)510
C*  (3)  ПO ПOЛHOMY ИMEHИ ЛEHTЫ/ДИCKA :
C*     D(ISK=)28/OWN
C*     T(APE=)362/WORKIN
C*     H(TAPE=)9/N
C*     E(TAPE=)510/NO CHECK
C*  (4)  ПO ИMEHИ ФAЙЛA HA ДИCKE :
C*     D(ISK=)28/OWN,WORKIN,FTEXT
C*  (5)  ПO ИMEHИ ФAЙЛOBOЙ CИCTEMЫ :
C*     D(ISK=)D,SITNIK,X
C*      (ЗДECЬ D - ИMЯ CИCTEMЫ)
C*  (6)  ПO MAT.HOMEPY, YЖE ЗAKAЗAHHOMY:
C*     L(UN=)67
C*  (7)  ЗAKAЗ  SCRATCH-ФAЙЛA
C*      S(CRATCH) - ПO YMOЛЧAHИЮ 40 ЗOH
C*      S,W41(200) - HOMEP=41, 200 ЗOH
C*      S(300) - HOMEP BЫБИPATЬ ABTOMAT.
C*  (8)  ЗAKAЗ 'ФИKTИBHOГO TOMA'
C*     P(IT)
C*
C*   ПPИ ЗAДAHИИ ЛEHTЫ ИЛИ ФAЙЛA HA ДИCKE
C*   MOЖHO YKAЗЫBATЬ PEЖИM ЧTEHИЯ/ЗAПИCИ,
C*   A TAKЖE MAT.HOMEP, KOTOPЫЙ CЛEДYET
C*   ПPИCBOИTЬ ЛEHTE/ФAЙЛY :
C*    DISK=28/OWN,WORKIN,TEXT,R
C*    T362,W67  - БOБ.362 (ЗAП.) ПOД N 67
C*
C*   ПPИ OTCYTCTBИИ MAT.HOMEPA OH БEPETCЯ
C*   ИЗ 2-ГO CЛOBA MACCИBA FDB, A ECЛИ
C*   TAM HOЛЬ, TO BЫБИPAETCЯ ABTOMATИЧECKИ
C*   ПPИ OTCYTCTBИИ PEЖИMA ЧT/ЗAП
C*   OH БEPETCЯ ИЗ 7-ГO CЛOBA  FDB.
C*
C*   B KOHЦE OПИCAHИЯ TOMA MOЖHO
C*   YKAЗЫBATЬ EГO OБЬEM B ЗOHAX :
C*    TAPE=9/MONSYS(1000)
C*    D1/SYST,JLOB,LIBR,W41(200)
C*   ПPИ HEYKAЗAHИИ OБЬEMA ДЛЯ ФAЙЛOB
C*   OH OПPEДEЛЯETCЯ ABTOMATИЧECKИ, ДЛЯ
C*   ЛEHT - ПOЛAГAETCЯ = 1000 ЗOH.
C*
C*    F D B  - XAPAKTEPИCTИKA HOCИTEЛЯ
C*   JFOCC ФOPMИPYET 1-8 CЛOBA ЭTOГO MACCИBA
C*   1 - TИП HOCИTEЛЯ :
C*       0 - ЗAKAЗ HE ПPOШEЛ ИЗ-ЗA OШИБKИ
C*       1 - ЗAKAЗAH ПOД MAT. HOMEPOM
C*       2 - ДИCKOBЫЙ ПAKET
C*       3 - MAГHИTHЫЙ БAPAБAH
C*       4 - ЛEHTA B PEЖИME EC
C*       5 - ФИKTИBHЫЙ TOM
C*   2 - MAT.HOMEP ЗAKAЗAHHOГO HOCИTEЛЯ
C*       ИЛИ ИMЯ ДИCKA ИЛИ HOMEP MБ.
C*   3 - ЗAKAЗAHHЫЙ OБ'EM HOCИTEЛЯ B ЗOHAX
C*   4:6 - TEKCT ДИAГHOCTИKИ (,ISO,18H...)
C*   7 - TPEБYEMЫЙ PEЖИM ЧT/ЗП (1HR ИЛИ 1HW)
C*   8 - 0,ECЛИ ДИCK, ИHAЧE 1
C*
C*   JFOCC BOЗBPAЩAET HA CYMMATOPE HOЛЬ,
C*   ECЛИ ЗAKAЗ ПPOШEЛ YCПEШHO, ИHAЧE
C*   HOMEP ДИAГHOCTИKИ (1,2,...), TEKCT
C*   KOTOPOЙ ПOПAЛ B FDB.
C*
C*
C*     FUNCTION JFEXCH ( FDB )
C*   OБMEH C YCTPOЙCTBOM, ЗAXBAЧEHHЫM
C*   ЧEPEЗ  JFOCC.  B 8-M CЛOBE  FDB
C*   HEOБXOДИMO ЗAДATЬ ИHФOPM.CЛOBO :
C*    1-12 : HOMEP ЗOHЫ
C*   31-35 : HOMEP ЛИCTA
C*    40   : "1"-ЧTEHИE,  "0"-ЗAПИCЬ
C*   ПPOЧИE PAЗPЯДЫ HECYЩECTBEHHЫ.
C*   JFEXCH BOЗBPAЩAET HA CYMMATOPE HOЛЬ,
C*   ECЛИ OБMEH ПPOШEЛ HOPMAЛЬHO, ИHAЧE
C*   HOMEP ДИAГHOCTИKИ, TEKCT KOTOPOЙ
C*   ЗAПИCЫBAETCЯ B 4-6 CЛOBA  FDB.
C*
C*
C*     FUNCTION JFEX1 ( FDB,LIST,NZON,T )
C*   MOДИФИKAЦИЯ JFEXCH C БOЛEE ФOPTPAHHЫM
C*   ИHTEPФEЙCOM.  ЗДECЬ :
C*   FDB - XAPAKTEPИCTИKA TOMA KAK B JFOCC
C*   LIST - CTPAHИЧHЫЙ MACCИB ДЛЯ OБMEHA
C*   NZON - HOMEP ЗOHЫ
C*   T - TИП OБMEHA : 1HW - ЗAПИCЬ,
C*                    1HR - ЧTEHИE.
C*   B ЭTOЙ MOДИФИKAЦИИ 8-E CЛOBO FDB
C*   OCTAETCЯ ПOCЛE JFOCC БEЗ ИЗMEHEHИЙ,
C*   T.E. YKAЗЫBAET HA TИП YCTPOЙCTBA.
C*   B 6-E CЛOBO FDB ПOCЛE ЧTEHИЯ ПOПAДAET
C*   1-E (ДИCK) ИЛИ 4-E (ЛEHTA) CЛYЖ.CЛOBO
C*   PEЗYЛЬTAT JFEX1 ФOPMИPYETCЯ TAK ЖE,
C*   KAK И JFEXCH.
C*
C*   ПOPTЯTCЯ  8-14 PEГИCTPЫ
C*   PEЖИM AY HE MEHЯETCЯ.
C*
C******************************************
C*
C
C...   CCЫЛKИ HA ДИCПETЧEP :
C
  AГYC   :,EQU,502B
  A/ИПД  :,EQU,760B
  Ш/CЛYЖ :,EQU,10B
  ADNAM  :,EQU,575B
  ATNAM  :,EQU,505B
  ATAPES:,EQU,504B
  CHEKMDFL:,EQU,512B
  REGSCAL:,EQU,100B
C...   OПИCAHИE  F D B  :
  *0:,BLOCK,TYP,NUM,VOL,ERR(3)
  ,CONT,REGIM
  ,CONT,IWEXCH
C...   П P O Ч E E :
  A/I0:,LC,1
 LSPN:,EQU,6. CM. SCSPEC
  SAVP:,EQU,46B
  RESP:,EQU,45B
C...   CИMBOЛЫ  I S O  :
  BLAN  :,EQU,40B
  LBR   :,EQU,50B
  COMMA :,EQU,54B
 SPEC:,EQU,56B.
  SLASH :,EQU,57B
  TWOP  :,EQU,72B
  EQU   :,EQU,75B
C...   Д И A Г H O C T И K A
  *1:,BLOCK,CИHTOШ,HEПOЛOЖ,OШHOMEP
  ,CONT,HETПAK,ЗAHПAK,HETMЛ
  ,CONT,YБEPИЗAП
  ,CONT,HETЗП,HEГOTMЛ,MЛЗAHЯTA
  ,CONT,ФAЗAH,HETMEC,HETДOC
  ,CONT,HETФAЙЛA
  ,CONT,ЗAПPЗП,ПPEBOБ,HEБЫЗAK
  ,CONT,ИMEHMЛ
  ,CONT,ПЛOXOБ
C
C------------------------------
C
  B:8,BASE,B
  ,STI,9.FDB
  ,ATI,12.STR
  10,VJM,TYPETASK
  10,VTM,40
  ,XTA,A/I0
  9,ATX,TYP
  9,ATX,VOL
  9,ATX,IWEXCH
  12,AEX,
  ,UZA,F1
  ,ITA,12
  F1:11,VTM,-4
  ,FUN,12
  ,ATX,ID
  14,UTM,-4
  14,VIM,E1.OШ.CИHT.
  ,FUN,70100B+136B.OГP-ЛЬ
  ,ATI,14
  14,UTM,-EQU."="
  14,VIM,FS
  10,VTM,
C.....  "ДЛИHHЫЙ" ФOPMAT
  FL:,XTA,ID
  10,ASN,64
  ,AEX,=6H
  ,AAX,=377
  ,U1A,FL1
  10,UTM,8
  11,VLM,FL
  FL1:,XTA,
  ,FUN,12
  14,UTM,-2
  14,VZM,FL2
  14,UTM,2-4
  14,VIM,E1.OШ.CИHT.
   15,ATX,
  ,AAX,=377
  ,ATI,14
  ,XTA,TTF
  ,STX,ID
  14,UTM,-40B
  14,VZM,FS1
  ,UJ,F2
   FL2:13,MTJ,11
  ,CALL,OCTTDEC
  11,MTJ,13
  ,UJ,F2
C.....  "KOPOTKИЙ" ФOPMAT
  FS:,XTA,ID
  ,ASN,64-8
  ,ATX,UNIT
  ,YTA,
  ,ATI,14
  14,UTM,-123B."S"
  ,XTA,UNIT
  14,VZM,CHFILE.SCRATCH
  FS1:,ASN,64+8
  ,AOX,=6H
  15,ATX,
  ,AEX,=6H
  ,AAX,=377
  ,STI,14
  14,VIM,F2
  11,VLM,FS1
C...
  F2:,ATX,UNIT
  ,FUN,70100B+136B
  ,ATI,12
 11,VTM,-6
C...
  F3:,XTA,ID
 11,AEX,TTF+5
  10,ASN,64
  ,UZA,F4
  11,VLM,F3
  E1:14,VTM,CИHTOШ
  ,UJ,ERROR
  E2:14,VTM,HEПOЛOЖ
  ,UJ,ERROR
  E3:14,VTM,OШHOMEP
  ,UJ,ERROR
  E4:14,VTM,HETПAK
  ,UJ,ERROR
  E5:14,VTM,ЗAHПAK
  ,UJ,ERROR
  E6:14,VTM,HETMЛ
  ,UJ,ERROR
  E7:14,VTM,HETЗП
  ,UJ,ERROR
  E71:14,VTM,YБEPИЗAП
  ,UJ,ERROR
  E8:14,VTM,HEГOTMЛ
  ,UJ,ERROR
  E9:14,VTM,MЛЗAHЯTA
  ,UJ,ERROR
  :14,VTM,ИMEHMЛ
  ,UJ,ERROR
  E10:14,VTM,ФAЗAH
  ,UJ,ERROR
  E11:14,VTM,HETMEC
  ,UJ,ERROR
  E12:14,VTM,HETДOC
  ,UJ,ERROR
  E13:14,VTM,HETФAЙЛA
  ,UJ,ERROR
  EE1:14,VTM,ЗAПPЗП
  ,UJ,ERROR
  EE2:14,VTM,ПPEBOБ
  ,UJ,ERROR
  EE3:14,VTM,HEБЫЗAK
  ,UJ,ERROR
  ERROR:14,MTJ,10
  14,J+M,14
  10,J+M,14
  14,UTM,DIAGN-3
  14,XTA,
  9,ATX,ERR
  14,XTA,1
  9,ATX,ERR+1
  14,XTA,2
  9,ATX,ERR+2
  ,ITA,10
  ,AOX,A/I0
  RETMAT:,XTS,PHYS
  ,FUN,72100B+REGSCAL
  :,STI,
  13,UJ,
C
C.....   OПPEД.TИПA ЗAДAЧИ (CЛYЖ. ИЛИ MAT.)
C
  TYPETASK:,BSS,
  ,XTS,
 ,ATX,NSP
  ,*63,AГYC
  ,ATI,14
  14,*63,
 15,ATX,
  ,ASN,64+42
 ,STI,14
 ,ASN,64+15
 ,AAX,=77
 ,AEX,=30
 ,ATX,NOEDIT
  ,XTA,B48
  14,ASN,64-1
  15,ATX,
  ,*63,A/ИПД
  ,ATI,14
  14,*63,Ш/CЛYЖ
  15,AAX,
  ,ATX,SLUG
  ,XTA,FULW
  ,*57,4040B
  ,ASN,64+16
  ,ATX,OWN NUM
  ,FUN,70100B+REGSCAL
  ,ATX,PHYS
  ,AOX,=:4004.PHYS+CЛ.CЛ
  ,XTS,KEY
  ,*76,1
  15,XTA,
  ,FUN,72100B+REGSCAL
  15,XTA,
  10,UJ,
C---
  F4:12,UTM,-SLASH
 11,UTM,5
  ,ITS,11
  ,AOX,A/I0
  9,STX,IWEXCH
  11,UJ,FSW
C..... ПO TИПAM HOCИTEЛEЙ :
  :11,VTM,2.H-TAPE
  11,UJ,FSW.(IWEXCH=-1)
  FSW:12,VZM,FD/.ИMЯ ДИCKA
  ,UJ,FD.ПAKET/MOДYЛЬ
  :,,
  :12,VZM,FT/.ИMЯ ЛEHTЫ
  ,UJ,FT.БOБИHA/MФ
  :,XTA,SLUG
   ,UTC,1-3.LUN
  :10,VTM,3.MБ
 ,UJ,DRLUN
 :10,VTM,5
 ,XTA,A/I0
 9,ATX,NUM
 ,XTA,=I4032.7700B
 9,ATX,VOL
 ,UJ,FVOL
 DRLUN:,BSS,
  12,VZM,E1
  ,U1A,E2
  ,XTA,UNIT
  ,APX,=6H'''''''''7''7'
  ,ASN,64+42
  ,AOX,A/I0
  9,ATX,NUM
  ,ATI,14
  ,XTA,B48
  14,ASN,64-10B
   10,MTJ,14
  :14,UTM,-3
  14,VIM,*+2
  ,XTS,=:7777 74
  ,STX,OWNNUM
 :,AAX,OWN NUM
  ,UZA,E3
C..... ПPOБA ЧИCЛA ЗOH :
  FVOL:,ITA,10
  ,AOX,A/I0
  9,ATX,TYP
  ,FUN,70100B+136B
  ,ATI,12
  12,UTM,-LBR."("
  13,MTJ,11
  12,VIM,OKRET1
  ,XTA,
  ,FUN,12
 12,VTM,1
  14,UTM,-1
  14,VZM,OCTV
  14,UTM,-1
 14,VZM,INTV
 14,UTM,-1
  14,VIM,OKRET1.OШ.ДЛИHA
 ,NTR,7
 ,A+X,A/I0
 ,NTR,6
 ,UTC,-1
 INTV:8,VTM,1
 ,CALL,OCTTDEC
 8,MTJ,12
 8,VTM,B
  ,APX,=6H'7''7''7''7''7''7'
  ,ASN,64+30
  OCTV:15,ATX,.БOЛEE,ЧEM ECTЬ,
  ,AEX,=7777.OБЬEM
  9,XTS,VOL.YKAЗЫBATЬ
  ,AAX,=7777
  :,U1A,*+1
  ,XTA,=7777
  :15,ARX,
  ,ASN,64+12.HE ДAEM
  ,STI,14
  14,VZM,OKRET1
  ,AOX,A/I0
  9,ATX,VOL
  OKRET1:11,MTJ,13
 12,VZM,SPECIS
 ,FUN,70100B+136B
 ,ATI,12
 12,UTM,-SPEC
 12,VZM,SPECIS
 9,WTC,IWEXCH
 11,VTM,1
 11,VIM,NO SPEC.HE EC
 SPECIS:,ITA,13
 ,XTS,SCSPEC
 ,UZA,ERRSP
 13,VTM,NO SPEC
 ,ANX,
 ,ATI,11
 ,YTA,
 11,ASN,64
 ,ATX,SCSPEC
 9,XTA,NUM
 11,ATX,SPN-1
 ,ITA,11
 ,ASN,64-2
 ,ATI,11
 11,UTM,SPP-4
 ,XTA,
 14,VTM,-3
 :11,ATX,3
 14,VLM,*
 ,XTA,=10 0000.ДЛЯ EC:
 11,ATX,2.БYДET REWIND
 12,VIM,RETSP
 ,XTA,SLUG
 ,UZA,*71
 ,XTA,NOEDIT
 ,UZA,RETSP
 15,UTC,1
 14,VTM,
 ,ITA,14
 ,AOX,=10 0000
 ,*50,205B
 ,UJ,RETSP*
 ERRSP:,BSS,
 13,VTM,E11
 ,UJ,RETSP
 *71:,*71,IW71
 RETSP*:14,VTM,-1
 15,XTA,1
 11,ATX,
 15,XTA,2
 11,ATX,1
 L1:14,UTC,1
 11,XTA,
 ,ASN,64+8
 15,ATX,
 ,YTA,
 ,AUX,=6H'''110''300''200''200''300'
 15,ARX,
 14,UTC,1
 11,ATX,
 14,VLM,L1
 RETSP:,BSS,
 13,MTJ,14
 ,STI,
 ,ATI,13
 14,UJ,
 NO SPEC:,BSS,
  ,ITA,10
  ,ASN,64+4
  ,UZA,NO SCR
C
C...   ЗAKAЗ  SCRATCH-ФAЙЛA
C
  10,VTM,1
  ,XTA,=I1
  9,ATX,TYP.LOGICAL
  9,XTA,NUM
  ,ASN,64-36
  ,AOX,=:0000 004
  9,WTC,VOL
  14,VTM,37B
  ,ITS,14
  ,ASN,64+5.ЭKCTEHTЫ
  :,U1A,*+2
  ,XTA,=I32
  9,ATX,VOL
  ,XTA,=1
  :15,AOX,
  ,ATX,MONO
  ,XTA,
  ,ATX,MONO+1
  ,XTA,INFSC
  14,VJM,*57D
  ,ATI,14
  14,U1A,E10-1
  ,XTA,=6HW
  9,ATX,REGIM
  NO SCR:10,UTM,-1
  10,VIM,OKRET
  9,WTC,IWEXCH
 14,VTM,-5
 14,VZM,RETG
 14,UTM,5+1.-1
  14,VIM,SETSTA
  ,XTA,=I4
  9,ATX,TYP
 RETG:,BSS,
  ,XTA,A/I0
  ,UJ,RETMAT
C
C...   YCTAHOBKA CTATYCA 2
C      ДЛЯ YCTPOЙCTB TИПA 1
C
 SETSTA:,BSS,
  9,XTA,NUM
  ,ASN,64-36
  ,AOX,=2
  ,ATX,MONO
  ,XTA,INFST
  14,VTM,OKRET
C
C....  BЫДAЧA ЭKCTPAKOДA ,*57,-1
C      C COXPAHEHИEM 135-137 CЛOB ИПЗ
C
  *57D:,ITS,14
  ,ITS,13
  15,ATX,
  13,VTM,-2
  :13,FUN,70100B+137B
  :15,ATX,
  13,VLM,*-1
  15,XTA,-6
  ,*57,-1
  15,STX,-6
  13,VTM,3
  :13,UTM,-1
  13,FUN,72100B+135B
  15,XTA,
  13,VIM,*-1
  ,STI,13
  ,STI,14
  14,UJ,
C
C....  ПOCЛEДHЯЯ ПPOБA: ДИCK ИЛИ ЛEHTA
C
  OKRET:9,XTA,IWEXCH
  ,ATI,14
  14,VZM,RETMAT.ДИCK
  ,*63,AГYC
  ,ATI,14
  14,*63,
  ,AAX,=:77
  9,XTS,NUM
  ,ASN,64-36
  15,AOX,
  ,ATX,ID
  ,*63,ATAPES
  ,ATI,12
  10,VTM,-31
  STID:10,UTC,31
  12,*63,
  ,AEX,ID
  ,ASN,64+36
  ,ATI,14
  ,XTA,A/I0
  14,VZM,ST/VOL.ЛEHTA
  10,VLM,STID
  9,ATX,IWEXCH.ДИCK
  ,UJ,RETMAT
  ST/VOL:9,WTC,VOL
  14,VTM,
  14,VIM,RETMAT.-ЗAДAHO
  ,XTS,=I4000.
  9,STX,VOL.-CTAHДAPT
  ,UJ,RETMAT
C
C....  ЗAДAH HOMEP TOMA ИЛИ YCTP-BO :
C
  FD:12,UTM,SLASH-COMMA
  ,XTA,UNIT
  ,ASN,64-12
  ,ATX,NAME
  12,VZM,CHFILE
  ,UTC,ADNAM-ATNAM
  FT:,*63,ATNAM
  ,ATI,14
  12,VTM,36.БEЗ ИMEHИ
  ,XTA,SLUG
  ,UZA,E2
  ,XTA,UNIT
  ,AAX,=6H'337''337''337''337''310''310'
  ,U1A,FNV.-TOM
  ,XTA,UNIT
  ,APX,=6H'''''''''7''7'
  ,ASN,64+42
  ,ATI,10
  10,J+M,14
  ,XTA,B48
  10,ASN,64-30B
  ,UZA,FNV
  ,ASN,64-16
  :11,VZM,*+1
  ,ASN,64-16
  :,U1A,FNV
  14,*63,-30B
  ,ATX,NAME
  ,UZA,FNV
  ,AEX,STNAME
  ,UZA,GIVNCTAP
  11,VIM,GIVTAP
C.....  ЗAKAЗ ПAKETA B MOHOПOЛИЮ
  GIVDISM:9,XTA,REGIM
  ,AEX,=6HW
  :,U1A,*+1
  ,UTC,B48
  GIVDIS:,XTA,
  ,ATX,MONO
  ,XTA,INFD
  14,VJM,*57D
  ,ASN,64+45
  ,ATI,14
  14,U1A,E4-1.OTC./ЗAH.
  10,VZM,CHRW
  ,XTA,NAME
  9,ATX,NUM.ИMЯ ДП
  11,VTM,.3-E HAПP.
  ,*63,ADNAM
  ,ATI,10
  12,VTM,-7
  :10,UTC,
  12,*63,7
  :,AEX,NAME
  ,UZA,*+2
  :12,VLM,*-2
  11,VTM,1.4-E HAПP.
  :10,VTM,2
  ,*63,551B
  ,ATI,14.SCDICH
  12,VTM,7620B.29 MБ
  14,UTC,
  11,*63,3
  :,U1A,*+1
  12,VTM,1744B.7 MБ
  :,ITA,12
  ,AOX,A/I0
  9,ATX,VOL
  ,UJ,FVOL.ЗA ДЛИHOЙ
C
C.....   ПOЛHOE ИMЯ :
C
  FT/:,BSS,
  FD/:,XTA,
  ,FUN,12
  14,UTM,-4
  14,VIM,E1
  ,ATX,NAME
  13,MTJ,10
  ,AEX,=6HNO
  ,U1A,TO TEX
  11,VZM,TO TEX.ДИCK
  ,FUN,70100B+136B
  ,ATI,14
  14,UTM,-40B
  14,VIM,TO TEX
  ,XTA,
  ,FUN,12
  14,UTM,-4
  14,VIM,E1
  ,AEX,=6HCHECK
  ,U1A,E1
  ,XTA,=6HNO CHE
  ,ATX,NAME
  TO TEX:,XTA,INFK
  ,CALL,ISOTEX
  10,MTJ,13
  ,ATX,NAME
C.....  TOЛЬKO HOMEP БOБ/ПAK
  FNV:,XTA,UNIT
  ,APX,=6H'''''17''17''17''17'
  ,ASN,64+32
  ,FUN,203B
  ,AEX,NAME
  ,AAX,=7777
  ,AEX,NAME
  ,ATX,UNIT
  ,ATX,NAME
  ,XTA,FULW
  12,ASN,64
  ,ATX,ID
  11,VZM,CHFILE
  ,*63,ATNAM
  ,ATI,12
  10,VTM,-47
  БOБ:12,UTM,1
  12,*63,-17
  ,ATX,NAME
  ,AEX,UNIT
  ,AAX,ID
  ,UZA,CHFILE
  10,VLM,БOБ
  ,UJ,E6.HET MЛ
C......
  CHFILE:10,VTM,1
  ,FUN,70100B+136B
  ,ATI,12
  12,UTM,-COMMA
  12,VZM,CONDEF
  11,VZM,GIVDISM
  ,UJ,GIVTAP
  CONDEF:11,VIM,CHRW
  10,VTM,-1
  GMF:,XTA,
  ,FUN,12
  14,UTM,-4
  14,VIM,E1
  10,ATX,FILE
  10,VLM,GMF
  ,FUN,70100B+136B
  ,ATI,12
  12,UTM,-COMMA
  ,UJ,GIVDIS
C.....
C... ПPOCTO MAT.HOMEP БEЗ R/W
  CHINTN:14,UTM,4-2
  14,VIM,E1
  ,ITA,13
  ,ITS,11
  ,XTS,ID
  ,CALL,OCTTDEC
  ,APX,=6H'7''7''7''7''7''7'
  ,ASN,64+30
  ,AOX,A/I0
  9,STX,NUM
  ,STI,11
  ,ATI,13
  12,VTM,
  ,UJ,NO REG
  CHRW:10,VTM,1
 12,VIM,NO REG
  ,XTA,
  ,FUN,12
  ,ATX,ID
  14,UTM,-4
  14,VIM,CHINTN
  ,APX,=6H'''7''7'''''''
  ,ASN,64+42
  ,UZA,NO LUN
  ,AOX,A/I0
  9,ATX,NUM
  NO LUN:,XTA,ID
  ,AAX,=:776
  ,AOX,=6H''
  9,ATX,REGIM
  NO REG:11,VIM,GIVTAP
  14,VJM,MAKLUN
  9,XTA,REGIM.ПPИ ЗAДAHИИ
  ,AEX,=6HC
  ,U1A,SINGULAR."C" BMECTO "W"
  ,XTA,=6HW
  9,ATX,REGIM.B KAЧECTBE
  ,XTA,=:0000 004.PEЖИMA ЧT/ЗП
  ,ATX,R/W. - ПPOBEPKA HA
  ,FUN,74100B+REGSCAL.ЗAHЯTOCTЬ ФAЙЛA
  SINGULAR:,BSS,.HE ДEЛAETCЯ !
  ,XTA,NAME
  ,ASN,64-36
  :,U1A,*+1
  9,XTA,NUM
  :,ASN,64-36
  ,AOX,R/W
  ,ATX,R/W
C.....  ЗA KOOPДИHATAMИ ФAЙЛA :
  ,XTA,SLUG
  ,U1A,KOOR
  10,VTM,
  ,DRUM,SAVP
  KOOR:,XTA,INFK
  14,VJM,*57D
  :10,VIM,*+1
  ,DRUM,RESP
  :,XTA,R/W
  ,ASN,64+45
  ,U1A,DIAFIL
  ,ATX,FILE
  ,XTA,R/W
  ,AEX,=7777.-1-R
  15,ATX,
  ,ASN,64+12
  15,ARX,.L-1-R
  ,AEX,=7777.R-L
  ,ARX,=1
  ,AAX,=7777
  ,AOX,A/I0
  9,ATX,VOL
  ,XTA,R/W
  ,AAX,=77 7777 7777
  9,XTS,NUM
  ,ASN,64-36
  15,AOX,
  ,ATX,MASTER
  ,XTA,INFF
  14,VJM,*57D
  ,XTA,MASTER
  ,ASN,64+42
  ,UZA,ISTAKED.XOP.
  ,ATI,14
  14,UTM,-1
  14,VZM,E4
  14,UTM,1-2
  14,VZM,E3
  14,UTM,2-4
  14,VZM,E10
  ,UJ,E11
  DIAFIL:,ATI,14
  14,UTM,-1
  14,VZM,E12
  14,UTM,1-2
  14,VZM,E13
 ,UJ,E3
C.....   ПOЛYЧEHИE MAT.HOMEPA :
  MAKLUN:9,XTA,NUM
  ,UZA,AUTONUM
  ,AEX,A/I0
  ,U1A,REDYNUM
  AUTONUM:,BSS,
  ,XTA,OWNNUM
  ,AEX,FULW
  ,ASN,64-16
  ,UZA,E11
  ,ANX,=I23
  9,ATX,NUM
  REDYNUM:,ASN,64+4
  ,ASN,64-10
  ,U1A,LUN
  9,XTA,NUM
  ,AOX,=40
  9,ATX,NUM
  LUN:,XTA,B48
  9,WTC,NUM
  ,ASN,64-30B
  ,UZA,E3
  ,ASN,64+16
  ,UZA,E3
  ,AAX,OWN NUM
  ,U1A,E3
  ,ATX,R/W
 9,XTA,REGIM
  ,AEX,=6HR
  14,UZA,
  9,XTA,REGIM
  ,AEX,=6HW
  14,U1A,
  ,XTA,=:0000 004
  ,ATX,R/W
  14,UJ,
C.....   ЗAKAЗ ЛEHTЫ :
  GIVNCTAP:,ITA,10
  ,ASN,64-3
  ,AOX,=7777 7777 7777 7000
  ,ATX,NAME
  GIVTAP:13,MTJ,10
  14,VJM,MAKLUN
  11,MTJ,14
  14,UTM,4
  14,VZM,FVOL.SCRATCH
  9,WTC,NUM
  13,VTM,
  14,UTM,-6
  14,VIM,LOWDENS
  13,UTM,40000B.HD
  9,WTC,IWEXCH
  14,VTM,1
  14,VIM,LOWDENS
C...   ЛEHTA B PEЖИME EC ДOЛЖHA
C      ИMETЬ "ИMЯ" = NO CHECK
  ,XTA,NAME
  ,AEX,=5657 0043 5045 0000
  ,ASN,64+12
  ,U1A,E9+1
  LOWDENS:9,XTA,REGIM
  ,AEX,=6HR
  12,VTM,200B
  ,UZA,*57
  9,XTA,REGIM
  ,AEX,=6HW
  12,VTM,100B
  ,UZA,*57
  12,VTM,
  *57:,XTA,NAME
  12,*57,2400B
  10,MTJ,13
  ,AEX,
  ,UZA,E6
  12,VZM,NORW
  12,UTM,-100B
  ,ARX,
  12,VZM,CHWRIT
  ,U1A,E71
  NORW:,BSS,
  ,AOX,B48
  CHWRIT:,BSS,
  ,UZA,E7
  12,VTM,-2
  :,ASN,64-1
  ,ARX,
  12,UZA,E8+2
  12,VLM,*-1
  ,ARX,=100
  ,AAX,=400
  :,UZA,*+1.MOДEЛЬ
 14,VTM,7677B.ЛEHTA
  :14,UTM,1
  ,ITA,14
  ,AOX,A/I0
  9,ATX,VOL
  ISTAKED:,BSS,
  10,VTM,1
  ,UJ,FVOL
C
C......   BXOД ДЛЯ OБMEHOB :
C
  JFEX1:,ENTRY,
  ,UTC,150B+1
  JF EXCH :,ENTRY,
  :11,VTM,
  8,BASE,B
  10,VJM,TYPETASK
 :11,VZM,*+2
  ,STI,14
  ,STI,12
  ,STI,10
 :,ATI,9
  9,XTA,IWEXCH
  ,AAX,=0010 3700 0000 7777
  11,VZM,READYIW
  :,UZA,*+1.ДИCK
  11,UTM,4-1.ЛEHTA
  :,ITA,10
  ,ASN,64-20
  12,XTS,
  ,AAX,=7777
  15,AOX,
  14,XTS,
  ,AEX,=6HW
  ,ASN,64+40
  :,UZA,*+1
  ,XTA,=:001
  :15,AOX,
  READYIW:,ATX,UNIT
  ,AAX,=:001
  ,U1A,R*UN
  9,XTA,REGIM
  ,AEX,=6HW
  ,U1A,EE1
  R*UN:9,XTA,VOL
  ,AAX,=7777
  ,UZA,NOCHEKV
  ,ARX,=4
  ,XTS,UNIT
  ,ARX,=4
  ,AAX,=7777
  ,NTR,3
  15,A-X,
  ,UZA,EE2
  NOCHEKV:,NTR,6
  ,*63,ADNAM
  ,ATX,ID
 ,ITA,11
 ,ATX,IFF
 10,VJM,GIVSP
  14,VTM,HEБЫЗAK
  9,WTC,TYP
  ,UJ,ESW
C...
  S/DIS:,WTC,ID
  10,*63,15
  9,AEX,NUM
  ,UZA,ISDIS
  10,VLM,S/DIS
  ,UJ,E4
  ISDIS:10,UTM,15+30B
  14,VTM,=:0404 0022
  ,XTA,UNIT
  ,ASN,64+36
  :,U1A,*+1
 14,VJM,IFSPEC
  14,VTM,=:0404 0020
  :,ITA,10
  ,ASN,64-12
  14,AOX,
  ,ARX,UNIT
  ,ATX,UNIT
  12,VTM,10
C...   ЦИKЛ ПOПЫTOK ЧTEHИЯ :
  LEX:,BSS,
   10,VTM,
  ,*70,UNIT
  ,AEX,
  ,U1A,OKEX
  12,UTM,-1
  12,VIM,LEX
 BADEX:,BSS,
 ,XTA,=6H
 BADMV*:,ATX,TBEX+2
 14,VJM,IFSPEC
 14,VTM,ПЛOXOБ
  ,XTA,UNIT
  ,ASN,64-30
  ,AUX,=6H'7''7''7''7''7''7'
  ,AOX,=6H000000
  ,ATX,TBEX+1
  ,XTA,UNIT
  ,AAX,=:001
  :,UZA,*+1
  ,XTA,=6H'''''''4''44'''.OШ.ЧT
 :,AEX,=6HOШ.ЗП
  ,ATX,TBEX
C......
   ESW:,UJ,ERROR
     :10,VTM,.MAT.OБMEH
  ,UJ,EXCH
  :10,VTM,-15.ФИЗ.ДИCK
  ,UJ,S/DIS
  :,UJ,E/DRU
 :,UJ,E/EC
 :,UJ,RETG
C...   OБMEH C MЛ B PEЖИME EC
 E/EC:,BSS,
 ,ATI,11
 11,UTM,SPP-4
 ,UZA,EE3
 ,XTA,PHYS
 ,AOX,=:4
 ,*50,72100B+REGSCAL
 ,XTA,UNIT
 ,AAX,=7777
 ,UZA,CHPG
 ,XTA,UNIT
 ,ARX,=1
 ,ATX,UNIT
 CHPG:,XTA,UNIT
 ,ASN,64+20
 ,ATI,14
 14,XTA,.*****
 ,XTA,UNIT
 ,AAX,=:001
 ,U1A,IFMV*
 14,VJM,IFSPEC
 IFMV*:12,VTM,-7.CЧ. OШИБOK
 IFMV:,XTA,UNIT
 ,AAX,=7777
 ,NTR,7
 11,A-X,2.TEK. NREC
 ,U1A,HAЗAД
 10,VTM,1.BПEPEД
 MOVE:,AEX,
 ,UZA,EXCHES
 11,ATX,2.
 MOV*:9,XTA,NUM
 ,ASN,64-12
 10,AOX,IWES
 ,*57,7777B
 ,AEX,=200
 ,AAX,=10 0234
 ,U1A,BADMOV
 11,XTA,2
 10,VZM,MIN
 ,A-X,=1
 ,UJ,MOVE
 MIN:,A+X,=1
 ,UJ,MOVE
 HAЗAД:,BSS,
C  ПPOBEPKA - A HE ЛYЧШE-ЛИ ПPEДBAPИTEЛЬHO
C  CMOTATЬ ЛEHTY HA HAЧAЛO
 10,VTM,
 11,ATX,2.K-BO ШЗH (-)
  ,A+X,=1
  ,UZA,MOV*.1 ЗOHA ==> ШЗH
 ,XTA,UNIT
 ,AAX,=7777
 15,ATX,
 ,ASN,64+2
 15,ARX,
 11,A+X,2
 ,UZA,MOV*.ЧEPEЗ ШЗH
C  BЫГOДHEE CMOTATЬ, A ПOTOM BПEPEД.
 REWIND:9,XTA,NUM
 ,ASN,64-12
 ,AOX,=:4007
 15,ATX,
 ,*57,7777B
 15,XTA,
 ,*57,7777B
 ,XTA,
 11,ATX,2
 ,UJ,IFMV
 EXCHES:,NTR,6
 ,XTA,UNIT
  ,ASN,64+12
  9,AOX,NUM
  ,ASN,64-12
  15,ATX,
  ,AAX,=:001
  ,U1A,R/EC
 12,V1M,W/EC
 ,XTA,=:4012 0000 4.CTИP
 15,AEX,-1
 ,*57,7777B
 W/EC:,BSS,
 ,XTA,=4002 0000 4100 0000
  RW/EC:15,AEX,
  ,*57,7777B
 ,AEX,=200.ГT
 ,AAX,=17 0237
 ,XTS,UNIT
 ,AAX,=7777
 ,ARX,=1
 11,STX,2
 ,UZA,RETGOOD
 ,AAX,=10 0200
 ,UZA,BADEXCH
 ,AAX,=200
 ,U1A,HET ГT
 ,XTA,=6H K Д B
 ,UJ,BADM
 BADEXCH:12,VLM,IFMV
 ,UJ,BADEX
 BADMOV:,AAX,=200
 ,U1A,HET ГT
 ,XTA,=6HПOДB.''
 BADM:,XTS,=10 0000.БYДET
 11,STX,2.REWIND
 ,UJ,BADMV*
 HET ГT:,BSS,
 9,XTA,NUM
 ,ASN,64-12
 ,*57,7777B
 ,AAX,=200
 ,U1A,REWIND
 ,*57,3
 ,UJ,HET ГT
 R/EC:,XTA,=4011 0000 4100 0000
  ,UJ,RW/EC
C---
  E/DRU:,BSS,
  :,XTA,UNIT
  ,AOX,=:0004.ФИЗ.MБ
  ,ATX,UNIT
  ,AAX,=7777
  ,ASN,64-7
   ,ARX,UNIT
  ,ATX,UNIT.ПEPEAДPECAЦИЯ
  ,AAX,=:001
  :,U1A,*+1
  ,XTA,SLUG
  :,UZA,EE1
  ,*63,CHEKMDFL
  ,ATI,10
  ,XTA,=:0004
  10,*52,
 EXCH:9,XTA,NUM
  ,ASN,64-12
  ,ARX,UNIT
  ,ATX,UNIT
 ,AAX,=:001
 ,U1A,EXCH*
 14,VJM,IFSPEC
 EXCH*:,BSS,
  ,*70,UNIT
   OKEX: ,XTA,UNIT
  ,ASN,64+20
  ,ATI,12
  12,XTA,.ЖДEM K/O
   ,XTA,
  :10,VZM,*+1
  10,*52,.CHEKMDFL
 :,XTA,IFF
 ,ATI,11
 11,VZM,CHEKP
  11,FUN,70100B
  9,ATX,ERR+2
  ,AEX,= 7163 4760 3471 6347
  ,U1A,CHEKP
  9,ATX,ERR+2
   CHEKP:,ITA,12
  ,FUN,200B
  ,AEX,=2
  ,UZA,BADEX
 RETGOOD:,BSS,
 14,VJM,IFSPEC
  ,XTA,A/I0
  ,UJ,RETMAT
 GIVSP:,BSS,.П/П
 12,VTM,1-LSPN
 9,XTA,NUM
 9,ATX,NUM
 LCSP:12,XTA,SPN+LSPN-1
 9,AEX,NUM
 ,UZA,OUR
 12,VLM,LCSP
 10,UJ,
 OUR:12,UTM,LSPN
 ,ITA,12
 ,ASN,64-2
 ,ATX,NSP
 10,UJ,
 IFSPEC:,BSS,
 ,XTA,NSP
 14,UZA,
 ,ATI,11
 11,UTM,SPP-4
 11,XTA,
 14,UZA,
 ,ITA,14
 ,ITS,1
 ,ITS,2
 ,ITS,3
 ,ITS,13
 ,ITS,
 ,XTA,UNIT
 ,ASN,64+30
 ,ASN,64-10
 ,ATI,3
 1,VTM,-1
 L1P:,BSS,
 2,VTM,-1023
 ,XTA,UNIT
 ,AAX,=7777
 1,UTC,1
 11,ARX,
 15,ATX,3
 15,UTC,3
 13,VTM,
 ,ITS,13
 ,CALL,BRAND
 3,MTJ,12
 L2P:,BSS,
 ,ITA,12
 ,CALL,MIXER
 12,ATX,
 12,UTM,1
 2,VLM,L2P
 ,WTC,NSP
 11,VTM,SPP-4
 1,VLM,L1P
 ,STI,
 ,STI,13
 ,STI,3
 ,STI,2
 ,ATI,1
 15,WTC,
 ,UJ,
C
C===========  PAЗHЫE TEKCTЫ  ===========
C
  :,ISO,6HETAPE
  TTF   :,ISO,30HDISK  TAPE  HTAPE LUN   DRUM
 ,CONT,6HPIT
  DIAGN :,ISO,18HCИHTAKCИЧ.OШИБKA ''
        :,ISO,18HЭTO BAM ЗAПPEЩEHO''
        :,ISO,18HOШ.HOMEP YCTP-BA ''
        :,ISO,18HHET ПAKETA       ''
        :,ISO,18HЗAHЯT ПAKET      ''
        :,ISO,18HHET ЛEHTЫ        ''
  :,ISO,18HBЫKЛЮЧИ ЗAПИCЬ   ''
        :,ISO,18HBKЛЮЧИ ЗAПИCЬ    ''
        :,ISO,18HHEГOTOB MФ.      ''
        :,ISO,18HЗAHЯTA ЛEHTA     ''
        :,ISO,18HФAЙЛ ЗAHЯT       ''
        :,ISO,18HHET MECTA B ФATE ''
        :,ISO,18HHE ИMEETE ПPABA  ''
        :,ISO,18HHET TAKOГO ФAЙЛA ''
  :,ISO,18HЗAПИCЬ ЗAПPEЩEHA ''
  :,ISO,18HПPEBЫШEH OБЬEM   ''
  :,ISO,18HHE БЫЛO ЗAKAЗA   ''
  :,ISO,18HИMEHOBAHHAЯ ЛEHTA''
  TBEX:,BSS,3
C
C==========  ДЛЯ ЗAKAЗA ДИCKOB  =========
C
  INFD:13,Z07,7240B
  8,Z00,MONO
  INFK:13,Z07,7277B.37 ЛИCT
  8,Z02,NAME
  INFF:13,Z07,7240B
  8,Z03,NAME
  INFSC:13,Z07,7240B
  8,Z04,MONO
  INFST:13,Z07,7240B
  8,Z37,MONO
  MONO  :,LOG,
  NAME  :,LOG,
  MASTER:,LOG,
  FILE  :,LOG,
  R/W   :,LOG,
  :,OCT,4
  B48:,OCT,4
 IWES:,OCT,4004 0000 4.BПЛ+ШЗH
 ,OCT,4003 0000 4.BПЛ+ШЗB
 IW71:15,060,1
 ,,
C
C==========  KOHCTAHTЫ  ==========
C
  FULW   : ,LOG, 7777 7777 7777 7777
  STNAME : ,LOG, 2245 1252 5122 4512
  KEY    :,LOG,3053 4576 1634 0112
C     ШKAЛA БYФEPOB ДOП. ИHФOPMAЦИИ
 SCSPEC:,OCT,77.6 (CM. LSPN)
C
C=========  PAБ.ЯЧEЙKИ  ==========
C
  ID      :,BSS,1
  UNIT    :,BSS,1
  SLUG    :,BSS,1
  OWNNUM  :,BSS,1
  PHYS:,BSS,1
 NOEDIT:,BSS,1
 IFF:,BSS,1
 NSP:,BSS,1
 SPN:,BSS,6. CM. SCSPEC
 SPP:,BSS,24.6*4 (CM. SPN)
  ,END,
  J OPER :,NAME,
C*
C*********** 06.05.81. A.П.CAПOЖHИKOB.
C*
C*   FUNCTION JOPER ( MISO, L, KOD )
C*
C*   OБMEH COOБЩEHИЯMИ C OПEPATOPCKИM
C*   TEPMИHAЛOM (BЫДAЧA, ЗATEM ПPИEM).
C*
C*   MISO - MACCИB, COДEPЖAЩИЙ TEKCT
C*      BЫДABAEMOГO COOБЩEHИЯ B KOДE ISO.
C*   L - ДЛИHA MISO B CЛOBAX (HE БOЛEE 6)
C*       ПPИ  L = 0  COOБЩEHИE HE BЫДAETCЯ
C*   KOD -  PEAKЦИЯ HA OTBET OПEPATOPA:
C*   KOD=0 : OTBET BOOБЩE HE HYЖEH
C*           BЫXOД C JOPER=0.
C*   KOD=-1 : TOЛЬKO OПPOC HAЛИЧИЯ COOБЩEHИЯ
C*           BЫXOД C JOPER=0, ECЛИ HE БЫЛO
C*           OTBETA, ИHAЧE JOPER COДEPЖИT
C*           OTBET OПEPATOPA (HE БOЛEE 6
C*           CИMBOЛOB ISO, HOPMAЛИЗOB.BЛEBO)
C*   KOD=1 : OБЯЗATEЛЬHOE OЖИДAHИE OTBETA
C*           HA BЫXOДE JOPER=<OTBET>
C*   KOD=<TEKCT. KOHCTAHTA HE БOЛEE 6 CИMB>
C*           CPABHEHИE OTBETA  C KOD.
C*           ПPИ HECOBПAДEHИИ - BЫДAETCЯ
C*           ПOДCKAЗKA И BHOBЬ ЖДEM OTBETA.
C*           COBПAЛO - BЫXOД C JOPER=KOD.
C*
C*******************************************
C*
C*    П P И M E P Ы :
C*  J = JOPER('ПPИBET',1,0) - TOЛЬKO BЫДAЧA
C*  J = JOPER(0,0,-1)       - TOЛЬKO OПPOC
C*  J = JOPER(0,0,1) - OЖИДAHИE ДИPEKTИBЫ
C*  J = JOPER('CMEHИ ПEPO',2,'ГOTOBO') -
C*      - ДOЖИДAEMCЯ KOHKPETHOГO OTBETA.
C*
C*   ПPOГPAMMA ПOPTИT 8-14 PEГИCTPЫ
C*   BЫXOД ПO 13 PEГ.  PEЖ.AY HE MEHЯETCЯ
C*   YCTAHABЛИBAETCЯ ЛOГИЧECKAЯ ГPYППA
C*   ИCПOЛЬЗYETCЯ П/П  TEXISO .
C*
C*******************************************
C*
  A/I0:,LC,1
C
  B:12,BASE,B
  13,MTJ,8
  ,STI,14
  ,STI,10
  ,ATI,9
  10,XTA,
  ,ATI,10.ДЛИHA M
  ,AAX,=1377 7777 7777 7770
  :,UZA,*+1
  10,VTM,
  :,ITA,10
  ,ATX,LEN
  14,XTA,
  13,VTM,KR
  NORM:15,ATX,2
  ,AEX,=6H
  ,UZA,NR
  ,ASN,64+40
  ,U1A,NR
  15,XTA,2
  ,ASN,64-8
  ,AOX,=40
  ,UJ,NORM
  NR:15,XTA,2
  13,UJ,
  KR:,ATX,KOD
  ,ITA,15
  ,ATX,STAC
  ,XTA,A/I0
  ,ATX,REZ
  ,*63,502B
  ,ATI,14
  14,*63,
  ,ASN,64+15
  ,AAX,=77
  15,ATX,
  ,ASN,64-42
  ,AUX,=6H'''''7''7'''''
  ,AOX,=6H Ш00('100'
  15,AOX,
  ,XTS,=6H): '1''1''1'
  TRAN:10,VZM,ETRAN
  10,UTM,-1
  9,XTS,
  9,VLM,TRAN
  ETRAN:15,MTJ,9
  ,XTS,
  ,XTS,=6HOTBET=
  ,XTS,KOD
 :,XTS,LEN
  ,UZA,*+2
  TELE:,XTS,STAC
  ,FUN,76B
  :,XTA,=6H'1''1''1'
  9,ATX,1
  ,XTA,KOD
  ,AEX,A/I0
  ,UZA,RET
  ,AEX,=1
  ,UZA,WAIT
  ,ARX,
  WAIT:,U1A,*+1
  ,UTC,=1
  :,XTA,
  ,FUN,66B
  ,UZA,RET
  ,ATX,ISO+2
  14,VTM,ISO+2
  ,ITS,14
  14,VTM,ISO
  ,ITS,14
  ,CALL,TEXISO
  12,BASE,B
  ,XTA,ISO
  13,VJM,NORM
  ,ATX,REZ
  ,XTA,KOD
  ,ARX,
  ,UZA,RET
  ,AEX,REZ
  ,U1A,TELE
  RET:,WTC,STAC
  15,VTM,
  ,XTA,REZ
  8,UJ,
  STAC:,BSS,1
  LEN :,BSS,1
  KOD :,BSS,1
  REZ :,BSS,1
  ISO :,BSS,4
  ,END,
  JSEART:,NAME,
C*
C***********  15.06.80  A.П.CAПOЖHИKOB
C*
C*   FUNCTION JSEART(TAB,STEP,KST,ET)
C*   ПOИCK ЭTAЛOHA ET B TAБЛИЦE TAB
C*   C ШAГOM STEP. ДEЛAETCЯ HE БOЛEE
C*   KST ШAГOB. CPABHИBAЮTCЯ TOЛЬKO
C*   ПOЗИЦИИ CИMBOЛOB, OTЛИЧHЫX OT
C*   ПPOБEЛOB B ET.
C*   BCE ПEPEMEHHЫE - ЦEЛOГO TИПA.
C*   STEP = 1,2,3,...
C*   KST  = 1,2,3,...
C*   ET - ЛИTEPHAЯ ПEPEMEHHAЯ, 6 CИM.ISO
C*   PEЗYЛЬTAT: HOMEP ШAГA, ГДE COBПA-
C*   ДEHИE, ИHAЧE 0.
C*   ПOPTЯTCЯ PEГИCTPЫ: 8-14
C*   BЫXOД ПO И.P.13 C  ,NTR,2
C*
C*   FUNCTION JCOUNS(ET)
C*   BЫДAЧA KOЛИЧECTBA OTЛИЧHЫX OT
C*   ПPOБEЛA CИMBOЛOB B ET.
C*   ПOPTЯTCЯ PEГИCTPЫ:8,12,14
C*
C***************************************
C*
  A/I0:,LC,1
  ,UTC,-6
  JCOUNS:,ENTRY,
  14,VTM,
  8,BASE,*
  ,ATI,12
  12,XTA,
  ,AEX,=6H
 ,ARX,=6H'177''177''177''177''177''177'
 ,AAX,=6H'200''200''200''200''200''200'
  14,VIM,ST
  ,ACX,A/I0
  13,UJ,
  ST:15,ATX,
  ,ASN,64+1
  15,AOX,
  14,VLM,ST
  ,STX,MASK
  ,STI,11
  ,STI,10
  ,ATI,9
  10,WTC,
  10,VTM,
  ,NTR,3
  11,XTA,
  ,X-A,A/I0
  ,UZA,RET
  ,ATI,11
  11,UTM,1
  S:9,XTA,
  12,AEX,
  ,AAX,MASK
  14,UTM,1
  ,UZA,RET
  10,J+M,9
  11,VLM,S
  14,VTM,
 RET:,ITA,14
  ,AOX,A/I0
  ,NTR,2
  13,UJ,
  MASK:,BSS,1
  ,END,
 KEY:,NAME,
C
C**************** E.Д.ФEДЮHЬKИH 10/01/79
C*
C*   FUNCTION   KEY(N)
C*
C*   ФYHKЦИЯ PABHA 1, ECЛИ ПYЛЬTOBЫЙ
C*   KЛЮЧ N = 1, ФYHKЦИЯ PABHA HYЛЮ B
C*   ПPOTИBHOM CЛYЧAE. ПOCЛE OБPAЩEHИЯ
C*   K ФYHKЦИИ ПYЛЬTOBЫЙ KЛЮЧ N ABTO-
C*   MATИЧECKИ ЗAHYЛЯETCЯ.
C*   ПOPЯДOK ЗHAЧEHИЯ ФYHKЦИИ COBПA-
C*   ДAET C ПOPЯДKOM ЧИCЛA N.
C*
C*   ECЛИ N=0, TO ЗHAЧEHИEM ФYHKЦИИ
C*   ЯBЛЯETCЯ KOПИЯ ПYЛЬTOBOГO CЛOBA
C*   ЗAДAЧИ; B ЭTOM CЛYЧAE ПOCЛE OБPA-
C*   ЩEHИЯ K ФYHKЦИИ ABTOMATИЧECKИ ЗA-
C*   HYЛЯЮTCЯ BCE 48 KЛЮЧEЙ.
C*
C*   OБPAЩEHИE CTAHДAPTHOE. COXPAHЯET-
C*   CЯ PEЖИM И BCE PEГИCTPЫ, HE ИC-
C*   ПOЛЬЗYETCЯ MAГAЗИH. BOЗBPAT - ПO
C*   13 PEГИCTPY.
C*
C*   FUNCTION   KEYGET(N)
C*
C*   AHAЛOГИЧHA KEY(N), HO KЛЮЧИ HE
C*   ЗAHYЛЯЮTCЯ.
C*
C*   FUNCTION   KEYPUT(N)
C*
C*   AHAЛOГИЧHA KEY(0), HO CЛOBO N KO-
C*   ПИPYETCЯ B ПYЛЬTOBOE CЛOBO ЗAДAЧИ.
C*
C
 C:,P/P,(W)2000B
 C1:,P*P,(C)2000B
 C2:,EQU,W-C1
 C3:,P/P,(C2)2
 ,UTC,WR
 ,ATX,8
 ,RTE,77B
 ,UTC,WR
 ,ATX,9
 ,ITA,12
 12,VTM,WR
 12,ATX,10
 ,ITA,14
 12,ATX,11
 ,ITA,11
 12,ATX,12
 ,NTR,7
 12,WTC,8
 ,XTA,
 12,AVX,5
 ,ATI,11
 12,AAX,7
 12,ATX,8
 ,*61,
 :12,ATX,13
 11,VZM,*+2
 12,XTA,6
 11,ASN,65
 :12,AAX,13
 ,U1A,SSW
 RET:12,WTC,12
 11,VTM,
 12,WTC,11
 14,VTM,
 12,AEX,8
 12,XTR,9
 12,WTC,10
 12,VTM,
 13,UJ,
 SSW:11,V1M,*+2
 12,AEX,6
 12,ATX,8
 12,AEX,6
 :12,AEX,13
 12,ATX,13
 12,XTA,
 14,VTM,-4
 :12,UTC,5
 14,ARX,
 14,VLM,*-1
 ,*76,1
 :14,VTM,C3
 12,XTA,13
 14,V1M,*+1
 ,UTC,WR1-WR
 :12,*76,
 :,*76,
 :12,XTA,6
 ,UJ,RET
 KEYGET:,ENTRY,
 ,UTC,WR
 ,ATX,8
 ,RTE,77B
 ,UTC,WR
 ,ATX,9
 ,ITA,12
 12,VTM,WR
 12,ATX,10
 ,ITA,14
 12,ATX,11
 ,ITA,11
 12,ATX,12
 12,WTC,8
 ,XTA,
 ,ATI,11
 12,AAX,7
 11,V1M,*+1
 ,XTA,
 :12,ATX,8
 ,*61,
 :11,VZM,RET
 11,ASN,63
 12,AAX,6
 ,UJ,RET
 KEYPUT:,ENTRY,
 ,UTC,WR
 ,ATX,13
 ,RTE,77B
 ,UTC,WR
 ,ATX,9
 ,ITA,12
 12,VTM,WR
 12,ATX,10
 ,ITA,14
 12,ATX,11
 12,WTC,13
 ,XTA,
 12,ATX,13
 ,*61,
 :12,AEX,6
 12,ATX,8
  ,XTA,
 ,UJ,SSW+2
 WR:,WTC,502B
 ,WTC,
 ,ATX,113B
 ,UTC,
 W:,MTJ,27B
 2,IJ,
 WR1:,WTC,502B
 ,WTC,
 ,ATX,113B
 14,UJ,-1
 ,OCT,2327311401040113
 ,LOG,1
 ,OCT,774
 ,BSS,6
 ,END,
  LDEFIN:,NAME,
C*******************************************
C*                                         *
C*   ПOДПPOГPAMMЫ ДЛЯ PAБOTЫ CO CПИCKAMИ   *
C*                                         *
C*                    ЧEPEHKOB C.          *
C*                                         *
C*      ДYБHA    ФEBPAЛЬ 1982              *
C*******************************************
C*                                         *
C*  CПИCKOM БYДEM HAЗЫBATЬ MHOЖECTBO ЭЛE-  *
C*  MEHTOB, CTOЯЩИX B HEKOTOPOЙ ПOCЛEДOBA- *
C*  TEЛЬHOCTИ(ИЗMEHЯEMOЙ), OБ'EДИHEHHЫX    *
C*  ИMEHEM  NAME. ЭЛEMEHTЫ CПИCKA COCTOЯT  *
C*  ИЗ  K  CЛOB И MOГYT HECTИ ЛЮБYЮ ИHФOP- *
C*  ЦИЮ B K-1 CЛOBAX, OДHO CЛOBO OTBOДИTCЯ *
C*  ПOД CCЫЛKИ.                            *
C*                                         *
C*    SUBROUTINE LDEFIN(N,K,YKAZ,FIRST)    *
C*   N- PAЗMEP ПOЛЯ B CЛOBAX               *
C*   K- PAЗMEP KBAHTA B CЛOBAX             *
C*   YKAZ- YKAЗATEЛЬ ФAЙЛA ИЛИ AДPEC HAЧA- *
C*         ЛA MACCИBA                      *
C*   FIRST- 0-ПPИЗHAK "BCE B ПAMЯTИ", ИHAЧE*
C*          "BCE B ФAЙЛE", ПPИ ЭTOM ECЛИ   *
C*          FIRST<0, TO HAДO ЧИCTИTЬ ФAЙЛ, *
C*          ECЛИ FIRST>0, TO HE HAДO.      *
C*  ПOДПPOГPAMMA OTBOДИT ПOЛE ДЛЯ CПИCKOB  *
C*  B ПAMЯTИ ИЛИ B ЗAKAЗAHHOM ФAЙЛE. ПOЛE  *
C*  ИЗ N CЛOB PAЗБИBAETCЯ HA ЭЛEMEHTЫ(KBAH-*
C*  TЫ) ИЗ CЛOB, MEЖДY KOTOPЫMИ CYЩECTBYЮT *
C*  CCЫЛKИ. ПOCЛE ИHИЦИAЛИЗAЦИИ ПEPBOE CЛO-*
C*  BO ПOЛЯ COДEPЖИT YKAЗATEЛЬ CПИCKA ИMEH *
C*  CПИCKOB(CИC) ИЛИ KATOЛOГ CПИCKOB, BTO- *
C*  POE CЛOBO COДEPЖИT YKAЗATEЛЬ CBOБOДHOЙ *
C*  ПAMЯTИ(CП), CЛOBA C 3 ПO K+3 COДEPЖAT  *
C*  ПEPBЫЙ KBAHT "CИC", KOTOPЫЙ B CBOЮ OЧE-*
C*  PEДЬ COДEPЖИT ИMEHA CПИCKOB И AДPECA   *
C*  ЭTИX CПИCKOB И T.Д.                    *
C*                                         *
C*         FUNCTION LCREAT(NAME)           *
C*  COЗДAET CПИCOK C ИMEHEM NAME. ИMЯ CПИC-*
C*  KA ЗAHOCИTCЯ B "CИC", ПOД  CПИCOK  ДЛЯ *
C*  HAЧAЛA OTBOДИTCЯ OДИT KBAHT ИЗ "CП", B *
C*  ДAЛЬHEЙШEM CПИCOK MOЖET PACШИPЯTCЯ ПPИ *
C*  ПOMOЩИ ДPYГИX ПOДПPOГPAMM. HA BЫXOДE   *
C*  CYMMATOP PABEH AДPECY KBAHTA ИЛИ 0, EC-*
C*  ЛИ OTCYTCTBYET "CП" ДЛЯ ЗABEДEHИЯ HOBO-*
C*  ГO CПИCKA ИЛИ CПИCOK C TAKИM ИMEHEM YЖE*
C*  CYЩECTBYET. ИMЯ CПИCKA: 6 CИMBOЛOB ISO.*
C*                                         *
C*         FUNCTION LREWIN(NAME)           *
C*  AKTИBИЗИPYET CПИCOK. HA CYMMATOPE-AДPEC*
C*  HAЧAЛA CПИCKA ИЛИ 0B, ECЛИ TAKOЙ CПИCOK*
C*  OTCYTCTBYET.                           *
C*                                         *
C*         FUNCTION LDEATH(NAME)           *
C*  YHИЧTOЖAET CПИCOK C ИMEHEM NAME. CYMMA-*
C*  TOP PABEH 1, ECЛИ CПИCOK YHИЧTOЖEH, И  *
C*  0, ECЛИ TAKOГO CПИCKA HET.             *
C*                                         *
C*         FUNCTION LCONC(NAME1,NAME2)     *
C*  ПPOИЗBOДИT KOHKOTEHAЦИЮ(OБ'EДИHEHИE')  *
C*  CПИCKOB  C ИMEHAMИ NAME1 И NAME2. ПOЛY-*
C*  ЧAEM CПИCOK C ИMEHEM NAME1. HA CYMMATO-*
C*  PE 1, ECЛИ KOHKOTEHAЦИЯ ПPOИЗBEДEHA, И *
C*  0, ECЛИ XOTЯ БЫ OДOГO ИЗ CПИCKOB HET.  *
C*                                         *
C*         FUNCTION LAFTER(NUM)            *
C*         FUNCTION LBEFOR(NUM)            *
C*  OБHOBЛЯЮT HOMEP NUM TEKYЩEГO ЭЛEMEHTA  *
C*  CПИCKA. LBEFOR ДAET HOMEP ПPEДЫДYЩEГO  *
C*  ЭЛEMEHTA, A LAFTER- HOMEP CЛEДYЮЩEГO.  *
C*  HA CYMMATOPE HOMEP HOBOГO TEKYЩEГO ЭЛE-*
C*  MEHTA, ИЛИ -1, ECЛИ TEKYЩИЙ ЭЛEMEHT B  *
C*  HAЧAЛE CПИCKA, A MЫ ПЫTAEMCЯ ПOЛYЧИTЬ  *
C*  HOMEP ПPEДЫДYЩEГO, ИЛИ 1, ECЛИ TEKYЩИЙ *
C*  ЭЛEMEHT B KOHЦE CПИCKA, A MЫ ПЫTAEMCЯ  *
C*  ПOЛYЧИTЬ HOMEP CЛEДYЮЩEГO.             *
C*                                         *
C*         FUNCTION LINCA(NUM)             *
C*         FUNCTION LINCB(NUM)             *
C*  BCTABЛЯЮT ЭЛEMEHT ПOCЛE(LINCA) ИЛИ ДO  *
C*  (LINCB) TEKYЩEГO ЭЛEMEHTA C HOMEPOM NUM*
C*  HA CYMMATOPE HOMEP HOBOГO TEKYЩEГO ЭЛE-*
C*  MEHTA.                                 *
C*                                         *
C*         FUNCTION LDEALA(NUM)            *
C*         FUNCTION LDEALB(NUM)            *
C*  ИЗЫMAЮT TEKYЩИЙ ЭЛEMEHT. TEKYЩИM CTAHO-*
C*  BИTCЯ CЛEДYЮЩИЙ(LDEALA) ИЛИ ПPEДЫДYЩИЙ *
C*  (LDELB) ЭЛEMEHT. HA CYMMATOPE HOMEP HO-*
C*  BOГO TEKYЩEГO ЭЛEMEHTA, ИЛИ 0, ECЛИ ПPИ*
C*  OБPAЩEHИИ K LDELA BЫШЛИ HA ПOCЛEДHИЙ, A*
C*  ПPИ OБPAЩEHИИ K LDELB - HA ПEPBЫЙ ЭЛ-T.*
C*                                         *
C*         SUBROUTINE LREAD(NUM,M)         *
C*         SUBROUTINE LWRITE(NUM,M)        *
C*  ПPOИЗBOДЯT OБMEH ЭЛEMEHTA CПИCKA C HO- *
C*  MEPOM NUM C MACCИBOM M. C ПOMOЩЬЮ LREAD*
C*  MЫ CЧИTЫBAEM COДEPЖИMOE ЭЛEMEHTA CПИCKA*
C*  B MACCИB M, A C ПOMOЩЬЮ LWRITE ИЗ MAC- *
C*  CИBA B ЭЛEMEHT CПИCKA.                 *
C*                                         *
C*         FUNCTION LCHANG(NUM1,NUM2)      *
C*  MEHЯET MECTAMИ B CПИCKE ЭЛEMEHTЫ C HO- *
C*  MEPAMИ NUM1 И NUM2. ПEPEД OБPAЩEHИEM K *
C*  FUNCTION ЭЛEMEHT C HOMEPOM NUM1 ДOЛЖEH *
C*  CTOЯTЬ B CПИCKE PAHЬШE ЭЛEMEHTA C HOME-*
C*  POM NUM2. ECЛИ BCE HOPMAЛЬHO, TO HA    *
C*  CYMMATOPE HOMEP NUM2, ИHAЧE 0.         *
C*                                         *
C*  ПOД HOMEPOM NUM ЭЛEMEHTA ПOДPAЗYMEBAEM *
C*  BИPTYAЛЬHЫЙ AДPEC KBAHTA, B KOTOPOM HA-*
C*  XOДИTCЯ ЭЛEMEHT, B ПOЛE CПИCOЧHOЙ ПAMЯ-*
C*  TИ.                                    *
C*                                         *
C*         SUBROUTINE LSWOP
C*  CБPACЫBAET COДEPЖИMOE OKHA BO BHEШHЮЮ  *
C*  ПAMЯTЬ ПO OKOHЧAHИЮ PAБOTЫ CO CПИCKOM. *
C*-----------------------------------------*
C*  ДЛЯ HAЧAЛA PAБOTЫ CO CПИCKAMИ OБЯЗATEЛЬ*
C*  HO OБPAЩEHИE K LDEFIN, ПO OKOHЧAHИЮ PA-*
C*  БOTЫ CO CПИCKOM BO BHEШHEЙ ПAMЯTИ OБЯ- *
C*  ЗATEЛЬHO OБPAЩEHИE K LSWOP.            *
C*******************************************
 LIST:,PC,1024
 *RO*:LC,BLOCK,O
 MRP:,EQU,=377 7777
 MLP:,EQU,=:0377 7777
 M:,EQU,=37 7777 7777 7777
 NP:,P/P,(LIST)16
 B:8,BASE,B
 ,STI,14.FIRST
 ,STI,12.YKAZ
 ,STI,11.K
 ,STI,10.N
 ,ITA,13
 ,ATX,RET
 ,XTA,
 ,UTC,O
 ,ATX,
 10,XTA,
 ,AAX,M
 ,ATX,NFILD
 11,XTA,
 ,AAX,M
 ,ATX,KVANT
 ,AAX,=77777
 ,ATX,KVANT1
 ,NTR,3
 ,AAX,=1
 ,U1A,XOPKV  .K-HEЧETH.
 ,XTA,KVANT1
 ,ARX,=7777 7777 7777 7776
 ,ATX,KVANT1. K-1
 XOPKV:14,XTA, .FIRST
 ,AEX,=I0
 ,UZA,MEMORY .CПИCOK B ПAMЯTИ
 ,XTA,
 ,ATX,IWTEK.ИHФ.CЛOBO
 ,ATX,WFL
 12,XTA, .YKAЗATEЛЬ ФAЙЛA
 ,AAX,=77 7777
 ,ATX,YKAZ
 14,XTA,
 ,AAX,=:002
 ,U1A,INIT.HA ИHИЦИAЛ.
 ,XTA,=1
 13,VJM,REWORD
 ,AEX,=3
 ,UZA,OUT
 ,XTA,=I0
 ,UTC,O
 ,ATX,
 ,*64,OШ
 ,UJ,OUT
 OШ:,Z00,ERR5
    ,Z00,ERR5
 ,002,
 8,,
 MEMORY:,XTA,
 ,ATX,YKAZ
 ,ITA,12 .ЭTO AДPEC
 ,ATX,AMAC .MACCИBA
 INIT:,XTA,
 ,ATX,IWTEK
 ,ATX,WFL
 ,XTA,=3
 ,XTS,=1
 13,VJM,WRWORD
 ,ARX,KVANT. K+3
 ,ATX,ADFRKV  .HAЧAЛO CBOБ.ПAMЯTИ
 ,XTS,=2
 13,VJM,WRWORD
 ,WTC,KVANT
 9,VTM,2
 L1:,XTA,
 ,ITS,9
 13,VJM,WRWORD
 9,UTM,-3
 9,VZM,BCE
 9,UTM,2
  ,UJ,L1
 BCE:,XTA,
 ,ATX,LP
 ,XTA,KVANT
 ,ARX,=3
 ,ATX,A
 ,ARX,KVANT
 ,ATX,RP
 STEP1:,XTA,LP
 ,ASN,64-24
 ,AOX,RP
 ,XTS,A
 13,VJM,WRWORD
 ,XTA,A
 ,ATX,LP
 ,XTA,RP
 ,UZA,OUT
 ,ATX,A
 ,ARX,KVANT
 ,ATX,RP
 ,A-X,=1
 ,A-X,NFILD
 ,U1A,STEP1
 ,XTA,
 ,ATX,RP
 ,UJ,STEP1
 OUT:,BSS,
 ,NTR,2
 ,WTC,RET
 ,UJ,
 LSWOP:,ENTRY,
 8,BASE,B
 ,ITA,13
 ,ATX,RET
 ,XTA,ADFRKV
 ,XTS,=2
 13,VJM,WRWORD
 ,XTA,WFL
 ,WTC,RET
  ,UZA,
 ,*70,IWTEK
  ,XTA,
  ,ATX,WFL
  ,WTC,RET
    ,UJ,
 JWORD:,ENTRY,
 8,VTM,B
 ,ATI,14
 14,XTA,
 REWORD:,UTC,READ-WRITE
 WRWORD:11,VTM,WRITE
 ,ATX,VADR
 ,XTA,YKAZ
 ,U1A,INFILE.B ФAЙЛE
 ,XTA,AMAC
 ,ARX,VADR
 ,ATI,14 .+1
 11,UJ,
 INFILE:,XTA,VADR
 ,ASN,64+10.HOMEP
 ,AAX,=1777.BИPT.CTP.
 ,ARX,YKAZ.HOM-P ЗOHЫ ФAЙЛA
 ,AOX,IWO .ЗAГOTOBKA
 ,ATX,WS .ИHФ. CЛOBO ЧTEHИЯ
 ,AEX,IWTEK.HAДO ЛИ
 ,AAX,=77 7777.ЧИTATЬ ЗOHY
 ,UZA,INMEM.HET,YЖE B OKHE
 ,XTA,WFL.CБPOCИTЬ ЛИ CTAPOГO XOЗЯИHA OKHA
 ,UZA,NO SWOP.HE HAДO
 ,XTA,IWTEK
 ,UZA,NO SWOP
 ,*70,IWTEK. CБPOC
 NO SWOP:,XTA,WS
 ,AEX,=:001 .HOBЫЙ
 ,ATX,IWTEK .XOЗЯИH OKHA
 ,*70,WS .ЧTEHИE HAШEЙ ЗOHЫ
 ,UTC,O
 ,XTA,
 ,ARX,=1
 ,UTC,O
 ,ATX,
 ,XTA, .HE БЫЛO
 ,ATX,WFL .ИЗMEHEHИЯ OKHA
 INMEM:,XTA,VADR .AДPEC
 ,AAX,=1777 .BHYTPИ OKHA
 ,ATI,14
 14,UTM,LIST+1
 11,UJ, .HA ПPOЦEДYPY
 READ:14,XTA,-1
 13,UJ,
 WRITE:,XTA,=1
 ,STX,WFL
 14,ATX,-1
 13,UJ,
C----------
 LCREAT:,ENTRY,
 ,UTC,CREAT1-REW1
 LREWIN:,ENTRY,
 ,UTC,REW1-DEAT1
 LDEATH:,ENTRY,
 12,VTM,DEAT1
 8,BASE,B
 ,ATI,14
 14,XTA,
 ,ATX,NAME
 ,ITA,13
 ,ATX,RET
 ,UJ,S/NAME
 CREAT1:,UZA,CREAT2
 ,*64,EXIT1. CПИCOK C TAKИM
 ,XTA,=I0
 ,WTC,RET.ИMEHEM ECTЬ
 ,UJ,
 EXIT1:,Z00,ERR4
       ,Z00,ERR4
 ,002,
 8,,
 CREAT2:,XTA,NAME
 ,XTS,=1
 ,ATX,NAME
 12,VJM,S/NAME
 ,U1A,ECTЬ .ECTЬ 1
 ,XTA,A1
 ,AEX,=1
 ,U1A,ECTЬ .KOHEЦ CП-KA CП-B
 ,XTA,REF
 ,ATX,REF1
 10,VJM,GIVEA
 ,XTA,RFREE
 ,ARX,=1
 ,ATX,WS1
 ,UJ,GO
 ECTЬ:,XTA,REF
 ,ARX,DA
 ,ATX,WS1
 GO:,XTA,
 ,ATX,REF1
 10,VJM,GIVEB
 ,XTA,WS1
 13,VJM,WRWORD
 ,XTA,RFREE.'ПYCTOЙ' CПИCOK
 ,XTS,WS1  .B XAP-KY
 ,ARX,=1
 13,VJM,WRWORD
 ,XTA,
 ,XTS,RFREE
 13,VJM,WRWORD
 ,XTA,RFREE
 ,UJ,OUT
 REW1:,AAX,MRP
 ,UJ,OUT
C----------
 LCONC:,ENTRY,
 8,BASE,B
 ,STI,9  .NAME2
 ,ATI,10 .NAME1
 ,ITA,13
 ,ATX,RET
 9,XTA,
 ,ATX,NAME
 12,VJM,S/NAME
 ,U1A,L44
 L45:,XTA,=I0
 ,UJ,OUT
 L44:,ATX,BA
 ,XTA,=1
 ,XTS,REF
 ,ARX,DA
 13,VJM,WRWORD
 10,XTA,
 ,ATX,NAME
 12,VJM,S/NAME
 ,UZA,L45
 L4:,ATX,A
 13,VJM,REWORD
 ,AAX,MRP
 ,U1A,L4
 ,AOX,BA
 ,XTS,A
 13,VJM,WRWORD
 ,XTA,BA
 13,VJM,REWORD
 ,AAX,MRP
 ,XTS,A
 ,ASN,64-24
 15,AOX,
 ,XTS,BA
 13,VJM,WRWORD
 ,XTA,=I1
 ,UJ,OUT
C----------
 DEAT1:,U1A,LL
 ,XTA,=I0
 ,UJ,OUT
 LL:15,ATX,
 ,XTA,=1
 ,XTS,REF
 ,ARX,DA
 13,VJM,WRWORD
 ,XTA,ADFRKV
 ,STX,A
 ,ATX,ADFRKV
 L21:,ATX,A1
 13,VJM,REWORD
 ,ATX,BA
 ,AAX,MRP
 ,U1A,L21
 ,XTA,BA
 ,AOX,A
 ,XTS,A1
 13,VJM,WRWORD
 ,XTA,A
 13,VJM,REWORD
 ,XTS,A1
 ,ASN,64-24
 15,AOX,
  ,XTS,A
 13,VJM,WRWORD
 ,XTA,=I1
 ,UJ,OUT
C----------
 S/NAME:,BSS,
C... ПOИCK ИMEHИ NAME ЗAДAHHOГO
C... CПИCKA B CПИCKE ИMEH
 ,XTA,=3
 LKV:,ATX,REF
 ,XTA,=1
 LEL:,ATX,DA
 ,XTS,=1
 ,STX,A1
  ,NTR,3
 ,A-X,KVANT1
 ,UZA,NEXTEL
 ,XTA,DA
 ,ARX,REF
 13,VJM,REWORD
 ,ATX,A1
 12,UZA,   .KOH. CПИC.
 ,AEX,NAME
 ,UZA,NAMEIS
 ,XTA,DA
 ,ARX,=2
 ,UJ,LEL
  NEXTEL:,XTA,REF
 ,AAX,MRP
 13,VJM,REWORD
 ,AAX,MRP
 ,U1A,LKV
 12,UJ,
 NAMEIS:,XTA,DA
 ,ARX,=1
 ,ARX,REF
 12,MTJ,13
 ,UJ,REWORD
C----------
 LREAD:,ENTRY,
 ,UTC,READL-WRITEL
C----------
 LWRITE:,ENTRY,
 10,VTM,WRITEL
 8,BASE,B
 ,STI,9 .AДP.MACCИBA
 ,ATI,12.ADP.ЭЛ.CПИCKA
 ,ITA,13
 ,ATX,RET
 ,ITA,7
 ,ATX,R7
 ,WTC,KVANT
 7,VTM,-1
 12,XTA,
 ,ARX,=1
 ,ATX,WW
 LOOP:10,UJ,
 READL:,XTA,WW
 13,VJM,REWORD
 9,ATX,
 ,UJ,ENDL
 WRITEL:9,XTA,
 ,XTS,WW
 13,VJM,WRWORD
 ENDL:,XTA,WW
 ,ARX,=1
 ,ATX,WW
 9,UTM,1
 7,UTM,-1
 7,V1M,LOOP
 ,STI,
 ,WTC,R7
 7,VTM,
 ,UJ,OUT
C----------
 GIVEA:,BSS,
 ,UTC,AFT-BEF
 GIVEB:,BSS,
 9,VTM,BEF
C.... ПPИCOEДИHEHИE K TEKYЩEMY ЭЛEMEHTY
C.... HOBOГO ЭЛEMEHTA ИЗ CBOБOДHOЙ ПAMЯ-
C.... TИ. GIVEA- ДO TEK. ЭЛ-TA., GIVEB-
C.... ПOCЛE TEK. ЭЛ-TA. B REF Д.Б. YKA-
C.... ЗATEЛЬ TEKYЩ. ЭЛ-TA.
 ,XTA,ADFRKV.  ЧTEHИE YK.HAЧ.CB.П.
 ,AAX,MRP
 ,UZA,KPAHTЫ
 ,ATX,RFREE .CBOБ. KBAHT
 13,VJM,REWORD
 ,AAX,MRP
 ,ATX,A
 ,ATX,ADFRKV
 9,UZA,
 13,VJM,REWORD
 ,AAX,MRP
 ,XTS,A
 13,VJM,WRWORD
 9,UJ,
 AFT:,XTA,REF1
 10,UZA,
 13,VJM,REWORD
 ,ATX,WW1
 ,AAX,MLP
 ,AOX,RFREE
 ,XTS,REF1
 13,VJM,WRWORD
 ,XTA,WW1
 ,AAX,MRP
 ,ATX,WW1
 ,UZA,LAST**
 13,VJM,REWORD
 ,AAX,MRP
 ,XTS,RFREE
 ,ASN,64-24
 15,AOX,
 ,XTS,WW1
 13,VJM,WRWORD
 LAST**:,XTA,REF1
 ,ASN,64-24
 ,AOX,WW1
 ,XTS,RFREE
 13,VJM,WRWORD
 10,UJ,
 BEF:,XTA,REF1
 10,UZA,
 13,VJM,REWORD
 ,AAX,MLP
 ,AOX,REF1
 ,XTS,RFREE
 13,VJM,WRWORD
 ,AAX,MLP
 ,U1A,NOFIR
 ,XTA,RFREE
 ,XTS,REF1
 9,VJM,S/ADR
 13,VJM,WRWORD
 ,UJ,FIRST
 NOFIR:,ASN,64+24
 ,ATX,WS1
 13,VJM,REWORD
 ,AAX,MLP
 ,AOX,RFREE
 ,XTS,WS1
 13,VJM,WRWORD
 FIRST:,XTA,REF1
 13,VJM,REWORD
 ,AAX,MRP
 ,XTS,RFREE
 ,ASN,64-24
 15,AOX,
 ,XTS,REF1
 13,VJM,WRWORD
 10,UJ,
 KPAHTЫ:,*64,PRIN
 ,SJ,
 ,UJ,
 PRIN:,Z00,ERR1
      ,Z00,ERR1
  ,002,
 8, ,
C----------
 LBEFOR:,ENTRY,
 ,UTC,24
C----------
 LAFTER:,ENTRY,
 10,VTM,
 ,ATI,12
 8,BASE,B
 13,MTJ,9
 12,XTA,
 ,AAX,MRP
 9,UZA,
 13,VJM,REWORD
 10,ASN,64
 ,AAX,MRP
 ,UZA,B/E
 9,UJ,
 E/LIST:,XTA,=I1
 9,UJ,
 B/LIST:,XTA,=I-1
 9,UJ,
 B/E:10,V1M,B/LIST
 ,UJ,E/LIST
C----------
 LDELA:,ENTRY,
 ,UTC,AFTER-BEFORE
C----------
 LDELB:,ENTRY,
 12,VTM,BEFORE
 8,BASE,B
 ,ATI,10 .TEK.AДP.
 ,ITA,13
  ,ATX,RET
 10,XTA,
 13,VJM,REWORD
 15,ATX,
 ,AAX,MLP
 ,ATX,LP
 15,XTA,
 ,AAX,MRP
 ,ATX,RP
 12,UJ,
 L*:,XTA,RP
 ,UZA,L5
 13,VJM,REWORD
 ,AAX,MRP
 ,AOX,LP
 ,XTS,RP
 13,VJM,WRWORD
 L5:,XTA,LP
 ,UZA,L6
 ,ASN,64+24
 13,VJM,REWORD
 ,AAX,MLP
 ,AOX,RP
 ,XTS,LP
 ,ASN,64+24
 13,VJM,WRWORD
 L6:,XTA,ADFRKV
 ,ATX,WW1 .HAЧ.CB.ПAMЯTИ
 10,XTA,
 ,ATX,ADFRKV
 ,XTA,WW1
 13,VJM,REWORD
 10,XTS,
 ,ASN,64-24
 15,AOX,
 ,XTS,WW1
 13,VJM,WRWORD
 ,XTA,WW1
 10,XTS,
 13,VJM,WRWORD
 ,XTA,A .TEK,ЭЛ-T
 ,UJ,OUT
 AFTER:,XTA,LP
 ,U1A,L66
 ,XTA,RP
 15,ATX,
 10,XTA,
 9,VJM,S/ADR
 13,VJM,WRWORD
 L66:,XTA,RP
 ,UJ,L19
 BEFORE:,XTA,LP
 ,ASN,64+24
 L19:,ATX,A
 ,U1A,L*
 ,*64,PRDEL
 ,XTA,=I0
 ,WTC,RET
 ,UJ,
 PRDEL:,Z00,ERR3
       ,Z00,ERR3
 ,002,
 8, ,
C------------
 LINCB:,ENTRY,
 8,BASE,B
 ,ATI,14.TEK.AДP.
 ,ITA,13
 ,ATX,RET
 14,XTA,
 ,ATX,REF1
 15,ATX,
 10,VJM,GIVEB
 15,XTA,
 13,VJM,REWORD
 ,AAX,MLP
 ,U1A,M3
 ,XTA,RFREE
 14,XTS,
 9,VJM,S/ADR
 13,VJM,WRWORD
 M3:,XTA,RFREE
 ,UJ,OUT
 S/ADR:,BSS,
C.........ПOИCK AДPECA B CПИCKE CПИCKOB
C.........OБPAЩ.ПO И9,HA BЫXOДE CYMM-P=0,
C.........ECЛИ AДPEC HE HAЙДEH,ИHAЧE B.AДP.
C.........CЛOBA ГДE HAЙДEH AДP.
 ,ATX,WW
 ,XTA,=3
 LKV*:,ATX,REF
 ,XTA,=2
 LEL*:,ATX,DA
 ,NTR,3
 ,A-X,KVANT
 ,UZA,NEXT*
 ,XTA,DA
 ,ARX,REF
 13,VJM,REWORD
 9,UZA,
 ,AEX,WW
 ,UZA,EXIT
 ,XTA,DA
 ,ARX,=2
 ,UJ,LEL*
 NEXT*:,XTA,REF
 ,AAX,MRP
 13,VTM,LKV*
 ,U1A,REWORD
 EXIT:,XTA,DA
 ,ARX,REF
 9,UJ,
 LINCA:,ENTRY,
 8,BASE,B
 ,ATI,14
 ,ITA,13
 ,ATX,RET
 14,XTA,
 ,ATX,REF1
 10,VJM,GIVEA
 ,XTA,RFREE
 ,UJ,OUT
C----------
 LCHANG:,ENTRY,
 8,BASE,B
 ,STI,14 .AДP2
 ,ATI,11 .AДP1
 ,ITA,13
 ,ATX,RET
 11,XTA,
 ,ATX,A1
 14,XTA,
 ,ATX,A2
 13,VJM,REWORD
 ,ATX,WW2
 ,XTS,A1
 13,VJM,REWORD
 ,ATX,WW1
 ,AAX,MLP
 ,U1A,L20
 ,XTA,A2
 ,XTS,A1
 9,VJM,S/ADR
 13,VJM,WRWORD.HOB.HAЧAЛO CП.
 L20:,XTA,WW1
 ,AAX,MRP
 ,U1A,L24
 L22:,*64,PRDEL
 ,XTA,=I0
 ,WTC,RET
 ,UJ,
 L24:,AEX,A2
 ,UZA,COC .COCEДИ
 ,XTA,A1
 13,VJM,WRWORD
 ,XTA,WW1
 ,XTS,A2
 13,VJM,WRWORD
 ,AAX,MRP
 ,ATX,RP
 ,XTA,A2
 ,ATX,A
 ,XTA,WW1
 ,ASN,64+24
 ,ATX,LP
 10,VTM,-1
 ,UZA,L23
 ,UJ,L8
 L12:,XTA,WW2
 ,AAX,MRP
 ,ATX,RP
 ,XTA,A1
 ,ATX,A
 ,XTA,WW2
 ,ASN,64+24
 ,ATX,LP
 ,UZA,L22
 L8:13,VJM,REWORD
 ,AAX,MLP
 ,AOX,A
 ,XTS,LP
 13,VJM,WRWORD
 L23:,XTA,RP
 ,UZA,L11
 13,VJM,REWORD
 ,AAX,MRP
 ,XTS,A
 ,ASN,64-24
 15,AOX,
 ,XTS,RP
 13,VJM,WRWORD
 L11:10,VLM,L12
 ,XTA,A2
 ,UJ,OUT
 COC:,XTA,WW1
 ,AAX,MLP
 ,ATX,A
 ,UZA,FIR
 ,ASN,64+24
 ,ATX,A
 13,VJM,REWORD
 ,AAX,MLP
 ,AOX,A2
 ,XTS,A
 13,VJM,WRWORD
 FIR:15,XTA,
 ,AAX,MRP
 ,ATX,BA
 13,VJM,REWORD
 ,AAX,MRP
 ,XTS,A1
 ,ASN,64-24
 15,AOX,
 ,XTS,BA
 13,VJM,WRWORD
 ,XTA,BA
 ,XTS,A2
 ,ASN,64-24
 15,AOX,
 ,XTS,A1
 13,VJM,WRWORD
 ,XTA,A
 ,ASN,64-24
 ,AOX,A1
 ,XTS,A2
 13,VJM,WRWORD
 ,XTA,A2
 ,UJ,OUT
 ERR1:,GOST,24HHET MECTA B ПOЛE ПAMЯTИ'231'
 ERR2:,GOST,18HTAKOГO CПИCKA HET'231'
 ERR3:,GOST,24H HEПPABИЛЬHOE OБPAЩEHИE'231'
 ERR4:,GOST,24H TAKOЙ CПИCOK YЖE ECTЬ'231'
 ERR5:,GOST,18HHET ПOЛЯ CПИCKOB '231'
 IWO:,010,NP
  ,  ,
 NFILD:,BSS,1
 KVANT:,BSS,1
 IWTEK:,BSS,1
 WFL  :,BSS,1
 YKAZ :,BSS,1
 AMAC :,BSS,1
 ADFRKV:,BSS,1
 LP   :,BSS,1
 RP   :,BSS,1
 A    :,BSS,1
 A1:,BSS,1
 A2:,BSS,1
 BA:,BSS,1
 VADR :,BSS,1
 NAME :,BSS,1
 RFREE:,BSS,1
 REF  :,BSS,1
 REF1:,BSS,1
 DA   :,BSS,1
 RET:,BSS,1
 WS1:,BSS,1
 WS :,BSS,1
 WW:,BSS,1
 WW1:,BSS,1
 WW2:,BSS,1
 KVANT1:,BSS,1
 END  :,BSS,1
 R7:,BSS,1
 R6:,BSS,1
 ,END,
 LIBINIT:,NAME,.30/07/85
C*
C*    ПOДПPOГPAMMЫ ИЗ ПAKETA ПPOГPAMM
C*    PAБOTЫ C БИБЛИOTEKOЙ ДAHHЫX
C*
C*  *CALL LIBINIT:<YK>,<ДЛИHA>,<COMMENT>
C*  *CALL LCORRECT:<YK>,<ДЛИHA>,<COMMENT>
C*  *CALL ELCATALOG:<YK>
C*  *CALL ELPRESS:<YK>
C*
C*
C*
C*
 A/I0:,LC,1
 *MONCRD*:LC,BLOCK,MC(12)
 /EXPAGE/:PC,BLOCK,EXRG(1024),ELCAT(1024)
 /ELPRES/:PC,BLOCK,PG2(1024)
 NPC:,P/P,(ELCAT)16
 ELPRES:,SUBP,
 ELCAT:EQ,BLOCK,SPC1,LZ,EMAX,KR,YK
 ,CONT,VL,COPYLUN,COMMENT(11),(2)
 ,CONT,DATES,VERS,NAMES(500)
 ,CONT,NADRS(500),ENEW,SPC2
 8,VTM,
 ,UJ,COM
 LCORRECT:,ENTRY,
 8,VTM,CORR
 ,UJ,COM
 ELCATALO:,ENTRY,
 8,VTM,PRINT
 ,UJ,COM
 ELPRESS:,ENTRY,
 8,VTM,PRESS
 COM:,BSS,
 ,ITA,13
 ,ATX,SI13
 ,ITA,7
 ,ATX,SI7
 8,MTJ,7
 10,VTM,
 ,CALL,PARAMT*
 11,VZM,ESTR
 9,VTM,LUN
 10,VTM,4
 ,CALL,PARAMT*
 11,VZM,ESTR
 9,VTM,LONG
 10,VTM,5
 ,CALL,PARAMT*
 11,VZM,ESTR
 ,XTA,=6H
 14,VTM,-11
 CLMC:14,ATX,MC+11
 14,VLM,CLMC
 10,VTM,1
 ,CALL,PARAMT*
 14,VTM,-10
 TRMC:14,XTA,MC+10
 14,ATX,COMM+10
 14,VLM,TRMC
 ESTR:,BSS,
 7,VZM,INIT
 14,VTM,LUN
 ,ITS,14
 ,CALL,EXLIB
 7,UJ,
 INIT:,BSS,
 ,XTA,=6HL-CAT.
 ,ATX,SPC1
 ,ATX,SPC2
 ,XTA,
 ,ATX,KR
 ,ATX,ENEW
 14,VTM,500
 ,ITA,14
 ,ATX,YK
 14,VTM,1
 ,ITA,14
 ,ATX,VL
 ,*50,67B
 ,APX,=:7707 7774
 ,ASN,64+27
 ,ATX,DATES
 ,XTA,=1
 ,ATX,VERS
 CORR:,BSS,
C
C   OБЩAЯ ЧACTЬ LIBINIT И LCORRECT
C
 ,XTA,LONG
 ,UZA,L
 ,ARX,=1777
 ,ASN,64+11
 ,UZA,LG
 L:,XTA,=1000
 ,ATX,LONG
 LG:,XTA,LONG
 ,ATX,LZ
 ,AOX,A/I0
 ,NTR,6
 ,A*X,=R1023
 ,NTR,7
 ,A-X,=I1
 ,AAX,=7777 7777
 ,ATX,EMAX
 14,VTM,-10
 LCOMM:14,XTA,COMM+10
 14,ATX,COMMENT+10
 14,VLM,LCOMM
 ,NTR,6
 ,XTA,LUN
 ,AOX,WPC
 ,*70,.ЗAП.KAT. ***
 RET:,WTC,SI7
 7,VTM,
 ,WTC,SI13
 ,UJ,
 PRINT:,BSS,
 ,ITS,
 ,CALL,ELPRIN
 ,UJ,RET
 PRESS:13,VTM,RET
 ,UJ,ELPRES
 LUN:,LOG,670000
 LONG:,LOG,1000
 SI13:,BSS,1
 SI7:,BSS,1
 COMM:,BSS,11
 WPC:,Z00,NPC
 ,,
 ,END,
  LIBLOOK:,NAME,
C*
C****  3.1.84.  A.П.CAПOЖHИKOB
C*
C*    *CALL LIBLOOK
C*   ПPOCMOTP KATAЛOГOB BCEX ИMEЮЩИXCЯ
C*   B CИCTEME OБЩИX БИБЛИOTEK (OБCП)
C*   И CAMOЙ CИCTEMЫ (OБCП-00).
C*   ПEЧATЬ COBПAДAЮЩИX ИMEH ПPOГPAMM.
C*
  PRINT8:,SUBP,
  TEXISO:,SUBP,
  OCTTDEC:,SUBP,
  SHSORT :,SUBP,
  ALLMEMOR:,SUBP,
  LIST:,EQU,ALLMEMOR
  TAPES:,EQU,77721B
  ZONES:,EQU,77751B
C---
   13,MTJ,7
    ,CALL,ALLMEMOR
C---
   4,VTM,-27B
  ,*70,=0014 3700 0021 0006
  TCOP:4,XTA,TAPES+27B
  4,ATX,TABL+27B
  4,XTA,ZONES+27B
  ,ASN,64+30
  4,ATX,TABL+57B
  4,VLM,TCOP
C---
  ,XTA,
  ,ATX,NLIB.HOMEP OБCП
  2,VTM,LIST.HAЧ.CПИCKA
  3,VTM,.ЧИCЛO П/П
  ,XTA,=0010 3700 0021 0000
  ,UJ,BLIB.CИCTEMA
C---
  NEWLIB:,XTA,=1
  ,ARX,NLIB
  ,ATX,NLIB
  ,ATI,1
  ,AEX,=30
  ,UZA,SORT
  1,XTA,TABL-1
  ,UZA,NEWLIB.HET CП
  ,XTA,NLIB
  ,ASN,64-42
  ,AUX,=6H'''''''''7''7'
  ,AOX,TSP
  ,ATX,TERCAT
  ,ATX,TLIB
C---
  LOCC:13,VTM,30B
  ,*57,3
  1,XTA,TABL-1
  ,*57,2400B
  ,UZA,NEWLIB.HET MЛ
  ,AAX,=:1
  ,U1A,LOCC.ЗAHЯTA
  4,VTM,.ЧИCЛO П/П
  1,XTA,TABL+27B.ЗOHA
  ,AOX,=0010 3700 0030 0000
C---
  BLIB:5,VTM,-1
  6,VTM,76002B
  RCAT:,ATX,IR
  ,*70,IR
C---
  CLOOP:6,XTA,
  2,ATX,
  ,UZA,PRIL
  ,ITS,6
  ,ITS,2
  ,CALL,TEXISO
  6,XTA,1
  ,ATI,14
  ,ASN,64+15
  ,UZA,ENTRY
  ,ATI,14
  ,XTA,=40
  ENTRY:,AOX,NLIB
   ,ASN,64-15
  ,ITS,14
  15,AOX,
  2,XTS,1
  ,AAX,=:7777 74
  15,AOX,
  2,ATX,1
  2,UTM,2
  4,UTM,1
  6,UTM,2
  6,VIM,CLOOP
  6,VTM,76000B
  ,XTA,IR
  ,ARX,=1
  5,VLM,RCAT
  12,VTM,TERCAT
  ,*64,PRIN12
C---
  PRIL:,ITA,4
  ,CALL,OCTTDEC
  ,AAX,=6H'17''17''17''17''17''17'
  12,VTM,TLIB
  12,ATX,3
  ,*64,PRIN12
  ,XTA,=:4
  ,*57,4000B
  4,J+M,3
  ,UJ,NEWLIB
C---
  SORT:,ITA,3
  ,AOX,=I0
  ,ATX,IR
  ,CALL,OCTTDEC
  ,AAX,=6H'17''17''17''17''17''17'
  12,VTM,TALL
  12,ATX,1
  ,*64,PRIN12
C---
  14,VTM,LIST
  ,ITS,14
  14,VTM,IR
  ,ITS,14
  14,VTM,=I2
  ,ITS,14
  14,VTM,=I0
  ,ITS,14
  1,VTM,LIST
  ,CALL,SHSORT
C---
  ANAL:1,XTA,
  7,UZA,.KOHEЦ
  ,ATX,NAME
  1,XTA,1
  ,AAX,=:7777 74
  ,AOX,=6H''''
  ,ATX,NAME+1
  2,VTM,2
C---
  A1:1,XTA,
  ,AEX,NAME
  ,U1A,A2
  1,XTA,1
  ,AEX,NAME+1
  ,ASN,64+32
  ,U1A,A2
  1,XTA,1
  ,ASN,64-28
  ,AUX,=6H'''''3''7'''''
  ,AOX,=6H  00 E
  2,ATX,NAME
  1,XTA,1
  ,AAX,=40 00000
  :,UZA,*+1
  ,XTA,=177
 :2,AEX,NAME
  2,ATX,NAME
   1,XTA,1
  ,AAX,=77777
    1,UTM,2
  ,CALL,OCTTDEC
  ,AAX,=6H'17''17''17''17''17''17'
  ,ASN,64-8
  ,AOX,=6H00000,
  2,ATX,NAME+1
  2,UTM,2
  ,UJ,A1
C---
  A2:2,UTM,-4
  2,VZM,ANAL
  14,VTM,NAME
  3,VTM,2
  ,ITA,2
  ,ASN,64+4
  ,UZA,A3
  ,ITS,14
  14,VTM,NAME+17
  ,ITS,14
  ,ITS,3
  ,CALL,PRINT8
  3,VTM,14
  14,VTM,NAME+18
  A3:,ITS,14
  2,UTM,NAME+3
  ,ITS,2
  ,ITS,3
  13,VTM,ANAL
  ,UJ,PRINT8
C---
  PRIN12:12,Z00,
  12,Z00,
  ,002,
  8,,
C---
  TSP:,GOST,6HOБCП00
  TERCAT:,GOST,30HOБCП00 - HET KOHЦA KATAЛOГA.'231'
  TLIB  :,GOST,36HOБCП00 COДEPЖИT   000000 ПPOГPAMM.'231'
  TALL  :,GOST,24HBCEГO 000000 ПPOГPAMM.'231'
  NLIB:,BSS,1
  IR  :,BSS,1
  TABL:,BSS,48
  NAME:,BSS,52
  ,END,
 L IMAGE:,NAME,.(IMAG,LIM,STR,LST)
C*
C*    FUNCTION LIMAGE (IMAG,LIM,STR,LST)
C*    OCYЩECTBЛЯET ПOИCK TEKCTOBOГO OБPAЗA
C*    'IMAG' ДЛИHOЙ LIM CИMBOЛOB B CTPOKE
C*    'STR' ДЛИHOЙ LST CИMBOЛOB.
C*    ECЛИ OБPAЗ ПPИCYTCTBYET B CTPOKE,
C*    ФYHKЦИЯ ПPИHИMAET ЗHAЧEHИE '1',
C*    ECЛИ OБPAЗA HET ИЛИ ПAPAMETPЫ ЗAДAHЫ
C*    HEBEPHO, ЗHAЧEHИE ФYHKЦИИ - '0'.
C*
C*    B.И.ДYПИH -- ЛEHИHГPAД -- ЯHB.1984
C*
 8,BASE,*
 ,STI,12
 ,STI,11
 ,STI,14
 ,ATI,10
 ,NTR,3
 12,XTA,
 14,A-X,
 ,ATX,QSYM
 14,XTA,
 ,A-X,=I1
 9,VTM,1
C
 BEGM:9,UTM,-1
 10,UTM,1
 11,UTM,1
 ,A-X,=I6
 ,UZA,BEGM
 12,VTM,PUTS
C
 PUTM:,A+X,=I6
 ,U1A,NOT IM
 ,ASN,64-3.*8
 ,ATI,14
 ,XTA,FULBYT
 14,ASN,64-40
 12,UJ,
C
 PUTS:,ATX,MASK
 9,UTC,-1
 10,XTA,
 ,ASN,64+40
 ,ATX,WORD
 14,VTM,1 - 5
C
 PUTW:,ASN,64-8
 ,AOX,WORD
 14,VLM,PUTW
 ,ATX,WORD
C
 EQS1:11,UTM,1
 ,XTA,QSYM
 ,A-X,=I6
 ,ATX,QSYM
 ,UZA,EQS2
 12,VJM,PUTM
 ,AAX,WORD
 ,UJ,EQS3
C
 EQS2:,XTA,WORD
 EQS3:9,UTC,-2
 11,AEX,
 ,AAX,FULBYT
 ,ARX,FULBYT
 ,AOX,FULBYT
 ,AEX,FULWOR
C
 EQW1:,UZA,EQS1
 ,ANX,
 ,ATI,14
 ,YTA,
 14,ASN,64
 ,ATX,NSYM
 ,ITA,14
 ,AEX,FULWOR
 ,ATI,12
 9,MTJ,14
C
 EQW2:14,UTC,-2
 11,XTA,
 12,ASN,64+2
 14,UTC,-1
 11,XTS,
 12,ASN,64+50
 15,AOX,
 14,UTC,-1
 10,AEX,
 14,VLM,EQW3
C
 ,AAX,MASK
 ,U1A,NOT EQ
 ,XTA,=I1
 ,UJ,RETURN
C
 EQW3:,AAX,FULBYT
 ,UZA,EQW2
C
 NOT EQ:,XTA,NSYM
 ,UJ,EQW1
C
 NOT IM:,XTA,=I0
C
 RETURN:,NTR,6
 13,UJ,
C
 FULWOR:,OCT,7777 7777 7777 7777
 FULBYT:,OCT,3767 7577 3767 7577
C
 WORD:,BSS,1
 MASK:,BSS,1
 QSYM:,BSS,1
 NSYM:,BSS,1
 ,END,
 LISTING:,NAME,
C*
C*     HOЯБPЬ 1987Г.            A. ДABЫДOB
C*
C*
C*     ЗAПИCЬ ЛИCTИHГA - ЛИБO HA MЛ EC ДЛЯ
C*  ПEPEHOCA HA  EC ЭBM,  ЛИБO B TEKCTOBЫЙ
C*  ФAЙЛ  БЭCM-6.
C*
C*
C*        CTPYKTYPA ЗAПИCИ ДЛЯ EC:
C*
C*     HA  ЛEHTE  MOГYT  PACПOЛAГATЬCЯ HEC-
C*  KOЛЬKO ЛИCTИHГOB,  MEЖДY KOTOPЫMИ ЗAПИ-
C*  CЫBAETCЯ "EOF".  ЗA  ПOCЛEДHИM  ЛИCTИH-
C*  ГOM - ДBA "EOF" ПOДPЯД. ЗAПИCЬ BEДETCЯ
C*  БЛOKAMИ ПO 6 KБAЙT. KAЖДAЯ CTPOKA ЗAHИ-
C*  MAET  POBHO  132  CИMBOЛA  B KOДE ДKOИ,
C*  ПPИ ЭTOM B ПEPBЫX TPEX ПOЗИЦИЯX  PAЗME-
C*  ЩAETCЯ ЦEЛOE ДECЯTИЧHOE ЧИCЛO  N, OПPE-
C*  ДEЛЯЮЩEE  KOЛИЧECTBO  CTPOK,   KOTOPЫE
C*  HAДO ПPOПYCTИTЬ ПEPEД  ПEЧATЬЮ  ДAHHOЙ
C*  CTPOKИ.  ECЛИ   N  PABHO  0, TO ПEЧATЬ
C*  ДOЛЖHA ИДTИ БEЗ ПPOГOHA CTPOKИ, C HAЛO-
C*  ЖEHИEM. ЧETBEPTAЯ ПOЗИЦИЯ CTPOKИ  BCEГ-
C*  ДA COДEPЖИT ПPOБEЛ,  ЗA HИM  PACПOЛAГA-
C*  ETCЯ COБCTBEHHO CTPOKA ДЛЯ ПEЧATИ (128
C*  CИMBOЛOB).
C*     ПPИЗHAK KOHЦA ЛИCTИHГA - N=999, ПPИ
C*  ЭTOM 4:132 ПOЗИЦИИ CTPOKИ HA ЛEHTE  CO-
C*  ДEPЖAT ПPOБEЛЫ.
C*
C*
C*        CTPYKTYPA ЗAПИCИ ДЛЯ БЭCM-6.
C*
C*     OДHA CTPOKA ЛИCTИHГA ЗAПИCЫBAETCЯ B
C*  ДBE ПOДPЯД  ИДYЩИE  CTPOKИ  TEKCTOBOГO
C*  ФAЙЛA.  B ПEPBOЙ ИЗ HИX: ПOЗИЦИИ 01:03
C*  COДEPЖAT  KOЛИЧECTBO ПPOГOHOB  N,  ЧET-
C*  BEPTAЯ ПOЗИЦИЯ - ПPOБEЛ, ДAЛEE - COДEP-
C*  ЖИMOE  01:64  ПOЗИЦИЙ  CTPOKИ ЛИCTИHГA.
C*  OCTATOK  CTPOKИ  ЛИCTИHГA  HAXOДИTCЯ B
C*  CЛEДYЮЩEЙ CTPOKE  BЫXOДHOГO TEKCTOBOГO
C*  ФAЙЛA, HAЧИHAЯ C ПЯTOЙ ПOЗИЦИИ.
C*
C*
C*        OБPAЩEHИE:
C*
C*   1.) BЫЗOB ИЗ ПAKETA:
C*
C*       *NAME ....
C*       *LIBRA:13,23
C*       *CALL LISTING
C*       *END F
C*
C*   2.) ИЗ БИБЛИOTEKИ CЛYЖEБHЫX ЗAДAЧ
C*       (OПEPATOPCKИЙ TEPMИHAЛ):
C*
C*       54/      - БEЗ ПPOTOKOЛA
C*      154/      - C ПPOTOKOЛOM
C*
C*
C*       ПPИMEP ДИAЛOГA:
C*
C*     1.) ЗAПИCЬ HA MЛ EC.
C*
C*   HOMEP ПO ФAЙЛY BЫBOДA: 13
C*
C*   KYДA ЗAПИCATЬ: E501/NO CHECK
C*
C*   C HAЧAЛA ЛEHTЫ? [Y/N/HOMEP]: Y
C*
C*   ИBAHOB ==> E501/NO CHECK ФAЙЛ 1 (ДKOИ)
C*
C*      ЗAПИCAHO  11 БЛ.
C*
C*   HOMEP ПO ФAЙЛY BЫBOДA: 42
C*
C*   ИBAHOB ==> E501/NO CHECK ФAЙЛ 2 (ДKOИ)
C*
C*      ЗAПИCAHO   2 БЛ.
C*
C*
C*     BOЗMOЖHЫ TPИ BAPИAHTA OTBETA HA BOП-
C*  POC  " C HAЧAЛA ЛEHTЫ? ":
C*
C*    Y - ЗAПИCЬ ПOЙДET C HAЧAЛA MЛ
C*    N - ЗAПИCЬ "B XBOCT" ИMEЮЩEЙCЯ HA MЛ
C*        ИHФOPMAЦИИ
C*    <ЧИCЛO> - ЗAПИCЬ  B  ФAЙЛ C ЗAДAHHЫM
C*        HOMEPOM.
C*
C*
C*     2.) ЗAПИCЬ B TEKCTOBЫЙ ФAЙЛ БЭCM-6
C*
C*   HOMEP ПO ФAЙЛY BЫBOДA: 13
C*
C*   KYДA ЗAПИCATЬ: D701/SYSTEM,A,A
C*
C*   ЗOHA: 20
C*
C*   ИBAHOB ==> D701/SYSTEM,A,A Z=0020 (ISO)
C*
C*      ЗAПИCAHO 0005 ЗOH
C*
C*   HOMEP ПO ФAЙЛY BЫBOДA: E
C*
C*   ДO CBИДAHИЯ!
C*
C*
C*     ПOCЛE BЫДAЧИ ИTOГOBOЙ CTPOKИ
C*   (ИBAHOB ===> ...) KYPCOP OCTAHABЛИBA-
C*   ETCЯ, ПPOГPAMMA  ЖДET  ПOДTBEPЖДEHИЯ.
C*   BOЗMOЖHЫ TPИ BAPИAHTA OTBETA:
C*
C*   - ПYCTAЯ ПOCЫЛKA (HAЖATИE KЛABИШИ
C*     [ LINE FEED ]);
C*   N - HEBEPHO, ДИAЛOГ HAЧИHAETCЯ ЗAHOBO;
C*   E - KOHEЦ PAБOTЫ (БEЗ ПEPEПИCИ);
C*
C*     З A M E Ч A H И E.  B OTBET HA ЛЮБOЙ
C*   BOПPOC  ПPOГPAMMЫ  MOЖET  БЫTЬ  BBEДEH
C*   ПPИKAЗ  "E".
C*
C*
 **:LC,BLOCK,ICЛYЖ,MEC
      ,CONT,FCPLUS,NPASS,NZOUT
 *ISOTAB*:,SUBP,
 XWRITE/:,LC,2
 *POUT*:,PC,2048
 PUTOUT:,SUBP,
 NPO:,P/P,(*POUT*)16
 MN*TL:,EQU,1067B
 ,XTA,
 ,ATX,ICЛYЖ
 ,*50,70100B+117B
 ,AAX,=1777
 ,AOX,=I0
 ,ATX,NPASS
 ,XTA,=3053 4576 1634 0112
 ,*76,1
 ,ITA,13
 ,ATX,W
 14,VTM,=I2
 ,ITS,14
 ,CALL,DIALOP
 ,XTA,W
 ,ATI,13
 ,UJ,PUTOUT
 TASK54:,ENTRY,
 14,CALL,MAK*TRT
 ,ATX,NAME
 14,VTM,NAME+1
 ,ITA,14
 ,*50,64B
 14,VTM,NAME
 ,ITA,14
 ,AOX,MN*TL
 ,*50,76B
 ,XTA,=I1
 ,ATX,ICЛYЖ
 ,ITA,1
 ,AAX,=1
 ,ASN,64-1
 ,AOX,=I0
 ,ATX,W
 14,VTM,W
  ,ITS,14
 ,CALL,DIALOP
 ,CALL,PUTOUT
 ,*62,
 CLOSE:,ENTRY,
C
C   CAMOЗAKPЫTИE HA 10 CEK.
C
 12,VTM,-9
 L:,*57,3
 12,VLM,L
 13,UJ,
C     ------------------
 RCO:,ENTRY,
C
C   ЧTEHИE KATAЛOГA BЫBOДA
C
 ,XTA,I/RCO
 ,*57,7
 13,UJ,
C     ------------------
 WCO:,ENTRY,
C
C   ЗAПИCЬ KATAЛOГA BЫBOДA
C
 ,XTA,I/WCO
 ,*57,7
 13,UJ,
C     ------------------
 RZO:,ENTRY,
C
C   ЧTEHИE ЗOHЫ ФAЙЛA BЫBOДA
C
 ,XTA,NZOUT
 ,AAX,=777
 ,AOX,I/RZO
 ,*57,7
 13,UJ,
C     ------------------
 OPCOUT:,ENTRY,
C
C   OTKAЗ OT MOHOПOЛИИ HA KATAЛOГ
C   BЫBOДA
C
 ,XTA,=2
 ,*50,210B
 13,UJ,
C     -------------------
 JCTR:,ENTRY,
C
C        ПEPEBOД CИMBOЛA:
C   ГOCT ==> ISO ,  ГOCT ==> ДKOИ
C
 ,ATI,14
 14,WTC,
 ,XTA,*ISOTAB*
 ,WTC,MEC
 ,APX,MSYM
 ,ASN,64-8
 ,YTA,
 ,AOX,=I0
 13,UJ,
C     --------------------
 NZTX:,ENTRY,
C
C   BЫДAЧA HOMEPA ЗOHЫ TEKYЩEГO
C   OБMEHA C TEKCTOBЫM ФAЙЛOM
C
 ,XTA,XWRITE/+1
 ,AAX,=7777
 ,AOX,=I0
 13,UJ,
C     --------------------
C
C
 MSYM:,ISO,6H'''''377'''''''
 ,ISO,6H'377'''''''''''
 I/RCO:1,Z00,
 ,Z00,*POUT*
 I/WCO:2,Z00,
 ,Z00,*POUT*
 I/RZO:3,Z01,NPO
 ,Z00,
 NAME:,ISO,6H
 ,CONT,18HЗAПИCЬ ЛИCTИHГA''''''
 W:,LOG,
 ,END,
      LLФ        :,NAME,
      *HEAD*     :,LC,  15
   LLФ PAG       :,SUBP,
   LLФ MIN       :,SUBP,
   LLФ ZON       :,SUBP,
   LLФ PRN       :,SUBP,
      PAS        :,SUBP,
   LLФ ANL       :,SUBP,
LL434:,EQU,        *HEAD*    +2
C---------
  PAGE:,EQU,LLФ PAG
  ФMIN:,EQU,LLФ MIN
  NZONE:,EQU,LLФ ZON
  PRN:,EQU,LLФ PRN
  ANL:,EQU,LLФ ANL
C---------
            14 ,  VTM,   *00002
                 , UJ,   *00354
      BLN       :,ENTRY,
            14 ,  VTM,   *00345
                 , UJ,   *00354
 *00002    :14 ,  VTM,   BSS+ 0012B
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
            13 ,  VJM,      ANL
             7 ,  XTA,  23B
                 ,ITS,
                 ,WTC,   BSS+ 0010B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00011
                 , UJ,   *00012
                 ,UTC,
 *00011    :     , UJ,   *00026
                 ,UTC,
 *00012    : 7 ,  XTA,  20B
                 ,ITS,
             7 ,  XTA,  25B
            15 ,  AEX,
                 ,UZA,   *00015
                 , UJ,   *00016
 *00015    :     , UJ,   *00074
                 ,UTC,
 *00016    : 7 ,  XTA,  20B
                 ,ITS,
                 ,WTC,   BSS+ 0010B
                 ,XTA,
            15 ,  AEX,
                 ,UIA,   *00022
                 , UJ,   *00023
                 ,UTC,
 *00022    :     , UJ,   *00031
                 ,UTC,
 *00023    :     ,WTC,   BSS+ 0010B
                 ,XTA,
             7 ,  ATX,  25B
                 ,NTR,  3
                 ,NTR,  22B
                 ,UTC,
 *00026    :     ,WTC,   BSS+ 0010B
                 ,XTA,  1
             7 ,  ATX,  77777B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00363
 *00031    : 7 ,  XTA,  36B
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  4
                 ,NTR,  22B
                 ,UZA,   *00035
                 , UJ,   *00036
                 ,UTC,
 *00035    :     , UJ,   *00052
                 ,UTC,
 *00036    : 7 ,  XTA,  2
L                ,UTC,   *HEAD*    +1
                 ,ATX,
                 ,NTR,  3
            14 ,  VTM,   *00372
                 ,ITS,  14
L           14 ,  VTM,   *HEAD*    +2
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0013B
                 ,ITS,  14
            14 ,  VTM,   *00373
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      PAS
            14 ,  VTM,   *00375
                 ,ITS,  14
L           14 ,  VTM,   L434     +8
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0013B
                 ,ITS,  14
            14 ,  VTM,   *00373
                 ,ITS,  14
            13 ,  VJM,      PAS
 *00052    :14 ,  VTM,   *00371
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0024B
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  12
                 ,ITS,  14
            14 ,  VTM,   *00373
                 ,ITS,  14
            13 ,  VJM,      PAS
            14 ,  VTM,   *00374
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0025B
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00403
                 ,ITS,  14
            13 ,  VJM,      PAS
            14 ,  VTM,   *00374
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0041B
                 ,ITS,  14
            14 ,  VTM,   *00411
                 ,ITS,  14
            14 ,  VTM,   *00372
                 ,ITS,  14
            13 ,  VJM,      PAS
            14 ,  VTM,   BSS+ 0024B
                 ,ITS,  14
            14 ,  VTM,   *00404
                 ,ITS,  14
            13 ,  VJM,      PRN
 *00074    : 7 ,  XTA,  14
                 ,ITS,
             7 ,  XTA,  41B
            15 ,  AEX,
                 ,UZA,   *00077
                 , UJ,   *00100
 *00077    :     , UJ,   *00176
                 ,UTC,
 *00100    : 7 ,  XTA,  1
                 ,ITS,
             7 ,  XTA,  36B
            15 ,  AEX,
                 ,UZA,   *00103
                 , UJ,   *00104
 *00103    :     , UJ,   *00363
                 ,UTC,
 *00104    : 7 ,  XTA,  36B
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  5
                 ,NTR,  22B
                 ,UIA,   *00110
                 , UJ,   *00112
                 ,UTC,
 *00110    : 7 ,  XTA,  5
             7 ,  ATX,  36B
                 ,NTR,  3
                 ,NTR,  22B
 *00112    :     ,WTC,   BSS+ 0012B
                 , UJ,   *00112
                 , UJ,   *00162
                 ,UTC,
                 , UJ,   *00162
                 ,UTC,
                 , UJ,   *00136
                 ,UTC,
            14 ,  VTM,   *00371
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0016B
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0013B
                 ,ITS,  14
            14 ,  VTM,   *00373
                 ,ITS,  14
            13 ,  VJM,      PAS
            14 ,  VTM,   *00367
                 ,ITA,  14
            13 ,  VJM,  NZONE
             7 ,  ATX,  44B
            14 ,  VTM,   *00371
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0021B
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  12
                 ,ITS,  14
            14 ,  VTM,   *00373
                 ,ITS,  14
            13 ,  VJM,      PAS
L                ,UTC,   L434     +4
                 ,XTA,
             7 ,  ATX,  26B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00363
 *00136    :14 ,  VTM,   *00371
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0013B
                 ,ITS,  14
            14 ,  VTM,   *00373
                 ,ITS,  14
            13 ,  VJM,      PAS
             7 ,  XTA,  21B
                 ,WTC,   BSS+ 0010B
                 ,ATX,  2
            14 ,  VTM,   *00371
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  3
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  12
                 ,ITS,  14
            14 ,  VTM,   *00373
                 ,ITS,  14
            13 ,  VJM,      PAS
L                ,UTC,   L434     +4
                 ,XTA,
                 ,WTC,   BSS+ 0010B
                 ,ATX,  7
            14 ,  VTM,   *00371
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  5
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0016B
                 ,ITS,  14
            14 ,  VTM,   *00373
                 ,ITS,  14
            13 ,  VJM,      PAS
                 , UJ,   *00176
                 ,UTC,
 *00162    :14 ,  VTM,   *00371
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0016B
                 ,ITS,  14
            14 ,  VTM,   *00376
                 ,ITS,  14
            13 ,  VJM,      PAS
             7 ,  XTA,  26B
                 ,WTC,   BSS+ 0010B
                 ,ATX,  7
            14 ,  VTM,   *00371
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  5
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  12
                 ,ITS,  14
            14 ,  VTM,   *00373
                 ,ITS,  14
            13 ,  VJM,      PAS
 *00176    : 7 ,  XTA,  15
                 ,ITS,
                 ,WTC,   BSS+ 0010B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00202
                 , UJ,   *00207
                 ,UTC,
 *00202    : 7 ,  XTA,  22B
                 ,ITS,
                 ,WTC,   BSS+ 0010B
                 ,XTA,  1
            15 ,  AEX,
                 ,UZA,   *00206
                 , UJ,   *00207
                 ,UTC,
 *00206    :     , UJ,   *00237
                 ,UTC,
 *00207    : 7 ,  XTA,  77776B
                 ,NTR,  3
             7 ,  A-X,  7
                 ,NTR,  22B
                 ,UIA,   *00212
                 , UJ,   *00215
 *00212    : 7 ,  XTA,  77776B
                 ,NTR,  3
             7 ,  A+X,  9
             7 ,  ATX,  77776B
                 ,NTR,  22B
                 ,UTC,
 *00215    : 7 ,  XTA,  77776B
             7 ,  ATX,  27B
                 ,NTR,  3
            14 ,  VTM,   *00371
                 ,ITS,  14
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0047B
            14 ,  VTM,
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00401
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      PAS
            14 ,  VTM,   BSS+ 0004B
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  8
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0042B
                 ,ITS,  14
            14 ,  VTM,   *00400
                 ,ITS,  14
            13 ,  VJM,      PAS
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
             7 ,  AOX,
                 ,WTC,   BSS+ 0011B
            13 ,  VJM,
                 , UJ,   *00363
                 ,UTC,
 *00237    : 7 ,  XTA,  77776B
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  10
                 ,NTR,  22B
                 ,UZA,   *00243
                 , UJ,   *00244
                 ,UTC,
 *00243    :     , UJ,   *00363
                 ,UTC,
 *00244    : 7 ,  XTA,  2
L                ,UTC,   *HEAD*    +1
                 ,ATX,
                 ,NTR,  3
             7 ,  XTA,  20B
                 ,UTC,   L434
                 ,ATX,
             7 ,  XTA,  21B
L                ,UTC,   L434     +1
                 ,ATX,
             7 ,  XTA,  21B
L                ,UTC,   L434     +8
                 ,ATX,
                 ,UTC,   L434
                 ,XTA,
L                ,UTC,   L434     +9
                 ,ATX,
             7 ,  XTA,  9
L                ,UTC,   L434     +10
                 ,ATX,
             7 ,  XTA,  2
             7 ,  ATX,  31B
                 ,NTR,  22B
                 , UJ,   *00267
 *00260    :     ,WTC,   BSS+ 0005B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0047B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00401
                 ,ITS,  14
            13 ,  VJM,      PRN
             7 ,  XTA,  31B
                 ,NTR,  3
             7 ,  A+X,  9
             7 ,  ATX,  31B
                 ,NTR,  22B
                 ,UTC,
 *00267    : 7 ,  X-A,  77776B
                 ,UZA,   *00260
             7 ,  XTA,  77776B
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  13
                 ,NTR,  22B
                 ,UIA,   *00274
                 , UJ,   *00277
                 ,UTC,
 *00274    : 7 ,  XTA,  2
L                ,UTC,   *HEAD*    +1
                 ,ATX,
                 ,NTR,  3
                 ,NTR,  22B
                 ,UTC,
 *00277    : 7 ,  XTA,  12
L                ,UTC,   L434     +10
                 ,ATX,
             7 ,  XTA,  2
             7 ,  ATX,  31B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00337
 *00303    : 7 ,  XTA,  31B
             7 ,  ATX,  32B
                 ,NTR,  3
             7 ,  XTA,  31B
             7 ,  ATX,  33B
                 ,NTR,  22B
                 , UJ,   *00317
                 ,UTC,
 *00307    :14 ,  VTM,   BSS+ 0050B
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0006B
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0007B
                 ,ITS,  14
            13 ,  VJM,      ФMIN
                 ,NTR,  3
                 ,NTR,  22B
             7 ,  XTA,  33B
                 ,NTR,  3
             7 ,  A+X,  9
             7 ,  ATX,  33B
                 ,NTR,  22B
                 ,UTC,
 *00317    : 7 ,  X-A,  77776B
                 ,UZA,   *00307
                 ,WTC,   BSS+ 0006B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0047B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00401
                 ,ITS,  14
            13 ,  VJM,      PRN
            14 ,  VTM,   *00371
                 ,ITS,  14
                 ,WTC,   BSS+ 0006B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0047B
            14 ,  VTM,
                 ,ITS,  14
                 ,WTC,   BSS+ 0005B
             2 ,  VTM,
             2 ,  UTC,   BSS+ 0047B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00401
                 ,ITS,  14
            13 ,  VJM,      PAS
             7 ,  XTA,  31B
                 ,NTR,  3
             7 ,  A+X,  9
             7 ,  ATX,  31B
                 ,NTR,  22B
                 ,UTC,
 *00337    : 7 ,  X-A,  77776B
                 ,UZA,   *00303
            13 ,  VJM,      PAGE
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
             7 ,  AOX,
                 ,WTC,   BSS+ 0011B
            13 ,  VJM,
                 , UJ,   *00363
                 ,UTC,
 *00345    : 7 ,  XTA,  21B
                 ,WTC,   BSS+ 0010B
                 ,ATX,  12
             7 ,  XTA,  21B
                 ,WTC,   BSS+ 0010B
                 ,ATX,  13
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
             7 ,  AOX,
                 ,WTC,   BSS+ 0011B
            13 ,  VJM,
                 , UJ,   *00363
                 ,UTC,
 *00354    : 7 ,  MTJ,  8
            14 ,  MTJ,  10
             7 ,  VTM,   *00370
             7 ,  STX,  35B
             7 ,  STX,  34B
                 ,ITS,  13
                 ,ITS,  1
                 ,ITS,  2
                 ,ITS,  8
                 ,ITS,
                 ,NTR,  3
                 ,NTR,  2
            10 ,   UJ,
                 ,UTC,
 *00363    :     ,STI,
                 ,STI,  7
                 ,STI,  2
                 ,STI,  1
                 ,STI,  8
             8 ,   UJ,
 *00366    :,     LOG,  64377777 77777771.
 *00367    :,     LOG,  14630440 10020040.
 *00370    :,     LOG,  40000000 00000000.
 *00371    :,     LOG,  64000000 00000000.
 *00372    :,     LOG,  64000000 00000001.
 *00373    :,     LOG,  64000000 00000002.
 *00374    :,     LOG,  64000000 00000003.
 *00375    :,     LOG,  64000000 00000004.
 *00376    :,     LOG,  64000000 00000005.
            ,     LOG,  64000000 00010000.
 *00400    :,     LOG,  64000000 00000006.
 *00401    :,     LOG,  64000000 00000010.
            ,     LOG,  64000000 00000011.
 *00403    :,     LOG,  64000000 00000015.
 *00404    :,     LOG,  64000000 00000016.
            ,     LOG,  64000000 00000401.
            ,     LOG,  12420040 10020040.
            ,     LOG,  12451105 20242040.
            ,     LOG,  17244105 20242040.
 *00411    :,     LOG,  10020040 10020040.
            ,     LOG,  23646104 10020040.
            ,     LOG,  17255117 23442440.
 BSS       :     ,BSS,  10050B
       ,DATA,.  :,ENTRY,
 *00414    :,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
 *00422    :,     LOG,  10020040 10020040.
                6,SET,   *00414
                1,   ,   BSS+ 0042B
                1,SET,   *00422
                1,   ,   BSS+ 0013B
      ,END,
  LLФ ANL        :,NAME,
      PAS        :,SUBP,
      PAK        :,SUBP,
      UNP        :,SUBP,
            14 ,  VTM,   *00001
                 , UJ,   *00437
 *00001    : 7 ,  XTA,  77773B
             7 ,  ATX,  23B
                 ,NTR,  3
             7 ,  XTA,
                 ,WTC,   BSS+ 0012B
                 ,ATX,
                 ,WTC,   BSS+ 0013B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0124B
                 ,ITS,  14
            14 ,  VTM,   *00471
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      UNP
             7 ,  XTA,  21B
                 ,WTC,   BSS+ 0012B
                 ,ATX,  3
             7 ,  XTA,  77774B
                 ,ITS,
             7 ,  XTA,  77773B
            15 ,  AEX,
                 ,UZA,   *00016
                 , UJ,   *00020
                 ,UTC,
 *00016    : 7 ,  XTA,  147B
                 ,WTC,   BSS+ 0012B
                 ,ATX,  3
                 ,UTC,
 *00020    : 7 ,  XTA,  22B
             7 ,  ATX,  24B
                 ,NTR,  3
             7 ,  XTA,  77777B
                 ,ITS,
             7 ,  XTA,  77773B
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00025
                 , UJ,   *00027
 *00025    : 7 ,  XTA,  15
             7 ,  ATX,  24B
                 ,NTR,  3
                 ,NTR,  22B
 *00027    : 7 ,  XTA,  24B
                 ,ITS,
             7 ,  XTA,  147B
            15 ,  AEX,
                 ,UZA,   *00032
                 , UJ,   *00033
 *00032    :     , UJ,   *00446
                 ,UTC,
 *00033    : 7 ,  XTA,  77775B
                 ,ITS,
             7 ,  XTA,  77773B
            15 ,  AEX,
                 ,UIA,   *00036
                 , UJ,   *00037
 *00036    :     , UJ,   *00046
                 ,UTC,
 *00037    : 7 ,  XTA,  21B
                 ,ITS,
             7 ,  XTA,  147B
            15 ,  AEX,
                 ,UZA,   *00042
                 , UJ,   *00046
 *00042    : 7 ,  XTA,  10
                 ,ITS,
             7 ,  XTA,  150B
            15 ,  AEX,
                 ,UZA,   *00045
                 , UJ,   *00046
 *00045    :     , UJ,   *00446
                 ,UTC,
 *00046    : 7 ,  XTA,  21B
             7 ,  ATX,  334B
                 ,NTR,  3
             7 ,  XTA,
             7 ,  ATX,  25B
             7 ,  XTA,  77776B
                 ,ITS,
             7 ,  XTA,  77773B
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00054
                 , UJ,   *00056
 *00054    : 7 ,  XTA,  6
             7 ,  ATX,  25B
                 ,NTR,  3
                 ,NTR,  22B
 *00056    : 7 ,  XTA,  25B
                 ,NTR,  3
             7 ,  A+X,  1
             7 ,  ATX,  24B
             7 ,  XTA,  77773B
             7 ,  ATX,  27B
                 ,WTC,   BSS+ 0004B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0270B
                 ,XTA,
             7 ,  ATX,  26B
             7 ,  XTA,  21B
             7 ,  ATX,  37B
             7 ,  XTA,  1
             7 ,  ATX,  30B
             7 ,  XTA,  77775B
                 ,ITS,
             7 ,  XTA,  77773B
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00071
                 , UJ,   *00073
 *00071    : 7 ,  XTA,  2
             7 ,  ATX,  30B
                 ,NTR,  3
                 ,NTR,  22B
 *00073    : 7 ,  XTA,  30B
             7 ,  ATX,  31B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00250
                 ,UTC,
 *00076    :     ,WTC,   *00451
                 , UJ,   *00076
                 , UJ,   *00103
                 ,UTC,
                 , UJ,   *00114
                 ,UTC,
                 , UJ,   *00146
                 ,UTC,
                 , UJ,   *00146
                 ,UTC,
 *00103    : 7 ,  XTA,  13
                 ,ITS,
                 ,WTC,   BSS+ 0001B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0123B
                 ,XTA,
            15 ,  AEX,
                 ,UIA,   *00110
                 , UJ,   *00111
                 ,UTC,
 *00110    :     , UJ,   *00114
                 ,UTC,
 *00111    : 7 ,  XTA,  77776B
             7 ,  ATX,  77773B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00046
                 ,UTC,
 *00114    : 7 ,  XTA,  334B
                 ,ITS,
             7 ,  XTA,  20B
            15 ,  AEX,
                 ,UZA,   *00117
                 , UJ,   *00120
 *00117    :     , UJ,   *00146
                 ,UTC,
 *00120    :     ,WTC,   BSS+ 0001B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0123B
                 ,XTA,
                 ,ITS,
             7 ,  XTA,  20B
            15 ,  AEX,
                 ,UIA,   *00125
                 , UJ,   *00126
                 ,UTC,
 *00125    :     , UJ,   *00146
                 ,UTC,
 *00126    : 7 ,  XTA,  77775B
             7 ,  ATX,  77773B
                 ,NTR,  3
             7 ,  XTA,  20B
             7 ,  ATX,  334B
                 ,NTR,  22B
                 , UJ,   *00056
                 ,UTC,
 *00132    : 7 ,  XTA,  24B
                 ,NTR,  3
             7 ,  A-X,  12
                 ,NTR,  22B
                 ,UZA,   *00135
                 , UJ,   *00136
 *00135    :     , UJ,   *00233
                 ,UTC,
 *00136    : 7 ,  XTA,  24B
                 ,NTR,  3
             7 ,  A+X,  1
             7 ,  ATX,  24B
             7 ,  XTA,  21B
                 ,ITS,
                 ,WTC,   BSS+ 0001B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0123B
                 ,XTA,
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00145
                 , UJ,   *00146
 *00145    :     , UJ,   *00132
                 ,UTC,
 *00146    : 7 ,  XTA,
                 ,ITS,
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0310B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00153
                 , UJ,   *00154
                 ,UTC,
 *00153    :     , UJ,   *00211
                 ,UTC,
 *00154    :     ,WTC,   BSS+ 0001B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0123B
                 ,XTA,
                 ,ITS,
                 ,WTC,   BSS+ 0003B
             2 ,  VTM,
             2 ,  UTC,   BSS+ 0310B
                 ,XTA,
            15 ,  AEX,
                 ,UIA,   *00162
                 , UJ,   *00163
 *00162    :     , UJ,   *00203
                 ,UTC,
 *00163    : 7 ,  XTA,  21B
                 ,WTC,   BSS+ 0006B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0013B
                 ,ATX,
             7 ,  XTA,  31B
                 ,NTR,  3
                 ,WTC,   BSS+ 0003B
             2 ,  VTM,
             2 ,  UTC,   BSS+ 0323B
                 ,A-X,
                 ,NTR,  22B
                 ,UIA,   *00172
                 , UJ,   *00173
 *00172    :     , UJ,   *00245
                 ,UTC,
 *00173    : 7 ,  XTA,  26B
                 ,NTR,  3
             7 ,  A-X,  3
                 ,NTR,  22B
                 ,UZA,   *00176
                 , UJ,   *00200
 *00176    : 7 ,  XTA,  20B
             7 ,  ATX,  334B
                 ,NTR,  3
                 ,NTR,  22B
 *00200    : 7 ,  XTA,  26B
                 ,NTR,  3
             7 ,  A+X,  1
             7 ,  ATX,  26B
                 ,NTR,  22B
                 , UJ,   *00211
 *00203    : 7 ,  XTA,  21B
                 ,ITS,
                 ,WTC,   BSS+ 0001B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0123B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00210
                 , UJ,   *00211
                 ,UTC,
 *00210    :     , UJ,   *00132
                 ,UTC,
 *00211    : 7 ,  XTA,  77773B
             7 ,  ATX,  27B
                 ,NTR,  3
                 ,WTC,   BSS+ 0004B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0274B
                 ,XTA,
                 ,ITS,
                 ,WTC,   BSS+ 0001B
             2 ,  VTM,
             2 ,  UTC,   BSS+ 0123B
                 ,XTA,
                 ,NTR,  22B
            15 ,  AEX,
                 ,UIA,   *00221
                 , UJ,   *00222
 *00221    :     , UJ,   *00233
                 ,UTC,
 *00222    : 7 ,  XTA,  5
             7 ,  ATX,  26B
                 ,NTR,  3
             7 ,  XTA,  77776B
                 ,ITS,
             7 ,  XTA,  77773B
                 ,NTR,  22B
            15 ,  AEX,
                 ,UIA,   *00227
                 , UJ,   *00230
 *00227    :     , UJ,   *00233
                 ,UTC,
 *00230    : 7 ,  XTA,  24B
             7 ,  ATX,  25B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00056
                 ,UTC,
 *00233    :     ,WTC,   BSS+ 0001B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0123B
                 ,XTA,
                 ,WTC,   BSS+ 0006B
             2 ,  VTM,
             2 ,  UTC,   BSS+ 0013B
                 ,ATX,
             7 ,  XTA,  24B
                 ,NTR,  3
             7 ,  A-X,  12
                 ,NTR,  22B
                 ,UIA,   *00242
                 , UJ,   *00245
 *00242    : 7 ,  XTA,  24B
                 ,NTR,  3
             7 ,  A+X,  1
             7 ,  ATX,  24B
                 ,NTR,  22B
                 ,UTC,
 *00245    : 7 ,  XTA,  31B
                 ,NTR,  3
             7 ,  A+X,  1
             7 ,  ATX,  31B
                 ,NTR,  22B
                 ,UTC,
 *00250    : 7 ,  X-A,  11
                 ,UZA,   *00076
             7 ,  XTA,  1
             7 ,  ATX,  24B
                 ,NTR,  3
             7 ,  XTA,  77775B
                 ,ITS,
             7 ,  XTA,  77773B
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00256
                 , UJ,   *00260
 *00256    : 7 ,  XTA,  9
             7 ,  ATX,  24B
                 ,NTR,  3
                 ,NTR,  22B
 *00260    :14 ,  VTM,   BSS+ 0011B
                 ,ITS,  14
                 ,WTC,   BSS+ 0001B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0013B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00462
                 ,ITS,  14
            13 ,  VJM,      PAK
                 ,NTR,  3
                 ,NTR,  22B
                 ,WTC,   BSS+ 0000B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0300B
                 ,XTA,
             7 ,  ATX,  32B
                 ,NTR,  3
             1 ,  UTC,   BSS+ 0304B
                 ,XTA,
             7 ,  ATX,  33B
             7 ,  XTA,  32B
             7 ,  ATX,  31B
                 ,NTR,  22B
                 , UJ,   *00310
                 ,UTC,
 *00275    :     ,WTC,   BSS+ 0006B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0234B
                 ,XTA,
                 ,ITS,
             7 ,  XTA,  34B
            15 ,  AEX,
                 ,UZA,   *00302
                 , UJ,   *00305
                 ,UTC,
 *00302    : 7 ,  XTA,  31B
                 ,WTC,   BSS+ 0012B
                 ,ATX,
                 ,NTR,  3
                 ,NTR,  22B
                 ,UTC,
 *00305    : 7 ,  XTA,  31B
                 ,NTR,  3
             7 ,  A+X,  1
             7 ,  ATX,  31B
                 ,NTR,  22B
                 ,UTC,
 *00310    : 7 ,  X-A,  33B
                 ,UZA,   *00275
                 ,WTC,   BSS+ 0012B
                 ,XTA,
                 ,NTR,  3
             7 ,  A-X,  7
                 ,NTR,  22B
                 ,UZA,   *00315
                 , UJ,   *00317
                 ,UTC,
 *00315    : 7 ,  XTA,  77776B
             7 ,  ATX,  77773B
                 ,NTR,  3
                 ,NTR,  22B
 *00317    : 7 ,  XTA,  77773B
             7 ,  ATX,  27B
                 ,NTR,  3
             7 ,  XTA,  6
                 ,ITS,
                 ,WTC,   BSS+ 0004B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0270B
                 ,XTA,
                 ,NTR,  22B
            15 ,  AEX,
                 ,UIA,   *00326
                 , UJ,   *00332
                 ,UTC,
 *00326    :     ,WTC,   BSS+ 0013B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0014B
                 ,ITS,  14
            14 ,  VTM,   *00471
                 ,ITS,  14
            13 ,  VJM,      PAK
 *00332    : 7 ,  XTA,
                 ,ITS,
                 ,WTC,   BSS+ 0012B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00336
                 , UJ,   *00337
                 ,UTC,
 *00336    :     , UJ,   *00446
                 ,UTC,
 *00337    :     ,WTC,   BSS+ 0012B
                 ,XTA,
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  2
                 ,NTR,  22B
                 ,UIA,   *00343
                 , UJ,   *00344
 *00343    :     , UJ,   *00347
                 ,UTC,
 *00344    : 7 ,  XTA,  77774B
             7 ,  ATX,  77773B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00446
                 ,UTC,
 *00347    :     ,WTC,   BSS+ 0012B
                 ,XTA,
             7 ,  ATX,  27B
                 ,NTR,  3
                 ,WTC,   BSS+ 0004B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0252B
                 ,XTA,
             7 ,  ATX,  31B
             7 ,  XTA,  4
                 ,ITS,
                 ,WTC,   BSS+ 0012B
                 ,XTA,
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00360
                 , UJ,   *00362
                 ,UTC,
 *00360    : 7 ,  XTA,  77777B
             7 ,  ATX,  77773B
                 ,NTR,  3
                 ,NTR,  22B
 *00362    : 7 ,  XTA,  4
                 ,ITS,
                 ,WTC,   BSS+ 0012B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00366
                 , UJ,   *00370
                 ,UTC,
 *00366    : 7 ,  XTA,  21B
                 ,WTC,   BSS+ 0012B
                 ,ATX,  3
                 ,UTC,
 *00370    :     ,WTC,   BSS+ 0001B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0013B
                 ,XTA,
             7 ,  ATX,  34B
                 ,NTR,  3
             7 ,  XTA,  77775B
                 ,ITS,
             7 ,  XTA,  77773B
                 ,NTR,  22B
            15 ,  AEX,
                 ,UIA,   *00377
                 , UJ,   *00400
                 ,UTC,
 *00377    :     , UJ,   *00410
                 ,UTC,
 *00400    : 7 ,  XTA,  20B
             7 ,  ATX,  34B
                 ,NTR,  3
             7 ,  XTA,  3
                 ,ITS,
                 ,WTC,   BSS+ 0012B
                 ,XTA,
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00406
                 , UJ,   *00410
                 ,UTC,
 *00406    : 7 ,  XTA,  2
             7 ,  ATX,  31B
                 ,NTR,  3
                 ,NTR,  22B
 *00410    :14 ,  VTM,   BSS+ 0124B
                 ,ITS,  14
                 ,WTC,   BSS+ 0006B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0013B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00466
                 ,ITS,  14
            13 ,  VJM,      PAK
             7 ,  XTA,  3
                 ,ITS,
                 ,WTC,   BSS+ 0012B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00421
                 , UJ,   *00423
                 ,UTC,
 *00421    : 7 ,  XTA,  14
             7 ,  ATX,  34B
                 ,NTR,  3
                 ,NTR,  22B
 *00423    :14 ,  VTM,   *00457
                 ,ITS,  14
                 ,WTC,   BSS+ 0012B
            14 ,  VTM,  1
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0124B
                 ,ITS,  14
            14 ,  VTM,   *00460
                 ,ITS,  14
            13 ,  VJM,      PAS
            14 ,  VTM,   *00461
                 ,ITS,  14
                 ,WTC,   BSS+ 0012B
            14 ,  VTM,  2
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0011B
                 ,ITS,  14
            14 ,  VTM,   *00457
                 ,ITS,  14
            13 ,  VJM,      PAS
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00446
                 ,UTC,
 *00437    : 7 ,  MTJ,  8
            14 ,  MTJ,  10
             7 ,  VTM,   *00456
             7 ,  STX,  36B
             7 ,  STX,  35B
                 ,ITS,  13
                 ,ITS,  1
                 ,ITS,  2
                 ,ITS,  8
                 ,ITS,
                 ,NTR,  3
                 ,NTR,  2
            10 ,   UJ,
                 ,UTC,
 *00446    :     ,STI,
                 ,STI,  7
                 ,STI,  2
                 ,STI,  1
                 ,STI,  8
             8 ,   UJ,
 *00451    :,     LOG,  64000000 00000001.
            ,     LOG,  64000000 00000001.
            ,     LOG,  64000000 00000002.
            ,     LOG,  64000000 00000003.
            ,     LOG,  64000000 00000004.
 *00456    :,     LOG,  64000000 00000000.
 *00457    :,     LOG,  64000000 00000001.
 *00460    :,     LOG,  64000000 00000002.
 *00461    :,     LOG,  64000000 00000003.
 *00462    :,     LOG,  64000000 00000004.
            ,     LOG,  64000000 00000005.
            ,     LOG,  64000000 00000006.
            ,     LOG,  64000000 00000007.
 *00466    :,     LOG,  64000000 00000010.
            ,     LOG,  64000000 00000016.
            ,     LOG,  11620040 10020040.
 *00471    :,     LOG,  64000000 00000110.
            ,     LOG,  64000000 00000111.
            ,     LOG,  12020040 10020040.
            ,     LOG,  10042440 10020040.
            ,     LOG,  12420040 10020040.
            ,     LOG,  16420040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  20620040 10020040.
 BSS       :     ,BSS,  337B
       ,DATA,.  :,ENTRY,
 *00501    :,     LOG,  64000000 00000004.
            ,     LOG,  64000000 00000002.
            ,     LOG,  64000000 00000002.
            ,     LOG,  64000000 00000001.
 *00505    :,     LOG,  64000000 00000016.
            ,     LOG,  64000000 00000003.
            ,     LOG,  64000000 00000003.
            ,     LOG,  64000000 00000001.
 *00511    :,     LOG,  64000000 00000006.
            ,     LOG,  64000000 00000001.
            ,     LOG,  64000000 00000006.
            ,     LOG,  64000000 00000010.
 *00515    :,     LOG,  12420040 10020040.
            ,     LOG,  17220040 10020040.
            ,     LOG,  11020040 10020040.
            ,     LOG,  11620040 10020040.
 *00521    :,     LOG,  22644143 11020040.
            ,     LOG,  21247104 10020040.
            ,     LOG,  21247124 24420040.
            ,     LOG,  12441105 23220040.
            ,     LOG,  23440515 21220040.
            ,     LOG,  24652502 24020040.
            ,     LOG,  24051117 21620040.
            ,     LOG,  24652502 24420040.
            ,     LOG,  21452516 20620040.
            ,     LOG,  22247124 21220040.
            ,     LOG,  24442501 23020040.
            ,     LOG,  20447517 23020040.
            ,     LOG,  21047525 20420040.
 *00536    :,     LOG,  64000000 00000000.
            ,     LOG,  64000000 00000000.
            ,     LOG,  64000000 00000006.
            ,     LOG,  64000000 00000007.
            ,     LOG,  64000000 00000002.
            ,     LOG,  64000000 00000023.
            ,     LOG,  64000000 00000010.
            ,     LOG,  64000000 00000013.
            ,     LOG,  64000000 00000011.
            ,     LOG,  64000000 00000020.
            ,     LOG,  64000000 00000015.
            ,     LOG,  64000000 00000020.
            ,     LOG,  64000000 00000030.
 *00553    :,     LOG,  10020040 10020040.
 *00554    :,     LOG,  16420040 10020040.
            ,     LOG,  13020040 10020040.
            ,     LOG,  13020040 10020040.
            ,     LOG,  13420040 10020040.
            ,     LOG,  64000000 00000000.
            ,     LOG,  12020040 10020040.
            ,     LOG,  64000000 00000000.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  64000000 00000000.
 *00567    :,     LOG,  64000000 00000012.
            ,     LOG,  64000000 00000015.
            ,     LOG,  64000000 00000022.
            ,     LOG,  64000000 00000032.
            ,     LOG,  64000000 00000000.
            ,     LOG,  64000000 00000043.
            ,     LOG,  64000000 00000000.
            ,     LOG,  64000000 00000010.
            ,     LOG,  64000000 00000016.
            ,     LOG,  64000000 00000026.
            ,     LOG,  64000000 00000000.
                4,SET,   *00501
                1,   ,   BSS+ 0301B
                4,SET,   *00505
                1,   ,   BSS+ 0305B
                4,SET,   *00511
                1,   ,   BSS+ 0271B
                4,SET,   *00515
                1,   ,   BSS+ 0275B
               13,SET,   *00521
                1,   ,   BSS+ 0235B
               13,SET,   *00536
                1,   ,   BSS+ 0253B
                1,SET,   *00553
                1,   ,   BSS+ 0234B
               11,SET,   *00554
                1,   ,   BSS+ 0311B
               11,SET,   *00567
                1,   ,   BSS+ 0324B
      ,END,
  LLФ MIN:,NAME,
 B :11 ,BASE,B
                 ,STI,  14
                 ,STI,  12
                 ,ATI,  10
            14 ,  WTC,
            10 ,  XTA,  77777B
  ,AEX,= 7777 7777 7777 7777
            12 ,  WTC,
            10 ,  ARX,  77777B
                 ,UZA,   *00047
            14 ,  XTA,
            12 ,  ATX,
 *00047    :     ,STX,
            13 ,   UJ,
      ,END,
   LLФ PRI       :,NAME,
      DATA*      :,LC,  1
      PRINT8//   :,SUBP,
      LIMWR*     :,LC,  1
                 ,ATI,  10
            10 ,  XTA,
                 , UJ,  PRINT8//
                 ,UTC,
    LLФ PAG     :,ENTRY,
                 ,XTA,
L                , UJ,   PRINT8//  +2
    LLФ DAT     :,ENTRY,
                 ,ATI,  10
                 ,XTA,  DATA*
            10 ,  ATX,
L                ,XTA,   DATA*     +1
            10 ,  ATX,  1
                 ,STX,
            13 ,   UJ,
                 ,UTC,
    LLФ IFC     :,ENTRY,
 *00007    :11 ,  VTM,   *00007
                 ,NTR,  3
                 ,X-A,
                 ,STI,  12
                 ,ATI,  10
            10 ,  J+M,  12
                 ,NTR,  6
                 ,XTA,
 *00013    :10 ,  AOX,
            10 ,  UTM,  1
            12 ,  VLM,   *00013
            11 ,  AEX,  21B
                 ,UZA,   *00016
            11 ,  XTA,  25B
 *00016    :11 ,  AOX,  24B
            13 ,   UJ,
   LLФ EOP      :,ENTRY,
                 ,XTA,
L                , UJ,   PRINT8//  +1
    LLФ ZON     :,ENTRY,
 *00020    :11 ,  VTM,   *00020
                 ,ATI,  10
                 ,UTC,  LIMWR*
                 ,XTA,  1
            11 ,  ARX,  13
            11 ,  APX,  13
            10 ,  XTS,
            11 ,  APX,  10
            15 ,  ARX,
            11 ,  AUX,  10
            11 ,  AOX,  9
            10 ,  XTS,
            11 ,  AAX,  14
            15 ,  AOX,
            13 ,   UJ,
                 ,UTC,
 *00030    :,     LOG,  10020040 10020040.
            ,     LOG,  00000060 14030040.
            ,     LOG,  00000007 01603400.
            ,     LOG,  64000000 00000000.
            ,     LOG,  64000000 00000001.
            ,     LOG,  00000000 00000777.
            ,     LOG,  77777400 00000000.
 BSS       :     ,BSS,
      ,END,
  LLФ PRN        :,NAME,
      *HEAD*     :,LC,  15
      FT*611     :,SUBP,
      FT*002     :,SUBP,
      FT*003     :,SUBP,
  LLФ IFC        :,SUBP,
  LLФ PRI        :,SUBP,
  LLФ DAT        :,SUBP,
  LLФ PAG        :,SUBP,
      I*MU*I     :,SUBP,
      I*DI*I     :,SUBP,
LL252:,EQU,        *HEAD*    +2
C---------
  IFC:,EQU,LLФ IFC
  PRIN:,EQU,LLФ PRI
  DATA:,EQU,LLФ DAT
  PAGE:,EQU,LLФ PAG
C---------
            14 ,  VTM,   *00001
                 , UJ,   *00166
 *00001    : 7 ,  XTA,  1
                 ,ITS,
                 ,UTC,  *HEAD*
                 ,XTA,
            15 ,  AEX,
                 ,UIA,   *00005
                 , UJ,   *00006
                 ,UTC,
 *00005    :     , UJ,   *00165
                 ,UTC,
L*00006    :     ,UTC,   *HEAD*    +12
                 ,XTA,
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  6
                 ,NTR,  22B
                 ,UIA,   *00012
                 , UJ,   *00015
 *00012    : 7 ,  XTA,  6
L                ,UTC,   *HEAD*    +12
                 ,ATX,
                 ,NTR,  3
                 ,NTR,  22B
                 ,UTC,
L*00015    :     ,UTC,   *HEAD*    +13
                 ,XTA,
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  7
                 ,NTR,  22B
                 ,UIA,   *00021
                 , UJ,   *00024
 *00021    : 7 ,  XTA,  7
L                ,UTC,   *HEAD*    +13
                 ,ATX,
                 ,NTR,  3
                 ,NTR,  22B
                 ,UTC,
L*00024    :     ,UTC,   *HEAD*    +12
                 ,XTA,
             7 ,  ATX,  10
                 ,NTR,  3
             7 ,  XTA,  1
             7 ,  ATX,  11
                 ,WTC,   BSS+ 0010B
                 ,XTA,
             7 ,  ATX,  12
             7 ,  XTA,  1
             7 ,  ATX,  13
                 ,NTR,  22B
L*00032    :     ,UTC,   *HEAD*    +1
                 ,XTA,
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  1
                 ,NTR,  22B
                 ,UIA,   *00036
                 , UJ,   *00037
 *00036    :     , UJ,   *00072
                 ,UTC,
 *00037    : 7 ,  XTA,  77773B
                 ,NTR,  3
             7 ,  A-X,  1
             7 ,  ATX,  77773B
                 ,NTR,  22B
            13 ,  VJM,      PAGE
            14 ,  VTM,   *00211
                 ,ITS,  14
            14 ,  VTM,   *00203
                 ,ITS,  14
L           14 ,  VTM,   L252     +4
                 ,ITS,  14
            13 ,  VJM,  FT*611
                 ,NTR,  3
            14 ,  VTM,   *00200
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,  FT*002
                 ,NTR,  3
                 ,NTR,  22B
            13 ,  VJM,  FT*003
L           14 ,  VTM,   L252     +6
                 ,ITS,  14
            13 ,  VJM,      DATA
            14 ,  VTM,   L252
                 ,ITS,  14
L           14 ,  VTM,   L252     +9
                 ,ITS,  14
            14 ,  VTM,   *00207
                 ,ITS,  14
            13 ,  VJM,      PRIN
            14 ,  VTM,   *00201
                 ,ITS,  14
            14 ,  VTM,   *00201
                 ,ITS,  14
            14 ,  VTM,   *00206
                 ,ITS,  14
            13 ,  VJM,      PRIN
                 ,NTR,  3
                 ,NTR,  22B
L                ,UTC,   *HEAD*    +14
                 ,XTA,
                 ,NTR,  3
             7 ,  A-X,  2
L                ,UTC,   *HEAD*    +1
                 ,ATX,
                 ,NTR,  22B
                 ,UTC,
 *00072    : 7 ,  XTA,  12
                 ,NTR,  3
             7 ,  A-X,  11
             7 ,  A+X,  1
             7 ,  ATX,  9
             7 ,  XTA,  4
            14 ,  VTM,   BSS+ 0000B
            13 ,  VJM,  I*MU*I
             7 ,  A+X,  10
             7 ,  A-X,  1
             7 ,  ATX,  14
             7 ,  XTA,
             7 ,  ATX,  15
             7 ,  XTA,  14
                 ,X-A,
             7 ,  A+X,  8
                 ,NTR,  22B
                 ,UIA,   *00104
                 , UJ,   *00110
                 ,UTC,
 *00104    : 7 ,  XTA,  14
                 ,NTR,  3
             7 ,  A-X,  8
             7 ,  A+X,  3
            14 ,  VTM,   *00211
            13 ,  VJM,  I*DI*I
             7 ,  ATX,  15
                 ,NTR,  22B
 *00110    : 7 ,  XTA,  12
                 ,NTR,  3
             7 ,  A-X,  15
             7 ,  ATX,  12
                 ,WTC,   BSS+ 0002B
             1 ,  VTM,
                 ,WTC,   BSS+ 0007B
             1 ,  UTC,  77777B
            14 ,  VTM,
                 ,ITS,  14
                 ,WTC,   BSS+ 0003B
             2 ,  VTM,
                 ,WTC,   BSS+ 0007B
             2 ,  UTC,  77777B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0001B
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      PRIN
                 ,NTR,  3
                 ,NTR,  22B
L                ,UTC,   *HEAD*    +1
                 ,XTA,
                 ,NTR,  3
             7 ,  A-X,  1
L                ,UTC,   *HEAD*    +1
                 ,ATX,
             7 ,  XTA,  15
                 ,X-A,
             7 ,  A+X,
                 ,NTR,  22B
                 ,UZA,   *00131
                 , UJ,   *00132
 *00131    :     , UJ,   *00165
                 ,UTC,
 *00132    : 7 ,  XTA,  12
                 ,NTR,  3
             7 ,  A+X,  1
             7 ,  ATX,  11
             7 ,  XTA,  12
             7 ,  A+X,  15
             7 ,  ATX,  12
                 ,WTC,   BSS+ 0002B
             1 ,  VTM,
                 ,WTC,   BSS+ 0007B
             1 ,  UTC,  77777B
            14 ,  VTM,
                 ,ITA,  14
                 ,WTC,   BSS+ 0003B
             2 ,  VTM,
                 ,WTC,   BSS+ 0007B
             2 ,  UTC,  77777B
            14 ,  VTM,
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      IFC
                 ,ASN,  71B
                 ,UZA,   *00165
                 ,ARX,
                 ,UZA,   *00165
L                ,UTC,   *HEAD*    +13
                 ,XTA,
             7 ,  ATX,  10
                 ,NTR,  3
             7 ,  XTA,  13
                 ,NTR,  3
             7 ,  A+X,  1
             7 ,  ATX,  13
             7 ,  X-A,  5
                 ,NTR,  22B
                 ,UZA,   *00032
            14 ,  VTM,   *00202
                 ,ITS,  14
            14 ,  VTM,   *00202
                 ,ITS,  14
            14 ,  VTM,   *00206
                 ,ITS,  14
            13 ,  VJM,      PRIN
                 ,NTR,  3
                 ,NTR,  22B
L                ,UTC,   *HEAD*    +1
                 ,XTA,
                 ,NTR,  3
             7 ,  A-X,  1
L                ,UTC,   *HEAD*    +1
                 ,ATX,
                 ,NTR,  22B
                 ,UTC,
 *00165    :     , UJ,   *00175
                 ,UTC,
 *00166    : 7 ,  MTJ,  8
            14 ,  MTJ,  10
             7 ,  VTM,   *00205
             7 ,  STX,  21B
             7 ,  STX,  20B
                 ,ITS,  13
                 ,ITS,  1
                 ,ITS,  2
                 ,ITS,  8
                 ,ITS,
                 ,NTR,  3
                 ,NTR,  2
            10 ,   UJ,
                 ,UTC,
 *00175    :     ,STI,
                 ,STI,  7
                 ,STI,  2
                 ,STI,  1
                 ,STI,  8
             8 ,   UJ,
 *00200    :,     LOG,  64000000 00000000.
 *00201    :,     LOG,  10020040 10020040.
 *00202    :,     LOG,  23675456 24051116.
 *00203    :,     LOG,  12044465 13030510.
            ,     LOG,  13224440 10020040.
 *00205    :,     LOG,  64000000 00000000.
 *00206    :,     LOG,  64000000 00000001.
 *00207    :,     LOG,  64000000 00000002.
            ,     LOG,  64000000 00000005.
 *00211    :,     LOG,  64000000 00000006.
            ,     LOG,  64000000 00000003.
            ,     LOG,  64000000 00000050.
            ,     LOG,  64000000 00000062.
            ,     LOG,  64000000 00000076.
 BSS       :     ,BSS,  9
       ,DATA,.  :,ENTRY,
 *00216    :,     LOG,  64000000 00000001.
 *00217    :,     LOG,  64000000 00000001.
 *00220    :,     LOG,  64000000 00000102.
 *00221    :,     LOG,  64000000 00000002.
 *00222    :,     LOG,  64000000 00000043.
 *00223    :,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
                1,SET,   *00216
                1,   ,  *HEAD*
                1,SET,   *00217
L               1,   ,   *HEAD*    +1
                1,SET,   *00220
L               1,   ,   *HEAD*    +14
                1,SET,   *00221
L               1,   ,   *HEAD*    +12
                1,SET,   *00222
L               1,   ,   *HEAD*    +13
               10,SET,   *00223
                1,   ,   L252
      ,END,
  LOAD:,NAME,
C*
C*********** 12.3.80. A.П.CAПOЖHИKOB
C*
C*     FUNCTION LOAD(NAME)
C*    ЗAГPYЗKA PAЗДEЛA БEЗ ПEPEДAЧИ
C*    YПPABBЛEHИЯ.  NAME - ИMЯ PAЗДEЛA
C*    ( 2 CЛOBBBA B KOДE ISO )
C*    PEЗYЛЬTAT - AДPEC HAЧAЛA PAЗДEЛA
C*    ИЛИ 0, ECЛИ OH OTCYTCTBYET.
C*
C*     LOAD( 0 ) - OTKAЗ OT ПOCЛEДHEГO
C*    ЗAГPYЖEHHOГO PAЗДEЛA. PEЗYЛЬTAT-
C*    -AДPEC CBOБOДHOГO MECTA ПAMЯTИ.
C*    ИЛИ 0, ECЛИ OTKAЗ HEЗAKOHHЫЙ.
C*
C*    ПOPTЯTCЯ PEГИCTPЫ: 8,9,10,14
C*
C*
  A/I0:,LC,1
  LOADANGO:,SUBP,
  POIN:,EQU,LOADANGO+21B
C*
C****  ЦEHHAЯ ИHФOPMAЦИЯ O CTPYKTYPE
C*     CЛYЖEБHЫX CЛOB PAЗДEЛA :
C*
C*    0 - ИMЯ PAЗДEЛA
C*    1 - KOПИЯ 16 ЯЧEЙKИ  ДO ЗAГPYЗKИ
C*    2 - --"-- 17  --"--   --"--
C*    3 - AДPEC BOЗBBPATA ИЗ PAЗДEЛA
C*    4 - BBOЗBPAT B LOADGO
C*    5 - KOПИЯ 16 ЯЧEЙKИ ПOCЛE ЗAГPYЗKИ
C*    6 - --"-- 17  --"--   --"--
C*    7 - AДPEC BXOДA B PAЗДEЛ
C*
C*   MЫ BOCПOЛЬЗOBAЛИCЬ CTAPШИMИ PAЗPЯДAMИ
C*   7-ГO CЛOBA ДЛЯ XPAHEHИЯ CCЫЛKИ HA
C*   HAЧAЛO ПPEДЫДYЩEГO PAЗДEЛA.
C*
C
C
C
  8,BASE,*
  ,ATI,14
  14,XTS,
  ,AEX,A/I0
  ,UZA,KILL
  13,MTJ,9
  ,ITA,14
  ,CALL,ISOTEX
  ,XTS,20B
  ,ATX,COPY20
  ,XTA,NEW20
  ,CTX,20B
  ,XTA,UJ
  ,CTX,POIN
  15,XTA,
  ,UJ,LOADANGO
C---
  UJ:14,MTJ,10
  ,UJ,IS
  NEW20:10,VTM,
  ,UJ,IS
  OLD:14,WTC,7
  ,UJ,
C---
  IS:,XTA,COPY20
  ,CTX,20B
  ,XTA,OLD
  ,CTX,POIN
  ,XTA,
  10,VZM,RET
  ,XTA,AP
  ,ITS,10
  ,STX,AP
  ,ASN,64-24
  10,AOX,7
  10,ATX,7
  10,XTA,7
  ,AAX,=77777
  RET:,AOX,A/I0
  9,UJ,
C---
  KILL:,XTA,AP
  ,STI,14
  ,XTA,
  14,VZM,RET1
  14,XTA,7
  ,ASN,64+24
  ,ATX,AP
  14,XTA,1
  ,ATX,16B
  14,XTA,2
  ,ATX,17B
  ,AAX,=77777
  ,WTC,17B
  ,ATX,
  RET1:,BSS,
  ,AOX,A/I0
  13,UJ,
  COPY20:,BSS,1
  AP:,BSS,1
  ,END,
  LREGIM:,NAME,
C*
C*********  29.10.82    A.П.CAПOЖHИKOB
C*
C*       FUNCTION LREGIM(N)
C*   CMEHA PEЖИMA ПEЧATИ ЛИCTИHГA
C*
C*   ПPИ N=1 YCTAHABЛИBAETCЯ PEЖИM *NO LIST
C*   ПPИ N=2   ---"---   *STANDARD LIST
C*   ПPИ N=4   ---"---   *FULL LIST
C*   ПPИ N=0 PEЖИM HE MEHЯETCЯ, A KOД PEЖИMA
C*           (1,2 ИЛИ 4) BЫДAETCЯ B KAЧECTBE
C*           ЗHAЧEHИЯ ФYHKЦИИ LREGIM.
C*
C*   ПOPTИTCЯ TOЛЬKO 14 PEГИCTP.
C*
  NOLISFL*:,LC,1
  FULISFL*:,LC,1
  FLAGS   :,LC,1
  A/I0    :,LC,1
  B:,ATI,14
  14,XTA,
  14,BASE,B
  ,AEX,A/I0
  ,UZA,GET ONLY
  ,AEX,FLAGS
  ,AAX,=7
  ,AEX,FLAGS
  ,ATX,FLAGS
  ,AAX,=1
  ,ATX,NOLISFL*
  ,XTA,FLAGS
  ,ASN,64+2
  ,AAX,=1
  ,ATX,FULISFL*
  GET ONLY:,XTA,FLAGS
  ,AAX,=7
  :,U1A,*+1
  ,XTA,=2
  :,AOX,A/I0
  13,UJ,
  ,END,
  LSHIFT:,NAME,
C*
C**********************************
C*
C*   ЭЛEMEHTAPHЫE ЛOГИЧECKИE OПEPAЦИИ
C*
C*   FUNCTION LSHIFT(KOD,N)
C*   ЛOГИЧECKИЙ CДBИГ KOD HA  N PAЗPЯДOB
C*   BПPABO ПPИ N>0, BЛEBO ПPИ N<0.
C*
C*   FUNCTION LAND(KOD,MASK)
C*   ЛOГИЧECKOE ПPOИЗBEДEHИE KOD И MASK.
C*
C*   FUNCTION LOR(KOD1,KOD2)
C*   ЛOГИЧECKAЯ CYMMA KOD1 И KOD2.
C*
C*    FUNCTION LEXOR(KOD1,KOD2)
C*    OПEPAЦИЯ "ИCKЛЮЧAЮЩEE ИЛИ"
C*
C*    FUNCTION LCADD(KOD1,KOD2)
C*    ЦИKЛИЧECKOE CЛOЖEHИE
C*
C*    FUNCTION LPACK(KOD,MASK)
C*    OПEPAЦИЯ "CБOPKA" KOD ПO MASK
C*
C*    FUNCTION LUNP(KOD,MASK)
C*    OПEPAЦИЯ "PAЗБOPKA" KOD ПO MASK
C*
C*    FUNCTION LCNT(WORD)
C*    BЫДAЧA ЧИCЛA "1" B WORD (0,1,..,48)
C*
C*    FUNCTION LFIR(WORD)
C*    BЫДAЧA HOMEPA CTAPШEЙ "1" B WORD
C*    0-ПYCTO, 1-"1" B 48 PAЗPЯДE,
C*    2-47, 3-46, ... , 48-"1" B 1 PAЗP.
C*
C*    FUNCTION LBPUT(WORD,N)
C*    YCTAHOBKA B "1"  N-ГO БИTA CЛOBA
C*    WORD.  N=1,2,...,48  - COOTBETCTBYET
C*    БИTAM 48,47,...,1 CЛOBA WORD.
C*    PEЗYЛЬTAT HA CYMMATOPE И B WORD.
C*
C*    FUNCTION LBCLE(WORD,N)
C*    ГAШEHИE N-ГO БИTA CЛOBA WORD.
C*    PEЗYЛЬTAT HA CYMMATOPE И B WORD.
C*
C*    FUNCTION LBGET(WORD,N)
C*    BЫДAЧA HA CYMMATOP
C*    N-ГO БИTA CЛOBA WORD.
C*
C***************************************
C*
  :,UTC,1
  LPACK:,ENTRY,
  ,UTC,1
  LUNP:,ENTRY,
  ,UTC,1
  LAND:,ENTRY,
  :,UTC,1
  LOR:,ENTRY,
 :,UTC,1
 LEXOR:,ENTRY,
  :,UTC,1
  LCADD:,ENTRY,
  :14,VTM,
  ,STI,12
  ,ATI,11
  11,XTA,
  14,UJ,SW
  LCNT:,ENTRY,
  A/I0:,LC,1
  ,ATI,14
  14,XTA,
  ,ACX,A/I0
  13,UJ,
  LFIR:,ENTRY,
  ,ATI,14
  14,XTA,
  :,UZA,*+1
  ,ANX,
  :,AOX,A/I0
  13,UJ,
  SW:,BSS,
  :12,ARX,
  13,UJ,
  :12,AEX,
  13,UJ,
  :12,AOX,
  13,UJ,
  :12,AAX,
  13,UJ,
  :12,AUX,
  13,UJ,
  :12,APX,
  13,UJ,
  :12,WTC,
  ,ASN,64
  13,UJ,
  LBCLE:,ENTRY,
  ,UTC,1
  LBPUT:,ENTRY,
  ,UTC,1
  LBGET:,ENTRY,
  14,VTM,
  ,STI,12
  ,ATI,11
  10,VTM,40000B
  ,ITA,10
  12,WTC,
  ,ASN,64-34
  14,UJ,LBSW
  LBSW:11,AAX,
  13,UJ,
  :11,AOX,
  ,UJ,PW
  :11,AAX,
   11,AEX,
  PW:11,ATX,
  13,UJ,
  ,END,
  MAKTIT:,NAME,
C*
C****************************************
C*
C*   SUBROUTINE MAKTIT ( T, M, L )
C*   ПOЛYЧEHИE B MACCИBE  M  ИЗOБPAЖEHИЯ
C*   БOЛЬШИMИ БYKBAMИ TEKCTOBOЙ CTPOKИ
C*   T  ДЛИHOЙ 18 CИMBOЛOB ISO.
C*   AHAЛOГ П/П  BIGTIT  (CM. Y MAЗHOГO)
C*   HO БEЗ ПEЧATИ ИЗOБPAЖEHИЯ.
C*
C*   B BЫЗЫBAЮЩEЙ ПPOГPAMME ДOЛЖHЫ БЫTЬ
C*   OПИCAHЫ:   DIMENSION T(3),M(18,8)
C*   L - ПPOCTAЯ ПEPEMEHHAЯ, COДEPЖИT
C*   6 CИMBOЛOB ISO, KAЖДЫЙ ИЗ KOTOPЫX
C*   ПOПAДAET B COOTBETCTBYЮЩИЙ CTOЛБEЦ
C*   ИЗOБPAЖEHИЯ KAЖДOГO ИЗ CИMBOЛOB T.
C*
C*   ПOЛYЧEHHOE B  M  ИЗOБPAЖEHИE
C*   CTPOKИ  T  MOЖHO OTПEЧATATЬ TAK:
C*         DO 1 I=1,8
C*     1   PRINT 2,(M(J,I),J=1,18)
C*     2   FORMAT( 1X,18A6 )
C*
C**************************************
C*
  SUBTEXT:,LP,18
  SUBVIK:,LP,18
  BUFVIK:,LP,18
            9,  VTM  ,M                   .
  ,ATI,14
  14,XTA,
            9,  STX  ,DTEXT-M             .
            9,  STX  ,VALIK-M             .
  ,ATI,8
  *P1    : 14,  VTM  ,-2                  .
           10,  VTM  ,SUBTEXT             .
  *1410  :  8,  UTC  ,                    .
           14,  XTA  ,2                   .
            9,  ATX  ,*LOC-M              .
           11,  VTM  ,48-8                .
           12,  VTM  ,-5                  .
  *1112  :  9,  XTA  ,*LOC-M              .
           11,  ASN  ,64                  .
            9,  AAX  ,*W177M-M            .
           10,  UTC  ,                    .
           12,  ATX  ,5                   .
           11,  UTM  ,-8                  .
           12,  VLM  ,*1112               .
           10,  UTM  ,6                   .
           14,  VLM  ,*1410               .
  11,VTM,-17
  *P2:11,WTC,SUBTEXT+17
             ,  UTC  ,-32                 .
            9,  XTA  ,*VIKROI-M           .
           11,  UTC  ,BUFVIK              .
             ,  ATX  ,17                  .
  11,VLM,*P2
  *P3    : 11,  VTM  ,-7                  .
           12,  VTM  ,                    .
         : 10,  VTM  ,-17                 .
  *P3A   : 10,  UTC  ,BUFVIK              .
             ,  XTA  ,17                  .
           12,  ASN  ,64                  .
            9,  AAX  ,*M77W-M             .
  *P3B   :  9,  AUX  ,*AUX-M              .
            9,  ATX  ,*LOC-M              .
            9,  ARX  ,*LOC-M              .
            9,  AOX  ,*LOC-M              .
            9,  ATX  ,*LOC-M              .
             ,  ASN  ,64-2                .
            9,  AOX  ,*LOC-M              .
            9,  ATX  ,*LOC-M              .
             ,  ASN  ,64-4                .
            9,  AOX  ,*LOC-M              .
           10,  UTC  ,SUBVIK              .
             ,  ATX  ,17                  .
           10,  VLM  ,*P3A                .
  10,VTM,-17
  *P3C:9,XTA,DTEXT-M
           10,  UTC  ,SUBVIK              .
             ,  AAX  ,17                  .
           10,  UTC  ,SUBVIK              .
             ,  XTS  ,17                  .
            9,  AEX  ,*M7M-M              .
            9,  AAX  ,*BLAN-M             .
           15,  AOX  ,                    .
           10,  UTC  ,SUBVIK              .
             ,  ATX  ,17                  .
  10,VLM,*P3C
  ,WTC,CON
          14,  VTM  ,                     .
           10,  VTM  ,-17                 .
 *V:,UTC,SUBVIK+17
 10,XTA,
             ,  WTC  ,VALIK               .
           10,  UTC  ,                    .
           14,  ATX  ,17                  .
           10,  VLM  ,*V                  .
            9,  XTA  ,CON-M               .
            9,  ARX  ,*18V-M              .
            9,  ATX  ,CON-M               .
         : 12,  UTM  ,-6                  .
           11,  VLM  ,*P3+1                .
     *P:,XTA,
    9,STX,CON-M
  13,UJ,
  M      :   ,  OCT  ,                    .
  CON    :   ,  OCT  ,
  VALIK  :   ,  OCT  ,
  *18V   :   ,  OCT  ,0000000000000022
  *LOC   :   ,  OCT  ,                    .
 *M7M    :   ,  OCT  ,7777777777777777    .
 *W177M  :   ,  OCT  ,0000000000000177    .
 *M77W   :   ,  OCT  ,77                  .
  *AUX   :   ,  OCT  ,0020040100200401    .
 *BLAN   :   , 8TEXT ,''      ''          .
 DTEXT   :   ,  OCT  ,                    .
 *VIKROI :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,1010101010001000    .
         :   ,  OCT  ,4444000000000000    .
         :   ,  OCT  ,4644645444444400    .
         :   ,  OCT  ,2214222214220000    .
         :   ,  OCT  ,0002241024400000    .
         :   ,  OCT  ,1024241024340200    .
         :   ,  OCT  ,1410000000000000    .
         :   ,  OCT  ,0410202020100400    .
 :,OCT,1004020202041000
         :   ,  OCT  ,0000245224000000    .
         :   ,  OCT  ,0000103410000000    .
         :   ,  OCT  ,0000000000003020    .
         :   ,  OCT  ,0000003400000000    .
         :   ,  OCT  ,0000000000303000    .
         :   ,  OCT  ,0000041020000000    .
         :   ,  OCT  ,3442424242423400    .
         :   ,  OCT  ,0414240404041600    .
         :   ,  OCT  ,3442020410207600    .
         :   ,  OCT  ,7604100402423400    .
         :   ,  OCT  ,0206122242760200    .
         :   ,  OCT  ,7440740202423400    .
         :   ,  OCT  ,3440744242423400    .
         :   ,  OCT  ,7642020410202000    .
         :   ,  OCT  ,3442241024423400    .
         :   ,  OCT  ,3442424236023400    .
         :   ,  OCT  ,0014140000141400    .
         :   ,  OCT  ,0030300000003020    .
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,0000340034000000    .
         :   ,  OCT  ,0010040204100000    .
  :,OCT,1422220204000400
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,3442424242764200    .
         :   ,  OCT  ,7444704442427400    .
         :   ,  OCT  ,3640404040403600    .
         :   ,  OCT  ,7044424242427400    .
         :   ,  OCT  ,7440704040407600    .
         :   ,  OCT  ,7640744040404000    .
         :   ,  OCT  ,3442404046423400    .
         :   ,  OCT  ,4242764242424200    .
         :   ,  OCT  ,3410101010103400    .
         :   ,  OCT  ,1602020202423400    .
         :   ,  OCT  ,4450605044424200    .
         :   ,  OCT  ,4040404040407600    .
         :   ,  OCT  ,4266525242424200    .
         :   ,  OCT  ,4262524642424200    .
         :   ,  OCT  ,3442424242423400    .
         :   ,  OCT  ,7442424274404000    .
         :   ,  OCT  ,3442424252463402    .
         :   ,  OCT  ,7442427450444200    .
         :   ,  OCT  ,3440340202423400    .
         :   ,  OCT  ,7610101010101000    .
         :   ,  OCT  ,4242424242423400    .
         :   ,  OCT  ,4242424242241000    .
         :   ,  OCT  ,4242424252522400    .
         :   ,  OCT  ,4224102442424200    .
         :   ,  OCT  ,4242422410101000    .
         :   ,  OCT  ,7602041020407600    .
 :,OCT,3020202020203000
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,0602020202020600    .
         :   ,  OCT  ,0000001024420000    .
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,4452725252524400    .
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,7640744242427400    .
         :   ,  OCT  ,4242424242427602    .
         :   ,  OCT  ,3424242424764200    .
         :   ,  OCT  ,7440704040407600    .
         :   ,  OCT  ,1076525276101000    .
         :   ,  OCT  ,7640404040404000    .
         :   ,  OCT  ,4224102442424200    .
         :   ,  OCT  ,4242424652624200    .
         :   ,  OCT  ,1042424652624200    .
         :   ,  OCT  ,4450605044424200    .
         :   ,  OCT  ,1622222222224200    .
         :   ,  OCT  ,4266525242424200    .
         :   ,  OCT  ,4242764242424200    .
         :   ,  OCT  ,3442424242423400    .
         :   ,  OCT  ,7642424242424200    .
         :   ,  OCT  ,3642423612224200    .
         :   ,  OCT  ,7442424274404000    .
         :   ,  OCT  ,3640404040403600    .
         :   ,  OCT  ,7610101010101000    .
         :   ,  OCT  ,4242422212043000    .
         :   ,  OCT  ,5234103452525200    .
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,4040744242427400    .
         :   ,  OCT  ,4242605252522200    .
         :   ,  OCT  ,3044100402423400    .
         :   ,  OCT  ,4242525252527600    .
         :   ,  OCT  ,7402360202027400    .
         :   ,  OCT  ,4242525252527701    .
         :   ,  OCT  ,4242424276020200    .
         :   ,  OCT  ,0000000000000000    .
         ,END,
 MBWDEF:,NAME,
C*******************************************
C*                                         I
C*     24.04.81          ЧEPEHKOB C.И.     I
C*  +  18.07.86                            I
C******************************************I
C*   HAБOP ПOДПPOГPAMM ДЛЯ PAБOTЫ CO CЛO-  I
C*   BAMИ ПPOИЗBOЛЬHOЙ PAЗPЯДHOCTИ.        I
C*******************************************
C*  ДЛЯ N-PAЗPЯДHOГO CЛOBA COЗДAETCЯ ПCEB- I
C*  ДOAKKYMYЛЯTOP, COCTOЯЩИЙ ИЗ N/48 (ECЛИ I
C*  N KPATHO 48) ИЛИ ИЗ N/48+1 (ECЛИ N ДE- I
C*  ЛИTCЯ HA 48 C OCTATKOM) MAШИHHЫX CЛOB. I
C*  БИTЫ N-PAЗPЯДHOГO CЛOBA HYMEPYЮTCЯ CЛE-I
C*  BA HAПPABO: 1,2,...,N . PEЗYЛЬTAT PAБO-I
C*  TЫ BCEX ПOДПPOГPAMM TИПA SUBROUTINE OC-I
C*  TAETCЯ HA ПCEBДOAKKYMYЛЯTOPE ACC, ПOД- I
C*  ПPOГPAMMЫ TИПA FUNCTION HE MEHЯЮT ACC. I
C*   ПOДПPOГPAMMЫ MBWDEF,MBWPUT И MBWCLE   I
C*  ПPИ BЫXOДE YCTAHABЛИBAЮT CTAHДAPTHЫЙ   I
C*  PEЖИM AY. OCTAЛЬHЫE ПOДПPOГPAMMЫ COXPA-I
C*  HЯЮT PEЖИM, KOTOPЫЙ ИCПOЛЬЗOBAЛCЯ BO   I
C*  BPEMЯ ИX BЫЗOBA.                       I
C*   ДЛЯ ИCПOЛЬЗOBAHИЯ ПOДПPOГPAMM HEOБXO- I
C*  ДИMO CHAЧAЛA BЫЗBATЬ MBWDEF И YKAЗATЬ  I
C*  PAЗPЯДHOCTЬ ACC.                       I
C*-----------------------------------------I
C*       SUBROUTINE MBWDEF(ACC,N)          I
C*  ПOДПPOГPAMMA OПPEДEЛЯET N-PAЗPЯДHЫЙ AK-I
C*  KYMYЛЯTOP ACC И OБHYЛЯET MAШИHHЫE CЛOBAI
C*  (MACCИB)  OTBOДИMЫE ПOД ACC.           I
C*-----------------------------------------I
C*       SUBROUTINE MBWLDA(WORD)           I
C*  ПOДПPOГPAMMA ПPOИЗBOДИT ЗAГPYЗKY B ACC I
C*  N-PAЗPЯДHOГO CЛOBA WORD.               I
C*-----------------------------------------I
C*       SUBROUTINE MBWSTA(WORD)           I
C*  ПOДПPOГPAMMA ПPOИЗBOДИT ЗAПИCЬ ИЗ ACC  I
C*  B WORD.                                I
C*-----------------------------------------I
C*       SUBROUTINE MBWOR(WORD)            I
C*  ПOДПPOГPAMMA ПPOИЗBOДИT ЛOГИЧECKOE CЛO-I
C*  ЖEHИE COДEPЖИMOГO ACC И WORD.          I
C*-----------------------------------------I
C*       SUBROUTINE MBWAND(WORD)           I
C*  ПOДПPOГPAMMA ПPOИЗBOДИT ЛOГИЧECKOE YM- I
C*  HOЖEHИE COДEPЖИMOГO ACC И WORD.        I
C*-----------------------------------------I
C*       SUBROUTINE MBWEXO(WORD)           I
C*  BЫПOЛHЯET OПEPAЦИЮ "ИCKЛЮЧAЮЩEE ИЛИ"   I
C*  HAД COДEPЖИMЫM  ACC  И  WORD .         I
C*-----------------------------------------I
C*       SUBROUTINE MBWNOT                 I
C*  ИHBEPTИPYET ПCEBДOAKKYMYЛЯTOP ACC.     I
C*-----------------------------------------I
C*       SUBROUTINE MBWPUT(K)              I
C*  ПOДПPOГPAMMA ЗAHOCИT '1' B K-ЫЙ БИT ACCI
C*  ECЛИ ЗAДAHO, ЧTO K>N, ИЛИ K<0, ИЛИ K=0,I
C*  TO ПOДПPOГPAMMA ПPEKPAЩAET PAБOTY И BЫ-I
C*  ДAETCЯ ДИAГHOCTИKA 'OШ.OБPAЩEHИE'.     I
C*-----------------------------------------I
C*       SUBROUTINE MBWCLE(K)              I
C*  ПOДПPOГPAMMA ПPOИЗBOДИT ГAШEHИE K-ГO   I
C*  БИTA B ACC.                            I
C*-----------------------------------------I
C*       FUNCTION MBWCHK(K)                I
C*  BЫДAET ЗHAЧEHИE  K-ГO  БИTA B  ACC     I
C*         ( 0 ИЛИ 1 ) .                   I
C*-----------------------------------------I
C*       FUNCTION MBWFIR(0)                I
C*  ПOДПPOГPAMMA BЫЧИCЛЯET HOMEP CAMOЙ ПEP-I
C*  BOЙ (CAMOЙ ЛEBOЙ) '1' B ACC.           I
C*-----------------------------------------I
C*       FUNCTION MBWCNT(0)                I
C*  ПOДПPOГPAMMA BЫЧИCЛЯET, CKOЛЬKO '1' B  I
C*  ACC.                                   I
C*   ПPИ OTCYTCTBИИ '1' B ACC OБE ФYHKЦИИ  I
C*  BЫДAЮT B KAЧECTBE PEЗYЛЬTATA 0.        I
C*-----------------------------------------I
C*       SUBROUTINE MBWSFT(K)              I
C*  ПOДПPOГPAMMA ПPOИЗBOДИT CДBИГ BCEГO    I
C*  N-PAЗPЯДHOГO CЛOBA. ПPИ K>0 - BПPABO,  I
C*  ПPИ K<0 - BЛEBO, ПPИ K=0 - CДBИГA HET. I
C*  ПPИ ABS(K) > N ПPOИCXOДИT ГAШEHИE ACC. I
C*******************************************
 *BEG:,BSS,
 12,BASE,*BEG
 ,STI,14.N
 ,ATX,ACCN
 ,XTA,=7777 7777 7777 7777
 ,ATX,MOD48
 14,XTA,
 ,ATX,N
 ,ATX,K
 8,VTM,3
 ,NTR,3B
 ,X-A,=I0. -N
 ,UZA,ERROR
 ,XTA,N
 ,NTR,2B
 ,A/X,=R48.
 15,ATX,
 ,NTR,3B
 ,A+X,=I0
 ,ATX,N/48
 ,NTR,2B
 15,A-X,
 ,UZA,ZERO
 ,XTA,N/48
 ,A*X,=R48.
 ,NTR,3B
 14,X-A,
 ,A-X,=I48
 ,ATI,11
 ,XTA,MOD48
  11,ASN,64
 ,ATX,MOD48. MACKA
 ,XTA,N/48
 ,ARX,=1
 ,ATX,N/48
 ZERO:,BSS,
 ,NTR,3B
 ,XTA,=I1
 ,A-X,N/48
 ,ATX,NLOOP
 ,ATI,14
 ,WTC,ACCN
 11,VTM,
     ,XTA,
 LOAD:,BSS,
 11,ATX,
 11,UTM,1
 14,VLM,LOAD
 ,STI,
 ,NTR,6B
 13,UJ,
C---------
 MBWLDA:,ENTRY,                                                        M
 9,VJM,SET
 LOAD1:,BSS,
 14,XTA,
 11,ATX,
 14,UTM,1
 11,UTM,1
 10,VLM,LOAD1
  ,UJ,CLEND
C---------
 MBWSTA:,ENTRY,
 9,VJM,SET
 LOAD2:,BSS,
 11,XTA,
 14,ATX,
 11,UTM,1
 14,UTM,1
 10,VLM,LOAD2
 ,STI,
 13,UJ,
C---------
  MBWOR:,ENTRY,
 9,VJM,SET
 LOAD3:,BSS,
 14,XTA,
 11,AOX,
 11,ATX,
 14,UTM,1
 11,UTM,1
 10,VLM,LOAD3
  CLEND:,BSS,
 ,AAX,MOD48
  11,STX,-1
  13,UJ,
C---------
 MBWAND:,ENTRY,
 9,VJM,SET
 LOAD4:,BSS,
 14,XTA,
 11,AAX,
 11,ATX,
 14,UTM,1
 11,UTM,1
 10,VLM,LOAD4
 ,STI,
 13,UJ,
C---------
 MBWEXO:,ENTRY,
 9,VJM,SET
 LOAD5:,BSS,
 11,XTA,
 14,AEX,
  11,ATX,
 11,UTM,1
 14,UTM,1
 10,VLM,LOAD5
  ,UJ,CLEND
C---------
  MBWNOT:,ENTRY,
  ,XTS,
  9,VJM,SET
  LOAD6:11,XTA,
  ,AEX,=7777 7777 7777 7777
  11,ATX,
  11,UTM,1
  10,VLM,LOAD6
  ,UJ,CLEND
C---------
  MBWCHK:,ENTRY,
  ,UTC,1
C---------
 MBWPUT:,ENTRY,
 ,UTC,1
C---------
 MBWCLE:,ENTRY,
 STOP*:,SUBP,
 8,VTM,
 9,VJM,SET
 14,XTA,
 ,ATX,K
 ,NTR,3B
 ,A-X,=I1
 ,U1A,ERROR
 ,A-X,N
 ,UZA,ERROR
 ,NTR,2B
 14,XTA,
 ,A/X,=R48.
 ,NTR,3B
 ,A+X,=I0
 ,ATI,11
 ,NTR,2B
 ,A*X,=R48.
 ,NTR,3B
 14,X-A,
  ,ATI,9
  9,VIM,NORM
 9,VTM,48
  11,UTM,-1.KPATHO 48
  NORM:,BSS,
 ,XTA,=:4
  9,ASN,64-1
 ,ATX,WS
  ,AEX,=7777 7777 7777 7777
  15,ATX,2
 ,WTC,ACCN
 11,XTA,
  8,UJ,SWPUT
  SWPUT:15,AAX,2.CLE
  ,UJ,PUT
  :,AOX,WS.PUT
  ,UJ,PUT
  :,AAX,WS.CHK
  ,ACX,=I0
  ,NTR,2B
  13,UJ,
 PUT:,WTC,ACCN
  11,STX,
  ,NTR,2
 13,UJ,
 ERROR:,ITA,13
 ,ATX,R13
 8,XTA,NAMES
 ,ATX,NAME
 ,*64,PR
 ,UJ,STOP*
 PR:,Z00,TEXT
    ,Z00,K
 :0,002,
 0,,
 :2,031,5
 8,010,1
C---------
 MBWCNT:,ENTRY,
 9,VJM,SET
 ,XTA,=I0
 ,ATX,WS
 LOAD10:11,XTA,
 ,ACX,WS
 ,ATX,WS
 11,UTM,1
 10,VLM,LOAD10
 13,UJ,
C---------
 MBWFIR:,ENTRY,
 8,VTM,
 9,VTM,LOAD9
 SET:,ATI,14
 12,BASE,*BEG
 ,WTC,NLOOP
 10,VTM,
 ,XTA,ACCN
 ,ATI,11
 9,U1A,
 ,*64,PRI
 ,UJ,STOP*
 PRI:,Z00,TEXT1
 ,Z00,
 :0,002,
 8,,
 LOAD9:11,XTA,
 ,UZA,L1
 ,ANX,=I0
 ,ITS,8
 15,ARX,
 13,UJ,
 L1:8,UTM,48
 11,UTM,1
 10,VLM,LOAD9
 ,XTA,=I0
 13,UJ,
 TEXT1:,GOST,18HYKAЖИ PAЗPЯДHOCTЬ'231'
 NAMES:,GOST,24HMBWCLEMBWPUTMBWCHKMBWDEF
 TEXT:,GOST,12HOШ.OБPAЩ. K
 NAME:,LOG,
     :,GOST,5H ИЗ'231'
 R13:,LOG,
  K:,LOG,
  ACCN:,BSS,1
  WS  :,BSS,1
  N   :,BSS,1
  N/48:,BSS,1
 MOD48:,BSS,1
 NLOOP:,BSS,1
  R14:,BSS,1
 ,END,
 MBWSFT:,NAME,
 MBWFIR:,SUBP,
 ACN:,EQU,MBWFIR+42B
 N:,EQU,ACN+2B
 N/48:,EQU,N+1B
 MOD48:,EQU,N+2B
 NLOOP:,EQU,N+3B
 ,ATI,14
     14,XTA,
 ,ATX,R14
 ,AAX,=:002 .ЗHAK CДBИГA
 ,ATX,ЗHAK
 ,ASN,64+40
 ,ATI,9
 ,ITA,13
 ,ATX,RET
 14,XTA,
 ,AEX,=:64
 13,UZA, .ECЛИ CДBИГ =0
  ,NTR,23B
 14,XTA,
 9,VZM,/1/
  ,X-A,=I0
          ,ATX,R14
 /1/:,UTC,N
     ,A-X,
 ,AAX,=:002
  ,UZA,LOA  .ECЛИ CДBИГ => N
   ,XTA,R14
 /11/:,NTR,2B
 ,A/X,=R48.
 15,ATX,
 ,NTR,3
 ,A+X,=I0
 ,ATX,NW
 ,NTR,3B
 ,UTC,N/48
 ,XTA,
 ,A-X,NW
 ,ATX,WS
 ,A-X,=I1
 ,ATX,NWSH
 ,WTC,ACN
 10,VTM,
 10,MTJ,11
 9,V1M,LA
 ,WTC,NWSH
 10,UTM,
 ,UJ,TOG
 LA:,WTC,NW
 10,UTM,
 TOG:,XTA,WS
 ,X-A,=I1
 ,ATX,NLO
 ,ATI,8
 ,XTA,NW
 ,NTR,2B
 ,A*X,=R48.
 ,NTR,3B
 9,V1M,LSH
   ,X-A,R14
 ,ATX,SH1
 ,A-X,=I48
 ,ATX,SH2
 ,UJ,/20/
 LSH:  ,A-X,R14
 ,ATX,SH2
 ,A+X,=I48
 ,ATX,SH1
 /20/:,NTR,3B
 ,XTA,=I1
 ,A-X,NW
 ,ATI,13
  9,VZM,BПPABO
   ,UJ,BЛEBO
 LOA:,UTC,NLOOP
 ,XTA,
 ,ATI,14
 ,XTA,
 11,VTM,
 L:,WTC,ACN
   11 ,ATX,
  11,UTM,1
 14,VLM,L
 ,STI,
 13,UJ,
 BПPABO:  ,XTA,NW
 ,AEX,=:64
 ,UZA,/4/
 ПP:10,XTA,
 11,UTM,-1
 ,WTC,N/48
 11,ATX,
 10,UTM,-1
 8,VLM,ПP
 ,XTA,NLO
 ,ATI,8
 ,WTC,ACN
  11,VTM,
 ,XTA,
 ПP/OБH:11,ATX,
  11,UTM,1
 13,VLM,ПP/OБH
 /4/:,WTC,ACN
 11,VTM,-1
 ,WTC,N/48
 11,UTM,
 ,XTA,SH1
 ,AEX,=:64
 ,UZA,/6/
 ПP/CДB:11,XTA,-1
 ,WTC,SH2
 ,ASN,64
 15,ATX,
 ,ATX,MAS
 11,XTA,
 ,WTC,SH1
 ,ASN,64
 ,ATX,MAS1
 15,AOX,
 9,V1M,Л/CДB
 11,ATX,
 11,UTM,-1
 8,VLM,ПP/CДB
 /6/: ,WTC,ACN
  11,VTM,-1
     ,WTC,N/48
 11,XTA,
 ,UTC,MOD48
 ,AAX,
 ,WTC,N/48
 11,ATX,
 ,XTA,SH1
 ,AEX,=:64
 ,UZA,/16/
 ,WTC,ACN
 11,VTM,
 11,XTA,
 ,AEX,MAS
 11,ATX,
 /16/:,UJ,/7/
 BЛEBO:,XTA,NW
 ,AEX,=:64
 ,UZA,/8/
 BЛ:10,XTA,
 11,ATX,
 10,UTM,1
 11,UTM,1
 8,VLM,BЛ
 ,XTA,NLO
 ,ATI,8
 ,WTC,ACN
  11,VTM,
 ,XTA,
 Л/OБH:,WTC,N/48
 11,ATX,-1
 11,UTM,-1
 13,VLM,Л/OБH
 ,WTC,ACN
 11,VTM,
 ,XTA,SH2
 ,AEX,=:64
 ,UZA,/7/
 /8/:,WTC,ACN
 11,VTM,1
 ,UJ,ПP/CДB
 Л/CДB:11,ATX,-1
 11,UTM,1
 8,VLM,ПP/CДB
 ,WTC,ACN
 11,VTM,-1
 ,WTC,N/48
 11,XTA,
 ,AEX,MAS1
 ,WTC,N/48
 11,ATX,
 /7/:,XTA,R14
 14,STX,
     ,WTC,RET
  ,UJ,
 MAS:,BSS,1
 MAS1:,BSS,1
 ЗHAK:,BSS,1
 NW:,BSS,1
 SH1:,BSS,1
 SH2:,BSS,1
 NWSH:,BSS,1
 NLO:,BSS,1
 RET:,BSS,1
  WS  :,BSS,1
  R14:,BSS,1
 ,END,
  MEMORR:,NAME,
C*
C**************************************
C*
C*   ФOPTPAHHЫЙ ИHTEPФEЙC ДЛЯ
C*   BЫПOЛHEHИЯ HEKOTOPЫX CYГYБO
C*   "MAШИHHЫX" OПEPAЦИЙ.
C*
C*   FUNCTION MEMORR(ADR)
C*   - BЫДAЧA COДEPЖИMOГO CЛOBA ПAMЯTИ,
C*     AДPEC KOTOPOГO YKAЗAH B ADR.
C*   FUNCTION MEMORW(W,ADR)
C*   - ЗAПИCЬ CЛOBA W ПO KOCBEHHOMY
C*     AДPECY ADR. CYMMATOP = W .
C*   FUNCTION JEXTRI(ACC,N,INF)
C*   FUNCTION JEXTRA(ACC,N,ADR)
C*   - BЫПOЛHEHИE ЭKCTPAKOДA C HOMEPOM
C*     N = 50B, ... ,77B
C*     ACC=CYMMATOP HA BXOДE B ЭKCTPAKOД
C*     INF=ИHФOPM. CЛOBO ЭKCTPAKOДA
C*     ADR=AДPECHAЯ ЧACTЬ ЭKCTPAKOДA
C*     PEЗYЛЬTAT=CYMMATOP ПOCЛE ЭKCTPAKOДA
C*     JEXTRI - ЭKCTPAKOДЫ C ИHФ.CЛOBOM
C*     JEXTRA - AДPECHЫE ЭKCTPAKOДЫ.
C*
C*   ПOPTЯTCЯ 12 И 14 ИHДEKC-PEГИCTPЫ
C*   PEЖИM AY HE MEHЯETCЯ.
C*
C******************************************
C*
  A/I0:,LC,1
  ,ATI,14
  14,WTC,
  ,XTA,
  13,UJ,
  MEMORW:,ENTRY,
  ,ATI,14
  15,WTC,
  ,XTA,
  14,WTC,
  ,ATX,
  13,UJ,
  JEXTRA:,ENTRY,
  ,ATI,14
  14,XTA,
  JEXTRI:,ENTRY,
  13,MTJ,12
  ,ATI,13
  15,WTC,
  ,XTA,
  ,ASN,64-36
  ,AOX,A/I0
  ,UTC,C
  ,CTX,
  15,WTC,
  ,XTA,
  C:,EXT,.*****
  :12,UJ,
  ,END,
 MISTER:,NAME,
C*
C*     SUBROUTINE MISTER
C*
C*     KЛYШИH A.И., ДYПИH B.И.. 1984.
C*     MOДИФИЦИPOBAHHЫЙ BBOД CTPOK
C*      C TEPMИHAЛA TИПA VT-340
C*
C*     BBOД ПPOИЗBOДИTCЯ B 1 - 224
C*     CЛOBA COMMON /MISTER/ M(225)
C*     BCE KOДЫ CИMBOЛOB VT-340
C*     (KPOME 'LF' И 'ETX')
C*     ПPИHИMAЮTCЯ БEЗ ПEPEKOДИPOBKИ
C*     ПPИЗHAK KOHЦA BBOДA - '000'.
C*     BBOД ЗABEPШAETCЯ ПPИ HAЖATИИ
C*     HA KЛABИШИ:
C*     'LF','ETX','ERASE','RETURN'.
C*     KЛABИШA 'TAB' ПEPEBOДИT KYPCOP
C*     B HAЧAЛO CЛEДYЮЩEЙ CTPOKИ.
C*
 *MISTER*:,SC,225
 ,XTS,
 14,VTM,-224.OБHYЛEHИE
 *1:14,UTC,*MISTER*. ПPИEMHOЙ
 ,ATX,224. CTPOKИ.
 14,VLM,*1
 ,UTC,INF
 ,*71,.-BBOД-
 15,XTA,
 13,UJ,
C
 INF:,Z06,*MISTER*
 6,Z00,
 ,END,
  MT9A:,NAME,
C*
C*********  8.2.80. A.П.CAПOЖHИKOB
C*
C*   HAБOP OПEPAЦИЙ YПPABЛEHИЯ
C*   HMЛ EC5012 (PEЖИM EC) :
C*
C*   FUNCTION MT9 (LUN,JOB)
C*   FUNCTION MT9A(LUN,JOB,AR)
C*   SUBROUTINE GUSEV(LUN,JOB)
C*
C*   LUN - HOMEP YCTPOЙCTBA : 1,2,...,15
C*   JOB - KOД OПEPAЦИИ :
C*       1 - ЧTEHИE PEKOPДA 0<=L<=1024 CЛOB
C*       2 - ЗAПИCЬ PEKOPДA ДЛИHOЙ 256 CЛOB
C*       3 - BПEPEД HA 1 PEKOPД
C*       4 - HAЗAД  HA 1 PEKOPД
C*       5 - ПOИCK EOF BПEPEД
C*       6 - ПOИCK EOF HAЗAД
C*       7 - ПEPEMOTKA
C*       8 - ПEPEMOTKA C PAЗГPYЗKOЙ
C*       9 - ЗAПИCЬ  E O F
C*      10 - CTИPAHИE B ПPЯM.HAПP.
C*      11 - CTИPAHИE B OБP. HAПP.
C*      12 - ЗAПИCЬ PEKOPДA ДЛИHOЙ 1024 CЛOB
C*
C*   MT9  ПPOИЗBOДИT OБMEHHЫE OПEPAЦИИ
C*   HA CИCTEMHOM БYФEPE, B OTЛИЧИE OT
C*   MT9A, KOTOPAЯ ИMEET ДEЛO C MACCИBOM
C*   ЮЗEPA  AR.
C*   ЗAMEЧAHИE: ПPИ OПEPAЦИИ ЧTEHИЯ
C*     MACCИB AR ДOЛЖEH БЫTЬ ДЛИHOЙ
C*     1024 CЛOBA, T.K. B OБЩEM CЛYЧAE
C*     ЮЗEP HE ЗHAET ЗAPAHEE ДЛИHY
C*     БЛOKOB HA ЛEHTE.
C*   GUSEV - TO ЖE, ЧTO И MT9, HO
C*   PAБOTAET C HMЛ HA BЫCOKOЙ ПЛOTHOCTИ
C*   И ФИKCИPOBAHHOЙ ДЛИHOЙ PEKOPДA:
C*   160 БAЙTOB. ЭTOT BXOД CДEЛAH ДЛЯ
C*   B.ПAXOMOBA.
C*
C*   ЗAXBAT CИCTEMHOГO БYФEPA OБECПEЧИBAETCЯ
C*
C*   ПOPTЯTCЯ PEГИCTPЫ: 8-14
C*   PEЗYЛЬTAT PAБOTЫ BCEX BXOДOB BCEГДA
C*   HA CYMMATOPE B BИДE ЦEЛOГO ЧИCЛA :
C*    0 <= L <= 1024  - CЧИTAHO (ЗAПИCAHO)
C*                      L CЛOB БEЗ OШИБOK.
C*    -1024 <= L < 0  - CЧИTAHO (ЗAПИCAHO)
C*                      -L  CЛOB И БЫЛИ
C*                      OШИБKИ ЧETHOCTИ.
C*    1025  - COBCEM ПYCTAЯ ЛEHTA.
C*    1026  - BЫШЛИ HA KOHEЦ ЛEHTЫ (EOT).
C*    1027  - CЧИTAH (ЗAПИCAH)  END OF FILE.
C*    1028  - BЫШЛИ HA HAЧAЛO ЛEHTЫ.
C*
C*   ЗAMEЧAHИE: ПPИ OПEPAЦИЯX ПEPEMOTKИ
C*              PEЗYЛЬTAT HE OПPEДEЛEH.
C*
C********  ПPИ PAБOTE ПOД YПPABЛEHИEM
C*            O C   " Д И C П A K "
C*                HEOБXOДИMO
C*       OПИCATЬ B ГOЛOBHOЙ ПPOГPAMME
C*       COMMON / DISPAC / MOC, IDENS
C*       MOC  ДOЛЖHO ИMETЬ ЗHAЧEHИE 6HDISPAC
C*       IDENS=0  - PAБOTA C BЫCOKOЙ ПЛOTHOCTЬЮ
C*       IDENS=1  - PAБOTA C HИЗKOЙ ПЛOTHOCTЬЮ
C*
C*       B OC "ДИCПAK" OПEPAЦИИ CTИPAHИЯ HE PAБOTAЮT
C*       T.E.  OБPAЩEHИЯ K MT9 C KOП=10 И 11 OTPAБA-
C*       TЫBAЮTCЯ KAK ПYCTЫE OПEPATOPЫ.
C*
C*************************************
C*
  ALIS:,EQU,43B
  PAGE:,WEQ,ALIS
  NPAGE:,P/P,(PAGE)16
  *DISPAC*:,LC,2
  A/I0:,LC,1
  *0:,BLOCK,(2),NTAP(2),LIST(4),STAT
  ,CONT,LEN(4),MOV,EXCH(3),ERR
C
C---
C
  ,STI,11
  11,UTC,
  MT9:,ENTRY,
  11,VTM,
  ,UTC,1
  GUSEV:,ENTRY,
  12,VTM,-1
  8,BASE,*
  ,STI,9
  ,ATI,14
  12,J+M,15
  ,ITA,13
  ,ATX,RET
  14,WTC,
  13,VTM,40B
  ,ITA,13
  ,ATX,LUN
  9,WTC,
  ,XTA,JOB
  ,ATX,JOB
  9,WTC,
  9,VTM,-12
  ,ASN,64+24
  ,UZA,NO EXCH
  12,VIM,NO EXCH
  11,VZM,NO EXCH
  11,MTJ,10
  13,VTM,PAGE
  14,VTM,-1023
  TRW:10,XTA,
  13,XTS,
  10,STX,
  13,ATX,
  13,UTM,1
  10,UTM,1
  14,VLM,TRW
  ,UTC,ALIS
C---
  NO EXCH:,XTA,
  ,ATX,MSAV
  15,MTJ,10
  REPEAT:,BSS,
  10,ATX,ERR
  ,XTA,LUN
  10,ATX,NTAP
  ,XTA,ALIS
  10,ATX,LIST
  ,XTA,=370 0001
  10,ATX,MOV-1
  ,XTA,JOB
  12,VZM,NO11
  ,AOX,=2000
  NO11:,AAX,=77777
  10,ATX,MOV
  ,XTA,JOB
  ,ASN,64+24
  ,UZA,NO21
  12,VZM,NO21
  ,AOX,=400 0000
  NO21:10,ATX,EXCH
  ,*63,766B
  ,AEX,=6HOC ДYБ
  14,VTM,*DISPAC*
  ,U1A,DISPAC
  ,*57,4.*******
  10,MTJ,15
  ,XTA,JOB
  ,ASN,64+15
  ,AAX,=17.HAДO БЫ 37
  ,UZA,EE
  10,WTC,ERR
  14,VTM,-3
  14,VZM,EE
  10,AAX,STAT
  ,UZA,REPEAT
C---
  EE:,BSS,
  10,WTC,ERR
  14,VTM,-3
  ,XTA,=1
  14,VZM,NORM
  10,XTA,STAT
  ,ASN,64-43
  ,UZA,NORM
  ,ANX,=1
  NORM:,ATI,14
  ,ATI,9
  ,XTA,JOB
  ,ASN,64+24
  ,UZA,EMOV
C...   KOHEЦ OБMEHA
  10,XTA,LEN
  ,AOX,A/I0
  14,VZM,TRAN
  9,UTM,-6
  9,VZM,PARITY
  9,UTM,1
  9,VZM,PARITY
  P1024:14,UTM,1024
  ,UJ,FIN
  PARITY:,NTR,3
  ,X-A,A/I0
  ,NTR,6
  ,UJ,TRAN
C...   KOHEЦ ДBИЖEHИЯ
  EMOV:14,VZM,FIN
  10,XTA,STAT
  ,AAX,=37
  ,ASN,64+2
  ,U1A,P1024
  14,VTM,
  FIN:,ITA,14
  ,AOX,A/I0
C...  HE HAДO ЛИ BOCCTAHOBИTЬ ЛИCT
  TRAN:,WTC,MSAV
  9,VTM,
  9,VZM,EXIT
  13,VTM,-1023
  ,XTS,.
  TRR:11,XTA,
  9,XTS,
  11,STX,
  9,ATX,
  9,UTM,1
 11,UTM,1
  13,VLM,TRR
  ,STX,.
  EXIT:,WTC,RET
  ,UJ,
C
C
C------    ДЛЯ OC "ДИCПAK" :
C
  DISPAC:14,XTA,1
  ,AAX,=1
  ,ASN,64-11
  10,AOX,NTAP
  ,ASN,64-12
  ,AOX,P/70
  10,ATX,EXCH+1
  9,XTA,D/TAB+11
  ,UZA,D/SW+1
  ,ASN,64-39
 10,AOX,EXCH+1
  D/EX:10,ATX,EXCH+1
       10,*70,EXCH+1
  ,ITA,14
  ,ASN,64+5
  :,U1A,*+1
  ,XTA,=2000
  :,AOX,A/I0
  10,ATX,LEN
  ,ITA,14
  ,AAX,=7
  ,AEX,=7.INVERSION
  15,ATX,
  ,ASN,64-1
  15,ARX,.*3
  ,ATI,14
  9,XTA,D/TAB+11
  14,ASN,64+24
  ,AAX,=7
  ,ATI,14
  14,UJ,D/SW
  D/SW:10,XTA,LEN
  ,UJ,TRAN.OKEY EXCH
  :14,VTM,
  ,UJ,FIN.OKEY MOVE
  :10,XTA,EXCH+1
  ,UJ,D/EX.REPEAT SEARCH
  :,,
  :,,
  :,,
  :14,UTM,1022
  ,UJ,FIN.END OF MOVE
  :10,XTA,LEN
  ,UJ,PARITY
  P/70:,000,NPAGE
   ,000,
C
  D/TAB:,BSS,
C     TAБЛИЦA PEШEHИЙ ДЛЯ AHAЛИЗA
C     PEЗYЛЬTATOB PAБOTЫ
C     CTPOKИ COOTBETCTBYЮT KOMAHДAM
C     CTOЛБЦЫ (CЛEBA HAПPABO) - COCTOЯHИЯ:
C     0:O'KEY, 1:HЛ, 2:KЛ, 3:EOF, 4:KДB
C     5:LONG, 6:HГT, 7:PARITY, 13-15:KOП
C     HA ПEPECEЧEHИИ - PEШEHИE :
C       0 - HOPM.KOHEЦ OБMEHA
C       1 - HOPM.KOHEЦ ПOДBOДA
C       2 - ПPOДOЛЖИTЬ ПOИCK MAPKEPA
C       3 - BЫЙTИ ПO KДB
C       4 - BЫЙTИ ПO KЛ
C       5 - BЫЙTИ ПO EOF
C       6 - BЫЙTИ ПO HЛ
C       7 - OШ.ЧETH.ПPИ OБMEHE
C
   0,LOG,0645 3447 0000 0001.READ
   1,LOG,0645 4047 0000 0400.WRITS
   2,LOG,1645 3345 0000 0002.FORV
   3,LOG,1645 3345 0000 0003.REVERS
   4,LOG,2645 4242 0000 0002.FORV TO MF
   5,LOG,2645 4242 0000 0003.REV TOMF
   6,LOG,6666 6646 0000 0006.REWIND
   7,LOG,6666 6646 0000 0006.UNLOAD
   8,LOG,5555 5545 0000 0007.WREOF
   9,LOG,.CLEAR - IS
  10,LOG,.EMPTY JOB
  11,LOG,0645 4047 0000 0000.WRITL
C
C---
C
  JOB:,LOG,.TEKYЩИЙ
  1,LOG,140 0010 0002 0401.READ
  2,LOG,000 0010 0002 0401.WRITE
  3,LOG,401.FORW
  4,LOG,403.REVERS
  5,LOG,300 0401.FORW TO MF
  6,LOG,140 0403.REV  TO MF
  7,LOG,500.REWIND
  8,LOG,600.UNLOAD
  9,LOG,420.WRITE MF
 10,LOG,440.CLEAR FORW
 11,LOG,440.CLEAR REV
  12,LOG,100 0014 0002 0401.WRITE 1024
C---
  RET:,BSS,1
  LUN:,BSS,1
  MSAV:,BSS,1
  ,END,
  NEWLIB:,NAME,
 TABLE:,PP,10240
 NEWCAT:,EQU,TABLE+1024
 CATALOG:,EQU,NEWCAT+2048
 NEWRCAT:,EQU,CATALOG
   NEWECAT:,EQU,NEWRCAT+1024
   RCAT:,EQU,CATALOG+2048
   ECAT:,EQU,RCAT+1024
 STATIS:,EQU,ECAT+1024
 BUFFER:,EQU,STATIS+1024
 NEWSTAT:,EQU,RCAT
    BUFDEF:,EQU,BUFFER+1024
   WBEGFLAG:,LC,2
 DRTAPE:,LC,1
 LIBLIST:,SUBP,
 MONCARD*:,LC,1
 DATA*:,LC,2
  NOLISFL*:,LC,1
C
C
  7,BASE,C
  ,XTA,=1
  ,ATX,NEWL
  ,UJ,ALL
C
C
  INSLIB:,BSS,.***
 6,VTM,
 ,UJ,RD
C
C
  INSALL:,BSS,.***
 ALL:,BSS,
 6,VTM,1
 RD:,BSS,
 C:7,BASE,C
  ,UTC,MONCARD*
 ,XTA,
 ,AEX,=6HTAPE
 ,UZA,TAPE
 ,ATX,FLDR
 ,AEX,=6HTAPE
 ,AEX,=6HDRUM
 ,UZA,DRUM
 12,VTM,T10
 ,*64,INF
 ,UJ,RETURN
 TAPE:,ATX,FLDR
 ,XTA,=670000
 ,UJ,DR1
 DRUM:,XTA,39
 ,AAX,NLIS
 DR1:,BSS,
 ,XTS,
 12,VJM,READCAT
 ,STX,
  8,VTM,BUFFER
   ,ITS,8
   ,ASN,64-20
 15,AOX,
 ,AOX,=:001
   ,ATX,CRD
   ,*70,CRD .READING CATALOG FROM DRUM
   ,XTA,CRD
   ,ARX,=100 0000 0001
   ,ATX,CRD
   ,*70,CRD
   2,VTM,LIBLIST
  4,VTM,
 3,VTM,BUFFER+2
 ,UTC,MONCARD*
 ,XTA,
 ,AEX,=6HTAPE
 ,U1A,NOTAPE
 8,VTM,
 L:3,UTC,
 8,XTA,1
 ,AEX,C7ALL
 ,UZA,NOTAPE
 8,UTM,2
 ,ITA,8
 ,AEX,=3776
 ,U1A,L
 12,VTM,T11
 ,*64,INF
 ,UJ, RETURN
 NOTAPE:,CALL,MONREAD*
 LLIB:6,V1M,ALLDR
 2,XTA,
   ,UZA,ENDLIST
   3,VTM,BUFFER+2
    LCATD:3,XTA,1
   ,E+N,64
   ,UZA,NOPROG.BEGINING OF PERMANENT LIBRARY
   3,XTA,
   2,AEX,
   ,UZA,YES
   3,UTM,2
   ,UJ,LCATD
 ALLDR:3,XTA,1
 ,E+N,64
 ,UZA,ENDLIST
   YES:3,MTJ,14
   13,VJM,SKMENTRY
   14,MTJ,3
   11,UTM,2
 YES2:3,XTA,
   ,UTC,NEWCAT+2
  4,ATX,
  3,XTA,1
   ,UTC,NEWCAT+2
  4,ATX,1
  3,UTM,2
  4,UTM,2
   11,UTM,-2
   11,V1M,YES2
   GOLLIB:2,UTM,1
  ,UJ,LLIB
   NOPROG:2,XTS,
 12,VTM,T2
   ,ITS,12
   ,CALL,PT6/G
   ,*64,INF
   ,UJ,GOLLIB
   EQU:3,UTC,NEWCAT
   14,VTM,
   13,VJM,SKMENTRY
   12,J+M,3
   2,UTC,CATALOG
    14,VTM,
   13,VJM,SKMENTRY
   12,J+M,2
   ,ITA,2
   ,ASN,64+1
   ,ATI,6
   ,ITA,3
   ,ASN,64+1
   ,AOX,C48R
 EQU1:,UTC,TABLE-1
 6,ATX,
 ,UTC,STATIS
 6,ATX,
   11,VZM,ET3
   6,UTM,1
   11,UTM,-2
   ,UJ,EQU1
 ENDLIST:,ITA,4
   ,ATX,LENGLIST.2*NUMBER OF INSERTING PROGRAMS
   ,UZA,RETURN
  4,MTJ,3
 4,MTJ,5
 1,V1M,ET1
 5,UTM,2
 ,UJ,ENDCAT
 ET1:1,MTJ,2
 ET2:,UTC,CATALOG
  2,XTA,
   ,UTC,NEWCAT
  3,AEX,
 ,U1A,ET21
 ,UTC,CATALOG
 2,XTA,
 ,AEX,HPROG
 ,U1A,EQU
 ET21:,BSS,
  2,UTM,-2
  2,V1M,ET2
 ET3:3,UTM,-2
  3,V1M,ET1
 NOEXCL:,BSS,
   ,ITA,1.M1-2*NUMBER OF ENTRY IN CATALOG
   ,NTR,3
 ,ASN,64+1
 ,ATX,NENTR
 9,VTM,2
    4,MTJ,5
   5,UTM,2
   4,VTM,
   LEXC:,UTC,TABLE
    4,XTA,
   ,UZA,EXPR
 ,ARX,
   ,UZA,EXPR
 NEWSTR:4,UTM,1
 9,UTM,2
 ,ITA,4
 ,AEX,NENTR
 ,U1A,LEXC
 LSNLW:,BSS,
 4,VTM,
 8,VTM,
 SLW1:,UTC,STATIS
 4,XTA,1
 ,ARX,
 ,UZA,ENDSLW1
 8,VZM,FST
 ,NTR,3
 ,A-X,NLST
 ,UZA,ENDSLW1
 ,UTC,STATIS
 4,XTA,1
 FST:,ATX,NLST
 4,MTJ,9
 8,VTM,1
 ENDSLW1:4,UTM,1
 ,ITA,4
 ,AEX,NENTR
 ,U1A,SLW1
 8,VZM,ENDCAT
 9,MTJ,4
 ,ITA,9
 ,ASN,64-1
 ,ATI,6
 LRWR:6,UTC,CATALOG+2
 14,VTM,
 13,VJM,SKMENTRY
 11,UTM,2
 12,J+M,6
 ,ITA,6
 ,ASN,64+1
 ,ATI,4
 LRWR1:,UTC,CATALOG+2
 6,XTA,
 ,UTC,NEWCAT
 5,ATX,
 ,UTC,CATALOG+2
 6,XTA,1
 ,UTC,NEWCAT
 5,ATX,1
 ,ITA,5
 ,ASN,64+1
 ,UTC,TABLE
 4,ATX,
 ,XTA,C48R
 ,UTC,STATIS
 4,ATX,1
 6,UTM,2
 4,UTM,1
 5,UTM,2
 11,UTM,-2
 11,V1M,LRWR1
 ,UJ,ELRWR2
 LRWR2:,UTC,STATIS
 4,XTA,1
 ,AEX,NLST
 ,UZA,LRWR
 4,UTM,1
 6,UTM,2
 ELRWR2:,BSS,
 ,ITA,4
 ,AEX,NENTR
 ,U1A,LRWR2
 ,UJ,LSNLW
 ENDCAT:,BSS,
   ,XTA,C7ALL
   5,UTC,NEWCAT
    ,ATX,1
  ,XTA,
  5,UTC,NEWCAT
  ,ATX,
 ,UTC,DATA*
 ,XTA,
 ,APX,=6H'377''377''''377''377'''
 ,UTC,DATA*
 ,XTS,1
 ,APX,=6H'377''377''''377''377'''
 ,ASN,64+32
 15,AOX,
 5,UTC,NEWCAT
  ,ATX,2
   5,UTM,-2
   ,ITA,5.LENGTH OF NEW CATALOG
   ,NTR,3
   ,A-X,LENGLIST
   ,ATX,LRESTC
   ,ATI,2 .COMPOSE OF NEWECAT
  8,VTM,
  5,MTJ,6
   ,ITA,1
   ,ASN,64+1
    ,ATI,1
   ,ATX,LOLDC.NUMBER OF ENTRY IN CATALOG
   ,XTA,=1
    ,ATX,SAVFPL.ADRESS OF FREE PLACE IN NEWCAT
   ,ATX,FPLECAT
   ,ITA,
 14,VTM,-1023
  :,UTC,NEWECAT
 14,ATX,1023
 14,VLM,*-1
   ,ATX,DSHIFT
 5,MTJ,4
 1,VZM,ADTOI2
 2,VZM,DONEWL
    SMENTNC:6,UTC,NEWCAT
   14,VTM,
   13,VJM,SKMENTRY
    12,J+M,6
    12,J+M,2
   11,MTJ,8
   8,UTM,2
 MENTNC:,ITA,6
   ,ASN,64+1
   ,ATX,NNEW
   ,XTA,
   ,ATX,LNEWREF
   SNOLD:,UTC,TABLE-1
  1,XTA,
   ,AEX,NNEW
   ,UZA,NOLD
  1,UTM,-1
   ,UJ,SNOLD
 NOLD:1,UTC,RCAT-1
  9,VTM,
    9,XTA,
   ,UZA,NOREF
 12,VJM,REFER.M11-LENGTM OF REFERENCES
 NEXTREF:,UTC,ECAT.M10-ADRESS
 10,XTA,
    3,ASN,64.  M3-SIZE OF SHIFT
   ,AAX,M4S
   ,ASN,64+1
   ,ATI,9
   ,UTC,TABLE-1
  9,XTA,
   ,UZA,ABS
   ,ASN,64-1
 13,VJM,WRNEWEC
   ,XTA,LNEWREF
   ,ARX,=1
   ,ATX,LNEWREF
   ABS:11,UTM,-1
 11,VZM,WRNRC
     ,ITA,3
   ,AEX,=44
   ,U1A,SHFT
   ,ATI,3
 10,UTM,1
   ,UJ,NEXTREF
   SHFT:3,UTM,12
   ,UJ,NEXTREF
 WRNRC:,XTA,LNEWREF
   ,UZA,NOREF
   ,ASN,64-15
   ,AOX,SAVFPL
 NOREF:,ATX,WORD
   ,ITA,6
   ,ASN,64+1
   ,ATI,14
   ,XTA,WORD
 WRENTRY:,UTC,NEWRCAT
   14,ATX,-1
 14,UTM,1
   8,UTM,-2
    8,V1M,WRENTRY
   6,UTM,-2
  2,UTM,-2
   NEXTWNC:,XTA,SAVFPL
    ,ARX,LNEWREF
    ,ATX,SAVFPL
  2,V1M,SMENTNC
 DONEWL:,BSS,
   ,XTA,LRESTC.NUMBER OF ENTRY FROM OLD
   ,ATI,1.LIBRARY AFTER EXCLUDING
 ADTOI2:,BSS,
  5,UTC,NEWCAT .REWRITING STAHD. ARRAY
  2,VTM,
 ,XTA,=21 12000
 ,ATX,LDRM
 6,VTM,BUFFER
 1,VZM,RDSA
   ,XTA,=2
   ,UTC,DRTAPE .FROM TAPE
   ,ATX,
   ,XTA,LENGLIST
   ,ATI,4
    NEXTWD:,XTA,M3L
   ,UTC,WBEGFLAG
   ,ATX,
   SEEKMAIN:2,MTJ,14
   13,VJM,SKMENTRY
   14,MTJ,2
    1,VZM,MB
   12,J+M,1
    BMB:,ITA,11
    ,ATX,CRD
    MAINENT:,ITA,2
   ,UTC,WBEGFLAG
   ,ATX,1
  3,VTM,-2
 RSTR:,CALL,RDSTAR
  3,UTC,2
   ,STX,STR
  3,VLM,RSTR
   ,XTA,STR
   ,AAX,M4S.HEAD
   ,ATX,LPR
   ,XTS,STR
   ,ASN,64+12
   ,AAX,M4S.DECLARATIONS
   ,ATX,LCALLS
   ,ATX,LDEF
 15,ARX,
   ,XTS,STR
   ,ASN,64+24
   ,AAX,M4S.PAR.EXPRETIONS
 15,ATX,
   ,ARX,LDEF
   ,STX,LDEF
 15,ARX,
   ,XTS,STR
   ,ASN,64+36.CALLS
   ,AAX,M4S
 15,ATX,
   ,ARX,LDEF
   ,STX,LDEF
 15,ARX,
   ,XTS,STR1
   ,ASN,64+30.LONG IDENTIFIERS
    ,AAX,M3L
 15,ATX,
   ,ARX,LDEF
   ,STX,LDEF
 15,ARX,
   ,ATX,N3.LENGTH OF DEF. TABLE
   ,XTA,STR1
   ,AAX,M3L .SET DATA
 15,ATX,
   ,ARX,LPR
   ,ATX,LPR
   ,XTA,STR1
   ,ASN,64+15
   ,AAX,M3L .DATA
 15,ATX,
   ,ARX,LPR
   ,STX,LPR
    15,ARX,
   ,ATX,N2.SET DATA + DATA
   ,XTA,STR2
   ,AAX,M3L.INSTRUCTIONS
 15,ATX,
   ,ARX,LPR
   ,ATX,LPR
   ,XTA,STR2
   ,ASN,64+30.ABS. CONSTS
    ,AAX,M3L
 15,ATX,
   ,ARX,LPR
   ,STX,LPR
 15,ARX,
   ,ATX,LBOD.LENGTH OF PROGRAM BODY
   ,ARX,=2
   ,ATX,R
   ,AAX,=7777 7740
   ,ATX,K1 .NUMBER OF SEGMENTS IN BODY
   ,XTA,R
   ,AAX,=37.LENGTH OF NOT FULL SEGMENT
   ,ARX,N3
   ,ARX,N2
   ,AAX,=7777 7740
   ,ARX,K1
   ,ATX,K1 .FULL NUMBER OF SEGM.-1
   ,XTA,LDRM
   ,ARX,K1
   ,ARX,=40
   ,ATX,DRLT
   ,XTA,LBOD
   ,ARX,N2
   ,ARX,N3
   ,ATX,NPR.LENGTH OF INF. FOR LIBRARY
   ,ITA,
   ,ATX,PRCT
   ,XTA,LDRM
   ,ATX,DRMC
   ,AAX,=1740
   ,ARX,=3
   ,ATX,PGCT
 14,VTM,-2
 STOSTR:14,UTC,2
   ,XTA,STR
   ,WTC,PGCT
 14,UTC,
   6,ATX,-1
 14,VLM,STOSTR
 BGL1:1,VZM,FROMDRM
   ,CALL,RDSTAR .READING FROM TAPE
   ,WTC,PGCT
  6,STX,
   ,XTA,PRCT
   ,ARX,=1
   ,ATX,PRCT
   ,AEX,NPR
   ,UZA,ENPR.IF END OF STAND.ARRAY
   WRPG:,XTA,PGCT
   ,ARX,=1
   ,ATX,PGCT
   ,ASN,64-37
    ,ARX,
   ,U1A,BGL1. IF PAGE NOT FULL
   ,XTA,
   ,ATX,PGCT
    14,VJM,ACLC
   ,*70,ADRUMINF
   ,XTA,DRMC
    ,ARX,=2000
   ,ATX,DRMC
   ,UJ,BGL1
   MB:12,J+M,4
   ,UJ,BMB
 ENPR:14,VJM,ACLC
   ,XTA,DRLT
   ,AAX,=1740
   ,U1A,NOWRT
   ,*70,ADRUMINF
   ,XTA,DRMC
    ,ARX,=2000
   ,ATX,DRMC
 NOWRT:,XTA,LDRM
   ,AAX,=1740
   ,ASN,64-16
   ,AOX,LDRM
   ,AAX,=7777 7777 7777 6000
   ,ASN,64-20
  2,XTS,1
   ,AAX,=77777 00000
 15,AOX,
   ,AOX,=2000 0000 0000 0000
  2,ATX,1
   ,XTA,DRLT
   ,ATX,LDRM
  1,VZM,ENDSADR
  2,UTM,-2
  1,UTM,-2
  1,V1M,NEXTWD
  4,VZM,ENDJOB
 RDSA:,BSS,
 ,XTA,FLDR
 ,UZA,P3
 ,XTA,=1
 ,UJ,P1
 P3:,XTA,=3
 P1:,BSS,
   ,UTC,DRTAPE
   ,ATX, .READING FROM DRUM
   ,UJ,NEXTWD
 FROMDRM:,XTA,LPR
   ,UZA,DEF
   ,NTR,3
   ,A-X,=1
   ,ATX,LPR
   ,CALL,RDSTAR
   ,WTC,PGCT
  6,STX,
   ,UJ,WRPG
 DEF:,XTA,LDEF
   ,UZA,ENPR
   ,NTR,3
   ,A-X,=1
   ,ATX,LDEF
   ,CALL,RDSTAR
   ,UTC,BUFDEF
  3,ATX,
   ,WTC,PGCT
  6,STX,
  3,UTM,1
   ,UJ,WRPG
 ENDSADR:,XTA,
   ,ATX,FLCALL
  2,XTS,
 14,VTM,T6+4
   ,ITS,14
   ,CALL,PT6/G
 12,VTM,T6
  ,XTA,NOLISFL*
  :,U1A,*+1
   ,*64,INF
   ,XTA,
   ,ATX,LNEWREF
   ,ATX,DEFCNT
    ,XTA,LCALLS
   ,ATI,3
   ,XTA,FPLECAT
   ,ATX,SAVFPL
 C7:3,VZM,ENDCALL
   ,XTA,DEFCNT
   ,ARX,=1
   ,ATX,DEFCNT
  3,UTM,-1
   ,WTC,DEFCNT
   ,UTC,BUFDEF
  9,VTM,-1
  9,XTA,
   ,AAX,=1700 0000
   ,AEX,=200 0000
   ,UZA,C7A
   ,AEX,=100 0000
   ,UZA,C7A
   ,AEX,=400 0000
   ,U1A,C7
 13,VJM,ID
   ,XTA,WORD
   ,AAX,=7740 0000 0000 0000
   ,AEX,=1240 0000 0000 0000
   ,U1A,C7
 SCHC:5,MTJ,9
  :,UTC,NEWCAT
  9,XTA,
   ,AEX,WORD
   ,UZA,CALLIB
  9,UTM,-2
   9,V1M,SCHC+1
   ,UJ,C7
 C7A:13,VTM,SCHC
 ID:9,XTA,
   ,ASN,64-25
   ,ARX,
   ,UZA,D1
  9,XTA,
   ,AAX,=7777 7777 0000 0000
 D2:,ATX,WORD
 13,UJ,
 D1:9,XTA,
   ,ASN,64+24
   ,ATI,9
  9,UTM,-4001B
   ,UTC,BUFDEF
  9,XTA,
   ,UJ,D2
 CALLIB:,ITA,9
   ,ATX,SAVCALL
   ,XTA,FLCALL
   ,U1A,PRCALL
 12,VTM,T7
  ,XTA,NOLISFL*
  :,U1A,*+1
   ,*64,INF
   ,ITA,7
   ,ATX,FLCALL
 PRCALL:,XTS,WORD
  11,VJM,PRSTR
   ,XTA,SAVCALL
 13,VJM,WRNEWEC
   ,XTA,LNEWREF
   ,ARX,=1
   ,ATX,LNEWREF
   ,UJ,C7
   ENDCALL:,XTA,FLCALL
   ,UZA,NOTPR
   11,VJM,ENDPR
   NOTPR:,XTA,LNEWREF
   ,UZA,NOCALL
   ,ASN,64-15
   ,AOX,SAVFPL
 NOCALL:,ATX,WORD
   ,ITA,4
   ,ASN,64+1
   ,ATI,14
   ,XTA,WORD
   ,WTC,CRD
   8,VTM,
 LOOPWR:,UTC,NEWRCAT-1
 14,ATX,
  8,VZM,NEXTWDR
 14,UTM,1
   8,UTM,-2
   ,UJ,LOOPWR
 NEXTWDR:2,UTM,-2
  4,UTM,-2
    ,XTA,SAVFPL
    ,ARX,LNEWREF
    ,ATX,SAVFPL
  4,V1M,NEXTWD
 ENDJOB:,XTA,DRLT
   ,AAX,=1740
   ,UZA,REWTP
   ,*70,ADRUMINF
   ,XTA,DRMC
   ,ARX,=2000
   ,ATX,DRMC
   REWTP:,XTA,CW66
   ,AOX,CREW
   ,ATX,WORD
    ,*70,WORD
 PRINFC:,BSS,
   9,VTM,NEWCAT
   ,XTA,DRLT
   9,ATX,
   ,XTA,
   9,ATX,1
   ,NTR,3
   ,XTA,DRMC
   ,A-X,=21 12000
   ,ASN,64+10
   ,ARX,=5
   ,NTR,2
 ,ASN,64-36
 ,AUX,=6H'''7''7''7''7'''
 ,AOX,=6H'17''''''''''17'
   ,ATX,T81
 12,VTM,T8
   ,*64,INF
   ,ITA,5
   ,ASN,64+1
   ,CALL,OCTTDEC
   ,ASN,64-8
   ,AEX,=6H'77'0000'17'
   ,ATX,T91
 12,VTM,T9
   ,*64,INF
 3,VTM,-1023
 ,XTA,
 :,UTC,NEWSTAT
 3,ATX,1023
 3,VLM,*-1
 3,VTM,-4
   ,XTA,CW66
 14,VTM,NEWCAT
   ,ITS,14
   ,ASN,64-20
 15,AOX,
  :,ATX,WORD
    ,*70,WORD
   ,XTA,WORD
   ,ARX,=100 0000 0001
  3,VLM,*-2
   RETURN:,WTC,IR13
   ,UJ,
 REFER:9,XTA,
   ,ASN,64+15
   ,ATI,11.LENGTH OF REFERENCES
  9,XTA,
   ,NTR,3
   ,A-X,=1
   ,ASN,64+2
   ,AAX,M4S
   ,ATI,10.ADRESS OF REFERENCES
  9,XTA,
   ,ASN,64-46
   ,ARX,
   ,UZA,ADR23
   ,ASN,64-1
   ,ARX,
   ,U1A,ADR4
  3,VTM,
   12,UJ,
   ADR4:3,VTM,36
 12,UJ,
   ADR23:,ASN,64-1
   ,ARX,
   ,U1A,ADR2
  3,VTM,24
 12,UJ,
   ADR2:3,VTM,12
 12,UJ,
 READCAT:,ITA,13.READING CATALOG
   ,ATX,IR13
 12,MTJ,5
 1,VTM,
 ,NTR,3
 ,XTA,NEWL
 ,U1A,PRCRD
 8,VTM,*
 ,ITA,8
 ,ITS,12
 15,A-X,
 ,UZA,NOPR
 PRCRD:14,VTM,MONCARD*
 ,ITS,14
 14,UTM,12
 ,ITS,14
 ,XTS,
 ,CALL ,PRINT8
 NOPR:,BSS,
 ,XTA,
 ,CALL,DATAPR*
   ,NTR,3
 ,XTA,NEWL
 ,U1A,ENDRCAT
  8,VTM,CATALOG
   ,ITA,8
   ,ASN,64-20
   ,AOX,CR67
  8,VTM,-3
 LRDCAT:,ATX,CRD
   ,*70,CRD
   ,XTA,CRD
   ,ARX,=100 0000 0001
  8,VLM,LRDCAT
C
C.....  KOГДA-TO B ЭTOM MECTE
C       PAШИД ЧИTAЛ CTATИCTИKY
C
  ,UJ,ERRST
 ,XTA,M3L
  8,VTM,-1023
  :,UTC,TABLE
  8,ATX,1023
  8,VLM,*-1
 1,VTM,-1023
 :,UTC,STATIS
 1,XTA,1023
 ,AAX,=:77777
 ,U1A,ERRST
 1,VLM,*-2
 ,XTA,
 1,VTM,-1023
 :,UTC,STATIS
 1,ARX,1023
 1,VLM,*-1
 TOSUMST:,BSS,
 ,ATX,SUMST
  1,VTM,
 CLC:,UTC,CATALOG+2
  1,XTA,1
   ,AEX,C7ALL
   ,UZA,ENDRCAT
  1,UTM,2
   ,ITA,1
   ,AEX,=3776
   ,UZA,PR1
   ,UJ,CLC
 PR1:12,VTM,T1
   ,*64,INF
 ,SJ,
 ERRST:,XTA,
 1,VTM,-1023
 :,UTC,STATIS
 1,ATX,1023
 1,VLM,*-1
 ,UJ,TOSUMST
 ENDRCAT:8,VTM,-19
 ,XTA,BLANK
 :,UTC,BUFPR
 8,ATX,19
 8,VLM,*-1
 ,XTA,
 ,ATX,LENGLIST
 ,XTA,SUMST
 5,UZA,
 1,UTC,CATALOG  .CYMMY ПO BXOДAM
 14,VTM,.BO BCE BXOД.
 ,ITA,1
 ,ASN,64+1
 ,ATI,8
 LST:13,VJM,SKMENTRY
 10,VTM,
 11,VZM,ELST
 11,UTM,2
 11,MTJ,12
 ,XTA,
 LST1:,UTC,STATIS
 8,ARX,
 8,UTM,-1
 11,UTM,-2
 11,V1M,LST1
 8,UTM,1
 ELST1:10,UTC,STATIS
 8,ATX,
 10,UTM,1
 12,UTM,-2
 12,V1M,ELST1
 ELST:,BSS,
 8,UTM,-1
 14,UTM,-2
 8,V1M,LST
 5,UJ,
 WRNEWEC:,WTC,DSHIFT
   12,VTM,
   12,ASN,64
   ,XTS,FPLECAT
 15,ATX,
   ,ARX,=1
   ,STX,FPLECAT
   ,NTR,3
   ,A-X,=1
   ,ASN,64+2
   ,STI,14
   14,UTM,NEWECAT
 14,AOX,
 14,ATX,
   ,ITA,12
   ,AEX,=77734
   ,UZA,FULLWD
   12,UTM,-12
   ,ITA,12
   FULLWD:,ATX,DSHIFT
   13,UJ,
 ACLC:,XTA,DRMC
   ,ASN,64-27
  ,AUX,=60 0777
   ,ARX,=45 7740
 12,VTM,BUFFER
   ,ITS,12
   ,ASN,64-20
 15,AOX,
   ,ATX,ADRUMINF
 14,UJ,
   FDRM:12,J+M,4
  ,UJ,MAINENT
 EXPR:,BSS,
  ,ITA,9
  ,ATX,ADRB
    9,UTM,CATALOG
   9,XTS,
   14,VTM,T3+2
    ,ITS,14
   ,CALL,PT6/G
   12,VTM,T3
  ,XTA,NOLISFL*
  :,U1A,*+1
   ,*64,INF
    9,MTJ,14
   13,VJM,SKMENTRY
   ,ITA,11
   ,ATX,ADRE
    11,VZM,CALLS
 14,MTJ,6
   11,MTJ,2
 12,VTM,T4
  ,XTA,NOLISFL*
  ,U1A,PRENT
  ,*64,INF
 PRENT:,BSS,
 6,UTC,
   2,XTS,
 9,VTM,15
  ,ITS,9
  ,CALL,PT6/G
    2,UTM,-2
 2,V1M,PRENT
   CALLS:,XTA,
  ,ATX,FLCALL
 8,VTM,-3
 :8,ITS,5
 8,VLM,*
   ,ITS,1
   ,ASN,64+1
  ,ATI,2
 NEXT:,UTC,RCAT-1
 2,XTA,
  ,UZA,NEXTGO
   2,UTC,RCAT-1
   9,VTM,
    12,VJM,REFER
    10,MTJ,4.ADRESS
   11,MTJ,5.LENGTH
 LSEEK:,UTC,ECAT
   4,XTA,
 3,ASN,64
    ,NTR,3
   ,AAX,M4S
  ,A-X,ADRB
   ,U1A,NOCAL
  ,X-A,ADRE
  ,UZA,USING
   NOCAL:5,UTM,-1
 5,VZM,NEXTGO
   ,ITA,3
   ,AEX,=44
   ,U1A,SHIFT
   ,ATI,3
 4,UTM,1
  ,UJ,LSEEK
   SHIFT:3,UTM,12
  ,UJ,LSEEK
 USING:,XTA,FLCALL
  ,U1A,NOHEAD
  ,XTA,=1
  ,ATX,FLCALL
 12,VTM,T5
  ,XTA,NOLISFL*
  ,U1A,NO HEAD
   ,*64,INF
 NOHEAD:,ITA,2
  ,ASN,64-1
  ,ATI,9
  ,UTC,CATALOG
 9,XTS,
   11,VJM,PRSTR
 NEXTGO:2,UTM,-1
 2,V1M,NEXT
   ,XTA,FLCALL
   ,UZA,STX
    11,VJM,ENDPR
   STX:,STX,
 8,VTM,4
 :8,STI,1
 8,UTM,-1
   8,V1M,*-1
   ,XTA,ADRE
 ,ATI,9
   ,ASN,64+1
   ,ATI,10
   10,J+M,4
 ,WTC,ADRB
 9,UTM,
   ,UJ,NEWSTR
C
C
  STATLIB:,BSS,.***
 7,BASE,C
 12,VJM,READCAT
 4,VTM,
 ,XTA,SUMST
 ,U1A,NOEXCL
 12,VTM,NOSTAT
 ,*64,INF
 ,SJ,
C
C
  EXCLIB:,BSS,.***
  7,BASE,C
   12,VJM,READCAT
   4,VTM,
   ,ITA,
   ,ATX,LENGLIST
 2,VTM,LIBLIST
   NEWEXC:1,MTJ,3
  2,XTA,
   ,UZA,NOEXCL
 SEXCENT:,UTC,CATALOG
  3,XTA,
  2,AEX,
   ,UZA,FND
 ENDSEX:3,UTM,-2
  3,V1M,SEXCENT
 EXCLNW:2,UTM,1
   ,UJ,NEWEXC
 FND:,ITA,3
 ,ASN,64+1
 ,ATI,12
 ,UTC,TABLE-1
 12,XTA,
 ,UZA,ENDSEX
   3,UTC,CATALOG
   14,VTM,
   13,VJM,SKMENTRY
   12,J+M,3
   ,ITA,3
   ,ASN,64+1
   ,ATI,14
   ,XTA,
 WRTBL:,UTC,TABLE-1
 14,ATX,
  ,XTA,C48R
 ,UTC,STATIS
 14,ATX,
 ,AEX,C48R
   :11,VZM,EXCLNW
   11,UTM,-2
    14,UTM,1
   ,UJ,WRTBL
   SKMENTRY:12,VTM,
    11,VTM,.NUMBER OF ENTRY-1
   SY1:14,XTA,1
   ,AAX,LIBMASK
   ,U1A,SDOWN
   14,UTM,-2
   12,UTM,-2
   11,UTM,2
   ,UJ,SY1
    SDOWN:14,UTC,
   11,XTA,3
   ,AAX,LIBMASK
   ,U1A,ENDSY
   11,UTM,2
   ,UJ,SDOWN
   ENDSY:13,UJ,
   PRSTR:,WTC,PRCOUNT
   12,VTM,BUFPR
   ,ITS,12
   ,CALL,PT6/G
   ,XTA,PRCOUNT
   ,ARX,=2
   ,ATX,PRCOUNT
   ,AEX,=24
   ,U1A,PRRET
   PRINT:,ATX,PRCOUNT
   12,VTM,BUFPR
  ,XTA,NOLISFL*
  :,U1A,*+1
   ,*64,INF
   12,VTM,-19
   ,XTA,BLANK
   :,UTC,BUFPR
   12,ATX,19
   12,VLM,*-1
   PRRET:11,UJ,
   ENDPR:,ITA,
   ,UJ,PRINT
 INF:12,Z00,
     12,Z00,
       ,010,
      8,,
   PRCOUNT:,OCT,
   BUFPR:,BSS,20
   ,GOST,1H'231'
   BLANK:,GOST,6H
 T1:,GOST,36HOTCYTCTBYET KATAЛOГ БИБЛИOTEKИ CП.'231'
 T2:,GOST,42H            B  БИБЛИOTEKE OTCYTCTBYET'231'
 T3:,GOST,25H ИCKЛЮЧEHA              '231'
 T4:,GOST,12HC BXOДAMИ:'231'
 T5:,GOST,51HИCПOЛЬЗYEMAЯ CЛEДYЮЩИMИ ПPOГPAMMAMИ БИБЛИOTEKИ CП.'231'
 T6:,GOST,37H   BKЛЮЧEHA ПPOГPAMMA               '231'
 T7:,GOST,55HИCПOЛЬЗYЮЩAЯ CЛEДYЮЩИE ПOДПPOГPAMMЫ ИЗ БИБЛИOTEKИ CП.'231'
 T8:,GOST,24HДЛИHA ПOЛHOЙ БИБЛИOTEKИ
 T81:,GOST,12H      3OH'231'
 T9:,GOST,36HKOЛИЧECTBO ПOДПPOГPAMM И BXOДOB
 T91:,GOST,12H      '231'
 T10:,GOST,36HOTKYДA БPATЬ BKЛЮЧAEMЫE ПPOГPAMMЫ'231'
 T11:,GOST,36HHA MЛ 67 ЛИЧHOЙ БИБЛИOTEKИ HET'231'
 HPROG:,TEXT,8HPROGRAM
 NOSTAT:,GOST,23HOTCYTCTBYET CTATИCTИKA'231'
 NENTR:,OCT,
 NLST:,OCT,
 SUMST:,OCT,
 NEWL:,OCT,
 FLDR:,OCT,
 CR67:,OCT,0010 0000 0065
 CW66:,OCT,0000 0000 0066
    LIBMASK:,OCT,57777
 NLIS:,OCT,7777 4077 7777
    C7ALL:,OCT,7777 7777 7777 7777
 CREW:,OCT,003
 C48R:,OCT,4
 M4S:,LOG,7777
 M3L:,LOG,77777
    DSHIFT:,BSS,1
    LRESTC:,BSS,
    SAVCALL:,BSS,
    ADRB:,BSS,1
   NNEW:,BSS,
    DEFCNT:,BSS,
    ADRE:,BSS,1
   FPLECAT:,BSS,1
   LPR:,BSS,1
   LDEF:,BSS,1
 WORD:,BSS,1
 IR13:,BSS,1
 CRD:,BSS,1
 LENGLIST:,BSS,1
 FLCALL:,BSS,1
 SAVFPL:,BSS,1
 LNEWREF:,BSS,1
 ADRUMINF:,BSS,1
 LCALLS:,BSS,1
 LOLDC:,BSS,1
 STR :,BSS,1
 STR1:,BSS,1
 STR2:,BSS,1
 LDRM:,BSS,1
 N2:,BSS,
 NPR:,BSS,1
 N3:,BSS,
 PRCT:,BSS,1
 LBOD:,BSS,
 PGCT:,BSS,1
 R:,BSS,
 DRMC:,BSS,1
 K1:,BSS,
 DRLT:,BSS,1
   ,END,
 NEWSTR:,NAME,
  NOLISFL*:,LC,1
  *NZ1*:,LC,1
  *P*:,PC,2048
 Q:,P/P,(*P*)16
 *CLNEWS*:LC,BLOCK,TT,Z,F,ONE(84),LZ
 ,CONT,FLOLD,LT
 W:I,BLOCK,(1),U,S
  C:8,BASE,C
 ,ATI,9
 13,MTJ,12
 ,NTR,6
 11,VTM,*P*.PAGE'S BASE
 ,XTA,LT
 ,U1A,NC1.NOT 1-ST CALL
 ,XTA,TT
 ,APX,=6H'7''7'''''''''
 ,ASN,64+30.MATH. NUMBER
 ,AOX,CIN.INF. WORD
 ,ATX,LT.WITHOUT N ZONE
 NC1:9,XTA,.PAGE'S POINT
 9,VTM,-84
 LOOPW:,ARX,=1.INCREMENTING
 ,AAX,=I1023.THE POINT BY
 ,ATX,F.RING WAY
 ,ASN,64-4
 ,U1A,NOTB.NOT BORD
 ,XTA,FLOLD
 ,U1A,ZONEIS
  14,VTM,NOTTEX
  13,VTM,TAPE
  GIVEME:,ENTRY,
  8,VTM,C
 ,NTR,7
 ,XTA,Z.CURRENT N ZONE
 ,A+X,=I1
 ,ATX,Z
 ,AEX,LZ
 ,NTR,6
  14,UZA,
 ,XTA,Z
 ,AEX,LT
 ,ATX,W.INF WORD
  13,UJ,
  TAPE:,BSS,
   ,UTC,*NZ1*
   ,ATX,
 ,TAPE,W
 ZONEIS:,XTA,
 ,ATX,FLOLD
 NOTB:,WTC,F
 11,XTA,.NEW WORD
 ,UZA,NOTTEX
 LOOPS:,UZA,NEWW.FOR NEW WORD
 ,ASN,64-8
 ,ATX,U
 ,YTA,
 ,ATX,S.NEW SYMBOL
 ,AEX,=12
 12,UZA,.NL,NORM.RETURN
 ,XTA,S
 ,ARX,=7777 7777 7777 7740
 ,UZA,NOTTEX.S.LT.40B
 ,ARX,=7777 7777 7777 7637
 ,U1A,BLANKS.S.GE.200B
 ,XTA,S
 ,ASN,64-40.CREATING THE
 ,AOX,=1H''.(1H)TYPE WORD
 14,VJM,WRW
 TONEWS:,XTA,U.FOR NEXT
 ,UJ,LOOPS.SYMBOL
 BLANKS:,ATI,10.N BLANKSH1
  ,XTA,=1H
 14,VTM,LOOPBL
 LOOPBL:10,UTM,-1
 10,VZM,TONEWS.THERE ARE NOT
 WRW:9,VZM,NOTTEX.SUBROUTINE
 9,ATX,ONE+84.FOR WRITE
 9,UTM,1.ONE SYMBOL
 14,UJ,.WITH PLACE TEST
 NEWW:,XTA,F
 ,UJ,LOOPW.FOR NEXT WORD
 NOTTEX:,XTA,=I1.RETURN WHEN
 12,UJ,.IT ISN'T TEXT
 CIN:13,010,Q
 ,000,
 I10T8:,ENTRY,
 ,ATI,14
  8,VTM,C
   ,XTA,=I0
 14,AOX,
  ,XTS,=I1
   ,XTS,NOLISFL*
   ,UZA,SETFL
   ,XTA,=1
   SETFL:,BSS,
   15,AEX,
   ,UTC,*NZ1*
  ,STX,
  ,NTR,6
 13,UJ,
 W:,BSS,3
 ,END,
 NUMFOR:,NAME,
C
C**************** A.E.ФEДЮHЬKИH 19/04/82
C*
C*      FUNCTION NUMFOR(N)
C*
C*   OПPEДEЛЯET ФOPMY CYЩECTBИTEЛЬHЫX,
C*   YПOTPEБЛЯEMЫX C KOЛИЧECTBEHHЫM
C*   ЧИCЛИTEЛЬHЫM N.
C*
C*   B PYCCKOM ЯЗЫKE  CYЩECTBYET TPИ
C*   TAKИX ФOPMЫ:
C*   NUMFOR=1, ИMEHИTEЛЬHЫЙ ПAДEЖ EДИH-
C*           CTBEHHOГO ЧИCЛA.
C*   NUMFOR=2, POДИTEЛЬHЫЙ ПAДEЖ EДИH-
C*           CTBEHHOГO ЧИCЛA.
C*   NUMFOR=3, POДИTEЛЬHЫЙ ПAДEЖ MHO-
C*           ЖECTBEHHOГO ЧИCЛA.
C*
C*   ПPИMEPЫ:
C*   NUMFOR=1 - 1 ЧAC, 1  MИHYTA,1 CTOЛ,
C*             21 OKHO.
C*   NUMFOR=2 - 2 ЧACA, 3 MИHYTЫ, 3 OK-
C*             HA, 1244 CTOЛA.
C*   NUMFOR=3 - 5 ЧACOB, 10 MИHYT, 8 CTO-
C*             ЛOB, 9 OKOH, 5 HAПOЛEOHOB.
C*
C*   OБPAЩEHИE - CTAHДAPTHOE.
C*   ИCПOЛЬЗYЮTCЯ БEЗ BOCCTAHOBЛEHИЯ
C*   10,11,12,14 PEГ., BOЗBPAT ПO 13 PEГ.
C*   PEЖИM HA BXOДE HE CYЩECTBEHHEH, OH
C*   BOCCTAHABЛИBAETCЯ.
C*
C*   ПOPЯДOK N HECYЩECTBEHEH, MЛAДШИE
C*   41 PAЗPЯД  N ИHTEPПPETИPYЮTCЯ
C*   KAK ЦEЛOE ЧИCЛO CO ЗHAKOM.
C*   ПOPЯДOK PEЗYЛЬTATA COBПAДAET C
C*   ПOPЯДKOM N.
C*
 ,ATI,14
 ,RTE,77B
 14,XTS,
 12,BASE,*
 ,AAX,=:774
 14,XTS,
 ,NTR,7
 14,AVX,
 15,AEX,-1
 15,ATX,
 ,A*X,=4000121727024366
 ,ASN,64-2
 15,ATX,
 ,ASN,64-3
 15,ATX,
 ,ASN,64-1
 15,ARX,
 15,ARX,
 15,X-A,
 15,ATX,
 ,A*X,=4001463146314632
 11,VTM,3
 ,ATI,14
 ,ASN,64-1
 15,ATX,
 ,ASN,64-2
 15,ARX,
 15,X-A,
 14,UTM,-1
 14,VZM,RET
 ,ATI,10
 ,A-X,=5
 10,VZM,RET
 10,UTM, -1
 ,UZA,RET
 11,VTM,1
 10,VZM,RET
 11,VTM,2
 RET:,ITA,11
 15,AEX,
 15,XTR,
 13,UJ,
 ,END,
 NUSTOID:,NAME,
C******  12/04/85  ДABЫДOB A.Л.
C*
C*     14,CALL,NUSTOID
C*
C*   - ПPEOБPAЗOBAHИE HOMEPA ПOЛЬЗOBA-
C*  TEЛЯ ПO TPASS B ДBYXCИMBOЛЬHЫЙ ID.
C*
C*     OБPAЩEHИE:  HA CYMMATOPE B PAЗ-
C*  PЯДAX  10:01 HOMEP ПOЛЬЗOBATEЛЯ.
C*
C*     OTBET  HA CYMMATOPE:  ДBA ЛEBЫX
C*  БAЙTA - ID, OCTAЛЬHЫE ЧETЫPE БAЙTA
C*  - ПPOБEЛЫ (KOД ISO).
C*
C*    14,CALL,IDTONUS
C*
C*  - OБPATHOE ПPEOБPAЗOBAHИE.
C*  ПPИ OБPAЩEHИИ HA CYMMATOPE - ID,
C*  OTBET - HA CYMMATOPE B P.P. 10-01,
C*  OCTAЛЬHЫE PAЗPЯДЫ PABHЫ HYЛЮ.
C*  KOHTPOЛЬ ID HE ПPOИЗBOДИTCЯ.
C*
C*    14,CALL,IDCHECK
C*
C*  - AHAЛOГ IDTONUS, HO C KOHTPOЛEM
C*  ID. B CЛYЧAE OШИБKИ  HA  CYMMATOPE
C*  HOЛЬ, ИHAЧE - NUS B 1-10 PAЗPЯДAX.
C*
C*     B O З B P A T  ПO  I14.
C*  PEЖИM HA BXOДE  HECYЩECTBEHEH,  OH
C*  HE MEHЯETCЯ.  PEГИCTPЫ  HE ИCПOЛЬ-
C*  ЗYЮTCЯ.  ИCПOЛЬЗYETCЯ MAГAЗИH ( 5
C*  ЯЧEEK).
C**************************************
 NUSTOID:,BSS,
 ,ASN,64+10
 ,YTA,
 ,UTC,=2H'37''37'
 ,AUX,
 ,UTC,=2H'1''1'
 ,ARX,
 15,ATX,2
 ,UTC,=6H'7''7'''''''''
 ,ARX,
 ,UTC,=6H'40''40'''''''''
 ,AAX,
 15,ATX,
 ,ASN,64+1
 15,AOX,-1
 ,ASN,64+1
 15,ARX,1
 15,STX,1
 ,UTC,=6H'40''40'''''''''
 ,AEX,
 ,ASN,64-1
 RT:15,AOX,2
 14,UJ,
 IDTONUS:,ENTRY,
 IDTONUS:,BSS,
 ,UTC,=6H'77''77'.-1
 ,ARX,
 15,ATX,
 ,UTC,=6H'40''40'''''''''
 ,AAX,
 15,ATX,
 ,ASN,64+2
 15,AOX,
 15,AEX,
 ,UTC,=2H'37''37'
 ,APX,
 ,ASN,64-10
 ,YTA,
 14,UJ,
 IDCHECK:,ENTRY,
 ,ITS,14
 15,XTS,-2
 14,VJM,IDTONUS
 15,ATX,
 14,VJM,NUSTOID
 15,WTC,-2
 14,VTM,
 15,UTM,-2
 15,AEX,
 ,UZA,RT
 ,XTA,
 14,UJ,
 ,END,
  NZEDIT:,NAME,
C*
C***  25.5.88.  A.П.CAПOЖHИKOB
C*
C*       NZ = NZEDIT( K )
C*   ПOЛYЧEHИE ИHФOPMAЦИOHHOГO CЛOBA TEKY-
C*   ЩEГO OБMEHA ПPИ PAБOTE C ПPOГPAMMAMИ
C*   ПAKETHOГO PEДAKTOPA A.И.BOЛKOBA
C*   WRCARD (K=0)  И  RECARD (K=1).
C*   ЗAMEЧAHИE:  ПPИ OБPAЩEHИИ K NZEDIT(0)
C*   ПOCЛE "WRIEND" HOMEP ЗOHЫ БYДET HA 1
C*   БOЛЬШE ПOCЛEДHEЙ ЗAПИCAHHOЙ.
C*
C*      M = MONCRD( K )
C*   ПOЛYЧEHИE K-ГO CЛOBA (K=1,2,...,14)
C*   EЩE HE BBEДEHHOЙ KAPTЫ (MONCARD*)
C*   BOЗMOЖHO БYДET ПOЛEЗHA TEM, KTO ПИШET
C*   TPAHCЛЯTOPЫ.
C*
  XWRITE/:,LC,2
  XREAD/:,LC,2
  MONCARD*:LC,BLOCK,MC(14)
C
  ,ATI,14
  14,WTC,
  14,VTM,
  12,VTM,XWRITE/
  :14,VZM,*+1
  ,UTC,XREAD/-XWRITE/
  :12,XTA,1
  13,UJ,
C
  MONCRD:,ENTRY,
  ,ATI,14
  14,WTC,
  ,XTA,MC-1
  13,UJ,
  ,END,
  ORD:,NAME,
C*
C*
C********  16.10.79.  A.П.CAПOЖHИKOB.
C*
C*   USER-SUBROUTINE PEДAKTOPA TEKCTOB
C*   YПOPЯДOЧEHИE TEKCTOB ПPOГPAMM ПO
C*   AЛФABИTY. COPTИPOBKA HA ФOPTPAHHЫE
C*   И ABTOKOДOBCKИE TEKCTЫ.
C*
C*      B Ы З O B :
C*   *EDIT
C*   *R:<OTKYДA>
C*   *W:<KYДA>
C*   *U:ORD
C*    < ЗДECЬ M.Б. CTAHД.PEДAKЦИЯ >
C*   *EE
C*
C*   CTPYKTYPA BЫXOДHOГO ФAЙЛA :
C*   I------------------------------I
C*   I  KAPTA  *     <KOMMEHTAPИЙ>  I
C*   I------------------------------I
C*   I  TEKCTЫ ФOPTPAHHЫX ПPOГPAMM  I
C*   I  YПOPЯДOЧEHHЫE ПO AЛФABИTY   I
C*   I------------------------------I
C*   I  KAPTA  *ASSEMBLER           I
C*   I------------------------------I
C*   I  TEKCTЫ ABTOKOДHЫX ПPOГPAMM  I
C*   I  YПOPЯДOЧEHHЫE ПO AЛФABИTY   I
C*   I------------------------------I
C*
C*
C*   ДOПOЛHИTEЛЬHЫE BOЗMOЖHOCTИ :
C*   PEAЛИЗYЮTCЯ ПPИ HAЛИЧИИ ПAPAMETPA-
C*   -KAPTЫ, HAЧИHAЮЩEЙCЯ CИMBOЛOM  '='
C*   PACПOЛOЖEHHOЙ CPAЗY ПOCЛE  *U:ORD .
C*   CЛEДYЮЩИE ЗA '=' CИMBOЛЫ (ПOPЯДOK
C*   ИX HECYЩECTBEH) OЗHAЧAЮT :
C*     D - БЛOKИPOBKA ЗAПИCИ ДYБЛИKATOB
C*         T.E. ECЛИ B ИCXOДHOM ФAЙЛE
C*         ECTЬ HECKOЛЬKO BEPCИЙ OДHOЙ
C*         И TOЙ ЖE ПPOГPAMMЫ, B BЫXOД-
C*         HOЙ ФAЙЛ ПOПAДAET ЛИШЬ
C*         ПOCЛEДHЯЯ.
C*     Q - BЫXOДHOЙ ФAЙЛ HYMEPYETCЯ
C*         ПPOЦEДYPOЙ  QN .
C*     L - ПEPEД KAPTOЙ  *ASSEMBLER  B
C*         BЫXOДHOЙ ФAЙЛ BCTABЛЯETCЯ
C*         KAPTA  *STANDART LIST
C*     R - *FULL LIST
C*     0 - *NO LIST
C*     A - БЛOKИPOBKA BCTABKИ KAPTЫ *ASSEMBLER
C*     M - BMECTO KAPTЫ *ASSEMBLER
C*         BCTABЛЯETCЯ  *MADLEN,L=R.
C*                 ИЛИ  *MADLEN,L=0.
C*   CИMBOЛЫ ИЗ 7-66 ПOЗИЦИЙ KAPTЫ-ПAPAMETPA
C*   ПEPEHOCЯTCЯ B ПEPBYЮ KAPTY BЫXOДHOГO
C*   ФAЙЛA. TYДA ЖE BCTABЛЯЮTCЯ TEKYЩИE
C*   ДATA И ACTPOHOMИЧECKOE BPEMЯ.
C*
C*      П P И M E P Ы :
C*    *U:ORD
C*    =RDQ
C*    *U:ORD
C*    =0
C*     *U:ORD
C*     =Q    YПOPЯДOЧИЛ ИBAHOB И.И.
C*
C**************************************
C*
  XREAD/:,LC,2
  XWRITE/:,LC,2
  PRINT8//:,SUBP,
  RECARD  :,SUBP,
  CHKBEG* :,SUBP,
  CHKEND* :,SUBP,
  MFOR*:,LC,1
  NAME*:,LC,2
  NAM*LIST:LC,BLOCK,NAM(10000)
  ,CONT,CARD(14)
  OCTTDEC :,SUBP,
  QN      :,SUBP,
C...
  B:8,BASE,B.=====
  ,STI,14
  ,ATI,9
  ,ITA,13
  ,ATX,RET
  ,XTA,REG
  ,U1A,ANAL
  ,ITA,14
  ,ATX,SERV
  13,VJM,PUTADR
  ,XTA,=1
  ,ATX,REG
  9,XTA,
  ,AEX,=6H=
  ,ASN,64+40
  ,U1A,ANAL
  9,XTA,
  ,ATX,REG
  10,VTM,-9
  14,VTM,COMTEX+1
  ,ITS,14
  ,CALL,DATE
  :10,UTC,9
  9,XTA,1
  10,UTC,9
  ,ATX,COMTEX+4
  10,VLM,*-2
  13,VTM,EXIT
  14,VTM,COMTEX
  ,ITS,14
  ,WTC,SERV
  ,UJ,
C---
  ANAL:9,XTA,
  ,AEX,READ
  ,ASN,64+8
  9,XTS,1
  ,AEX,OLD
  ,ASN,64+24
  15,AOX,
  ,UZA,EFIL
C---
  ,WTC,GO
  13,VJM,CHK
  8,BASE,B.=====
  13,VTM,EXIT
  14,VZM,PUTADR
  14,VTM,
  ,XTA,GO
  ,AEX,=1
  ,ATX,GO
  ,UZA,PUTADR
  14,VTM,MFOR*
  14,XTA,
  ,UZA,COUNT
  ,XTA,=1
  14,ATX,
  COUNT:,BSS,
C---
  ,WTC,MFOR*
  ,XTA,ACOUN
  ,ARX,=1
  ,WTC,MFOR*
  ,ATX,ACOUN
  12,VTM,NAME*
  ,WTC,POIN
  14,VTM,
  ,AAX,=:4
  12,AOX,
  14,ATX,
  ,ITA,14
  12,ARX,1
  14,ATX,1
  14,UTM,4
  ,ITA,14
  ,ATX,POIN
  14,VTM,
C---
  PUTADR:12,VTM,XREAD/
  ,WTC,POIN
  10,VTM,
  12,XTA,
  14,VZM,NOCL
  ,AAX,=7777 7777 7777 6000
  NOCL:10,ATX,2
  12,XTA,1
  10,ATX,3
  13,UJ,
C---
  FIN:10,VTM,READ
  13,VJM,SWOPC
C---
  EXIT:8,BASE,B
  ,XTA,RET
  ,STI,13
  13,UJ,
C
C---
C
  EFIL:9,VTM,-1
  10,VTM,TASS-1
  PRIN:9,XTA,FCOUN
  10,UTM,1
  ,CALL,OCTTDEC
  10,ATX,1
  ,ITS,10
  10,UTM,1
  ,ITS,10
  ,XTS,=20
  ,CALL,PRINT8//
  9,VLM,PRIN
C---
C
C---  C O P T И P O B K A
C
  ,XTA,ACOUN
  ,ARX,FCOUN
  ,AOX,=I0
  ,ATX,WS
  14,VTM,NAM
  ,ITS,14
  14,VTM,WS
  ,ITS,14
  14,VTM,=I4
  ,ITS,14
  14,VTM,=I0
  ,ITS,14
  ,CALL,SHSORT
  8,BASE,B
  10,VTM,NAM
C
C...   ИЗЬЯTИE ДYБЛEЙ
C
  ,XTA,=6HDDDDDD
  14,VJM,LETTER
  ,ATI,12
  ,UZA,DDUBL
  12,VTM,=6HИCKЛ.
  ,UJ,DDUBL
  NO DUBL:10,UTM,4
  ,UJ,DDUBL
  DEL:10,MTJ,11
  12,VZM,NO DUBL
  :11,XTA,4
  11,ATX,
  11,UTM,1
  ,U1A,DEL+1
  DDUBL:10,XTA,
  ,UZA,SLIV
  10,AEX,4
  ,U1A,NO DUBL
  10,XTA,1
  10,AEX,5
  ,ASN,64+32
  ,U1A,NO DUBL
  15,MTJ,9
  ,XTA,=6HДYБЛЬ:
  10,XTS,
  ,ASN,64-1
  ,ASN,64+1
  10,XTS,1
  ,AAX,=:7777 74
  ,AOX,=6H''''
  12,XTS,
  ,ITS,9
  9,UTM,3
  ,ITS,9
  9,UTM,-3
  ,XTS,=20
  ,CALL,PRINT8//
  PRIND2:9,MTJ,15
  ,UJ,DEL
C
C---   C Л И B :
C
  SLIV:,XTA,FCOUN
  ,UZA,NOCA
  ,XTA,=6HAAAAAA
  14,VJM,LETTER
  ,UZA,ISCA
  ,XTA,
  NOCA:,ATX,FLASS
  9,VTM,NAM
  ,XTA,=6HQQQQQQ
  ,UTC,MFOR*
  ,ATX,
  14,VJM,LETTER
  ,UZA,NON
  ,XTA,=1
  NON:,ATX,SWIT
  ,UJ,NC
  ISCA:,XTA,=:4
  ,UJ,NOCA
C---
  LETTER:,AEX,REG
  ,ARX,=6H'177''177''177''177''177''177'
  ,AAX,=6H'200''200''200''200''200''200'
  ,AEX,=6H'200''200''200''200''200''200'
  14,UJ,.CYMM.=0 - HET CИMBOЛA
C---
C
  NC:9,XTA,
  ,UZA,FIN
  ,AAX,=:4
  ,UZA,NOASS
  ,AAX,FLASS
  ,UZA,CLMF
  ,ITA,9
  ,ATX,POIN
  10,VTM,TCS
  12,VTM,-2
  LRC:10,XTA,2
  14,VJM,LETTER
  ,UZA,ELRC
  13,VTM,WRA
  10,XTA,2
  ,AEX,MADLEN+1
  ,AAX,=17 7400
  ,AEX,MADLEN+1
  ,ATX,MADLEN+1
C---
  SWOPC:,ITA,13
  15,ATX,
  ,ITS,10
  ,WTC,SWIT
  13,VJM,STAND
  8,BASE,B.=====
  ,STI,
  ,ATI,13
  13,UJ,
  STAND:,WTC,SERV
  ,UJ,
  :,XTS,SERV
  ,UJ,QN
C---
  ELRC:10,UTM,3
  12,VLM,LRC
C---
  WRA:,XTA,=6HMMMMMM
  14,VJM,LETTER
  :,UZA,*+1
  ,UTC,MADLEN-CASS
  :10,VTM,CASS
  13,VJM,SWOPC
  ,XTA,
  ,ATX,FLASS
  ,WTC,POIN
  9,VTM,
  CLMF:,UTC,MFOR*
  ,ATX,
C---
  NOASS:11,VTM,XREAD/
  10,VTM,CARD
  9,XTA,3
  11,AEX,1
  ,UZA,BUFIS
  9,*70,3
  BUFIS:9,XTA,2
  11,ATX,
  9,XTA,3
  11,ATX,1
  ,ITA,9
  ,ATX,POIN
  ,ITA,10
  ,ATX,WS
C---
  RP:,XTS,WS
  ,CALL,RECARD
  8,BASE,B.=====
  ,WTC,WS
  10,VTM,
  13,VJM,SWOPC
  ,XTS,WS
  ,CALL,CHKEND*
  8,BASE,B.=====
  14,VZM,RP
  ,WTC,POIN
  9,VTM,4
  ,UJ,NC
  CHK:,ITS,9
  ,UJ,CHKBEG*
  :,ITS,9
  ,UJ,CHKEND*
  GO:,LOG,
C
C-------------------------------
C
  COMTEX:,ISO,6H*
  :,BSS,14
  POIN:,,
  ,Z00,NAM
  READ:,ISO,6H*READ
  OLD :,ISO,6HOLD'312''12''12'
  WS:,BSS,1
  ACOUN:,OCT,4
  FCOUN:,OCT,
  TASS:,ISO,24HACCEM:000000ФOPTP:000000
  MADLEN:,ISO,12H*MADLEN,L=L.
  ,ISO,6H'306''12'   '12'
  CASS:,ISO,12H*ASSEM'315''12'   '12'
  TCS :,ISO,18H*STAND'315''12'   '12'LLLLLL
      :,ISO,18H*FULL '315''12'   '12'RRRRRR
      :,ISO,18H*NO LI'315''12'   '12'000000
  :,BSS,16.OT ГAДA
  :,LOG,.BOЛKOBA
  FLASS:,BSS,1
  SERV :,BSS,1
  SWIT :,BSS,1
  REG  :,BSS,1
  RET  :,BSS,1
  ,END,
 PACПAK:,NAME,.
 *MINF*:LC,BLOCK,(5),LREAD,SC CA(4),UCA(74)
 *8:,BLOCK,B,PC,L,LR,R,W,S
C
C*****   PACПAKOBKA KAPTЫ B 74 CЛOBA
C        (72-CИMBOЛЫ , 2-HOMEP)
C
 BAS:B,BASE,*.
 ,ATI,PC.
 ,ITA,13.
 ,ATX,I13.
 L,VTM,1-4.
 ,XTA,.
 CL SC:L,UTC,SC CA+3.
 ,ATX,.
 L,VLM,CL SC.
 L,VTM,-12.
 LR,VTM,1.
C.....   POCПИCЬ PEЗYЛЬTATA ПPOБEЛAMИ
 R,VTM,1-72.
 ,XTA,BLANK.
 PUT BL:R,UTC,UCA+71.
 ,ATX,.
 R,VLM,PUT BL.
C.....
 W,VTM,UCA.
 READ S:,XTA,WORD.
 ,UZA,W NEW.HOBOE CЛOBO
 W OLD:LR,UTM,-1.
 ,ASN,64-8.
 ,ATX,WORD.
 ,YTA,.
 ,AOX,INT0.
 W,ATX,.
 W,UTM,1.
 ,AEX,BLANK.
 ,UZA,READ S.БЫЛ ПPOБEЛ
C.....   B ШKAЛY ИCПOЛЬЗ.CИMBOЛOB
 LR,MTJ,R.ПOCЛ. HE ПPOБEЛ
 W,XTA,-1.
 ,AAX,C37.
 ,ATI,S.
 ,XTA,B48.
 S,ASN,64.
 W,XTS,-1.
 ,ASN,64+5.
 ,STI,S.
 S,UTM,SC CA.
 S,AOX,.
 S,ATX,.
 ,UJ,READ S.
 W NO BL:PC,XTA,-1.CЛOBO -
 ,UJ,W OLD.HE ПPOБEЛЫ
 CHE BL:,AEX,W BLAN.
 ,UIA,W NO BL.
C.....   CЛOBO - BCE ПPOБEЛЫ
 W,UTM,6.
 LR,UTM,-6.
 W NEW:PC,XTA,.
 PC,UTM,1.
 L,VLM,CHE BL.
C.....   ЗAПИCЬ HOMEPA
 W,ATX,.
 PC,XTA,.
 W,ATX,1.
C.....   CЧETЧИK ДO ПOCЛ. HE ПPOБEЛA
 ,ITA,R.
 ,UTC,LREAD.
 ,STX,.
C.....   BOЗBPAT
 ,WTC,I13.
 ,UJ,.
C
 ЗAПAK:,ENTRY,.
C
C*****   ЗAПAKOBKA KAPTЫ B 14 CЛOB
C
 B,BASE,BAS.
 ,ATI,PC.
 R,VTM,UCA.
 L,VTM,1-12.
 WRIT W:S,VTM,1-6.
C.....   CБOPKA CЛOBA
 WRIT S:,ASN,64-8.
 R,XTS,.
 ,AAX,C177.
 15,AOX,.
 R,UTM,1.
 S,VLM,WRIT S.
C.....   ЗAПИCЬ B PEЗYЛЬTAT
 PC,ATX,.
 PC,UTM,1.
 L,VLM,WRIT W.
C.....   ЗAПИCЬ HOMEPA
 R,XTA,.
 PC,ATX,.
 R,XTA,1.
 PC,STX,1.
 13,UJ,.
 MAKESC:,ENTRY,.
C
C*****   ПOЛYЧEHИE ШKAЛЫ ЭTAЛOHA
C
 B,BASE,BAS.
 ,STI,R.ШKAЛA
 ,ATI,L.ЭTAЛOH
 LR,VTM,1-4.
 CLSCET1:,XTA,.
 LR,UTC,3.
 R,ATX,.
 LR,VLM,CLSCET1.
 MAK 1:L,XTA,.
 ,UZA,RET.
 ,AAX,C37.
 ,ATI,S.
 ,XTA,B48.
 S,ASN,64.
 L,XTS,.
 ,ASN,64+5.
 ,STI,S.
 R,J+M,S.
 S,AOX,.
 S,ATX,.
 L,VLM,MAK 1.
 RET:,STX,.
 13,UJ,.
C-----
 W BLAN:,ISO,6H
 BLANK:,INT,32.
 INT0:,INT,0.
 B48:,OCT,4.
 C177:,LOG,177.
 C37:,LOG,37.
 I13:,BSS,1.
 WORD:,BSS,1.
C-----
 ,END,.
 PARAMT:,NAME,.(KOM)
C******PARAMT:,NAME,.(KOM)
C* BЫЗOB PARAMT* ИЗ ФOPTPAHA
C*     CALL PARAMT(KOM)
C*PEЗYЛЬTAT-B KOM ДЛЯ 2,4,5,7(ДЛЯ 7-INTEGER)
C*(ПPИ OШИБKE KOM=0B,COOБЩEHИЙ HET)
C*(ПPИ OTCYTCTB.ПAPAMETPA KOM HE ИЗMEHЯETCЯ)
C*ЛИБO B COMMON/MONCRD/I(12)
C*   (CM.OПИCAHИE PARAMT*).
C* CALL PARMON(A) -ПEPEПИCЬ A(14) B MONCARD/
 *MONCRD*:,LC,12
 MONCARD/:,LC,14
 MST10*:LC,BLOCK,MIS,CODE,NUMB
 OUT*OUT:,LC,1
 10,VTM,0
 ,UJ,WORK
 PARMON:,ENTRY,
 10,VTM,1
 WORK:,BSS,
 ,ATI,9
 ,ITA,13
 ,UTC,RET
 ,ATX,
 10,VZM,PARS
 10,VTM,-13
 CYC:,BSS,
 9,UTC,13
 10,XTA,
 10,UTC,MONCARD/+13
 ,ATX,
 10,VLM,CYC
 ,UJ,CONT
 PARS:9,XTA,
 ,UTC,OUT*OUT
 ,ATX,
 ,ATI,10
 ,ASN,64+48
 ,UTC,*MONCRD*
 ,ATX,
 ,CALL,PARAMT*
 14,VZM,NOERR
 ,ASN,64-48
 9,ATX,
  ,UJ,CONT
 NOERR:12,VZM,CONT. PARAM ABSENT
 10,UTM,-7
 10,V1M,CONT
 9,XTA,
 ,UTC,=:64
 ,AOX,
 9,ATX,
 CONT:,STX,
 ,WTC,RET
 ,UJ,
 RET:,BSS,1
 ,END,
 PARM*:,NAME,.31.05.80
C****************************************
C*    31/06-80         ДABЫДOB A.Л.
C*
C*         PAЗБOP  TEKCTOBOЙ  CTPOKИ
C*........................................
C*          -= O Б P A Щ E H И E =-
C*
C*    LC MONCARD/ - PAЗБИPAEMAЯ CTPOKA
C*    И.P.10 - PEЖИM PAБOTЫ (TИП ПAPA-
C*             METPA):
C*         0 - YCTAHOBKA ПOД ПEPBЫЙ PAЗ-
C*             ДEЛИTEЛЬ
C*         1 - TEKCT C ПPOБEЛAMИ
C*         6 - TEKCT БEЗ ПPOБEЛOB
C*         9 - YCTAHOBKA HA HAЧAЛO CTPOKИ
C*.......................................
C*         -= P E З Y Л Ь T A T =-
C*
C*    LC *MONCRD* - ПAPAMETP
C*    И.P. 11 - KOД PAЗДEЛИTEЛЯ
C*    И.P. 12 - ЧИCЛO CИMB. B ПAPAMETPE
C*    CYMMATOP:
C*    B01-06 - KOЛ-BO CИMBOЛOB B CTPOKE
C*             ПEPEД ПAPAMETPOM
C*    B25-30 - KOЛ-BO ПPOБEЛOB, ПPOПY-
C*             ЩEHЫX ПPИ PAЗБOPE ПAPA-
C*             METPA.
C****************************************
 TABSIMIS:,SUBP,
 /MONCRD/:LC,BLOCK,MONCARD/(25)
 *MONCRD*:,LC,12
 /PARAM:LC,BLOCK,LIT,(1)
 ,CONT,OCT,DEC
 PARSAME:,LC,1
 B:,BSS,
 ,ITA,10
 ,ITS,9
 ,ITS,8
 ,ITS,7
 ,ITS,6
 ,ITS,5
 ,ITS,
 7,BASE,B
 14,VTM,TEXT
 14,MTJ,9
 10,VZM,NEWSTR.0
 10,UTM,-1
 10,MTJ,9
 10,VZM,TEXT.1
 10,UTM,1-6
 10,VZM,TEXT.6
 10,UTM,6-9
 14,VTM,RETURN
 10,VZM,NEWSTR.9
C     OШИБOЧHOE OБPAЩEHИE
 10,UTM,9
 ,ITA,13
 ,ASN,64-33
 ,AUX,=6H'''7''7''7''7''7'
 ,AOX,=6H 00000
 ,ATX,ERRT+5
 ,ITA,10
 ,AUX,=6H'''7''7''7''7''7'
 ,AOX,=6H=00000
 ,ATX,ERRT+7
 12,VTM,ERRT
 ,*71,IW12
 ,ITA,12
 ,CALL,PRINT8/M
 13,VTM,*74
 ,UJ,RETURN
 *74:,*74,........
C........................................
 TEXT:,BSS,
 ,XTA,SI12.PEЗ.ПPEДЫДYЩEГO ЗAXOДA
 ,ARX,NSUMB
 ,ATX,NSUMB
 12,VTM,
 ,WTC,SI6
 6,VTM,.ADR B MONCARD/
 ,WTC,SI8
 8,VTM,.PEГИCTP CДBИГA ДЛЯ I6
 5,VTM,*MONCRD*.ADR B *MONCRD*
 11,VTM,-40.PEГ.CДBИГA ДЛЯ I5
 10,VTM,
 ,ITA,
 5,ATX,
 ,UTC,LIT
 ,ATX,
 ,UTC,OCT
 ,ATX,
 ,UTC,DEC
 ,ATX,
 MTR:,BSS,
 6,XTA,
 8,ASN,64
 ,AAX,C377
 ,ATI,14
 ,UTC,TABSIMIS
 14,XTA,
 ,AAX,=:7
 ,AEX,=:1
 ,UZA,ALL
 9,VZM,CONT1.C ПPOБEЛAMИ
 14,UTM,-40B
 14,VZM,BLANK
 14,UTM,40B
 CONT1:12,UTM,1
 ,UTC,TABSIMIS
 14,XTA,
 ,ASN,64+45
 15,ATX,
 ,ITA,14
 15,WTC,
 ,UTC,/PARAM
 ,ATX,
 11,ASN,64
 5,AOX,
 5,ATX,
 11,VZM,E11
 11,UTM,8
 CONT2:,BSS,
 8,VZM,E8
 8,UTM,-8
  ,UJ,MTR
 ALL:,BSS,
 14,UTM,-40B
 14,V1M,NO BLANK
 9,VZM,NO BLANK
 12,V1M,NO BLANK.БЫЛ TEKCT
 10,UTM,1.CЧ.ПPOП.ПPOБEЛOB
C     ECЛИ ПPИ OБPAЩEHИИ И.P.10 = 6
C     И ПPOБEЛ - PAЗДEЛИTEЛЬ,TO ПPOПYCKAEM
C     BCE ПPOБEЛЫ ПEPEД TEKCTOM
 ,UJ,CONT2
 NO BLANK:8,VZM,E8/1
 8,UTM,-8
 CONT/T:14,UTM,40B
 14,MTJ,11
 10,MTJ,14.ПPOП.ПPOБEЛЫ
 12,J+M,14.ДЛИHA ПAPAM.
 14,UTM,1.PAЗДEЛИTEЛЬ
 ,ITA,14
 ,ATX,SI12
 ,ITA,6
 ,ATX,SI6
 ,ITA,8
 ,ATX,SI8
 ,ITA,10
 ,ASN,64-24
 ,AOX,NSUMB
 ,ATX,MSAV
 RETURN:,STI,
 ,STI,5
 ,STI,6
 ,STI,7
 ,STI,8
 ,STI,9
 ,ATI,10
 ,UTC,MSAV
 ,XTA,
 ,UTC,PARSAME
 ,ATX,
 14,VTM,
 13,UJ,
 BLANK:,BSS,
 10,UTM,1
 ,UJ,CONT2
 E11:,BSS,
 11,VTM,-40
 5,UTM,1
 ,ITA,
 5,ATX,
 ,UJ,CONT2
 E8:,BSS,
 8,VTM,40
 6,UTM,1
 ,UJ,MTR
 E8/1:,BSS,
 8,VTM,40
 6,UTM,1
 ,UJ,CONT/T
 NEWSTR:,BSS,
 6,VTM,MONCARD/
 8,VTM,40
 ,ITA,6
 ,ATX,SI6
 ,ITA,8
 ,ATX,SI8
 ,ITA,
 ,UTC,*MONCRD*
 ,ATX,
 ,ATX,NSUMB
 ,ATX,SI12
 ,ATX,MSAV
 12,VTM,
 14,UJ,
C========================================
 MSAV:,LOG,
 NSUMB:,LOG,
 SI12 :,LOG,
 SI8  :,LOG,
 SI6  :,LOG,
 C377 :,LOG,377
 IW12 :12,040,
 ,,
 ERRT:,ISO,51HOШИБOЧHOE OБPAЩEHИE K PARM* ИЗ 00000B (I10=00000B)''
 ,END,
  PARSER:,NAME,
C*
C*
C********  12.1.80.  A.П.CAПOЖHИKOB
C*
C*******************************************
C*
C*   SUBROUTINE PARSER(INF,STRI,FRAG)
C*
C*   CKAHИPOBAHИE TEKCTOBOЙ CTPOKИ  STRI.
C*   BЫБOPKA BO  FRAG  ЗAДAHHOГO KOЛИЧECTBA
C*   CИMBOЛOB ИЛИ ФPAГMEHTA  STRI  ДO
C*   ЗAДAHHOГO CИMBOЛA.
C*   BЫБOPKA TEKYЩEЙ ЛEKCИЧECKOЙ EДИHИЦЫ,
C*   T.E. ПOCЛEДOBATEЛЬHOCTИ CИMBOЛOB ДO
C*   ЛЮБOГO PAЗДEЛИTEЛЯ.
C*   ПEPEBOД ЧИCEЛ ИЗ TEKCTOBOГO ПPEДCTAB-
C*   ЛEHИЯ B MAШИHHOE.
C*
C*   BCE ПEPEMEHHЫE ИMEЮT TИП "ЦEЛЫЙ".
C*   CTPOKA  STRI  ДOЛЖHA ИMETЬ ПPИЗHAK
C*   KOHЦA - KOД '012'.
C*   STRI  MOЖET ПOДABATЬCЯ И B COSY-BИДE.
C*
C*   ECЛИ  STRI=0, TO BЫБOPKA HAЧИHAETCЯ C
C*   TEKYЩEГO CИMBOЛA TEKYЩEЙ CTPOKИ.
C*
C*   FRAG (PEЗYЛЬTИPYЮЩИЙ ФPAГMEHT CTPOKИ)
C*   BCEГДA HOPMAЛИЗOBAH BЛEBO И ДOПOЛHEH
C*   ПPOБEЛAMИ ДO KOHЦA CЛOBA.
C*
C*   INF - MACCИB ДЛИHOЙ 10 CЛOB. ЭTO БЛOK
C*   CBЯЗИ C ЮЗEPOM. HAЗHAЧEHИE OTДEЛЬHЫX
C*   CЛOB :
C*   1. REGM - PEЖИM PAБOTЫ PARSER-A.
C*   2. LENF - KOЛИЧECTBO CИMBOЛOB BO FRAG.
C*   3. FTYP - TИП ЛEKCИЧECKOЙ EДИHИЦЫ FRAG.
C*   4. NUMB - ЧИCЛEHHOE ЗHAЧEHИE FRAG.
C*   5. KODR - KOД HAЙДEHHOГO PAЗДEЛИTEЛЯ.
C*   6. STYP - TИП ПOCЛEДHEГO ПPOЧTEHHOГO
C*             CИMBOЛA CTPOKИ.
C*   7-10    - PAБ. ЯЧEЙKИ ДЛЯ ЗAПOMИHAHИЯ
C*             TEKYЩEГO ПOЛOЖEHИЯ ПO  STRI.
C*
C*   BOЗMOЖEH OДHOBPEMEHHЫЙ AHAЛИЗ MHOГИX
C*   CTPOK.
C*
C*   BOЗMOЖHЫE ЗHAЧEHИЯ CЛOB  INF :
C*   REGM = 'FRAGM','COUNT','REVERS',
C*          'SYNTAX','NUMBER','OCTAL'.
C*   LENF = 0,1,2,...
C*   FTYP = 0  : ПYCTOЙ ФPAГMEHT
C*          1  : BOCЬM.ЧИCЛO ('314 ИЛИ 314B)
C*          2  : ЦEЛOE         ( 314 )
C*          3  : F-ФOPMAT      ( 3.14 )
C*          4  : E-ФOPMAT      ( 3.14E-2 )
C*          5  : ИДEHTИФИKATOP
C*   FTYP < 0  -  ПPИЗHAK OШИБKИ B ФPAГMEHTE
C*                TИПA "ЧИCЛO".
C*   NUMB = "BOCЬM.", "ЦEЛOE" ИЛИ "BEЩECTB."
C*   KODR = BOCЬMEP. KOД CИMBOЛA (MЛ.PAЗP.)
C*   STYP = 0(PAЗДEЛ.), 1(БYKBA), 2(ЦИФPA).
C*
C***
C*
C*   PEЖИMЫ PAБOTЫ  PARSER-A :
C*
C*  1.FRAGM - ИЗBЛEKAEM ФPAГMEHT BO FRAG
C*    ДO ПOЯBЛEHИЯ ПEPBOГO ИЗ 6-TИ CИM-
C*    BOЛOB, YKAЗAHHЫX B  KODR.
C*    ЛEBЫE ПPOБEЛЫ ИГHOPИPYEM.
C*    ФOPMИPYEM: KODR,LENF,STYP,FTYP=5.
C*    ECЛИ CTPOKA KOHЧИЛACЬ, TO  KODR=12B.
C*
C*  2.COUNT - BЫБOPKA LENF ЛИTEP. ФOPMИPY-
C*    ЮTCЯ: FTYP=5, STYP, LENF.  KODR=ПOCЛ.
C*    ПEPEПИCAHHЫЙ CИMBOЛ ИЛИ 012.
C*
C*  3.REVERS - BOЗBPAT PARSER-A HA 1 CИMBOЛ
C*    HAЗAД. ФOPMИPYЮTCЯ: LENF=0,
C*    KODR= KOД ПPEДЫДYЩEГO CИMBOЛA.
C*
C*  4.SYNTAX - BЫБOPKA OЧEPEДHOЙ ЛEKCИЧECKOЙ
C*    EДИHИЦЫ. ФOPMИPYЮTCЯ: LENF,FTYP,NUMB,
C*    KODR,STYP. ECЛИ ФPAГMEHT OПOЗHAH KAK
C*    ЧИCЛO, TO CИMBOЛЫ: 'AПOCTPOФ','ПЛЮC',
C*    'MИHYC','TOЧKA'  CTOЯЩИE B CEPEДИHE
C*    ЧИCЛA, PAЗДEЛИTEЛЯMИ HE CЧИTAЮTCЯ.
C*    ЧИCЛO ПEPEBOДИTCЯ B MAШИHHOE ПPEДCTAB-
C*    ЛEHИE  NUMB  COOTBETCTBEHHO EГO TИПY.
C*    ECЛИ ПEPBЫЙ CИMBOЛ ФPAГMEHTA - PAЗДE-
C*    ЛИTEЛЬ, TO ФPAГMEHT CЧИTAETCЯ ПYCTЫM.
C*    B ЭTOM PEЖИME, TAKИM OБPAЗOM, ЗHAK
C*    ЧИCЛA CЧИTAETCЯ PAЗДEЛИTEЛEM.
C*    KPATHЫE ПPOБEЛЫ CЧИTAЮTCЯ KAK OДИH.
C*
C*  5.NUMBER - TO ЖE, ЧTO И SYNTAX, C TOЙ
C*    PAЗHИЦEЙ, ЧTO B CЛYЧAE ФPAГMEHTA TИПA
C*    "ЧИCЛO CO ЗHAKOM" ЗHAK HE CЧИTAETCЯ
C*    PAЗДEЛИTEЛEM. TAKИM OБPAЗOM, B ЭTOM
C*    PEЖИME "ЧИCЛO CO ЗHAKOM" ECTЬ CAMO-
C*    CTOЯTEЛЬHAЯ ЛEKCИЧECKAЯ EДИHИЦA.
C*
C*  6.OCTAL - BЫБOPKA BOCЬMEPИЧHOГO ЧИCЛA
C*
C******
C*
C*   ПOPTЯTCЯ PEГИCTPЫ: 10, 11, 12, 14
C*   PEЖИM  AY  HE MEHЯETCЯ.
C*   BЫXOД ПO  13 PEГИCTPY.
C*
C****************************************
C*
  A/I0:,LC,1.ЦEЛЫЙ HOЛЬ
C....  PEГИCTPЫ:
   R:,EQU,13.BOЗBPAT
   F:,EQU,12.AДPEC PEЗYЛЬTATA
  SS:,EQU,11.AДPEC CTPOKИ
   I:,EQU,10.AДPEC БЛOKA CBЯЗИ
   C:,EQU,14.CЧ.CИMBOЛOB FRAGM
   S:,EQU,9 .CИMBOЛ
   W:,EQU,8 .ДЛЯ ЗAПAKOBKИ
  TW:,EQU,7 .TИП PAБOTЫ
   E:,EQU,6 .ФЛAГ OШИБKИ
   T:,EQU,5 .TИП CИMBOЛA
  ST:,EQU,4 .TEK.COCTOЯHИE
  SW:,EQU,3 .PAБ.PEГИCTP
  NB:,EQU,2 .ЧИCЛO COSY-ПPOБEЛOB
   B:,EQU,1 .БAЗOBЫЙ PEГИCTP
  SMB:,EQU,S-B
C
C...  ЯЧEЙKИ БЛOKA CBЯЗИ C ЮЗEPOM:
C
  *0:,BLOCK,REGM,LENF,FTYP,NUMB,KODR
  ,CONT,STYP,SYM,ADR,APP,COUN
C
C...  KOДЫ CИMBOЛOB :
C
   APOS:,EQU,47B
   POIN:,EQU,56B
   PLAS:,EQU,53B
  MINUS:,EQU,55B
C
C=====================================
C
  BEG:,STI,F
  ,STI,SS
  ,STI,I
  ,RTE,177B
  ,ITS,R
  C,VTM,B-S
  SREG:C,ITS,S
  C,VLM,SREG
  B,BASE,BEG.*****
  I,XTS,REGM
  ,AEX,=6HREVERS
  ,U1A,NO REV
C---
  REVERS:I,XTA,SYM
  ,ASN,64-40
  I,XTS,APP
  ,ASN,64+8
  15,AOX,
  I,ATX,APP
C---
  EXIT:,ITA,C
  ,AOX,A/I0
  I,ATX,LENF
  I,XTA,SYM
  I,STX,KODR
  C,VTM,SMB+1
  RREG:C,STI,B-1
  C,UTM,-1
  C,VIM,RREG
  ,ATI,R
  15,XTR,
  R,UJ,
C---
  NO REV:,BSS,
  W,VTM,-48
  E,VTM,
  R,VTM,EN TAB
  ,XTA,=6H
  F,ATX,
  TW,VTM,WORK1-WORK2
C---   OПPEДEЛEHИE TИПA PAБOTЫ TW :
  STW:I,XTA,REGM
  TW,AEX,WORK2
  ,UZA,ESTW
  TW,VLM,STW
  I,XTA,REGM
  ,AEX,=6HOCTAL
  ,U1A,EXIT
  ESTW:,BSS,
C
C---   ЗA ПEPBЫM CИMBOЛOM :
C
  ST,VTM,
  NB,VTM,
  ,XTA,A/I0
  I,ATX,FTYP
  SS,AEX,
  ,UZA,SYMB.CONTINUE
  ,XTA,A/I0
  I,ATX,COUN
C
C---   БЛOK "ДAЙ CИMBOЛ" :
C
  NEXTW:,ITA,SS
  I,ATX,ADR
  SS,XTA,
  I,ATX,APP
  SYMB:,BSS,
  I,XTA,COUN
  ,ARX,=1
  I,ATX,COUN
  NB,VIM,COSY1
  I,XTA,APP
  ,ASN,64-8
  I,ATX,APP
  ,YTA,
  ,U1A,SYMB1
  I,WTC,ADR
  SS,VTM,1
  ,UJ,NEXTW
  COSY:S,MTJ,NB
  NB,UTM,-177B
  COSY1:NB,UTM,-1
  ,XTA,=40
  SYMB1:I,ATX,SYM
  ,ATI,S
  ,AEX,=12.LF
  ,U1A,NOLF
  TW,VZM,FIN
  TW,MTJ,SW
  SW,UTM,1
  SW,VZM,FIN
  ,XTA,
  ,UJ,NEXTS
  NOLF:,BSS,
  ,ASN,64+7
  ,U1A,COSY
  TW,WTC,TWSW
  ,UJ,
C===
  :,UJ,COPY
  ,Z00,PACK
  :,UJ,SYMB
  ,Z00,CHECKS
  :,UJ,SYMB
  ,Z00,ANAL
  TWSW:,UJ,SYMB
  ,Z00,ANAL
C===
C
C---   БЛOK "HA CИMBOЛ" :
C
  PACK:I,XTA,SYM
  ,AEX,=40
  W,ASN,64+8
  F,AEX,
  F,ATX,
  W,UTM,8
  W,VIM,PEX
  W,VTM,-48
  F,UTM,1
  ,XTA,=6H
  F,ATX,
  PEX:C,UTM,1
  TW,UJ,TWSW
C
C---   PEЖИM "COUNT" :
C
  COPY:,ITA,C
  I,AEX,LENF
  ,AEX,A/I0
  ,UJ,NEXTS
C
C---   PEЖИM "FRAGM" :
C
  CHECKS:SW,VTM,-5
  I,XTA,KODR
  CHECKS1:,ASN,64-8
  15,ATX,
  ,YTA,
  I,AEX,SYM
  ,UZA,EFRAG
  15,XTA,
  SW,VLM,CHECKS1
  ,UJ,PACK
  EFRAG:15,UTM,-1
  C,VIM,NEXTS
  ,ITA,S
  ,AEX,=40
  ,UZA,SYMB
  ,XTA,
  NEXTS:,U1A,SYMB
  ,XTA,=I5
  I,ATX,FTYP
  R,VTM,EXIT1
C
C---   БЛOK "AHAЛИЗ CИMBOЛA" :
C
  ANAL:T,VTM,1.БYKBA
  ,ITA,S
  ,ASN,64+6
  ,U1A,SET TYP
  T,VTM,.PAЗДEЛИTEЛЬ
  ,ITA,S
  ,NTR,3
  ,A-X,=60
  ,U1A,SET TYP
  ,A-X,=12
  ,UZA,SET TYP
  T,VTM,2.ЦИФPA
  SET TYP:,ITA,T
  ,AOX,A/I0
  I,ATX,STYP
  R,UJ,
C
C---   PEЖИMЫ "SYNTAX" И "NUMBER" :
C      BXOД B ПEPEKЛЮЧATEЛЬ COCTOЯHИЙ
C      ST=0   -  EMPTY
C         1   -  OCTAL
C         2   -  INTEGER
C         3   -  REAL
C         4   -  EXPONENT
C         5   -  IDENT
C
  EN TAB:ST,MTJ,SW
  ST,J+M,SW
  ST,J+M,SW
  ,ITA,S
  T,UTC,
  SW,UJ,TABLO
C===
  TABLO:,BSS,
  :S,UTM,-APOS.EMPTY
  ,UJ,EMPT/Z.И ЗHAK
  ID:ST,VTM,5.EMPTY
  ,UJ,NEW STAT.И БYKBA
  :,AAX,=17.EMPTY
  ,UJ,BINT.И ЦИФPA
  FIN:E,VZM,FIN1.OCTAL
  ,UJ,SETE.И ЗHAK
  ERR:E,UTM,1.OCTAL
  ,UJ,ID.И БYKBA
  :,AAX,=10.OCTAL
  ,UJ,OCT.И ЦИФPA
  :S,UTM,-POIN.INTEGER
  ,UJ,INT/Z.И ЗHAK
  :S,UTM,-102B.INTEGER
  ,UJ,INT/L.И БYKBA
  :,AAX,=17.INTEGER
  ,UJ,INT.И ЦИФPA
  :,UJ,FIN.REAL И ЗHAK
  :S,UTM,-102B.REAL
  ,UJ,CHE.И БYKBA
  :,AAX,=17.REAL
  ,UJ,REAL.И ЦИФPA
  :S,UTM,-MINUS.EXPON
  ,UJ,EXP/Z.И ЗHAK
  :,UJ,ERR.EXP И БYKBA
  :,AAX,=17
  ,UJ,EXP.И ЦИФPA
  :,UJ,FIN.IDENT
  :,UJ,PACK.IDENT
  :,UJ,PACK.IDENT
C===
C
C---   AHAЛИЗ KЛЮЧEBЫX CИMBOЛOB
C      ПEPEXOД B HOBOE COCTOЯHИE.
C
  EMPT/Z:S,VIM,CHSIGN
  ,XTA,
  PLUS1:ST,UTM,1
  I,ATX,NUMB
  NEW STAT:,ITA,ST
  ,AOX,A/I0
  I,ATX,FTYP
  ,UJ,PACK
  CHSIGN:TW,VIM,EXIT
  I,XTA,SYM
  ,ATX,NSIGN
  S,UTM,APOS-40B
  S,VZM,SYMB
  S,UTM,40B-PLAS
  S,VZM,PACK
  S,UTM,PLAS-MINUS
  S,VIM,EXIT
  ,UJ,PACK
C---
  INT/Z:S,VIM,FIN
  ,XTA,=R1.
  ,ATX,CMANT
  ,NTR,2
  I,XTA,NUMB
  ,A+X,
  ST,VTM,2
  ,UJ,PLUS1
C---
  INT/L:S,VIM,CHE
  ,XTA,NUM2/10
  ,AAX,=6H'210''210''210''210''210''210'
  ,U1A,ERR
  ,XTA,NUM2/10
  ,APX,=6H'167''167''167''167''167''167'
  ,ASN,64+12
  ,UJ,TO OCT
C---
  CHE:S,UTM,102B-105B
  S,VIM,ERR
  I,XTA,NUMB
  ,NTR,2
  ,A+X,
  ,ATX,CMANT
  ,XTA,
  ,ATX,NUM2/10
  ST,VTM,4
  ,UJ,NEW STAT
C---
  EXP/Z:,XTA,=R0.1
  S,VZM,TOSIG
  S,UTM,MINUS-PLAS
  ,XTA,=R10.
  TOSIG:S,VIM,FIN
  ,ATX,ESIGN
  ,XTA,NUM2/10
  ,UZA,FIN
  ,UJ,PACK
C---
  BINT:,ATX,NUM2/10
  ,AOX,A/I0
  I,ATX,NUMB
  ST,VTM,2
  I,XTA,REGM
  ,AEX,=6HOCTAL
  ,U1A,NEW STAT
  I,ATX,NUMB
  ,XTA,NUM2/10
  ,ASN,64+3
C
C---   CБOPKA BOCЬMEPИЧHOГO ЧИCЛA
C
  OCT:,U1A,ERR
  ,ITA,S
  ,AAX,=7
  I,XTS,NUMB
  ,ASN,64-3
  15,AOX,
  TO OCT:ST,VTM,
  ,UJ,PLUS1
C
C---   CБOPKA ЦEЛOГO
C
  INT:15,ATX,
  I,XTS,NUMB
  ,AEX,A/I0
  ,ASN,64-1
  15,ATX,
  ,ASN,64-2
  15,ARX,
  15,ARX,
  ,AOX,A/I0
  I,ATX,NUMB
  ,XTA,NUM2/10
  ,ASN,64-4
  15,AOX,
  ,ATX,NUM2/10
  ,UJ,PACK
C
C---   CБOPKA  F-ФOPMATA
C
  REAL:,AOX,A/I0
  ,NTR,2
  ,XTS,CMANT
  ,A*X,=R0.1
  ,ATX,CMANT
  15,A*X,
  I,A+X,NUMB
  TON:I,ATX,NUMB
  ,UJ,PACK
C
C---   CБOPKA  E-ФOPMATA
C
  EXP:,XTS,NUM2/10
  ,ASN,64-1
  15,ATX,
  ,ASN,64-2
  15,ARX,
  15,ARX,
  ,ATX,NUM2/10
  ,ATI,SW
  ,ASN,64+4
  ,U1A,ERR
  ,NTR,2
  ,XTA,CMANT
  MUL:,A*X,ESIGN
  SW,UTM,-1
  SW,VIM,MUL
  ,UJ,TON
C
C---   OБPAБOTKA OШИБOK :
C
  SETE:I,XTA,FTYP
  ,NTR,3
  ,X-A,
  I,ATX,FTYP
C
C---   KOPPEKЦИЯ ЗHAKA B PEЖИME "NUMBER"
C
  FIN1:TW,VIM,EXIT1
  ,WTC,NSIGN
  SW,VTM,-MINUS
  ,XTA,
  ,ATX,NSIGN
  SW,VIM,EXIT1
  I,XTA,NUMB
  ST,UTM,-1
  ST,VZM,OCTMIN
  ST,UTM,1-5
  ST,VZM,EXIT1
  ST,UTM,5-2
  ,NTR,3
  ST,VZM,IMIN
  ,NTR,2
  IMIN:,X-A,
  ,UJ,FMIN
  OCTMIN:,AEX,=7777 7777 7777 7777
  ,ARX,=1
  FMIN:I,ATX,NUMB
C
C---   PEBEPC HA KOHЦE CTPOKИ :
C
  EXIT1:I,XTA,SYM
  ,AEX,=12
  ,U1A,EXIT
  ,UJ,REVERS
C===================================
  WORK1:,ISO,6HCOUNT
       :,ISO,6HFRAGM
       :,ISO,6HSYNTAX
  WORK2:,ISO,6HNUMBER
  NUM2/10:,BSS,1
  NSIGN  :,BSS,1
  ESIGN  :,BSS,1
  CMANT  :,BSS,1
  ,END,
  PAЗHИЦA2:,NAME,
C*
C******* 25.05.80  A.П.CAПOЖHИKOB.
C*
C*  CPABHEHИE ДBYX BAPИAHTOB BPEMEHHOЙ
C*  БИБЛИOTEKИ.  CПOCOБ YПOTPEБЛEHИЯ :
C*
C*  < ФOPMИPOBAHИE 1-ГO BAPИAHTA >
C*  *CALL S/TEMPO
C*  < ФOPMИPOBAHИE 2-ГO BAPИAHTA >
C*  *CALL PAЗHИЦA2
C*  < ДAЛEE ЧTO YГOДHO, BPEMEHHAЯ
C*    БИБЛИOTEKA ПYCTA. >
C*
C*  *CALL PAЗHИЦA2:CTPYKT
C*   - TOЛЬKO CPABHEHИE CTPYKTYP.
C*
C*************************************
C*
  *MONCRD*:,LC,15
  CAT:,PC,1024
  LSM:PC,BLOCK,(6144),LSM2(6144)
  NC :,P/P,(CAT)16
  NSM:,P/P,(LSM)16
  NSM2:,P/P,(LSM2)16
C
C
C
  ,ITA,13
  ,ATX,RET
  1,VTM,1.CЧ-K ИMEH
  9,VTM,
 10,VTM,
  ,CALL,PARAMT*
  10,VTM,3
  ,CALL,PARAMT*
  ,XTA,*MONCRD*
  ,AEX,=6HCTPYKT
  ,ATX,STRUFL
  12,VJM,CHAN
C
C...  OCH.ЦИKЛ ПO KATAЛOГY 1 BAPИAHTA
C
  NEXT:4,VTM,.VAR-1
  1,MTJ,14
  ,XTA,222B
  13,VJM,GIVCEL
  ,UZA,END
  ,AEX,=1
  1,UTM,1
  ,UZA,NEXT.ENTRY
  4,VTM,1.VAR-2
  2,VTM,1
  ,XTA,XAP
  ,ARX,
  ,UZA,END.PERMANENT
C
C... ПOИCK ИMEHИ B VAR-2
C
  S/2:2,MTJ,14
  13,VJM,GIVCEL
  ,UZA,ABSENT
  ,ATI,14
  ,XTA,NAME+1
  ,AEX,NAME
  2,UTM,1
  ,U1A,S/2
  14,UTM,-1
  14,VIM,OK2
  S/H:2,UTM,-1
  2,MTJ,14
  13,VJM,GIVCEL
  ,AEX,=2
  ,U1A,S/H
C
C... HAЙДEHЫ OБA BAPИAHTA ПPOГPAMMЫ
C
  OK2:1,MTJ,14
  14,UTM,-1
  ,ITA,14
  ,CALL,OCTTDEC
  ,AAX,=6H'17''17''17''17''17''17'
  ,ASN,64-8
  ,AOX,GOST0
  ,ATX,HEAD
  ,XTS,NAME
  14,VTM,HEAD+3
  ,ITS,14
  ,CALL,PT6/G
  ,XTS,NAME+1
  14,VTM,HEAD+6
  ,ITS,14
  ,CALL,PT6/G
  ,XTA,XAP
  ,ATX,HEAD+9
  ,XTA,XAP+1
  ,ATX,HEAD+10
  3,VTM,-1
  ,*64,PRHEAD
C
C... ИЗBЛEЧEHИE И ПEЧATЬ CTPYKTYP
C
  STRUC:3,MTJ,4
  4,UTM,1
  ,XTA,STRUFL
  13,VTM,-5
  ,U1A,GIVSM
  13,VTM,
  GIVSM:,BSS,
C---  ИЗBЛEЧEHИE TEЛA C.M.:
  4,XTA,ADR
  ,ASN,64-27
  ,AUX,=:40 37 76
  15,ATX,2
  R6TR:,AUX,=0001 3700 0077 0037
  4,ARX,R/BOD
  15,ATX,3
  15,*70,3
  15,XTA,2
  ,ARX,=:01 00 02
  15,ATX,2
  13,VLM,R6TR
  4,XTA,ADR
  ,AAX,=1777
  ,ATI,14
  14,UTM,LSM
  4,VZM,AL1
  14,UTM,LSM2-LSM
  AL1:,ITA,14
  4,ATX,ADR
  5,VTM,1
  13,VJM,GIVMEL
  ,ASN,64+12
  4,ATX,OБOЗ
  5,VTM,2
  13,VJM,GIVMEL
  15,ATX,
  15,ATX,
  ,AAX,=77777
  4,STX,SET
  ,ASN,64+15
  ,AAX,=77777
  4,STX,DATA
  ,ASN,64+30
  ,AAX,=77777
  4,ATX,LONGID
  5,VTM,3
  13,VJM,GIVMEL
  15,ATX,
  15,ATX,
  ,AAX,=77777
  4,STX,COM
  ,ASN,64+30
  ,AAX,=77777
  4,STX,CONST
  ,ASN,64+15
  ,AAX,=77777
  4,ATX,BSS
  4,ARX,COM
  4,ARX,CONST
  4,ATX,LBODY
  4,XTA,COM
  4,ARX,CONST
  4,ARX,DATA
  4,ARX,SET
  ,ARX,=1
  4,ATX,ADEF
  4,XTA,COM
  ,ASN,64-1
  4,ATX,COM
  4,XTA,OБOЗ
  4,ARX,LONGID
  4,ATX,LTD
  4,ARX,ADEF
  ,ARX,=3
  4,ATX,LENSM
  3,VLM,STRUC
  ,NTR,3.===
  ,*64,PRSTR
  ,*64,PRSTR1
C
C...  BЫЯBЛEHИE PAЗHИЦЫ B KOMAHДAX
C
  ,XTA,GOOD
  ,ATX,HITOG+1
  ,XTA,STRUFL
  ,UZA,CHSTRU
  ,XTA,
  ,ATX,POIN
  ,ATX,POIN+1
  ,ATX,POINP
  ,ATX,POINP+1
  ,ATX,FLCONS
C
C...  MAHИПYЛИPYEM ДBYMЯ YKAЗATEЛЯMИ
C     ПO CИCTEME "MAЯTHИK".
C
  LENS:,EQU,5.ГЛYБИHA ПPOCMOTPA
  STEP:2,VTM,-1
  8,VTM,
  STEP1:2,XTA,COM+1
  2,A-X,POIN+1
  ,U1A,STEP2.ЭTOT ЛOПHYЛ
  2,XTA,POIN+1
  ,ARX,=1
  2,ATX,POIN+1
  2,ATX,POIN2+1
  8,VTM,-1
  STEP2:2,VLM,STEP1
  8,VZM,ESTEP.OБA ЛOПHYЛИ
  STEP3:3,VTM,-1.CПYCK BЛEBO
  ,XTA,POIN2
  ,ATX,POINW
  ,XTA,POIN2+1
  ,ATX,POINW+1
  13,VJM,ANAL2.CИHXPOHHO
  STEP4:,UZA,STEP.COBПAЛИ
  3,XTA,POINW+1
  3,A-X,COM+1
  ,U1A,ANAL9
C    CПYCTИЛИCЬ ДO KOHЦA KOMAHД
  3,XTA,POIN2+1
  3,ATX,POINW+1
  3,VZM,INSDEL
C   MAЯTHИK B ДPYГYЮ CTOPOHY
  3,VLM,STEP4
C
C...  БOЛЬШAЯ ИTEPAЦИЯ
C
  INSDEL:8,XTA,POIN2+1
  ,ARX,=1
  8,ATX,POIN2+1
  8,ATX,POINW+1
  8,A-X,COM+1
  ,UZA,PR2V
  8,VLM,INSDEL
  8,VTM,-1
  3,VTM,-1
C
C...  ПPOБA ЭKBИBAЛEHTHOCTИ
C    ФPAГMEHTOB ПO  LENS  KOMAHД:
C
  ANAL9:,XTA,POINW
  ,XTS,POINW+1
  9,VTM,1-LENS
  ANL:,XTS,
  13,VJM,ANAL2
  ,U1A,NEGRET
  ,XTA,POINW
  ,ARX,=1
  ,ATX,POINW
  ,XTA,POINW+1
  ,ARX,=1
  ,STX,POINW+1
  9,VLM,ANL
  ,STX,POINW+1
  ,ATX,POINW
C
C... ЭTO "INSERT"
C    ПEЧATЬ OДHOГO BAPИAHTA ( 3 PEГ.)
C    ДЛЯ  POIN <= C < POINW
C
  14,VTM,-1
  12,VTM,1
  SETLOOP:,BSS,
  14,XTA,POIN +1
  14,ATX,POIN2+1
  14,XTS,POINW+1
  14,STX,POIN +1
  14,ATX,POINW+1
  14,X-A,POIN +1
  ,ASN,64+1
  ,ATI,13
  13,UTM,-LENS
  ,ITA,13
  ,ASN,64+14
  ,U1A,SMALL
 12,VTM,.PIECE>2*LEN
  SMALL:,BSS,
  14,VLM,SETLOOP
  ,*64,PRLIN
  PRINS:10,VTM,
  3,VTM,-1
  CHPRIN:,BSS,
  9,VTM,STEP
  3,XTA,POINW+1
  3,A-X,POIN +1
  ,UZA,NO PRIN
  3,XTA,POINP+1
  3,A-X,POINW+1
  ,UZA,NO PRIN
  ,ITA,3
  ,AEX,=77777
  ,ATI,11
  11,XTA,POINW+1
  11,XTS,POIN2+1
  11,ATX,POINW+1
  13,VJM,ANAL2
  12,VZM,BIGP
  ,UZA,RESPW
  11,XTA,POINW+1
  ,ARX,=1
  11,ATX,POINW+1
  11,A-X,POIN +1
  ,U1A,ANAL2
  BIGP:,BSS,
  10,VTM,1
  13,VJM,KODIR
  3,XTA,POINW+1
  3,ATX,POINP+1
  RESPW:,STI,
  11,ATX,POINW+1
  NO PRIN:3,VLM,CHPRIN
  8,VTM,-1
  10,VZM,NEW PRIN
  13,VJM,STROUT
  NEWPRIN:,BSS,
  ,XTA,=1
  8,ARX,POINW+1
  8,ATX,POINW+1
  8,A-X,POIN +1
  ,UZA,NEWPR1
  9,VTM,PRINS
  NEWPR1:8,VLM,NEW PRIN
  9,UJ,
C---
  NEGRET:,STI,
  ,STX,POINW+1
  ,ATX,POINW
C   ПPOДOЛЖAEM CПYCK
  3,XTA,POINW+1
  ,ARX,=1
  3,ATX,POINW+1
  ,UJ,STEP4
C
C...  ПEЧATЬ OБOИX BAPИAHTOB
C     ДЛЯ  C = POINW
  PR2V:,BSS,
  ,XTA,POIN
  ,ATX,POINW
  ,XTA,POIN+1
  ,ATX,POINW+1
  3,VTM,-1
  13,VJM,ANAL2
  :13,VJM,KODIR
  3,VLM,*-1
  13,VTM,STEP
C
  STROUT:,*64,PRRAZ
  ,XTA,BAD
  ,ATX,HITOG+1
  14,VTM,-14
  ,XTA,GBLAN
  :14,ATX,STRIN+14
  14,VLM,*
  13,UJ,
  PRLIN:,Z00,LIN
  ,Z00,LIN
  ,002,
  8,,
  LIN:,GOST,12H-----------'231'
  PRRAZ:,Z00,STRIN
  ,Z00,STRIN
  ,002,
  8,,
  STRIN:,BSS,
  ,GOST,24H
  ,GOST,18H
  ,GOST,6H
  ,GOST,24H
  ,GOST,18H
  ,GOST,6H'231'
  KODIR:3,XTA,POINW+1
  ,A-X,=1
  ,ASN,64-33
  ,AUX,=6H'3''7''7''7''7''1'
  ,AEX,=17
  14,VTM,STRIN
  3,VIM,*+1
  14,UTM,8
  :14,ATX,.REL.ADR.
  ,XTA,FLCONS
  ,U1A,TRCONS
  3,XTA,MODIF+1
  ,ASN,64-42
  ,AUX,=6H'''''''''7''7'
  ,AOX,=6H'17''17''17''17'''''
  14,ATX,1.MODIFIC.
  3,XTA,KOP+1
  14,ATX,2.KOP
  3,XTA,ADRES+1
  13,UZA,
  ,ASN,64-33
  ,AUX,=6H'7''7''7''7''7'''
  3,WTC,CTYP+1
  ,AOX,ADCONT
  TRCONS:,BSS,
  14,ATX,3.ADRES
  3,XTA,VALUE+1
  13,UZA,
  ,AUX,=6H'''''7''7''7''7'
  ,AOX,=6H'17''17'''''''''
  14,ATX,4.VAL1
  3,XTA,VALUE+1
  ,ASN,64-12
  ,AUX,=6H'7''7''7''7''7''7'
  14,ATX,5.VAL2
  3,XTA,VALUE+1
  ,ASN,64-30
  ,AUX,=6H'7''7''7''7''7''7'
  14,ATX,6.VAL3
  13,UJ,
C
C...  KOHEЦ CPABHEHИЯ KOMAHД
C
  ESTEP:,BSS,
  8,VTM,1
   3,VTM,-1
C
C...   CPABHEHИE KOHCTAHT
C
  ,XTA,GTCONS
  ,ATX,FLCONS
  CON1:,ITA,8
  3,X-A,CONST+1
  ,U1A,ECON
  8,MTJ,6
  3,MTJ,4
  4,UTM,1
  13,VJM,GIVCONS
  3,ATX,VALUE+1
  6,VTM,1
  ,ITA,4
  ,AEX,=1
  ,ATI,4
  CON2:,ITA,6
  4,X-A,CONST
  ,U1A,CONPR
  13,VJM,GIVCONS
  3,AEX,VALUE+1
  ,UZA,CON3
  6,VLM,CON2
  CONPR:,ITA,8
  ,ASN,64-1
  3,ARX,COM+1
  ,A-X,=1
  3,ATX,POINW+1
  13,VJM,KODIR
  13,VJM,STROUT
  CON3:8,VLM,CON1
  ECON:8,VTM,1
  3,VLM,CON1
C
C...  KOHEЦ CPABHEHИЯ KOHCTAHT
C
  CHSTRU:13,VTM,OБOЗ
  14,VTM,-6
  CHSTRU1:13,XTA,
  13,AEX,1
  13,UTM,2
  ,UZA,CHSTRU2
  ,XTA,BAD
  ,ATX,HITOG+1
  CHSTRU2:14,VLM,CHSTRU1
  ,*64,PRITOG
C
C
  ,UJ,NEXT
C
C... OЧИCTKA "TEMPO" ПO KOHЦY PAБOTЫ
C
  END:,WTC,RET
  13,VTM,
C
  S/TEMPO:,ENTRY,
  12,VTM,CLE/TEMP
  ,NTR,6
  CHAN:,UTC,=5021 2522 2623 2777
  ,*72,
  12,UJ,
  CLE/TEMP:,BSS,
  ,*70,RP1
  ,*70,WM1
  ,*70,RP2
  ,*70,WM2
  ,UTC,=2104000
  ,XTA,
  ,ATX,54B
  13,UJ,
  RP1:,014,NC
  ,021,7
  WM1:,000,NC
  ,021,
  RP2:,014,NC
  ,021,10B
  WM2:,000,NC
  ,021,1
C
C... OTCYTCTBYET ПOДПPOГPAMMA
C
  ABSENT:,XTS,NAME
  14,VTM,AMAC
  ,ITS,14
  ,CALL,PT6/G
  ,*64,PRABS
C
  ,UJ,NEXT
  PRABS:,Z00,AMAC
  ,Z00,AMAC
  ,016,
  9,000,
  AMAC:,GOST,24HSUBROUTINE  OTCYTCTBYET'231'
  :,BSS,
C
C
C...  CPABHEHИE ДBYX KOMAHД ПO POINW
C
  ANAL2:,ITA,13
  ,XTS,
  ,ATX,EQU
  ,ATX,ADRES
  ,ATX,ADRES+1
  ,ATX,VALUE
  ,ATX,VALUE+1
  2,VTM,-1
  AN:2,XTA,POINW+1
  ,ATI,6
  2,X-A,COM+1
  ,UZA,AN1
  ,ATX,EQU
  ,UJ,XOPA
  AN1:2,MTJ,4
  4,UTM,1
  13,VJM,GIVCOM
  4,ATX,COMAND
  ,ASN,64+20
  4,ATX,MODIF
  4,XTA,COMAND
  ,ASN,64+19
  ,AAX,=1
  4,ATX,CTYP
  ,ATI,13
  4,XTA,COMAND
  ,ASN,64-28
  13,AUX,MASKOP
  13,AOX,SYMKOP
  4,ATX,KOP
  4,XTA,COMAND
  13,AAX,MASAD
  4,ATX,ADRES
  13,A-X,DIAP
  ,U1A,XOPA
  ,ATI,5
  13,VZM,REFA
  ,X-A,=34000
  ,UZA,RELA
C...  CCЫЛKA HA TAБЛ.OПИCAHИЙ
  REFA:4,XTA,ADRES
  ,AAX,=3777
  REFA1:,ATI,7
  13,VJM,GIVDEF
  ,UZA,XOPA
  4,ATX,VALUE
  ,ATI,5
  ,ASN,64+15
  ,AAX,=777
  ,ATI,14
  14,VZM,ADDA.A+A
  14,UTM,-410B
  14,VZM,RELA
  14,UTM,410B-630B
  14,VZM,L/ID
  14,UTM,630B-521B
  14,VZM,Z00A
  14,UTM,521B-470B
  14,VZM,XOPA.LC
  14,UTM,470B-570B
  14,VZM,XOPA.SC
  14,UTM,570B-474B
  14,VZM,XOPA.PC
  14,UTM,474B-400B
  14,VZM,ABSA
  14,UTM,400B-520B
  14,VZM,ABSA
C.....  PAЗБOP ДAЛEKO HE ПOЛHЫЙ
  ,UJ,XOPA
  L/ID:4,XTA,VALUE
  ,ASN,64+24
  ,ATI,7
  13,VJM,GIVDEF
  4,ATX,VALUE
  ,UJ,XOPA
  Z00A:,ITA,5
  ,UJ,REFA1
  ADDA:4,XTA,VALUE
  ,ASN,64+24
  ,UJ,REFA1
  ABSA:,ITA,5
  4,ATX,ADRES
  TO VAL:,BSS,
  4,ATX,VALUE
  ,UJ,XOPA
C
C...  OTHOCИTEЛЬHЫЙ AДPEC
C
  RELA:,ITA,5
  5,UTM,4
  4,ATX,ADRES
  4,XTA,COM
  ,ASN,64+1
  4,A-X,ADRES
  ,U1A,NORCOM
C...  KOMAHДA
  13,VJM,GIVMEL
  ,AAX,=:7777.ЛEBAЯ
  ,UJ,TO VAL
  NORCOM:4,A+X,CONST
  ,U1A,TO VAL
C...   KOHCTAHTA
  13,VTM,TO VAL
  ,UJ,GIVMEL
C
C...  KOHEЦ PAЗБOPKИ
C
  XOPA:2,VLM,AN
  ,XTA,EQU
  ,STI,14
  ,ATI,13
  ,XTA,
  13,UTC,
  14,VIM,
C
C... COБCTBEHHO CPABHEHИE
C
  ,XTA,MODIF
  ,AEX,MODIF+1
  13,U1A,
  ,XTA,KOP
  ,AEX,KOP+1
  13,U1A,
  ,XTA,ADRES
  ,AEX,ADRES+1
  13,UZA,
  ,XTA,VALUE
  ,AEX,VALUE+1
  13,UJ,
  MASKOP:,ISO,12H'''3''7''7''''''''3''7'''''''
  SYMKOP:,GOST,12H 000   00
  MASAD:,LOG,7777
        ,LOG,77777
  DIAP:,LOG,4000
       ,LOG,40000
C
C...  ЭЛEMEHTAPHЫE OПEPAЦИИ HAД БИБЛИOTEKOЙ
C
  GIVCEL:,BSS,
C  "ДAЙ I-Й ЭЛEMEHT KATAЛOГA VAR-J"
C   I=1,2,...   - 14 PEГИCTP
C   J=0,1       -  4 PEГИCTP
C  HA BЫXOДE :
C  NAME - ИMЯ ПPOГPAMMЫ
C  XAP  - XAPAKTEPИCTИKA B KATAЛOГE
C  ADR  - AДPEC ПO БИБЛИOTEKE
C  CYMMATOP = 0 - KOHEЦ KATAЛOГA
C             1 - ENTRY
C             2 - ГOЛOBHAЯ
C----------------------------------
C
  14,J+M,14
  ,ITA,14
  15,ATX,3
  ,ASN,64+10
  ,ITS,4
  ,ASN,64-14
  15,AOX,
  15,ATX,2
  ,AEX,CATFL
  ,UZA,CATIS
  15,XTA,2
  ,ATX,CATFL
  ,ARX,R/CAT
  15,ATX,2
  15,*70,2
  CATIS:15,XTA,3
  ,AAX,=1777
  ,ATI,14
  14,UTM,CAT
  14,XTA,
  4,ATX,NAME
  13,UZA,
  14,XTA,1
  4,ATX,XAP
  ,AEX,=7777 7777 7777 7777
  13,UZA,
  ,AEX,=7777 7777 7777 7777
  ,ASN,64+15
  ,UZA,ENTRY
  4,XTA,XAP
  ,APX,=:4017 77
  ,ASN,64+32
  4,XTS,XAP
  ,ASN,64-2
  ,ASN,64-5
  ,YTA,
  15,AOX,
  ,ASN,64-5
  4,ATX,ADR
  ,XTA,=2
  13,UJ,
  ENTRY:,XTA,=1
  13,UJ,
  R/CAT:,010,NC
  ,021,
  CATFL:,LOG,362
  NAME:,BSS,2
  XAP :,BSS,2
  ADR :,BSS,2
C
C
  GIVCOM:,BSS,
C  "ДAЙ I-Ю KOMAHДY"
C  I=1,2,...,COM   - 6 PEГИCTP
C  PEЗYЛЬTAT B 1-24 P. CYMMATOPA
C  ПOPTИTCЯ 5 PEГ.
C--------------------------------
C
  6,VZM,NEGR
  ,ITA,6
  4,X-A,COM
  ,U1A,NEGR
  ,ITA,13
  6,UTM,-1
  ,ITS,6
  6,UTM,1
  ,ASN,64+1
  ,ATI,5
  5,UTM,4
  13,VJM,GIVMEL
  ,ITS,6
  ,AAX,=1
  ,STI,14
  14,WTC,SHIFT
  ,ASN,64
  ,AAX,=7777 7777
  15,WTC,
  ,UJ,
  SHIFT:,LOG,
  ,LOG,30
C
C
  GIVCONS:,BSS,
C  "ДAЙ I-Ю KOHCTAHTY"
C  I=1,2,...,CONST   - 6 PEГИCTP
C  ПOPTИTCЯ 5 PEГ.
C-------------------------------
C
  6,VZM,NEGR
  ,ITA,6
  4,X-A,CONST
  ,U1A,NEGR
  4,XTA,COM
  ,ASN,64+1
  ,ATI,5
  6,J+M,5
  5,UTM,3
  ,UJ,GIVMEL
C
C
  GIVDEF:,BSS,
C  "ДAЙ I-E CЛOBO TAБЛ.OПИCAHИЙ"
C  I=1,2,...   - 7 PEГИCTP
C  ПOPTИTCЯ 5 PEГ.
C-------------------------------
C
  ,ITA,7
  4,X-A,LTD
  ,U1A,NEGR
  7,VZM,NEGR
  7,MTJ,5
  4,WTC,ADEF
  5,UTM,3
C
C
  GIVMEL:,BSS,
C  "ДAЙ I-E CЛOBO J-ГO BAPИAHTA C.M."
C  I=1,2,...  - 5 PEГИCTP
C  J=0,1      - 4 PEГИCTP
C  PEЗYЛЬTAT HA CYMMATOPE.
C------------------------------------
C
  ,ITA,5
  4,X-A,LENSM
  ,U1A,NEGR
  4,WTC,ADR
 5,XTA,-1
  13,UJ,
  NEGR:,XTA,
  13,UJ,
  R/BOD:,010,NSM
  ,000,
  :,010,NSM2
  ,004,
C
C...  BCE ДЛЯ ПEЧATИ CTPYKTYPЫ
C
  PRSTR:,Z00,HSTR
  ,Z00,HSTR
  ,003,
  8,,
  PRSTR1:,Z00,OБOЗ
  ,Z00,BSS+1
  2,004,4
  8,006,13
  PRHEAD:,Z00,HEAD
  ,Z00,HEAD+10
  ,010,
  ,,
  2,070,16
  8,024,1
  PRITOG:,Z00,HITOG
  ,Z00,HITOG
  ,010,
  9,,
  HEAD:,GOST,24H00001:   VAR-1
       ,GOST,12H      VAR-2
       ,GOST,12HSUBROUTINE
       ,GOST,6H'231'
  :,BSS,2
  HSTR:,BSS,
  ,GOST,12H OБOЗHAЧEHИЯ
  ,GOST,12H  PACCЫЛKИ
  ,GOST,12H   ДAHHЫE
  ,GOST,12H ДЛ.ИДEHT.
  ,GOST,12H  KOMAHДЫ
  ,GOST,12H  KOHCTAHTЫ
  ,GOST,12H   BSS'231'
  HITOG:,GOST,12HИTOГO:
  GOOD :,GOST,6HXOP.'231'
  BAD  :,GOST,6HПЛOXO'231'
  GOST0:,GOST,6H00000:
  ADCONT:,GOST,12H 0000 00000
  GTCONS:,GOST,6HCONST:
  GBLAN:,GOST,6H
  OБOЗ  :,BSS,2
  SET   :,BSS,2
  DATA  :,BSS,2
  LONGID:,BSS,2
  COM   :,BSS,2
  CONST :,BSS,2
  BSS   :,BSS,2
  LBODY :,BSS,2
  ADEF  :,BSS,2
  LTD:,BSS,2
  LENSM:,BSS,2
  POIN  :,BSS,2
  POIN2:,BSS,2
  POINW :,BSS,2
  POINP:,BSS,2
  COMAND:,BSS,2
  MODIF :,BSS,2
  KOP   :,BSS,2
  ADRES :,BSS,2
  VALUE :,BSS,2
  CTYP:,BSS,2
  STRUFL:,BSS,1
  EQU:,BSS,1
  FLCONS:,BSS,1
  RET   :,BSS,1
  ,END,
 PERFPL:,NAME,
C***** 22.09.81 ****** KOKYEB A.H. *****
C*
C*   ПPOГPAMMA BЫДAЧИ PEДAKTOPCKOГO ИЛИ
C* MYЛЬTИTAЙПHOГO ФAЙЛA HA ПEPФOЛEHTY B
C* KOДE ISO C ДOБABЛEHИEM CИMBOЛOB ПEPEД
C* CTPOKOЙ И B KOHЦE CTPOKИ. (PEKOMEHДY-
C* ETCЯ ИCПOЛЬЗOBATЬ ,B ЧACTHOCTИ, ДЛЯ
C* ПEPEBOДA ФOPTPAHHЫX ПPOГPAMM ЭBM
C* БЭCM-6 HA ЭBM CEPИИ "CM".)
C*======================================
C*      O Б P A Щ E H И E :
C*......................................
C*  *CALL PERFPL:YK,N1,PAR1,...,PARN1,
C*                  N2,PAR1,...,PARN2
C*    YK  - YKAЗATEЛЬ ФAЙЛA
C*    N1  - KOЛ-BO CИMBOЛOB ПEPEД CTPOKOЙ
C*    N2  - KOЛ-BO CИMBOЛOB ПOCЛE CTPOKИ
C*    PAR1,...,PARN -BOCЬMEPИЧHЫE CONST'Ы
C*    B COOTBETCTBYЮЩEЙ ПOCЛEДOBATEЛЬHOCTИ
C*
C*    ECЛИ B ФAЙЛE BCTPEЧAETCЯ KAPTA,
C*    COДEPЖAЩAЯ TOЛЬKO CИMBOЛЫ "." B
C*    1 И 2 ПOЗИЦИЯX - OHA HE ПEPФOPИPYET-
C*    CЯ, A BЛEЧET ПPOГOH ПEPФOЛEHTЫ HA
C*    80 ПOЗИЦИЙ.
C*
C*   PERFPL1 И PERFPL2  - TO ЖE CAMOE, HO
C*   C ДOПOЛHEHИEM KAЖДOГO CИMBOЛA ИЗ
C*   BXOДHOГO ФAЙЛA 8-M БИTOM
C*   ДO HEЧETA (PERFPL1)  ИЛИ
C*   ДO ЧETA (PERFPL)
C*======================================
C*      P E З Y Л Ь T A T :
C*......................................
C*       BЫДAHHAЯ ПEPФOЛEHTA
C*======================================
C*    ПPИMEP BЫДAЧИ ФOPTPAHHOЙ ПPOГPAM-
C* MЫ C MЛ ПOД MAT.HOMEPOM 42 ЗOHЫ 150
C* ДЛЯ PAБOTЫ HA ЭBM "CM-3" :
C*     *CALL PERFPL:42150,0,2,15,12
C***************************************
 CARD:,LC,14
 A/I0:,LC,1
 PAGE:,PC,1040
 N:,EQU,72
 NK:,P/P,(N)6
C---
  ,UTC,-1
  PERFPL1:,ENTRY,
  ,UTC,1-2
  PERFPL2:,ENTRY,
  14,VTM,2
  ,ITA,14
  ,ATX,ЧETHEЧET
 ,ITA,7
 ,ITS,6
 ,ITS,13
 ,ATX,SAVI13
C  ДOCTAEM ПAPAMETPЫ
 10,VTM,
 ,CALL,PARAMT*
 ,XTA,=37 0000
 ,ATX,YK
 9,VTM,YK
 10,VTM,4
 ,CALL,PARAMT*
 7,VTM,-1
 L2:,BSS,
 7,UTC,1
 9,VTM,KOL/BO
 10,VTM,7
 ,CALL,PARAMT*
 8,VTM,-5
 ,ITA,
 7,ATX,DIVSTR+1
 7,XTA,KOL/BO+1
 ,UZA,L3
 ,AEX,=77777
 ,ARX,=2
 ,ATI,6
 L:,BSS,
 9,VTM,W
 10,VTM,5
 ,CALL,PARAMT*
 7,XTA,DIVSTR+1
 ,ASN,64-8
 ,AOX,W
 7,ATX,DIVSTR+1
 8,UTM,1
 6,VLM,L
 L1:,BSS,
 ,ASN,64-8
 8,VLM,L1
 7,ATX,DIVSTR+1
 L3:,BSS,
 7,VLM,L2
C  ПPИГOTOBИMCЯ K ЧTEHИЮ KAPT
 14,VTM,YK
 ,ITS,14
 ,CALL,RBEGIN
C
C     KAK BЫЯCHИЛOCЬ, TOB.KOKYEB
C     HE YMEET ПPABИЛЬHO ПOЛЬЗOBATЬ
C     ПPOГPAMMЫ A.Л.ДABЫДOBA.
C
  ,XTA,A/I0
  ,AOX,KOL/BO
  ,ATX,KOL/BO
  ,ATI,6
  ,XTA,A/I0
  ,AOX,KOL/BO+1
  ,ATX,KOL/BO+1
  ,ATI,7
  8,VTM,PAGE
  ,FUN,70100B+576B.ФИO
  9,VTM,TITLE
  ,UZA,NOTIT
  9,ATX,
  ,FUN,70100B+577B.ФИO(2)
  9,ATX,1
  NOTIT:,ITS,8
  14,VTM,=I1024
  ,ITS,14
  ,ITS,9
  14,VTM,=I36
  ,ITS,14
  ,CALL,PTPBEG
C---
  GIVE:,BSS,
 14,VTM,CARD
 ,ITS,14
 ,CALL,RECARD
 10,VTM,-5
 9,VTM,NK
C  ECЛИ *READ OLD, TOГДA HA KOHEЦ
 ,XTA,CARD
 ,AEX,=6H*READ
 ,U1A,M1
 ,XTA,CARD+1
 ,AEX,=6HOLD
 ,UZA,TO END
C  OБPAБOTKA TEKYЩEЙ KAPTЫ
 M1:,BSS,
 9,XTA,CARD-1
 ,AEX,=H
 ,U1A,M2
 9,UTM,-1
  9,VZM,GIVE.ПYCTAЯ П/K
 ,UJ,M1
 M2:,BSS,
 ,ASN,64-8
 ,UZA,M3
 10,VLM,M2
 M3:,BSS,
 10,UTM,6
 ,NTR,6
 9,UTM,-1
  9,VIM,NO SKIP.> 6 CИMB.
  ,XTA,CARD
  ,AEX,=6H..
  ,U1A,NO SKIP
  9,VTM,-79
  :,XTS,
  ,CALL,PTPUNS
  9,VLM,*-1
  ,UJ,GIVE
  NO SKIP:,BSS,
 ,ITA,9
 ,AOX,A/I0
 ,A*X,=R6.
 ,NTR,7
 ,A+X,A/I0
 ,ATI,9
 10,J+M,9
  ,ITA,9
  ,AOX,A/I0
  ,ATX,W
  6,VZM,P/CAR
  14,VTM,DIVSTR
  ,ITS,14
  14,VTM,KOL/BO
  ,ITS,14
  ,CALL,PTPUNM
  P/CAR:,XTA,ЧETHEЧET
  ,UZA,PUNCH
  13,VTM,-13
  14,VTM,-5
  ЧET1:13,XTA,CARD+13
  ,ASN,64-8
  13,ATX,CARD+13
  ,YTA,
  15,ATX,
  ,ACX,
  ,AEX,ЧETHEЧET
  ,AAX,=1
  ,ASN,64-7
  15,AOX,
  13,AOX,CARD+13
  13,ATX,CARD+13
  14,VLM,ЧET1
  14,VTM,-5
  13,VLM,ЧET1
  PUNCH:14,VTM,CARD
  ,ITS,14
  14,VTM,W
  ,ITS,14
  ,CALL,PTPUNM
  7,VZM,GIVE
  14,VTM,DIVSTR+1
  ,ITS,14
  14,VTM,KOL/BO+1
  ,ITS,14
  ,CALL,PTPUNM
  ,UJ,GIVE
C----
  TO END:,BSS,
C..  ЗДECЬ БЫ ПEPФOPHYTЬ ПPИЗHAK KOHЦA
  14,VTM,=I50
  ,ITS,14
  ,CALL,PTPEND
 ,STI,
 ,STI,6
 ,ATI,7
 ,WTC,SAVI13
 ,UJ,
 ЧETHEЧET:,LOG,
  TITLE:,ISO,36H
 SAVI13:,BSS,1
 W:,BSS,1
 DIVSTR:,BSS,2
 YK:,BSS,1
 KOL/BO:,BSS,2
 ,END,
 PERSOT:,NAME,
C*
C*     П/П ДИHAMИЧECKOГO ЗAKAЗA
C*     PERSONAL LIBRARY
C*     OБPAЩEHИE:
C*     CALL PERSOT ('NNZZZZ,CONT')
C*     ГДE:
C*     NNZZZZ - YKAЗATEЛЬ ФAЙЛA
C*     CONT   - PEЖИM (HEOБЯЗATEЛЬHO)
C*
 MONCARD/:,LC,14
 LIBDRUM:,SUBP,
C
 C:8,BASE,*
 ,STI,10
 ,XTA,*PER
 ,ATX,MONCARD/
 ,XTA,DW
 ,ATX,MONCARD/+1
 10,XTA,
 ,ATX,MONCARD/+2
 10,XTA,1
 ,ATX,MONCARD/+3
 ,UJ,LIBDRUM
 DW:,ISO,6H:
 *PER:,ISO,6H*PERSO
 ,END,
 PRIBYT:,NAME,.7.08.81
C*********  7.08.81 **** ДABЫДOB A.Л. ***
C*
C*     SUBROUTINE PRIBYT(IDIM,L)
C*  ПEЧATЬ MACCИBA IDIM ДЛИHЫ L B BOCЬME-
C*  PИЧHOM BИДE ПO БAЙTAM.
C*
C****************************************
 PRINT8:,SUBP,
  B:,STI,14
 ,STI,9.IDIM
 ,ITA,8
 ,ITS,13
 8,BASE,B
  14,XTS,
  ,ATX,L
 ,AEX,=77777
 ,ARX,=2
 ,ATI,10.ДЛЯ ,VLM,
 BPRIN:,BSS,
 12,VTM,BUF
 11,VTM,-3
 BPRW:,BSS,
 ,WTC,L
 10,UTC,-1
 9,XTA,
 ,ATX,W.B БPЗ
 14,VTM,-3
 *1:,BSS,
 ,XTA,W
 14,APX,M1+3
 14,AUX,M2+3
 14,AOX,M3+3
 12,ATX,
 12,UTM,1
 14,VLM,*1
 ,XTA,=H
 12,ATX,
 12,UTM,1
 10,VLM,NEXT
 13,VTM,RET
 ,UJ,PRINT
 NEXT:,BSS,
 11,VLM,BPRW
 13,VTM,BPRIN
 PRINT:,BSS,
 14,VTM,BUF
 ,ITS,14
 12,UTM,-1
 ,ITS,12
 14,VTM,1
 ,ITS,14
 ,UJ,PRINT8
 RET:,BSS,
 ,STI,
 ,STI,13
 ,ATI,8
 13,UJ,
 L:,BSS,1
 W:,BSS,1
 BUF:,BSS,20
 M1:,OCT,7777 4
 ,OCT,0000 3777
 ,LOG,7777 4000
 ,LOG,0000 3777
 M2:,BSS,
 ,GOST,6H377037
 ,GOST,6H703770
 ,GOST,6H377037
 ,GOST,6H703770
 M3:,BSS,
 ,ISO,6H000 00
 ,ISO,6H0 000
 ,ISO,6H000 00
 ,ISO,6H0 000
 ,END,
 PRINT//M:,NAME,
C***** 12.09.80 ****** KOKYEB A.H.***
C*
C*   TO ЖE, ЧTO И PRINT8/M, HO ПEЧATAET
C*   БИЛИCTOM.
C*.....................................
C*   ДЛЯ CБPOCA БYФEPA :
C*   ,UTC,1
C*   ,CALL,PRINT8//
C*.....................................
C*   ДЛЯ ПEPEXOДA HA HOBYЮ CTPAHИЦY
C*   (B CMЫCЛE БИЛИCTИHГA):
C*   ,UTC,2
C*   ,CALL,PRINT8//
C*.....................................
C*   PEГИCTPЫ  1-12 COXPAHЯЮTCЯ.
C**************************************
 PRINT8//:,SUBP,
 ENTRY8/M:,SUBP,
 ,ATI,14
 ,ITA,10
 10,VTM,PRINT8//
 ,UJ,ENTRY8/M
 ,END,
 PRINT8/M:,NAME,.12.09.80
C***** 12.09.80 ******* KOKYEB A.H.***
C*
C*   ПEЧATЬ  HA  AЦПY  TEKCTOBOЙ  CTPO-
C*   KИ (ISO).
C*   BЫШEOЗHAЧEHHAЯ CTPOKA ДOЛЖHA OKAH-
C*   ЧИBATЬCЯ  0-БAЙTOM, A AДPEC EE HA-
C*   ЧAЛA ДOЛЖEH БЫTЬ HA CYMMATOPE ПPИ
C*   OБPAЩEHИИ K П/П.
C*................................ .....
C*   PEГИCTPЫ  1-12 COXPAHЯЮTCЯ.
C**************************************
 PRINT8:,SUBP,
C    NП - HOMEP HAЧ. ПOЗ. ПPИ ПEPEHOCE
 NП:,EQU,24.KPATHO 6-TИ.
 N1:,EQU,60-NП
 NW2:,P/P,(N1)6
 B:,BSS,
 ,ATI,14.ADR.CTPOKИ
 ,ITA,10
 10,VTM,.FLAG
 ENTRY8/M:,ENTRY,.ДЛЯ PRINT//M
 ,ITS,13
 ,ITS,12
 ,ITS,11
 ,ITS,9
 11,BASE,B
 ,ITS,
 ,ATX,NПOЗ
 13,VTM,RET
 12,VTM,-9
 14,MTJ,9
 S/0:,BSS,
 14,XTA,
 14,UTM,1
 ,ARX,=6H'177''177''177''177''177''177'
 ,AAX,=6H'200''200''200''200''200''200'
 ,AEX,=6H'200''200''200''200''200''200'
 ,U1A,PRINT.KOHEЦ TEKCTA
 10,VZM,S/0.MOHOЛИCT
 12,VLM,S/0.БИЛИCT
C   OTПEЧATAHO 60 CИMBOЛOB БИЛИCTOM.
 12,VTM,1-NW2.ПEPEHOC NW2 CЛOB
 13,VTM,RS/0
 PRINT:,BSS,
 ,ITS,9.AHAЧ
 14,MTJ,9
 14,UTM,-1
 ,ITS,14.AKOH
 ,XTS,NПOЗ.N ПOЗИЦИИ
 10,VZM,PRINT8
 10,UJ,.PRINT8//
 RS/0:9,MTJ,14
 ,XTA,NП2
 ,ATX,NПOЗ
 13,VJM,S/0
C......................................
 RET:,BSS,
 ,STI,
 ,STI,9
 ,STI,11
 ,STI,12
 ,STI,13
 ,ATI,10
 13,UJ,
 NПOЗ:,BSS,1
 NП2:,,
 ,Z00,NП.
 ,END,
 PRINTER:4,NAME,
C*** 20.11.80 ****** KOKYEB A.H. ***
C*
C*  ПPOГPAMMA ДЛЯ ПEЧATИ (B YKAЗAH-
C* HOM KOЛИЧECTBE) AHKET,OБ'ЯBЛEHИЙ,
C* TAБЛИЦ И T.П. . BЫШEYKAЗAHHЫE
C* ДOKYMEHTЫ PACПOЛAГAЮTCЯ HA ЛИCTE
C* A Ц П Y  HAИБOЛEE OПTИMAЛЬHЫM
C* OБPAЗOM.
C*..................................
C*       O Б P A Щ E H И E :
C*   *CALL PRINTER:<YK>,<KOЛ-BO>
C*  YK     - YKAЗATEЛЬ ФAЙЛA
C*           (PEДAKTOPCKOГO ИЛИ
C*            MYЛЬTИTAЙПHOГO), ГДE
C*            HAXOДИTCЯ TEKCT ДOKYM.
C*  KOЛ-BO - KOЛИЧECTBO ЭKЗEMПЛЯPOB.
C***********************************
 *MONCRD*:,LC,12
 CARD:,LC,14
 BUFFER:,LC,2904
 FORM:,LC,1848
 A/I0:,LC,1
 ,ITA,1
 ,ITS,2
 ,ITS,4
 ,ITS,5
 ,ITS,6
 ,ITS,13
 ,ATX,SAVEI13
 4,VTM,20000B
 5,VTM,40000B
 6,VTM,60000B
 10,VTM,
 ,CALL,PARAMT*
 9,VTM,YK
 10,VTM,4.IW70
 ,CALL,PARAMT*
 9,VTM,HOW*MANY
 10,VTM,7
 ,CALL,PARAMT*
 ,XTA,HOW*MANY
 ,AOX,A/I0
 ,ATX,HOW*MANY
 14,VTM,YK
 ,ITS,14
 ,CALL,RBEGIN
 1,VTM,-131
 2,VTM,
 ,NTR,7
 ,ITA,
 ,ATX,W1
 ,XTA,A/I0
 ,ATX,HOW*LINE
 L:,BSS,
 14,VTM,CARD
 ,ITS,14
 ,CALL,RECARD
 9,VTM,14
 9,XTA,CARD-14
 ,AEX,=6H*READ
 ,U1A,L1
 9,XTA,CARD-13
 ,AEX,=6HOLD
 ,UZA,END/1
 L1:,BSS,
 9,XTA,CARD-1
 ,AAX,=6H'377''377''0''0''0''0'
 ,AOX,=6H'0''0'
 9,ATX,CARD-1
 L1/1:,BSS,
 9,XTA,CARD-1
 ,AEX,=H
 ,U1A,L2
 ,AEX,=H
 2,UTC,
 9,ATX,FORM-1
 9,UTM,-1
 9,V1M,L1/1
C...  ЗA CЛEДYЮЩYЮ KOMAHДY T.KOKYEB
C     ДOЛЖEH CKAЗATЬ "CПACИБO"
  9,VTM,1.CAПOЖHИKOBY
 L2:,BSS,
 10,VTM,-5
 L3:,BSS,
 ,ASN,64-8
 ,UZA,L4
 10,VLM,L3
 L4:,BSS,
 10,UTM,6
 ,ITA,9
 ,X-A,W1
 ,U1A,L5
 ,AEX,
 ,UZA,L6
 L7:,BSS,
 9,XTA,CARD-1
 2,UTC,
 9,ATX,FORM-1
 9,UTM,-1
 9,V1M,L7
 2,UTM,14
 1,VLM,L
 14,VTM,ERR*TEXT
 ,ITA,14
 ,CALL,PRINT8/M
 ,UJ,END
 L5:,BSS,
 ,ITA,9
 ,ATX,W1
 L6/1:,BSS,
 ,ITA,10
 ,ATX,W2
 ,UJ,L7
 L6:,BSS,
 ,ITA,10
 ,X-A,W2
 ,U1A,L6/1
 ,UJ,L7
 END/1:,BSS,
 ,NTR,6
 1,UTM,131
 ,XTA,W1
 ,AOX,A/I0
 ,A-X,=I1
 ,A*X,=R6.
 ,NTR,7
 ,A+X,A/I0
 ,ARX,W2
 ,ATX,W1
C  B W1 MAX KOЛ-BO CИMBOЛOB B CTPOKE
 ,NTR,6
 ,A+X,A/I0
 ,XTS,=I127
 15,A/X,
 ,NTR,7
 ,A+X,A/I0
 ,X-A,A/I0
 ,ATX,W2
C  B W2 CK. PAЗ ДOKYMEHT ПOMEЩAETCЯ
C  ПO ШИPИHE HA ЛИCTE  A Ц П Y
 ,ITA,1
 ,AOX,A/I0
 ,X-A,A/I0
 ,ATX,W
C  B W CK. CTPOK B ДOKYMEHTE
 1,VTM,M
C=======================================
C    ЗAПOЛHEHИE БYФEPA ПEЧATИ
 WR*BUF:,BSS,
 8,VTM,
 2,VTM,
 ,WTC,W
 11,VTM,1
 R:,BSS,
 8,UTC,
 10,VTM,BUFFER
 12,VTM,
 ,CALL,STACK*
 12,VTM,1
 14,VTM,=1H
 ,CALL,STACK*
 ,WTC,W1
 12,VTM,
 ,WTC,W2
 9,VTM,1
 R1:,BSS,
 2,UTC,
 14,VTM,FORM
 ,CALL,STACK*
 9,VLM,R1
 12,VTM,1
 14,VTM,
 ,CALL,STACK*
 8,UTM,22
 2,UTM,14
 11,VLM,R
 1,UJ,
C=======================================
C        ПEPEXOДИM K ПEЧATИ
 M:,BSS,
 ,XTA,HOW*LINE
 ,A+X,W
 ,U1A,M1
 ,ATX,HOW*LINE
 ,XTA,HOW*MANY
 ,A+X,W2
 ,U1A,M2
 ,ATX,HOW*MANY
 ,AEX,
 ,U1A,M3
 M4:,BSS,
 12,VTM,
 M3:,BSS,
 ,WTC,W
 11,VTM,1
 8,VTM,
C  ЦИKЛ PACПEЧATKИ OДHOЙ ПOЛOCЫ
 PRINT:,BSS,
 8,UTC,
 14,VTM,BUFFER
 ,ITA,14
 ,CALL,PRINT8/M
 8,UTM,22
 11,VLM,PRINT
C=======================================
 12,V1M,M
 END:,BSS,
 ,*64,INF*64
 ,STI,
 ,STI,6
 ,STI,5
 ,STI,4
 ,STI,2
 ,ATI,1
 ,WTC,SAVEI13
 ,UJ,
 M1:,BSS,
 ,XTA,=I66
 ,ATX,HOW*LINE
 ,*64,INF*64
 ,UJ,M
 M2:,BSS,
 ,X-A,A/I0
 ,NTR,7
 ,A+X,W2
 ,ATX,W2
 1,VTM,M4
 ,UJ,WR*BUF
 YK:,BSS,1
 HOW*MANY:,BSS,1
 HOW*LINE:,INT,
 W:,BSS,1
 W1:,BSS,1
 W2:,BSS,1
 INF*64:,,/*/
 ,,/*/
 ,,
 8,,
 /*/:,GOST,2H'201''231'
 ERR*TEXT:,ISO,22HCЛИШKOM ДЛИHHЫЙ БYФEP''
 SAVEI13:,BSS,1
 ,END,
      PRINTSP*   :,NAME,
      DATAPR*    :,SUBP,
      MIST10*    :,LC,  3
      OUT*OUT    :,LC,  1
      PRINT8//   :,SUBP,
      LIST       :,PC,  10000B
      PARAMT*    :,SUBP,
LL164:,P/P,       (   LIST   )20B
                 ,ITS,  13
                 ,ITS,  7
                 ,ITS,  6
                 ,ITS,  5
             7 ,  VTM,   *00105
             7 ,  XTS,  32B
                 ,UTC,  OUT*OUT
                 ,ATX,
                 ,MTJ,  9
                 ,MTJ,  10
            13 ,  VJM,  PARAMT*
            11 ,  VZM,   *00103
            10 ,  VTM,  4
             9 ,  VTM,   BSS+ 0017B
            13 ,  VJM,  PARAMT*
             7 ,  AOX,
             7 ,  ATX,  63B
            11 ,  VZM,   *00103
            10 ,  VTM,  5
             9 ,  VTM,   BSS+ 0020B
            13 ,  VJM,  PARAMT*
                 ,ATI,  5
             5 ,  UTM,      LIST
            10 ,  VTM,  5
             9 ,  VTM,  21B
            13 ,  VJM,  PARAMT*
                 ,ATI,  6
             7 ,  ARX,  64B
             7 ,  ARX,  42B
             7 ,  AAX,  31B
                 ,ASN,  112B
                 ,ATX,  21B
            10 ,  VTM,  5
             9 ,  VTM,   BSS+ 0016B
            13 ,  VJM,  PARAMT*
                 ,MTJ,  9
            10 ,  VTM,  2
             7 ,  XTA,  32B
            13 ,  VJM,  PARAMT*
                 ,UIA,   *00027
             7 ,  XTA,  63B
             7 ,  AOX,  23B
             7 ,  ATX,  63B
 *00027    :     ,UTC,  MIST10*
                 ,XTA,
                 ,UIA,   *00103
                 ,WTC,  21B
            12 ,  VTM,
                 ,UTC,
 *00032    : 7 ,   *70, 63B
             7 ,  XTA,  63B
             7 ,  ARX,  30B
             7 ,  ATX,  63B
            12 ,  VZM,   *00036
            12 ,  UTM,  77777B
                 , UJ,   *00032
 *00036    :     ,XTA,
            13 ,  VJM,  DATAPR*
            14 ,  VTM,   *00110
                 ,ITS,  14
            14 ,  VTM,   *00120
                 ,ITS,  14
            14 ,  VTM,  5
                 ,ITS,  14
            13 ,  VJM,  PRINT8//
             7 ,  XTA,  35B
             7 ,  ATX,  47B
 *00044    : 6 ,  VZM,   *00076
             7 ,  XTA,  62B
             7 ,  APX,  42B
             7 ,  AUX,  36B
             7 ,  AOX,  26B
             7 ,  ATX,  44B
            13 ,  VTM,  77777B
            12 ,  VTM,
 *00050    : 5 ,  XTA,
            13 ,  WTC,   *00127
                 ,ASN,  50B
             7 ,  ATX,  56B
             7 ,  XTA,  56B
             7 ,  AAX,  43B
             7 ,  AUX,  33B
             7 ,  AOX,  25B
                 ,UTC,   BSS+ 0001B
            12 ,  ATX,
             7 ,  XTA,  56B
             7 ,  AAX,  24B
                 ,UIA,   *00061
             7 ,  XTA,  56B
             7 ,  APX,  41B
             7 ,  AUX,  34B
             7 ,  AOX,  40B
                 , UJ,   *00063
 *00061    : 7 ,  XTA,  56B
             7 ,  APX,  41B
             7 ,  AUX,  36B
             7 ,  AOX,  26B
 *00063    :     ,UTC,   BSS+ 0002B
            12 ,  ATX,
            12 ,  UTM,  3
            13 ,  VLM,   *00050
            14 ,  VTM,   BSS+ 0000B
                 ,ITS,  14
            14 ,  UTM,  2
                 ,ITS,  14
             7 ,  XTS,  37B
            13 ,  VJM,  PRINT8//
            14 ,  VTM,   BSS+ 0003B
                 ,ITS,  14
            14 ,  UTM,  2
                 ,ITS,  14
             7 ,  XTS,  37B
            13 ,  VJM,  PRINT8//
             5 ,  UTM,  1
             6 ,  UTM,  77777B
             7 ,  XTA,  62B
             7 ,  ARX,  27B
             7 ,  ATX,  62B
                 , UJ,   *00044
 *00076    :     ,UTC,  1
            13 ,  VJM,  PRINT8//
                 ,UTC,  2
            13 ,  VJM,  PRINT8//
 *00100    :     ,STI,
                 ,STI,  5
                 ,STI,  6
                 ,STI,  7
                 ,STI,  13
            13 ,   UJ,
 *00103    : 7 ,   *64, 1
                 , UJ,   *00100
                 ,UTC,
 *00105    :     ,XTA,   L164
                 ,ATX,
             7 ,  ATX,  12
             7 ,  ATX,  12
                 ,XTA,
             8 ,  ATX,
 *00110    :,     LOG,  34050117 31650101.
            ,     LOG,  23246501 10020040.
            ,     LOG,  20640530 20250117.
            ,     LOG,  20440440 10020040.
            ,     LOG,  24040503 34042576.
            ,     LOG,  20252113 32220102.
            ,     LOG,  10046501 36664510.
            ,     LOG,  22074530 10020040.
 *00120    :,     LOG,  22647544 20254056.
            ,     LOG,  20442104 11240440.
            ,     LOG,  21007510 10025055.
            ,     LOG,  10043456 22415110.
            ,     LOG,  03630440 21637417.
            ,     LOG,  26714417 03607417.
            ,     LOG,  00000000 00000030.
 *00127    :,     LOG,  00000000 00000000.
            ,     LOG,  00040000 00000000.
            ,     LOG,  02000000 00000000.
            ,     LOG,  10030060 10030060.
            ,     LOG,  10030060 14030060.
            ,     LOG,  00000000 00000001.
            ,     LOG,  00000100 00000001.
            ,     LOG,  00000000 00006000.
            ,     LOG,  24044131 24620040.
            ,     LOG,  00000407 00001407.
            ,     LOG,  01600007 01603407.
            ,     LOG,  10020040 13220040.
            ,     LOG,  00003407 01603407.
            ,     LOG,  00000000 00000011.
            ,     LOG,  14020060 14030060.
            ,     LOG,  00077777 00000000.
            ,     LOG,  00000000 00077777.
            ,     LOG,  77700000 00000000.
 BSS       :     ,BSS,  21B
      ,END,
      PT6        :,NAME,
            15 ,  ATX,
                 ,ASN,  107B
                 ,UZA,   *00006
                 ,UTC,   *00072
                 ,XTA,
                 ,UTC,   *00066
                 ,ATX,
                 ,STX,
                 ,UTC,   *00065
                 ,ATX,
                 , UJ,   *00014
                 ,UTC,
 *00006    :     ,STX,
                 ,UTC,
 *00007    :     ,ASN,  34B
                 ,UTC,   *00060
                 ,XTS,
                 ,UTC,   *00067
                 ,AAX,
            15 ,  AOX,
                 ,AOX,
                 ,UTC,   *00060
                 ,ATX,
                 ,UTC,
 *00014    :     ,UTC,   *00070
                 ,XTA,
                 , UJ,   *00023
                 ,UTC,
                 ,ASN,  34B
                 ,UTC,   *00060
                 ,AOX,
                 ,UTC,   *00060
                 ,ATX,
                 ,STX,
                 ,ASN,  37B
                 ,UTC,   *00072
                 ,AUX,
                 ,UTC,
 *00023    :     ,UTC,   *00071
                 ,AOX,
                 ,UTC,   *00110
                 ,STX,
                 ,UTC,   *00106
                 ,ATX,
                 ,ITA,  3
                 ,ITS,  4
                 ,ITS,  5
                 ,ITS,  7
             7 ,  VTM,   *00007
            14 ,  VTM,  77765B
             7 ,  XTS,  77B
                 ,UTC,
 *00032    :     ,ASN,  72B
            15 ,  ATX,
                 ,YTA,
                 ,NTR,  3
                 ,X-A,
                 ,ATI,  4
             3 ,  VTM,
                 ,NTR,  2
 *00036    : 5 ,  VTM,  77773B
                 ,UTC,   *00073
             3 ,  XTA,
                 ,UTC,
 *00040    :     ,ASN,  70B
             4 ,  VLM,   *00042
                 ,YTA,
                 , UJ,   *00044
 *00042    : 5 ,  VLM,   *00040
             3 ,  UTM,  1
                 , UJ,   *00036
                 ,UTC,
 *00044    : 7 ,  XTS,  100B
                 ,ASN,  70B
            15 ,  ATX,
                 ,YTA,
             7 ,  XTS,  77B
                 ,ASN,  70B
            15 ,  AOX,
             7 ,  STX,  77B
            15 ,  AOX,
             7 ,  STX,  100B
            14 ,  VLM,   *00032
             7 ,  XTA,  57B
                 ,UIA,   *00061
             7 ,   *64, 50B
 *00053    :     ,XTA,
             7 ,  ATX,  57B
                 ,STI,
                 ,STI,  7
                 ,STI,  5
                 ,STI,  4
                 ,STI,  3
            13 ,   UJ,
                 ,UTC,   *00106
                 ,UTC,   *00106
 *00060    :     ,ATX,
             8 ,  ATX,
 *00061    : 7 ,  XTA,  77B
                 ,WTC,   *00065
                 ,ATX,
             7 ,  XTA,  100B
                 ,WTC,   *00065
                 ,ATX,  1
                 , UJ,   *00053
                 ,UTC,
 *00065    :,     LOG,  00000000 00000000.
 *00066    :,     LOG,  00000000 00000000.
 *00067    :,     LOG,  74007777 77777777.
 *00070    :,     LOG,  03607417 03607400.
 *00071    :,     LOG,  00000000 00000231.
 *00072    :,     LOG,  01603407 01603400.
 *00073    :,     LOG,  10055542 30662146.
            ,     LOG,  31664533 26625152.
            ,     LOG,  33070566 13630061.
            ,     LOG,  14431464 15233067.
            ,     LOG,  16034570 26670055.
            ,     LOG,  12674572 20241103.
            ,     LOG,  21042506 21644111.
            ,     LOG,  22445514 23247117.
            ,     LOG,  24050522 24652125.
            ,     LOG,  25453530 26255173.
            ,     LOG,  37076576 30007414.
 *00106    :,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
 *00110    :,     LOG,  00000000 00000000.
 BSS       :     ,BSS,
      ,END,
  PTPUNS:,NAME,
C*
C******** 04.07.81   A.П.CAПOЖHИKOB
C*
C*   ПEPФOPAЦИЯ HA БYMAЖHYЮ ЛEHTY
C*   YCTPOЙCTBA : ПЛ-20, ПЛ-80, ПЛ-150
C*
C*   SUBROUTINE PTPBEG(BUF,LBUF,TITLE,LTIT)
C*   SUBROUTINE PTPUNS (SYM)
C*   SUBROUTINE PTPUNM (PACK,N)
C*   SUBROUTINE PTPEND (LEMPT)
C*   FUNCTION MATRCH(LET)
C*
C*   PTPBEG - ИHИЦИИPYЮЩИЙ BXOД
C*   BUF - MACCИB, B KOTOPOM БYДET БYФEPИЗO-
C*         BATЬCЯ ПEPФOPИPYEMЫЙ MATEPИAЛ.
C*   LBUF - ДЛИHA BUF (ЧEM БOЛЬШE, TEM ЛYЧШE
C*         HO HE БOЛEE 1024 CЛOB).
C*   TITLE - TEKCTOBЫЙ MACCИB B KOДE ISO,
C*         LTIT CИMBOЛOB KOTOPOГO ПEPФOPИPY-
C*         ЮTCЯ KPYПHЫM ШPИФTOM. ПPИ LTIT<1
C*         ЗAГOЛOBOK HE ПEPФOPИPYETCЯ.
C*   PTPUNS - ПEPEДAЧA B БYФEP ПEPФOPAЦИИ
C*         OДHOГO CИMBOЛA (1-8 PAЗPЯДЫ SYM)
C*         9-48 PAЗPЯДЫ SYM HECYЩECTBEHHЫ.
C*   PTPUNM - ПEPEДAЧA B БYФEP ПEPФOPAЦИИ
C*         N CИMBOЛOB, YПAKOBAHHЫX ПO 6 B
C*         KAЖДOM CЛOBE MACCИBA PACK.
C*   PTPEND - ДOCБPOC БYФEPA ПO OKOHЧAHИИ
C*         PAБOTЫ И ПPOГOH ПEPФOЛEHTЫ HA
C*         LEMPT  ПOЗИЦИЙ.
C*   MATRCH - ПOЛYЧEHИE MATPИЦЫ 8:6 БИT
C*         ДЛЯ ГPAФИЧECKOГO ИЗOБPAЖEHИЯ
C*         CИMBOЛA LET, ЗAДAHHOГO B BИДE
C*         ЦEЛOГO ИЛИ BOCЬMEPИЧHOГO ЧИCЛA,
C*         ЛИБO B BИДE:  1H<CИMBOЛ>
C*
C*   ПOPTЯTCЯ 8-14 PEГИCTPЫ.
C****************************************
C*
  LIST:,WEQ,43B
  SAV:,EQU,46B
  RES:,EQU,45B
C...
  B:8,BASE,B
  ,STI,12
  12,XTA,
  13,MTJ,12
  BUFS:,AAX,=377
  ,ASX,TEKADR
  ,WTC,TEKADR
  ,AOX,
  ,WTC,TEKADR
  ,ATX,
  ,XTA,TEKADR
  ,ATX,SIS
  14,VTM,=:04
  ,ARX,
  :,U1A,*+1
  14,VTM,=5400 0000 0100 0000
  :14,ARX,
  ,ATX,TEKADR
  ,AEX,LBUF
  ,AAX,=777 7700 0000
  12,U1A,
  ,ATX,SIS
  SWOP:,ITA,12
  ,ATX,I12
  ,XTA,LBUF
  ,ASN,64+18
  ,ATI,12
  ,ARX,IW71
  ,ATX,PUNCH
  ,*70,SAV
  ,XTA,
  14,VTM,-1023
 :14,ATX,LIST+1023
  14,VLM,*
  TR:,WTC,ABUF
  12,XTA,-1
  ,UTC,LIST
  12,ATX,-1
  ,XTA,
  ,WTC,ABUF
  12,ATX,-1
  12,UTM,-1
  12,VIM,TR
  ,*71,PUNCH
  ,XTA,ABUF
  ,AOX,=:14
  ,ATX,TEKADR
  ,*70,RES
  ,WTC,I12
  ,UJ,
C.....
  PTPUNM:,ENTRY,
  8,BASE,B
  ,STI,10
  ,STI,9
  10,WTC,
  10,VTM,
  11,VTM,48
  TRW:13,UTC,
  10,VZM,
  9,XTA,
  11,UTM,-8
  11,ASN,64
  12,VJM,BUFS
  10,UTM,-1
  11,VIM,TRW
  11,VTM,48
  9,VLM,TRW
C......
  PTPEND:,ENTRY,
  8,BASE,B
  ,STI,14
  14,XTA,
  ,ATI,9
  ZER:,XTA,
  12,VJM,BUFS
  9,UTM,-1
  ,ITA,9
  ,ASN,64+14
  ,UZA,ZER
  ,XTA,SIS
  13,UZA,
  13,MTJ,12
  ,XTA,TEKADR
  ,ARX,=100 0000
  ,AAX,=777 7700 0000
  ,ATX,LBUF
  ,UJ,SWOP
C......
  PTPBEG:,ENTRY,
  8,BASE,B
  ,STI,9
  ,STI,10
  ,STI,14
  ,AAX,=77777
  ,ATX,ABUF
  ,AOX,=:14
  ,STX,TEKADR
  14,XTA,
  ,ATI,14
  ,ASN,64-18
  ,ATX,LBUF
  ,ASN,64+28
  ,UZA,CL
  ,XTA,=20 0000 0000
  ,ATX,LBUF
  CL:,XTA,
  ,WTC,ABUF
  14,ATX,-1
  14,UTM,-1
  14,VIM,CL
  9,WTC,
  9,VTM,-1
  11,VTM,48
  LS:10,XTA,
  11,UTM,-8
  11,ASN,64
  ,AAX,=377
  ,ATI,14
  ,ASN,64+5
  ,UZA,HEND
  14,XTA,TABL-40B
  ,ATX,WS
  ,XTA,=4040 4040 4040 4040
  ,ATX,MASK
  LB:,XTA,WS
  ,APX,MASK
  ,ASN,64+40
  12,VJM,BUFS
  ,XTA,MASK
  ,ASN,64+1
  ,ATX,MASK
  ,ACX,
  ,AEX,=10
  ,UZA,LB
  HEND:9,UTM,-1
  11,VIM,LW
  11,VTM,48
  10,UTM,1
  LW:,ITA,9
  ,ASN,64+14
  ,UZA,LS
  10,VTM,-35
  :,XTA,
  12,VJM,BUFS
  10,VLM,*-1
  13,UJ,
  IW71:,Z00,LIST
  ,Z00,LIST-1
C---------------------------------------
  MATRCH:,ENTRY,
  8,BASE,B
  ,ATI,14
  14,XTA,
  ,AEX,=6H
  ,ASN,64-8
  12,VTM,40
  :,UZA,*+1
  12,VTM,
  :14,XTA,
  12,ASN,64
  ,AAX,=377
  ,ATI,14
  ,ASN,64+5
  13,UZA,.< 40B
  ,ASN,64+2
  :,U1A,*+1.> 177B
  14,UTC,-40B
 :,XTA,TABL
  13,UJ,
C------------------
  TABL:,BSS,
  ,LOG,.ПPOБEЛ
         :   ,  OCT  ,1010101010001000    .
         :   ,  OCT  ,4444000000000000    .
         :   ,  OCT  ,4644645444444400    .
         :   ,  OCT  ,2214222214220000    .
         :   ,  OCT  ,0002241024400000    .
         :   ,  OCT  ,1024241024340200    .
         :   ,  OCT  ,1410000000000000    .
         :   ,  OCT  ,0410202020100400    .
 :,OCT,1004020202041000
         :   ,  OCT  ,0000245224000000    .
         :   ,  OCT  ,0000103410000000    .
         :   ,  OCT  ,0000000000003020    .
         :   ,  OCT  ,0000003400000000    .
         :   ,  OCT  ,0000000000303000    .
         :   ,  OCT  ,0000041020000000    .
         :   ,  OCT  ,3442424242423400    .
         :   ,  OCT  ,0414240404041600    .
         :   ,  OCT  ,3442020410207600    .
         :   ,  OCT  ,7604100402423400    .
         :   ,  OCT  ,0206122242760200    .
         :   ,  OCT  ,7440740202423400    .
         :   ,  OCT  ,3440744242423400    .
         :   ,  OCT  ,7642020410202000    .
         :   ,  OCT  ,3442241024423400    .
         :   ,  OCT  ,3442424236023400    .
         :   ,  OCT  ,0014140000141400    .
         :   ,  OCT  ,0030300000003020    .
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,0000340034000000    .
         :   ,  OCT  ,0010040204100000    .
  :,OCT,1422220204000400
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,3442424242764200    .
         :   ,  OCT  ,7444704442427400    .
         :   ,  OCT  ,3640404040403600    .
         :   ,  OCT  ,7044424242427400    .
         :   ,  OCT  ,7440704040407600    .
         :   ,  OCT  ,7640744040404000    .
         :   ,  OCT  ,3442404046423400    .
         :   ,  OCT  ,4242764242424200    .
         :   ,  OCT  ,3410101010103400    .
         :   ,  OCT  ,1602020202423400    .
         :   ,  OCT  ,4450605044424200    .
         :   ,  OCT  ,4040404040407600    .
         :   ,  OCT  ,4266525242424200    .
         :   ,  OCT  ,4262524642424200    .
         :   ,  OCT  ,3442424242423400    .
         :   ,  OCT  ,7442424274404000    .
         :   ,  OCT  ,3442424252463402    .
         :   ,  OCT  ,7442427450444200    .
         :   ,  OCT  ,3440340202423400    .
         :   ,  OCT  ,7610101010101000    .
         :   ,  OCT  ,4242424242423400    .
         :   ,  OCT  ,4242424242241000    .
         :   ,  OCT  ,4242424252522400    .
         :   ,  OCT  ,4224102442424200    .
         :   ,  OCT  ,4242422410101000    .
         :   ,  OCT  ,7602041020407600    .
 :,OCT,3020202020203000
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,0602020202020600    .
         :   ,  OCT  ,0000001024420000    .
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,4452725252524400    .
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,7640744242427400    .
         :   ,  OCT  ,4242424242427602    .
         :   ,  OCT  ,3424242424764200    .
         :   ,  OCT  ,7440704040407600    .
         :   ,  OCT  ,1076525276101000    .
         :   ,  OCT  ,7640404040404000    .
         :   ,  OCT  ,4224102442424200    .
         :   ,  OCT  ,4242424652624200    .
         :   ,  OCT  ,1042424652624200    .
         :   ,  OCT  ,4450605044424200    .
         :   ,  OCT  ,1622222222224200    .
         :   ,  OCT  ,4266525242424200    .
         :   ,  OCT  ,4242764242424200    .
         :   ,  OCT  ,3442424242423400    .
         :   ,  OCT  ,7642424242424200    .
         :   ,  OCT  ,3642423612224200    .
         :   ,  OCT  ,7442424274404000    .
         :   ,  OCT  ,3640404040403600    .
         :   ,  OCT  ,7610101010101000    .
         :   ,  OCT  ,4242422212043000    .
         :   ,  OCT  ,5234103452525200    .
         :   ,  OCT  ,0000000000000000    .
         :   ,  OCT  ,4040744242427400    .
         :   ,  OCT  ,4242605252522200    .
         :   ,  OCT  ,3044100402423400    .
         :   ,  OCT  ,4242525252527600    .
         :   ,  OCT  ,7402360202027400    .
         :   ,  OCT  ,4242525252527701    .
         :   ,  OCT  ,4242424276020200    .
         :   ,  OCT  ,0000000000000000    .
C
C-------------------------------
C
  TEKADR:,BSS,1
  PUNCH :,BSS,1
  ABUF:,BSS,1
  LBUF  :,BSS,1
  MASK  :,BSS,1
  SIS   :,BSS,1
  I12   :,BSS,1
  WS    :,BSS,1
  ,END,
  PULLMOD:,NAME,.BMECTO COMPARE2
C*
C*****         H.C.ГOHЧAPOB.
C*
C*    CPABHEHИE TEKCTOBЫX ФAЙЛOB
C*
C*  *CALL PULLMOD:<OLD><D1><NEW><D2><MOD>,<LEN>
C*    OLD (30) - YK. ЧTEHИЯ CTAPOГO TEKCTA
C*    NEW (31) - YK. ЧTEHИЯ HOBOГO  TEKCTA
C*    MOD (05) - YK. ЗAПИCИ PEДAKЦИИ
C*    LEN (7)  - ДЛИHA ГPYППЫ COBПAДAЮЩИX KAPT
C*               ДЛЯ OПPEДEЛEHИЯ ИДEHTИЧHOCTИ
C*    D1 - PAЗДEЛИTEЛЬ, ECЛИ + CPABHEHИE ПOЛHOЙ KAPTЫ
C*         ИHAЧE  CPABHEHИE БEЗ HOMEPOB
C*    D2 - PAЗДEЛИTEЛЬ, ECЛИ + ПEЧATЬ ПOЛHOЙ KAPTЫ
C*         ИHAЧE  ПEЧATЬ БEЗ HOMEPOB
C*
C*    B CKOБKAX YKAЗAHЫ ЗHAЧEHИЯ ПAPAMETPOB
C*    ПO YMOЛЧAHИЮ.
C*
C*    ПO YKAЗATEЛЮ  MOD  ФOPMИPYETCЯ ПAKET
C*    PEДAKЦИИ, ПPEBPAЩAЮЩИЙ ФAЙЛ  OLD  B
C*    ФAЙЛ  NEW .
C*    PEДAKЦИЯ PACПEЧATЫBAETCЯ, ECЛИ HE БЫЛO
C*    KAPTЫ  *NO LIST .
C*
 NOLISFL*:,LC  ,
 STOP*   :,SUBP,
 COSYTISO:,SUBP,
 WRCARD  :,SUBP,
 WRIEND  :,SUBP,
 PARAMT* :,SUBP,
 TABSIMIS:,SUBP,
 PAGE:,PC,2048
 NP  :,P/P,(PAGE)16
 *1:,BLOCK,EF,OF,P,L,N
    ,CONT ,E,A,F,R,T
    ,CONT ,C,I,J,M,S
 PLUS:,EQU,53B
C--------------------------
   M,VTM,M
  :M,UTM,-1
   M,ITS,
   M,V1M,*-1
   M,VTM,PN*O-W80
  :M,ATX,W80
   M,VLM,*
    ,XTA,=30 0000
    ,ATX,IU*O
    ,XTA,=31 0000
    ,ATX,IU*N
    ,XTA,=05 0000
    ,ATX,IUM
    ,XTA,=7
    ,ATX,ML
   T,VTM,
    ,CALL,PARAMT*
   T,VTM,4
   R,VTM,IU*O
    ,CALL,PARAMT*
    ,XTA,=2
   C,UTM,-PLUS
  :C,VZM,*+1
    ,ATX,M80
   R,VTM,IU*N
    ,CALL,PARAMT*
    ,XTA,=6H
   C,UTM,-PLUS
  :C,VZM,*+1
    ,ATX,W80
   R,VTM,IUM
    ,CALL,PARAMT*
   E,VTM,
   T,VTM,5
   R,VTM,ML
    ,CALL,PARAMT*
   M,V1M,STOP*
   M,VTM,IUM
    ,ITS,M
    ,CALL,WBEGIN
  OF,VTM,-1
    ,XTA,=6H*EDIT
    ,ATX,COCA
   J,VJM,CCOUT
 OUTHEA:,BSS,
   A,VTM,COCA
  OF,XTA,HEAD+1
   A,ATX,
  OF,XTA,IU*
    ,ASN,64-30
    ,AUX,=6H'7''7''7''7''7''7'
    ,AEX,=6H000000
   A,ATX,1
   J,VJM,COUT
  OF,XTA,IP*
  OF,AEX,IU*
  OF,ATX,IU*
  OF,TAPE,IU*
  OF,VLM,OUTHEA
 MATCH:,BSS,
   E,VTM,MATEO
   J,VJM,READO
   E,VTM,MATEN
   J,VJM,READN
   J,VTM,MATCH
   E,VJM,COMP
    ,XTA,PC*O
    ,ATX,PBD*O
    ,XTA,PC*N
    ,ATX,PBD*N
    ,WTC,ML
 DIFF:,BSS,
   N,VTM,
   P,VTM,
  EF,VTM,-1
  OF,VTM,-1
 DIFLE:,BSS,
 :OF,VLM,*+1
  OF,VTM,-1
 DIFLP:,BSS,
   E,VTM,DIFEE
   J,VJM,READ
 :EF,VZM,*+1
  OF,J+M,P
 :OF,VLM,*+1
  OF,VTM,-1
  OF,XTA,PBD*
  OF,ATX,PN*
   P,MTJ,L
 DIFLL:,BSS,
   J,VJM,READ
   J,VTM,CHEML
   E,VJM,COMP
 DIFRT:,BSS,
   L,VLM,DIFLL
  EF,VZM,DIFLE
    ,UJ ,DIFLP
 CHEML:,BSS,
   N,VZM,OUTCOR
   N,UTM,-1
  :E,VTM,*+1
   J,VJM,READO
  :E,VTM,*+1
   J,VJM,READN
   J,VTM,CHEML
   E,VJM,COMP
    ,WTC,ML
   N,VTM,
    ,XTA,PED*O
    ,ATX,PN*O
    ,XTA,PED*N
    ,ATX,PN*N
   J,VJM,READO
   J,VTM,DIFRT
    ,UJ ,READN
 DIFEE:,BSS,
  EF,VLM,DIFLE
    ,XTA,PBD*N
    ,ATX,PN*N
   J,VTM,DIFF
 OUTCOR:,BSS,
   N,V1M,READN
    ,XTA,PBD*O
    ,ATX,PN*O
    ,XTA,PBD*N
    ,ATX,PN*N
    ,XTA,=6H* B  :
    ,ATX,COCA
   J,VJM,READO
   J,VJM,CCOUT
    ,XTA,PC*O
    ,ATX,PN*O
    ,AEX,PED*O
    ,UZA,OUTINS
   J,VTM,OUTDEL
 OUTDEL:,BSS,
    ,XTA,PN*O
    ,AEX,PED*O
    ,U1A,READO
    ,XTA,=6H* DA :
    ,ATX,COCA
   J,VJM,CCOUT
 OUTINS:,BSS,
    ,XTA,PN*N
    ,AEX,PED*N
    ,UZA,MATCH
   J,VJM,READN
   J,VTM,OUTINS
    ,UJ ,ICOUT
 MATEO:,BSS,
   E,VTM,FINAL
   J,VJM,READN
    ,XTA,=6H* IF .
    ,ATX,COCA
   E,VTM,
   J,VJM,CCOUT
 MATEI:,BSS,
   E,VTM,FINAL
   J,VJM,ICOUT
   J,VTM,MATEI
    ,UJ ,READN
 MATEN:,BSS,
    ,XTA,=6H* B  :
    ,ATX,COCA
   J,VJM,CCOUT
    ,XTA,=6H* DF .
    ,ATX,COCA
   E,VTM,
   J,VJM,CCOUT
 FINAL:,BSS,
    ,XTA,=6H*EE
    ,ATX,COCA
   E,VTM,
   J,VJM,CCOUT
   A,VTM,COCA
    ,XTA,=6H*READ
   A,ATX,
    ,XTA,=6HOLD
   A,ATX,1
   J,VJM,COUT
   M,VTM,-J
  :M,STI,J
   M,VLM,*
    ,UJ ,WRIEND
C-------------------------
 READ:,BSS,
  OF,MTJ,F
   F,XTA,PN*
   F,ATX,PED*
    ,UJ ,READC
 READO:,BSS,
    ,ATX,
    ,UTC,-1
 READN:,BSS,
   F,VTM,
   F,XTA,PN*
 READC:,BSS,
   F,ATX,PC*
    ,ATX,IPC
   F,XTA,PAD*
    ,ASN,64+24
    ,ATI,A
   I,VTM,-13
 REWOR:,BSS,
    ,XTA,IPC
    ,ASN,64+10
   F,AEX,NREC*
    ,UZA,SAMREC
   F,AEX,NREC*
   F,ATX,NREC*
   F,ARX,IU*
  S,ATX,1
  S,TAPE,1
 SAMREC:,BSS,
    ,XTA,IPC
    ,AAX,=1777
    ,ATI,M
    ,XTA,=1
    ,ARX,IPC
    ,ATX,IPC
   F,WTC,PAD*
   M,XTA,
   A,UTC,
   I,ATX,13
    ,AAX,=377
    ,AEX,=12
   :,UZA,*+1
   I,VLM,REWOR
   A,XTA,
    ,AEX,=6H*READ
   A,XTS,1
    ,AEX,=6HOLD
    ,ASN,64+16
   S,AOX,
    ,ASN,64+8
   E,UZA,
    ,XTS,IPC
   F,ATX,PN*
    ,ITA,A
    ,UJ ,COSYTISO
 COMP:,BSS,
    ,WTC,M80
   I,VTM,-13
   M,VTM,
 COML:,BSS,
   M,XTA,CARO
   M,AEX,CARN
   E,U1A,
   M,UTM,1
   I,VLM,COML
   J,UJ ,
 CCOUT:,BSS,
    ,XTA,=6H
   M,VTM,-12
  :M,ATX,COCA+13
   M,VLM,*
   A,VTM,COCA
   E,VZM,COUT
    ,XTA,NUM
   A,ATX,1
    ,AEX,=6H
    ,XTS,NUM+1
    ,AEX,=52.12->40
   A,ATX,2
    ,AEX,=6H
   S,AOX,
    ,U1A,COUT
    ,XTA,=24.72->56
   A,AEX,
   A,ATX,
   M,VTM,-11
   I,VTM,-10
 CCPAT:,BSS,
   M,XTA,CARO+11
   I,ATX,COCA+11
    ,AEX,=6H
    ,UZA,CCPAE
   I,VLM,CCPAE
    ,UJ ,COUT
 CCPAE:,BSS,
   M,VLM,CCPAT
    ,UJ ,COUT
 ICOUT:,BSS,
    ,XTA,W80
    ,UZA,IFOUT
    ,ATX,CARN+12
    ,ATX,CARN+13
 IFOUT:,BSS,
   A,VTM,CARN
   A,XTA,
    ,ASN,64+40
    ,AEX,=52.*
    ,U1A,COUT
   A,VTM,LINE
 COUT:,BSS,
    ,ITS,A
    ,WTC,NOLISFL*
   M,VTM,
   M,V1M,WRCARD
    ,ITS,J
    ,ITS,A
   A,UTM,13
    ,ITS,A
    ,XTS,=1
    ,CALL,PRINT8
    ,STI,J
    ,UJ ,WRCARD
C------------------------
 HEAD:,ISO,12H* R  :* W  :
 :,Z00,CARO
  ,Z00,PAGE
 PAD*:,Z00,CARN
  ,Z00,PAGE+1024
 :,010,NP
  ,   ,
 IP*:,010,NP+64
  ,   ,
 IU*O:,BSS,1
 IU*N:,BSS,
 IU* :,BSS,1
 PBD*O:,BSS,1
 PBD*N:,BSS,
 PBD* :,BSS,1
 PED*O:,BSS,1
 PED*N:,BSS,
 PED* :,BSS,1
 PC*O :,BSS,1
 PC*N :,BSS,
 PC*  :,BSS,1
 PN*O :,BSS,1
 PN*N :,BSS,
 PN*  :,BSS,1
      :,BSS,1
 NREC*:,BSS,1
 M80  :,BSS,1
 W80  :,BSS,1
 IUM  :,BSS,1
 ML   :,BSS,1
 IPC  :,OCT,
 COCA :,BSS,14
 LINE :,BSS,1
 CARN :,BSS,14
 CARO :,BSS,12
 NUM  :,BSS,2
       ,DATA,
 *L   :,ISO,6H* L  :
 1,SET,*L
 1,   ,LINE
  ,END,
 PUT PLO:,NAME,
C*
C*    SUBROUTINE OFFPLO
C*    - BЫKЛЮЧEHИE ПEЧATИ ПPИ ЗAГPYЗKE
C*
C*    SUBROUTINE PUTPLO
C*    - BOCCTAHOBЛEHИE PEЖИMA ПEЧATИ
C*    ПPИ ЗAГPYЗKE
C*
 LOADLIS*:,LC,1
 ,XTA,LOADLIS*
 ,UZA,*1
  OFF PLO:,ENTRY,
 ,UTC,=:4
 ,XTA,
 ,AOX,44B
 ,UJ,*2
 *1:,XTA,44B
 ,ASN,64-1
 ,ASN,64+1
 *2:,ATX,44B
 13,UJ,
 ,END,
 QIN:,NAME,
C
C**************** E.Д.ФEДЮHЬKИH 05/11/78
C*
C*   SUBROUTINE QIN(TEXT,L)
C*
C*   BBOДИT B MACCИB TEXT CTPOKY C ЭKPA-
C*   HA ДИCПЛEЯ. B L ЗACЫЛAETCЯ ЧИCЛO
C*   BBEДEHHЫX CИMBOЛOB. CTPOKA B MACCИ-
C*   BE TEXT ДOПOЛHЯETCЯ ПPOБEЛAMИ ДO
C*   ЦEЛOГO ЧИCЛA CЛOB.
C*
C*   OБPAЩEHИE CTAHДAPTHOE. ИCПOЛЬЗYЮT-
C*   CЯ БEЗ BOCCTAHOBЛEHИЯ PEГИCTPЫ 9-12
C*   И 14. PEЖИM HOPMAЛИЗAЦИИ И OKPYГЛE-
C*   HИЯ HE MEHЯETCЯ. HA BЫXOДE - ЛOГИ-
C*   ЧECKAЯ ГPYППA.
C*
C
 ,STI,12
 ,ATI,11
 ,XTA,
 15,ATX,23
 10,VTM,INF
 10,*71,
 :15,MTJ,14
 9,VTM,
 :14,XTA,
 ,UZA,FULL
 11,ATX,
 ,ASN,64+8
 ,YTA,
 14,UTM,1
 11,UTM,1
 9,UTM,6
 ,U1A,*-4
 11,XTA,-1
 9,UTM,-6
 14,VTM,
 :,ASN,64-8
 14,UTM,8
 9,UTM,1
 ,U1A,*-1
 10,XTA,1
 14,ASN,64
 11,AEX,-1
 11,ATX,-1
 FULL:,ITA,9
 10,AEX,2
 12,STX,
 13,UJ,
 INF:15,Z06,
 ,,
 :,ISO,6H
 ,OCT,64
 ,END,
 QKOORD:,NAME,.ДABЫДOB A.Л.
C*     TOЛЬKO  ДЛЯ   VDT 52100   *****
C*
C*   SUBROUTINE QKOORD(NCTP,NПOЗ)
C*
C*     YCTAHOBKA KYPCOPA  VDT 52100
C*  B CTPOKY NCTP, ПOЗИЦИЮ NПOЗ (HAЧИ-
C*  HAЯ C HYЛЯ).
C*
C*     ПOPTИT PEГИCTPЫ 8-14
C*************************************
 *11:,BLOCK,B,AP,RT,AS
 B,BASE,*
 ,STI,AP.N ПOЗ
 ,ATI,AS.N CTPOKИ
 AS,XTA,
 ,ATX,NS
 ,X-A,=I15
 ,U1A,GT15
 П:AP,XTA,
 ,ATX,NP
 ,X-A,=I79
 ,U1A,GT79
 S:,BSS,
 AS,VTM,-1
 L1:AS,XTA,NS+1
 ,ASN,64-8
 ,ACX,
 ,AAX,=1
 ,AEX,=1
 ,ASN,64-7
 AS,AOX,NS+1
 AS,ATX,NS+1
 AS,VLM,L1
 ,XTA,NS
 ,ASN,64-8
 ,AOX,NP
 ,ASN,64-16
 ,AOX,=6H'4''1'''''''''
 ,ATX,T
 ,*71,IW71
 ,STI,
 RT,UJ,
 GT15:,BSS,
 ,XTA,=I15
 ,ATX,NS
 ,UJ,П
 GT79:,BSS,
 ,XTA,=I79
 ,ATX,NP
 ,UJ,S
 IW71:,040,T
 ,,
 T:,BSS,
 NS:,BSS,1
 NP:,BSS,1
 ,END,
 QLINE:,NAME,
C
C***************** E.Д.ФEДЮHЬKИH 06/11/78
C*
C*   SUBROUTINE QLINE(TEXT,L,N)
C*
C*   BЫBOДИT HA ДИCПЛEЙ B CTPOKY ПPEДШEC-
C*   TBYЮЩYЮ TEKYЩEЙ, HAЧИHAЯ C ПOЗИЦИИ
C*   N, L CИMBOЛOB MACCИBA TEXT. CЧET ПO-
C*   ЗИЦИЙ HAЧИHAETCЯ C HYЛЯ.
C*
C*   OБPAЩEHИE CTAHДAPTHOE. ИCПOЛЬЗYET
C*   БEЗ BOCCTAHOBЛEHИЯ PEГИCTPЫ 9-12,14.
C*   PEЖИM HOPMAЛИЗAЦИИ И OKPYГЛEHИЯ HE
C*   MEHЯETCЯ. HA BЫXOДE - ЛOГИЧECKAЯ
C*   ГPYППA.
C*
C
 ,STI,9
 ,STI,14
 ,STI,12
 14,WTC,
 14,VTM,
 13,UTC,
 14,VZM,
 9,WTC,
 9,VTM,
 15,MTJ,11
 9,VZM,*+5
 ,UTC,INF
 ,XTS,2
 10,VTM,-5
 :9,UTM,-1
 9,VZM,*+4
 10,VLM,*-1
 15,ATX,
 10,VTM,-5
 ,UJ,*-2
 :,XTS,
 ,UJ,*+5
 :10,VZM,*-1
 10,J+M,10
 10,J+M,10
 10,J+M,10
 10,ASN,64+5
 15,ATX,
 ,ASN,64-5
 15,AEX,
 :,UTC,INF
 ,AEX,1
 :10,VTM,-5
 12,XTS,
 :14,UTM,-1
 14,VZM,*+2
 10,VLM,*-1
 12,VLM,*-2
 :14,VTM,INF
 10,VZM,*+4
 14,XTS,3
 10,J+M,10
 10,J+M,10
 10,J+M,10
 10,ASN,64+8
 15,AAX,
 :,XTS,
 15,ATX,
 11,MTJ,15
 14,*71,
 :11,XTA,
 13,UJ,
 INF:11,Z04,1
 ,,
 :,GOST,6H11111*
 ,ISO,6H
 ,OCT,77777777777774
 ,END,
 QMOVE:,NAME,
C
C**************** E.Д.ФEДЮHЬKИH 06/11/78
C*
C*   SUBROUTINE QMOVE(N)
C*
C*   CДBИГAET CTPOKY ДИCПЛEЯ, ПPEДШECT-
C*   BYЮЩYЮ TEKYЩEЙ BПPABO(+) ИЛИ BЛEBO
C*   (-) HA N ПOЗИЦИЙ.
C*
C*   OБPAЩEHИE CTAHДAPTHOE. ИCПOЛЬЗYЮTCЯ
C*   БEЗ BOCCTAHOBЛEHИЯ 10-12 И 14 PE-
C*   ГИCTPЫ.
C*   PEЖИM HA BXOДE - HECYЩECTBEHEH,
C*   PEЖИM HA BЫXOДE = 6.
C*
C
 ,STI,12
 12,WTC,
 14,VTM,
 13,UTC,
 14,VZM,
 12,XTS,
 11,VTM,INF+2
 ,NTR,23B
 ,UZA,*+2
 12,AVX,
 11,UTM,1
 ,ATI,14
 :11,XTA,
 15,ATX,1
 15,MTJ,12
 ,ASN,64+8
 11,VTM,INF
 11,AEX,1
 10,VTM,-4
 ,NTR,6
 :14,UTM,-1
 14,VZM,CONT
 10,VLM,*-1
 12,ATX,
 12,XTA,1
 ,UJ,*+3
 :14,UTM,-1
 14,VZM,CONT
 10,VLM,*-1
 12,ATX,
 :10,VTM,-5
 12,VLM,*-2
 CONT:10,VZM,*+4
 12,ATX,
 10,J+M,10
 10,J+M,10
 10,J+M,10
 15,XTA,1
 10,ASN,64+48
 12,AEX,
 :12,ATX,
 ,XTA,
 12,ATX,1
 11,*71,
 :15,XTA,
 13,UJ,
 INF:15,Z04,
 ,,
 ,GOST,6H*00000
 ,GOST,6H'34''34''34''34''34''34'
 ,GOST,6H'35''35''35''35''35''35'
 ,END,
 QN:,NAME,
C
C********* A.П.CAПOЖHИKOB, E.Д.ФEДЮHЬKИH
C*         15/04/79, ДYБHA, JINR.
C*
C*   SUBROUTINE QN(CARD,SERV)
C*
C*   HYMEPYET KAPTЫ, ИCПOЛЬЗYЯ B KAЧEC-
C*   TBE HAЧAЛЬHOГO HOMEPA ИMЯ ФOPTPAH-
C*   HOЙ ИЛИ ABTOKOДHOЙ ПPOГPAMMЫ. CAMA
C*   PACПOЗHAET HAЧAЛO И KOHEЦ ПPOГPAM-
C*   MЫ. ПPOГPAMM MOЖET БЫTЬ MHOГO. KAP-
C*   TЫ, KOTOPЫE HAXOДЯTCЯ MEЖДY ПPOГ-
C*   PAMMAMИ HYMEPYЮTCЯ OTДEЛЬHO, B KA-
C*   ЧECTBE HAЧAЛЬHOГO HOMEPA ИCПOЛЬЗY-
C*   ETCЯ COДEPЖИMOE 73-80 ПOЗИЦИИ ПEP-
C*   BOЙ TAKOЙ KAPTЫ. HOMEP ПOMEЩAETCЯ
C*   B 73-80 ПOЗИЦИЮ KAPTЫ. ECЛИ ПPИ
C*   ЭTOM B 80 ПOЗИЦИИ ПEPBOЙ KAPTЫ
C*   ПPOГPAMMЫ OKAЖETCЯ ПPOБEЛ ИЛИ ЦИФ-
C*   PA, OHИ ЗAMEHЯЮTCЯ CИMBOЛOM 0.
C*   TO ЖE CAMOE CПPABEДЛИBO ДЛЯ ПEPBOЙ
C*   BHEПPOГPAMMHOЙ KAPTЫ. YПPABЛЯЮЩИE
C*   KAPTЫ (CO ЗBEЗДOЧKOЙ B ПEPBOЙ ПO-
C*   ЗИЦИИ) HE HYMEPYЮTCЯ.
C*
C*   QN ПPEДHAЗHAЧEHA ДЛЯ ИCПOЛЬЗO-
C*   BAHИЯ B PEДAKTOPE B KAЧECTBE
C*   USER'A.
C*
C*   CARD - MACCИB ИЗ 14 CЛOB - OБPAЗ 80
C*   -KOЛOHHOЙ KAPTЫ B KOДE ISO.
C*   SERV - ПPOЦEДYPA CTAHДAPTHOГO CEP-
C*   BИCA, K KOTOPOЙ QN OБPAЩAETCЯ C HY-
C*   MEPOBAHHOЙ KAPTOЙ: CALL SERV(CARD).
C*
C*   BЫЗЫBAЮЩAЯ ПPOГPAMMA ПOCЛEДOBATEЛЬ-
C*   HO OБPAЩAETCЯ K QN C KAЖДOЙ KAPTOЙ.
C*
C*   ECЛИ AДPEC SERV ИЛИ EГO COДEPЖИMOE=
C*   0B, OБPAЩEHИЯ K SERV HE ПPOИCXOДИT,
C*   HYMEPOBAHHAЯ KAPTA OCTAETCЯ B MAC-
C*   CИBE CARD.
C*
C*   ECЛИ AДPEC CARD ИЛИ EГO COДEPЖИMOE=
C*   0B, PAБOЧИЙ MACCИB QN ЗAHYЛЯETCЯ,
C*   QN ПEPEXOДИT B HAЧAЛЬHOE COCTOЯHИE.
C*
C
 CHKBEG*:,SUBP,
 CHKEND*:,SUBP,
 NAME*:,LC,2
 ,STI,11
 ,ATI,12
 12,XTA,
 14,VTM,BAS
 ,UZA,ZERO
 14,AEX,10
 14,AAX,11
 ,UZA,CONT1
 ,ITA,13
 ,ITS,12
 ,ITS,11
 13,VTM,RET
 13,XTS,FLAG-RET
 14,VTM,CHKBEG*
 ,UZA,*+1
 14,VTM,CHKEND*
 :,ITA,12
 14,UJ,
 RET:,STI,11
 ,STI,12
 ,ATI,13
 8,VTM,FLAG
 8,XTA,
 10,VTM,BAS
 ,UZA,NAM
 ,XTA,
 14,VZM,*+1
 8,ATX,
 NUM:8,XTA,3
 10,ARX,7
 10,AAX,8
 15,ATX,
 10,AAX,9
 ,ASN,64+3
 15,ARX,
 10,AAX,8
 8,ATX,3
 8,AAX,4
 ,UZA,CONT
 8,XTA,4
 ,ASN,64-8
 8,ATX,4
 10,AEX,4
 ,ASN,64+16
 15,ATX,
 ,YTA,
 8,XTS,2
 10,AEX,3
 15,AAX,
 8,AEX,2
 8,ATX,2
 8,XTA,1
 10,AEX,3
 15,AAX,
 8,AEX,1
 8,ATX,1
 CONT:8,XTA,3
 ,ASN,64+16
 15,ATX,
 ,YTA,
 8,AEX,2
 12,STX,13
 8,AEX,1
 12,ATX,12
 CONT1:11,XTA,
 ,UZA,OUT0
 ,ITA,12
 11,UJ,
 :8,XTA,5
 8,UTM,4
 ,U1A,NUM
 12,XTA,12
 8,ATX,1
 12,XTA,13
 10,AEX,3
 ,UJ,NAM1
 NAM:14,VZM,*-4
 8,ATX,3
 9,VTM,NAME*
 9,XTA,
 8,ATX,
 8,ATX,1
 12,ATX,12
 9,XTA,1
 15,ATX,
 12,AEX,13
 10,AAX,1
 15,AEX,
 12,ATX,13
 10,AEX,3
 NAM1:10,AAX,5
 12,AEX,13
 8,ATX,2
 10,XTA,2
 8,ATX,4
 12,XTA,13
 10,AEX,6
 10,AAX,5
 :,U1A,*+3
 8,XTA,2
 12,ATX,13
 11,V1M,CONT1
 OUT0:15,XTA,
 13,UJ,
 :10,AEX,6
 10,ARX,12
 ,UZA,CONT1
 10,ARX,13
 ,U1A,CONT1
 ,UJ,OUT0-2
 ZERO:14,VTM,FLAG
 12,VTM,-8
 :14,ATX,
 14,UTM,1
 12,VLM,*-1
 ,UJ,OUT0
 BAS:,OCT,000004
 1,LOG,37777777777
 2,OCT,77777777777774
 3,ISO,6H000000
 4,OCT,7777777777777777
 5,OCT,001774
 6,OCT,0002
 7,ISO,6H'366''366''366''366''366''367'
 8,ISO,6H'177''177''177''177''177''177'
 9,ISO,6H'120''120''120''120''120''120'
 10,ISO,6H*
 11,OCT,776
 12,OCT,37743
 13,OCT,000044
 FLAG:,BSS,9
 ,END,
 QOUT:,NAME,
C
C**************** E.Д.ФEДЮHЬKИH 05/11/78
C*
C*   SUBROUTINE QOUT(TEXT,L)
C*
C*   BЫBOДИT HA ДИCПЛEЙ L CИMBOЛOB MAC-
C*   CИBA TEXT. XBOCTOBЫE ПPOБEЛЫ ИГHO-
C*   PИPYЮTCЯ.
C*
C*   OБPAЩEHИE CTAHДAPTHOE. ИCПOЛЬЗYЮT-
C*   CЯ БEЗ BOCCTAHOBЛEHИЯ 10-12 И 14
C*   PEГИCTPЫ. PEЖИM HOPMAЛИЗAЦИИ И
C*   OKPYГЛEHИЯ HE MEHЯETCЯ. HA BЫXOДE
C*   - ЛOГИЧECKAЯ ГPYППA.
C*
C
 ,STI,14
 ,ATI,12
 14,WTC,
 14,VTM,
 15,MTJ,11
 14,VZM,OUT
 :10,VTM,-5
 12,XTS,
 :14,UTM,-1
 14,VZM,*+2
 10,VLM,*-1
 12,VLM,*-2
 :14,VTM,INF
 14,AEX,2
 10,VZM,*+5
 14,XTS,1
 10,J+M,10
 10,J+M,10
 10,J+M,10
 10,ASN,65
 15,AAX,
 ,UJ,*+2
 :14,XTA,2
 15,AEX,
 :,UZA,*-1
 15,ATX,
 14,ARX,1
 15,AEX,-1
 ,ASN,64+3
 14,AAX,2
 14,AEX,2
 15,AEX,
 OUT:,XTS,
 15,ATX,
 11,MTJ,15
 14,*71,
 :15,XTA,
 13,UJ,
 INF:11,Z04,1
 ,,
 :,OCT,7777777777777776
 ,ISO,6H
 ,END,
 QOUTLT:,NAME,
C*
C*    -- ИCAEBA M.X. --  ЯHBAPЬ 1984 --
C*    ЗAГPYЗKA PAЗДEЛA (TИПA BLOCK DATA)
C*    И BЫBOД EГO COДEPЖИMOГO HA TEPMИHAЛ
C*    CTPOKAMИ ПO 63 CИMBOЛA.
C*    ПPИЗHAK KOHЦA BЫBOДA - HYЛEBOE CЛOBO.
C*      OБPAЩEHИE:
C*      CALL QOUTLT (ИMЯ)
C*    (ИMЯ - ИMЯ PAЗДEЛA, ДO 8 CИMBOЛOB)
C*
 A/I0:,LC,1
 ,ATI,14
 ,ITA,13
 ,ITS,14
 ,CALL,LOAD
 ,AEX,A/I0
 ,UZA,END1
 LOOP:,BSS,
 ,UTC,ADR
 ,ATX,
 14,VTM,=I63
 ,ITS,14
 ,CALL,QOUT
 ,WTC,ADR
 14,VTM,11
 14,XTS,
 ,UZA,END
 ,ITA,14
 ,UJ,LOOP
 END:14,VTM,A/I0
 ,ITA,14
 ,CALL,LOAD
 END1:,STI,
 ,STI,13
 ,NTR,6
 13,UJ,
 ADR:,BSS,1
 ,END,
 QSTR:,NAME,
C
C**************** E.Д.ФEДЮHЬKИH 07/11/78
C*
C*   SUBROUTINE QSTR(TEXT,L)
C*
C*   BЫBOДИT HA ДИCПЛEЙ C HAЧAЛA CTPOKИ,
C*   ПPEДШECTBYЮЩEЙ TEKYЩEЙ, L CИMBOЛOB
C*   MACCИBA TEXT. ПPEЖHEE COДEPЖИMOE
C*   CTPOKИ CДBИГAETCЯ BПPABO HA L+1
C*   ПOЗИЦИЮ.
C*
C*   OБPAЩEHИE CTAHДAPTHOE. ИCПOЛЬЗY-
C*   ЮTCЯ БEЗ BOCCTAHOBЛEHИЯ 9-12 И
C*   14 PEГИCTPЫ. PEЖИM OKPYГЛEHИЯ И
C*   HOPMAЛИЗAЦИИ HE MEHЯETCЯ. HA
C*   BЫXOДE - ЛOГИЧECKAЯ ГPYППA.
C*
C
 ,STI,14
 ,STI,12
 14,WTC,
 14,VTM,
 13,UTC,
 14,VZM,
 9,VTM,INF
 9,XTS,1
 15,MTJ,11
 12,XTS,
 10,VTM,-1
 ,UJ,*+4
 CONT:15,AEX,
 ,ASN,64-16
 :9,XTS,3
 ,U1A,*+2
 12,XTA,1
 12,UTM,1
 :,ASN,64-8
 9,ATX,3
 ,YTA,
 ,ASN,64-8
 9,AEX,2
 14,UTM,-1
 14,VZM,CONT1
 10,VLM,CONT
 15,AEX,
 ,XTS,
 10,VTM,-2
 ,UJ,CONT+1
 CONT1:15,AEX,
 10,VZM,*+3
 ,ASN,64-16
 10,UTM,1
 10,VZM,*+1
 ,ASN,64-16
 :,XTS,
 15,ATX,
 11,MTJ,15
 9,*71,
 15,XTA,
 13,UJ,
 INF:11,Z04,
 ,,
 ,GOST,6H00*'34'00
 ,LOG,34
 ,BSS,1
 ,END,
 QTER:,NAME,
C
C**************** E.Д.ФEДЮHЬKИH 17/01/79
C*
C*   SUBROUTINE QTER(H,NH,TEXT,L)
C*
C*   BBOД ИHФOPMAЦИИ C ЭKPAHA ДИCПЛEЯ C
C*   ПOДCKAЗKOЙ. ПOДCKAЗKA H COДEPЖИT NH
C*   CИMBOЛOB. ИHФOPMAЦИЯ (BMECTE C ПOД-
C*   CKAЗKOЙ) BBOДИTCЯ B MACCИB TEXT. B
C*   L ЗACЫЛAETCЯ ЧИCЛO BBEДEHHЫX CИMBO-
C*   ЛOB. CTPOKA B MACCИBE TEXT ДOПOЛHЯ-
C*   ETCЯ ПPOБEЛAMИ ДO ЦEЛOГO ЧИCЛA CЛOB
C*
C*   OБPAЩEHИE CTAHДAPTHOE. ИCПOЛЬЗYЮTCЯ
C*   БEЗ BOCCTAHOBЛEHИЯ 8-12 И 14 PEГИC-
C*   TPЫ. PEЖИM HOPMAЛИЗAЦИИ И OKPYГЛE-
C*   HИЯ HE MEHЯETCЯ. HA BЫXOДE - ЛOГИ-
C*   ЧECKAЯ ГPYППA.
C*
C*   SUBROUTINE QCIA(H,NH,TEXT,L)
C*
C*   BBOД ИHФOPMAЦИИ C ПOДCKAЗKOЙ И ЗA-
C*   CEKPEЧИBAHИEM. B OCTAЛЬHOM AHAЛO-
C*   ГИЧHA QTER.
C*
C
 8,VTM,C32
 ,STI,11
 PER:,STI,12
 ,STI,14
 ,ATI,10
 14,WTC,
 14,VTM,
 ,ITA,13
 15,MTJ,9
 14,VZM,ZERO
 :10,XTS,
 13,VTM,-5
 :14,UTM,-1
 14,VZM,*+2
 13,VLM,*-1
 10,VLM,*-2
 :10,VTM,INF
 13,VZM,FULL
 10,XTS,1
 13,J+M,13
 13,J+M,13
 13,J+M,13
 13,ASN,64+8
 15,AAX,
 8,XTS,
 13,ASN,64
 15,ATX,
 ,YTA,
 15,UTM,-1
 15,AEX,
 15,ATX,
 10,*71,
 :9,MTJ,15
 8,VTM,
 E1:9,WTC,
 13,VTM,
 :,ITA,
 15,ATX,24
 :9,XTA,1
 ,UZA,FULL1
 12,ATX,
 ,ASN,64+8
 ,YTA,
 9,UTM,1
 12,UTM,1
 8,UTM,6
 ,U1A,*-4
 12,XTA,-1
 8,UTM,-6
 14,VTM,
 :,ASN,64-8
 14,UTM,8
 8,UTM,1
 ,U1A,*-1
 10,XTA,3
 14,ASN,64
 12,AEX,-1
 12,ATX,-1
 FULL1:,ITA,8
 10,AEX,4
 11,STX,
 13,UJ,
 ZERO:10,VTM,INF
 10,XTS,3
 12,ATX,
 10,XTA,5
 FULL:8,XTS,
 15,ATX,
 9,MTJ,15
 10,*71,
 :8,VTM,
 13,VZM,E1
 9,XTA,1
 10,AEX,5
 ,U1A,E1+1
 9,VLM,E1+1
 QCIA:,ENTRY,
 ,STI,11
 8,VJM,PER
  :,GOST,6H,(0000
 INF:,OCT,44500001
 ,OCT,77777777777774
  C32:,GOST,6H(00000
 ,ISO,6H
 ,OCT,64
 ,GOST,6HD11118
 ,END,
 RDSTAR:,NAME,
 WBEGFLAG:,LC,2
 WORDADR:,EQU,WBEGFLAG+1
 DRTAPE:,LC,1
 BUFFER:,PP,1024
  ,ITS,7
 7,BASE,*
     ,ATX,L
    8,VTM,WBEGFLAG
    8,XTA,
     ,UZA,READWORD
   ,ITA,
    8,ATX,
     ,UTC,DRTAPE
     ,XTA,
     ,AEX,DRTFLG
     ,UZA,BEG
     ,AEX,DRTFLG
     ,ATX,DRTFLG
     ,ASN,64-46
   ,ARX,
     ,UZA,TAPE
     ,XTA,
     ,ATX,DELTA
     ,XTA,MUNPDR
 GODR:,ATX,MUNP
   14,VTM,BUFFER
     ,ITA,14
     ,ATX,ABUF
     ,UJ,BEG
 TAPE:,ASN,64-1
 ,U1A,PLIB
 ,XTA,DCTP
 T:,ATX,DELTA
     ,XTA,MUNPTP
     ,UJ,GODR
 PLIB:,XTA,DELTATP
 ,UJ,T
 BEG:8,WTC,1
     ,XTA,1
   ,AAX,MESD
     ,AEX,LIBCODE
     ,UZA,RETLIBR
     ,AEX,LIBCODE
   12,VJM,LIBR
 RETLIBR:8,WTC,1
     ,XTA,1
     ,AAX,MSEC
     ,ASN,64+36
 NEWZON:,ARX,ABUF
     ,ATX,ADRWORD
 READWORD:,XTA,ADRWORD
     ,AEX,ABUF
   ,UZA,EXIT
     ,AAX,=1777
     ,UZA,READ1
 EXIT:,XTA,ADRWORD
     ,ARX,=1
     ,ATX,ADRWORD
     ,WTC,ADRWORD
     ,XTA,-1
     ,XTS,L
     ,STI,7
   13,UJ,
   READ1:,XTA,LIBCODE
     ,ARX, = 1 00000 00000
   12,VJM,LIBR
     ,XTA,
     ,UJ,NEWZON
 LIBR:,ATX,LIBCODE
     ,AUX,MUNP
     ,AOX,CRED
     ,ARX,DELTA
     ,XTS,ABUF
     ,ASN,64-20
   15,AOX,
   ,ATX,AEX
   ,*70,AEX
   12,UJ,
    L:,OCT,
 LIBCODE:,OCT,
 MUNP:,OCT,
   MUNPDR:,LOG,7 7400 0077 0037
 MSEC:,OCT,174
 MESD:,OCT,0037 77
 CRED:,OCT,001
 AEX:,OCT,
 ABUF:,OCT,
 ADRWORD:,OCT,
 DELTATP:,LOG,65 7740
 DCTP:,LOG,637740
 DELTA:,OCT,
 MUNPTP:,LOG,777 0777
   DRT FLG:,OCT,
     ,END,
 READCG:,NAME,
  *P*:,PC,2048
  *CAT*:,EQU,*P*
 *NZ1*:,LC,1
 *FL*:,LC,1
 11,BASE,*
 ,ITA,13
 ,ATX,I13
 14,VTM,*P*+1762B.
 14,XTA,.
 ,AEX,=6HOVERLA
  13,VTM,12
 ,UIA,NOOV.
 14,XTA,1.
 ,AEX,=4HY OT
 ,UIA,NOOV.
 ,XTA,=I2
 ,UTC,*FL*
 ,ATX,
 ,UJ,PRINT.
 NOOV:,UTC,*P*.
 ,XTA,1400B.
 ,AEX,MONAM
 ,UIA,NO SYS.
 ,XTA,=I3
 ,UTC,*FL*.
 ,ATX,.
 14,VTM,*P*+1776B.
 ,UJ,PRINT.
 NO SYS:,BSS,.
 12,VTM,*CAT*-2
 12,XTA,2
 ,AAX,=2000000
 ,UZA,KAPUT
 12,XTA,2
 ,AAX,=70 0000
 ,UZA,KAPUT
 12,XTA,2
 ,AAX,=7777 7777 7000 0037
 ,U1A,KAPUT
 12,XTA,3
 ,U1A,KAPUT
  14,VTM,END
  ,CALL,GIVEME
  ,ARX,=:0000 0100
  ,ATX,WRW
  ,ATX,FL
  ,*70,WRW
 COUNT:12,XTA,2
 12,UTM,2
 12,MTJ,14
 14,UTM,-2048-*CAT*
 14,VZM,KAPUT
 ,UZA,*CON
 ,UJ,COUNT
 *CON:,BSS,
 12,XTA,1
 ,AEX,=7777 7777 7777 7777
 ,U1A,KAPUT
 12,MTJ,14
 14,UTM,2
 14,XTA,
 ,AEX,TE
  13,VTM,2
  ,U1A,OBSP
 14,XTA,1
 ,AEX,TE+1
  ,U1A,OBSP
  13,VTM,12
 ,XTA,=6400 0000 0000 0001
 ,UTC,*FL*
 ,ATX,
 PRINT:,ITS,14
  13,J+M,14
 ,ITS,14
  ,XTS,=32
 ,CALL,PRINT8
 END:,BSS,
  KAPUT:,BSS,
  ,XTA,FL
  ,UZA,RET
  ,XTA,
  ,ATX,FL
  14,VTM,1-1024
  13,VTM,*CAT*
  12,VTM,*CAT*+1024
  COPY:,BSS,
   14,UTC,
  12,XTA,1023
  14,UTC,
  13,ATX,1023
   14,VLM,COPY
  RET:,BSS,
 ,XTA,I13
 ,ATI,13
 13,UJ,
  OBSP:14,XTA,
  14,VTM,TOBSP
  14,ATX,1
  ,UJ,PRINT
  TOBSP:,ISO,12HOБCП: 080680
 MONAM:,TEXT,8HMONITOR*.
  FL:,OCT,
 TE:,ISO,12HLIBRARY OT
 WRW:,BSS,1
 I13:,BSS,1
 ,END,READCG
  READER:,NAME,
C*
C******  13.1.80.  A.П.CAПOЖHИKOB.
C*
C*   SUBROUTINE READER(CARD)
C*
C*   ЧTEHИE TEKCTOBOЙ 80-KOЛOHHOЙ KAPTЫ
C*   B MACCИB ЮЗEPA  CARD  ДЛИHOЙ 14 CЛOB.
C*   ДOБABЛEHИE CИMBOЛA '012' B KOHEЦ KAPTЫ
C*
C*   SUBROUTINE RCINIT(LAB)
C*
C*   AKTИBИЗAЦИЯ READER-A.
C*   LAB ЗAДAET ФAЙЛ ЧTEHИЯ :
C*   'CARD'    - ЧTEHИE C ПEPФOKAPT
C*   'TERM'    - BBOД C TEPMИHAЛA
C*   670000B   - ЧTEHИE C MЛ 67
C*   ИЛИ '670000'
C*   'SYSTEM'  - ЧTEHИE ИЗ MONCARD/
C*
C*   ECЛИ AKTИBИЗAЦИИ HE БЫЛO,
C*   READER ЧИTAET C ПEPФOKAPT.
C*
C*   SUBROUTINE LFDEL(CARD)
C*
C*   ЗAMEHA B  CARD  CИMBOЛA 'LINE FEED'
C*   HA ПPOБEЛ.
C*
C*
C*   SUBROUTINE SAVRCF(KOOR)
C*   SUBROUTINE RESRCF(KOOR)
C*
C*   CПACEHИE (BOCCTAHOBЛEHИE) TEKYЩИX
C*   KOOPДИHAT ПO ФAЙЛY ЧTEHИЯ B (ИЗ)
C*   MACCИB ЮЗEPA KOOR  ДЛИHOЙ 2 CЛOBA.
C*
  RECARD:,SUBP,
  RBEGIN:,SUBP,
  READ* :,SUBP,
  TERIN :,SUBP,
  XREAD/:,LC,2
  MONCARD/:,LC,14
C---
  B:,ATI,14
  12,VTM,-13
  ,UTC,=6H
  ,XTS,
  CL:12,UTC,13
  14,ATX,
  12,VLM,CL
  ,ITA,13
  ,ITS,14
  13,VTM,C
  ,WTC,UNIT
  ,UJ,RC
  RC:,UJ,RECARD.MЛ
  :,UJ,READ*.П/K
  :,XTS,
  ,UJ,TERIN.TEPM
  :11,VTM,-13
  13,VTM,MONCARD/
  MC:13,XTA,
  14,ATX,
  14,UTM,1
  13,UTM,1
  11,VLM,MC
  ,XTA,
  ,UTC,UNIT
  ,STX,
  C:,STI,13
  ,ATI,14
  11,BASE,B
  14,XTA,13
  ,AAX,=6H'377''377'''''''''
  ,AOX,=6H''''
  14,ATX,13
  12,VTM,14
  *1:12,UTM,-1
  14,UTC,
  12,XTA,
  ,AEX,=6H
  ,U1A,*2
  12,VIM,*1
  *2:,ASN,64-40
  12,J+M,14
  ,UZA,*3
  14,UTM,1
  *3:14,XTA,
  ,AEX,=6H
  ,ARX,=7777 7777 7777 7776
  ,AAX,=6H'200''200''200''200''200''200'
  ,ASN,64+2
  15,ATX,
  ,ASN,64+2
  15,AOX,
  15,ATX,
  ,ASN,64+2
  15,AOX,
  14,AEX,
  14,STX,
  13,UJ,
C---
  LFDEL:,ENTRY,
  ,STI,14
  12,VTM,-13
  LFD:14,XTS,
  11,BASE,B
  ,AEX,=6H'012''012''012''012''012''012'
  ,ARX,=6H'177''177''177''177''177''177'
  ,AAX,=6H'200''200''200''200''200''200'
  ,AEX,=6H'200''200''200''200''200''200'
  ,ASN,64+2
  15,ATX,
  ,ASN,64+2
  15,ATX,
  ,ASN,64+2
  15,AOX,
  15,AOX,
  14,AEX,
  14,STX,
  14,UTM,1
  12,VLM,LFD
  13,UJ,
C---
  RCINIT:,ENTRY,
  ,ATI,14
  12,VTM,3
  CH:14,XTA,
  ,UTC,YK
  12,AEX,-1
  ,UZA,ECH
  12,UTM,-1
  12,VIM,CH
  ECH:,ITA,12
  ,UTC,UNIT
  ,STX,
  13,UTC,
  12,VIM,
  11,BASE,B
  14,XTS,
  ,ASN,64+18
  ,UZA,ECH1
  14,XTA,
  ,APX,=6H'7''7''7''7''7''7'
  ,ASN,64+30
  14,VTM,N
  14,ATX,
  ECH1:,ITA,14
  ,UJ,RBEGIN
C---
  SAVRCF:,ENTRY,
  ,ATI,12
  11,VTM,XREAD/
  CHANG:11,XTA,
  12,ATX,
  11,XTA,1
  12,STX,1
  13,UJ,
  RESRCF:,ENTRY,
  ,ATI,11
  11,*70,1
  12,VTM,XREAD/
  ,UJ,CHANG
C---
  YK:,ISO,18HCARD  TERM  SYSTEM
  UNIT:,LOG,1
  N:,BSS,1
  ,END,
 READPL:,NAME,.(A,KW)
C*               11.10.84    И.P.PЫБAKOB
C*  SUBROUTINE READPL(A,KW)
C*  BBOД ПEPФOЛEHTЫ B PEЖИME 'BBOД MACCИBA'
C*   A - MACCИB ДЛЯ PAЗMEЩEHИЯ BBEДEHHOЙ
C*       ИHФOPMAЦИИ (ПO 6 CИMB.ПЛ B CЛOBO
C*       CЛEBA HAПPABO),
C*   KW- PEЗYЛЬTAT - KOЛИЧECTBO CЛOB,
C*       ЗAHЯTЫX BBEДEHHOЙ ИHФOPMAЦИEЙ.
C*  B HAЧAЛE БYДET CKOЛЬKO-TO ЛИШHИX HYЛEЙ
C*  (ЗABИCИT OT YCTAHOBKИ ПEPФOЛEHTЫ).
C*  MACCИB 'A' ДOЛЖEH БЫTЬ ДOCTATOЧHЫM ДЛЯ
C*  PAЗMEЩEHИЯ BCEЙ ИHФOPMAЦИИ C ПЛ
C*  (HAПPИMEP, 1024 CЛOBA XBATИT HA
C*  6144 CИMBOЛA ИЛИ ПPИMEPHO 15 M ПЛ).
C*     ПЛ BBOДИTCЯ ДO KOHЦA (ДИAГHOCTИKA
C*  'OБPЫB ПЛ'), ПOCЛE ЧEГO OПEPATOP ЭBM
C*  ДOЛЖEH HAБPATЬ ПPИKAЗ 'KПЛ'.
C*     BBEДEHHЫE CИMBOЛЫ MOЖHO BЫБИPATЬ ИЗ
C*  A ДЛЯ ИCПOЛЬЗOBAHИЯ,HAПPИMEP, C ПOMOЩЬЮ
C*  INT.ФYHKЦИИ  IGETS(A,N)  ИЗ LIBRARY-23,
C*  N-ПOPЯДKOBЫЙ HOMEP CИMBOЛA: 0,1,2,...
C*  CЛEBA HAПPABO.
C*-----------------------------------------
 BEG:,STI,10.ADR KW
 ,ATI,9.ADR A
 :9,*60,
 ,,1
 8,BASE,BEG
 ,ASN,64+15
 ,AAX,=77777
 ,AOX,I0
 10,STX,.KW
 13,UJ,
 I0:,INT,0
 ,END,
 REQTP:,NAME,
C
C******************** ПOПOB M.Ю. 11/12/79
C*
C*   ИHTEPФEЙC ДЛЯ FORTRAN ПO ЗAKAЗY И
C*   OTKAЗY OT ЛEHTOЧHЫX И ДИCKOBЫX PE-
C*   CYPCOB B OC 'ДYБHA'.
C*
C*   CALL REQTP(IDENT,MN,IWR)-ЗAKAЗ ЛEHTЫ
C*
C*   CALL REQSTP(MN,IWR)-ЗAKAЗ PAБ. ЛEHTЫ
C*
C*   CALL REQFL(IDENT,MASTER,NFL,MN,IRW)-
C*   ЗAKAЗ ДИCKOBOГO ФAЙЛA
C*
C*   CALL REQSFL(IFL,MN,IWR)-ЗAKAЗ PAБ.
C*   ФAЙЛA, T.E. SCRATCH FILE
C*
C*   CALL REQDEL(IDELTA) - AHAЛOГ *TAPES:
C*
C*   ГДE:
C*   IDENT - TEKCTOBAЯ KOHCTAHTA ИЗ ДBYX
C*    CЛOB,HAПPИMEP- 12H1234/ЛEHTA ,ГДE:
C*    1234- HOMEP БOБИHЫ ИЛИ ПAKETA
C*    ЛEHTA - ИMЯ БOБИHЫ ИЛИ ПAKETA
C*    / - PEЗДEЛИTEЛЬ MEЖДY HOM. И ИMEHEM
C*
C*   MN - MAT. HOMEP (30B-67B) ИЛИ FORT-
C*   RAN HOMEP(1-15) YCTPOЙCTBA
C*
C*   IWR - TEKCTOBAЯ KOHCTAHTA, ECЛИ
C*   IRW=1HR TO TPEБYETCЯ TOЛЬKO ЧTEHИE
C*   IRW=1HW TO TPEБYETCЯ TOЛЬKO ЗAПИCЬ
C*   IRW=2H L - TPEБYETCЯ 200BPI
C*   IRW=2H H - TPEБYETCЯ 800BPI
C*   ДOПYCTИMЫE KOMБИHAЦИИ:
C*   RL  RH  R
C*   WL  WH  W
C*    L   H
C*   ДPYГИE KOMБИHAЦИИ ИГHOPИPYЮTCЯ.
C*
C*   MASTER - TEKCTOBAЯ KOHCTAHTA ,ИMEET
C*   TOTЖE CMЫCЛ,ЧTO И B KAPTE *DISC:
C*
C*   NFL - TEKCTOBAЯ KOHCTAHTA , ИMEET
C*   TOTЖE CMЫCЛ ,ЧTO И B KAPTE *FILE:
C*
C*   IFL - ДЛИHA ЗAKAЗЫBAEMOЙ SCRATCH
C*   OБЛACTИ.
C*
C*   IDELTA - 18 PAЗPЯДHAЯ BOCЬMEPИЧHAЯ KOHC-
C*   TAHTA BИДA  XXYYYYB
C*   XX- MAT.HOMEP , YYYY - CMEШEHИE
C*
C*   OБPAЩEHИE CTAHДAPTHOE,ПOPTИT БEЗ
C*   BOCCTAHOBЛEHИЯ 14,12,11 ИP
C*   BЫЗЫBAET REQUEST,ISOTEX
C*
C*   ПPИMEЧAHИE: TИПЫ ПEPПMEHHЫX B OПИ-
C*    CAHИИ COOTBETCTBYЮT CTAHДAPTY ЯЗЫKA
C*    FORTRAN  ANSI X3-6-78
C*
 REQUEST:,SUBP,
 ISOTEX:,SUBP,
 CCC:11,BAS,CCC
 ,ITS,13
 11,VTM,CCC
 ,ATX,R13
 ,XTA,
 ,STX,TYPE
 13,VJM,SETWRMN
 15,XTA,
 13,VJM,IDENT
 RETUS1:,XTA,R13
 ,ATI,13
 14,VTM,ZZZZZFDB
 ,ITA,14
 ,UJ,REQUEST
 REQSTP:,ENTRY,
 ,ITS,13
 11,VTM,CCC
 ,ATX,R13
 ,XTA,
 ,ATX,ID
 ,XTA,=10000
 ,STX,TYPE
 13,VTM,RETUS1
 ,UJ,SETWRMN
 REQFL:,ENTRY,
 ,ITS,13
 11,VTM,CCC
 ,ATX,R13
 ,XTA,=20000
 ,STX,TYPE
 13,VJM,SETWRMN
 15,XTA,
 ,ATI,13
 13,XTA,
 ,STX,FL
 ,ATI,13
 13,XTA,
 ,STX,MAS
 13,VTM,RETUS1
 ,UJ,IDENT
 REQSFL:,ENTRY,
 ,ITS,13
 11,VTM,CCC
 ,ATX,R13
 ,XTA,=30000
 ,STX,TYPE
 13,VJM,SETWRMN
 15,XTA,
 ,ATI,14
 14,XTA,
 ,ARX,=37
 ,ASN,64+5
 ,AAX,=7777
 ,ATX,ID
 ,UJ,RETUS1
 ZZZZZFDB:,ENTRY,
 ZZZZZFDB:,BSS,
 TYPE:,BSS,1
 ID:,BSS,1
 MAS:,BSS,1
 FL:,BSS,1
 IDENT:,ATI,12
 12,XTA,
 ,ATX,RAB1
 12,XTA,1
 ,ATX,RAB2
 14,VTM,1-6
 ,XTA,
 ,ATX,NUM
 ID1:,XTA,RAB1
 ,ASN,64-8
 ,ATX,RAB1
 ,YTA,
 15,ATX,
 ,AEX,=57./
 ,UZA,ID2
 ,XTA,RAB2
 ,ASN,64-8
 ,ATX,RAB2
 ,YTA,
 ,AEX,RAB1
 ,ATX,RAB1
 ,XTA,RAB2
 ,AEX,=40
 ,ATX,RAB2
 ,XTA,NUM
 ,ASN,64-8
 15,AEX,
 ,ATX,NUM
 14,VLM,ID1
 ,XTA,TYPE
 ,AOX,=4000000000
 ,ATX,TYPE
 ,UJ,RETUSER
 ID2:,XTA,RAB2
 ,ASN,64-8
 ,ATX,RAB2
 ,YTA,
 ,AEX,RAB1
 ,ATX,RAB1
 ,XTA,RAB2
 ,AEX,=40
 ,STX,RAB2
 14,VTM,RAB1
 ,ITA,14
 13,MTJ,11
 13,VJM,ISOTEX
 11,MTJ,13
 11,VTM,CCC
 ,AAX,=:777777777777
 ,ATX,ID
 ,XTA,NUM
 ,APX,=6H'''''17''17''17''17'
 ,ASN,64+32
 ,FUN,203B
 ,AEX,ID
 ,ATX,ID
 13,UJ,
 REQDEL:,ENTRY,
 11,VTM,CCC
 ,ATI,14
 14,XTA,
 ,*50,112B
 15,XTA,
 13,UJ,
 RETUSER:,XTA,R13
 ,STI,13
 13,UJ,
 SETWRMN:,STX,WR
 ,ATX,MN
 ,WTC,WR
 ,XTA,
 14,VTM,1-2
 ,ATX,WR
 ,AEX,=1HW
 ,AAX,=:776
 ,UZA,W
 ,XTA,WR
 ,AEX,=1HR
 ,AAX,=:776
 ,UZA,R
 ,XTA,
 SETWR:,AEX,TYPE
 ,ATX,TYPE
 14,VLM,SETLH
 ,WTC,MN
 ,XTA,
 ,AAX,=77
 ,ATX,MN
 ,AAX,=60
 ,U1A,SETMN
 ,XTA,MN
 ,ARX,=40
 ,ATX,MN
 SETMN:,XTA,MN
 ,AEX,TYPE
 ,ATX,TYPE
 13,UJ,
 SETLH:,XTA,WR
 ,AEX,=2H L
 ,AAX,=:001774
 ,UZA,L
 ,XTA,WR
 ,AEX,=2H H
 ,AAX,=:001774
 ,UZA,H
 ,XTA,
 ,UJ,SETWR
 L:,XTA,=400
 ,UJ,SETWR
 H:,XTA,=1000
 ,UJ,SETWR
 W:,XTA,=100
 ,UJ,SETWR
 R:,XTA,=200
 ,UJ,SETWR
 RAB1:,BSS,1
 WR:,BSS,
 RAB2:,BSS,1
 MN:,BSS,
 NUM :,BSS,1
 R13:,BSS,1
 ,END,
     REQUEST:,NAME,
C*
C*                  ПOПOB M.Ю. 17/11/79
C****************************************
C*
C*   ПPOЦEДYPЫ ЗAKAЗA И OTKAЗA OT ФAЙЛOB
C*
C*   ПOПOB M.Ю.  17/11/79   OИЯИ ДYБHA
C*
C*   ЗAKAЗ ФAЙЛA  CALL REQUEST(FDB)
C*   OTKAЗ OT ФAЙЛA  CALL RETURN(FDB)
C*
C*   FILE DEFENITION BLOCK (FDB)
C*
C*   WORD 1
C*   18/U,15/E,3/T,2/U,2/D,1/R,1/W,6/N
C*
C*   E - ERRORS
C*   T - TYPE
C*   D - DENSETY
C*   DENSETY: 0 - 556 BPI
C*            1 - 200 BPI
C*            2 - 800 BPI
C*
C*   U - UNUSED
C*   TYPE: 0 TAPE
C*         1 SCRATCH TAPE
C*         2 FILE
C*         3 SCRATCH FILE
C*   W - WRITE BIT
C*   R - READ BIT
C*   N - MAT HOMEP
C*   ERRORS 40000 ПЛOXOE OБPAШEHИE
C*          20000 HET ФAЙЛA
C*          10000 HET ДOCTYПA
C*           4000 HET MECTA B TAБЛИЦE
C*           2000 ФAЙЛ ЗAHЯT
C*           1000 MAT.HOMEP ЗAHЯT
C*            400 HET ПAKETA
C*            200 ПAKET ЗAHЯT
C*            100 HET SCRATCH OБЛACTИ
C*             40 PEЗEPB
C*             20 HET MЛ
C*             10 WRITE ON
C*              4 WRITE OFF
C*              2 HET ГOTOBHOCTИ MЛ
C*              1 MЛ ЗAHЯTA
C*
C*   WORD 2
C*   ДЛЯ ЛEHT И ДИCKOB : ИMЯ ПAKETA,ЛEHTЫ
C*   ДЛЯ SCRATCH FILES : ЧИCЛO ЗOH/40B
C*
C*   TOЛЬKO ДЛЯ ФAЙЛOB
C*   WORD 3 : MASTER
C*   WORD 4 : ИMЯ ФAЙЛA
C*
C*
C*   BOЗBPAT ПO 13 ИP ,ПOPTИTCЯ 14 ИP
C*
C*
 B:,EQU,9
 FD:,EQU,10
 R1:,EQU,11
 R2:,EQU,12
 LIST:,WEQ,43B
 NPAGE:,P/P,(LIST)1024
 NPAGE1:,P/P,(LIST)16
 RFMRTFLG:LC,BLOCK,FL
 CCC:,ATI,14
 ,ITA,B
 ,ITS,13
 ,ITS,FD
 ,ITS,R1
 ,ITS,R2
 B,BASE,CCC
 14,MTJ,FD
 FD,XTS,
 ,AAX,=77
 ,ATI,14
 ,XTA,=:4
 14,ASN,64-30B
 15,ATX,
 R1,VTM,1000B
 ,*57,4040B
 15,AAX,
 ,U1A,ERROR
C
C
C
C    OPEN Э76
C
 ,XTA,PWORD
 ,*76,1
C
C
 REQUEST:FD,XTA,
 ,ASN,64+12
 ,AAX,=7
 ,ATI,R1
 R1,UJ,SWITCH
 SWITCH:,BSS,
 ,UJ,TAPE . TAPE
 :,UJ,TAPE . SCRATCH TAPE
 :,UJ,FILE . FILE
 :,UJ,SFILE . SCRATCH FILE
 :R1,VTM,40000B
 ,UJ,ERROR
 :R1,VTM,40000B
 ,UJ,ERROR
 :R1,VTM,40000B
 ,UJ,ERROR
C
C
C
C    TAPE'S REQUEST
C
 TAPE:FD,XTA,
 ,AAX,=77
 FD,XTS,
 ,AAX,=1400
 ,ASN,64-5
 15,AEX,
 ,ATI,13
 FD,XTA,
 ,AAX,=300
 ,ATI,R2
 R1,UTM,-1
 R1,V1M,TAPE1
 R2,UTM,1000B
 TAPE1:FD,XTA,1
 R2,*57,2400B
 R1,VTM,20B
 ,UZA,ERROR
 ,ASN,64+45
 ,ATX,WB
 ,AAX,=3
 ,ATI,R1
 ,U1A,ERROR
 ,XTA,WB
 ,UZA,WRON
C    ЗAПИCИ HET
 FD,XTA,
 ,AAX,=100
 R1,VTM,4
 :,U1A,ERROR
 ,UJ,RETURN
C    ЗAПИCЬ ECTЬ
 WRON:FD,XTA,
 ,AAX,=200
 R1,VTM,10B
 ,UJ,WRON-1
C
C
C
C   SCRATCH FILE'S REQUEST
C
 SFILE:FD,XTA,1
 ,AAX,=37
 FD,XTS,
 ,AAX,=77
 ,ASN,64+6
 ,YTA,
 ,ASN,64+6
 15,AEX,
 ,ATX,WB
 ,XTA,
 ,ATX,WB+1
 ,XTA,=00400000
 ,AEX,INFDISK
 ,*57,-1
 ,UZA,RETURN
 ,ATI,R2
 R2,UTM,1
 R1,VTM,100B
 R2,VZM,ERROR . HAVEN'T SCRATCH FL
 R1,VTM,4000B
 ,UJ,ERROR . HAVEN'T PLACE IN *FATA*
C
C
C
C   FILE'S REQUEST
C
C   REQUEST DISK UNIT
C
 FILE:FD,XTA,1
 ,ATX,WB+1
 ,XTA,
 ,ATX,WB
 FD,XTA,2 .MASTER
 ,ATX,WB+2
 FD,XTA,3
 ,ATX,WB+3 .FILE NAME
 FD,XTA,
 ,AAX,=100 .WRITE BIT
 ,ASN,64-23
 ,ATX,WB+4
 FD,XTA,
 ,AAX,=77
 ,AOX,=:4
 ,ATX,WB+5
 ,XTA,INFDISK
 ,*57,-1
 ,UZA,FILE 1 . O'KEY
 ,ARX,=:2
 R1,VTM,200B
 ,UZA,ERROR .DISK BUSY
 ,ARX,=:1
 R1,VTM,400B
 ,UZA,ERROR .DISK NOT FOUND
C
C   REQUEST * WHERE IS THE FILE *
C
 FILE1:,XTA,FL
 ,ARX,SAVE
 ,ATX,WB
 ,*70,WB
 ,XTA,INFDISK
 ,AEX,=00200000
 ,ARX,WPAGE
 ,*57,-1
 ,XTA,WB
 ,AOX,=:001
 ,ATX,WB
 ,*70,WB
 ,XTA,WB+4
 ,AAX,=:7
 ,UZA,FILE2
 ,ASN,64-15
 ,YTA,
 ,ASN,64-15
 ,UJ,ERROR+1
C
C   REQUEST FILE
C
 FILE2:,XTA,WB+4
 ,AAX,=777777777777
 FD,XTS,
 ,ASN,64+6
 ,YTA,
 ,ASN,64+6
 15,AEX,
 ,ATX,WB+2
 ,XTA,
 ,ATX,WB+3
 ,XTA,INFDISK
 ,ARX,=00300001
 ,*57,-1
 ,XTA,WB+2
 ,AAX,=:17
 ,UZA,RETURN
 ,ASN,64-14
 ,YTA,
 ,ATI,R1
 ERROR:,ITA,R1
 ,ASN,64-15
 :FD,AOX,
 FD,ATX,
C
C
C    CLOSE Э76
C
C
 RETURN:,XTA,
 ,*76,
 15,XTA,
 ,STI,R2
 ,STI,R1
 ,STI,FD
 ,STI,13
 ,STI,B
 13,UJ,
 RETURN:,ENTRY,
 ,ATI,14
 14,XTA,
 ,UTC,=77
 ,AAX,
 ,ATI,14
 ,UTC,=:4
 ,XTA,
 14,ASN,64-30B
 ,*57,4000B
 15,XTA,
 13,UJ,
 INFDISK:13,Z07,7240B
 8,Z00,WB
 SAVE:,000,NPAGE1
 ,007,
 WPAGE:,Z00,NPAGE
 ,Z00,1
 PWORD:,LOG,3053457616340112
 WB:,BSS,6
 ,OCT,4
 ,END,
 RUN SUB:,NAME,
C*
C*    ЗAГPYЗKA ПPOГPAMMЫ C ПAPAMETPAMИ
C*         - CALL RUNSUB (NAME) -
C*
C*    ЧИCЛO ПAPAMETPOB ЗAДAETCЯ B ПEPBOM
C*    ЭЛEMEHTE COMMON-БЛOKA /LISSUB/,
C*    CAMИ ПAPAMETPЫ - HAЧИHAЯ CO 2-ГO
C*    ЭЛEMEHTA. ECTECTBEHHO, MACCИBЫ
C*    HE ПEPEДAЮTCЯ.
C*
C*    B.И.ДYПИH -- 1984 -- ЛEHИHГPAД
C*
 LOADANGO:,SUBP,
 GOAFLOAD:,EQU,LOADANGO+17B
 END LOAD:,EQU,LOADANGO+20B
 RES 100:,SUBP,
 *LISSUB*:LC,BLOCK,ARRAY
C
 ,STI,9
 15,MTJ,10
C   ПPOДBИЖKA MAГAЗИHA
 15,UTM,40B
 ,WTC,ARRAY
 14,VTM,
 12,VTM,ARRAY+1
C   ЗAHECEHИE ПAPAMETPOB
 L1:14,VZM,L2
    ,ITS,12
 14,UTM,-1
 12,VLM,L1
 L2:,BSS,
C   BKЛЮЧEHИE BЫBOДA ЗAГPYЗKИ
 ,ITS,13
 ,CALL,BEGTPR
 12,BASE,*
 ,ATX,RET
 ,ITA,10
 ,ATX,STA
C   HECTAHДAPTHЫE BЫXOДЫ ИЗ REDUOLA
 ,XTA,END LOAD
 ,ATX,CGO
 ,XTA,GO
 ,CTX,END LOAD
 ,XTA,*20
 ,CTX,20B
C   ПOXOД HA ЗAГPYЗЧИK
 ,ITA,9
 ,CALL,LOADGO
C   BOЗBPAT B ПPOГPAMMY
 ,WTC,STA
 15,VTM,
 ,WTC,RET
 ,UJ,
C   YДAЧHAЯ ЗAГPYЗKA
 GO:13,VTM,GOAFLOAD
 ,UJ,TO
C   HEYДAЧHAЯ ЗAГPYЗKA
 *20:13,VTM,20B
 ,UJ,TO
 CGO:,BSS,1
C   BЫKЛЮЧEHИE BЫBOДA,
C   BOCCTAHOBЛEHИE CTAHДAPTHЫX ЯЧEEK
 TO:,XTS,CGO
 ,CTX,END LOAD
 ,STX,
 ,UJ,RES 100
 STA:,BSS,1
 RET:,BSS,1
 ,END,
  RU SORT:,NAME,
C*
C***   12.12.83.   A.П.CAПOЖHИKOB
C*
C*    SUBROUTINE RUSORT( M,N,L,NW,LKEY )
C*
C*   COPTИPOBKA MACCИBA  M, COДEPЖAЩEГO
C*   N ЗAПИCEЙ ДЛИHOЙ  L CЛOB KAЖДAЯ.
C*   CTPYKTYPA MACCИBA M - TAKAЯ ЖE, KAK
C*   B ПPOГPAMME  SHSORT.
C*   KЛЮЧ KAЖДOЙ ЗAПИCИ - ИMЯ ИЗ LKEY
C*   PYCCKИX CИMBOЛOB B KOДИPOBKE  ISO.
C*   KЛЮЧ PACПOЛAГAETCЯ HAЧИHAЯ C NW-ГO
C*   CЛOBA KAЖДOЙ ЗAПИCИ ( NW=1,2,3,...,L )
C*   COPTИPOBKA ПPOИCXOДИT ПO AЛФABИTY.
C*   KЛЮЧИ CPABHИBAЮTCЯ ПO LKEY CИMBOЛAM.
C*
  B:8,BASE,B
  ,STI,14
  ,STI,12
  ,STI,11
  ,STI,10
  ,STX,M
  ,ITA,13
  10,XTS,
 ,ATX,N
  11,XTA,
  ,ATX,L
  12,XTA,
  ,ATX,NW
  14,XTA,
  ,AAX,=17 7777
  15,ATX,
  ,NTR,3
  ,ARX,=5
  ,A*X,C1/6
  ,ATX,KW
  ,ASN,64-1
  15,ATX,
  ,ASN,64-1
  15,ARX,
  15,X-A,
  15,ATX,.-5,-4,...,0
  ,A+X,=5.0,1,...,5
  ,X-A,
  ,STX,LOOP.0,-1,...,-5
  ,ASN,64-3
  ,ATX,SHIFT.-40,-32,...,0
  ,NTR,6
  9,VTM,9
  13,VJM,TRANS
  ,XTS,M
  14,VTM,N
  ,ITS,14
  14,VTM,L
  ,ITS,14
  14,VTM,MORD
  ,ITS,14
  ,CALL,SHSORT
  8,BASE,B
  9,VTM,
  15,XTA,
  ,ATI,13
C
C...   ПEPEBOД ISO <===> RUSORT
C
  TRANS:,XTA,M
  ,ATI,10
  ,WTC,NW
  10,UTM,-1
  ,WTC,N
  11,VTM,
C---
  T1:,WTC,KW
  12,VTM,
  12,J+M,10
  ,WTC,LOOP
  14,VTM,
  ,XTA,SHIFT
  ,ATX,SHIFT1
C---
  T2:10,XTA,-1
  ,ASN,64-8
  10,ATX,-1
  ,YTA,
  ,ATX,S
  ,AAX,=300
  ,UZA,T3
  ,AAX,=200
  ,U1A,T3
  ,WTC,S
  ,XTA,TABL-100B
  9,ASN,64
  ,AAX,=377
  ,ATX,S
C---
  T3:,XTA,S
  10,AOX,-1
  10,ATX,-1
  14,VLM,T2
  ,WTC,SHIFT1
  14,VTM,
  14,VZM,T4
  14,ASN,64
  10,ATX,-1
  ,YTA,
  10,AOX,-1
  10,ATX,-1
  ,XTA,
  ,ATX,SHIFT1
  T4:14,VTM,-5
  10,UTM,-1
  12,UTM,-1
  12,VIM,T2
C---
  ,WTC,L
  10,UTM,
  11,UTM,-1
  11,VIM,T1
  13,UJ,
C
C...   ФYHKЦИЯ - KPИTEPИЙ :
C
  MORD:,STI,10
  ,ATI,9
  ,WTC,NW
  9,UTM,-1
  ,WTC,NW
  10,UTM,-1
  ,WTC,KW
  11,VTM,
  ,NTR,3
  14,VTM,1
  CHK:9,XTA,
  ,ASN,64+16
  10,XTS,
  ,ASN,64+16
  15,X-A,
  ,U1A,RETMOR
  ,AEX,
  ,UZA,CHK1
  NEG:14,VTM,-1
  ,UJ,RETMOR
  CHK1:12,VTM,=17 7777
  9,XTA,
  12,AAX,
  10,XTS,
  12,AAX,
  15,X-A,
  ,U1A,RETMOR
  ,AEX,
  ,U1A,NEG
  9,UTM,1
  10,UTM,1
  11,UTM,-1
  11,VIM,CHK
  14,VTM,
  RETMOR:,ITA,14
  13,UJ,
C
C     ПPЯMAЯ TAБЛИЦA ПEPEBOДA ИЗ ISO
C        B KOД RUSORT И OБPATHO.
C          -----------------
C           KOД RUSORT :
C          -----------------
C
C    1  2  3  4  5  6  7  10
C  --------------------------
C    A  Б  B  Г  Д  E  Ж  З  : 101-110
C    И  Й  K  Л  M  H  O  П  : 111-120
C    P  C  T  Y  Ф  X  Ц  Ч  : 121-130
C    Ш  Щ  Ь  Ы  Ь  Э  Ю  Я  : 131-140
C    D  F  G  I  J  L  N  Q  : 141-150
C    R  S  U  V  W  Z        : 151-156
C  --------------------------
C
  TABL:,BSS,
  100,LOG,4000 0000 00 100 100.
  101,LOG,0000 0000 00 101 101.A
  102,LOG,0000 0000 00 103 142.B
  103,LOG,0000 0000 00 122 102.C
  104,LOG,4000 0000 00 141 147.D
  105,LOG,0000 0000 00 106 144.E
  106,LOG,4000 0000 00 142 105.F
  107,LOG,4000 0000 00 143 166.G
  110,LOG,0000 0000 00 116 172.H
  111,LOG,4000 0000 00 144 151.I
  112,LOG,4000 0000 00 145 152.J
  113,LOG,0000 0000 00 113 113.K
  114,LOG,4000 0000 00 146 154.L
  115,LOG,0000 0000 00 115 115.M
  116,LOG,4000 0000 00 147 110.N
  117,LOG,0000 0000 00 117 117.O
  120,LOG,0000 0000 00 121 160.P
  121,LOG,4000 0000 00 150 120.Q
  122,LOG,4000 0000 00 151 103.R
  123,LOG,4000 0000 00 152 124.S
  124,LOG,0000 0000 00 123 131.T
  125,LOG,4000 0000 00 153 146.U
  126,LOG,4000 0000 00 154 130.V
  127,LOG,4000 0000 00 155 143.W
  130,LOG,0000 0000 00 126 176.X
  131,LOG,0000 0000 00 124 173.Y
  132,LOG,4000 0000 00 156 175.Z
  133,LOG,4000 0000 00 163 005.
  134,LOG,4000 0000 00 164 171.
  135,LOG,4000 0000 00 165 170.
  136,LOG,4000 0000 00 166 174.
  137,LOG,4000 0000 00 167 140.
  140,LOG,0000 0000 00 137 161.Ю
  141,LOG,0000 0000 00 101 104.A
  142,LOG,0000 0000 00 102 106.Б
  143,LOG,0000 0000 00 127 107.Ц
  144,LOG,0000 0000 00 105 111.Д
  145,LOG,0000 0000 00 106 112.E
  146,LOG,0000 0000 00 125 114.Ф
  147,LOG,0000 0000 00 104 116.Г
  150,LOG,0000 0000 00 126 121.X
  151,LOG,0000 0000 00 111 122.И
  152,LOG,0000 0000 00 112 123.Й
  153,LOG,0000 0000 00 113 125.K
  154,LOG,0000 0000 00 114 126.Л
  155,LOG,0000 0000 00 115 127.M
  156,LOG,0000 0000 00 116 132.H
  157,LOG,0000 0000 00 117 000.O
  160,LOG,0000 0000 00 120 000.П
  161,LOG,0000 0000 00 140 000.Я
  162,LOG,0000 0000 00 121 000.P
  163,LOG,0000 0000 00 122 133.C
  164,LOG,0000 0000 00 123 134.T
  165,LOG,0000 0000 00 124 135.Y
  166,LOG,0000 0000 00 107 136.Ж
  167,LOG,0000 0000 00 103 137.B
  170,LOG,0000 0000 00 135 000.Ь
  171,LOG,0000 0000 00 134 000.Ы
  172,LOG,0000 0000 00 110 000.З
  173,LOG,0000 0000 00 131 000.Ш
  174,LOG,0000 0000 00 136 000.Э
  175,LOG,0000 0000 00 132 000.Щ
  176,LOG,0000 0000 00 130 000.Ч
  177,LOG,0000 0000 00 177 177.
  C1/6:,LOG,4002 5252 5252 5253
  SHIFT1:,BSS,1
  SHIFT:,BSS,1
  LOOP:,BSS,1
  M :,BSS,1
  N :,BSS,1
  L :,BSS,1
  NW:,BSS,1
  KW:,BSS,1
  S :,BSS,1
  ,END,
 SAVEMON/:,NAME,
C   ПEPECЫЛKA KAPTЫ ИЗ *TIKTAK*+23
C   B MONCARD/ CO CПACAHИEM MONCARD/
C   ECЛИ CYMM.=0; BOCCTAHOBЛEHИE
C   MONCARD/ ECЛИ CYMM.#0
 *TIKTAK*:,LC,25
 MONCARD/:,LC,14
 14,VTM,-13
 ,U1A,RET.HA BOCCTAHOBЛEHИE
 SAVE:14,UTC,MONCARD/+13
 ,XTA,
 14,UTC,CARD+13
 ,ATX,
 14,UTC,*TIKTAK*+23
 ,XTA,
 14,UTC,MONCARD/+13
 ,ATX,
 14,VLM,SAVE
 13,UJ,
 RET:14,UTC,CARD+13
 ,XTA,
 14,UTC,MONCARD/+13
 ,ATX,
 14,VLM,RET
 13,UJ,
 CARD:,BSS,14
 ,END,
  SCANER:,NAME,
C*
C****** 08/07/81   A.П.CAПOЖHИKOB
C*
C*   ФOPTPAHHЫЙ ИHTEPФEЙC ЭKCTPAKOДA
C*      ФOPMATHЫX ПPEOБPAЗOBAHИЙ
C*
C*  SCANER(STRI,FRAG,IREG,ITYP,KOD,IPOZ)
C*  PUTH(STRI,TEXT,INOR,N,M,IPOZ)
C*  PUTO(STRI,NUMB,INOR,N,M,IPOZ)
C*  PUTG(STRI,NUMB,INOR,N,M,IPOZ)
C*   BCE BXOДЫ TИПA "SUBROUTINE".
C*
C*   SCANER - BЫБOPKA CИHTAKCИЧECKOГO
C*     ФPAГMEHTA ИЗ TEKCTOBOЙ CTPOKИ.
C*   STRI - AДPEC HAЧAЛA CTPOKИ. ECЛИ
C*     STRI=0, BЫБOPKA HAЧИHAETCЯ C TOГO
C*     CИMBOЛA CTPOKИ, ГДE OCTAHOBИЛИCЬ
C*     ПOCЛE ПPEДЫДYЩEГO BXOДA.
C*   FRAG - MACCИB, KYДA ПOПAДAET BЫБPAH-
C*     HЫЙ ФPAГMEHT
C*   IREG - PEЖИM PAБOTЫ SCANER-A :
C*     БИT 1 : 0-ПPOБEЛ ECTЬ PAЗДEЛИTEЛЬ
C*             1-ПPOБEЛЫ ИГHOPИPYЮTCЯ
C*     БИT 2 : 0-CTAHДAPTHЫЙ AЛФABИT
C*             1-AЛФABИT ABTOKOДA MADLEN
C*     БИT 3 : 0-BOCЬMEPИЧHЫE ЧИCЛA ЗAДA-
C*               ЮTCЯ C CYФФИKCOM "B".
C*             1-BCE ЦEЛЫE ЧИCЛA CЧИTAЮT-
C*               CЯ BOCЬMEPИЧHЫMИ.
C*     БИT 4 : 0-CKAHИPOBAHИE ФPAГMEHTOB.
C*             1-ПOCИMBOЛЬHOE CKAHИPOBAHИE
C*     ПPOЧИE БИTЫ HE CYЩECTBEHHЫ.
C*   ITYP - TИП ПOЛYЧEHHOГO ФPAГMEHTA :
C*     0 - OШИБKA, ФPAГMEHT HE PACПOЗHAH
C*     1 - BOCЬMEPИЧHOE ЧИCЛO
C*     2 - ЦEЛOE
C*     3 - BEЩECTBEHHOE
C*     4 - TEKCTOBAЯ KOHCTAHTA
C*     5 - ПYCTOЙ ФPAГMEHT
C*   KOD - KOД PAЗДEЛИTEЛЯ (ЦEЛOE)
C*
C*   ПPИ ПOCИMBOЛЬHOM CKAHИPOBAHИИ ЗA OДHO
C*   OБPAЩEHИE K SCANER-Y BЫБИPAETCЯ OДИH
C*   OЧEPEДHOЙ CИMBOЛ CTPOKИ. OH ПOMEЩAETCЯ
C*   BO FRAG B BИДE  1H<CИMBOЛ> И B KOD B
C*   BИДE ЦEЛOГO ЧИCЛA.
C*   ITYP COДEPЖИT TИП BЫБPAHHOГO CИMBOЛA:
C*     0 - KOHEЦ CTPOKИ
C*     1 - ЦИФPA
C*     2 - БYKBA
C*     3 - PAЗДEЛИTEЛЬ
C*
C*   PUTH, PUTO, PUTG - OПEPAЦИИ TИПA
C*   "ENCODE" ПO CПEЦИФИKAЦИЯM "H","O","G"
C*
C*   ЗДECЬ STRI - AДPEC BЫXOДHOГO TEKCTA
C*   ИЛИ 0, ECЛИ OЧEPEДHOЙ TEKCTOBЫЙ ФPAГ-
C*   MEHT ЗACЫЛAETCЯ BCTЫK K ПPEДЫДYЩEMY
C*
C*   N,M - ЦEЛЫE.  N<32 , M<16
C*
C*   PUTH - ПEPECЫЛKA B BЫXOДHYЮ CTPOKY
C*     N CИMBOЛOB MACCИBA TEXT.
C*     INOR И M - HECYЩECTBEHHЫ
C*   PUTO - ПPEOБPAЗOBAHИE CЛOBA NUMB
C*     ПO ФOPMATY  O<N>  CO BCTABKOЙ
C*     OДHOГO ПPOБEЛA ПOCЛE KAЖДЫX  M
C*     BOCЬMEPИЧHЫX ЦИФP.
C*   PUTG - ПPEOБPAЗOBAHИE CЛOBA NUMB
C*     ПO ФOPMATY  G<N>.<M>  ИЛИ  I<N>
C*     ECЛИ M=0
C*   INOR - PEЖИM BЫPABHИBAHИЯ TEKCTA
C*     BHYTPИ CBOEГO ПOЛЯ ИЗ N ПOЗИЦИЙ :
C*     0 - ПO ЛEBOMY KPAЮ, 1 - ПO ПPABOMY
C*
C*   B  IPOZ  BO BCEX CЛYЧAЯX ПOMEЩAETCЯ
C*   HOMEP TEKYЩEЙ ПOЗИЦИИ ПO BXOДHOЙ
C*   (BЫXOДHOЙ) CTPOKE: 1,2,3,...
C*
  A/I0:,LC,1
  ,UTC,-1
  PUTH:,ENTRY,
  ,UTC,-1
  PUTO:,ENTRY,
  ,UTC,-1
  PUTG:,ENTRY,
  9,VTM,3
  8,BASE,*
  ,STX,IPOZ
  ,STX,M
  ,STX,N
  ,STI,11
  ,STI,10
  ,ATI,12
  12,XTA,
  ,AEX,A/I0
  :,U1A,*+1
  12,VTM,
  :11,XTA,
  ,AAX,=17
  ,ASN,64-15
  9,VZM,MACRO
  ,AAX,=10 0000
  ,ASN,64-4
  ,WTC,N
  ,XTS,
  ,AAX,=37
  ,ASN,64-24
  ,WTC,M
  ,XTS,
  ,AAX,=17
  15,AOX,
  ,ASN,64-15
  15,AOX,
  MACRO:,AOX,IW50
  9,FUN,12
  9,VIM,EXIT
  14,UJ,SW
  SW:,UJ,FIN.OШИБKA
  :10,ATX,.OCTAL
  ,UJ,FIN
  :10,ATX,.INTEGER
  ,UJ,FIN
  :10,ATX,.REAL
  ,UJ,FIN
  :,,.IDENT
  :,,.LONG
  ,UJ,ID
  :14,VTM,5.EMPTY
  ,UJ,FIN
  LONG:11,XTA,
  ,AAX,=17
  ,ASN,64-15
  ,FUN,12
  14,VZM,FIN
  10,UTM,2
  ID:10,ATX,
  ,YTA,
  10,ATX,1
  14,UTM,-5
  14,VZM,LONG
  ,FUN,70100B+136B.OГP.
  15,ATX,
  ,FUN,70100B+135B.ПOЗ.
  ,ASN,64+24
  ,ASN,64-9
  15,AOX,
  14,VTM,4
  ,AEX,
  FIN:,YTA,
  15,ATX,
  ,ITS,14
  ,AOX,A/I0
  ,WTC,N
  ,STX,
  ,AAX,=377
  ,AOX,A/I0
  ,WTC,M
  ,STX,
  ,ASN,64+24
  ,AAX,=377
  EXIT:,AOX,A/I0
  ,WTC,IPOZ
  ,STX,
  13,UJ,
  IW50:10,Z00,
  12,Z00,
  IPOZ:,BSS,1
  N   :,BSS,1
  M   :,BSS,1
  ,END,
 SEARCH*:,NAME,.ДABЫДOB A.Л.
C*************** 16/04-80 ***************
C*     ПOCЛEДOBATEЛЬHЫЙ ПOИCK ПO TAБЛИЦE,
C*     AДPEC KOTOPOЙ ЗAДAETCЯ B 10-M PE-
C*     ГИCTPE, C ИCПPABЛEHИEM OШИБOK ПPИ
C*     HAБOPE KЛЮЧA.
C*     ПPEДПOЛAГAETCЯ, ЧTO ПOИCK ПPOИЗBO-
C*     ДИTCЯ ПPИ PAЗБOPE TEKCTOBOЙ CTPO-
C*     KИ, ПPИЧEM CЛOBA (KЛЮЧИ) OTДEЛEHЫ
C*     PAЗДEЛИTEЛЯMИ. KOД PAЗДEЛИTEЛЯ
C*     ДOЛЖEH БЫTЬ B 11 И.P., A B 12 И.P.
C*     ДOЛЖHO БЫTЬ ЗAHECEHO ЧИCЛO CИMBO-
C*     ЛOB B KЛЮЧE. B KOHЦE TEKCTOBOЙ
C*     CTPOKИ OБЯЗATEЛЬHO ДOЛЖHЫ CTOЯTЬ
C*     PAЗДEЛИTEЛИ C KOДOM '0' ИЛИ '12'.
C*     MEЖДY HИMИ ECTЬ HEKOTOPAЯ PAЗHИЦA:
C*     '12' - ЭTO ПPИЗHAK БЛOKИPOBKИ ПE-
C*     ЧATИ OБ ИCПPABЛEHЫX OШИБKAX.
C*       ПOД ИCПPABЛEHИEM OШИБOK ПOHИMA-
C*     ETCЯ HAXOЖДEHИE OБPAЗA B TAБЛИЦE,
C*     ДAЖE ECЛИ B KЛЮЧE ECTЬ OДИH HE-
C*     BEPHЫЙ CИMBOЛ. OДHAKO ФOPMAЛЬHO
C*     TAKOE OБPAЩEHИE CЧИTAETCЯ OШИБOЧ-
C*     HЫM.
C*       PEЗYЛЬTAT OБPAЩEHИЯ HAXOДИTCЯ
C*     B 14 И.P. И HA CYMMATOPE.
C*     И.P. 14 - HOMEP ПO TAБЛИЦE KЛЮЧEЙ
C*     CYMMATOP .NE.0. - OШИБKA:
C*     1 - OШ. KЛЮЧ, HO YДAЛOCЬ ИCПPA-
C*         BИTЬ.
C*     2 - OШ.KЛЮЧ.
C*     3 - HEOДHOЗHAЧHOCTЬ
C*     4 - HEOДHOЗHAЧHOCTЬ ИCПPABЛEHИЯ.
C*     ECЛИ ПPИ ЭTOM И.P.14 = 0, TO
C*     OШИБKY ИCПPABИTЬ HE YДAЛOCЬ.
C*     B ЭTOM CЛYЧAE, KPOME TOГO, CЧИTA-
C*     ETCЯ, ЧTO TEKCTOBAЯ CTPOKA OKOH-
C*     ЧEHA.
C*
C*     B CBETE BCEГO BЫШECKAЗAHHOГO OБPA-
C*     ЩEHИE K П/П TAKOBO:
C*     KЛЮЧ ДЛЯ ПOИCKA - B LC *MONCRD*
C*     10 И.P.- AДPEC TAБЛИЦЫ KЛЮЧEЙ
C*     11 И.P.- PAЗДEЛИTEЛЬ
C*     12 И.P.- ЧИCЛO CИMBOЛOB B KЛЮЧE.
C*     PEГИCTPЫ 1-12 COXPAHЯЮTCЯ.
C****************************************
 *MONCRD*:LC,BLOCK,MCRD(12)
 INKOGN:,LC,1
 B:,BSS,
 ,ITA,8
 ,ITS,9
 ,ITS,10
 ,ITS,13
 ,ITS,
 8,BASE,B
 ,ATX,STACK/FL
 ,ITA,12
 ,ATX,SI12.ЧИCЛO CИMB.
 ,ARX,=1
 ,ASN,64+3
 ,UZA,*2
C          CMOTPИM TOЛЬKO 6 CИMBOЛOB
 12,VTM,6
 *2:,ITA,12
 ,U1A,*3
 13,VTM,RETURN1
 11,MTJ,12
 12,VZM,E/STRING
 12,UTM,-12B
 12,VZM,CБPOC
 ,UJ,ERROR2
 *3:,BSS,
 ,ASN,64-3.A*8
 ,ATI,14.ЧИCЛO P.P.
 ,XTA,FULWOR
 14,ASN,64
 ,AEX,FULWOR
 ,ATX,MASKEY
 ,XTA,MCRD.HAM
 ,AAX,MASKEY.ЛИШHEГO
 ,ATX,KEY.HE HAДO
 ,ITA,
 ,ATX,ERROR
 ,ATX,ПOXOЖE
 12,MTJ,14
 14,UTM,-1
 14,V1M,*1
C          B KЛЮЧE BCEГO OДИH CИMBOЛ
 ,ITA,10
 ,ATX,ПOXOЖE.HE HOЛЬ
 *1:,BSS,
 9,VTM,
 12,VTM,1
 LOOP:,BSS,
 12,UTC,
 10,XTA,-1
 ,UZA,BCE.KOHEЦ TAБЛИЦЫ
 ,AAX,MASKEY
 ,AEX,KEY
 ,ATX,W
 ,UZA,GOD
 9,V1M,E/LOOP.БЫЛO CPABHEHИE
 ,ACX,.ЧИCЛO
 ,ASN,64+3.EДИHИЦ
 ,UZA,EXCLUD.MEHЬШE 8-MИ
 E/LOOP:12,VLM,LOOP
 EXCLUD:,BSS,
C     ПOПPOБYEM HAЙTИ ЧTO-TO ПOXOЖEE
 ,XTA,W
 ,ANX,
 ,ARX,C77777.-1
 ,AAX,=70
 ,ATI,14.KPATHO 8-MИ
 ,XTA,OCT776
 14,ASN,64
 ,AAX,W
 ,AEX,W
 ,U1A,E/LOOP.CЛИШKOM MHOГOE HE COBП.
C     HE COBПAЛ OДИH БAЙT.
 14,VTM,4
 ,XTA,ПOXOЖE
 ,U1A,ERRORS.MЫ CДECЬ БЫЛИ
 ,ITA,12
 ,ATX,ПOXOЖE
 ,UJ,E/LOOP
 ERRORS:,ITA,14
 ,ATX,ERROR
 ,UJ,E/LOOP
 GOD:,BSS,
 14,VTM,3
 9,V1M,ERRORS
 12,MTJ,9
 ,UJ,E/LOOP
 BCE:,BSS,.CYMMATOP=0
 9,VZM,NOT OWN
 ,WTC,ERROR
 14,VTM,
 14,UTM,-3
 14,VZM,RETURN.ERROR=3
 9,MTJ,14
 ,ATX,ERROR.CYMMATOP=0
 ,UJ,RETURN
 NOT OWN:,BSS,
 14,VTM,
 ,XTA,ERROR
 ,U1A,RETURN.ERROR=4
 ,XTA,ПOXOЖE
 ,UZA,ERROR2
 ,ATI,14
 ,XTA,=1
 ,ATX,ERROR
 ,XTA,MCRD
 ,AAX,MASKEY
 ,AEX,MCRD
 ,ATX,MCRD
 14,UTC,-1
 10,XTA,.BEPHЫЙ KЛЮЧ
 ,AAX,MASKEY
 ,AOX,MCRD
 ,ATX,MCRD
 13,VJM,ERRTEXT
 RETURN1:,BSS,
 ,STI,
 ,STI,13
 ,STI,10
 ,STI,9
 ,ATI,8
 ,WTC,SI12
 12,VTM,
 ,UTC,ERROR
 ,XTA,
 13,UJ,
 RETURN:,BSS,
 14,V1M,O KEY.KЛЮЧ HAЙДEH
 13,VTM,RETURN1
 ,UJ,CБPOC.I11 ЯKOБЫ PABEH 12B
 O KEY:,BSS,
 13,VTM,RETURN1
 ,UJ,TOTEXT
 ERROR2:,BSS,
 14,VTM,2
 ,ITA,14
 ,ATX,ERROR
 14,VTM,
 ,UJ,RETURN
 TOTEXT:,BSS,
 ,XTA,P/FLAG
 ,U1A,ERRTEXT
 ,UJ,ALL
C     БЫЛA TOЧKA B OШ.KЛЮЧE
 ERRTEXT:,BSS,
C     БYФEPИЗAЦИЯ OШИБOЧHЫX OБPAЩEHИЙ
 ,UTC,INKOGN
 ,XTA,
 ,U1A,ALL
 ,ITA,11
 ,AEX,=56.TOЧKA ЛИ
 ,U1A,BUF.HET
 ,XTA,=56
 ,ATX,P/FLAG
 BUF:,BSS,
 ,XTA,PT/FLAG
 ,U1A,ALL
 ,ITA,14
 10,VTM,BUFER
 14,VTM,MCRD
 TO BUF:,BSS,
 ,ITS,13
 ,ITS,
 ,WTC,STACK/FL
 ,WTC,I12
 12,VTM,.CЧETЧИK B БYФEPE
 ,WTC,STACK/FL
 ,WTC,I9
 9,VTM,.PEГИCTP CДBИГA
 9,V1M,*4
 ,ITA,
 10,UTC,
 12,ATX,
 *4:,BSS,
 ,NTR,6
 ,XTA,SI12.ЧИCЛO CИMBOЛOB
 ,AOX,=I0
 ,A+X,=I0
 ,A/X,=R6.0
 ,NTR,7
 ,A+X,=I0
 ,ATX,W.ЧИCЛO ЯЧEEK
 ,AEX,C77777
 ,NTR,6
 ,ARX,=1
 ,ATI,13
 13,VZM,YOUNG
 13,UTM,1.ДЛЯ ,VLM,
 WORDS:,BSS,
 ,WTC,W
 13,UTC,-1
 14,XTA,
 9,ASN,64
 ,ATX,W2
 ,YTA,
 10,UTC,
 12,ATX,1
 ,XTA,W2
 10,UTC,
 12,AOX,
 10,UTC,
 12,ATX,
 12,UTM,1-13
 ,ITA,12
 ,AAX,=70000
 ,AOX,STACK/FL
 ,UZA,PROTECT
 12,UTM,13
 13,VLM,WORDS
 YOUNG:,BSS,
 ,XTA,W.ЧИCЛO ЯЧEEK
 ,A*X,=R6.0
 ,ATX,W2.YПPЯTAHHЫE CИMBOЛЫ
 ,NTR,7
 ,XTA,SI12
 ,AOX,=I0
 ,A-X,W2
 ,NTR,6
C           HA CYMMATOPE-ЧИCЛO OCTABШИXCЯ CИMB.
 ,ASN,64-3.A*8
 ,ATI,13
 ,XTA,FULWOR
 13,ASN,64
 ,AEX,FULWOR
 ,WTC,W.ПOCЛEДHEE
 14,AAX,.CЛOBO
 9,ASN,64
 ,ATX,W2
 ,YTA,
 ,ATX,W.BCE,ЧTO BЫЛEЗЛO
 ,XTA,W2
 10,UTC,
 12,AOX,
 10,UTC,
 12,ATX,
 13,J+M,9
 ,XTA,STACK/FL
 ,U1A,ST1
 ,ITA,11.PAЗДEЛИTEЛЬ
 9,ASN,64-40
 ,ATX,W2
 ,YTA,
 10,UTC,
 12,AOX,1
 10,UTC,
 12,ATX,1
 ,UZA,SMALL
C           ЗAHЯЛИ CЛEД.ЯЧEЙKY
 12,UTM,1
 9,UTM,-48+8
 ,UJ,E/BUF
 SMALL:,BSS,
 9,UTM,8
 ,XTA,W2
 10,UTC,
 12,AOX,
 10,UTC,
 12,ATX,
 ,AAX,C377
 ,UZA,E/BUF
C           KOHЧИЛACЬ ЯЧEЙKA
 ,ITA,
 9,VTM,
 12,UTM,1
 12,ATX,BUFER
 E/BUF:,BSS,
 ,ITA,9
 ,WTC,STACK/FL
 ,ATX,I9
 ,ITA,12
 ,WTC,STACK/FL
 ,ATX,I12
 12,UTM,-13
 ,ITA,12
 ,AAX,=70000
 ,AOX,STACK/FL
 ,U1A,E*BUF
 PROTECT:,XTA,=1.ЗAЩИTA OT
 ,ATX,PT/FLAG.ПEPEПOЛH.БYФEPA
 E*BUF:,BSS,
 ,STI,
 ,STI,13
 ,ATI,14
 ,XTA,STACK/FL
 13,U1A,
 ALL:,BSS,
 11,MTJ,12
 12,VZM,E/STRING
 12,UTM,-12B
 12,VZM,CБPOC
 13,UJ,
 E/STRING:,BSS,
 ,XTA,BUFER
 ,UZA,CБPOC
 14,MTJ,12
 ,*71,IW71
 12,MTJ,14
 CБPOC:,BSS,
 ,ITA,
 ,ATX,BUFER
 ,ATX,PT/FLAG
 ,ATX,I9
 ,ATX,I12
 ,ATX,P/FLAG
 13,UJ,
C========================================
 ST1:,BSS,
 ,ITA,9
 ,NTR,7
 ,A-X,=60.48
 ,U1A,ST1/1
C     BЫЛEЗЛИ B CЛEД. ЯЧEЙKY
 9,UTM,-48
 12,UTM,1
 9,VZM,ST1/1.HOB.ЯЧ.HE ЗAHЯTA
 ,XTA,W.TO,ЧTO BЫЛEЗЛO
 10,UTC,
 12,ATX,
 ST1/1:,NTR,6
 ,ITA,12
 9,VZM,ST1/2
 ,ARX,=1
 ST1/2:,BSS,
 ,ATX,ERROR
 ,UJ,E/BUF
C========================================
 STACK*:,ENTRY,.3/06-80
C****************************************
C*            S T A C K *
C*    ФOPMИPOBAHИE TEKCTA ИЗ ПAPAMETPOB
C*    PAЗЛИЧHOЙ ДЛИHЫ.
C*        BXOД  B  П/П   SEARCH*
C*
C*        O Б P A Щ E H И E :
C*......................................
C*    I12 = 0 - YCTAHOBOЧHOE OБPAЩEHИE
C*            B ЭTOM CЛYЧAE:
C*        I10 = ADR. БYФEPA
C*......................................
C*    ЗAПИCЬ ПAPAMETPA:
C*    I12 - KOЛ-BO CИMBOЛOB B ПAPAMETPE
C*    I14 - AДPEC ПAPAMETPA
C*.......................................
C*    HA BЫXOДE CYMMATOP PABEH KOЛ-BY
C*    ЗAHЯTЫX TEKCTOM ЯЧEEK B БYФEPE
C***************************************
  ,ITA,8
 ,ITS,9
 ,ITS,10
 ,ITS,13
 ,ITS,12
 8,BASE,B
 ,ATX,SI12
 ,XTA,=1
 ,ATX,STACK/FL
 13,VTM,RETURN1
 12,V1M,ST CONT
 ,ITA,10
 ,ATX,I10
 ,ITA,
 ,ATX,I9+1
 ,ATX,I12+1
 10,ATX,
 13,UJ,
 STCONT:,BSS,
 ,WTC,I10
 10,VTM,
 ,ITA,14
 ,UJ,TO BUF
 IW71:,040,BUFER
 ,,
 OCT776:,OCT,776
 SI12:,BSS,1
 FULWOR:,LOG,7777 7777 7777 7777
 C77777:,LOG,77777
 C377  :,LOG,377
 I9    :,LOG,
 ,LOG,
 I12   :,LOG,
 ,LOG,
 I10:,BSS,1
 STACK/FL:,BSS,1
 BUFER :,LOG,
 ,BSS,13.BUFER
 PT/FLAG:,LOG,
 W:,BSS,1
 W2:,BSS,1
 P/FLAG:,LOG,
 ERROR:,BSS,1
 ПOXOЖE:,BSS,1
 KEY:,BSS,1
 MASKEY:,BSS,1
 ,END,
  SHSORT:,NAME,
C*
C**********  2.11.80.  A.П.CAПOЖHИKOB
C*
C*   SUBROUTINE SHSORT(M,N,L,MORD)
C*   COPTИPOBKA ЗAПИCEЙ, ПOCЛEДOBATEЛЬHO
C*   PACПOЛOЖEHHЫX B MACCИBE  M :
C*    M[1], ... ,M[L]        - 1-Я ЗAПИCЬ
C*    M[L+1], ... ,M[2L]     - 2-Я ЗAПИCЬ
C*       .................
C*    M[NL-L+1], ... ,M[NL]  - N-Я ЗAПИCЬ
C*   N - KOЛИЧECTBO ЗAПИCEЙ
C*   L - ДЛИHA OДHOЙ ЗAПИCИ
C*
C*   ПOCЛE BЫXOДA ИЗ ПOДПPOГPAMMЫ
C*   MACCИB M COДEPЖИT TE ЖE N ЗAПИCEЙ,
C*   HO OTCOPTИPOBAHHЫX COГЛACHO БИHAPHOMY
C*   OTHOШEHИЮ  " < " , OПPEДEЛEHHOMY
C*   ФYHKЦИEЙ ЮЗEPA  MORD  ИЛИ CTAHДAPTHO
C*   B CЛYЧAE, ECЛИ ЗHAЧEHИE MORD =0,1,2,3.
C*
C*   FUNCTION MORD(Z1,Z2) MOЖET БЫTЬ
C*   HAПИCAHA HA ФOPTPAHE. ЗДECЬ Z1,Z2 -
C*   - AДPECA HAЧAЛ ДBYX ЗAПИCEЙ.
C*   ФYHKЦИЯ ДOЛЖHA CPABHИTЬ Z1 И Z2,
C*   ПOЛЬЗYЯCЬ CBOИM COБCTBEHHЫM KPИTEPИEM
C*   (HAПPИMEP, ПO COДEPЖИMOMY KAKOГO-TO
C*   KЛЮЧEBOГO ПOЛЯ), И BЫДATЬ B KAЧECTBE
C*   PEЗYЛЬTATA :
C*     1, ECЛИ  Z1 < Z2  ,
C*     0, ECЛИ  Z1 = Z2  ,
C*    -1, ECЛИ  Z1 > Z2  .
C*
C*   ECЛИ KЛЮЧ PACПOЛAГAETCЯ B ПEPBOM CЛOBE
C*   KAЖДOЙ ЗAПИCИ И ЗAHИMAET POBHO OДHO
C*   CЛOBO, TO MOЖHO ПOЛЬЗOBATЬCЯ OДHИM ИЗ
C*   TPEX CTAHДAPTHЫX KPИTEPИEB YПOPЯДOЧEHИЯ
C*   ЗAДABAЯ B KAЧECTBE ПAPAMETPA  MORD
C*   ЦEЛOE ЧИCЛO  1,2 ИЛИ 3 :
C*    1 - YПOPЯДOЧEHИE ПO AЛФABИTY
C*        (KЛЮЧ - TEKCTOBAЯ KOHCTAHTA)
C*    2 - YПOPЯДOЧEHИE ПO BOЗPACTAHИЮ
C*        (KЛЮЧ - ЦEЛOE ИЛИ BEЩECTB.)
C*    3 - YПOPЯДOЧEHИE ПO YБЫBAHИЮ
C*   ECЛИ ЖE ЗAДATЬ  MORD = 0,  TO BCЯ
C*   ЗAПИCЬ PACCMATPИBAETCЯ KAK CИMBOЛЬ-
C*   HЫЙ KЛЮЧ ДЛИHOЙ L CЛOB, И YПOPЯДO-
C*   ЧEHИE ПPOИCXOДИT ПO AЛФABИTY.
C*
C*   ЗAMEЧAHИE: ПOД AЛФABИTHЫM YПOPЯДOЧEHИEM
C*     MЫ ЗДECЬ ПOHИMAEM YПOPЯДOЧEHИE
C*     ЛATИHCKИX ИMEH ДЛЯ KOДA ISO
C*     ИЛИ PYCCKИX ИMEH ДЛЯ KOДA GOST.
C*     ДЛЯ COPTИPOBKИ PYCCKИX ИMEH B KOДE
C*     ISO CЛEДYET ПOЛЬЗOBATЬCЯ ПPOГPAMMOЙ
C*     RUSORT.
C*
C*   ИCПOЛЬЗYETCЯ METOД ШEЛЛA C YБЫBAЮЩИM
C*   ШAГOM  S(I+1)=(S(I)-1)/3
C*   CM. KHYT "ИCKYCCTBO ПPOГPAMMИPOBAHИЯ"
C*
C*   BЫXOДHAЯ ПOCЛEДOBATEЛЬHOCTЬ ЗAПИCEЙ
C*   YДOBЛETBOPЯET COOTHOШEHИЮ
C*    Z1 <= Z2 <=  ...  <= ZN
C*   OTHOCИTEЛЬHOE PACПOЛOЖEHИE ЗAПИCEЙ
C*   C PABHЫMИ KЛЮЧAMИ  HE  COXPAHЯETCЯ.
C*
  A/I0:,LC,1
  B:8,BASE,B
  ,STX,MORD
  ,STI,11.L
  ,STI,10.N
  ,AOX,A/I0
  ,ATX,M
  ,ITA,13
  ,ATX,RET
  ,NTR,3
C
C---   ПPOБA MORD HA 1,2,3  И
C      ПOДCTAHOBKA AДPECA
C      CTAHДAPTHOЙ ПPOЦEДYPЫ
C      CPABHEHИЯ KЛЮЧEЙ.
C
  ,WTC,MORD
  ,XTA,
  ,ATI,9
  ,AEX,A/I0
  ,ASN,64+2
  ,U1A,BEGIN
  9,XTA,ADR
  ,ATX,MORD
C
C
C      SUBROUTINE SHSORT(M,N,L,MORD)
C      DIMENSION M(2)
C      IF(L.LT.1.OR.N.LT.2) RETURN
C
C
  BEGIN:10,XTA,
  ,ATX,N
  ,A-X,=I2
  ,U1A,EXIT
  11,XTA,
  ,ATX,L
  ,A-X,=I1
  ,U1A,EXIT
C
C
C      S = 1
C   1  IF(9*S+4.GE.N) GOTO 2
C      S = 3*S+1
C      GOTO 1
C
C
  :12,VTM,1
  14,VTM,13
  MSTEP:,ITA,14
  ,AOX,A/I0
  ,A-X,N
  ,UZA,STEP
  12,MTJ,13
  12,J+M,12
  13,J+M,12
  12,UTM,1
  14,MTJ,13
  14,J+M,14
  13,J+M,14
  14,VLM,MSTEP
C
C
C    2  D = L*S
C       JJ = (S-1)*L
C       DO 3 J= S+1, N
C
C
  STEP:,ITA,12
  ,AOX,A/I0
  ,ATX,S
  ,ATX,J
  ,E+N,64-40
  ,A*X,L
  ,YTA,64
  ,ATX,D
  SSORT:,ATX,JJ
  ,XTA,J
  ,A+X,=I1
  ,ATX,J
  ,X-A,N
  ,U1A,ESTEP
C
C
C      II = JJ
C    5 IF(MORD(M(II+1),M(II+D+1)).NE.-1) GOTO 3
C
C
  ,XTA,JJ
  SIMPLE:,BSS,
  ,ATX,II
  ,A+X,M
  15,ATX,
  ,A-X,D
  ,WTC,MORD
  13,VJM,
  CHORD:,BSS,
  ,NTR,3
  8,BASE,B
  ,ATI,14
  14,UTM,-1
  14,VIM,ORD
C
C
C      DO 4 K = 1,L
C      KK = M(II+K)
C      M(II+D+K) = M(II+K)
C   4  M(II+K) = KK
C
C
  ,XTA,II
  ,A+X,M
  ,ATI,10
  ,A-X,D
  ,ATI,11
 ,WTC,L
  14,VTM,
  TRAN:10,XTA,
  11,XTS,
  10,STX,
  11,ATX,
  10,UTM,1
  11,UTM,1
  14,UTM,-1
  14,VIM,TRAN
C
C
C      II = II-D
C      IF(II.GE.0) GOTO 5
C
C
  ,XTA,II
  ,A-X,D
  ,A-X,D
  ,U1A,ORD
  ,A+X,D
  ,UJ,SIMPLE
C
C
C    3 JJ = JJ+L
C
C
  ORD:,XTA,JJ
  ,A+X,L
  ,UJ,SSORT
C
C
C      IF(S.EQ.1) RETURN
C      S = (S-1)/3
C      GOTO 2
C      END
C
C
  ESTEP:,WTC,S
  12,VTM,-1
  12,VZM,EXIT
  ,ITA,12
  ,A*X,C1/3
  ,ATI,12
  ,UJ,STEP
C---
  EXIT:,XTA,RET
  ,STI,13
  ,NTR,6
  13,UJ,
C---
  ADR:,,
  ,Z00,CHEK0
  ,,
  ,Z00,CHEK1
  :,,
  ,Z00,CHEK2
  :,,
  ,Z00,CHEK3
C
C---   CTAHД.ПPOЦEДYPЫ
C      CPABHEHИЯ KЛЮЧEЙ :
C
  CHEK0:,STI,10
  ,ATI,9
  ,WTC,L
  14,VTM,
  :14,UTM,-1
  13,VJM,CHEK1/1
  ,U1A,CHORD
  14,VZM,CHORD
  9,UTM,1
  10,VLM,*-2
  CHEK1:,STI,10
  ,ATI,9
  CHEK1/1:,BSS,
  9,XTA,
  ,ASN,64+15
  10,XTS,
  ,ASN,64+15
  15,X-A,
  ,U1A,P1
  ,AEX,
  ,U1A,M1
  9,XTA,
  ,AAX,=77777
  10,XTS,
  ,AAX,=77777
  SUB:15,X-A,
  ,U1A,P1
  ,AEX,
  13,UZA,
  M1:,XTA,=77777
  13,UJ,
  P1:,XTA,=I1
  13,UJ,
  CHEK3:,STI,10
  ,ATI,9
  ,UJ,CHEK23
  CHEK2:,STI,9
  ,ATI,10
  CHEK23:,NTR,6
  10,XTA,
  9,XTS,
  ,UJ,SUB
C---
  C1/3:,LOG,4005 2525 2525 2526
  MORD:,BSS,1
  RET :,BSS,1
  II  :,BSS,1
  JJ  :,BSS,1
  M   :,BSS,1
  N   :,BSS,1
  L   :,BSS,1
  S   :,BSS,1
  J   :,BSS,1
  D   :,BSS,1
  ,END,
  SORT48:,NAME,
C*
C********** 1.2.80.  A.П.CAПOЖHИKOB
C*
C*   SUBROUTINE SORT48(TAB,LEN)
C*   COPTИPOBKA TAБЛИЦЫ TAB, COДEPЖAЩEЙ
C*   LEN 48-БИTOBЫX KЛЮЧEЙ.
C*
C*   KЛЮЧИ PACCMATPИBAЮTCЯ KAK ЦEЛЫE
C*   48-PAЗPЯДHЫE ЧИCЛA И YПOPЯДOЧИBA-
C*   ЮTCЯ B TAB ПO BOЗPACTAHИЮ.
C*   ИCПOЛЬЗYETCЯ "METOД ПYЗЫPЬKA"
C*   CM. KHYT T.3
C*
C*   ПPOГPAMMA ИCПOЛЬЗYET БEЗ COXPAHEHИЯ
C*   10-14 PEГИCTPЫ. HA BЫXOДE: ,NTR,2
C*
C****************************************
C*
  B:10,BASE,B
  ,STI,14
  ,ATI,12
  ,STX,ADR
  14,WTC,
  14,VTM,-2
  ,ITA,14
  ,ATX,LEN
  ,ASN,64+14
  13,U1A,
  ,NTR,3
  14,VTM,
C---
  LOOP:14,MTJ,11
  11,J+M,12
C---
  CHEK:12,XTA,
  ,ASN,64+10
  12,XTS,1
  ,ASN,64+10
  15,A-X,
  ,U1A,NORD
  ,AEX,
  ,UZA,ORD
  12,XTA,
  ,AAX,=1777
  12,XTS,1
  ,AAX,=1777
  15,A-X,
  ,U1A,NORD
  ,AEX,
  ,U1A,ORD
C---
  NORD:12,XTA,
  12,XTS,1
  12,STX,
  12,ATX,1
  12,UTM,-1
  11,VZM,ORD
  11,UTM,-1
  ,UJ,CHEK
C---
  ORD:,ITA,14
  ,AEX,LEN
  ,WTC,ADR
  12,VTM,
  14,UTM,1
  ,U1A,LOOP
C---
  ,NTR,2
  13,UJ,
C---
  ADR:,BSS,1
  LEN:,BSS,1
  ,END,
  STR OUT:,NAME,
C*
C***********  1.2.80.  A.П.CAПOЖHИKOB
C*
C*    SUBROUTINE STROUT(M,L)
C*
C*    BЫBOД TEKCTOBOЙ CTPOKИ M ДЛИHOЙ L CЛOB
C*    CTPOKA BЫBOДИTCЯ HA AЦПY БИЛИCTOM
C*    ШИPИHOЙ 60 CИMBOЛOB, T.E. B OДHOЙ
C*    CTPOKE ЛИCTИHГA ПOMEЩAETCЯ 10 CЛOB
C*    BXOДHOЙ CTPOKИ M. "XBOCT" M ДOПOЛ-
C*    HЯETCЯ ПPOБEЛAMИ.
C*    B HAЧAЛE KAЖДOЙ ПOЛYCTPAHИЦЫ ПEЧATAEM
C*    ЗAГOЛOBOK - LTIT CЛOB ИЗ MACCИBA MTIT
C*      COMMON/TITLE/LTIT,MTIT(...)
C*
C*    BXOДHAЯ CTPOKA M MOЖET БЫTЬ BЫДAHA
C*    И HA ЭKPAH ДИCПЛEЯ ( TAKИMИ ЖE 60-
C*    -CИMBOЛЬHЫMИ ПOPЦИЯMИ ), ECЛИ БЫЛO
C*    OБPAЩEHИE :   CALL STROUT('DISPL',0).
C*
C*    БЛOKИPOBKA И PAЗPEШEHИE BЫДAЧИ
C*    HA ЭKPAH MOЖET ПPOИЗBOДИTЬCЯ B
C*    ПPOЦECCE PAБOTЫ C ПOMOЩЬЮ ПPИKAЗA
C*     " ПYЛЬT 40 "  :
C*    ЧET-БЛOKИPOBKA, HEЧET-PAЗPEШEHИE.
C*    ПOCЛE OПPOCA PAЗPЯД ПYЛЬTA ГACИTCЯ
C*
C*    YПPABЛEHИE ЛИCTOBAHИEM :
C*    CALL STROUT('PAGE',0) -
C*    - BЫXOД HA CЛEДYЮЩYЮ ПOЛYCTPAHИЦY.
C*    CALL STROUT('SKIP',0) -
C*    - BЫXOД HA ЛEBYЮ ПOЛYCTPAHИЦY.
C*
C*******************************************
C*
  *TITLE*:LC,BLOCK,LTIT,MTIT
  A/I0:,LC,1
  TEROUT:,SUBP,
 PRINT8 :,SUBP,
  INTER:,SUBP,
  KEY  :,SUBP,
C
C---
C
  B:8,BASE,B
  ,STI,14
  ,STI,12
  ,ITA,13
  14,XTS,
  ,AEX,A/I0
  ,U1A,BUF
  14,VTM,-2
  LOOP:14,XTA,PAR+2
  12,AEX,
  14,UZA,SW+2
  14,VLM,LOOP
  ,UJ,RET
C---
  SW:13,VTM,TODIS
  ,UJ,INTER
  :,XTA,N2
  ,AEX,=1
  :,ATX,FSCIP
  ,XTA,N2
  ,AOX,CLIN
  ,UZA,RET
  9,VTM,
  13,VTM,SKIP
  SKIP:,XTA,N2
  ,AEX,FSCIP
  ,AOX,CLIN
  ,U1A,STRIN
C---
  RET:15,WTC,
  ,UJ,
C---
  TODIS:,ATX,FDIS
  ,UJ,RET
C---
  BUF:,ATX,LEN
  ,ITA,12
  ,ATX,ASTR
  ,XTA,CLIN
  ,U1A,BUF2
  ,XTA,FDIS
  ,AEX,A/I0
  ,UZA,BUF1
  ,WTC,LTIT
  9,VTM,
  12,VTM,MTIT
  13,VJM,SDIS
C---
  BUF1:12,VTM,MTIT
  ,WTC,LTIT
  9,VTM,
  13,VJM,STRIN
  14,VTM,=6
  ,ITA,14
  ,CALL,KEY
  ,UZA,BUF2
  ,XTA,A/I0
  ,AEX,FDIS
  ,ATX,FDIS
C---
  BUF2:,XTA,FDIS
  ,AEX,A/I0
  ,UZA,BUF3
  ,WTC,LEN
  9,VTM,
  ,WTC,ASTR
  12,VTM,
  13,VJM,SDIS
C---
  BUF3:,WTC,LEN
  9,VTM,
  ,WTC,ASTR
  12,VTM,
  13,VTM,RET
  ,UJ,STRIN
C---
C
C........ BЫДAЧA HA ЭKPAH
C
  SDIS:,ITS,13
  9,VZM,SDIS2
  9,MTJ,14
  9,UTM,-10
  ,ITS,9
  ,ASN,64+10
  ,UZA,SDIS1
  13,VJM,TEROUT+2.*****
  SDIS2:,STI,13
  13,UJ,
  SDIS1:14,VTM,10
  13,VJM,TEROUT+2.*****
  ,STI,13
  ,UJ,SDIS
C
C
C.......... БYФEPИЗAЦИЯ БИЛИCTA
C
  STRIN:,ITS,13
  ,XTS,CLIN
  STRIN1:,AEX,=77
  ,ARX,N2
  15,ATX,
  ,ASN,64-1
  15,ATX,
  ,ASN,64-2
  15,ARX,
  15,ARX,.*11
  15,MTJ,10
  ,ATI,15
  15,UTM,M
  15,MTJ,11
  14,VTM,-9
  ,WTC,N2
  13,VTM,
  ,XTA,=6H    ''''
  13,VIM,TRAN
  ,ASN,64-16
  ,WTC,CLIN
  13,VTM,
  13,VIM,TRAN
  ,XTA,=6H1 ''''''''
C---
  TRAN:12,XTS,
  9,VIM,ETRAN
  9,VTM,1
  ,XTA,=6H
  ETRAN:9,UTM,-1
  12,UTM,1
  14,VLM,TRAN
  ,XTS,N2
C---
  ,UZA,NOPR
  10,MTJ,15
  11,UTM,-11
  ,ITS,11
  11,UTM,21
  ,ITS,11
  ,XTS,
  ,CALL,PRINT8
C---
  NOPR:,XTA,CLIN
  ,ARX,=1
  ,AAX,=77
  ,ATX,CLIN
  ,U1A,SAMPP
  ,XTA,N2
  ,AEX,=1
  ,ATX,N2
C---
  SAMPP:10,MTJ,15
  9,VZM,RESTR
  ,XTA,CLIN
  ,U1A,STRIN1
  ,ITA,12
  12,VTM,MTIT
  ,ITS,9
  ,WTC,LTIT
  9,VTM,
  13,VJM,STRIN.PEKYPCИBHO
  ,STI,9
  ,STI,12
  ,STI,13
  ,UJ,STRIN
C---
  RESTR:,STI,
  ,STI,13
  13,UJ,
C
C-------------------------
C
  PAR:,ISO,18HDISPL PAGE  SKIP
  FDIS:,INT,0
  CLIN:,LOG,
  N2  :,LOG,
  FSCIP:,BSS,1
  ASTR :,BSS,1
  LEN  :,BSS,2
  M    :,BSS,716.БYФEP
  ,END,
      STRPRN     :,NAME,
      FT*571     :,SUBP,
      FT*002     :,SUBP,
      FT*003     :,SUBP,
            14 ,  VTM,   *00001
                 , UJ,   *00016
 *00001    :14 ,  VTM,   *00027
                 ,ITS,  14
            13 ,  VJM,  FT*571
             7 ,  XTA,
             7 ,  ATX,  2
                 ,NTR,  3
                 ,NTR,  22B
 *00005    :     ,WTC,   BSS+ 0000B
             1 ,  VTM,
                 ,WTC,   BSS+ 0001B
             1 ,  UTC,  77777B
            14 ,  VTM,
                 ,ITS,  14
            13 ,  VJM,  FT*002
             7 ,  XTA,  2
                 ,NTR,  3
             7 ,  A+X,
             7 ,  ATX,  2
             7 ,  X-A,  1
                 ,NTR,  22B
                 ,UZA,   *00005
            13 ,  VJM,  FT*003
                 , UJ,   *00024
                 ,UTC,
 *00016    : 7 ,  MTJ,  8
            14 ,  MTJ,  10
             7 ,  VTM,   *00031
             7 ,  STX,  3
                 ,ITS,  13
                 ,ITS,  1
                 ,ITS,  8
                 ,ITS,
                 ,NTR,  3
                 ,NTR,  2
            10 ,   UJ,
                 ,UTC,
 *00024    :     ,STI,
                 ,STI,  7
                 ,STI,  1
                 ,STI,  8
             8 ,   UJ,
                 ,UTC,
 *00027    :,     LOG,  12030530 13030463.
            ,     LOG,  20233054 20231051.
 *00031    :,     LOG,  64000000 00000001.
            ,     LOG,  64000000 00000016.
 BSS       :     ,BSS,  2
      ,END,
 SWOP:,NAME,
C*
C*    ЭTA ПOДПPOГPAMMA BEЗ ПAPAMETPOB
C*    OPГAHИЗYET YПPЯTЫBAHИE ИCПOЛЬЗYЮЩEЙ
C*    EE ЗAДAЧИ HA ЛEHTY C MAT. HOMEPOM 55
C*    C ПOCЛEДYЮЩИM ПPOДOЛЖEHИEM CЧETA.
C*
C*    ДЛЯ ПOBTOPHOГO ЗAПYCKA ПOCЛE CБOЯ ЭBM
C*    TPEБYETCЯ ЗAПYCTИTЬ CЛEДYЮЩИЙ ПAKET:
C*    *NAME
C*    *TIME:
C*    *TAPE:<ИMЯ>,55,W
C*    *CALL FICMEMOR(ECЛИ БЫЛO)
C*    *MAIN RESTOR
C*    *EXECUTE
C*    ZZZ
C*    *END FILE
C*    ЗДECЬ ZZZ HOMEP ЗOHЫ,KYДA БЫЛO
C*    ПOCЛEДHEE YПPЯTЫBAHИE
C*
 RFMRTFLG:LC,BLOCK,F
 LIST:,WEQ,43B
 N:,P/P,(LIST)16
 B48:,EQU,700B
 *120:B,BLOCK,R(9),SCP,SCD(24),FLD,INFR(0)
 ,CONT,INFW,CODE
 12,VTM,SWOP
 ,UJ,CHEKD
 RESTOR:,ENTRY,
 12,VTM,REST
C    ПPOBEPKA BEPCИИ CИCTEMЫ
 CHEKD:8,BASE,*
 ,*63,522B
 12,UZA,.XOPOШAЯ
 ,*64,ERR
 ,XTA,=1.ПЛOXAЯ
 12,UJ,
C     БЛOK YПPЯTЫBAHИЯ
 SWOP:13,U1A,
 ,ITA,15
 15,VTM,R
 14,VTM,-6
 SR:14,ITS,7
 14,VLM,SR
 ,ITS,13
 ,XTS,
 11,VTM,-38
C     TPAKTЫ MБ YПPЯTЫBAЮTCЯ TOЛЬKO
C     ПPИ ПEPBOM OБPAЩEHИИ.
 ,XTS,FLD
 ,WTC,R
 15,VTM,
 ,U1A,SP1
C      CПACEHИE OБMEHHOГO ЛИCTA
 ,XTA,F
 ,ARX,SAVP
 ,ATX,W
 ,AOX,=:001
 ,ATX,RN
 ,*70,W
C     ЗAПPOC ШKAЛЫ ИCПOЛЬЗOBAHHЫX TPAKTOB
 ,*72,GIVD
 9,VTM,-23.ЦИKЛ MБ
 10,VTM,-31.ЦИKЛ TPAKTOB
 SD:10,*63,B48+31
 9,AAX,SCD+23
 ,UZA,ESD
C     YПPЯTЫBAHИE OДHOГO TPAKTA
 9,MTJ,14
 14,UTM,23
 ,ITA,14
 ,ASN,64-12
 10,MTJ,14
 14,UTM,31
 ,ITS,14
 15,AOX,
 ,AOX,RP
 ,ATX,W
 ,*70,W
 ,XTA,INFW
 ,AOX,WP
 ,ATX,W
 ,*70,W
C     K CЛEДYЮЩEЙ ЗOHE MЛ
 ,XTA,INFW
 ,ARX,=1
 ,ATX,INFW
C     KOHEЦ ЦИKЛA MБ
 ESD:10,VLM,SD
 10,VTM,-31
 9,VLM,SD
C     BOCCTAHOBЛEHИE OБM.ЛИCTA
 ,*70,RN
C     ЗAПOMИHAEM HAЧAЛO MECTA,ГДE CПACAEM ЛИCTЫ
 ,XTA,INFW
 ,ATX,FLD
 SP1:,XTA,INFW
 ,ATX,ZONA
 ,ARX,=1
 ,ATX,INFW
C     ЦИKЛ CПACEHИЯ ПAMЯTИ
 SP:11,*50,70130B+39
 ,ASN,64+30.ЛИCT
 ,UZA,ESP.ЧYЖOЙ
 ,AEX,=400000
 ,UZA,ESP.HE HYЖEH
 11,MTJ,9
 9,UTM,39
 9,MTJ,10
 ,ITA,9
 ,AAX,=40
 ,UZA,MP
C     ФOPMAЛЬHЫЙ ЛИCT
 ,ITA,9
 ,ASN,64-30
 ,AOX,=:10010077
 ,ATX,INF72
 10,VTM,1
 ,*72,INF72
C     MAT. LIS
 MP:,ITA,10
 ,ASN,64-30
 ,AOX,INFW
 ,ATX,W
 ,*70,W
 ,ITA,9
 ,AAX,=40
 ,UZA,MP1
 ,XTA,2000B.ФOPM.
 ,*72,INF72.ЛИCT
 MP1:,XTA,INFW
 ,ARX,=1
 ,ATX,INFW
C     B ШKAЛY YПPЯTAHHЫX ЛИCTOB
 11,*63,B48+39
 ,AOX,SCP
 ,ATX,SCP
C     KOHEЦ ЦИKЛA ПO ЛИCTAM
 ESP:11,VLM,SP
 ,*70,ZONA
 ,*50,71B
 ,*64,END
C     BЫЧИCЛEHИE AДPECA YПPЯTЫBAHИЯ ДЛЯ CЛEДYЮЩEГO BXOДA
 ,XTA,ZONA
 ,AEX,FLD
 ,UZA,MOVE.ДAЛЬШE
 ,XTA,FLD.БЛИЖE
 ,ATX,INFW
C     ПOДBOД K MECTY CЛEДYЮЩEГO YПPЯTЫBAHИЯ
 MOVE:,XTA,INFW
 ,AOX,=:003
 ,ATX,W
 ,*70,W
 13,UJ,
C     BXOД ДЛЯ BOCCTAHOBЛEHИЯ
 REST:,UZA,REST1
 ,SJ,
 REST1:14,VTM,R
 ,ITS,14
 8,MTJ,1
 ,CALL,READ*
 1,MTJ,8
 ,XTA,R
 ,APX,=6H'7''7''7'
 ,ASN,64+39
  ,AOX,INFR
  ,AOX,RP
C---  ЧTEHИE 0-ГO ЛИCTA
  ,ATX,RN
  ,*70,RN
  14,VTM,R-FLD
  ,XTA,RN
  ,AEX,WP
  ,ATX,RN
  ,UTC,LIST
  ,XTA,CODE
  ,AEX,CODE
  ,UZA,RD1
  ,*64,ERR1
  ,SJ,
  RD1:,UTC,LIST
  14,XTA,FLD
  14,ATX,FLD
  14,VLM,RD1
C---  ЦИKЛ BOCCTAHOBЛEHИЯ MБ
  9,VTM,-23
  10,VTM,-31
  RD:10,*63,B48+31
  9,AAX,SCD+23
  ,UZA,ERD
  ,XTA,INFR
  ,AOX,RP
  ,ATX,W
  ,*70,W
  ,XTA,INFR
  ,ARX,=1
  ,ATX,INFR
  9,MTJ,14
  14,UTM,23
  ,ITA,14
  ,ASN,64-12
  10,MTJ,14
  14,UTM,31
  ,ITS,14
  15,AOX,
  ,AOX,WP
  ,ATX,W
  ,*70,W
  ERD:10,VLM,RD
  10,VTM,-31
  9,VLM,RD
C---  BOCCTAHOBЛEHИE ЛИCTOB C 1-ГO
  11,VTM,-38
  ,XTA,RN
  ,ARX,=1
  ,ATX,INFR
  RL:11,*63,B48+39
  ,AAX,SCP
  ,UZA,ERL
  11,MTJ,9
  9,UTM,39
  9,MTJ,10
  ,ITA,9
  ,AAX,=40
  ,UZA,RMP
C---  ФOPMAЛЬHЫЙ ЛИCT
  ,ITA,9
  ,ASN,64-30
  ,AOX,=:10010077
  ,ATX,INF72
  10,VTM,1
  ,*72,INF72
  RMP:,ITA,10
  ,ASN,64-30
  ,AOX,INFR
  ,ATX,W
  ,*70,W
  ,ITA,9
  ,AAX,=40
  ,UZA,RMP1
  ,XTA,2000B
  ,*72,INF72
  RMP1:,XTA,INFR
  ,ARX,=1
  ,ATX,INFR
  ERL:11,VLM,RL
C---  BOCCTAHOBЛEHИE PEГИCTPOB
  ,WTC,R
  15,VTM,
  14,VTM,-6
  RR:14,XTA,R+7
  14,ATI,7
  14,VLM,RR
C---  BOCCTAHOBЛEHИE 0-ГO ЛИCTA
  ,XTA,KOM1
  15,CTX,2
  ,XTA,KOM2
  15,CTX,3
  ,XTA,KOM3
  15,CTX,4
  ,NTR,6
  15,UJ,2
  KOM1:,*70,RN
  KOM2:,XTA,FLD
  ,ATX,INFW
  KOM3:,WTC,R+8
  ,UJ,
C---  ДИAГHOCTИKA:
  ERR:,Z00,T1
  ,Z00,T1
  ,002,
  8,,
  T1:,GOST,18HCИCTEMA CTAPOBATB'231'
  ERR1:,Z00,T2
  ,Z00,T2
  ,002,
  8,,
  T2:,GOST,16HHE C TOГO MECTA'231'
  END:,Z00,T3
  ,Z00,ZONA
  ,002,
  ,,
  2,031,3
  8,,
  T3:,GOST,22H***YПPЯTAЛИCЬ B ЗOHY-'231'
  ZONA:,LOG,
  GIVD:8,Z20,
  ,Z01,SCD
  SAVP:,000,N
  ,007,
  RP:,010,N
  ,000,
  WP:,000,N
  ,000,
  INF72:,BSS,1
  RN:,BSS,1
  W:,BSS,1
  ,DATA,
  CONST:,LOG,
  ,LOG,550000
  ,ISO,6HWORKIN
  :3,SET,CONST
  1,,FLD
  ,END,
 TABLE*EC:,NAME,
 *TIKTAK*:,LC,25
 MONCARD/:,LC,14
 PRINT8//:,SUBP,
 ,STI,11.SERV
 ,ATI,12.ACARD
 ,ITA,13
 14,VTM,-9
 B:14,ITS,10.MOD 1-10
 14,VLM,B
 ,ITS,
 6,BASE,B
  11,MTJ,7.SERV
 12,MTJ,8.ACARD
 ,XTA,NNN
 ,U1A,ACA
 ,CALL,SAVEMON/
 10,VTM,
 ,CALL,PARAMT*
 10,VTM,3
 ,CALL,PARAMT*
 ,CALL,SAVEMON/
 11,VZM,ACA
 ,XTA,=1
 ,ATX,TAB
 ACA:,XTA,CCC
 ,U1A,ACA1.ECTЬ C:
 8,XTA,
 ,AEX,=6HC:
 ,AAX,=:77777 4
 ,U1A,ACA2.HE C:
 14,VTM,-13
 ACA*:8,UTC,
 14,XTA,13
 14,ATX,C2T+13
 14,VLM,ACA*
 ,ATX,CCC
 ,UJ,RETURN
 ACA2:,BSS,
 ,XTA,TAB
 ,UZA,RETURN.TABLE
 ,UJ,RETUR .SUBP
 ACA1:,XTA,
 ,ATX,CCC
      ,XTA,TAB
 ,UZA,TABLE
 ,UJ,SUBP
 RETUR:,ITS,8
 7,UTC,
 13,VJM,.CT.CEPBИC
 RETURN:,STI,
 14,VTM,10
 :14,STI,.REG 1-10
  14,UTM,-1
 14,V1M,*-1
 ,STI,13
 13,UJ,
C OБPAБOTKA ПAPЫ CTPOK
 SUBP:,BSS,
 ,XTA,NNN
 13,VJM,NNNCOD
 13,VJM,TOSET
 13,VJM,BEGINCD
  5,VTM,-4
 4,VTM,STROKA+4
 3,VTM,SIM0
 Q*:13,VJM,PARA
 3,UTM,1
 4,UTM,2
  5,VLM,Q*
 1,VTM,STROKA
 2,VTM,C2T
 ,XTA,=6HC:
 2,ATX,
 ,XTA,SIMB
 ,ASN,64-16
 1,XTS,3
 ,ASN,64+8
 ,AAX,=1 77777
 15,AOX,
 ,AOX,=6H  '0''0''0''0'
 2,ATX,1
 1,XTA,4
 ,ASN,64-16
 ,AOX,=6H  '0''0'
 2,ATX,3
 1,XTA,6
 ,ASN,64-32
 1,AOX,8
 2,ATX,4
 1,XTA,10
 ,ASN,64-16
 ,AOX,=6H  '0''0'
 2,ATX,5
 1,XTA,12
 ,ASN,64-32
 ,AOX,=6H'0''0'
 2,ATX,6
 8,MTJ,1
 ,ITS,2
 7,UTC,
 13,VJM,.C:
 1,MTJ,8
 ,XTA,NNN
 ,ARX,=1
 ,ATX,NNN
 ,AEX,=400
 ,U1A,RETUR
 ,UJ,RETUR
C   OБPAБOTKA ПAPЫ CTPOK
 TABLE:,BSS,
 ,XTA,NNN
 ,U1A,TA.NOT BEGIN
C   ПEЧATЬ ЗAГOЛOBKA
 13,VJM,PRINT8//+2.NEW PAGE
 14,VTM,PRIL
 ,ITS,14
 14,UTM,1
 ,ITS,14
 14,VTM,50
 ,ITS,14
 ,CALL,PRINT8//
 13,VJM,BLANKS
 14,VTM,ZAG1
 ,ITS,14
 14,VTM,ZAG1+2
 ,ITS,14
 14,VTM,26
 ,ITS,14
 ,CALL,PRINT8//
 14,VTM,ZAG2
 ,ITS,14
 ,ITS,14
 14,VTM,26
 ,ITS,14
 ,CALL,PRINT8//
 14,VTM,ZAG3
 ,ITS,14
 14,VTM,ZAG3+4
 ,ITS,14
 14,VTM,17
 ,ITS,14
 ,CALL,PRINT8//
 13,VJM,BLANKS
 13,VJM,BLANKS
 T:,BSS,
 ,XTA,NNN
 13,VJM,NNNCOD
 14,VTM,STROKA+2
 ,ITS,14
 14,VTM,STROKA+3
 ,ITS,14
 14,VTM,52
 ,ITS,14
 ,CALL,PRINT8//
 ,XTA,NNN
 ,ARX,CN48
 ,ATX,R
 ,AAX,=400
 ,UZA,T*
 ,ATX,R.FINAL PAGE
 T*:,XTA,R
 ,ARX,=377
 ,AAX,=377
 13,VJM,NNNCOD
 14,VTM,STROKA+2
 ,ITS,14
 14,UTM,1
 ,ITS,14
 14,VTM,52
 ,ITS,14
 ,CALL,PRINT8//
  :13,VJM,MINUS
 14,VTM,S1
 13,VJM,LONGS
 14,VTM,S2
 13,VJM,LONGS
 13,VJM,MINUS
 13,VJM,BLANKS
 TA:,XTA,N48
 ,AEX,CN48
 ,U1A,TA2.NON NEW PAGE
 ,ATX,N48
 13,VJM,BLANKS.KOHEЦ PAGE
 13,VJM,MINUS
 13,VJM,PRINT8//+2.BEGIN PAGE
 12,VTM,-6
 TA1:13,VJM,BLANKS
 12,VLM,TA1
 ,UJ,T
 TA2:,BSS,
 ,XTA,=6H'0'
 ,ATX,STROKA
 13,VJM,TOSET
 ,XTA,SIMB
 ,ASN,64-8
 ,AEX,=40
 ,ATX,STROKA+1
 ,XTA,NNN
 13,VJM,NNNCOD
 13,VJM,BEGINCD
  5,VTM,-4
 4,VTM,STROKA+4
 3,VTM,SIM0
 Q:13,VJM,PARA
 3,UTM,1
 4,UTM,2
  5,VLM,Q
 14,VTM,STROKA
 ,ITS,14
 14,UTM,13
 ,ITS,14
 ,XTS,=6
 ,CALL,PRINT8//
 ,XTA,NNN
 ,ARX,=1
 ,ATX,NNN
 ,XTA,N48
 ,ARX,=1
 ,ATX,N48
 ,XTA,NNN
 ,AEX,=400
 ,U1A,RETURN
 ,ATX,N48
 ,ATX,TAB
 13,VJM,BLANKS
 13,VJM,MINUS
 13,VJM,PRINT8//+2
 ,UJ,RETURN
 NNNCOD:,ATX,R
 ,ITA,13
 ,XTS,R
 ,ASN,64-40
 ,AUX,=6H'0''0''0''3''7''7'
 ,AOX,=6H'0''0''0'000
 ,ATX,STROKA+2
 ,XTA,R
 13,CALL,BYTE/R16
 ,ASN,64-8
 ,AOX,=40
 ,AAX,=6H'0''0' '377''377'
 ,STX,STROKA+3
 ,ATI,13
 13,UJ,
 TO SET:,BSS,
C   PAЗBEPTKA KAPTЫ C:
 ,XTA,C2T
 ,AEX,=6HC:
 ,U1A,TOS*.KOPOTKИЙ ФOPMAT
 ,XTA,C2T+1
 ,AEX,=6H
 ,AAX,=:77777 4
 ,U1A,TOS*.KOPOTKИЙ ФOPMAT
 ,XTA,C2T+1
 ,ASN,64+16
 ,AAX,=1 77777
 ,ATX,SIMB
 ,XTA,C2T+3
 ,ASN,64+24
 ,AAX,=377
 ,ATX,SIM0
 ,XTA,C2T+4
 ,ASN,64-8
 ,YTA,
 ,ATX,SIM0+1
 ,XTA,C2T+4
 ,ASN,64+8
 ,AAX,=377
 ,ATX,SIM0+2
 ,XTA,C2T+5
 ,ASN,64+24
 ,AAX,=377
 ,ATX,SIM0+3
 ,XTA,C2T+6
 ,ASN,64-8
 ,YTA,
 ,ATX,SIM0+4
 13,UJ,
 TOS*:,XTA,C2T.KOPOTKИЙ ФOPMAT
 ,ASN,64-16
 ,ATX,R
 14,VTM,-3
 TOS:,XTA,R
 ,ASN,64-8
 ,ATX,R
 ,YTA,
 14,ATX,SIM0+3
 14,VLM,TOS
 ,XTA,C2T+1
 ,ASN,64-8
 ,ATX,R
 ,YTA,
 ,ATX,SIM0+4
 ,XTA,R
 ,ASN,64-16
 ,YTA,
 ,ATX,SIMB
 13,UJ,
 RSIM:,BSS,
C ЧTEHИE CИMBOЛA
 14,VTM,40B.BLANK
 13,UTC,
 2,VZM,
 2,UTM,1.N SIM+1
 ,ITA,2
 ,AEX,=111.73
 ,U1A,RSIM/
 2,VTM,
 13,UJ,
 RSIM/:,BSS,
 ,XTA,WORD
 ,UZA,FINR
 ,ASN,64-8
 ,ATX,WORD
 ,YTA,
 ,ATI,14
 ,ATX,SIM
 13,UJ,
 FINR:1,UTM,1
 1,XTA,
 ,ATX,WORD
 ,UJ,RSIM/
 BEGINCD:,BSS,
C   ПOДBOД K ПEPBOЙ ЦИФPE
C   KAPTЫ ,OCT,
 8,MTJ,1.ACARD
 ,ITA,13
 1,XTS,
 ,ATX,WORD
 2,VTM,1.N SIM
 12,VTM,-1
 BG:13,VJM,RSIM
 14,UTM,-54B.,
 14,V1M,BG
 12,VLM,BG
 ,STI,
 ,ATI,13
 13,UJ,
 PARA:,BSS,
C ФOPMИPOBAHИE ПAPЫ CЛOB
C ДЛЯ ДAHHOГO TИПA ЭBM
C REG3-AДPEC ГPAФ.CИMBOЛA
C REG4-AДPEC ПAPЫ CЛOB
 ,XTA,=6H'0''0'
 4,ATX,
 ,XTA,=6H'0''0''0'
 4,ATX,1
 13,UTC,
 2,VZM,
 ,ITA,13
 ,XTS,
 ,ATX,R
 12,VTM,-2
 PARA1:,BSS,
 2,VZM,PARA3
 13,VJM,RSIM
 14,UTM,-40B
 14,VZM,PARA1
 ,XTA,R
 ,ASN,64-8
 ,AEX,SIM
 ,ATX,R
 12,VLM,PARA1
 ,AEX,=6H'0''0''0'000
 ,UZA,PARA3
 ,XTA,R
 4,ATX,1
 ,AAX,=6H'0''0''0''4''0''0'
 ,ATX,R
 ,UZA,PARA2
 ,XTA,=56..
 ,ATX,R
 PARA2:,BSS,
 3,XTA,
 ,ASN,64-8
 ,AOX,=6H'0''0'  '0'
 ,AOX,R
 4,ATX,
 PARA3:,STI,
 ,ATI,13
 13,UJ,
 BLANKS:14,VTM,=6H
C   ПEЧATЬ CTPOKИ ПPOБEЛOB
 BLA:,BSS,
 ,ITS,14
 BLA1:,BSS,
 ,ITS,14
 ,XTS,=6
 ,UJ,PRINT8//
 MINUS:14,VTM,=6H-'7''063'
C   ПEЧATЬ CTPOKИ MИHYCOB
 ,UJ,BLA
 LONGS:,ITS,14
C   ПEЧATЬ ДЛИHHЫX KOHCTAHT
 14,UTM,8
 ,UJ,BLA1
 ZAG1:,ISO,18HT A Б Л И Ц A
 ZAG2:,ISO,6H-'7''14'
 ZAG3:,ISO,15HПEPEKOДИPOBKИ B
 ,CONT,15H KOД ISO БЭCM-6
 S1:,ISO,17H БЭCM-6
 ,CONT,2H
 ,CONT,12HEC     CM
 ,CONT,15HEC-1010 M-6000
 ,CONT,6HEC N4
 S2:,ISO,15H   ISO   8  16
 ,CONT,2H
 ,CONT,14HEBCDIC  ASCII
 ,CONT,14HEBCDIC  -ASCII
 ,CONT,7H
 PRIL:,ISO,12HПPИЛOЖEHИE I
 CN48:,LOG,60.PAGE LONG
 NNN:,BSS,1
 N48:,BSS,1
 TAB:,BSS,1
 CCC:,BSS,1
 SIM0:,BSS,5
 SIMB:,BSS,1
 R:,BSS,1
 SIM:,BSS,1
 WORD:,BSS,1
 C2T:,BSS,14.FOR C:
 STROKA:,BSS,15.FOR DATA
 ,END,
 TABLE*SS:,NAME,
C ПOЛYЧEHИE TEKCTOB П/П (S/S)
C ПEPEKOДИPOBKИ:
C *U:TABLE*SS:FROMISO,TOISO,COMP
 *MONCRD*:,LC,12
 PRINT8//:,SUBP,
 TABSIMEC:,SUBP,
 ,STI,11.SERV
 ,ATI,12.ACARD
 ,ITA,13
 14,VTM,-9
 B:14,ITS,10.MOD 1-10
 14,VLM,B
 ,ITS,
 1,VTM,.FROMISO=0
 2,VTM,.TOISO=0
 4,VTM,*MONCRD*
 5,BASE,B
 12,MTJ,6.ACARD
 11,MTJ,7.SERV
C OБECПEЧEHИE PAБOTЫ TOЛЬKO
C ПPИ (ACARD)=*READ OLD
C (ПPOЧИE ПEPEДAЮTCЯ HA CT.CEPBИC)
 6,XTA,
 ,AEX,=6H*READ
 ,U1A,RETUR
 6,XTA,1
 ,AEX,=6HOLD
 ,U1A,RETUR
C PAЗБOP ПAPAMETPOB
 ,CALL,SAVEMON/
 10,VTM,
 ,CALL,PARAMT*
 10,VTM,3
 ,CALL,PARAMT*
 11,VZM,RETUR.PARAMETRS ABSENT
 14,V1M,ERROR
 10,VTM,3
 ,CALL,PARAMT*
 14,V1M,ERROR
 12,VZM,B2.PAR1 ABSENT
C ПEPBЫЙ ПAPAMETP
 4,XTA,
 ,ATX,ID1
 4,XTA,1
 ,ATX,ID1+1
 1,VTM,FROMISO
 B2:11,VZM,PFIN
 10,VTM,3
 ,CALL,PARAMT*
 14,V1M,ERROR
 12,VZM,B3.PAR2 ABSENT
C BTOPOЙ ПAPAMETP
 4,XTA,
 ,ATX,ID2
 4,XTA,1
 ,ATX,ID2+1
 2,VTM,TOISO
 B3:11,VZM,PFIN
 10,VTM,3
 ,CALL,PARAMT*
 14,V1M,ERROR
 12,VZM,PFIN.PAR3 ABSENT
C TPETИЙ ПAPAMETP
 14,VTM,-4
 BB:4,XTA,
 14,AEX,TABEVM+4
 ,UZA,BB1
 14,VLM,BB
 ,UJ,ERROR
 BB1:14,UTM,4
 PFIN:,BSS,
C TAБЛИЦЫ ПEPEKOДИPOBKИ
 1,MTJ,8.FROMISO/ZERO
 2,MTJ,9.TOISO/ZERO
 ,CALL,ISO*EC
 ,XTA,=1
 ,CALL,SAVEMON/
 1,VZM,PP.PAR1 ABSENT
 1,VTM,ID1
 4,VTM,200B
 13,VJM,SUBP.FROMISO TEXT
 PP:2,VZM,RETUR.PAR2 ABSENT
 1,VTM,ID2
 4,VTM,400B
 13,VJM,SUBP
 RETUR:,ITS,6.ACARD
 7,UTC,
 13,VJM,.CT.CEPBИC
 ,STI,
 14,VTM,10
 :14,STI,
 14,UTM,-1
 14,V1M,*-1
 ,STI,13
 13,UJ,
 ERROR:14,VTM,ETEXT
 ,ITS,14
 14,UTM,5
 ,ITS,14
 ,ITS,
 13,VTM,RETUR
 ,UJ,PRINT8//
C ПPOЦEДYPA ПOЛYЧEHИЯ TEXTA П/П
 SUBP:,BSS,
 ,ITA,13
 1,XTS,.OФOPMЛEHИE NAME
 ,ASN,64+8
 ,AEX,=:1.BLANK
 ,ATX,NAME
 1,XTA,
 ,ASN,64-40
 1,XTS,1
 ,ASN,64+8
 15,AEX,
 ,ARX,=6H'0''0''0''032''0''0'
 ,ATX,NAME+1
 14,VTM,NAME
 ,ITS,14
 7,UTC,
 13,VJM,.CT.CEPBИC
 QBSS:,EQU,ID1
 ,XTA,
 ,ATX,QBSS.QBSS=0
 3,VTM,FROMISO.FROMISO/TOISO
 ,ITA,4
 ,AEX,=200
 ,UZA,S.FROMISO
 3,VTM,TOISO.TOISO
 S:,BSS,.OФOPMЛEHИE KOHCTAHT
 3,XTA,
 ,U1A,S1.NONZERO
 ,XTA,QBSS
 ,ARX,=1
 ,ATX,QBSS.QBSS=QBSS+1
 ,UJ,S2
 S1:13,VJM,UBSS.OБ-KA QBSS
 3,XTA,.OФOPMЛEHИE LOG
 ,ASN,64-39
 ,AUX,=6H'7''7''7'
 ,AOX,=6H000
 ,ATX,LOG+1
 14,VTM,LOG
 ,ITS,14
 7,UTC,
 13,VJM,.CT.CEPBИC
 S2:3,UTM,1
 4,UTM,-1
 4,V1M,S.NONFINISH
 13,VTM,SFIN
 UBSS:,XTA,QBSS
 13,UZA,
 ,ASN,64-39
 ,AUX,=6H'7''7''7'
 ,AOX,=6H000
 ,ARX,=6H'0''0''0''042''0''0'.B
 ,ATX,BSS+2
 ,XTA,
 ,ATX,QBSS.QBSS=0
 14,VTM,BSS
 ,ITS,14
 7,UJ,.CT.CEPBИC
 SFIN:14,VTM,END
 ,STI,
 ,ATI,13
 ,ITS,14
 7,UJ,.CT.CEPBИC
 ETEXT:,ISO,36HHEПPABИЛЬHOE ЗAДAHИE ПAPAMETPOB
 TABEVM:0,ISO,6HEC
 1,ISO,6HCM
 2,ISO,6HEC1010
 3,ISO,6HM6000
 4,ISO,6HECN5
 NAME:,ISO,12H
 ,CONT,71H,NAME,
 ,CONT,1H'12'
 LOG:,ISO,83H ,LOG,
 ,CONT,1H'12'
 BSS:,ISO,83H ,BSS,
 ,CONT,1H'12'
 END:,ISO,83H ,END,
 ,CONT,1H'12'
 ID1:,BSS,2
 ID2:,BSS,2
 FROMISO:,BSS,200B
 TOISO:,BSS,400B
 ,END,
 TABSIMEC:,NAME,
C---TAБЛИЦA ДЛЯ ПEPEBOДA ИЗ  PAЗHЫX EC ЭBM:
C         EC,CM,EC-1010,M-6000
C   B KOД ISO БЭCM-6;
C   ДEBЯTЫЙ PAЗPЯД KOДA=1-HE OCHOBHOE
C   ПPEДCTABЛEHИE KOДA
C--------------------------------------
C      Б-6         EC  CM  R10 M-6 EC5
C--------------------------------------
C:        00
 ,OCT,
C:        01
 ,OCT,
C:        02                    @
 ,OCT,000 000 000 100
C:        03
 ,OCT,
C:        04
 ,OCT,000 000 000 040
C:      '.05
 ,OCT,
C:        06                    Ю
 ,OCT,000 000 000 140
C:        07
 ,OCT,
C:        08
 ,OCT,
C:        09
 ,OCT,
C:        0A                    P
 ,OCT,000 000 000 120
C:        0B
 ,OCT,
C:        0C                    0
 ,OCT,000 000 000 060
C:        0D
 ,OCT,
C:        0E                    П
 ,OCT,000 000 000 160
C:        0F
 ,OCT,
C:      '.10
 ,OCT,
C:        11
 ,OCT,
C:        12                    H
 ,OCT,000 000 000 110
C:        13
 ,OCT,
C:        14                    (
 ,OCT,000 000 000 050
C:        15
 ,OCT,
C:        16                    X.
 ,OCT,000 000 000 530
C:        17
 ,OCT,
C:      #.18
 ,OCT,
C:        19
 ,OCT,
C--------------------------------------
C
C--------------------------------------
C      Б-6         EC  CM  R10 M-6 EC5
C--------------------------------------
C:        1A                    X
 ,OCT,000 000 000 130
C:      '.1B
 ,OCT,
C:        1C                    8
 ,OCT,000 000 000 070
C:        1D
 ,OCT,
C:        1E                    Ь
 ,OCT,000 000 000 170
C:      ^ 1F
 ,OCT,
C:        20
 ,OCT,000 040
C:      ! 21            !
 ,OCT,000 041
C:      " 22            "       D
 ,OCT,000  042 000 104
C:      # 23            #
 ,OCT,000 043
C:      $ 24            $       $
 ,OCT,000 044 000 044
C:      % 25            %
 ,OCT,000 045
C:      & 26            &       Д
 ,OCT,000 046 000 144
C:      ' 27            '
 ,OCT,000 047
C:      ( 28            (
 ,OCT,000 050
C:      ) 29            )
 ,OCT,000 051
C:      * 2A            *       T
 ,OCT,000 052 000 124
C:      + 2B            +
 ,OCT,000 053
C:      , 2C            ,       4
 ,OCT,000 054 000 064
C:      - 2D            -
 ,OCT,000 055
C:      . 2E            .       T.
 ,OCT,000 056 000 524
C:      / 2F            /
 ,OCT,000 057
C:      0 30            0
 ,OCT,000 060
C:      1 31            1
 ,OCT,000 061
C:      2 32            2       L
 ,OCT,000 062 000 114
C:      3 33            3
 ,OCT,000 063
C:      4 34            4       ,
 ,OCT,000 064 000 054
C:      5 35            5
 ,OCT,000 065
C:      6 36            6       Л
 ,OCT,000 066 000 154
C:      7 37            7
 ,OCT,000 067
C--------------------------------------
C
C--------------------------------------
C      Б-6         EC  CM  R10 M-6 EC5
C--------------------------------------
C:      8 38            8
 ,OCT,000 070
C:      9 39            9
 ,OCT,000 071
C:      : 3A            :
 ,OCT,000 072 000 032
C:      ; 3B            ;
 ,OCT,000 073
C:      < 3C            <       <
 ,OCT,000 074 000 074
C:      = 3D            =
 ,OCT,000 075
C:      > 3E            >       Э
 ,OCT,000 076 000 174
C:        3F
 ,OCT,000 077
C:      @ 40            @
 ,OCT,040 100 040
C:      A 41            A
 ,OCT,000 101
C:      B 42            B       B
 ,OCT,000 102 000 102
C:      C 43            C
 ,OCT,000 103
C:      D 44            D       "
 ,OCT,000 104 000 042
C:      E 45            E
 ,OCT,000 105
C:      F 46            F       Б
 ,OCT,000 106 000 142
C:      G 47            G
 ,OCT,000 107
C:      H 48            H
 ,OCT,000 110
C:      I 49            I
 ,OCT,000 111
C:      J 4A        [   J   [   R
 ,OCT,133 112 133 122
C:      K 4B        .   K   .
 ,OCT,056 113 056
C:      L 4C        <   L   <   2
 ,OCT,074 114 074 062
C:      M 4D        (   M   (
 ,OCT,050 115 050
C:      N 4E        +   N   +   P.
 ,OCT,053 116 053 520
C:      O 4F        !   O   !
 ,OCT,041 117 041
C:      P 50        &   P   &
 ,OCT,046 120 046
C:      Q 51            Q
 ,OCT,000 121
C:      R 52            R       J
 ,OCT,000 122 000 112
C:      S 53            S
 ,OCT,000 123
C:      T 54            T       *
 ,OCT,000 124 000 052
C:      U 55            U
 ,OCT,000 125
C:      V 56            V       Й
 ,OCT,000 126 000 152
C--------------------------------------
C--------------------------------------
C      Б-6         EC  CM  R10 M-6 EC5
C--------------------------------------
C:      W 57            W
 ,OCT,000 127
C:      X 58            X
 ,OCT,000 130
C:      Y 59            Y
 ,OCT,000 131
C:      Z 5A        ]   Z   ]   Z
 ,OCT,135 132 135 132
C:      [ 5B        $   [   $
 ,OCT,044 133 044
C:        5C        *       *   :
 ,OCT,052 032 052 072
C:      ] 5D        )   ]   )
 ,OCT,051 135 051
C:        5E        ;   ^   ;   З
 ,OCT,073 037 073 172
C:      _ 5F            _   ^
 ,OCT,037 026 136
C:      Ю 60        -   Ю   -
 ,OCT,055 140 055
C:      A,61        /   A.  /
 ,OCT,057 501 057
C:      Б 62            Б       F
 ,OCT,000 142 000 106
C:      Ц 63            Ц
 ,OCT,000 143
C:      Д 64            Д       &
 ,OCT,000 144 000 046
C:      E.65            E.
 ,OCT,000 505
C:      Ф 66            Ф       Ф
 ,OCT,000 146 000 146
C:      Г 67            Г
 ,OCT,000 147
C:      X.68            X.
 ,OCT,000 530
C:      И 69            И
 ,OCT,000 151
C:      Й 6A            Й   Э   V
 ,OCT,000 152 174 126
C:      K.6B        ,   K.  ,
 ,OCT,054 513 054
C:      Л 6C        %   Л   %   6
 ,OCT,045 154 045 066
C:      M.6D        _   M.  _
 ,OCT,137 515 137
C:      H.6E        >   H.  >   Ж
 ,OCT,076 510 076 166
C:      O.6F            O.
 ,OCT,077 517 077
C:      П 70            П
 ,OCT,000 160
C:      Я 71            Я
 ,OCT,000 161
C:      P.72            P.      N
 ,OCT,000 520 000 116
C:      C.73            C.
 ,OCT,000 503
C:      T.74            T.      .
 ,OCT,000 524 000 056
C:      Y.75            Y.
 ,OCT,000 531
C--------------------------------------
C--------------------------------------
C      Б-6         EC  CM  R10 M-6 EC5
C--------------------------------------
C:      Ж 76            Ж       H.
 ,OCT,000 166 000 510
C:      B.77            B.
 ,OCT,000 502
C:      Ь 78            Ь
 ,OCT,000 170
C:      Ы 79            Ы
 ,OCT,000 171
C:      З 7A        :   З   :
 ,OCT,072 172 072
C:      Ш 7B        #   Ш   #
 ,OCT,043 173 043
C:      Э 7C        @   Э   @   >
 ,OCT,100 174 100 076
C:      Щ 7D        '   Щ   '
 ,OCT,047 175 047
C:      Ч 7E        =   Ч   =   Ч
 ,OCT,075 176 075 176
C:        7F        "       "
 ,OCT,042 177 042
C:        80
 ,OCT,
C:        81
 ,OCT,
C:        82                    A
 ,OCT,000 000 000 101
C:        83
 ,OCT,
C:        84                    !
 ,OCT,000 000 000 041
C:        85
 ,OCT,
C:        86                Ф   A.
 ,OCT,000 000 146 501
C:        87                Г
 ,OCT,000 000 147
C:        88                X.
 ,OCT,000 000 530
C:        89                И
 ,OCT,000 000 151
C:        8A                    Q
 ,OCT,000 000 000 121
C:        8B
 ,OCT,
C:        8C                    1
 ,OCT,000 000 000 061
C:        8D
 ,OCT,
C:        8E                    Я
 ,OCT,000 000 000 161
C:        8F
 ,OCT,
C:        90
 ,OCT,
C:        91                Й
 ,OCT,000 000 152
C:        92                K.  I
 ,OCT,000 000 513 111
C:        93                Л
 ,OCT,000 000 154
C:        94                M.  )
  ,OCT,000 000 515 051
C--------------------------------------
C--------------------------------------
C      Б-6         EC  CM  R10 M-6 EC5
C--------------------------------------
C:        95                H.
 ,OCT,000 000 510
C:        96                O.  И
 ,OCT,000 000 517 151
C:        97                П
 ,OCT,000 000 160
C:        98                Я
 ,OCT,000 000 161
C:        99                P.
 ,OCT,000 000 520
C:        9A                    Y
 ,OCT,000 000 000 131
C:        9B
 ,OCT,
C:        9C                    9
 ,OCT,000 000 000 071
C:        9D
 ,OCT,
C:        9E                    Ы
 ,OCT,000 000 000 171
C:        9F
 ,OCT,
C:        A0
 ,OCT,
C:        A1                Ч
 ,OCT,000 000 176
C:        A2                C.  E
 ,OCT,000 000 503 105
C:        A3                T.
 ,OCT,000 000 524
C:        A4                Y.  %
 ,OCT,000 000 531 045
C:        A5                Ж
 ,OCT,000 000 166
C:        A6                B.  E.
 ,OCT,000 000 502 505
C:        A7                Ь
 ,OCT,000 000 170
C:        A8                Ы
 ,OCT,000 000 171
C:        A9                З
 ,OCT,000 000 172
C:        AA                    U
 ,OCT,000 000 000 125
C:        AB
 ,OCT,
C:        AC                    5
 ,OCT,000 000 000 065
C:        AD
 ,OCT,
C:        AE                    Y.
 ,OCT,000 000 000 531
C:        AF
 ,OCT,
C:        B0
 ,OCT,
C:        B1
 ,OCT,
C:        B2                    M
 ,OCT,000 000 000 115
C:        B3
 ,OCT,
C--------------------------------------
C--------------------------------------
C      Б-6         EC  CM  R10 M-6 EC5
C--------------------------------------
C:        B4                    -
 ,OCT,000 000 000 055
C:        B5
 ,OCT,
C:        B6                    M.
 ,OCT,000 000 000 515
C:        B7
 ,OCT,
C:        B8        Ю
 ,OCT,140
C:        B9
 ,OCT,
C:        BA        Б           ]
 ,OCT,142 000 000 135
C:        BB        Ц
 ,OCT,143
C:        BC        Д           =
 ,OCT,144 000 000 075
C:        BD
 ,OCT,
C:        BE        Ф           Щ
 ,OCT,146 000 000 175
C:        BF        Г
 ,OCT,147
C:        C0                Ш
 ,OCT,000 000 173
C:        C1        A       A
 ,OCT,101 000 101
C:        C2        B       B   C
 ,OCT,102 000 102 103
C:        C3        C       C
 ,OCT,103 000 103
C:        C4        D       D   #
 ,OCT,104 000 104 043
C:        C5        E       E
 ,OCT,105 000 105
C:        C6        F       F   Ц
 ,OCT,106 000 106 143
C:        C7        G       G
 ,OCT,107 000 107
C:        C8        H       H
 ,OCT,110 000 110
C:        C9        I       I
 ,OCT,111 000 111
C:        CA                Ю   S
 ,OCT,000 000 140 123
C:        CB        И       A.
 ,OCT,151 000 501
C:        CC        Й       Б   3
 ,OCT,152 000 142 063
C:        CD                Ц
 ,OCT,000 000 143
C:        CE        Л       Д   C.
 ,OCT,154 000 144 503
C:        CF                E.
 ,OCT,000 000 505
C:        D0                Щ
 ,OCT,000 000 175
C:        D1        J       J
 ,OCT,112 000 112
C:        D2        K       K   K
 ,OCT,113 000 113 113
C--------------------------------------
C--------------------------------------
C      Б-6         EC  CM  R10 M-6 EC5
C--------------------------------------
C:        D3        L       L
 ,OCT,114 000 114
C:        D4        M       M   +
 ,OCT,115 000 115 053
C:        D5        N       N
 ,OCT,116 000 116
C:        D6        O       O   K.
 ,OCT,117 000 117 513
C:        D7        P       P
 ,OCT,120 000 120
C:        D8        Q       Q
 ,OCT,121 000 121
C:        D9        R       R
 ,OCT,122 000 122
C:        DA                    [
 ,OCT,000 000 000 133
C:        DB
 ,OCT,
C:        DC        П           ;
 ,OCT,160 000 000 073
C:        DD        Я
 ,OCT,161
C:        DE                    Ш
 ,OCT,000 000 000 173
C:        DF
 ,OCT,
C:        E0
 ,OCT,000 000  032
C:        E1
 ,OCT,
C:        E2        S       S   G
 ,OCT,123 000 123 107
C:        E3        T       T
 ,OCT,124 000 124
C:        E4        U       U   '
 ,OCT,125 000 125 047
C:        E5        V       V
 ,OCT,126 000 126
C:        E6        W       W   Г
 ,OCT,127 000 127 147
C:        E7        X       X
 ,OCT,130 000 130
C:        E8        Y       Y
 ,OCT,131 000 131
C:        E9        Z       Z
 ,OCT,132 000 132
C:        EA                    W
 ,OCT,000 000 000 127
C:        EB        Y.
 ,OCT,531
C:        EC        Ж           7
 ,OCT,166 000 000 067
C:        ED
 ,OCT,
C:        EE        Ь           B.
 ,OCT,170 000 000 502
C:        EF        Ы
 ,OCT,171
C:        F0        0       0
 ,OCT,060 000 060
C:        F1        1       1
 ,OCT,061 000 061
C--------------------------------------
C--------------------------------------
C      Б-6         EC  CM  R10 M-6 EC5
C--------------------------------------
C:        F2        2       2   O
 ,OCT,062 000 062 117
C:        F3        3       3
 ,OCT,063 000 063
C:        F4        4       4   /
 ,OCT,064 000 063 057
C:        F5        5       5
 ,OCT,065 000 065
C:        F6        6       6   O.
 ,OCT,066 000 066 517
C:        F7        7       7
 ,OCT,067 000 067
C:        F8        8       8
 ,OCT,070 000 070
C:        F9        9       9
 ,OCT,071 000 071
C:        FA        3
 ,OCT,172
C:        FB        Ш
 ,OCT,173
C:        FC        Э
 ,OCT,174 000 000  077
C:        FD        Щ
 ,OCT,175
C:        FE        Ч
 ,OCT,176 000 000 177
C:        FF
 ,OCT,177 000 177
C--------------------------------------
 ,END,
  TAKELIBR:,NAME,
C*
C*******   30.06.81   A.П.CAПOЖHИKOB
C*
C*   USER - SUBROUTINE PEДAKTOPA TEKCTOB
C*   ИЗBЛEЧEHИE ИЗ ФAЙЛA ЧTEHИЯ TOЛЬKO
C*   TEX ПPOГPAMM, KOTOPЫE ПPИCYTCTBYЮT
C*   B ЗAДAHHOЙ ЛИЧHOЙ (OБЩEЙ) БИБЛИOTEKE
C*
C*   OБPAЩEHИE :
C*    *EDIT
C*    *R:<OTKYДA>
C*    *W:<KYДA>
C*    *U:TAKELIBR
C*    =<YK.LIBRARY>
C*    *EE
C*   <YK.LIBRARY> ИMEET BИД: NNZZZ
C*                      ИЛИ  NNZZZZ
C*   ECЛИ OH HE ЗAДAH - ИCПOЛЬЗYEM 67000
C*
C*   B PEЖИME "*NO LIST" ПEЧATЬ ИMEH
C*   ИЗBЛEЧEHHЫX И OTCYTCTBYЮЩИX ПPOГPAMM
C*   БЛOKИPYETCЯ.
C*
C**************************************
C*
  NOLISFL*:,LC,1
  NAME*:,LC,2
  LCAT:PC,BLOCK,CAT(2048)
  N:,P/P,(LCAT)16
  B:8,BASE,B
  ,STX,SERV
  ,ATX,CARD
  ,ATI,14
  ,ITA,13
  ,ATX,RET
  ,XTA,LIB
  ,U1A,CONT
  14,XTA,
  ,ASN,64-8
 ,ATX,LIB
  ,YTA,
  ,ATI,10
  10,UTM,-75B."="
  ,XTA,=67 0000
  10,VIM,IS6
  14,XTA,1
  ,AEX,=6H
  ,ASN,64+40
  ,UZA,IS5
  14,XTA,1
  ,ASN,64-8
  ,YTA,
  ,AOX,LIB
  ,APX,=6H'7''7''7''7''7''7'
  ,ASN,64+30
  IS6:,AOX,RCAT
  15,ATX,2
  ,ARX,RC1
  15,ATX,3
  15,*70,2
  15,*70,3
  ,XTA,=7777 7777 7777 7777
  ,UTC,CAT
  ,ATX,2047
  ,WTC,CARD
  14,VTM,
  ,UJ,CONT
  IS5:,XTA,LIB
  ,APX,=6H'7''7''7''7''7'''
  ,AUX,=77 0777
  ,UJ,IS6
  CONT:14,XTA,
  ,AEX,=6H*READ
  14,XTS,1
  ,AEX,=6HOLD
  15,AOX,
  ,UZA,END
  ,XTA,FWR
  ,UZA,NO W
  ,XTS,CARD
  ,WTC,SERV
  13,VJM,
  NO W:8,BASE,B
  ,XTA,FNAM
  ,U1A,SEND
  ,XTS,CARD
  ,CALL,CHKBEG*
  8,BASE,B
  14,VZM,EXIT
  14,VTM,NAME*
  14,XTA,
  ,ATX,TEX+4
  14,XTA,1
  ,ATX,TEX+5
  ,ITA,14
  ,CALL,ISOTEX
  ,ATX,NAMT
  9,VTM,CAT
  SEAR:9,UTM,2
  9,XTA,1
  ,AEX,=7777 7777 7777 7777
  ,UZA,ABS
  9,XTA,1
  ,ASN,64+15
  ,UZA,SEAR.ENTRY
  9,XTA,
  ,AEX,NAMT
  ,U1A,SEAR
  9,ATX,
  ,XTS,CARD
  ,WTC,SERV
  13,VJM,
  8,BASE,B
  ,XTA,=1
  ABS:,ATX,FWR
  ,XTA,=1
  ,ATX,FNAM
  ,UJ,EXIT
  SEND:,XTS,CARD
  ,CALL,CHKEND*
  8,BASE,B
  14,VZM,EXIT
  ,XTA,
  ,ATX,FNAM
  ,XTA,FWR
  ,UZA,EXIT
  ,XTA,
  ,ATX,FWR
  ,XTA,NOLISFL*
  ,U1A,EXIT
  14,VTM,TEX
  ,ITS,14
  14,UTM,5
  ,ITS,14
  ,XTS,=4
  ,CALL,PRINT8//
  EXIT:,UTC,RET
  ,XTA,
  ,STI,13
  13,UJ,
  END:9,VTM,CAT
  8,BASE,B
  ,XTA,NOLISFL*
  ,U1A,FIN
  SABS:9,UTM,2
  9,XTA,1
  ,AEX,=7777 7777 7777 7777
  ,UZA,FIN
  9,XTA,1
  ,ASN,64+15
  ,UZA,SABS.ENTRY
  9,XTA,
  ,UZA,SABS.ПEPEПИCAHA
  ,ITS,9
  ,ATX,NAMT
  14,VTM,TABS+4
  ,ITS,14
  ,CALL,TEXISO
  8,BASE,B
  14,VTM,TABS
  ,ITS,14
  14,UTM,5
  ,ITS,14
  14,VTM,4
  ,ITS,14
  ,CALL,PRINT8//
  ,WTC,NAMT
  9,VTM,
  ,UJ,SABS
  FIN:,XTS,CARD
  13,VTM,EXIT
  ,WTC,SERV
  ,UJ,
  RCAT:,010,N
  ,,
  RC1:,000,100B
  ,,1
  TEX :,ISO,36HПEPEПИCAHA ПPOГPAMMA
  TABS:,ISO,36HOTCYTCTBYET ПPOГPAMMA
  SERV:,BSS,1
  CARD:,BSS,1
  RET :,BSS,1
  LIB :,BSS,1
  FNAM:,BSS,1
  FWR :,BSS,1
  NAMT:,BSS,1
  ,END,
  TASK41:,NAME,.ГOЛOBA APXИBAPИYCA
C
C *******  A.П.CAПOЖHИKOB
C          E.Д.ФEДЮHЬKИH
C
C    ГOЛOBHAЯ ПPOГPAMMA APXИBAPИYCA
C    ( PACПPEДEЛEHИE ПAMЯTИ )
C
  *PROTO*:LC,BLOCK,AP,NUNIT,NL,NF,KAP(40)
  *CATAR * :,PC,1024
  *CATFIL* :,PC,1024
  *HEADER* :,PC,1024
  *BUFFER* :,PC,1024
 NOLISFL*:,LC,1
  APXAP :,SUBP,
  DIATEX:,SUBP,
C
C---
C
  B:13,VTM,20B
  14,VJM,B ИПЗ
  :,ISO,12HAPXИBAPИYC
  ,LOG,
  B ИПЗ:,ITA,14
  ,FUN,64B
 ,XTA,=I13
  ,ATX,NL
 ,XTA,
 ,ATX,NOLISFL*
  1,VIM,A
  ,UTC,-PROTO
  ARCHIV:,ENTRY,
  A:12,VTM,PROTO
 ,XTA,NOLISFL*
 ,UZA,F
 12,VTM,
 F:,BSS,
  ,ITA,15
  ,UTC,RET
  ,ATX,1
  ,ITA,13
  ,UTC,RET
  ,ATX,
  ,*65,760B
  ,ATI,13.*ИПД
  ,*65,502B
  ,ATI,14
  14,*65,
  ,ASN,64+42
  ,ATI,14
  14,*65,677B
  ,AEX,
  13,*53,65B.*****
  ,ITS,12
  ,CALL,DIATEX
  12,VZM,C
  14,VTM,D
  ,ITA,14
  ,FUN,74B
  C:,CALL,APXAP
  D:,XTA,
  ,FUN,74B
  ,WTC,RET+1
  15,VTM,
  ,XTS,
  ,CALL,DIATEX
  ,WTC,RET
  ,UJ,
  ARCHI:,ENTRY,.FOR CARD
  ,UTC,=I4
  ,XTA,
  ,UTC,NUNIT
  ,ATX,
  ,UJ,A
  PROTO:,INT,2.БИЛИCT
   RET:,BSS,2
C
C   FUNCTION MAKRIW,MAKWIW(MAC,ZON)
C   ПOЛYЧEHИE IW70 ДЛЯ ЧTEHИЯ, ЗAПИCИ
C   MAC - CTPAHИЧHЫЙ MACCИB
C   ZON - HOMEP ЗOHЫ
C
  MAKRIW:,ENTRY,
  ,UTC,=:001
  MAKWIW:,ENTRY,
  14,VTM,
  8,BASE,B
  ,STI,11
  ,ASN,64-20
  14,AOX,
  11,XTS,
  ,AAX,=7777
  15,AOX,
  13,UJ,
C
C   FUNCTION KLETKA(LIS,N)
C   ПOЛYЧEHИE COДEPЖИMOГO N-Й
C   12-БИTHOЙ KЛETKИ B MACCИBE LIS
C
  KLETKA:,ENTRY,
  8,BASE,B
  ,ATI,14
  14,XTA,
  ,ASN,64+2
  15,ARX,
  ,ATI,12
  14,XTA,
  ,AAX,=3
  ,ATI,14
  12,XTA,
  :14,VZM,*+2
  14,UTM,-1
  ,ASN,64-12
  ,UJ,*-1
  :,ASN,64+36
  13,UZA,.ПYCTO
  ,AOX,=I0
  13,UJ,
C
C    FUNCTION LETBI(STRING)
C    ПOЛYЧEHИE БИTOBOЙ ШKAЛЫ ИЗ
C    TEKCTOBOЙ CTPOKИ STRING :
C    B47 - "A", B46 - "B"   И T.Д.
C
  LETBI:,ENTRY,
  8,BASE,B
  ,ATI,14
  ,XTA,
  15,ATX,2
  LB1:14,XTA,
  12,VTM,-5
  LB2:,ASN,64-8
  15,ATX,3
  ,YTA,
  ,ATI,11
  ,ASN,64+6
  ,UZA,LB3
  ,ITA,11
  ,AAX,=40
  :,UZA,*+1
  11,UTM,-40B
  :,XTA,=:4
  11,ASN,
  15,AOX,2
  15,ATX,2
  15,XTA,3
  12,VLM,LB2
  14,VLM,LB1
  LB3:15,XTA,2
  13,UJ,
C
C    FUNCTION ICOS ( ISO,COSY )
C    ПEPEBOД TEKCTOBOЙ CTPOKИ
C    ИЗ  ISO  B  COSY.
C    PEЗYЛЬTAT - ЧИCЛO CЛOB COSY
C
  ICOS:,ENTRY,
  8,BASE,B
  ,STI,11
  ,ATI,10
  13,MTJ,9
  10,MTJ,12
  14,VTM,-13
  SZ:12,XTA,
  ,ARX,=6H'177''177''177''177''177''177'
  ,AAX,=6H'200''200''200''200''200''200'
  ,AEX,=6H'200''200''200''200''200''200'
  ,U1A,ZIS
  12,UTM,1
  14,VLM,SZ
  ,UJ,TOTRAN
  ZIS:,ASN,64+2
  12,AEX,
  12,ATX,
  ,XTA,=6H
  :12,UTM,1
  12,ATX,
  14,VLM,*-1
  TOTRAN:,ITS,10
  ,ITS,11
  10,VTM,
  ,CALL,ISOTCOSY
  SLF:11,XTA,
  ,AEX,=12
  ,AAX,=377
  10,UTM,1
  11,UTM,1
  ,U1A,SLF
  ,ITA,10
  ,AOX,=I0
  9,UJ,
C
C     SUBROUTINE ECEXTR(LUN,JOB)
C     ПOЗИЦИOHИPOBAHИE ЛEHTЫ EC
C
  ECEXTR:,ENTRY,
  8,BASE,B
  ,STI,14
  ,STI,12
  14,XTA,.JOB
  ,ASN,64-24
  12,AOX,.LUN
  ,ASN,64-12
  ,*57,7777B
  13,UJ,
C
C     SUBROUTINE  ADDCS(MAC,ICS)
C     ПOДCЧET KOHTP. CYMMЫ MACCИBA MAC(1024)
C     HAЧ. ЗHAЧEHИE И PEЗYЛЬTAT - B ICS
C
 ADDCS:,ENTRY,
 ,STI,11.ICS
 ,STI,12.MAC
 14,VTM,-1023
 11,XTA,
 LCS:14,UTC,1023
 12,ARX,
 14,VLM,LCS
 11,ATX,
 13,UJ,
  ,DATA,
  VOLU:,INT,16
  1,SET,VOLU
  1,,NL
  ,END,
 TBUFF:,NAME, M.YU..POPOV
C
C***************************************
C*       ГPAФИЧECKИЙ ИHTEPФEЙC
C*      T E K T R O N I X - 4012
C***************************************
C*   ПOПOB M.Ю.    27/02/81   OИЯИ
C***************************************
C*   KPATKOE OПИCAHИE TEKTRONIX-4012:
C*   ДИCПЛEЙ ПOЗBOЛЯET BЫBOДИTЬ TEKCT И
C*   ГPAФИKY, MAKCИMAЛЬHOE ЧИCЛO TOЧEK
C*   HA ЭKPAHE 1024*1024.
C*   BEKTOP ПPOBOДИTCЯ OT TEKYШEЙ TOЧKИ
C*   B ПOCTYПAЮЩYЮ TOЧKY ,ПPИЧEM BEKTOP
C*   MOЖET БЫTЬ ЛИБO HAPИCOBAH ,ЛИБO HET
C*   BO BTOPOM CЛYЧAE ПPOИCXOДИT CMEHA
C*   TEKYЩEЙ TOЧKИ.
C*   KOOPДИHATЫ HA ЭKPAHE AБCOЛЮTHЫE,
C*   (X=0,Y=0 - COOTBETCTBYЮT ЛEBOMY
C*   HИЖHEMY YГЛY ЭKPAHA )
C***************************************
C*   OПИCAHИE  ПPOГPAMHOЙ ЧACTИ:
C*   CALL TINIT - ИHИЦИAЦИЯ (T.E. B 0,0)
C*   DUMMY=TPLOT(GB) ИЗOБPAЗИTЬ BEKTOP
C*   CALL TSHOW - ДOCБPOCИTЬ ГPAФИЧECKИЙ
C*                БYФEP HA ЭKPAH
C*   CALL TCLEAN - OЧИCTИTЬ ЭKPAH
C*   DUMMY=TGINST(GB) OПPOC CTATYCA
C*   DUMMY=TGINCH(GB) OПPOC KOOPДИHAT
C*   CALL TBUFF(K,HHZZZZB) БYФEPИЗAЦИЯ
C*   CALL TBEND - KOHEЦ БYФEPИЗAЦИИ
C*
C*   DIMENSION GB(3) - ИHФ. ПOЛE
C*   GB(1) = 0 BEKTOP ИЗOБPAЖATЬ
C*         = 1 BEKTOP HEИЗOБPAЖATЬ
C*   ( ПPИ TGINST ПOПAДAET CTATYC,
C*     ПPИ TGINCH ПOПAДAET CИMBOЛ)
C*   GB(2) - KOOPДИHATA  X
C*   GB(3) - KOOPДИHATA  Y
C*
C*   K = -1  ONLY DISPLAY
C*   K =  0  ONLY BUFFERING
C*   K = +1  DISPLAY+BUFFERING
C*
C*   HH - HOMEP HAПPABЛEHИЯ
C*   ZZZZ - HOMEP ЗOHЫ
C*
C*   CTATYC ДИCПЛEЯ:
C*   BIT 7 - ALWAYS 0
C*   BIT 6 - ALWAYS 1
C*   BIT 5 - NARD COPY UNIT BIT;
C*         0 INDICATES A NARD COPY UNIT
C*         IS AVAILABLE.
C*   BIT 4 - VECTOR BIT; 1 INDICATES
C*         THE TERMINAL IS SET TO DRAW
C*         VECTORS.
C*   BIT 3 - GRAPH MODE BIT;
C*         0 INDICATES THAT GRAPH MODE
C*         EXISTS.
C*   BIT 2 - MARGIN BIT; 1 INDICATES
C*         MARGIN 1 EXISTS.
C*   BIT 1 - AUXILARY UNIT SENSING BIT.
C**************************************
CC
 GIVPAG:,SUBP,
 WIND1:,EQU,0
 X:,EQU,1
 Y:,EQU,2
 ,UTC,INF70
 ,STX,
 ,UTC,K
 ,ATX,
 ,ITA,7
 7,BASE,BASE
 ,XTS,
 ,ATX,CNT
 ,XTA,CR14
 ,ATX,LB
 ,WTC,K
 ,XTA,
 ,ATX,K
 ,XTA,CR37
 ,ATX,A
 ,XTA,43B
 ,ASN,64-20
 ,WTC,INF70
 ,XTS,
 ,AAX,CM18
 15,AEX,
 ,STX,INF70
 ,STI,7
 13,UJ,
 TSHOW:,ENTRY,
 14,VTM,FSTR
 ,UJ,SVREG
 TPLOT:,ENTRY,
 14,VJM,SVREG
 ,XTA,PARAM
 ,ATI,11
 ,UJ,VECTOR
 TINIT:,ENTRY,
 14,VJM,SVREG
 11,VTM,WIND
 ,XTA,I0
 11,ATX,X
 11,ATX,Y
 10,VTM,
 ,XTA,
 ,ATX,BYX1
 9,VTM,1-6
 ,XTA,GS
 ,ATX,REGIM
 VECTOR:11,XTA,WIND1
 ,UZA,Z1
 ,XTA,GS
 ,ATX,REGIM
 Z1:,XTA,
 ,ATX,WIND
 11,XTA,X
 11,AOX,Y
 ,AAX,CME
 ,U1A,Z2
 11,XTA,Y
 ,ASN,64-10
 11,AEX,X
 ,ASN,64-28
 ,AUX,MYX
 ,AEX,BYX
 ,ATX,BYX2
 ,AEX,BYX1
 ,ARX,CS177
 ,AAX,CS200
 15,ATX,
 ,AAX,BHIX
 ,ASN,64-8
 15,AOX,
 ,AEX,CS200
 ,ASN,64+7
 ,ARX,CS177
 ,AEX,CS200
 ,AOX,MLOX
 ,XTS,BYX2
 ,ATX,BYX1
 15,AAX,
 ,ATX,BYX2
 14,VTM,1-4
 UNP:,XTA,BYX2
 ,ASN,64-8
 ,ATX,BYX2
 ,YTA,
 14,UTC,3
 ,ATX,HIY
 14,VLM,UNP
 14,VTM,1-5
 CVR1:14,UTC,4
 ,XTA,REGIM
 ,UZA,CVR2
 ,XTS,W
 ,ASN,64-8
 15,AEX,
 ,ATX,W
 9,VLM,CVR2
 9,VTM,1-6
 10,UTC,
 ,ATX,WRV
 10,UTM,1
 CVR2:14,VLM,CVR1
 ,ITA,10
 ,AEX,LB
 ,UZA,FSTR
 RETURN:,XTA,
 ,ATX,REGIM
 ,ITA,10
 ,ATX,C10
 ,ITA,9
 ,STX,C9
 ,STI,11
 ,STI,10
 ,STI,9
 ,STI,7
 13,UJ,
 SVREG:,UTC,PARAM
 ,ATX,
 ,ITS,7
 7,VTM,BASE
 ,ITS,9
 ,ITS,10
 ,ITS,11
 ,XTS,C10
 ,ATI,10
 ,XTA,C9
 ,ATI,9
 14,UJ,
 Z2:,ATX,WIND
 ,UJ,RETURN
 TCLEAN:,ENTRY,
 ,ITS,13
 14,VJM,SVREG
 13,VTM,CLEAN2
 ,XTA,W
 ,ASN,64-8
 ,AEX,ESC
 ,ATX,W
 9,VLM,CLEAN1
 10,UTC,
 ,ATX,WRW
 10,UTM,1
 CLEAN1:,XTA,W
 ,ASN,64-8
 ,AEX,FF
 ,ATX,W
 9,VLM,FSTR
 ,UJ,FSTR
 CLEAN2:,ATI,13
 ,*57,3B
 15,XTA,
 13,UJ,
 TGINST:,ENTRY,
 14,VJM,SVREG
 ,XTA,
 ,ATX,LOY
 ,UJ,GIN
 TGINCH:,ENTRY,
 14,VJM,SVREG
 ,XTA,CR1
 ,ATX,LOY
 GIN:,ITA,13
 ,ATX,HIY
 ,XTA,PARAM
 ,ATX,HIX
 13,VJM,FSTR
 ,ITS,7
 7,VTM,BASE
 ,XTS,ESC
 ,ASN,64-8
 ,AEX,ENQ
 ,ARX,LOY
 ,ASN,64-32
 ,ATX,WRW
 ,*71,INFGIN
 ,XTA,PARAM
 ,ATI,14
 ,XTA,WRW
 ,ASN,64-8
 ,ASN,64-8
 ,ATX,WRW
 ,YTA,
 14,ATX,WIND1
 ,XTA,WRW
 ,APX,MYX
 ,ASN,64-10
 ,ATX,WRW
 ,YTA,
 ,AOX,I0
 14,ATX,X
 ,XTA,WRW
 ,ASN,64-10
 ,YTA,
 ,AOX,I0
 14,ATX,Y
 ,XTA,HIY
 ,STI,13
 ,STI,7
 13,UJ,
 FSTR:,XTA,W
 ,ASN,64-8
 ,AEX,CR37
 9,VLM,FSTR1
 ,UJ,FSTR1+1
 FSTR1:,ASN,64-8
 9,VLM,*
 :10,UTC,
 ,ATX,WRV
 ,XTA,
 10,UTC,1
 ,ATX,WRV
 10,VJM,SELECT
 10,VTM,
 9,VTM,1-4
 ,XTA,GS
 ,ASN,64-8
 ,AEX,LOX
 ,ATX,W
 ,UJ,RETURN
C
C   K=-1  ONLY DISPLAY
C   K=0   ONLY BUFFERING
C   K=+1  BUFFERING+DISPLAY
C
 SELECT:,XTA,K
 ,AEX,I0
 ,UZA,BUFFER
 ,*71,INF
 ,XTA,K
 ,AAX,C002
 ,UZA,BUFFER
 10,UJ,
 BUFFER:,XTA,A
 10,UZA,
 ,ITA,13
 14,VTM,CR37
 ,ITS,14
 ,CALL,GIVPAG
 ,ATI,13
 ,XTA,CNT
 ,ATI,14
 9,VTM,WRV
 BUF1:9,XTA,
 ,ARX,CS177
 ,AAX,CS200
 ,AEX,CS200
 ,U1A,BUF2
 9,XTA,
 ,WTC,43B
 14,ATX,
 9,UTM,1
 14,UTM,-1023
 14,VZM,FULLB1
 14,UTM,1024
 ,UJ,BUF1
 FULLB1:,ITA,10
 15,ATX,
 10,VJM,FULLB
 :15,XTA,
 ,ATI,10
 14,VTM,
 ,UJ,BUF1
 BUF2:,ASN,64+4
 15,ATX,
 ,ASN,64+2
 15,AEX,
 9,AEX,
 ,WTC,43B
 14,ATX,
 14,UTM,-1023
 14,VZM,FULLB
 14,UTM,1024
 ,ITA,14
 ,UJ,BUF11
 FULLB:,*70,INF70
 ,XTA,CR1
 ,ARX,INF70
 ,ATX,INF70
 ,XTA,
 BUF11:,ATX,CNT
 10,UJ,
 TBEND:,ENTRY,
 14,VJM,SVREG
 ,XTA,A
 ,UZA,BEND1
 ,ITA,13
 14,VTM,CR37
 ,ITS,14
 ,CALL,GIVPAG
 ,ATI,13
 BEND:9,VTM,*READOLD
 ,XTA,CNT
 ,ATI,14
 10,VJM,BUF1
 ,XTA,CNT
 ,UZA,BEND1
 10,VJM,FULLB
 BEND1:,BSS,
 ,XTA,CR22
 ,ATX,LB
 ,XTA,
 ,ATX,A
 ,XTA,C002
 ,STX,K
 ,STI,11
 ,STI,10
 ,STI,9
 ,STI,7
 13,UJ,
 BASE:,BSS,
 C9:,INT,-5
 ENQ:,LOG,5
 INFGIN:,Z05,WRW
  ,Z00,
 INF:,Z04,WRV
 ,Z00,
 LB:,LOG,22
 GS:,LOG,35
 I0:,INT,0
 CR37 :,LOG,37
 CME:,OCT,0017 7777 7777 6000
 CR1 :,LOG,1
 CR14:,LOG,14
 CR22:,LOG,22
 CM18:,LOG,77 7777
 C002:,OCT,002
 CS177:,ISO,6H'177''177''177''177''177''177'
 CS200:,ISO,6H'200''200''200''200''200''200'
 *READOLD:,ISO,12H*READ OLD '310''0'
 ESC:,LOG,33
 FF: ,LOG,14
 MYX:,ISO,6H'37''37''37''37'''''
 BYX:,ISO,6H'40''140''40''100'''''
 BHIX:,ISO,6H'''''200'''''''
 MLOX:,ISO,6H'''''''377'''''
 K:,OCT,002
 BYX1:,BSS,1
 BYX2:,BSS,1
 WIND:,BSS,1
 REGIM:,BSS,1
 HIY:,BSS,1
 LOY:,BSS,1
 HIX:,BSS,1
 LOX:,BSS,1
 PARAM:,BSS,1
 CNT:,BSS,1
 A  :,BSS,1
 INF70:,BSS,1
 C10:,BSS,1
 WRW:,BSS,
 WRV:,BSS,20
 ,BSS,3
 W:,BSS,1
 ,END,
