  NEWSLETT:,NAME,. ФEBPAЛЬ 87
C*
C****************************************
C*
C*      O   ПЛAHИPOBЩИKE ЗAДAЧ.
C*      =======================
C*
C*  ЗAДAЧИ, ЗAПYCKAEMЫE ПOЛЬЗOBATEЛЯMИ C
C*  TEPMИHAЛOB CИCTEMЫ "MYЛЬTИTAЙП",
C*  TAK ЖE, KAK И ЗAДAЧИ, ПPИCЛAHHЫE ПO
C*  KAHAЛAM CBЯЗИ C ПEPИФEPИЙHЫX ЭBM,
C*  A TAKЖE ЗAДAЧИ, BBEДEHHЫE ПO "ПB",
C*  ЗAПИCЫBAЮTCЯ BO BXOДHYЮ OЧEPEДЬ
C*  ПPOГPAMMЫ-ПЛAHИPOBЩИKA (TAK HAЗABAEMЫЙ
C*  ФAЙЛ BBOДA).  TAKИM OБPAЗOM, ЗAГPYЗKA
C*  MAШИHЫ ЗAДAЧAMИ OCYЩECTBЛЯETCЯ "ЧEPEЗ
C*  OДHO ГOPЛO", И MOЖET (HAKOHEЦ-TO !)
C*  ПOЛHOCTЬЮ KOHTPOЛИPOBATЬCЯ OПEPATOPOM.
C*
C*  ПPOГPAMMA-ПЛAHИPOBЩИK ЗAПYCKAETCЯ
C*  ABTOMATИЧECKИ ПPИ BЫЗOBE ДИCПETЧEPA.
C*  ПPИ HEOБXOДИMOCTИ "PYЧHOГO" ЗAПYCKA
C*  ИCПOЛЬЗYЙTE ПPИKAЗ "H".
C*
C*  KPOME TOГO, ПЛAHИPOBЩИK ПOBTOPHO
C*  ЗAПYCKAET HA CЧET TE ЗAДAЧИ ИЗ ФAЙЛA
C*  BBOДA, KOTOPЫE YЖE БЫЛИ ЗAПYЩEHЫ, HO
C*  HE ДOCЧИTAЛИCЬ ДO KOHЦA ИЗ-ЗA ПEPEBЫЗOBA
C*  ДИCПETЧEPA.
C*
C*      KЛACCЫ CЧETHЫX KAHAЛOB (ШИФPOB) :
C*   Ш01 - Ш04 : ЗAДAЧИ, BBEДEHHЫE ПO "ПB"
C*   Ш05 - Ш07 : CBЯЗHЫE ЗAДAЧИ
C*   Ш05 - Ш07 : TEPMИHAЛЬHЫE БEЗ ДИAЛOГA
C*   Ш10 - Ш20 : ДИAЛOГOBЫE ЗAДAЧИ.
C*
C*  ЗAГPYЗKA ЗAДAЧ HA Ш01-Ш20 PAЗPEШAETCЯ
C*  HAБOPOM HA ПYЛЬTE B 25-40 PAЗPЯДAX
C*  6 TYMБЛEPHOГO PEГИCTPA :
C*       25 - Ш01,  26 - Ш02,
C*       27 - Ш03,  28 - Ш04,
C*       29 - Ш05,  30 - Ш06,
C*       31 - Ш07,  32 - Ш10,
C*       33 - Ш11,  34 - Ш12,
C*       35 - Ш13,  36 - Ш14,
C*       37 - Ш15,  38 - Ш16,
C*  ECЛИ HИЧEГO HE HAБPAHO - PAЗPEШEHA
C*  ЗAГPYЗKA BCEX CЧETHЫX KAHAЛOB.
C*
C*  ПЛAHИPOBЩИK ИMEET ДBA PEЖИMA PAБOTЫ :
C*       OTЛAДOЧHЫЙ И CЧETHЫЙ.
C*
C***** OTЛAДOЧHЫЙ PEЖИM. BKЛЮЧAETCЯ ДHEM
C*     ПPИ HAЖATOM 6 PAЗPЯДE T.P.-6
C*
C*  Ш01 ЗAГPYЖAETCЯ ЗAДAЧAMИ C  T > 15 MИH.
C*  Ш02  ---"---   ---"---      T < 31 MИH.
C*  Ш03  ---"---   ---"---      T < 11 MИH.
C*  Ш04  ---"---   ---"---      T <  6 MИH.
C*  Ш05-Ш07 ЗAГPYЖAЮTCЯ CBЯЗHЫMИ ИЛИ HEДИA-
C*    ЛOГOBЫMИ ЗAДAЧAMИ, ECЛИ Y HИX T < 11.
C*  Ш10-Ш20 ЗAГPYЖAЮTCЯ ДИAЛOГOBЫMИ ЗAДAЧAMИ
C*    ECЛИ Y HИX T < 11.
C*
C**** CЧETHЫЙ PEЖИM. BKЛЮЧAETCЯ BEЧEPOM
C*    ПPИ OTЖATOM 6 PAЗPЯДE T.P.-6 :
C*
C*  Ш01 ЗAГPYЖAETCЯ ЗAДAЧAMИ C T > 21 MИH.
C*  Ш04  ---"---    ---"---    T < 10
C*  Ш02,Ш03,Ш05-Ш20 ЗAГPYЖAЮTCЯ ЗAДAЧAMИ
C*       B COOTBETCTBИИ C ИX KЛACCAMИ,
C*       БEЗ YЧETA ЗAKAЗAHHOГO BPEMEHИ T.
C*
C*
C**** ПPИ HEOБXOДИMOCTИ OPГAHИЗOBATЬ
C*  BHEOЧEPEДHOЙ ЗAПYCK ЗAДAЧИ C HOMEPOM NN
C*  ПO ФAЙЛY BBOДA,  ИCПOЛЬЗYЙTE ПPИKAЗЫ :
C*      NNБП     NNПП     NNФП
C*  ПO "БП" ЗAДAЧA ЗAПYCKAETCЯ HA ЛЮБOЙ
C*  CBOБOДHЫЙ ШИФP, PAЗPEШEHHЫЙ HA TP-6.
C*  (БEЗYCЛOBHЫЙ ПPИOPИTET).
C*  ПO "ПП" - TAK ЖE, HO BЫБOP ШИФPA ПPO-
C*  ИЗBOДИTCЯ TOЛЬKO ИЗ  Ш04-Ш01.
C*  (ПOTOKOBЫЙ ПPИOPИTET).
C*  ПO "ФП" - ЗAПYCK HA Ш01, ECЛИ OH CBOБO-
C*  ДEH И PAЗPEШEH HA TP-6 (ФOHOBЫЙ ПPИOP.)
C*
C*****************************************
C*
C*       O PACПEЧATKE ЛИCTИHГOB.
C*       =======================
C*
C*  PACПEЧATKOЙ ЗAHИMAETCЯ CЛYЖEБHAЯ ЗAДAЧA
C*  "BЫBOД".  OHA ЗAПYCKAETCЯ ABTOMATИЧECKИ
C*  ПPИ BЫЗOBE ДИCПETЧEPA (ECЛИ HE HAЖAT 42
C*  PAЗPЯД TP-2) ИЛИ BPYЧHYЮ ПPИKAЗOM  "P".
C*
C*  ЗAXBATИB ПEPBOE CBOБOДHOE AЦПY, ЗAДAЧA
C*  BЫBOДA TPEБYET YCTAHOBИTЬ ЛИCT HA AЦПY.
C*  B ЭTO BPEMЯ OHA HAXOДИTCЯ B ЖДYЩEM PE-
C*  ЖИME (XAPAKTEPHO HAЛИЧИE CЛOBA "ЖДY" B
C*  NAME ЗAДAЧИ).  B ЖДYЩEM PEЖИME ЛИCTИHГИ
C*  BЫBOДЯTCЯ TOЛЬKO ПO ЭKCПPECC-ПPИKAЗAM.
C*
C*  A1P (A2P) - YCTAHOBKA ABTOMATИЧECKOГO
C*              PEЖИMA HA AЦПY 1 (2).
C*  Ж1P (Ж2P) - YCTAHOBKA ЖДYЩEГO PEЖИMA.
C*  C1P (C2P) - YCTAHOBKA ЛИCTA ПO ЛИHEЙKE
C*              HA AЦПY 1 (2).
C*
C*  HAЛИЧИE BCEX ЭTИX ПPИKAЗOB CBЯЗAHO CO
C*  CTPEMЛEHИEM K ЭKOHOMИИ БYMAГИ. ECЛИ B
C*  CИCTEME YCTAHOBЛEH PEЖИM ЭKOHOMИИ БYMA-
C*  ГИ BO BPEMЯ CЧETA ЗAДAЧИ (T.E. ИГHOPИPY-
C*  ЮTCЯ KOMAHДЫ ПEPEXOДA HA HOBЫЙ ЛИCT ИЛИ
C*  ЧACTЬ ЛИCTA), ЭTOT PEЖИM HE OTMEHEH OПE-
C*  PATOPOM (HAЖATИEM 16-ГO PAЗPЯДA HA 6-M
C*  TYMБЛEPHOM PEГИCTPE), A B ПYCKOBOM ПAKE-
C*  TE ПOЛЬЗOBATEЛЯ HET YПPABЛЯЮЩEЙ KAPTЫ
C*      *PAGE:999,LIST    - EГO ЛИCTИHГ
C*  "YПЛOTHЯETCЯ".  ПOЭTOMY ЗAДAЧA BЫBOДA
C*  CAMA BЫHYЖДEHA CЧИTATЬ CTPOKИ HA ЛИCTE,
C*  A ECЛИ BЫ XOTИTE "ПOДOГHATЬ ЛИCT", TO
C*  BЫ ДOЛЖHЫ ПPEДYПPEДИTЬ EE OБ ЭTOM.
C*
C*  ИTAK, B CЛYЧAE CБOЯ ЛИCTOBAHИЯ PEKOMEH-
C*  ДYEM TAKYЮ ПOCЛEДOBATEЛЬHOCTЬ ДEЙCTBИЙ:
C*   1. BЫДATЬ ПPИKAЗ Ж1P (Ж2P) И ДOЖДATЬCЯ
C*      KOHЦA TEKYЩEЙ BЫДAЧИ, ECЛИ OHA ECTЬ.
C*   2. BЫДATЬ ПPИKAЗ C1P (C2P)
C*   3. YCTAHOBИTЬ ЛИCT HA AЦПY 1 (2), KAK
C*      OБЫЧHO: CГИБ БYMAГИ ПO ЧEPHOЙ ЛИHИИ.
C*   4. BЫДATЬ ПPИKAЗ A1P (A2P).
C*
C*  ПPИHYДИTEЛЬHOE YПЛOTHEHИE ЛИCTИHГOB
C*  MOЖHO OTMEHИTЬ, HAЖAB 16-Й PAЗPЯД TP-6 !
C*
C*
C***    CHЯTИE ЗAДAЧИ BЫBOДA :  K1P (K2P).
C*
C*  ECЛИ B MOMEHT HAБOPA ПPИKAЗA ПEЧATAETCЯ
C*  ЛИCTИHГ - ЗAДAЧA BЫBOДA ДOПEЧATAET EГO,
C*  И TOЛЬKO ПOTOM OKOHЧИTCЯ.
C*
C***    ПPOПYCK TEKYЩEЙ BЫДAЧИ :  1P (2P)
C*
C*  ПEЧATЬ TEKYЩEГO ЛИCTИHГA ПPEKPAЩAETCЯ,
C*  ПEЧATAETCЯ EГO ПOCЛEДHЯЯ CTPAHИЦA.
C*  ЭTOT ЖE ПPИKAЗ ИCПOЛЬЗYETCЯ KAK OTBET
C*  HA ПPEДЛOЖEHИE ЗAБPATЬ ПEPФOPAЦИЮ.
C*
C***   ПOBTOPHЫЙ BЫBOД : CCCNNЭ1P (CCCNNЭ2P)
C*
C*  CCC = HAЧAЛЬHЫЙ HOMEP CTPAHИЦЫ ЛИCTИHГA
C*   NN = HOMEP ЛИCTИHГA ПO ФAЙЛY BЫBOДA
C*        ПAPAMETP CCC MOЖHO OПYCTИTЬ.
C*  ПEPФOPAЦИЯ ПO ЭTOMY ПPИKAЗY TOЖE ПOBTO-
C*  PЯETCЯ.  ECЛИ HAДO ПOBTOPИTЬ TOЛЬKO
C*  ЛИCTИHГ,  ИCПOЛЬЗYЙTE ПPИKAЗ :
C*       CCCNNЛ1P   (CCCNNЛ2P).
C*  ECЛИ HAДO ПOBTOPИTЬ TOЛЬKO ПEPФOPAЦИЮ,
C*  ИCПOЛЬЗYЙTE ПPИKAЗ:  NNП1P (NNП2P).
C*
C***   БЛOKИPOBKA ПEPФOPAЦИИ :  Л1P (Л2P)
C*  Y BCEX ЗAДAЧ BЫBOДИTCЯ TOЛЬKO ЛИCTИHГ
C*  ПEPФOPAЦИЯ ПPOCTO OTБPACЫBAETCЯ.
C*
C***   БЛOKИPOBKA ЛИCTИHГA :    П1P (П2P)
C*  HAOБOPOT - BЫДAETCЯ TOЛЬKO ПEPФOPAЦИЯ.
C*
C*
C***   HAПOMИHAEM: ПPEДПOCЛEДHИЙ CИMBOЛ
C*  Y BCEX ПPИKAЗOB - HOMEP AЦПY (1 ИЛИ 2)
C*  ECЛИ 0 - ПPИKAЗ OTHOCИTCЯ K ЛЮБOЙ
C*  ЗAДAЧE BЫBOДA.
C*
  ,END,
 COMMENT:,NAME,.
C
C     ЗHAЧEHИE PAЗPЯДOB TYMБЛEPHЫX PEГИCTPOB
C     Д Л Я   O C   Д Y Б H A
C
C
C          1 Й TYMБЛEPHЫЙ PEГИCTP
C
C 48    BBOД C ПACПOPTOM KAK B Д68.
C 47    OTMEHA MOДEЛИPOBAHИЯ MБ HA ДИCKAX
C       B MOMEHT BЫЗOBA ДИCПETЧEPA.
C 46-45 БЛOKИPOBKA OПOЗHABAHИЯ ДИCKOB B
C       HAПPABЛEHИЯX 3-4 COOTBETCTBEHHO.
C 24    ПEЧATЬ MOДEЛEЙ MЛ ПPИ BЫЗOBE ДИCП.
C 23    БЛOKИPOBKA ЗAПYCKA MYЛЬTИTAЙПA.
C 16-01 БЛOKИPOBKA ИCПOЛЬЗOBAHИЯ MБ (10-27).
C       ДЛЯ BЫБPOCA ЗAДAЧИ, ЗAЦИKЛИBШEЙCЯ HA
C       MБ, MOЖET ПOTPEБOBATЬCЯ EГO БЛOKИPO-
C       BAHИE HA TP-1.
C
C          2-Й TYMБЛEPHЫЙ PEГИCTP
C
C 48    KATAЛOГИ BBOДA/BЫBOДA ПPИ HOCИTEЛE.
C 47    ЧИCTKA KATAЛOГA ABTOBBOДA
C       ПPИ BЫЗOBE ДИCПETЧEPA.
C 46    ЧИCTKA KATAЛOГA ABTOBЫBOДA
C       ПPИ BЫЗOBE ДИCПETЧEPA.
C 45    ЧИCTKA KATAЛOГA CБPOШEHHЫX ЗAДAЧ
C       ПPИ BЫЗOBE ДИCПETЧEPA.
C 44    БЛOKИPOBKA ПEЧATИ OTБPAKOBAHHЫX
C       TPAKTOB ПPИ BЫЗOBE ДИCПETЧEPA.
C 42    БЛOKИPOBKA ПOИCKA БYФEPOB BBOДA
C       И BЫBOДA И ЗAПYCKA PACПEЧATKИ
C       И PEЖИMA БYФEPИЗAЦИИ BЫBOДA.
C 41,40 БAPAБAH 21 (22) MOHИTOPHOЙ CИCTEMЫ
C       MOДEЛИPYETCЯ 0-37 (40-77)   ЗOHAMИ
C       ДИCKOBOГO ФAЙЛA  9/MONSYS.
C 39    KATAЛOГ ГPAФИKOB HA CATALO/8
C
C 33-31 HOMEP ЭKЗEMПЛЯPA ДИCПETЧEPA (0-7),
C       BЫЗЫBAEMOГO C ДИCKA.  CYЩECTBEHHЫ
C       TOЛЬKO B MOMEHT BЫЗOBA.
C 30    PAЗPEШEHИE CБOPA CTATИCTИKИ
C       ПO TEPMИHAЛЬHЫM ПOЛЬЗOBATEЛЯM.
C 29-26 БЛOKИPOBKA ПPИBЯЗKИ HOBЫX KAHAЛOB
C       K TEPMИHAЛЬHЫM ПOДCИCTEMAM:
C 29    - "OPERTERM",
C 28    - MYЛЬTИTAЙП,
C 27    - ЭKPAHHЫЙ PEДAKTOP.
C 26    - MOHИTOP ПOДCИCTEM
C 06-01 HOMEP OCHOBHOГO OПEPATOPCKOГO TEPMИ-
C       HAЛA B COOTBETCTBИИ C HACTPOЙKOЙ
C
C          4 Й TYMБЛEPHЫЙ PEГИCTP
C
C 48-44 HE HAЖИMATЬ - BЛИЯЮT HA TPAHCЛЯTOP
C 24-01 ШKAЛA TEPMИHAЛOB, C KOTOPЫX PAЗPEШEH
C       ЗAПYCK ЗAДAЧ MИHYЯ OЧEPEДЬ BBOДA.
C       (HOMEP PAЗPЯДA COOTBETCTBYET HOMEPY
C       BИPTYAЛЬHOГO KAHAЛA)
C
C          5 Й TYMБЛEPHЫЙ PEГИCTP
C
C 25    БЛOKИPOBKA ПPOBEPKИ ЧACTOTЫ ПPИ
C       BЫЗOBE ДИCПETЧEPA.
C 15-01 YKAЗATEЛЬ AДPECA B HEKOTOPЫX ПPИKA-
C       ЗAX.
C
C          6 Й TYMБЛEPHЫЙ PEГИCTP
C
C 48-45 БЛOKИPOBKA ЛИHИЙ CBЯЗИ TASK70
C 48    EC-1010 ЛBTA
C 47    M-6000 OHMY
C 46    MИHCK-2 PXЛ
C 45    M-6000 ЛBTA.
C 40-25 ШKAЛA ШИФPOB ПЛAHИPOBЩИKA
C 24    БЛOKИPOBKA ПPOBEPKИ PECYPCOB   ПPИ
C       PAБOTE ПЛAHИPOBЩИKA
C 16    ИЗMEHEHИE PEЖИMA ЭKOHOMИИ БYMAГИ
C       BO BPEMЯ CЧETA ЗAДAЧИ
C 13    ЗAПYCK ПOГИБШИX ЗAДAЧ ИЗ ФAЙЛA
C       BBOДA ПPИ ПEPEBЫЗOBE ДИCПETЧEPA
C 12-11 ПPИ HAЛИЧИИ MYЛЬTИПЛEKCOPA ГOИ:
C       PAЗPEШEHИE PAБOTЫ MYЛЬTИПЛEKCOPA
C       HA 12-11 P. ПPП
C 09    БЛOKИPOBKA OЖИДAHИЯ OTBETA OПEPATO-
C       PA ПOCЛE ПEPФOPAЦИИ ПPИ ABTOBЫBOДE.
C 08    PAЗPEШEHИE OПOЗHABAHИЯ ДИCПAKOBCKИX
C       MAГHИTHЫX ЛEHT.
C 07    OБЯЗATEЛЬHЫЙ OCTAHOB ПPИ KK И KЧ.
C 06    PEЖИM OTЛAДKИ ДЛЯ ПЛAHИPOBЩИKA.
C 05    БEЗYCЛOBHAЯ ПEЧATЬ HA AЦПY ABOCTHOЙ
C       ДИAГHOCTИKИ.
C 03-01 HOMEP ПPИKAЗA ПPИ BЫДAЧE C ПYЛЬTA
C
C          7 Й TYMБЛEPHЫЙ PEГИCTP
C
C 48    ПAMЯTЬ 32K.
C 47    PAБOTAET TOЛЬKO CEГMEHT ПAMЯTИ,
C       BЫБPAHHЫЙ KHOПKOЙ ПCП (ИMEET CMЫCЛ
C       ПPИ ПAMЯTИ 128K, CPAБATЫBAET TOЛЬKO
C       ПPИ ПEPEBЫЗOBE ДИCПETЧEPA).
C 46-45 БЛOKИPOBKA AЦПY (0,1).
C 44-43 БЛOKИPOBKA ПИ-80 (0,1).
C 42-41 БЛOKИPOBKA ПЛ  (0-1)
C 40-39 CЖATИE ЛИCTИHГA HA AЦПY (0-1)
C 38    БЛOKИPOBKA ПACПOPTA MACCИBA B Э73
C 36-34 HOMEP MAШИHЫ.
C 34-33 TAKЖE ПPИЗHAK EC-ПEЧATEЙ BMECTO
C       0-1X AЦПY, COOTBETCTBEHHO.
C 32    БЛOKИPOBKA ЗAПИCИ DAYFILE B ФAЙЛ CTATИCTИKИ.
C 31    БЛOKИPOBKA ПOДBOДA ЛEHT LIBRARY.
C 30    KAPTA *PASS OБЯЗATEЛЬHA.
C       (ПPOИЗBOДИTCЯ CБOP ПOЛЬЗ.CTATИCTИKИ)
C 27    BOЗMOЖEH ФOHOBЫЙ ПPИOPИTET ШИФPY 1.
C 25-03 KYC ДЛЯ BЫЗOBA ДИCПETЧEPA ПO 9ПП.
C 02    HOMEP ФC (B ДYБHE ПPИЗHAK HE CDC405)
C 01    HOMEP ЗAПYCKAEMOГO YBBK (ECЛИ 2 ГO-
C       TOBЫ).
 ,END,
 *STRUCT1:,NAME,
C
C******          B H И M A H И E
C
C        BCE ЭKCTPAKOДЫ,KOTOPЫE MOГYT
C        ПPEPЫBATЬCЯ, B TOM ЧИCЛE ИЗ-ЗA
C        OБPAЩEHИЙ ПO MAT. AДPECY ИЛИ
C        ИЗ-ЗA TPACCИPOBKИ, ДOЛЖHЫ BOЗ-
C        BPAЩATЬ YПPABЛEHИE ЧEPEЗ
C        RETURN  ИЛИ  OUTMACRO
C        ДЛЯ ПPABИЛЬHOЙ PAБOTЫ OTЛAДЧИ-
C        KOB - ИHTEPAKTИBHOГO И ПAKETHOГO
C
C******    ECЛИ ДИCПETЧEP HA ДИCKE :
C        B DISPBASE HEOБXOДИMO OTMETИTЬ 2 MБ
C        (HEOБЯЗATEЛЬHO ПOДPЯД),   ФИЗИЧECKИ
C        OTCYTCTBYЮЩИX HA MAШИHE.    B ДYБHE
C        ЭTO MБ 16 И 17. OБPAЩEHИЯ K ЭTИM MБ
C        ПEPEAДPECYЮTCЯ HA  ФAЙЛ   9/MONSYS
C        C 400-Й ЗOHЫ. ДИCПETЧEPCKOE XOЗЯЙCTBO
C        ПOДPAЗДEЛЯETCЯ HA HECKOЛЬKO ЭKCTEHTOB:
C        400-437  : CБOPKA БЫBШИX CПEЦ-TPAKTOB:
C              0  : БYФEPHЫЙ TPAKT CTATИCTИKИ
C              1  : ROLL-TPAKT
C              2  : PASS'Ы
C            3-4  : Ф И O
C              5  : OTДEЛЫ
C           10-17 : CП ЭKCTPAKOДA 66
C           20-27 : OБCЛYГA
C              30 : PAБ. TPAKT ПЛAHИPOBЩИKA
C              31 : ЛИMИTЫ БYMAГИ
C           32-33 : FORMMESS
C           34-36 : ПYCKAЧИ CTAHД.ЗAДAЧ
C              37 : HOBOCTИ
C        440-477  : ДИCПETЧEP HOMEP 0
C        500-...  : ДИCПETЧEP HOMEP 1,2,...
C                   (CKOЛЬKO XBATИT MECTA)
C        HOMEP ДИCПETЧEPA ПPИ BЫЗOBE C ДИCKA
C        YKAЗЫBAETCЯ B 31-33 P. TP2
C        HACTPOЙKA ДИCПETЧEPA HA MБ 17 (BTOPOЙ
C        ИЗ OTMEЧEHHЫX MБ), A TAKЖE YCTAHOBKA
C        YKAЗATEЛEЙ ROLL-TPAKTA, БYФEPA CTAT-KИ
C        И TAБЛ.PASS-OB HA MБ 16 (ПEPBЫЙ ИЗ
C        OTMEЧEHHЫX MБ) ПPOИЗBOДИTCЯ ABTOMATИ-
C        ЧECKИ ПPИ BЫЗOBE ДИCПETЧEPA C ДИCKA.
C        ПPИ BЫЗOBE ДИCПETЧEPA C БAPAБAHA
C        HEOБXOДИMO OБECПEЧИTЬ HAЛИЧИE PASS'OB
C        HA MБ COГЛACHO YKAЗATEЛЮ B *USESTA.
C
C
C******  ПPИ PAБOTE HECKOЛЬKИX MAШИH
C        C OДHИM  K M Д  CПEЦ-ФAЙЛЫ
C        OПOЗHAЮTCЯ ПPИ COBПAДEHИИ TPEX
C        ПOCЛEДHИX БИTOB ИMEHИ MASTER C
C        HOMEPOM ЭBM (48-47 P. DISPBASE+6)
C        ФAЙЛЫ 5/D73LIB, 9/MONSYS, 7/M
C        И ФAЙЛЫ C OБCП ЯBЛЯЮTCЯ OБЩИMИ.
C        ЗABEДOMO HE MOГYT БЫTЬ OБЩИMИ
C        CПEЦ.ФAЙЛЫ : 6/D73STA , 10/USESTA
C                     1/ROLLIB , 11/LINBUF
C        A  TAKЖE BCE SCRATCH-ФAЙЛЫ .
C
C
C
C****** B CEHTЯБPE 1984 B Г.AЛMA-ATA
C   И.A.EMEЛИHЫM БЫЛA ПPEДЛOЖEHA ЛEГKO
C   PEAЛИЗYEMAЯ ПEPEПAЙKA B KBY, ПOЗBO-
C   ЛЯЮЩAЯ OCYЩECTBЛЯTЬ OПEPATИBHYЮ
C   ИHФOPMAЦИOHHYЮ CBЯЗЬ MEЖДY ДBYMЯ
C   COCEДHИMИ БЭCM-6.
C   HA ЭTOЙ OCHOBE MOЖHO ЭФФEKTИBHO
C   OPГAHИЗOBATЬ PAБOTY ДBYX MAШИH C
C   OБЩИM KMД (CM. П/П  "K COCEДY").
C   ЗДECЬ MЫ ПEPEЧИCЛИM TO, ЧTO YЖE
C   CДEЛAHO B ДИCПETЧEPE ПO ЭTOMY
C   ПOBOДY :
C   1. ЛИЧHЫE ФAЙЛЫ ПOЛЬЗOBATEЛEЙ.
C    OПPOC ЗAHЯTOCTИ ПPИ ИX ЗAKAЗE
C    ПPOИЗBOДИTCЯ OДHOBPEMEHHO HA
C    OБOИX CBЯЗAHHЫX MAШИHAX;
C   2. SCRATCH-ФAЙЛЫ. HA KAЖДOЙ MAШИHE
C                    - CBOЙ KOMПЛEKT .
C   3. CПEЦФAЙЛ  7/M.  CИHXPOHИЗAЦИЯ,ИX TИПЫ + ШKAЛA Ф.C.
C    OБECПEЧEHA ЗA CЧET ПPOBEPKИ PASS
C    ПPИ BXOДE B CEAHC MYЛЬTИTAЙПA HA
C    OБOИX CBЯЗAHHЫX MAШИHAX;
C   4. BBOД,BЫBOД,ГPAФИKA. CИHXPOHИЗAЦИЯ
C    C ПOMOЩЬЮ OБЩИX ДЛЯ OБOИX CBЯЗAHHЫX
C    MAШИH CEMAФOPOB ДOCTYПA K KATAЛOГAM;
C
C
C
C******  ИHФOPMAЦИOHHOE ПOЛE ДИCПETЧEPA
C
  *ИПД:LC,BLOCK,
C---------   HAЧ.HOMEPA ЗAДAЧ PAЗHЫX TИПOB
   0,CONT,XNF     .ДHЗ ПEPBOЙ CЛYЖEБHOЙ
   1,CONT,XNFM    .ДHЗ ПEPBOЙ C ПOЛHЫM ИПЗ
   2,CONT,XNFD    .ДHЗ ПEPBOЙ TEPMИHAЛЬHOЙ
   3,CONT,XNFB    .ДHЗ ПEPBOЙ ПOTOKOBOЙ
   4,CONT,XNW     .ДHЗ 'ЖДY'
C---------   KOЛИЧECTBA ЗAДAЧ PAЗHЫX TИПOB
   5,CONT,XNC     .K-BO BCEX MAT.ЗAДAЧ
   6,CONT,XNCM    .K-BO ЗAДAЧ C ПOЛHЫM ИПЗ
   7,CONT,XNSEM   .K-BO CEMAФOPOB
C---------   ШKAЛЫ ЗAДAЧ ПO TИПAM
  10,CONT,Ш/CЛYЖ  .ШK.CЛYЖ.ЗAДAЧ
  11,CONT,Ш/FULL  .ШK.ЗAДAЧ C ПOЛH.ИПЗ
  12,CONT,Ш/ПOTOK .ШK.ЗAДAЧ ДЛЯ ПOTOKA
  13,CONT,Ш/ПYCK  .ШK.ЗAДAЧ ПO ПYCK MYЛЬTИTAЙПA
  14,CONT,Ш/OTЛ   .ШK.ЗAДAЧ OTЛAДKИ
  15,CONT,Ш/CBЯ   .ШK.CBЯЗHЫX ЗAДAЧ
  16,CONT,*INCOGNI.ШK.ЗAДAЧ 'ИHKOГHИTO'
C---------   PAЗHЫE ЗAДABAEMЫE XAPAKTEPИCTИKИ
  17,CONT,MБД     .ШK.MOДEЛИPYEMЫX MAT.MБ
  20,CONT,LFATA   .ДЛИHA TAБЛИЦЫ ФAЙЛOB
  21,CONT,XLTDIS  .ДЛИHA TAБЛИЦЫ ЭKCTEHTOB
  22,CONT,XLTPH   .K-BO ФИЗ.ЛИCTOB
  23,CONT,Ш/ДИCП  .ШK.ДИCПETЧEPCKИX ЗAДAЧ
 24,CONT,INDI SC .ШK.ИHДИKAЦИИ ЗAДAЧ
 25,CONT,INDI M  .MACKA PACПAKOBKИ
 26,CONT,XLSMB   .ДЛИHA БYФEPA PEДAKTИP.
  27,CONT,XLQTRA.ДЛИHA OЧ.OБMEHOB
  30,CONT,XLQTIM.ДЛИHA OЧ.TAЙMEPOB
  31,CONT,(2).PEЗEPB
C---------   PAЗHЫE ФЛAГИ ДИCПETЧEPA
  33,CONT,MONOS   .ШK.MOHOП.MД
  34,CONT,FREXT   .CЧ-K CBOБ.ЭKCTEHTOB
  35,CONT,LISTFLAG.ШK.БYФEPИЗYEMЫX ЗAДAЧ
 36,CONT,(1)     .PEЗEPB
 37,CONT,C/BUF   .ШK.БYФEPИЗ.BЫBOДA
  40,CONT,BATCH   .PEЖИMЫ БYФEPИЗAЦИИ BBOДA
  41,CONT,BATCH/S .ШK.CTOП-ПOTOKOB
  42,CONT,ИПЗ/ECTЬ.ФЛAГИ: ИПЗ B ПAMЯTИ
 43,CONT,ШK/TП.ПPИOP.ПЛAH-KA
  44,CONT,PRTFLAG .ФЛAГ BЫЧИCЛEHИЯ ПPИOP.ЗAДAЧ
 45,CONT,STARTCW .ШK.CTAPTYЮЩИX ЗAДAЧ
 46,CONT,SC/SWOUT.CHЯTЬ ПOДKAЧKOЙ
 47,CONT,ШK/ФП.ПPИOPИTETЫ
 50,CONT,ШK/БП.ДЛЯ
 51,CONT,ШK/ПП.ПЛAHИPOBЩИKA
C---------   PAБOЧИE ШKAЛЫ C БИTOM ЗAДAЧИ
  52,CONT,OUTJOBSC.CHЯTЫ OПEPATOPOM
  53,CONT,LIMTSC  .ИCЧEPПAH ЛИMИT BPEMEHИ
  54,CONT,LIMLPSC .ИCЧEPПAH ЛИMИT БYMAГИ
  55,CONT,БЫЛ*64  .ЗAДAЧA ПOДABAЛA Э064
  56,CONT,SCOUT   .HET PECYPCA BЫBOДA
  57,CONT,SCMAMБ  .ЗAKPЫTЫ ПO MAЛOMБ
  60,CONT,ROLOUTSC.YПPЯTЫBAЮTCЯ
  61,CONT,SCEM*64 .ФЛAГ *WRBF64 /ДЛЯ EMUL/
  62,CONT,FLERBUS .ЗAHЯTOCTЬ ERRMACRO
  63,CONT,EXTSC   .ШK.ПEPEXBATOB AЦПY
  64,CONT,ERRSC   .KOHEЦ ЗAДAЧИ ПO OШИБKE
  65,CONT,ПAPTИЗAH.ШK.CПEЦИAЛЬHЫX ЗAДAЧ
  66,CONT,БЛOKAЦПY.БЛOKИPOBKA BЫBOДA
  67,CONT,MOЖHOKAЧ.ФЛ.BOЗMOЖHOCTИ YKAЧKИ ИПЗ
  70,CONT,ШKП     .ШK.ЗAДAЧ C ПEPEXBATOM ЭK74
    71,CONT,SC/DEBUG.ЗAДAЧИ C OTЛAДЧИKOM
    72,CONT,LIB/BOSS.ЗAДAЧИ,ЗAXBATИBШИE LIBRARY
 73,CONT,PRTSW.БИT ЗAДAЧИ C
C            BЫCOKИM ПPИOPИTETOM HA
C            BPEMЯ ПOДKAЧKИ.
  74,CONT,SPSC.KOГO HE ГPAБИT SWING
 75,CONT,SC/PLAN .ФЛAГИ ПЛAHИPOBЩИKA
 76,CONT,БЫЛ*ПФ  .БЫЛA ПEPФOPAЦИЯ
  77,CONT,SCENDJO .ФЛAГИ ЭK74
C
C******
C
   NFM:,WEQ,XNFM
   NFD:,WEQ,XNFD
   NFB:,WEQ,XNFB
   NC :,WEQ,XNC
   NCM:,WEQ,XNCM
  LTPH:,WEQ,XLTPH
C
C******  ИHФOPMAЦИOHHЫE ПOЛЯ KAHAЛOB
C
  *ИПK :LC,BLOCK,*INFBA.ПOTOK
   INFEX   :,EQU,*INFBA  + NCM.YC MT-ПYCKA
   AДP/ИПЗ :,EQU,INFEX   + NCM.AДPECA OTKAЧAHHЫX ИПЗ
C
  *ИПK1:LC,BLOCK,
   PRTSTAT :,EQU,*ИПK1       .ЧИCЛA ПPИOPИTETA
   MONO    :,EQU,PRTSTAT +NC .MOHOПOЛИИ HA MД
C
C****** ИHФOPMAЦИOHHOE ПOЛE ЗAДAЧИ
C
  W/NRCALL:,EQU,-3.PAБ.ЯЧ.NRESCALL
  TIC     :,EQU,-1.CЧETHOE BPEMЯ
  *0:B,BLOCK,SUMMATOR(24).PEГИCTPЫ
   30,CONT,TMATH(40)   .MAT.ЛИCTЫ
  100,CONT,REGSCAL     .PAЗHЫE ФЛAГИ
  101,CONT,OШBHYПP     .Э67,Э72
  102,CONT,M72         .Э64,Э71
  103,CONT,BUFI14      .Э70,Э75
  104,CONT,BUFS27      .Э70,Э75
  105,CONT,M75         .Э64,Э71
  106,CONT,COPYS33     .Э67
  107,CONT,RETM67      .Э67
  110,CONT,T I B       .KOMM.BPEMЯ
  111,CONT,TLIM        .ЛИMИT BPEMEHИ
 112,CONT,ДШ      .ДEШИФP.BETBЛEHИЯ
  113,CONT,PULT        .IFPULT
  114,CONT,PASS        .PASS/ШИФP Д-68
  115,CONT,SYSMD       .MБ 21-22 HA MД
  116,CONT,LIMITLP     .ЛИMИT БYMAГИ
  117,CONT, A U S      .CTATИCTИKA
C           B48/37 - HOMEP ПOДPAЗДEЛEHИЯ (2-10 KOД)
C           B36/21 - HOMEP TEMЫ (2-10 KOД)
C           B15/01 - AДPEC ПO TPASS (OTHOC.)
  120,CONT,NAME(3)     .*NAME
  123,CONT, S C E M    .EMULATOR
  124,CONT,TLIMS       .SAVE TLIM(БYДИЛЬHИKИ)
  125,CONT,I60/74      .ПEPEXBAT Э060,Э074
  126,CONT,LPSTR       .K-BO OTПEЧ.CTPOK
  127,CONT, M Л Д      .ШK.MAT.HOMEPOB ДИCK.ФAЙЛOB
  130,CONT, P Л Д      .ШK.MAT.HOMEPOB SCR.-ФAЙЛOB
  131,CONT,WS/OUT(4)   .P/Я БYФEPИЗAЦИИ BЫBOДA
 135,CONT,WS/ПФ(21).PAБ.ЯЧ.ПEPФOPAЦИИ
  162,CONT,LOMIDZSC.KAHAЛЫ Ф.CИCTEMЫ
  163,CONT, П T P (10) .TPAKTЫ ДЛЯ ПOДKAЧKИ
  175,CONT,MATMБ(192)  .TPAKTЫ MAT.MБ
  475,CONT,FIELD1EM(16).PAБ.ПOЛE 1 /EMULATOR/
  515,CONT,FIELD2EM(16).PAБ.ПOЛE 2 /EMULATOR/
  535,CONT,БYФИПЗ(22)  .PAБ.ПOЛE ERRMACRO
 563,CONT,ИP/34.ИHФ OTЛAДKИ
 564,CONT,SCJOTЛ.PAБOTЫ OTЛAДKИ
 565,CONT,DEBS33.MECTO ПPEPЫB. ПO OTЛAДKE
C-----------   ИHФOPMAЦИЯ ПO CTATИCTИKE ЗAДAЧ
 566,CONT,ФИO(2).B KOДE ГOCT
 570,CONT,CNTEXCH.CЧETЧИKИ OБMEHOB
C           B48/31 - ЧИCЛO MБ-OБMEHOB
C           B30/13 - ЧИCЛO MД-OБMEHOB
C           B12/01 - ЧИCЛO MЛ-OБMEHOB
 571,CONT,STAT1
C           B48    - БЫЛ OБMEH C TEPMИHAЛOM
C           B47/46 - TИП KOHЦA ЗAДAЧИ
C                    0 - ЗAДAЧA CHЯTA (И OШИБKИ)
C                    1 - ЛИMИT BPEMEHИ
C                    2 - ЛИMИT БYMAГИ
C                    3 - HOPMAЛЬHЫЙ KOHEЦ
C   B45 - БЫЛ ЗAПPET ABTOPACПEЧATKИ
C   B44 - OTMEHA HYMEPAЦИИ CTPAHИЦ
C         ПPИ ПEЧATИ ЛИCTИHГA
C*   B43 - ГPAФИKA EЩE HE BЫBEДEHA
C*   B42:40 - TИП ГPAФПЛOTTEPA
C   B39-25 - BBEДEHO ПФK
C           B24/01 - BBEДEHO CИMBOЛOB ПФЛ
 572,CONT,STAT2
C   B48 - PEЗEPB
C  B47-46  TИП ЗAДAЧИ(0-ПOTOK,1-TEPM,2-BBOД)
C   B45-40 - PEЗEPB
C   B39-25 - BЫBEДEHO ПФK
C           B24/01 - BЫBEДEHO CИMBOЛOB ПФЛ
 573,CONT,STAT3.ИCП.БИБЛИOTEKИ
C-----------
 574,CONT,STAT4(2).PAБ.ЯЧ. ЭK74
 576,CONT,ФИO/ISO(2).ФИO B ISO
 600,CONT,WS/71(6).PAБ.ПOЛE ЭK71
 606,CONT,(7)     .PEЗEPB
 615,CONT,WS/DEBUG(32).PAБ.ПOЛE OTЛAДЧИKA
  655,CONT,AFIL(5).ИMЯ MT-БYФEPA
 662,CONT,YПP/71(14).BETBЛEHИE-71
  700,CONT,(57). P E З E P B
  *771:B,BLOCK,MADRES.TEK.AДPEC "MЯЧ"
  772,CONT,WS/DEB2(6).PAБ.ЯЧ.OTЛAДЧИKA
  777,CONT,DRU/MEM.ШK.MБ,MOДEЛИ-
 1000,CONT,ИП PEД(509) .ИПЗ PEДAKTИPOBAHИЯ Э064
C
C******  MACCИB CEMAФOPOB ДИCПETЧEPA
C
 ШЛAГБAYM:LC,BLOCK,
  0,CONT,ЗAKAЗMЛ .ЭK57(10-7777)
   1,CONT,ЗAKAЗMД .ЭK57(77777)
   2,CONT,SEM/OUT .KATAЛOГ BЫBOДA
   3,CONT,SEM/IN  .KATAЛOГ BBOДA
   4,CONT,SEMDISC .ЗAKAЗ PECYPCOB
   5,CONT,CALLBSC .NRESCALL
   6,CONT,SCAL73  .ЭK73
   7,CONT,SCEM*CЛY.CЛYЖ.ЗAДAЧA HA TELOUT'E
  10,CONT,CLT     .ЭK66
  11,CONT,SEM212.ДOCTYП K ЧYЖOЙ ПAMЯTИ
 12,CONT,SEMPOST.ПOЧTOBAЯ CЛYЖБA
 13,CONT,SEM/GRF.KATAЛOГ ГPAФИKOB
  14,CONT,SEM/SEND.CBЯЗЬ 2 БЭCM
  15,CONT,SEMLP.EC-AЦПY
C
C*****   ШKAЛЫ ЗAДAЧ ПO YCTPOЙCTBAM
C
 SCALES:LC,BLOCK,
   0,CONT,PRTMASK .MACKA ПPИOPИTETHЫX ЗAДAЧ
   1,CONT,MRDSCAL .MACKA ШKAЛЫ ГOTOBHOCTИ
   2,CONT,S1CLTA  .ЗAKPЫTЫE ПO MAЛOMБ
   3,CONT,STCLTA  .BPEMEHHO-ЗAKPЫTЫE ЗAДAЧИ
   4,CONT,STATUSMT.OЖИДAЮЩИE ЛEHTЫ
   5,CONT,SC/YBBK .ЗAДAЧИ HA ЧИTAЛKE
   6,CONT,SCWPRIN .ЗAДAЧИ HA HEГOT.AЦПY
   7,CONT,SCWPERF .ЗAДAЧИ HA HEГOT.ПИ/ПЛ
  10,CONT,SCLTWJ  .ЗAДAЧИ HA ПAYЗE
 11,CONT,SCSTOP  .ЗAДAЧИ OCTAH.OTЛAДЧИKOM
 12,CONT,SC/CLJ.ЗAДAЧИ,ЗAKPЫTЫE ПO ABAPИЯM ПPИ ДИAЛOГE
C
C
C*****  ИCПOЛЬЗOBAHИE ФOPMAЛЬHЫX ЛИCTOB:
C
C   40 : *WRBF64 (TOTAЛЬHO)
C   41 : OTЛAДЧИK (ЛOKAЛЬHO)
C        NRES066 (ЛOKAЛЬHO)
C   44 : ГPAФOP-ФИAЭ(ГЛOБAЛЬHO)
C   45 : ZOO60    (TOTAЛЬHO)
C   46 : PROC/OUT (ЛOKAЛЬHO)
C        И ГPAФOP-ФИAЭ(ЛOKAЛЬHO)
C
C
C*****   CTPYKTYPA REGSCAL
C
C   B48 - PAЗPEШEHИE ФИЗ.ДEЙCTBИЙ
C   B47 - ........
C   B46 - PAЗPEШEHИE HA ИHTEPПPETAЦИЮ
C         Э75  C  AИCП = 0 ; 1
C   B44 - ПPOTЯЖKИ B HAЧ.ЛИCTA ДЛЯ Э64:1=ECTЬ,0=HET
C   B43 - ECTЬ PEAKЦИЯ HA ABOCTЫ
C   B40 - 48-MИTEPMИHAЛЬHЫЙ PEЖИM ДЛЯ
C         ДИCПAKOBCKOГO  Э71
C   B39 - ЗAKAЗ HA ПEPEKAЧKY CЛYЖ.CЛOB
C         ПOCЛE OБMEHA C MЛ ИЛИ MД
C         B 150-157 CЛOBA ИПЗ ЗAДAЧИ.
C   B38 - PAЗPEШEHИE ДИAЛOГA ПPИ
C         ЭMYЛЯЦИИ Э071 ДИCПAKA
C   B30 - БЛOKИPOBKA ПPOBEPKИ ЗAHЯTOCTИ
C         ПPИ ЗAKAЗE ФAЙЛOB.
C   B19 - OCTAHOB ПO AЧ (OTЛAДЧИK)
C  B18 - OCTAHOB ПO AKOM (OTЛAДЧИK)
C   B16 - ПPИЗHAK ЛИCTOBAHИЯ ПPИ ПEЧATИ
C   B15 - BЫBOД HA TEPMИHAЛ OT Э71
C         HEOБЯЗATEЛEH.
C   B12 - PEЖИM   A B T Б (!)
C   B09 - ИCПOЛЬЗOBAH ЛИMИT ПPИOPИTETA
C   B08 - Э64 BЫBOДИT HA TEPMИHAЛ И AЦПY
C   B07 - Э64 BЫBOДИT TOЛЬKO HA TEPMИHAЛ
C   B05 - OCTAHOB ПO ЗП/ЧT ПPИ COBПAД. И35
C         =1 - ЗAПИCЬ ; =0 - ЧTEHИE
C   B04 - =1 - PEЖИM ЗAПИCИ KOMAHД
C         =0 - PEЖИM ЗAПИCИ ЧИCEЛ
C
C
C
C*****   CTPYKTYPA *INFBA
C
C 48    - PEЖИM ПPOTOKOЛA
C 47-46 - HOMEP ЭBM ИЗ DISPBASE(7)
C 43    - "CEPЬEЗHAЯ" ЗAДAЧA
C 42-37 - ФИЗ. HOMEP TEPMИHAЛA, C KOTOPOГO
C         ЗAПYЩEHA ЗAДAЧA
C 36-31 - HOMEP ПO BЫBOДY
C 30-25 - HOMEP ПO BBOДY
C 24-19 - HOMEP ЛИHИИ, OTKYДA ЗAДAЧA
C         (NЛAБ):
C         B24 - C KOHЦEHTPATOPA
C         B23-22 - . . . . . .
C         B21 - BBEДEHO HA БЭCM-6
C         B20 - . . . . . .
C         B19 - OT MYЛЬTИTAЙПA
C 18    - MHOГOTEPMИHAЛЬHAЯ ЗAДAЧA (ПO CBЯЗИ)
C 17    - ДИAЛOГOBAЯ ЗAДAЧA (ПO CBЯЗИ)
C 16-01 - ID ЮЗEPA.
C
C
C
C*****   TAБЛИЦA HEPEЗИДEHTOB NRTABL
C         OДHO CЛOBO HA MAT.ЛИCT
C      (ПO TAБЛИЦE ЗAГPYЗKИ ДИCПETЧEPA)
C
C    1-5  : HOMEP ФИЗ.ЛИCTA ИЛИ 0
C   16-20 : CЧETЧИK ЧИCЛA ЗAДAЧ, AKTИBHO
C           BЛAДEЮЩИX ЛИCTOM HEPEЗИДEHTA
C   45-21 : ШKAЛA ЗAДAЧ, KOГДA-ЛИБO ПOЛЬ-
C           ЗOBABШИX ЛИCT (45-OПOЗHABAHИE,
C           44-Ш30, 43-Ш27, ..., 21-Ш1 )
C     46  : ПPИЗHAK, ЧTO NRESOFF HE ДOЛЖEH
C           PACФИKCИPOBATЬ ЛИCT (CM.PRINTASK)
C     47  : ПPИЗHAK ПEPECЧETA ПPИOPИTETA
C           ДЛЯ HEPEЗИДEHTHOГO ЛИCTA
C
C
C       B KAЖДOM HEPEЗИДEHTHOM ЛИCTE
C     0 CЛOBO = ЧИCЛO HEPEЗИДEHTOB  N
C   1-N CЛOBA = ДECKPИПTOPЫ HEPEЗИДEHTOB :
C       1:15  - ИДEHTИФИKATOP HEPEЗИДEHTA
C               (AДPEC ПO TAБЛИЦE ЗAГPYЗKИ)
C      48:16  - ШKAЛA ЗAДAЧ, ЗAXBATИBШИX
C               ЭTOT HEPEЗИДEHT
C
C
C
C*****  ИCПOЛЬЗOBAHИE ИCTИHHЫX AДPECOB:
C
C     A)  ПPИ ИHИЦИAЛИЗAЦИИ ДИCПETЧEPA
C       100-477 : TESTTRAK
C       230-277 : DISPINIT,PRINTDR
C       600-676 : CBOБOДHO
C
C    Б)  B PAБOЧEM PEЖИME
C         100   : HOMEPA ЛИHИЙ CBЯЗИ
C         101   : ДИPEKTИBA OПEPATOPA
C       102-120 : БYФEP ЭK."TTPRINT"
C       121-126 : БYФEP ЭK.ЗAMEHЫ CTPAHИЦ
C       127-326 : БYФEP TTTASK
C       327-357 : ИПЗ   TTTASK
C       360-424 : ИПЗ  "ЖДY"
C       425-435 : TAБЛ.SCR-OБЛ. (TSA)
C       436-477 : БYФEPA ПPИKAЗA "TEЛ"
C       500-577 : MAINSW
C       600-630 : ИПЗ  OKHA
C       631-676 : ИПЗ  OПOЗHABAHИЯ
C         677   : ДOЛЖHA БЫTЬ ПYCTOЙ
C       700-777 : MAINSW
C
 ,END,
  FREQ300:,NAME,
  FREQ300:,STEXT,. *** ЧACTOTA = 300 ГEPЦ
  FREQ:,EQU,300
  B*START:,EQU,0
  ГMAC:,MACRO,KOП
   ,KOП,.HET ПPИOPИTETOB
  ГMAC:,ENDM,
C
C    ПO 10 P. ГPП - HE ПPEPЫBAEMCЯ.
C    ПO 40 P. ГPП - ПPEP. C ЧACT. 300
C    OT ГPП-40 PAБOTAЮT ДPYГ ЗA ДPYГOM :
C       BIO*TL   - OБCЛYЖИBAHИE TL-PEГИCTPA
C       ITIMEB10 - HAЧИCЛEHИE BPEMEH ЗAДAЧAM
C       PR/TIMER - TO, ЧTO PAHЬШE БЫЛO HA
C                  ГPП-10.
C
  ,END,
  FREQ150:,NAME,
  FREQ150:,STEXT,. *** ЧACTOTA = 150 ГEPЦ
  FREQ:,EQU,150
  B*START:,EQU,0
  ГMAC:,MACRO,KOП
  ,KOП,
  ГMAC:,ENDM,
  ,END,
  FREQ600:,NAME,
  FREQ600:,STEXT,. *** ЧACTOTA = 600 ГEPЦ
  FREQ:,EQU,600
  B*START:,EQU,721B
  ГMAC:,MACRO,KOП
  ,KOП,=:6010 01
  ГMAC:,ENDM,
C
C    ПO ГPП-10 ПPEPЫBAEMCЯ C ЧACT. 150
C    ПPИ ЭTOM PAБOTAЮT: ITIMEB10,PR/TIMER.
C    ПO ГPП-31 ПPEPЫBAEMCЯ ПPИ ПOЯBЛEHИИ
C    CTAPTOBOГO БИTA B TL-PEГИCTPE.
C    ПPИ ЭTOM PAЗPEШAЮTCЯ ПPEPЫBAHИЯ ПO
C    ГPП-40 (ЧACTOTA 600), OT KOTOPЫX
C    PAБOTAET TOЛЬKO  BIO*TL.
C
C    OБECПEЧИBAETCЯ ПOBЫШEHИE ПPИOPИTETA
C    ПPEPЫBAHИЯM ПO 40 И 31 PAЗPЯДAM ГPП.
C
  ,END,
  FREQ1200:,NAME,
  FREQ1200:,STEXT,. *** ЧACTOTA = 1200 ГEPЦ
  FREQ:,EQU,1200
  B*START:,EQU,721B
  ГMAC:,MACRO,KOП
  ,KOП,=:6010 01
  ГMAC:,ENDM,
  ,END,
 *STRUCT2:,NAME,.TEPM. XOЗЯЙCTBO
C
C
C    ДЛЯ ЗAДAHИЯ KOHФИГYPAЦИИ TEPMИHAЛЬHOГO
C       KOMПЛEKCA HEOБXOДИMO:
C    1. B П/П *TLSIZE YKAЗATЬ ФAKTИЧECKOE
C       ЧИCЛO TEPMИHAЛOB PAЗЛИЧHЫX TИПOB,
C       ПOДKЛЮЧEHHЫX K MAШИHE,  + 1.
C       ЭTA KOHCTAHTA ИCПOЛЬЗYETCЯ ПPИ ЗA-
C       ГPYЗKE ДИCПETЧEPA И ДOЛЖHA COOTBET-
C       CTBOBATЬ ДЛИHE П/П *TLBUFI .
C    2. B П/П *TLPRMT B MACKAX MIN И MOT
C       OTMETИTЬ CYЩECTBYЮЩИE TEPMИHAЛЬHЫE
C       KAHAЛЫ B COOTBETCTBИИ C ИX TИПAMИ.
C       ЧИCЛO "1" B KAЖДOЙ ИЗ MACOK ДOЛЖHO
C       COOTBETCTBOBATЬ ДЛИHE П/П *TLBUFI .
C       MЛAДШИE PAЗPЯДЫ MIN И MOT ПEPEHO-
C       CЯTCЯ TAKЖE B ШKAЛЫ, OПИCЫBAЮЩИE
C       E-XAPAKTEPИCTИKY TEЛEГP.PEГИCTPOB.
C    3. B П/П *TLBUFI YKAЗATЬ TИПЫ TEPMИHA-
C       ЛOB И KAHAЛOB B COOTBETCTBИИ C OПИ-
C       CAHИEM. HOMEP ЯЧEЙKИ ПO *TLBUFI
C       (1,2,...) ECTЬ BИPTYAЛЬHЫЙ ФИЗИЧEC-
C       KИЙ HOMEP KAHAЛA.
C
C       MAKCИMAЛЬHOE ЧИCЛO TEPMИHAЛЬHЫX
C       KAHAЛOB = 24.
C
C
C
C      ПEPEXOД HA ЧACTOTY 600 ИЛИ 1200 ГЦ.
C
C
C   I. ИЗMEHEHИЯ B MAШИHE.
C
C       31-Й PAЗPЯД ГPП ДOЛЖEH PAБOTATЬ TAK,
C    KAK ЭTO  OПИCAHO  B  ДEBЯTOM TOME - ЭTO
C    ПPИЗHAK ПPИXOДA CTAPTOBOГO C OДHOГO  ИЗ
C    TEЛEГPAФHЫX  KAHAЛOB,  TOЧHEE - ПPИЗHAK
C    '1' B OДHOM ИЗ KAHAЛOB.  CИГHAЛ БEPETCЯ
C    C ЯЧ.  Б C T ,  ГДE OH ФOPMИPYETCЯ,  HO
C    ДAЛEE HИKYДA HE ИДET.  EГO HAДO ДOBECTИ
C    ДO  Y B Y ,  ГДE ECTЬ BXOД 31-ГO PAЗPЯ-
C    ДA  Г P П .  HA ЭTOT BXOД  EГO  CЛEДYET
C    ПOДABATЬ  ЧEPEЗ  ЭM.  ПOBTOPИTEЛЬ  (ДЛЯ
C    PAЗBЯЗKИ).
C    BMECTO 31 PAЗPЯДA ГPП MOЖHO BЗЯTЬ
C    ЛЮБOЙ ДPYГOЙ, YKAЗAB EГO B HACTPO-
C    EЧHOЙ ПPOГPAMME "FREQ...".
C
C   II. ГEHEPAЦИЯ ДИCПETЧEPA.
C
C       ПPOГPAMMЫ
C            BIO*TL
C            SER*OUT
C            PR/TIMER
C            ITIMEB10
C    TPAHCЛИPOBATЬ HA  MADLEN3  C ПAPAMETPOM
C    STEXT = FREQ600 ИЛИ FREQ1200
C        ДЛЯ ИЗMEHEHИЯ БИTA CБOPKИ CTAPTOBЫX
C    HA ГPП HYЖHO ИCПPABИTЬ ЗHAЧEHИE B*START
C    B COOTBETCTBYЮЩEЙ ПPOГPAMME.
C    TPAHCЛЯЦИЯ CИCTEMHOГO TEKCTA (FREQ...)
C    ДOЛЖHA OCYЩECTBЛЯTЬCЯ ABTOHOMHO, БEЗ
C    YKAЗAHИЯ ПAPAMETPA STEXT И ДO TPAHCЛЯ-
C    ЦИИ OCTAЛЬHЫX ПPOГPAMM.
C
C...........................................
 ,END,
 *USESTA:,NAME,
C
C*****   OПPEДEЛEHИE MECTA ДHEBHOЙ CTATИCTИKИ
C
C.....   ИMЯ ЛEHTЫ / MOДEЛИ
 ,TEXT,8HUSESTA 0
 ,BSS,
C.....   HAЧ.HOMEP ЗOHЫ CTATИCTИKИ
 ,LOG,
C.....   HAЧ.TPAKT TAБЛИЦ 'PASS+ФИO'
  ,LOG,4 0000 0020 0030
C.....   MECTO TEPMИHAЛЬHOЙ CTATИCTИKИ
C        HA 9/MONSYS ДЛЯ ЭBM-2,ЭBM-1(0)
  ,LOG,0435 0436
 ,END,
 *DRUMBAS:,NAME,
C      PP 12-7 YKAЗATEЛЬ MБ
C      PP 6-1 HAЧAЛЬHЫЙ N TPAKTA
C         ДЛЯ ЗAПИCИ ДИCПETЧEPA
C
C      BAPИAHT ДЛЯ ЗAГPYЗKИ HA ЛEHTY:
C      ,LOG, S DD00 TTZZZ
C      ЗДECЬ TTZZZ - YKAЗATEЛЬ MЛ
C            DD - БAЗOBЫЙ БAPAБAH
C            S=1 - BMECTE C CИCTEMOЙ
C            S=0 - TOЛЬKO ДИCПETЧEP
C
 ,LOG,2500
 ,END,
 EXCHNRS:,NAME,
C     PP 13-18 YKAЗATEЛЬ MБ
C     PP 1-5 HAЧAЛЬHЫЙ N TPAKTA
C     ДЛЯ HEPEЗИДEHTA MYЛЬTИTAЙПA
C        ,014,100B
C        ,025,37B
C     B CЛYЧAE ЗAГPYЗKИ HA ЛEHTY
C     39-Й PAЗPЯД = 0,  1-24 HE CYЩECTBEHHЫ
C
  ,010,100B
  ,,
 ,END,
 *ПДИCK:,NAME,.
C
C---  B 1-4 БAЙTAX ЭTOГO CЛOBA
C     ( CЧИTAЯ CЛEBA HAПPABO )
C   8-Й БИT COOTBETCTBYET 1-MY HAПPABЛ.
C   7-Й       --""--      2-MY  --""--
C     . . . . . . . . . . . . .
C   3-Й БИT   --""--      6-MY HAПPABЛ.
C
C---  HAЗHAЧEHИE БAЙTOB :
C   1 - ШKAЛA HAПPABЛEHИЙ KBY MЛ
C   2 - ШKAЛA HAПPABЛEHИЙ ДИCKOB
C   3 - ДИCKИ 29 MEГAБAЙT
C   4 - ДYБHEHCKИЙ KMД-29
C   5 - ПYCTOЙ БAЙT (OБЯЗATEЛЬHO)
C   6 - KOЛИЧECTBO ЭKCTEHTOB ДЛЯ
C       MOДEЛИPOBAHИЯ MБ.
C
C   ECЛИ 3-E HAПPABЛEHИE MД = OБЩEE,
C   ДOБABЬTE 34 БИT;
C   ECЛИ 4-E HAПPABЛEHИE MД = OБШEE,
C   TO ДOБABЬTE 33 БИT.
C
  ,ISO,6H'054''060''040''040''''37'
C
C... B ДYБHE HET 4 HAПP.KBY MЛ
C    A ДИCKИ B 3 И 4 HAПPABЛ.
 ,END,.
 *DISCS:,NAME,.
  DNAM:,BSS,16.ИMEHA ДП
  :,BSS,16.PEЗEPB
  ШMOД:,OCT,7777 74.ШK.BOЗM.MOДEЛEЙ MЛ
  ШФЛД:,OCT,.    ШK.PEAЛЬHЫX MOДEЛEЙ
 ,END,.
  TYPE MT:,NAME,
C*
C***  ПOДKЛЮЧEHИE MAГHИTOФOHOB
C*
C*  1. 4 CЛOBA COOTBETCTBEHHO ЧETЫPEM
C*    KBY-HAПPABЛEHИЯM MЛ  ( 4 ГPYППЫ
C*    KOMAHД ДBИЖEHИЯ ) :
C*     1-6  : AДPECA CЛYЖ.CЛOB OБMEHA
C*      44  : ЗHAЧEHИE 11 PAЗPЯДA KYC-A
C*    47-48 : TИП MAГHИTOФOHOB :
C*        0 : HMЛ БЭCM-6
C*        1 : EC5012 C ДYБHEHCKИM KMЛ
C*        2 : EC5017 C ДYБHEHCKИM KMЛ
C*        3 : EC5017 C ЗABOДCKИM  KMЛ
C*
  KBY:,LOG,22000 00000 000050.3-5012
     :,LOG,60.4-CDC405,608
     :,LOG,20000 00000 000050.5-5012
     :,LOG,60.6-БЭCM
C*
C*  2. ПPИЗHAK HAЛИЧИЯ (БИT2) ИЛИ OTCYTCTBИЯ
C*     (0) CDC-405.  ФAKTИЧECKИ - ПPИЗHAK
C*     POДHOЙ ДYБHEHCKOЙ ФИPMЫ :
C*
   FL405:,LOG,2.ECTЬ
C*
C*  3. ПPИЗHAK ФИKCИPOBAHHOЙ (БИT48)
C*     ПЛOTHOCTИ ПPИ PAБOTE C MЛ EC
C*     И EE ЗHAЧEHИE (11-10 БИTЫ) :
C*
   FIXDENS:,LOG,.HE ФИKCИPOBAHO
C*
C*  4. AДPEC B KOMAHДE OПPOCA БAYC-5 (1-15)
C*     И ЧИCЛO CДBИГOB BПPABO (48-42)  :
C*
   БAYC:,OCT,4600 0000 0000 4011.CД=12
C       ДЛЯ ЗABOДCKOГO KBY EC :
C      ,OCT,4000 0000 0000 4012.5017
C*
C*  5. ШKAЛA БЛOKИPOBOK OПOЗHABAHИЯ ЛEHT
C*     48:16  - MФ 30:67
C*
  NORECTP:,LOG,
  ,END,
 *TYPELP:,NAME,
C
C*****   P.40 - ЭKOHOMИЯ БYMAГИ (AЦПY 0)
C*****   P.39 - ЭKOHOMИЯ БYMAГИ (AЦПY 1)
C*****   P.16 - HET ЭKOHOMИИ БYMAГИ CИCTEMOЙ
C*****   P.04 - BOЗMOЖHA EC ПEЧATЬ(KAHAЛ 0)
C*****   P.03 - BOЗMOЖHA EC ПEЧATЬ(KAHAЛ 1)
C*****   P.01 - БЛOKИPOBKA KOHTPOЛЯ ЛИMИTA БYMAГИ
 ,LOG,14
C
C*****   CTAHДAPT.KOЛ-BO ПPOTЯЖEK + 1
C*****   (ПPИ ЭKOHOMИИ БYMAГИ)
 ,LOG,5
C
C*****   БЫCTPЫЙ/ЧECTHЫЙ ПPOГOH БYMAГИ
C*****   (B KOMMEHTAPИЯX - БЫCTPЫЙ)
 ,LOG,0
 ,LOG,10.CTD = 10
C***** CTAHД.ЛИMИT БYMAГИ
  ,LOG,1 0000 0000
 ,END,
 *KOHCTPA:,NAME,
C     BИT ЧTEHИЯ И HOMEP KOHTPOЛЬHOЙ
C     CTPAHИЦЫ B ФOPME KYCA, ECЛИ HY-
C     ЖEH KOHTPOЛЬ ЗAПИCИ HA MБ.
 ,LOG,4040 0000.0-Я CTP. 2-ГO MOЗY
 ,END,
 *LINKPAR:,NAME,
C ---   ШKAЛA ЛИHИЙ CBЯЗИ
 ,LOG,377.SC/NL
C ---   ШKAЛA ЛИHИЙ CBЯЗИ TASK70
 ,LOG,200.SC/CONC
C ---   BPEMEHA OTBETOB
C ---   24-13 -> ПYCП. 12-1 -> BЗBП
 ,LOG,0140 0300.EC1010 ЛBTA
 ,LOG,2000 2000.
 ,LOG,60 0060.MИKPOПPOЦ.
 ,LOG,1000 1000.M6000 ЛBTA
 ,LOG,2000 2000.
 ,LOG,2000 2000.
 ,LOG,2000 2000.
 ,LOG,2000 2000.
 ,END,
     TYP/PL:,NAME,
C
C  TИПЫ ЛEHTOЧHЫX ПEPФOPATOPOB
C  ИX M.Б. TOЛЬKO ДBA: 0-1
C
C  48-47  '1' - ПЛ-80, '0' - ПЛ-20
C  42-41  '1' - ДYБH.CПOCOБ ПOДKЛЮЧ.ПЛ-80
C         '0' -   ФPЯЗИHCKИЙ
C
  ,OCT,602.2 ПЛ-80
C   PAЗPЯДЬ  2-1  -TИП ПЛ-BBOДA 0-1:
C  '1' OЗHAЧAET BHИЭM,'0' - FSM-1500.
 COPY7:,BSS,
C.....   ПPOГPAMMHAЯ KOПИЯ TP7
C      32 P.- БЛOKИPOBKA ЗAПИCИ DAYFILE
C   26/25 P.- ПPИЗHAK HAЛИЧИЯ YBBK 0/1
C       1 P.- BBOД ПO ГOTOBHOCTИ YCTPOЙCTBA
  ,LOG,3 0000 0000.YBBK
  ,END,
  DD86:,NAME,
C
C***  HИЖECЛEДYЮЩИE HACTPOEЧHЫE
C     ПPOГPAMMЫ CЛEДYЮT ПOДPЯД !
C
 *ИПД:,LC,
  DISPBASE:,LC,7
  *ПДИCK  :,SUBP,
  TYPE MT :,SUBP,
  *KOHCTPA:,SUBP,
  *TYPELP :,SUBP,
  TYP/PL  :,SUBP,
  *TLPRMT:,SUBP,
  *TLBUFI:,SUBP,
 *TLSIZE:,SUBP,
 DD71/W:,SUBP,
 ,UJ,DD71/W
 ,END,
 *ИПД:,NAME,
C------
  0,LOG,30
  1,LOG,40
  2,LOG,43
  3,LOG,54
  4,LOG,60
C------
  5,LOG,30
  6,LOG,20
C...   48:25 - TИПЫ CEMAФOPOB
C...   24:21 - ШKAЛA ДOCTYПHЫX Ф.C.
C      15:1  - ЧИCЛO CEMAФOPOB
  7,LOG,3601 0000 4000 0016
C------
 10,LOG,1 7740 0000
 11,LOG,0 0037 7776
 12,LOG,0 0000 0036
  13,LOG,37 7740
 14,LOG,37 7740
  15,LOG,00 0376
 16,LOG,1 7777 7740
C------
 17,OCT,3700 114
 20,LOG,100
 21,LOG,40
 22,LOG,100
 23,OCT,0037 7776
 24,LOG,24 0000 0037
 25,LOG,6017 4000
 26,LOG,540
  27,LOG,44
  30,LOG,24
  ,BSS,11B
 42,LOG,77777777 77400001. ИПЗ/ECTЬ
 ,BSS,35B
 ,END,
  *TAKCA:,NAME,
C*
C***     ПPEЙCKYPAHT ДOБABOK K
C*    KOMMEPЧECKOMY BPEMEHИ ЗAДAЧИ
C*    ЗA PAБOTY BHEШHИX YCTPOЙCTB.
C*    BPEMЯ ДAHO B CEKYHДAX.
C*
C*    KTO XOЧET - MEHЯЙTE HA ЗДOPOBЬE!
C*
  0,REAL,0.0225.OБMEH C MБ
  1,REAL,0.080.OБMEH C MД
  2,REAL,0.250.ПPOXOД ЗOHЫ MЛ
  3,REAL,0.100.BBOД KAPTЫ C YBBK
  4,REAL,0.001.BBOД БAЙTA C FS
  5,REAL,0.150.ПEЧATЬ CTPOKИ AЦПY-128
  6,REAL,0.025.BЫBOД 6 CИMB. П/Л ИЛИ 1/24 П/K
  7,REAL,0.020.OДHA KOMAHДA CALCOMP
  8,REAL,1.000.KOЭФФ. ДЛЯ MЛ EC
  ,END,
 *TLSIZE:,NAME,
C
C*****   HACTPOЙKA ПO TEPMИHAЛAM
C           (PAЗMEPЫ БYФEPOB)
C
C-----   ДЛИHA KAPTЫ HAПPЯЖEHИЙ
  ,LOG,74
C-----   KOЛИЧECTBO ФИЗ.KAHAЛOB
  ,LOG,31
C-----   MAKCИMAЛЬHOE KOЛ-BO KOHCOЛEЙ
 ,LOG,2
C-----   KOЛ-BO TEPMИHAЛЬHЫX ПOДCИCTEM
 ,LOG,4
 ,END,
 *TLSYS:,NAME,
C
C*****   HACTPOЙKA ПO TEPMИHAЛAM
C         (OПИCAHИЯ ПOДCИCTEM)
C
C-----   COCTOЯHИE
C  PP.48/43 - Д H З  ПOДCИCTEMЫ
C  PP.42/19 - ШKAЛA ПPИBЯЗ. ФИЗ.KAHAЛOB
C  PP.18/17 - P E З E P B
C  PP.   16 - ИДET ЗAПYCK П/C
C  PP.15/01 - AДPEC CTPOЧHИKA П/C
C             ( 0 - CTAHДAPT )
 ,BSS,4
C-----   ПPИBЯЗKA
C  PP.48/37 - ШKAЛA ДOПYCTИMЫX ЛOГ.KAHAЛOB
C  PP.36/25 - ШKAЛA ПPИBЯЗ. ЛOГ.KAHAЛOB
C  PP.24/01 - ШKAЛA CTYЧAЩ. ФИЗ.KAHAЛOB
 ,OCT,6000.*=* CONS
 ,OCT,1774.*=* MULTI
 ,OCT,7774.*=* SCREEN
 ,OCT,7774.*=* MONITO
C-----   METKA BPEMEHИ + OTBЯЗKA
C  PP.48/25 - METKA BPEMEHИ ПO ФИЗ.KAHAЛAM
C  PP.24/01 - ШKAЛA OTBЯЗKИ ФИЗ.KAHAЛOB
 ,BSS,4
 ,END,
  *TLCONN:,NAME,
C
C*****   KOHCTAHTЫ ДЛЯ ПPИBЯЗKИ
C
C-----   KOДЫ ПPИBЯЗKИ K ПOДCИCTEMAM
C  PP.48/33 - 2 CИMBOЛA ДЛЯ ПPИBЯЗKИ,
C             B OБPATHOM ПOPЯДKE
C  PP.15/01 - HOMEP ПOДCИCTEMЫ
  ,ISO,6H '''''''''1'
  ,ISO,6H  '''''''1'
  ,ISO,6HTM'''''''1'
  ,ISO,6HPO'''''''0'
C
C
  MAIN*C:,ENTRY,
C
C*****   PAЗPEШEHИE ПPИBЯЗKИ K ПOДCИCTEMAM
C
C  PP.48/25 - ШKAЛA ФИЗ.KAHAЛOB, ДЛЯ KOTO-
C             PЫX ПPИBЯЗKA PAЗPEШEHA
C
C-----   OПEPATOPCKИE KOHCOЛИ
C  PP.15/01 - HOMEP ПEPBOЙ OПEPATOPCKOЙ
C             KOHCOЛИ ПO YMOЛЧAHИЮ
  ,OCT,60000000 000 00001
C
C-----   ДPYГИE ПOДCИCTEMЫ
C  PP.15/01 - HOMEPA ЗAДAЧ ДЛЯ STARTJOB
  ,OCT,77777777 00000005.  MT
  ,OCT,77777777 00000067.  ЭP
  ,OCT,77777777 00000002.
C
  ,END,
 *TLPRMT:,NAME,
C
C*****   HACTPOЙKA ПO TEPMИHAЛAM
C         ПAPAMETPЫ ФИЗ.KAHAЛOB
C
C        PAБOЧAЯ ЯЧEЙKA:
C
C    B MOMEHT ЗAГPYЗKИ - ЧACTOTA BPEMEHHЫX
C    ПPEPЫBAHИЙ, ДEЛEHHAЯ HA 150:
C    1 - 150 ГЦ,  2 - 300 ГЦ,  4 - 600 ГЦ,
C                10 - 1200 ГЦ.
  ,LOG,2
C    BO BPEMЯ PAБOTЫ - HOMEP KAHAЛA TИПA
C    TEKTRONIX (ФOPMИPYETCЯ П/П STARTDD).
C
C
C        MACKИ KAHAЛOB BBOДA И BЫBOДA:
C
C    48/25 P. MIN И MOT ДOЛЖHЫ COBПAДATЬ.
C    OHИ COOTBETCTBYЮT TИПAM KAHAЛOB:
C    48 P. - 1-Й KOHCYЛЬCKИЙ KAHAЛ,
C    47 P. - 2-Й KOHCYЛЬCKИЙ KAHAЛ,
C    46 - 31 P. - KAHAЛЫ MYЛЬTИПЛEKCOPA,
C    30 - 26 P. - ПOKA HE ЗAДEЙCTBOBAHЫ,
C    25 P. - KAHAЛ TИПA "TEKTRONIX".
C    "1" B 24/1 P. MIN COOTBETCTBYЮT
C    TEM PAЗPЯДAM TEЛEГPAФHOГO PEГИCTPA,
C    ПO KOTOPЫM ИДET BBOД.
C    "1" B 24/1 P. MOT COOTBETCTBYЮT
C    TEM PAЗPЯДAM TEЛEГPAФHOГO PEГИCTPA,
C    ПO KOTOPЫM ИДET BЫBOД.
C
C       MAKCИMAЛЬHOE ЧИCЛO KAHAЛOB - 24.
C
  ,LOG,77770000 7777 0000. MIN
  ,LOG,77770000 0000 7777. MOT
C
C     ДAЛEE  E,P,U-XAPAKTEPИCTИKИ TPEX ГPYПП
C     ПOCЛEДOBATEЛЬHO ПOДKЛЮЧEH. TEPMИHAЛOB.
C
C
C        XAPAKTEPИCTИKA E :
C        42/28 - ФAЗA OT CTAPTA KOHЦA CИMB.
C        24/1  - ШKAЛA KAHAЛOB ДAHHOГO TИПA
C                ( ПO BBOДY И BЫBOДY )
C
 ,LOG,777670 1700 1700
  ,LOG,777550 6077 6077
 ,LOG,
C
C        XAPAKTEPИCTИKA P :
C        45/31 - HAЧAЛO CБOPKИ CИMBOЛA
C        30/16 - ШAГ ПO KAPTE HAПPЯЖEHИЙ
C        15/1  - KOЛИЧECTBO БИT CИMBOЛA
C
 ,LOG,77706 77705 77772
 ,LOG,77710 77706 77772
 ,LOG,
C
C        XAPAKTEPИCTИKA U :
C        45/31 - HAЧAЛO PAЗБOPKИ CИMBOЛA
C        30/16 - ШAГ ПO KAPTE HAПPЯЖEHИЙ
C        15/1  - OTHOCИT.ФAЗA KOHЦA CИMBOЛA
C
 ,LOG,77777 77777 77766
 ,LOG,77777 77776 77754
 ,LOG,
C
C     OПИCATEЛЬ MYЛЬTИПЛEKCOPA TEPMИHAЛOB
C
C      I.  0 - HET HИKAKИX MYЛЬTИПЛEKCOPOB
C
C     II.  MYЛЬTИПЛEKCOP ИBTAH.
C          ПOДKЛЮЧEHИE ПO 19 P. ПPП.
C          1-4  : MACKИ BBOДA/BЫBOДA
C          5-8  : ДOП.PEГИCTP ПPEPЫBAHИЙ
C
C    III.  MYЛЬTИПЛEKCOP  Г O И
C          ПOДKЛЮЧEHИE HA 12-11 P. ПPП.
C          HACTPAИBAETCЯ "1" B 48-47 PAЗPЯДAX.
C          (48P. COOTBETCTBYET 12 P.ПPП,
C           47P. COOTBETCTBYET 11 P.ПPП)
C          MACKA 12-11 P.ПPП OTKPЫBAETCЯ TOЛЬKO
C          ПPИ ЗAЖATOM 12-11 P. HA 6 TYMБЛ.PEГ.
C
  ,LOG,365
C
 ,END,
  *TLBUFI:,NAME,.БЫBШИЙ  C I N
C
C*****   HACTPOЙKA ПO TEPMИHAЛAM
C         OПИCAHИE ФИЗ.KAHAЛOB
C
C.....  ЯЧEЙKA 0 :
C       48:25 - ШKAЛA ФИЗ.KAHAЛOB, ДЛЯ
C         KOTOPЫX PAЗPEШEHA ПPИBЯЗKA K
C         "OPERTERM".
C       5:1   - HOMEP ГЛABHOЙ OПEPATOPCKOЙ
C         KOHCOЛИ ПPИ OTCYTCTBИИ HAБOPA
C         B 5:1 P. 2 TYMБЛEPHOГO PEГИCTPA.
C
    0,LOG,60000300 000000 01
C
C
C.....  ЯЧEЙKИ 1 - 24 : OПИCATEЛИ TEPM.KAHAЛOB
C        ( HACTPOEЧHЫE PAЗPЯДЫ  -  31:19  )
C
C PP.48/41 - BBEДEHHЫЙ CИMBOЛ
C    40/33 - ПPEДЫД.CИMBOЛ (HA CBOБ.KAHAЛE)
C    40/36 - PEЗEPB (HA ПPИBЯЗ.KAHAЛE)
C    40/37 - KOД CЛYЖ.ПOЛYБAЙTA ДЛЯ MPX
C    35/33 - HOM.ПOДCИCT.(HA ПPИBЯЗ.KAHAЛE)
C            0 = OPERTERM
C            1 = MULTITYP
C            2 = ЭKPAHHЫЙ PEДAKTOP
C            3 = MOHИTOP ПOДCИCTEM
C       32 - ECTЬ CИMBOЛ (ДЛЯ BINARY-INPUT)
C       31 - ECTЬ "ЗBOHOK"
C       30 - HYЖHA ЗAДEPЖKA ДЛЯ ROLL
C       29 - БЛOKИPOBKA PEГEHEPAЦИИ
C       28 - CИMBOЛ "LF" ДOПOЛHЯTЬ "CR"
C       27 - HET ПEPEKOДИPOBKИ BBOДA
C       26 - HET ПEPEKOДИPOBKИ BЫBOДA
C       25 - ПPИЗHAK CИHXPOHИЗAЦИИ KAHAЛA
C    24/22 - TИП TEPMИHAЛA
C            0 = VT-340
C            1 = CETEBOЙ (KOД ASCII)
C            2 = KOHCYЛ
C            3 = VDT-52130
C            4 = 15-ИЭ (ЭЛEKTPOHИKA)
C    21/19 - TИП ФИЗИЧECKOГO KAHAЛA
C            0 = ПOCЛEДOBATEЛЬHЫЙ KAHAЛ
C            1 = KOHCYЛ
C            2 = BИДEOTOH/KOHCYЛ
C            4 = KAHAЛ ПЭM-2
C       18 - PEЗEPB
C       17 - BЫB.PEГИCTP 15-ИЭ
C       16 - BB.PEГИCTP 15-ИЭ
C            БЫЛ "ESCAPE" (VDT-52130)
C     15/1 - AДPEC OПИCATEЛЯ BИPT.KAHAЛA
C
C*****   CTPYKTYPA OПИCATEЛЯ BИPTYAЛЬHOГO
C                    KAHAЛA
C
C    0 = LJOB - ЗAKAЗ HA PAБOTY
C               И COCTOЯHИE ЗAKAЗA.
C    P.48 - HAЧAЛO PAБOTЫ ПO JOB
C      47 - "LF" ПO HAЧAЛY CTPOKИ
C      46 - "CUP" ПO HAЧAЛY CTPOKИ
C      45 - "EOT" (ПEPEXOД HA BBOД)
C      44 - OБPAБOTKA INSERT CHAR.
C      43 - OБPAБOTKA DELETE CHAR.
C      42 - BBOД/BЫBOД CTPOKИ
C      41 - ЗAKAЗ HA OTBЯЗKY
C      40 - ГEHEPAЦИЯ COБЫTИЯ ПOДCИCTEME
C      39 - PEЗEPB
C      38 - CTOПOP BЫBOДA (БЫЛ CNTR/S)
C      37 - ПPИЗHAK BEДEHИЯ TAЙMEPA
C      36 - ПPИЗHAK BBOДA
C      35 - ПPИЗHAK ЗACEKPEЧИBAHИЯ "*"
C      34 - ЗAKOHЧEHA PAБOTA ПO CTPOKE
C      33 - ПPEPBAH BЫBOД,
C           ЛИБO CPAБOTAЛ TAЙMEP HA BBOДE
C      32 - ЛOПHYЛA ДЛИHA CTPOKИ
C      31 - PEЗEPB
C      30 - PEЗEPB
C      29 - БЛOKИPOBKA PEГEHEPAЦИИ ПPИ BBOДE
C      28 - ПPИЗHAK "ПPOЗPAЧHOГO" BBOДA
C      27 - PEЗEPB
C      26 - PEЗEPB
C      25 - ПPИЗHAK HEПYCTOГO BBOДA
C      24 - ПPИЗHAK ПEPEПOЛHEHИЯ CЧETЧИKA
C      23/16 - TEK.CЧETЧИK CИMBOЛOB
C      15/1  - TEK.AДPEC ПO БYФEPY BB/BЫB.
C
C    1 = MSK - MACKA ПOЗИЦИИ CИMBOЛA B TEK.
C              CЛOBE БYФEPA BBOДA/BЫBOДA
C
C    2 = XNT - CCЫЛKA HA ФИЗ. KAHAЛ
C       48/41 - TEK.TAЙMEP ПPИ BBOДE
C       40/33 - HAЧ.TAЙMEP HA BBOД CИMBOЛA
C       32/21 - PEЗEPB
C       20/16 - HOMEP ЛOГИЧECKOГO KAHAЛA
C       15/01 - HOMEP ФИЗИЧECKOГO KAHAЛA
C
C    3 = OWNER - BЛAДEЛEЦ KAHAЛA
C       48/43 - ДHЗ, ПOДABШEЙ ЭKCTPAKOД
C       10/01 - HOMEP PASS ПOЛЬЗOBATEЛЯ
C
C    4 = WSC - PAБOЧAЯ ЯЧEЙKA ДЛЯ PEAЛИЗAЦИИ
C              "IC" И "DC"
C       ПOCЛE OTPAБOTKИ ЗAKAЗA:
C       8/1 - CИMBOЛ OKOHЧAHИЯ BBOДA, ЛИБO
C             CИMBOЛ ПEPEБИBKИ BЫBOДA.
C
C    5 = ... - "-1" ЯЧEЙKA CTPOKИ
C
C    6 = STRI(14) - БYФEP BBOДA.
C        OПEPAЦИИ "IC" И "DC" PEAЛИЗYЮTCЯ
C        TOЛЬKO B ПPEДEЛAX ЭTOГO БYФEPA.
C
C        БYФEP BЫBOДA MOЖET PACПOЛAГATЬCЯ
C        B ДPYГOM MECTE.
C
C
C=====   HACTPOЙKA ПO TИПAM TEPMИHAЛOB
C
C---  KOHCYЛЫ
  1,LOG,0002 000000.VT-CONS 1
  2,LOG,0002 000000.VT-CONS 2
C---  MYЛЬTИПЛEKCOP ИBTAH
  3,LOG,3014 000000.CETЬ-0
  4,LOG,3014 000000.CETЬ-1
  5,LOG,3014 000000.CETЬ-2
  6,LOG,3014 000000.CETЬ-3
  7,LOG,0004 000000.CETЬ-4
  8,LOG,0004 000000.CETЬ-5
  9,LOG,0004 000000.CETЬ-6
 10,LOG,0004 000000.CETЬ-7
 11,LOG,0004 000000.CETЬ-8
 12,LOG,0004 000000.CETЬ-9
C---  TEЛEГPAФHЫЙ PEГИCTP
 13,LOG,0000 000000.VT-340
 14,LOG,0000 000000.VT-340
 15,LOG,1030 000000. V D T
 16,LOG,0000 000000.VT-340
 17,LOG,0000 000000.---"---
 18,LOG,0000 000000.---"---
 19,LOG,0000 000000.---"---
 20,LOG,0000 000000.---"---
 21,LOG,0000 000000.---"---
 22,LOG,0000 000000.---"---
 23,LOG,0000 000000.---"---
 24,LOG,0000 000000.---"---
 ,END,
 *TLCONST:,NAME,
C
C*****   OБЩИE KOHCTAHTЫ TL-KOMПЛEKCA
C
 ,LOG,01600000 00000000.B43/41
 ,LOG,77600000 00000000.B48/41
 ,LOG,60000000 00000000.B48/47
 ,LOG,37700000 00000000.B47/40
 ,GOST,6H'377'0000'200'
 ,LOG,00000000 07000000.M*TYC
 ,GOST,6H0'377''377''377''377''177'
 ,GOST,6H'377''377''377''377'0'376'
 ,LOG,00177577 77777777.M*FIC
 ,LOG,40100200 40100200.C200*
 ,LOG,37677577 37677577.C177*
 ,LOG,00000000 00000360.C360
 ,LOG,00000177 77700000.B31/16
 ,LOG,00000177 77000000.B31/19
 ,LOG,30000000 00000000.B47/46
 ,LOG,77777777 77677777.B16M
 ,LOG,77777777 77777776.B1M
 ,LOG,00777777 77000000.B42/19
 ,LOG,77000000 00000000.B48/43
 ,LOG,77777400 00000000.B48/33
 ,LOG,01200000 00000000.B43*41
 ,LOG,77700000 00000000.M*LJOB
  ,END,
  *TLSYN:,NAME,
C
C*****   KOHCTAHTЫ CИHXPOHИЗAЦИИ
C
  ,OCT,376   .S*PAD
  ,OCT,412   .C*WAIT
 ,END,
 *TLSTAT:,NAME,
C
C*****   COCTOЯHИE TL-KOMПЛEKCA
C
 ,BSS,1.BB
  ,OCT,77777777 77777777.B/FREE
  ,OCT,77777777 00000000.N/FREE
 ,BSS,1.LAST
 ,BSS,1.OUT
 ,BSS,1.REQOUT
  ,BSS,1. P E З E P B
 ,BSS,1.J IN
 ,BSS,1.J OUT
 ,BSS,1.J LINE
 ,LOG,1.J TIM
 ,BSS,1.SPEC*CH
 ,BSS,1.SC*DOWN
 ,BSS,1.SC*BNL
 ,END,
 BIO*TL:,NAME,.20.02.78
C
C*****   OБCЛYЖИBAHИE TEЛEГPAФHOГO PEГИCTPA
C*****      ( БИTOBOE , MACCOBOE )
C
 *TLSIZE:LC,BLOCK,LMTR
 M:,WEQ,LMTR.ДЛИHA MATPИЦЫ
 *TLMTR:,LC,M+1
 *TLMTR:I,BLOCK,XF,MTR
 *TLPRMT:LC,BLOCK,(1),MIN,MOT,X*E(3)
 *TLSTAT:LC,BLOCK,BB,B/FREE,N/FREE,LAST
 ,CONT,OUT,REQOUT(2),JIN,JOUT
 *YCЫ:LC,BLOCK,(2),COMMIR
 WSD:LC,BLOCK,X1
 RETURN:,SUBP,
  ITIMEB10:,SUBP,
  IFJOB*TL:,SUBP,
  B24/1:,LC,1
 FULWOR:,LC,1
 *701:B,BLOCK,B47,B46(6),B40(9),B31(16),B15(14),B1
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 F:,EQU,13
 E:,EQU,14
 R:,EQU,15
C
C-----   KOPPEKЦИЯ ФAЗЫ
 ,XTA,XF
 ,A-X,B1
 ,UZA,PHA P
 ,A+X,LMTR
 PHA P:,ATI,F
 ,ATX,XF.
C-----   TL - BЫДAЧA (ДИФФEP.KOД)
 F,XTA,MTR
 ,AAX,MOT
 ,AEX,OUT
 ,EXT,140B. O U T P U T
 ,ATX,OUT
C-----
 F,XTA,MTR
 ,ASN,64+24.- ECTЬ KOHЦЫ
 ,UZA,INPUT. = HET
C=====   KOHЦЫ CИMBOЛOB (BBOД/BЫBOД)
 ,ATX,BB
 R,VJM,FREE
 ,XTA,BB
 ,APX,MIN
 ,AOX,J IN
 ,ATX,J IN.= BBEДEHO
 INPUT:,BSS,
C-----   BBOД + HAЧAЛA CИMBOЛOB
 ,EXT,4100B. I N P U T
 ,EXT,146B.CИHXPOHИЗAЦИЯ
 ,AAX,MIN
 F,ATX,MTR.- KOHЦЫ И BЫBOД
 ,AAX,LAST
 ,AAX,B/FREE
 ,U1A,BEG CHR.= ECTЬ CTAPTЫ
  *ЧACTOTA:,IFGE,FREQ,600
  *TL/ERR:LC,BLOCK,T31,N1*ER
 ,XTA,T31.KOHTPOЛЬ 31P
 ,UZA,F LAST. -> HET
 ,XTA,B/FREE
 ,AEX,FULWOR
  ,AAX,B24/1
 ,U1A,F LAST. -> HEЛЬЗЯ
 ,ATX,T31
  ,XTA,B*START
 ,AOX,B40
 ,AEX,FULWOR
 ,MOD,37B
 ,AEX,FULWOR
 ,AEX,COMMIR
 ,ATX,COMMIR
 ,MOD,36B
  *ЧACTOTA*:,ENDIF,
 F LAST:,BSS,
C-----   ЛOBЛЯ HYЛЯ B TL-PEГИCTPE
 F,XTA,MTR
 ,AEX,MIN.CTPOБ ДЛЯ
 ,ATX,LAST.CTAPTOBЫX
C-----   ПPOБA ГOTOBHOCTИ BЫBOДA
 ,XTA,REQ OUT.
 ,AAX,N/FREE.
 ,UZA,IF JOB. = HET
C=====   ЗAПYCK BЫBOДA CИMBOЛOB
 ,AOX,J OUT
 ,ATX,J OUT.ЗAKAЗ BЫBOДA
 ,AUX,MOT
 R,VJM,BUSY.
  IF JOB:,BSS,
  *ЧACTOTA:1,IFGE,FREQ,600
  14,VTM,RETURN
  *ЧACTOTA:1,IFLT,FREQ,600
  14,VTM,ITIMEB10
  ,UJ,IFJOB*TL
C
C=====   HAЧAЛA CИMBOЛOB (BBOД)
 BEG CHR:,BSS,
 ,ATX,BB.BEGIN-BIT
 R,VJM,BUSY. PUT '0'
C-----   ЗAПИCЬ KOHЦOB B COOTBETCTBИE
C        C TИПOM TEPMИHAЛA
 F,VTM,-2
 R,VTM,EL BEG
 L BEG:,XTA,BB
 F,AAX,X*E+2.HAШ TИП
 ,ATX,X1. (B БPЗ)
 ,U1A,P BEG. = ДA
 EL BEG:F,VLM,L BEG
 ,WTC,XF
 F,VTM,.BOCCTAH.ФAЗЫ
  *ЧACTOTA:2,IFGE,FREQ,600
 ,XTA,
 ,ATX,T31
 ,UJ,F LAST
 P BEG:F,XTA,X*E+2
 ,ASN,64+27
 ,ATI,E.- AДPEC KOHЦA
 ,XTA,X1
C
C=====   ЗAПИCЬ KOHЦOB CИMBOЛOB
C
 WRE*TL:,ENTRY,
 ,ASN,64-24
 ,ATX,X1. - KOHЦЫ
 ,WTC,XF
 E,UTM,.ФAЗA KOHЦA
 ,ITA,E
 ,AAX,B15
 ,UZA,WR 1
 E,UTM,M. - KOЛЬЦO
 WR 1:,XTA,X1
 E,AOX,MTR
 E,ATX,MTR
 R,UJ,
C
C*****   YCTAHOBKA CTPOБOB CTAPTOB И BЫДAЧИ
C
 FREE*TL:,ENTRY,
 FREE:,BSS,
 ,AOX,B/FREE
 ,UJ,PUT*
C
C*****   ГAШEHИE CTPOБOB CTAPTOB И BЫДAЧИ
C
 BUSY*TL:,ENTRY,
 BUSY:,AEX,FULWOR
 ,AAX,B/FREE
 PUT*:,ATX,B/FREE
 ,APX,MOT
 ,ATX,N/FREE
 R,UJ,
C*****
 ,END,
 CONINT/I:,NAME,
C
C*****   OБPAБOTKA ПPEPЫBAHИЙ ПO
C*****   ПAPAЛЛEЛЬHЫM TEPM.KAHAЛAM
C
  *TLPRMT:LC,BLOCK,(2),MOT
 *TLSTAT:LC,BLOCK,(5),REQOUT(2),JIN,JOUT
  *CB:LC,BLOCK,(1),C17
 IFJOB*TL:,SUBP,
  FREE*TL:,SUBP,
 BUSY*TL:,SUBP,
   CLOPIR:,SUBP,
   RETURN:,SUBP,
  WSD:LC,BLOCK,WS1
 *700:B,BLOCK,B48(11),B37(18)
 ,CONT,B19(3),B16(4),B12(2)
 ,CONT,B10(6),B4(2),B2,B1
C
C*****   CONSUL VT/CONS - INPUT
C
 14,XTA,B12
 ,CALL,CLOPIR
  14,XTA,B48
  14,VTM,RETURN
C
  IF*INP:,ENTRY,
C
  ,APX,MOT
 ,AOX,J IN
 ,ATX,J IN
  ,UJ,IFJOB*TL
C
C*****   CONSUL VT/CONS - OUTPUT
C
 CONINT/O:,ENTRY,
 14,XTA,B10
 ,CALL,CLOPIR
  14,XTA,B48
  14,VTM,RETURN
C
  IF*OUT:,ENTRY,
C
  ,ATX,WS1
  ,APX,MOT
  15,VTM,IFJOB*TL
 ,AAX,REQOUT
 ,UZA,PUT
 ,AOX,J OUT
 ,ATX,J OUT
  ,XTA,WS1
  ,UJ,BUSY*TL
  PUT:,XTA,WS1
  ,UJ,FREE*TL
 ,END,
 SDRV*INP:,NAME,
C
C*****   ПAPAЛЛEЛЬHЫЙ ФИЗ.ДPAЙBEP
C*****       YPOBHЯ  "C I O"
C
 *TLBUFI:LC,BLOCK,CHR(0),CIN
 *TLBUFO:LC,BLOCK,WS
 WSD:LC,BLOCK,WS1(2),NBB
 *TLCONST:LC,BLOCK,(5),M*TYC(6),C360
 SER*INP:,SUBP,
 SER*OUT:,SUBP,
 PERPIR:,SUBP,
  MPX*INP:,SUBP,
  MPX*OUT:,SUBP,
 C377:,LC,1
 *700:B,BLOCK,B48,B47(23),B24(5),B19(7)
  ,CONT,B12,B11,B10,B9,B8,B7
  ,CONT,B6,B5,B4,B3,B2,B1
 N:,EQU,10
 S:,EQU,12
  F:,EQU,13
C
C*****   BBOД C TEPMИHAЛOB
C
 N,XTA,CIN
 ,APX,M*TYC.ПOCЛEД.KAHAЛ
 ,UZA,SER*INP.-> ДA
 ,ATX,WS1
  ,WTC,NBB
  F,VTM,
 ,AEX,B48
  ,UZA,MPX*INP
 ,AAX,B47
 ,ATX,WS. VT/CONS
 :,U1A,*+1. -> ДA
 ,UTC,4174B-4156B
 :F,EXT,4156B-1
 ,ATX,CHR
 ,XTA,WS
 ,UZA,INP 1
 ,XTA,B10
 F,EXT,156B-1
 INP 1:F,XTA,B12-1
 ,CALL,PERPIR
 ,XTA,WS1
 ,AAX,B48.KOHCYЛ/MEЖMAШ
 ,UZA,RET2.-> HET
 ,EXT,172B.ПOДTBEPЖДEHИE
 RET 2:,XTA,CHR
 ,AAX,C377
 14,UJ,
C
C*****   BЫBOД HA TEPMИHAЛЫ
C
 SDRV*OUT:,ENTRY,
 N,XTA,CIN
 ,APX,M*TYC.ПOCЛEД.KAHAЛ
 ,UZA,SER*OUT.-> ДA
  ,WTC,NBB
  F,VTM,
 ,AEX,B48
  ,UZA,MPX*OUT
 ,AAX,B47
 ,ATX,WS
 F,XTA,B10-1
  F,MTJ,15
 ,CALL,PERPIR
 ,XTA,WS
 ,UZA,CONO/1
 ,XTA,B24
  15,EXT,156B-1
  15,UTM,156B-174B
 CONO/1:,ITA,S
 ,AOX,B9
 15,EXT,174B-1
 14,UJ,
 ,END,
 MPX*T:,NAME,
C
C*****   ДPAЙBEP MYЛЬTИПЛEKCOPA ГOИ
C
 *TLSIZE:LC,BLOCK,(3),XSS
 *TLBUFI:LC,BLOCK,CIN
 *TLSTAT:LC,BLOCK,(5),REQOUT(2),JIN,JOUT
 *TLPRMT:LC,BLOCK,(2),MOT(10),COUNT
 *TLSYS :LC,BLOCK,STATSS
 BUSY*TL:,SUBP,
 FREE*TL:,SUBP,
 IFJOB*TL:,SUBP,
 RETURN:,SUBP,
 WSD:LC,BLOCK,WS1(2),NBB
 C377:,LC,1
 C7:,LC,1
 *700:B,BLOCK,B48(2),B46(30)
 ,CONT,B16(4),B12(11),B1
 *12:,BLOCK,S,F,N,R
 NSS:,WEQ,XSS
 NS/1:,EQU,NSS-1
C
C=====   PEAKЦИЯ HA ПPEPЫBAHИE
C
 ,XTA,COUNT
 ,ATI,F
 ,ARX,B1
 ,AAX,C7
 ,ATX,COUNT
 F,V1M,CONT1
 N,EXT,4174B
 ,ATX,SYM
 ,XTA,C377
 N,EXT,174B
 ,ATX,
 CONT1:,XTA,SYM
 ,UZA,CONT2
 ,AEX,C377
 ,UZA,CONT2
 F,AOX,BUFSYM
 F,ATX,BUFSYM
 F,XTA,B46
 ,APX,MOT
 ,AOX,JIN
 ,ATX,JIN
 CONT2:N,EXT,4174B
 ,ATX,SYM
 F,XTA,BUFSYM
 ,ASN,64+8
 ,UZA,CONT3
 ,ATX,CIN
 F,XTA,B46
 R,VJM,FREE*TL
 F,XTA,B46
 ,APX,MOT
 ,AAX,REQOUT
 ,UZA,PUT
 ,AOX,JOUT
 ,ATX,JOUT
 F,XTA,B46
 R,VJM,BUSY*TL
 PUT:F,XTA,BUFSYM
 ,AAX,C377
 F,ATX,BUFSYM
 ,XTA,CIN
 CONT3:N,EXT,174B
 ,ATX,
 F,UTM,-7
 F,VZM,RETMPX
 N,XTA,B12
 ,EXT,142B
 ,UJ,IF JOB
 RETMPX:R,VTM,-NS/1
 ,XTA,
 :R,AOX,STATSS+NS/1
 R,VLM,*
 ,ASN,64-6
 ,AUX,MOT
 ,AAX,MPXCH
 ,U1A,IF JOB
 N,XTA,B12
 ,CALL,CLOPIR
 IF JOB:14,VTM,RETURN
 ,UJ,IFJOB*TL
C
C=====   ПEPEДAЧA BBEДEHHOГO CИMBOЛA
C
 MPX*INP:,ENTRY,
 F,XTA,BUFSYM-3
 ,AAX,C377
 F,AEX,BUFSYM-3
 F,ATX,BUFSYM-3
 ,YTA,
 14,UJ,
C
C=====   БYФEPИЗAЦИЯ CИMBOЛA ДЛЯ BЫBOДA
C
 MPX*OUT:,ENTRY,
 ,ITA,S
 S,VZM,CL
 ,ASN,64-8
 ,UTC,B16-B48
 CL:,AEX,B48
 F,AOX,BUFSYM-3
 F,ATX,BUFSYM-3
 14,UJ,
C
C=====
C
  MPX*TIM:,ENTRY,
  14,UJ,
C
 MPXCH:,OCT,1774
 SYM:,BSS,1
 BUFSYM:,BSS,8
 ,END,
  MPX*T:,NAME,
C
C*****   БAЙTOBЫЙ KAHAЛ ПЭM-2
C
  *TLBUFI:LC,BLOCK,CHR(0),CIN
 *TLBUFO:LC,BLOCK,COT
  *TLSTAT:LC,BLOCK,(5),REQOUT(2),JIN,JOUT
  *TLPRMT:LC,BLOCK,(2),MOT(10),/UVCH/
  BUSY*TL:,SUBP,
  FREE*TL:,SUBP,
  IF*INP:,SUBP,
  IF*OUT:,SUBP,
  RETURN:,SUBP,
  WSD:LC,BLOCK,(2),NBB
  FULWOR:,LC,1
  C377:,LC,1
  C37:,LC,1
  MAXTIM:,EQU,C37
  TTPRINT:,SUBP,
  *CB:LC,BLOCK,(1),C17
  C5:,LC,1
  *700:B,BLOCK,B48(2),B46(14),B32(13)
  ,CONT,B19(3),B16(9)
  ,CONT,B7,B6,B5,B4,B3,B2,B1
C
  R:,EQU,15
  F:,EQU,13
  S:,EQU,12
  N:,EQU,10
 *TLCONST:LC,BLOCK,(6)
 ,CONT,M1*O,M2*O(12)
 ,CONT,B48/33
C
C-----   ИCПOЛЬЗOBAHИE ЯЧEЙKИ /UVCH/
C   48/33 P. - ШKAЛA KAHAЛOB HA ЭTAПE
C              BЫBOДA,ДO ПPEPЫBAHИЯ
C   32/17 P. - ШKAЛA KAHAЛOB, ЗAKPЫTЫX
C              ПO ЗAЯBKE MYЛЬTИПЛEKCOPA
C              (БЫЛ CNTR/S).
C   08/05 P. - ДOП.PEГИCTP ПPEPЫBAHИЙ.
C   04/01 P. - MACKИ BBOДA/BЫBOДA.
C
C-----   ИCПOЛЬЗOBAHИE ЯЧEЙKИ OWNER
C        (3-E CЛOBO ДECKP.BИPT.KAHAЛA)
C   48/43 P. - ДHЗ BЛAДEЛЬЦA
C   10/1  P. - N PASS BЛAДEЛЬЦA
C
C-----   OБЩИЙ ФOPMAT 2-БAЙTOBOЙ ПOCЫЛKИ:
C   16/13 P. - CЛYЖEБHЫЙ ПOЛYБAЙT
C   12/9  P. - HOMEP TEPMИHAЛA
C    8/1  P. - БAЙT ИHФOPMAЦИИ
C
C
C=====   БЛOK PEAKЦИИ HA ПPEPЫBAHИE
C
  ,EXT,4165B.ЧTEHИE PПP
  ,AAX,C5
  ,AAX,/UVCH/
  ,UZA,RETURN.-ЛOЖHЯK
C-----   BЫЯCHEHИE TИПA ЗAKAЗA
  ,AAX,B3
  ,UZA,REDY. - BЫBOД
  ,EXT,4164B.ЧTEHИE БAЙTA
  ,ATX,CHR
  ,ASN,64+8.BЫЯCHИM
  ,AAX,C17.  HOMEP
  ,ATI,F.  MPX-KAHAЛA
  ,UTC,-2
  REDY:R,VTM,0
  R,XTA,B1
  ,AEX,/UVCH/.ЗAKPЫTИE
  ,ATX,/UVCH/.MACKИ ДPП
  R,AEX,B5.ГAШEHИE ДPП
  ,EXT,155B.  ***
  ,XTA,FULWOR
  ,AEX,B19.ГAШEHИE
  ,EXT,30B. B ПPП
  R,V1M,CH*IN
C-----   BЫДAЧA БAЙTA ИЗ OЧEPEДИ
 ,XTA,/UVCH/
 ,AAX,B48/33
 ,AEX,/UVCH/
 ,ATX,/UVCH/
 ,YTA,
 ,ASN,64+2
 14,VTM,RETURN
 ,UJ,IF*OUT
C-----   AHAЛИЗ ПPИHЯTЫX БAЙTOB
  CH*IN:,BSS,
  ,XTA,CHR
  ,AAX,=17 0377
  14,VTM,/ON
  ,AEX,=10 0021."Q"
  ,UZA,INP*S
  14,VTM,/OFF
  ,AEX,B2."S"
  ,UZA,INP*S
C...     ЗAПYCK  C I O
  14,VTM,RETURN
  F,XTA,B46
  ,UJ,IF*INP
C
C...   CИГHAЛЫ ГOTOBHOCTИ :
C
  /OFF:14,VTM,BUSY*TL
  F,XTA,B32
  ,AOX,/UVCH/
  ,UJ,ON/OFF
C
  /ON:,XTA,/UVCH/
  F,AAX,B32
  ,UZA,RETURN
  ,AEX,/UVCH/
  14,VTM,FREE*TL
C
  ON/OFF:,ATX,/UVCH/
  R,VTM,RETURN
  F,XTA,B46
  14,UJ,
C
C=====   ПPИEM C MYЛЬTИПЛEKCOPA
C
  MPX*INP:,ENTRY,
  ,EXT,4164B
  ,ATX,CHR.ПPИEM
  ,ASN,64-24.16/13 --> 40/37
  N,AEX,CIN
  ,ATI,R
  R,VZM,INP*S.HE ПPИBЯЗAH
  ,AAX,=:0017
  N,AEX,CIN
  N,ATX,CIN
  INP*S:,BSS,
  ,XTA,B19
  ,EXT,165B.ПOДTBEPЖДEHИE
  ,XTA,/UVCH/
  ,AOX,B3.OTKPЫTИE
  ,ATX,/UVCH/. MACKИ
  ,AEX,B7
  ,EXT,155B.ГAШEHИE ДPП
  ,XTA,CHR
  ,AAX,C377
  14,UJ,
C
C=====   BЫДAЧA B MYЛЬTИПЛEKCOP
C
  MPX*OUT:,ENTRY,
C   B PEГИCTPE F - ФИЗ.HOMEP KAHAЛA
C   ПO ШKAЛE "MOT": 3 - 22 (BIN.)
  F,UTM,-3.(0-17)
  F,XTA,B32."OFF-LINE"
  ,AOX,B48/33. ИЛИ
  ,AAX,/UVCH/.KAHAЛ ЗAHЯT
  ,U1A,PUSH. - ДA
C-----   ПEPEДAЧA ИHФOPMAЦИИ B KAHAЛ
  ,XTA,/UVCH/
  F,AOX,B48
  ,AOX,B1
  ,ATX,/UVCH/
  ,AEX,B5
  ,EXT,155B.ГAШEHИE ДPП
  R,VTM,CHR
  ,ITA,S.CИMBOЛ
  ,ITS,F.+NTERM
  ,ASN,64-8
  15,AOX,
  ,AOX,B19+1
  N,XTS,CIN.HA ПPИBЯЗAHHOM
  ,ATI,R.TEPMИHAЛE
  ,AAX,=:0017.ДOБABИM
  :R,VZM,*+1.    KOД
  ,ASN,64+24.CЛYЖEБHOГO
  :,AOX,CHR.ПOЛYБAЙTA
  ,EXT,164B. БAЙT + БИT18
  ,XTA,MAXTIM
  ,ATX,TIMER
  BUSY:14,MTJ,R
  F,XTA,B46
  ,UJ,BUSY*TL
  PUSH:,ASN,64-16.ПPИ "ON-LINE"
  F,AEX,B48.CTABИM B
  ,AOX,/UVCH/.OЧEPEДЬ
  ,ATX,/UVCH/.HA KAHAЛ
  ,ITA,S
 ,ASN,64-40
 ,ATX,CHR
  N,XTA,COT
  ,APX,M2*O
 ,AUX,M1*O
 ,AOX,CHR
 ,AOX,B7-1 .BIT 8
  N,ATX,COT
  ,UJ,BUSY
C
C=====  BXOД OT BPEMEHHЫX ПPEPЫBAHИЙ:
C
  MPX*TIM:,ENTRY,
  ,XTA,TIMER
  14,UZA,
  ,ARX,MAXTIM
  ,AAX,MAXTIM
  ,ATX,TIMER
  14,U1A,
  ,XTA,/UVCH/
  ,AAX,B48/33
  14,UZA,
  14,VTM,TEXT
  ,ITA,14
  14,VTM,REDY
  ,UJ,TTPRINT
  TEXT:,ISO,12HCБOЙ MPX*T.''
  TIMER:,LOG,
  ,END,
 SER*OUT:,NAME,
C
C*****   ПPEOБPAЗOBAHИE BЫBOДИMOГO CИMBOЛA
C*****      B KAPTY HAПPЯЖEHИЙ
C
 *TLSIZE:LC,BLOCK,XLM
 LMTR:,WEQ,XLM
 *TLMTR:,LC,LMTR+1
 *TLMTR:I,BLOCK,PHAS,MTR
 *TLBUFI:LC,BLOCK,CHR(0),CIN
 *TLPRMT :LC,BLOCK,(1),MIN(2)
 ,CONT,X*E(3),X*P(3),X*U(3)
 *TLSTAT:LC,BLOCK,BB,B/FREE(2),LAST
 *YCЫ:LC,BLOCK,(2),COMMIR
 WSD:LC,BLOCK,(2),N BB
 PERMIR:,SUBP,
 WRE*TL:,SUBP,
 *TLCONST:LC,BLOCK,(3),B47/40(2),M*TYC
  *TLSYN:LC,BLOCK,S*PAD(2)
 FULWOR:,LC,1
  B24/1:,LC,1
 C77777:,LC,1
 C377  :,LC,1
 *710:B,BLOCK,B40(14),B26(11)
 ,CONT,B15(14),B1
 B*OUT8:,EQU,B26
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 N:,EQU,10
 L:,EQU,11
 S:,EQU,12
 F:,EQU,13
 E:,EQU,14
 R:,EQU,15
C
C========
  ,XTA,S*PAD
 S,VZM,OUT 1.= PAD-SYMBOL
 ,ITA,S
 ,ASN,64-40
 ,ATX,CHR
 N,XTA,CIN
 ,AAX,B*OUT8
  ,AEX,B*OUT8
 ,UZA,NO/8
 ,XTA,CHR
 ,ACX,B1
 ,ASN,64-47
  NO/8:,AOX,CHR
  ,AEX,B47/40
  OUT1:,ATX,CHR
 ,UTC,X*U-X*P
C
C*****   CBEPTKA CИMBOЛA ИЗ KAPTЫ HAПPЯЖEHИЙ
C
 SER*INP:,ENTRY,
 R,VTM,
 ,ITA,14
 ,ATX,/RET
 14,VTM,-2
 PREP:14,XTA,X*E+2
 ,AAX,BB
 ,U1A,TYPE IS
 14,VLM,PREP
 TYPE IS:14,UTC,2
 R,XTA,X*P
 14,VTM,-2
 TY 1:14,ATI,F
 ,ASN,64+15
 14,VLM,TY 1
 ,WTC,PHAS
 F,UTM,
 R,V1M,OUT 2
 ,XTA,
 ,ATX,CHR
C-----   CБOPKA CИMBOЛA
 PACK:,ITA,F
 ,AAX,B15
 :,UZA,*+1
 F,UTM,L MTR
 :F,XTA,MTR
 ,AAX,BB
 ,ARX,CHR
 ,ARX,CHR
 ,ATX,CHR
 S,J+M,F
 L,VLM,PACK
  *ЧACTOTA:1,IFGE,FREQ,600
  13,VJM,CLOS*40
 ,XTA,N BB
 ,AEX,C77777
 ,ATI,S
 ,XTA,CHR
 S,ASN,64+49
 ,AEX,C377
 ,WTC,/RET
 ,UJ,
C-----   PAЗBEPTKA CИMBOЛA
 OUT 2:E,VTM,-9
 ,XTA,CHR
 ,ASN,64+1
 ,AEX,CHR.= ДИФФEP.KOД
 ,WTC,N BB
 E,ASN,64-2
 ,ATX,CHR
 UNP:,ITA,F
 ,AAX,B15
 :,UZA,*+1
 F,UTM,LMTR
 :,XTA,CHR
 ,ASN,64+1
 ,ATX,CHR
 ,AAX,BB
 F,AOX,MTR
 F,ATX,MTR
 S,J+M,F
 E,VLM,UNP
 ,XTA,BB
 L,MTJ,E
 R,VJM,WRE*TL
  *ЧACTOTA:1,IFGE,FREQ,600
  13,VJM,PER*40
  ,WTC,/RET
  ,UJ,
  *ЧACTOTA:,IFGE,FREQ,600
C
C*****   YCTAHOBKA CTPOБA BIO*TL
C
 PER*40:,ENTRY,
  *TL/ERR:LC,BLOCK,T31(2)
  ,XTA,B*START
 ,ATX,T31
 PER*40:,BSS,
 ,XTA,COMMIR
 ,AAX,B40
 13,U1A,
 ,XTA,MIN
 ,ATX,LAST
  ,XTA,B*START
 ,AEX,FULWOR
 ,AAX,COMMIR
 ,ATX,COMMIR
 ,XTA,B40
 ,UJ,PER MIR
C
C*****   CHЯTИE CTPOБA BIO*TL
C
 CLOS*40:,ENTRY,
  CLOS*40:,BSS,
 N,XTA,CIN
 ,AAX,M*TYC
 13,U1A,
 ,XTA,B/FREE
 ,AEX,FULWOR
  ,AAX,B24/1
 13,U1A,
 ,XTA,B40
 ,AEX,FULWOR
 ,AAX,COMMIR
 ,ATX,COMMIR
  ,XTA,B*START
 ,UJ,PER MIR
  *ЧACTOTA:,ENDIF,
 /RET:,BSS,1
 ,END,
 CIO*TL:,NAME,
C
C*****   CHARACTER   INPUT / OUTPUT
C           ФEДOCEEB , BEPETEHOB
C
 *TLBUFI:LC,BLOCK,CHR(0),CIN
 *TLBUFO:LC,BLOCK,COT
 *TLPRMT:LC,BLOCK,(2),MOT
 *TLSTAT:LC,BLOCK,BB(5),REQOUT(2)
 ,CONT,JIN,JOUT,JLINE,JTIM
 *YCЫ:LC,BLOCK,(4),PPIR
  MPXMASK:,LC,1
 ABTIME:LC,BLOCK,(1),NINT
 WSD:LC,BLOCK,(1),SAV*S,N BB
C
 RETURN:,SUBP,
 NEWTA:,SUBP,
  PERPIR:,SUBP,
 SDRV*INP:,SUBP,
 SDRV*OUT:,SUBP,
 FREE*TL:,SUBP,
 STRINGER:,SUBP,
 ALLTOISO:,SUBP,
 ISOTOALL:,SUBP,
 T*CC:,SUBP,
  CONN*OP:,SUBP,
C
 *TLCONST:LC,BLOCK,NL*RET,B48/41(3)
 ,CONT,M*OUT(2),M1*O,M2*O
  ,CONT,IN*FIC
  *TLSYN:LC,BLOCK,(1),C*WAIT
 *CB:LC,BLOCK,(1),C17
C
 B48/47:,LC,1
 C377:,LC,1
 C177:,LC,1
 C7:,LC,1
C
 NL:,EQU,12B
 ESC:,EQU,33B
  ESCP:,EQU,233B
 NEW:,EQU,-8
 OLD:,EQU,0
C
 *700:B,BLOCK,B48,B47,B46,B45,B44,B43
 ,CONT,B42,B41,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33,B32,B31
 ,CONT,B30,B29,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21,B20,B19
 ,CONT,B18,B17,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B9,B8,B7
 ,CONT,B6,B5,B4,B3,B2,B1
C
C-----   Б И T Ы  B  "C I N"
 IN*IS:,EQU,B32
 B*BELL:,EQU,B31
  SS*WT:,EQU,B30
 LF*CR:,EQU,B28
 B*IN8:,EQU,B27
 B*OUT8:,EQU,B26
  B*SYN:,EQU,B25
 R*OUT:,EQU,B17
 R*IN :,EQU,B16
 B*ESC:,EQU,B16
C
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 SS:,EQU,8
 C:,EQU,9
 N:,EQU,10
 L:,EQU,11
 S:,EQU,12
 F:,EQU,13
 E:,EQU,14
 R:,EQU,15
C
C=====
 15,VTM,SIR
 ,ITA,SS
 ,ITS,C
 ,ITS,N
 ,ITS,L
 ,ITS,S
 ,XTS,J TIM
  ,U1A,CONN*OP
 IF J:F,XTA,J LINE
 ,U1A,JOB
 F,VLM,IF J
 ,UJ,RETURN
C=====   PAБOTЫ : IN , OUT , LINER
 JOB:,ANX,
 ,ATI,N.N ФИЗ.KAHAЛA
  F,XTA, J LINE
  N,AEX,B48-1
 F,ATX,J LINE.OCTATOK ШKAЛЫ
 F,VZM,STRINGER. => STRINGER
 F,UTM,1
 N,XTA,B48-1
 F,AUX,MOT
 ,ATX,BB. HAШ БИT
 ,ANX,
 ,ATX,N BB.EГO HOMEP
  N,XTA,CIN
  ,ASN,64+21
  ,AAX,C7
  ,ATI,C.TИП TEPM.
  N,XTA,CIN
  F,AAX,B*OUT8. ИЛИ B*IN8
  ,ASN,64+12
  ,ATI,L.БЛOK.KOДИP.
 F,VZM,OUTPUT.-> ПOДГOT.BЫBOДA
 14,VJM,SDRV*INP
  L,VIM,NOC IN
C
C=====   ПEPEKOДИPOBKA HA BBOДE
C
 ,AAX,C177
 ,ATI,S
 S,MTJ,F
 F,UTM,-177B.CИMBOЛ-ПYCTO
 F,VZM,RESET. => ДA
  C,WTC,SW/TYP
  ,UJ,
C
C...   ПEPEKЛЮЧATEЛЬ ПO TИПAM TEPMИHAЛOB
C      ЛEBAЯ ЧACTЬ - BЫBOД, ПPABAЯ - BBOД.
C
  SW/TYP:,UJ,PARITY
  ,Z00,COD IN. VT-340
  :,UJ,ASCII
  ,Z00,NOC IN. CETEBOЙ
  :,UJ,RE OUT
  ,Z00,COD IN. CONSUL
  :,UJ,VDT*O
  ,Z00,VDT*I. VDT-52100
  :,UJ,Э15*O
  ,Z00,Э15*I. 15-ИЭ
C
C
C-----   15-ИЭ /BBOД/ CИMBOЛЫ 001/176
  Э15*I:,ITA,S
 ,ASN,64+5
 ,UZA,ЭЛ/CC*I
C-----   15-ИЭ /BBOД/ : CИMBOЛЫ 040/176
 ,AAX,B2
 ,UZA,COD IN
C-----   15-ИЭ /BBOД/ : CИMBOЛЫ 100/176
C             ( YЧET BB.PEГИCTPA )
 ,ITA,S
 ,AOX,B6
 ,AEX,B6
 ,ATI,S
 N,XTA,CIN
 ,AAX,R*IN
 ,UZA,COD IN
 S,UTM,40B
 ,UJ,COD IN
C-----   15-ИЭ /BBOД/ : CИMBOЛЫ 001/037
 ЭЛ/CC*I:S,XTA,T*CC
  ,ASN,64-16
 ,ARX,
 ,U1A,SYM IS
C-----   15-ИЭ /BBOД/ : "PYC" , "ЛAT"
 ,ASN,64+25
 N,AEX,CIN
 ,AAX,R*IN
 ,UJ,INV/CIN
C-----   VDT /BBOД/ CИMBOЛЫ 001/176
 VDT*I:,BSS,
  N,XTA,CIN
 ,AAX,B*ESC.БЫЛ 'ESCAPE'
 ,U1A,ESCAP 1. = ДA
 F,UTM,177B-ESC
 F,V1M,COD IN
C-----   VDT /BBOД/ : "ESCAPE"
 ,XTA,B*ESC
 ,UJ,INV/CIN
C-----   VDT /BBOД/ : CИMBOЛ HA "ESCAPE"
 ESCAP 1:N,AEX,CIN
 N,ATX,CIN
 ,ITA,S
 ,ASN,64+5
 ,AEX,B2
 ,U1A,COD IN
C-----   VDT /BBOД/ : CИMBOЛЫ 100/137
C                     (ПOCЛE "ESCAPE")
 S,XTA,T*CC-100B
  ,ASN,64-32
 ,UJ,SYM IS
  NOC IN:,ASN,64-40
  ,UJ,SYM IS1
 COD IN:S,XTA,ALLTOISO
 C,APX,MASKS
  SYM IS:,AAX,B48/41
 ,UZA,RESET
  SYM IS1:,AOX,IN*IS
 ,ATX,CHR
 N,XTA,CIN
 ,AAX,IN*FIC
 ,AOX,CHR
 N,ATX,CIN
 ,UJ,SET LINE
C
C=====   ПEPEKOДИPOBKA HA BЫBOДE
C
 OUTPUT:,BSS,
  C,MTJ,E
 C,VTM,NEW
 N,XTA,COT
 ,APX,M*OUT
 ,UZA,N U L
 ,ASN,64+40
 ,ATI,S
 ,YTA,.KOДИP.BЫBOД
  ,U1A,PAR/1. -> HET
  L,VIM,RE OUT
C-----   ПPOBEPKA HA COSY-ЗAДEPЖKY
  N,ARX,COT
  ,UZA,EMPTY.TAK И ECTЬ
  S,MTJ,SS
 S,XTA,ISOTOALL
 E,APX,MASKS
 ,UZA,NUL1. => ПYCTЫШKA
 ,ASN,64-8
 ,YTA,
 ,ATI,S
 ,ASN,64+5
  ,ATI,F.6-8 PAЗP.CИMB.
  E,U1A,SW/TYP
C-----   BCE-BCE  /BЫBOД/ : CИMBOЛЫ 0-37
  S,MTJ,R
  N,XTA,CIN
  R,UTM,-NL
  R,VZM,NL/S
  R,UTM,NL-27B
  R,VZM,PRINT/S
  R,UTM,27B-7
  R,VZM,BELL/S
  E,UJ,SW/TYP
C
C    ECЛИ ПO CИMBOЛY <CR> TEPMИHAЛ ПEPEBOДИT
C    KYPCOP B HAЧAЛO CTPOKИ - ЗAMEHЯEM  <LF>
C    HA ПOCЛEДOBATEЛЬHOCTЬ  <CR> <C.DOWN>
C
  NL/S:,AAX,LF*CR
  E,UZA,SW/TYP
  E,XTA,SW/TYP
  ,ASN,64+24
 :,ATI,R
  E,VIM,*+2. ДЛЯ VDT 12+15
  S,VTM,15B. ДЛЯ VT  15+32
  ,UTC,B45-NL*RET
  :,XTA,NL*RET
  ,UJ,OLD/C
C
  PRINT/S:,AAX,LF*CR
  E,UZA,SW/TYP
  S,VTM,15B
  E,UJ,SW/TYP
C
C-----   15-ИЭ /BЫBOД/ : CИMBOЛЫ 001/176
  Э15*O:,ITA,F
  ,UZA,ЭЛ/CC*O
 ,AAX,B2
 ,UZA,PARITY
C-----   15-ИЭ /BЫBOД/ : CИMBOЛЫ 100/176
 ,ITA,S
 ,ASN,64-11
 N,AEX,CIN
 ,AAX,R*OUT. PEГИCTP
 ,UZA,PARITY.= HYЖHЫЙ
C-----   15-ИЭ /BЫBOД/ : PEГИCTPЫ (PYC,ЛAT)
 N,AEX,CIN
 N,ATX,CIN
 C,VTM,OLD
 ,AAX,R*OUT
 ,ASN,64+16
 ,AEX,C17
 PUT*S:,ATI,S
 ,UJ,PARITY
C-----   15-ИЭ /BЫBOД/ : CИMBOЛЫ 001/037
 ЭЛ/CC*O:S,XTA,T*CC
 ,ASN,64+16
 ,AAX,C377
 ,UJ,PUT*S
 VDT*O:,BSS,
 F,VIM,PARITY
C-----   VDT /BЫBOД/ : CИMBOЛЫ 001/037
 S,XTA,T*CC
 ,AAX,C377
 ,UZA,NUL 1. -> ПYCTЫШKA
 ,ATI,S
 ,ASN,64-40
 ,AOX,B40
 ,ATX,SAV*S
 ,AAX,B48/47
 ,UZA,RE OUT. -> БEЗ "ESCAPE"
C-----   VDT /BЫBOД/ : CИMBOЛЫ 001/037
C                      ( HA "ESCAPE" )
 S,VTM,ESCP
 ,XTA,SAV*S
 ,AUX,M*OUT
  R,VTM,RE OUT
  OLD/COT:N,AEX,COT
  ,AAX,M*OUT
  OLD/C:N,AEX,COT
 N,ATX,COT
 C,VTM,OLD
  R,UJ,
C
  ASCII:SS,MTJ,S
  PARITY:,BSS,
  C,VZM,PAR/1
  F,VIM,PAR/1
  N,XTA,CIN
  ,AAX,SS*WT
  ,UZA,PAR/1
C-----   ПOДOЖДEM CPAБATЫBAHИЯ ROLL
  ,XTA,C*WAIT
  R,VJM,OLD/COT
  PAR/1:,ITA,S
 ,ACX,
 ,AAX,B1
 ,U1A,RE OUT
 S,UTM,200B
  ,UJ,RE OUT
C-----   BЫДAЧA ПYCTЫШKИ
  EMPTY:,ARX,ZB41
  N,ATX,COT
  C,VTM,OLD
  S,VTM,0
 RE OUT:14,VTM,IF COT
 ,UJ,SDRV*OUT
C=====
 N U L:,BSS,
C-----   БOЛЬШE HET CИMBOЛOB ДЛЯ BЫBOДA
  S,VTM,0
  N,XTA,CIN
  ,AAX,B*SYN
  ,U1A,RE OUT
 ,XTA,REQ OUT
 N,AOX,B48-1.- ЗAПPOCЫ
 N,AEX,B48-1. HA BЫBOД
 ,ATX,REQ OUT
 ,XTA,BB
 R,VJM,FREE*TL
  *ЧACTOTA:1,IFGE,FREQ,600
  ,CALL,CLOS*40
  ,UJ,SET LINE
C=====
  BELL/S:,AAX,B*BELL
  E,U1A,SW/TYP
 NUL 1:,BSS,
C=====   ЗAKAЗ HA BЫBOД CЛEД.CИMBOЛA
 F,VTM,J OUT
 R,VJM,SET J
C=====
 IF COT:C,VZM,RESET
 N,XTA,COT
 ,APX,M1*O
 ,AUX,M2*O
 N,ATX,COT
 ,U1A,RESET
C=====
 SET LINE:F,VTM,J LINE
 R,VTM,RESET
C=====   YCTAHOBKA ЗAKAЗA HA PAБOTY
 SET J:,BSS,
 N,XTA,B48-1
 F,AOX,
 F,ATX,
 R,UJ,
C
C=====   ПPOБЫ ЗAПYCKA ПO BPEMEHИ
 TIM*TERM:,ENTRY,
 ,XTA,NINT
 ,AAX,C377
 ,U1A,IF JOB
 ,XTA,B1
 ,ATX,J TIM
  ,XTA,MPXMASK
  ,AAX,6. 12/11 PP.
  ,UZA,TO CIO
  13,VTM,TO CIO.ПOДЗAПYCK
  ,UJ,PERPIR+2.MPX-ГOИ
C=====
 INV/CIN:N,AEX,CIN
 N,ATX,CIN
C
C=====   BOCCTAHOBЛEHИE ИP , ПPOБЫ ЗAПYCKOB
 RESET*TL:,ENTRY,
 RESET:14,VTM,RETURN
  15,VTM,SIR+5
  :,24,2003B
 15,XTA,
 ,STI,S
 ,STI,L
 ,STI,N
 ,STI,C
 ,STI,SS
 ,UJ,IF JOB
C
C=====   ПOДЗAПYCK  STRINGER'A
 STRT*DWN:,ENTRY,
 ,24,2003B
 N,XTA,B48-1
 ,AOX,JLINE
 ,ATX,JLINE
C
C=====   ПPOБЫ ЗAПYCKA ПO  П И П
 IFJOB*TL:,ENTRY,
 IF JOB:,BSS,
 ,XTA,JIN
 ,AOX,JOUT
 ,AOX,JLINE
 14,UZA,
 TO CIO:,XTA,B47
C
C=====   YCTAHOBKA ПPOГP.ИMMИT.ПPEPЫBAHИЙ
 PUT PIR:,ENTRY,
   :   ,24,2003B
 ,AOX,PPIR
 ,ATX,PPIR
 ,XTA,B6
 ,EXT,31B
 14,UJ,
C=====
 MASKS:,BSS,
 0,LOG,377.= VT-340
  1,LOG,377.= CETEBOЙ
 2,LOG,77600000.= KOHCYЛ
 3,LOG,377.= VDT-52130
 4,LOG,377.= 15-ИЭ
C=====
  ZB41:,OCT,7757 7777 7777 7777
C=====
 S IR:,BSS,5
 ,END,
 STRINGER:,NAME,
C
C*****   CTPOЧHИK  HA  ПPEPЫBAHИЯX
C*****   AПPEЛЬ 85       BEPETEHOB
C
 *TLSIZE:LC,BLOCK,(3),XNSS
 NSS:,WEQ,XNSS
 NSS1:,EQU,NSS-1
 *TLBUFI:LC,BLOCK,WS(0),CIN
 *TLBUFO:LC,BLOCK,COT
 *0:,BLOCK,LJOB,MSK,XNT,OWNER,WSC
 ,CONT,(1),STRI(14)
 *TLPRMT:LC,BLOCK,(2),MOT
 *TLSTAT:LC,BLOCK,(2),N/FREE(3),REQOUT
 ,CONT,(2),JOUT,JLINE,JTIM
 ,CONT,SPEC*CH,SC*DOWN,SC*BNL
 *TLSYS:LC,BLOCK,STATSS
 INITSS:,EQU,STATSS+NSS
 TIMSS:,EQU,INITSS+NSS
  *TLCONN:LC,BLOCK,S*INIT
  MAIN*C:,SUBP,
  E*INIT:,EQU,MAIN*C-1
  CHANSS:,EQU,MAIN*C
  NUM*SS:,EQU,MAIN*C+1
 MSTART:,LC,1
 NSTAJOB:,LC,1
 FLMAMБ:,LC,1
 *ИПД:LC,BLOCK,(53),ПAPTИЗAH
 *YCЫ:LC,BLOCK,
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
  FREESEM:LC,BLOCK,(1),MNEWTA
 WSD:LC,BLOCK,WS1(0),CHR*B
C-----
 COБЫTИE:,SUBP,
 BUSY*TL:,SUBP,
 RESET*TL:,SUBP,
 NO JOB:,EQU,RESET*TL
 CALL*OP:,SUBP,
C-----
 CHIR:,EQU,1
 STIN:,EQU,2
 EOT:,EQU,4
 CNOC:,EQU,4
C   CИMBOЛ '004' B BЫXOДHOЙ CTPOKE БЛOKИPYET
C   ПEPEKOДИPOBKY  CИMBOЛOB  И  ФOPMИPOBAHИE
C   БИTA ЧETHOCTИ ДO OKOHЧAHИЯ CTPOKИ.
 LF:,EQU,12B
 CR:,EQU,15B
 CNTR/Q:,EQU,21B
 TOIN:,EQU,22B
 CNTR/S:,EQU,23B
  BNL:,EQU,24B
 CUP:,EQU,31B
 IC:,EQU,34B
 DC:,EQU,35B
 DL:,EQU,36B
 MAPAШ:,EQU,43B
 STAR:,EQU,52B
  C*MAPAШ:,EQU,=6H'43'''''''''''
C-----
 *TLCONST:LC,BLOCK,(1),B48/41(7),IN*FIC(4)
 ,CONT,ZCIN,ZCIN1,B47/46,B16M
 ,CONT,B1M,B42/19(2),B48/33(2)
 ,CONT,M*LJOB
 FULWOR:,LC,1
 MASK12:LC,BLOCK,B48/37
 C77777:,LC,1
 C377:,LC,1
 C37:,LC,1
 C7:,LC,1
C-----
 *700:B,BLOCK,B48,B47,B46,B45,B44,B43
 ,CONT,B42,B41,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33,B32,B31
 ,CONT,B30,B29,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21,B20,B19
 ,CONT,B18,B17,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B9,B8,B7
 ,CONT,B6,B5,B4,B3,B2,B1
C
C-----   Б И T Ы  B  "C I N"
 IN*IS:,EQU,B32
 B*ECHO:,EQU,B29
 NOC*I:,EQU,B27
 NOC*O:,EQU,B26
C
C-----   Б И T Ы  B  "L J O B"
  B*INP:,EQU,B25
  B*BIN:,EQU,B28
  B*LIM:,EQU,B32
  B*INT:,EQU,B33
  B*END:,EQU,B34
 B*STAR:,EQU,B35
 B*IN  :,EQU,B36
 B*TAU :,EQU,B37
 B*STOP:,EQU,B38
 B*LIN :,EQU,B42
 B*DELC:,EQU,B43
 B*INSC:,EQU,B44
 B*KП:,EQU,B45
C
C-----   Б И T Ы  B  "T L S Y S"
 B*INI:,EQU,B16
C
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 SS:,EQU,8
 C:,EQU,9
 N:,EQU,10
 A:,EQU,11
 SI:,EQU,12
 SB:,EQU,13
 E:,EQU,14
 R:,EQU,15
C
C=====
C
 N,WTC,CIN
 C,VTM,.OПИCATEЛЬ KAHAЛA
 ,XTA,SPEC*CH
 N,AAX,B48-1
 ,UZA,NO/SPC
 SS,VTM,2.N П/C "Э P"
 SS,XTA,STATSS
 ,ATI,13
 13,VZM,NO JOB
 13,UJ,
 NO/SPC:,BSS,
 N,XTA,CIN
 C,VZM,CH*CONN.-> ПPИBЯЗKA
 ,ASN,64+32
 ,AAX,C7
 ,ATI,SS.HOMEP П/C
 SS,XTA,STATSS
 ,ATI,13
 13,UTC,
 13,V1M,
       N, XTA ,COT
        , U1A ,NO JOB.-> KAHAЛ ЗAHЯT
       C, XTA ,LJOB
  ,ATI,A.AДPEC ПO CTPOKE
        , AAX ,M*LJOB
        , UZA ,NO JOB.-> HET PAБOTЫ
        , ANX ,
        , ATI ,E
       E,  UJ ,SW*JOB-1
 SW*JOB:, BSS ,
     : R, VTM ,INI JOB.48 P.
        ,  UJ ,DEL/STA.HAЧAЛO PAБOTЫ
     :SI, VTM ,LF     .47 P.
        ,  UJ ,CH*BNL  ."LF" ДO
     :SI, VTM ,CUP    .46 P.
        ,  UJ ,OUT*1  .CURSOR UP
     :SI, VTM ,EOT    .45 P.
        ,  UJ ,TO*INP ."KП"
  :R,VTM,WS1.44 P.
  ,UJ,INS*DEL.INSERT CHAR *2
  :R,VTM,0.43 P.
  ,UJ,INS*DEL.DELETE CHAR *2
  :R,VTM,LIN/OUT.42 P.
        ,  UJ ,LINE   .L I N E
     : R, VTM ,DISCONN.41 P.
        ,  UJ ,DEL/STA.= OTBЯЗKA
     : R, VTM ,WHO*UP .40 P.
        ,  UJ ,DEL    .START UP
 INIJOB:, BSS ,
       R, VTM ,NO JOB
        ,  UJ ,SE TIME
C-----
 LINE:  , BSS ,
       N, XTA ,CIN
        , ASN ,64+40
        , ATI ,SI
       C, XTA ,LJOB
        , AAX ,B*IN
        , UZA ,GIV*SB.=> BЫBOД
       N, XTA ,CIN
        , AAX ,IN*IS
        , UZA ,TIMER .-> HET BBOДA
       N, XTA ,CIN
        , AAX ,IN*FIC
       N, ATX ,CIN
  C,XTA,LJOB.ПOCTABИM ПPИЗHAK
  ,AOX,B*INP.  "БЫЛ BBOД"
  C,ATX,LJOB
       R, VJM ,SE TIME
       N, XTA ,CIN
        , AAX ,NOC*I
        , U1A ,INP*1 .- БЛOK.AHAЛИЗA
        , ITA ,SI
        , ASN ,64+5
        , U1A ,INP*1.CИMBOЛ > 37
  C,XTA,LJOB
  ,AAX,B*BIN
  ,U1A,BIG INP
        , XTA ,M*EL
      SI, AAX ,B48
        , U1A ,INP*EL.-> KOHEЦ BBOДA
      SI, XTA ,B48
        , APX ,M*SPEC
        , UZA ,NO JOB.-> HE YПPABЛ.
        , ANX ,
        , ATI ,R
       R,  UJ ,SW*SPEC-1
 SW*SPEC:,BSS ,
      :C, XTA ,MSK   .CИMBOЛ 10
        ,  UJ ,CURS/L.= BACKSPACE
      :R, VTM ,NO JOB.CИMBOЛ 15
        ,  UJ ,INV/ST.= CATR.RETURN
      :R, VTM ,CURS/R.CИMBOЛ 30
        ,  UJ ,GIV*SB.= CURSOR-RIGHT
      : E,VTM ,B*INSC.CИMBOЛ 34
        ,  UJ ,INS/DEL.= INSERT CHAR.
      : E,VTM ,B*DELC.CИMBOЛ 35
        ,  UJ ,INS/DEL.= DELETE CHAR
 CURS/L:, BSS ,
C-----   CURSOR LEFT (BBOД)
        , ASN ,64-8
        , U1A ,CUL*1
       C, UTC ,STRI
       R, VTM ,
        , ITA ,R
       C, AEX ,LJOB
        , AAX ,C77777
        , UZA ,NO JOB.ДOШЛИ ДO HAЧAЛA
       C, XTA ,LJOB
        , ARX ,B1M
       C, ATX ,LJOB
        , XTA ,C377
 CUL*1:C, ATX ,MSK
       C, XTA ,LJOB
        , ARX ,B16M
       C, ATX ,LJOB
  ,ATI,A.  ECЛИ
  A,XTA,.  ПPEДЫДYЩИЙ
  C,APX,MSK.  CИMBOЛ
  ,ASN,64-3.  CЛYЖEБHЫЙ
  ,YTA,.- TOПЧEMCЯ
  ,UZA,STEP.HA MECTE
  OUT*0:R,VTM,PUT REQ
  ,UJ,CHBLR. SI --> COT
C-----   CИMBOЛ "CR" (BBOД/BЫBOД)
 INV/ST:, XTA ,B*STAR
       C, AEX ,LJOB
       C, ATX ,LJOB
       R,  UJ ,
 INS/DEL:,BSS,
C-----   INSERT/DELETE CHARACTER (ФAЗA 1)
 C,UTC,STRI+13
 R,VTM,
 ,ITA,R
 ,AEX,C77777
 C,ARX,LJOB
 C,ATX,WSC
  ,AAX,B15.ЗA ПPEДEЛAMИ
  ,UZA,NO JOB.  БYФEPA
  C,XTA,LJOB
  E,AOX,.ФAЗA 2
  C,ATX,LJOB
  ,UJ,RE*START
  INS*DEL:,BSS,
C-----   INSERT/DELETE CHARACTER (ФAЗA 2)
  C,WTC,WSC
  SB,VTM,1
 C,XTA,MSK
 ,AEX,FULWOR
 ,ATX,WS1
 A,XTA,
  R,V1M,INS*0
C-----   CДBИГ CTPOKИ BЛEBO
  SI,VTM,DC
  ,APX,WS1
  A,ATX,
  DEL*1:SB,VLM,DEL*2
  ,UJ,OUT*1
  DEL*2:A,XTA,1
  ,ASN,64-8
  A,ATX,1
  ,YTA,
  A,AOX,
  A,ATX,
  A,UTM,1
  ,UJ,DEL*1
C-----   CДBИГ CTPOKИ BПPABO
  INS*0:,ASN,64-40
 C,ATX,WSC
 A,XTA,
 ,AUX,WS1
  ,XTS,B46
  C,AUX,MSK
  SI,VTM,IC
  ,UJ,INS*2
  INS*1:A,UTM,1
  C,XTA,WSC
  A,XTS,
  ,ASN,64-40
  C,ATX,WSC
  ,YTA,
  INS*2:R,AOX,
  A,ATX,
  SB,VLM,INS*1
 ,UJ,OUT*1
C-----   ЭKPAHHЫЙ BBOД
  BIG INP:,BSS,
  SI,XTA,B48
  ,AAX,M*SPP
  ,UZA,NO JOB
  ,AAX,M*EP
  ,UZA,INP*1
  ,ASN,64-11
  ,UZA,INP*EL
  E,VTM,0.KOHEЦ BBOДA
C-----   ЗAПИCЬ CИMBOЛA B БYФEP
 INP*1: , BSS ,
        , ITA ,SI
        , ASN ,64-40
       C, AUX ,MSK
       A, AEX ,
       C, AAX ,MSK
       A, AEX ,
       A, ATX ,
  E,VZM,E*STR
C-----   OPГAHИЗAЦИЯ PEГEHEPAЦИИ
  R,VTM,STEP
       C, XTA ,LJOB
  ,AAX,B*STAR
  ,UZA,CHBLR
  ,UTC,B48-B*STAR
  SI,ASN,64-54B
  ,AAX,=:44."," + "/"
  ,U1A,CHBLR
  SI,VTM,STAR
  ,UJ,CHBLR
 LIN/OUT:,BSS ,
C
C=====   B Ы B O Д   CTPOKИ
C
      SI, VZM ,LO*1
       N, XTA ,CIN
        , AAX ,IN*FIC
       N, ATX ,CIN
  ,ITA,SI
      SI, UTM ,-CNTR/S
      SI, VZM ,STOP/ON
      SI, UTM ,CNTR/S-CNTR/Q
      SI, VZM ,STOP/OFF
  C,ATX,WSC.=> ПEPEБИBKA
  R,VJM,SET*INT
 LO*1: C, XTA ,LJOB
        , AAX ,B*STOP
        , U1A ,NO JOB.=> CTOПOP
       N, XTA ,CIN
        , AAX ,NOC*O
        , U1A ,LO*2  .=> БЛOK.AHAЛИЗA
      SB, VZM ,E*STR.-> KOHEЦ BЫBOДA
 ,ITA,SB
 ,ASN,64+5
 ,U1A,LO*2.CИMBOЛ > 37
 SB,XTA,B48
 ,APX,M*SPO
 ,UZA,LO*2.=> HE CПEЦ.
  ,ANX,C77777
  ,ATI,R
  E,VTM,1
 :R,VZM,STEP.CHIR
  R,UJ,*
 :E,VTM,.STIN
 ,UJ,OUT*IN
 :R,VTM,STEP.C*NOC
 ,UJ,INV/NOC
 :R,VTM,OUT*IN.CR
 ,UJ,INV/ST
  :,UJ,OUT*IN.TOIN
  E*STRO:,BSS,.BNL
C-----   БЛOKИPYEM "LF" B HAЧAЛE CTPOKИ
  N,XTA,B48-1
  ,AOX,SC*BNL
  ,ATX,SC*BNL
  ,UJ,E*STR
  CURS/R:,BSS,
C-----   CURSOR RIGHT (BBOД)
  ,ASN,64+5
  ,UZA,NO JOB.ДOШЛИ ДO KOHЦA
  SB,MTJ,SI
  R,VTM,STEP
C
C...   ПPOБA БЛOKИPOBKИ PEГEHEPAЦИИ
C
  CHBLR:N,XTA,CIN
  C,AOX,LJOB
  ,AAX,B*ECHO
  R,U1A,
  ,ITA,SI
  ,ASN,64-40
  N,ATX,COT
  R,UJ,
C
C...   CИMBOЛ - HA BЫBOД
C
 LO*2:  , XTA ,CHR*B
  N,ATX,COT
 ,U1A,STEP
 R,VTM,E*STRO
C    KOHEЦ CTPOKИ "БEЗ ПEPEKOДИPOBKИ BЫBOДA"
 INV/NOC:,BSS,
 N,XTA,CIN
 ,AEX,NOC*O
 N,ATX,CIN
 R,UJ,
  OUT*IN:C,XTA,LJOB
  ,AOX,B*KП
  C,ATX,LJOB
  E,VIM,NOJOB
C-----   ШAГ BПEPEД ПO CTPOKE
 STEP:  , BSS ,
       R, VTM ,LIMIT
       C, XTA ,MSK
        , ASN ,64+8
        , U1A ,STEP 1
        , XTA ,B1
       C, ARX ,LJOB
       C, ATX ,LJOB
        , XTA ,B48/41
 STEP1:C, ATX ,MSK
       C, XTA ,LJOB
        , ARX ,B16
       C, ATX ,LJOB
        , AAX ,B24   .ЛOПHYЛA ДЛИHA
        , UZA ,CH*OUT.-> HET
       N, XTA ,COT
        ,  UJ ,SET*OUT
 CH*OUT:, BSS ,
       N, XTA ,COT
        , U1A ,PUT REQ
       C, XTA ,LJOB
        , AAX ,B*IN
        , U1A ,NO JOB
        ,  UJ ,RE*START
 STOP/ON:,XTA ,B*STOP
       C, AOX ,LJOB
 STOP/:C, ATX ,LJOB
        ,  UJ ,LO*1
 STOP/OFF:C,XTA,LJOB
        , AOX ,B*STOP
        , AEX ,B*STOP
        ,  UJ ,STOP/
C-----   PAБOTA : ПEPEXOД HA BBOД
 TO*INP:, BSS ,
       C, XTA ,LJOB
        , AAX ,M1/O*I
        , AOX ,B*IN
       C, ATX ,LJOB
C-----   BЫДAЧA OДHOГO CИMBOЛA
  OUT*1:R,VTM,PUT REQ
  ,ITA,SI
  ,ASN,64-40
  N,ATX,COT
C-----   ИCKЛЮЧEHИE БИTA ИЗ ШKAЛЫ PAБOT
 DEL : E, XTA ,B48-1
       C, AEX ,LJOB
       C, ATX ,LJOB
       R,  UJ ,
C-----   ПPOBEPKA HEOБXOДИMOCTИ "LF" ДO.
  CH*BNL:,BSS,
  N,XTA,B48-1
  ,AAX,SC*BNL
  ,UZA,OUT*1
  ,AEX,SC*BNL
  ,ATX,SC*BNL
  R,VTM,NO JOB
C-----   ИCKЛЮЧEHИE БИTA И PECTAPT
 DEL/STA:N,XTA,B48-1
 ,AOX,J LINE
 ,ATX,J LINE
 ,UJ,DEL
C-----   TEKYЩИЙ CИMBOЛ ИЗ БYФEPA
 GIV*SB:, BSS ,
       A, XTA ,
       C, APX ,MSK
        , ATX ,CHR*B
        , ASN ,64+40
        , ATI ,SB
       R,  UJ ,
 SETIME:, BSS ,
C-----   YCTAHOBKA TAЙMEPA
       C, XTA ,XNT
        , ASN ,64-8
       C, AEX ,XNT
        , AAX ,B48/41
       C, AEX ,XNT
       C, ATX ,XNT
       R,  UJ ,
C-----   BEДEHИE TAЙMEPA
 TIMER: , BSS ,
       N, XTA ,B48-1
      SS, AAX ,TIMSS
      SS, AEX ,TIMSS
      SS, ATX ,TIMSS
        , YTA ,
        , UZA ,NO JOB
       C, XTA ,LJOB
        , AAX ,B*TAU
        , UZA ,NO JOB
        , XTA ,B41
       C, ARX ,XNT
       C, ATX ,XNT
        , U1A ,NO JOB
C
  R,VTM,E*STR
C-----   ПPИЗHAK: ПPEPBAH BBOД/BЫBOД
  SET*INT:,BSS,
  C,XTA,LJOB
  ,AOX,B*INT
  C,ATX,LJOB
  R,UJ,
C
 LIMIT:,BSS,
  SI,VTM,
  C,XTA,LJOB
  ,AOX,B*LIM.ЛOПHYЛA CTPOKA
  C,ATX,LJOB
  ,AAX,B*IN
  ,UZA,E*STR
C
 INP*EL:, BSS ,
C-----   KOHEЦ CTPOKИ ПPИ BBOДE
  ,ITA,SI
  C,ATX,WSC
       C, XTA ,MSK
        , ANX ,C77777
        , ATI ,R
        , XTA ,FULWOR
  :SI,V1M,*+1
  R,VZM,E*STR
       R, ASN ,64
  ,YTA,
       A, AAX ,
       A, ATX ,
  SI,XTA,B48
  ,AAX,M*DL
  ,UZA,E*STR
  ,XTA,C*MAPAШ
  N,ATX,COT
  R,VJM,SET*OUT
 E*STR: , BSS ,
C-----   KOHEЦ CTPOKИ (BBOД/BЫBOД)
  C,XTA,LJOB
  ,AOX,B*END
        , AEX ,B*LIN
       C, ATX ,LJOB
 RE*START:,BSS,
C-----   CAMOПOДЗAПYCK STRINGER'A
       N, XTA ,B48-1
 ,AOX,J LINE
 ,ATX,J LINE
 ,UJ,NO JOB
C-----   ЗAПYCK HYЖHOЙ ПOДCИCTEMЫ
 WHO*UP:SS,VZM,CALL*OP.-> OPERTERM
 SS,XTA,STATSS
 ,ASN,64+42
 ,U1A,SS YES.-> П/C ECTЬ
C=====   HAЧAЛЬHЫЙ BЫЗOB П/C   =====
 SS,XTA,STATSS
 ,AAX,B*INI
  ,AOX,MSTART
 ,U1A,RESET*TL.-> CTAPTEP ЗAHЯT
 SS,XTA,NUM*SS-1
  ,AAX,C77777
 ,AOX,B47/46
 ,ATX,MSTART.ДOCTATOЧHO
 ,XTA,B*INI
 SS,AOX,STATSS
 SS,ATX,STATSS
 ,UJ,RESET*TL
C=====   ГEHEPAЦИЯ COБЫTИЯ ДЛЯ П/C
 SS YES:,ATI,E.= Д H З  П/C
 E,XTA,*YCЫ
 ,ATX,MNEWTA
 ,AEX,
 ,XTA,COБ/ПC
 ,UJ,COБЫTИE
 COБ/ПC:,Z02,.BIT41
 ,Z00,RESET*TL
C=====   ПPOБЫ HA ПPИBЯЗKY
 CH*CONN:,BSS,
 C,VTM,S*INIT-E*INIT
 ,AAX,B*ECHO
 ,U1A,CH*SY
 N,XTA,CIN
 ,AAX,B48/41
 ,UZA,RESET*TL
 N,ATX,COT
 R,VJM,SET*OUT
 CH*SY:C,XTA,E*INIT
  ,ATI,SS
 N,AEX,CIN
 ,ASN,64+32
 ,UZA,*INIT
 C,VLM,CH*SY
 NO/STRT:,BSS,
 N,XTA,CIN
 ,ASN,64+8
 N,AEX,CIN
 ,AAX,B48/33
 N,AEX,CIN
 ,AAX,IN*FIC
 ,UJ,PUT CIN
C
C=====   З A П Y C K И   П / C
C
 *INIT:,BSS,
C-----   HET ЛИ БЛOKИPOBKИ ПPИBЯЗKИ
  ,XTA,2
  SS,AAX,B29.29,28,...PP.TP-2
  ,AOX,FLMAMБ.DISPINIT, MAЛOMБ
 ,U1A,CLE CIN
C-----   HET ЛИ БЛOKИPOBKИ ФИЗ.KAHAЛA
  SS,XTA,CHANSS
  ,AOX,SC*DOWN
  ,AEX,SC*DOWN
 N,AAX,B48-1
 ,UZA,NO/STRT.-> ECTЬ
 N,XTA,B24-1
 SS,AOX,INITSS
 SS,ATX,INITSS
 ,UJ,CLECIN/U
C=====   ЗAДAHИE TИПA TEPMИHAЛЬHOГO KAHAЛA
 CLE CIN:N,XTA,CIN
 ,AAX,ZCIN
 PUT CIN:N,ATX,CIN
 ,UJ,RESET*TL
C
C=====   PEAЛИЗAЦИЯ ЗAKAЗA HA OTBЯЗKY
C
 DIS CONN:,BSS,
 N,XTA,B42-1
 ,AEX,FULWOR
 SS,AAX,STATSS
 SS,ATX,STATSS
 C,XTA,XNT
 ,ASN,64+15
 ,AAX,C37
 ,ATI,E
 E,XTA,B36-1
 ,AEX,FULWOR
 SS,AAX,INITSS
 SS,ATX,INITSS
 ,XTA,
 SS,ATX,TIMSS
  SS,VZM,CLECIN/U
  ,ATX,531B.TEPM.CTAT.
 CLECIN/U:N,XTA,CIN
 ,AAX,ZCIN
 N,ATX,CIN
 ,UJ,WHO*UP
C
C*****   ПPИBЯЗKA KAHAЛA K ПOДCИCTEME
C
C   OБPAЩEHИE ПO ИP-13
C              B ИP-14 - N ФИЗ.KAHAЛA
C              B ИP-12 - N ПOДCИCTEMЫ
C
C   CYMMATOP : PP.15/01 - AДPEC БYФEPA
C
 CONN*SS:,ENTRY,
  :,24,2003B
 ,ATX,WS
 ,ITA,12
 ,ASN,64-32
 ,AOX,WS
 14,AEX,CIN
 ,AAX,MSKC1
 14,AEX,CIN
 14,ATX,CIN
 ,XTA,ДHЗ
 ,ASN,64-42
 12,AEX,STATSS
 ,AAX,MSKC2
 12,AEX,STATSS
 14,AOX,B42-1
 12,ATX,STATSS
  ,XTA,BITJ
 ,AOX,ПAPTИЗAH
 ,ATX,ПAPTИЗAH
 13,UJ,
C
C*****   ЗAПYCK HИЗA HA BЫBOД CИMBOЛA
C
 PUT REQ:,BSS,
 N,XTA,COT
 R,VTM,NO JOB
C
 SET*OUT:,ENTRY,
 SET*OUT:R,UZA,
 ,XTA,REQ OUT
 N,AOX,B48-1
 ,ATX,REQ OUT
 ,AAX,N/FREE
 ,AOX,J OUT
 ,ATX,J OUT
 N,AAX,B48-1
 R,UZA,
 ,AUX,MOT
 ,UJ,BUSY*TL
C
C*****   ЧИCTKA ПO HEЗAПYCKY П/C
C         (BXOД ИЗ "STARTJOB")
C
 CLMTSP:,ENTRY,
 13,VTM,-2
 CL 1:13,XTA,NUM*SS+2
 ,AEX,NSTAJOB
 ,AAX,C77777
 ,U1A,CL 2
 13,ATX,STATSS+3
 ,XTA,B48/37
 13,AAX,INITSS+3
 13,ATX,INITSS+3
 CL 2:13,VLM,CL 1
 ,XTA,
 ,ATX,NSTAJOB
 14,UJ,
C*****
C
C         ETX LF IL HOME CUP CDWN DL ERASE
  M*EL:,GOST,6H'20''70'0'143'00
C
C               ETX CL LF IL HOME BK PRINT
C               CR CUP CDWN IC DC DL ERASE
  M*SPP:,GOST,6H'20''274'1'357'00
C
C                    ETX LF IL BK DL ERASE
  M*EP:,GOST,6H'20''64'0300
C
C                    DL  ERASE
  M*DL:,GOST,6H000300
C
C                    CL BK CR IC DC
 M*SPEC:,GOST,6H0'204'0'214'00
C
C                CHIR STIN CNOC CR TOIN BNL
 M*SPO:,OCT,3200 205
C
C
 M1/O*I:,OCT,04776177 37777777
 MSKC1:,LOG,77777400 000 77777
 MSKC2:,OCT,77000000 001
C
 ,END,
 VALERINA:,NAME,
C
C*****   ДEШИФPATOP   COБЫTИЙ   CИCTEMЫ
C           " M Y Л Ь T И T A Й П "
C        ЯHBAPЬ 86          B.BEPETEHOB
C
C     OБPAБATЫBAЮTCЯ COБЫTИЯ :
C     P.48 - KOHEЦ OБMEHA C MБ/MД/MЛ
C       47 - CEKYHДHAЯ METKA BPEMEHИ
C       43 - COOБЩEHИE OT ДPYГOГO KAHAЛA
C       42 - COOБЩEHИE OT OПEPATOPA
C       41 - COOБЩEHИE OT CTPOЧHИKA
C       40 - ЗAKAЗ OT MYЛЬTИTAЙПA
C
C=====   Г Л A B H Ы Й   X O З Я И H
 MULTITYP:,SUBP,
C
C-----   CBЯЗЬ C TEPMИHAЛЬHЫM HИЗOM
 SEC5:,EQU,200B-5
 MIN2:,EQU,200B-120
 *TLSIZE:LC,BLOCK,(3),XNSS
 NSS:,WEQ,XNSS
 *TLBUFI:LC,BLOCK,CIN
 *0:,BLOCK,LJOB,MSK,XNT,OWNER,WSC
 ,CONT,(1),STRI
 *TLSYS:LC,BLOCK,(1),STATMT
 INITMT:,EQU,STATMT+NSS
 REFMT:,EQU,INITMT+NSS
 *SCAL71:LC,BLOCK,SC71,READY71
  ,CONT,(4),READY/2
  *TASK71:LC,BLOCK,(8),CHAN/J(8)
  *YCЫ:LC,BLOCK,(1),RDSCAL
 *TLSTAT:LC,BLOCK,(11),SPEC*CH(2),SC*BNL
 *TLCONST:LC,BLOCK,(1),MSK0(16)
 ,CONT,B42/19(4),M*LJOB
 CONN*SS:,SUBP,
 STRT*DWN:,SUBP,
C
C-----   ЧИCЛO ЛOГ.KAHAЛOB И ПPOИЗBOДHЫE
 NC:,EQU,10.ЧИCЛO Л-KAHAЛOB
 NCM1:,EQU,NC-1
 NCM3:,EQU,NC-3
 NC*2:,P*P,(NC) 2
C
C     CBЯЗЬ C HEPEЗИДEHTOM MYЛЬTИTAЙПA
 FETCH:,EQU,2000B
C
C     CBЯЗЬ C MYЛЬTИTAЙПOM HA PAБЛИCTE
 NPAБЛИCT:LC,BLOCK,MAT/PH
 *66:B,BLOCK,T/IS,S/BUS
  *74:B,BLOCK,SC*CUP.HYЖEH "CUP".
 *657:B,BLOCK,SC CAN  .OTMEHA CTPOKИ
       ,CONT ,SC END  .CБPOC CHИЗY
       ,CONT ,SC LINE .ЗAKOHЧEHA CTPOKA
       ,CONT ,SC INT  .ПPEPBAH BЫBOД
       ,CONT ,SC NEW  .HAЧAЛO CEAHCA
       ,CONT ,SC TIME .ЛOПHYЛO BPEMЯ
       ,CONT ,ST MT   .KOHЦЫ OБMEHA
       ,CONT ,RE MT   .ПOДЗAПYCK MT
       ,CONT ,SC WAIT .ЗAKAЗЫ HA OБMEH
 *670:B,BLOCK,JOB(NC) .MT-ЗAKAЗЫ
       ,CONT ,RETADR(NC*2).BOЗBPAT
       ,CONT ,TEKAДP(NC*2).
       ,CONT ,ASTR(NC).AДPECA БYФEPOB
 ***1:,EQU,1202B.= "CBOБOДHO"
  ***1:I,BLOCK,ASPBUF(NC)
  ,CONT,SPBUF(192)
  ,CONT,S*LJOB(NC)
       ,CONT,S*MSK(NC)
       ,CONT,TLG*(14)
 *1750:B,BLOCK,PБYФ(24)
C
C-----   CBЯЗЬ ПO TEЛEГPAФY C "TTANAL"
 *436:B,BLOCK,TEL/IS(2)
 ,CONT,TLG1
C
C-----   Б И T Ы :
 PB48:,EQU,700B
 B48:,EQU,=:4
 B47:,EQU,=:2
 B46:,EQU,=:1
 B41:,EQU,=:002
 B40:,EQU,=:001
 B36:,EQU,=:0000 4
 B34:,EQU,=:0000 1
 B33:,EQU,=:0000 04
  B32:,EQU,=:0000 02
 B30:,EQU,=:0000 004
  B28:,EQU,=:0000 001
  B24:,EQU,=4000 0000
 PB24:,EQU,730B
 B*CUP:,EQU,B46
 B*OTB:,EQU,B41
 B*IN:,EQU,B36
 B*INT:,EQU,B33
 B*TIM:,EQU,B33
 B*LIM:,EQU,B34
 B*COSY:,EQU,B30
  B*LON:,EQU,B32
  B*BIN:,EQU,B28
C
C-----   ИCПOЛЬЗYEMЫE CИMBOЛЫ
 DL:,EQU,36B
  ERASE:,EQU,37B
C
C-----   PAБOЧИE ЯЧEЙKИ
 LWORK:,EQU,20.= ДЛИHA WORK
 WORK:I,BLOCK,WS,BCH,SC,Ш/COБ
 ,CONT,SI1(10),STACK(5)
C
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ :
 JC:,EQU,2
 B:,EQU,3
 L:,EQU,4
 M:,EQU,5
 S:,EQU,6
 C:,EQU,8
 T:,EQU,9
 N:,EQU,10
 L1:,EQU,11
 R:,EQU,13
C
 BEGIN:,BSS,
C
C-----   MACKA BOCПPИHИMAEMЫX COБЫTИЙ
 :12,Z07,
 ,Z01,ДEШИФP
C
C-----   ПOЛE YПPЯTЫBAHИЯ
 П YПP:,BSS,13
 Ш/KO:,BSS,3
C
C=====   BXOД B ДEШИФPATOP
C
C     HA CYMMATOPE - ШKAЛA COБЫTИЙ
C
 ДEШИФP:,BSS,
 13,BAS,П YПP
 ,AAX,B48/25
 15,VTM,Ш/COБ
C.....   Y П P Я T Ы B A H И Я
 14,VTM,-10
 :14,ITS,11
 14,VLM,*
C
C-----   ГЛABHЫЙ ЦИKЛ OБPAБOTKИ COБЫTИЙ
 M LOOP:,BSS,
 B,BASE,BEGIN
 15,VTM,STACK
 ,XTA,Ш/COБ
 ,UZA,NEXT/EV
 ,ANX,
 ,ATI,12
 ,YTA,
 12,ASN,64
 ,ATX,Ш/COБ
 12,UJ,SWITCH-1
C
C=====   ПEPEKЛЮЧATEЛЬ COБЫTИЙ
C
 SWITCH:,BSS,
 :,,.- 48P
 ,UJ,KOH/OБM
 :,,.- 47P
 ,UJ,CEK/MET.= CEKYHД.METKA
 :,,.- 46P.
 ,UJ,NEXT/EV.= PEЗEPB
 :,,.- 45P.
 ,UJ,NEXT/EV.= COБЫTИE ЭK71
 :,,.- 44P.
 ,UJ,NEXT/EV.= OT ПOЧTЫ
 :,,.- 43P.
 ,UJ,NEXT/EV.= PEЗEPB
 :,,.- 42P
 ,UJ,OПEPATOP.= OПEPATOP
 :,,.- 41P
 ,UJ,CTPOЧHИK
 :L,VTM,-NCM3.- 40P
 ,UJ,MYЛЬTИ
C
C=====   COБЫTИE : "KOHEЦ OБMEHA C MД"
C
 KOH/OБM:,BSS,
 ,XTA,Ш/KO
 ,AAX,B48/17
 ,UZA,NEXT/EV
 ,ANX,C77777
 ,ATI,14.MAT.N ЛИCTA
 ,ASN,64-30
 ,ATX,WS
 L,VTM,-NCM3
 14,*65,PB48
 ,AEX,Ш/KO
 ,ATX,Ш/KO
 KO 1:L,XTA,RETADR+NCM1
 ,AEX,WS
 ,AAX,B35/31
 ,UZA,KO 2
 L,VLM,KO 1
 ,UJ,KOH/OБM
 KO 2:,XTA,B48
 L,ASN,64+NCM1
 ,AOX,ST MT
 ,ATX,ST MT
 ,UJ,KOH/OБM
C
C=====   COБЫTИE : CEKYHДHAЯ METKA
C
 CEK/MET:,BSS,
 ,XTA,SC WAIT
 ,AOX,ST MT
 ,ATX,ST MT
 ,UTC,1.= ПPИЗHAK
C
C=====   COБЫTИE : "C T P O Ч H И K"
C
 CTPOЧHИK:,BSS,
 M,VTM,
 ,XTA,STATMT
 ,APX,B42/19
 ,AOX,SPEC*CH
 ,AEX,SPEC*CH
 ,ATX,SC
C-----   ЦИKЛ ПO ПPИBЯЗAHHЫM Ф-KAHAЛAM
 CTP 0:,XTA,SC
 ,UZA,ПPИBЯЗ
 ,ANX,
 ,ATI,N.N ФИЗ.KAHAЛA
 ,YTA,
 N,ASN,64
 ,ATX,SC
 N,*65,CIN
 ,AAX,C1777.AДPEC БYФEPA
 ,ATI,C.M-AДP OПИCATEЛЯ
 C,XTA,XNT
 ,ASN,64+15
 ,AAX,C37
 ,ATI,L.N ЛOГ.KAHAЛA
 L,*65,PB48-1
 ,ATX,BCH
  ,XTA,B24
  N,ASN,64-1
  ,AAX,REFMT.- OTBЯЗATЬCЯ
 ,U1A,OTBЯЗ.-> ДA
 R,VJM,CH*TEL.- ПPOB.TEЛE.
C-----   HE TEЛEГPAMMY ЛИ OTPAБATЫBAЛИ
 CH*BUS:C,XTA,LJOB
 ,AAX,M*LJOB
 ,U1A,CTP 0.-> KAHAЛ ЗAHЯT
 L,XTA,S*LJOB-1
 ,UZA,NO TEL
 ,AOX,B47
 C,ATX,LJOB
 L,XTA,S*MSK-1
 C,ATX,MSK
 ,XTA,
 L,ATX,S*LJOB-1
 ,UJ,CH*BUS
 NO TEL:,BSS,
 M,V1M,CTP 0.-> CEK.MET.
C-----   KAK C ЗAKAЗOM OT MYЛЬTИTAЙПA
 ,XTA,S/BUS
 ,AAX,BCH
 ,UZA,CTP 1.-> YЖE OTPAБOTAH
 ,AEX,S/BUS
 ,ATX,S/BUS
 ,XTA,M*JOB
 L,AAX,JOB-1
 L,ATX,JOB-1
 C,XTA,LJOB
 ,UZA,CTP 0
 ,AAX,B*IN
  ,UZA,W/O
  C,XTA,LJOB
  ,AAX,B*BIN
  ,UZA,W/IN
  C,XTA,LJOB
  ,AAX,B*LON
  ,UZA,CTP END
  L,XTA,ASPBUF-1
  ,ARX,=:02
  L,ATX,ASPBUF-1
  ,UZA,CTP END
  ,ATI,15
C-----   ПEPEПИCЬ OЧEPEДHOЙ ПOPЦИИ БYФEPA
  C,MTJ,T
  R,VTM,-23
  C/BUF:T,XTA,STRI
  ,XTS,
  T,ATX,STRI
  T,UTM,1
  R,VLM,C/BUF
  15,VTM,STACK
C-----   OTKPЫBAEM ЗAДAЧY
  ,XTA,BCH
  ,AOX,READY/2
  ,ATX,READY/2
  L,XTA,CHAN/J-3
  ,AEX,
  ,*53,RDSCAL
  ,XTA,
  L,ATX,CHAN/J-3
C-----   ПOBTOPИM ЗAKAЗ HA BBOД
  ,XTA,BCH
  ,AOX,S/BUS
  ,ATX,S/BUS
  L,XTA,ASTR-1
  ,ARX,IW/CONT
  ,UJ,SET*DWN
C-----   OKOHЧAHИE BBOДA
  W/IN:,BSS,
  C,XTA,STRI
  ,U1A,W/I
  ,XTA,B48
  N,ASN,64-1
  ,AOX,SC*CUP
  ,ATX,SC*CUP
  W/I:,BSS,
  C,WTC,WSC
  S,VTM,-DL
  S,VZM,CTP D.=> OTMEHA CTPOKИ
  S,UTM,DL - ERASE
  S,VZM,CTP D
  ,UTC,SC TIME -SCINT .=> TAЙMEP
  W/O:T,VTM,SC INT.=> ПEPEБИBKA
  C,XTA,LJOB
  ,AAX,B*INT
  ,U1A,CTP E
  CTP END:T,VTM,SC LINE.=> HOPM.KOHEЦ
 CTP E:,BSS,
 R,VTM,CTP 0
 ,UJ,TO SC
  CTP D:T,VTM,SC CAN
 C,XTA,WSC
 ,ASN,64+8
 ,ASN,64-8
 C,ATX,WSC
  ,UJ,CTP E
C-----   HET ЛИ HOBOГO ЗAKAЗA OT MT
 CTP 1:,BSS,
 L,XTA,JOB-1
 ,AOX,M*JOB
 ,AEX,M*JOB
 ,UZA,CTP 0.-> HET
C-----   ПOДПИXHEM ПEPEДAЧY ЗAKAЗA
 ,XTA,B40
 ,AOX,Ш/COБ
 ,ATX,Ш/COБ
 ,UJ,CTP 0
C
C-----   HET ЛИ ЖДYЩEЙ TEЛEГPAMMЫ
 CH*TEL:,BSS,
 N,*65,PB48-1
 ,ATX,WS
 ,AAX,T/IS
 R,UZA,.-> HET
C-----   ECTЬ TEЛEГPAMMA
 C,XTA,LJOB
 ,AAX,M*LJOB
 ,UZA,CH*T.-> KAHAЛ CBOБ.
 C,XTA,LJOB
 ,AAX,B*IN
 ,UZA,CTP 0.-> KAHAЛ ЗAHЯT
 CH*T:,XTA,WS
 ,AEX,T/IS
 ,ATX,T/IS
 C,XTA,LJOB
 L,ATX,S*LJOB-1
 C,XTA,MSK
 L,ATX,S*MSK-1
 R,VTM,MIN2
 ,XTA,BCH
 ,AOX,S/BUS
 ,ATX,S/BUS
 ,XTA,J*TEL
  SET*DWN:,BSS,
 ,AOX,MAT/PH
 ,WTC,MAT/PH
 C,UTM,
 ,*76,*DWN
 ,UJ,CTP 0
C-----   HAЧAЛO OTBЯЗKИ KAHAЛA
  OTBЯЗ:,ASN,64. PMP = 0 !!!
  ,*53,REF MT
  C,XTA,LJOB
  ,AOX,M*LJOB
  ,AEX,M*LJOB
  C,ATX,LJOB
  ,XTA,S/BUS
 ,AOX,BCH
 ,AEX,BCH
 ,ATX,S/BUS
 ,XTA,M*JOB
 L,AAX,JOB-1
 L,ATX,JOB-1
 T,VTM,SC END
 ,UJ,CTP E
C-----   PEAЛИЗAЦИЯ ПPИBЯЗKИ HOBЫX
 ПPИBЯЗ:,BSS,
  ,XTA,INITMT
  ,ASN,64-24
  ,UZA,CH/END
  ,ANX,
  ,ATI,N
  ,XTA,B24
  N,ASN,64-1. PMP = 0 !!!
  ,*53,INIT MT
 ,ASN,64-12
 ,AEX,INITMT
 ,AAX,B48/37
 ,UZA,ПPИBЯЗ.-> BCE ЗAHЯTO
 ,ANX,C77777
 ,ATI,L
 L,WTC,ASTR
 C,VTM,LJOB-STRI.MAT.AДP. БYФEPA
C.....   ЗAЙMEM ЛOГИЧECKИЙ KAHAЛ
 ,XTA,B48
 L,ASN,64+12
 ,AEX,
 ,*53,INITMT
C.....   CФOPMИPYEM : LJOB OWNER XNT
 ,XTA,
 C,ATX,LJOB
 C,ATX,OWNER
 ,ITA,N
 L,UTM,1
 ,ITS,L
 ,ASN,64-15
 15,AOX,
 C,ATX,XNT
C.....   ПPИBЯЖEMCЯ BHИЗY
 12,VTM,1.N П/C "MT"
 ,ITA,C
 ,AEX,MAT/PH
 ,*76,M*CONN
C.....   COOБЩИM HOBЫX MYЛЬTИTAЙПY
 ,XTA,B48
 L,ASN,64-1
 ,ATX,BCH
 T,VTM,SC NEW
 R,VTM,ПPИBЯЗ
 ,UJ,TO SC
 CH/END:,BSS,
 ,*65,STATMT
 ,AAX,B42/19
 ,U1A,NEXT/EV
 ,SJ,
 M*CONN:,BSS,
 N,MTJ,14
 13,VJM,CONN*SS
 ,MTJ,27B
 2,IJ,
C
C=====   COБЫTИE : "O П E P A T O P"
C                   ( TEЛEГPAMMA )
C
 OПEPATOP:,BSS,
 L,VTM,-1
 T,VTM,TLG1
 ,XTA,STATMT
 ,ASN,64+42
 ,NTR,3
 ,X-A,C60
 ,AOX,C1440
 ,ATX,WS.= HAШ TEPMИHATOP
C-----   HAЙДEM OTПPABИTEЛЯ
 OП 1:L,*65,TEL/IS+1
 ,AEX,WS
 L1,VTM,-12
 ,UZA,OП 2
 T,UTM,14
 L,VLM,OП 1
 ,UJ,NEXT/EV.-> HET EГO
C-----   ЗAПOMHИM TEЛEГPAMMY
 OП 2:L1,UTC,12
 T,*65,
 L1,ATX,TLG*+13
 L1,VLM,OП 2
 ,XTA,
 L,*52,TEL/IS+1
C-----   ECTЬ ЛИ ПOЛYЧATEЛЬ
 ,XTA,TLG*+1
 ,AEX,ANY
 ,ASN,64+40
 ,UZA,OП 3.-> BCEM-BCEM
 ,XTA,TLG*+1
 ,APX,=6H'7''7'''''''''
 ,ASN,64+42
 ,ATI,N
 ,XTA,B48
 N,ASN,64+5
 ,AAX,STATMT
 ,UZA,NEXT/EV.-> HET KAHAЛA
 ,ASN,64-6
 ,UJ,OП 4
 OП 3:,XTA,STATMT
 ,APX,B42/19.= BCE KAHAЛЫ
 OП 4:,AOX,T/IS
 ,ATX,T/IS
 ,XTA,*OП
 ,ATX,TLG*
 ,UJ,CTPOЧHИK
C
C=====   COБЫTИE : "M T - З A K A З"
C
 MYЛЬTИ:,BSS,
 15,VTM,STACK.ИЗ-ЗA FETCH
 ,XTA,B48
 L,ASN,64+NCM1
 ,ATX,BCH
 ,AAX,S/BUS
 ,U1A,MYЛЬTИK.> ЗAHЯT CTPOЧHИK
 L,XTA,JOB+NCM1
 ,AOX,M*JOB
 ,AEX,M*JOB
 ,UZA,MYЛЬTИK.-> HET ЗAKAЗA
 L,XTA,JOB+NCM1
 ,AAX,B*COSY
 ,UZA,MY 1
 L,MTJ,JC
 JC,UTM,NCM1
 14,VTM,PБYФ
 ,ITA,14
 L,ATX,TEKAДP+NCM1
 13,VJM,FETCH
 B,BASE,BEGIN
 ,UJ,MYЛЬTИ
 MY 1:L,XTA,JOB+NCM1
 ,AAX,B*LIM
 :,U1A,*+1
 ,UTC,MIN2-SEC5
 :R,VTM,SEC5
 L,WTC,ASTR+NCM1
 C,VTM,LJOB-STRI
 L,XTA,JOB+NCM1
 ,ARX,B26/20
 ,APX,MSKP1
 ,AUX,MSKU1
 L,XTS,JOB+NCM1
 ,APX,MSKP2
 ,AUX,MSKU2
 15,AOX,
 ,AEX,SJOB0
 ,AEX,MAT/PH
 ,XTS,B48
 C,WTC,XNT
 ,ASN,64-1
 ,AAX,SC*CUP
 ,UZA,NO/CUP
  ,AEX,SC*CUP
  ,ATX,SC*CUP
 ,XTA,SC71
 ,AAX,BCH
 ,U1A,NO/CUP
 ,XTA,B*CUP
 15,AOX,-1
 15,ATX,-1
 NO/CUP:15,XTA,-1
 ,AAX,B*OTB
 ,U1A,REFU
 ,XTA,BCH
 ,AOX,S/BUS
 ,ATX,S/BUS
 ,UJ,TO DWN
 REFU:,XTA,
 L,ATX,JOB+NCM1
 TO DWN:,STX,
 ,WTC,MAT/PH
 C,UTM,
 ,*76,*DWN
 MYЛЬTИK:L,VLM,MYЛЬTИ
 ,UJ,NEXT/EV
C-----   ПOДПИXИBAHИE  STRINGER'A
 *DWN:14,REL,*
 C,ATX,LJOB
  C,WTC,XNT
  ,XTA,CIN
  ,AAX,723B.B29 = БЛOK.PEГEH.
  :,UZA,*+1
  R,VTM,MIN2.ДЛЯ CETИ
 ,ITA,R
 ,ASN,64-32
 C,AEX,XNT
 ,AAX,B40/33
 C,AEX,XNT
 C,ATX,XNT
 ,ATI,N.- ФИЗ.N KAHAЛA
 ,XTA,MSK0
 C,ATX,MSK
 B,BAS,BEGIN
 14,VJM,STRT*DWN
 ,MTJ,27B
 2,IJ,
C
C-----   YCTAHOBKA ШKAЛ MYЛЬTИTAЙПA
 TO SC:,XTA,BCH
 T,AOX,
 T,ATX,
 R,UJ,
C
C=====   KOHEЦ ГЛABHOГO ЦИKЛA ПO COБЫTИЯM
 NEXT/EV:,BSS,
 ,XTA,Ш/COБ
 ,U1A,M LOOP
C-----   BOЗBPAT ИЗ ДEШИФPATOPA
C.....   B O C C T A H O B Л E H И Я
 15,VTM,SI1+10
 14,VTM,11
 BOC 1:14,STI,
 14,UTM,-1
 14,V1M,BOC 1
 ,XTA,.BETBЛ.PAЗPEШEHO
 ,FUN,60B.BOЗBP. ИЗ BETBИ
 CLOSE*MT:,ENTRY,
C
C-----   CAMOЗAKPЫTИE ДO COБЫTИЯ
 CLOSE:,FUN,61B
C
C-----   HY OTKPЫЛИCЬ! HY И ЧTO?
 ,FUN,56B.БЛOK.BETBЛEH.
 14,VTM,-7
 ,XTA,
 :14,AOX,RE MT
 14,VLM,*
 ,U1A,MULTITYP
 ,FUN,57B.ДEБЛOK.BETBЛEH.
 ,UJ,CLOSE
C
C-----   K O H C T A H T Ы
 ANY:,ISO,6H@
 *OП:,ISO,6HTEЛ=>>
 J*TEL:12,Z05,
 1,Z20,TLG*
  IW/CONT:,OCT,0050 4010 160 00000
 M*JOB :,OCT,0000 1777 7777 7777
 B26/20:,OCT,0000 0003 7600 0000
 MSKP1 :,OCT,0131 0607 7607 7777
 MSKU1 :,OCT,2450 6000 377 77777
 MSKP2 :,OCT,0000 211
 MSKU2 :,OCT,0021 001
 SJOB0 :,OCT,4001
 B48/17:,OCT,7777 7777 776
 B48/25:,OCT,7777 7777
 B48/37:,OCT,7777
 B40/33:,OCT,0017 74
 B35/31:,OCT,0000 37
 C77777:,LOG,77777
 C1777:,LOG,1777
 C1440:,LOG,1440
 C377:,LOG,377
 C60:,LOG,60
 C37:,LOG,37
C
C-----   PAБOЧИE ЯЧEЙKИ
 WORK:,BSS,LWORK
 ,END,
 OPERTERM:,NAME,
C
C*****   OБCЛYЖИBAHИE OПEPATOPCKИX KOHCOЛEЙ
C*****   AПPEЛЬ 85              B.BEPETEHOB
C
 CONS*0:,EQU,2
 *127:B,BLOCK,BUF(128),BUFE
 BPEMЯ:,EQU,542B
C-----
 *TLSIZE:LC,BLOCK,(3),XNSS
 NSS:,WEQ,XNSS
  NSS1:,EQU,NSS-1
  WSD:,LC,1
  *TLSTAT:LC,BLOCK,(9),JLINE,JTIM
 *TLBUFI:LC,BLOCK,CIN
 *0:,BLOCK,LJOB,MSK,XNT,OWNER,WSC
  ,CONT,(1),STRI(14)
  ,CONT,TIME,STRO(15)
  ,CONT,BUF1(0) .ДЛЯ BTOPOГO
 *TLSYS:LC,BLOCK,STATOP
 INITOP:,EQU,STATOP+NSS
 TIMOP:,EQU,INITOP+NSS
  MAIN*C:,SUBP,
 *TLBUFOP:LC,BLOCK,BUSYSC,LWL,WL(9),NOP
 ,CONT,CONNOP,BUF0(20)
C-----
 RESET*TL:,SUBP,
 PUT PIR:,SUBP,
 STRT*DWN:,SUBP,
 STATIST:,SUBP,
 CONN*SS:,SUBP,
 TT TASK:,SUBP,
C-----
 *TLCONST:LC,BLOCK,(1),B48/41(16),B42/19(4)
 ,CONT,M*LJOB
 MASK12:LC,BLOCK,B48/37
 B24/1:,LC,1
 C77777:,LC,1
 C377:,LC,1
 C37:,LC,1
C-----
 *700:B,BLOCK,B48,B47,B46,B45,B44,B43
 ,CONT,B42,B41,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33,B32,B31
 ,CONT,B30,B29,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21,B20,B19
 ,CONT,B18,B17,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B9,B8,B7
 ,CONT,B6,B5,B4,B3,B2,B1
C-----
  B*INP:,EQU,B25
 B*TIM:,EQU,B33
 B*INT:,EQU,B33
 B*IN:,EQU,B36
 J*REF:,EQU,B41
 B*NL:,EQU,B47
C-----
 WORK:I,BLOCK,WS,WS1,STACK(2),SC
C-----   ИCПOЛЬЗYEMЫE CИMBOЛЫ ISO
 DL:,EQU,36B.= DELETE LINE
  ERASE:,EQU,37B
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 L:,EQU,3
 M:,EQU,8
 C:,EQU,9
 N:,EQU,10
 L1:,EQU,11
 R:,EQU,12
 F:,EQU,13
 T:,EQU,14
C
C========
C
 15,VTM,STACK
 ,XTA,STATOP
 ,APX,B42/19
 ,ATX,SC.= ПPИBЯЗAHЫ
C=====   ЦИKЛ ПO ПPИBЯЗAHHЫM KOHCOЛЯM
 M LOOP:,24,3
 ,XTA,SC
 ,UZA,CH/CONN
 ,ANX,
 ,ATI,N.N ФИЗ.KAHAЛA
 N,WTC,CIN
 C,VTM,.БYФEP KAHAЛA
 C,XTA,XNT
 ,ASN,64+15
 ,AAX,C37
 ,ATI,L.N ЛOГ.KAHAЛA
 L,UTM,-1
 N,XTA,B48-1
 ,AEX,SC
  :,24,2003B
 ,ATX,SC
 C,XTA,LJOB
 ,AAX,M*LJOB  .KAHAЛ
 ,ATX,WS
 ,UZA,CH BUSY.-> CBOБOДEH
  C,XTA,LJOB
  ,AEX,J*IN
  ,AAX,M*IN
  ,U1A,MLOOP
  CH BUSY:,BSS,
 ,XTA,TIMOP
 N,AAX,B24-1.   ПOЖEЛAHИE
 ,U1A,DIS CONN.-> HA OTBЯЗKY
 ,XTA,WS
 ,U1A,CH*OUT
 C,XTA,LJOB
 ,UZA,NEW/JOB
  C,WTC,WSC
  T,VTM,-DL
  :T,VZM,*+1
  T,UTM,DL-ERASE
 ,AAX,B*IN
 ,U1A,WAS/IN
C-----   ЗAKOHЧИЛCЯ BЫBOД
 C,XTA,LJOB
 ,AAX,B*INT
 ,UZA,NEW/JOB.-> HOPMAЛЬHO
C-----   ПPEPЫBAHИE BЫBOДA
  T,V1M,NEW/INP
C-----   OЧИCTKA OЧEPEДИ
  :R,VTM,*+1
  F,VTM,NEW/INP
  :,24,3
  ,UJ,GIV J
C-----   ЗAKOHЧИЛCЯ BBOД
 WAS/IN:C,XTA,LJOB
 ,AAX,B*TIM
  ,U1A,CH/OUT.-> ПO BPEMEHИ
 T,VZM,NEW/INP.-> OTMEHA CTPOKИ
C-----   ПOXOД  HA  "TTANAL"
  C,XTA,LJOB
  ,AEX,B*INP.ДЛЯ ПYCTOГO
  C,ATX,LJOB.BBOДA
 N,XTA,B48-1
 ,AOX,NOP
 ,ATX,NOP
 ,XTA,B43.= TTANAL
 14,VJM,PUT PIR.= PUT "TTANAL"
C-----   BЫБOP HOBOГO ЗAKAЗA B KAHAЛ
 NEW/JOB:,BSS,
  F,VTM,NEW/IN
 R,VJM,GIV J
  NEW/J:L1,VTM,1-14
C-----   COOБЩEHИE B CTPOЧHЫЙ БYФEP
 ,ATI,F
 F,UTM,-1
 C,UTC,STRO
 T,VTM,-1
 M,VTM,
 MOV 1:T,UTM,1
 F,UTM,1-BUFE
 :F,V1M,*+1
 F,VTM,BUF-BUFE
 :F,XTA,BUFE
 T,AEX,
 ,UZA,MOV 2
 M,VTM,1
 T,AEX,
 T,ATX,
 MOV 2:,24,3
 F,UTM,BUFE
 F,XTA,
 ,AAX,C377
 ,UZA,MOV 3
 L1,VLM,MOV 1
 MOV 3:M,VZM,PUT/OUT
C-----   ЗAПИCЬ B DAY-FILE
  ,XTA,7
  ,ASN,64-8
  ,AOX,WS
  ,AAX,B40
  ,U1A,PUT/OUT.-> БЛOKИPOBKA
  ,XTA,BPEMЯ
  C,ATX,TIME.ACTP.BPEMЯ
  L1,UTM,15
  ,ITA,L1
  ,ASN,64-44
  ,AOX,STAINF
  ,ITS,C
  ,ASN,64-24
  15,ARX,
  ,UJ,STATIST
  STA INF:,Z11,TIME
  ,Z00,*+1
C-----   ЗAПYCK BЫBOДA CTPOKИ
 PUT/OUT:,24,2003B
 ,UTC,J*OUT-J*IN
C-----   ИHИЦИAЦИЯ BBOДA CTPOKИ
  NEW/IN:,XTA,J*IN
  ,UJ,NEW/I
  NEW/INP:,XTA,J*IN
  ,AOX,B*INP
  NEW/I:,XTS,B48/41
  C,ATX,MSK
  ,ITA,C
  C,XTS,LJOB
  ,AEX,J*IN
  ,AAX,M*IN
  :,UZA,*+1
  ,XTA,B*NL
  :15,AOX,
  15,ARX,
  C,ATX,LJOB
  ,UJ,S*DWN
C-----   OCBOБOЖДEHИE KAHAЛA
 DIS CONN:,BSS,
 ,XTA,J*REF
  ,AOX,B*NL
  C,ATX,LJOB
  ,UJ,S*DWN
  CH/OUT:,BSS,
  R,VTM,NEW/J
  F,VJM,GIV J
C-----   ПPOДOЛЖEHИE BBOДA
  C,XTA,LJOB
  ,AOX,B*INP
  ,AEX,C*CONT
  C,ATX,LJOB
C-----   ЗAПYCKИ  "STRINGER"
  S*DWN:,BSS,
 14,VTM,M LOOP
 ,UJ,STRT*DWN
C-----   ПPOBEPKИ ЗAПPOCOB HA BЫBOД
  CH*OUT:,BSS,
  F,VTM,MLOOP
  R,VTM,NEW/J
C-----   BЫБOP ЗAKAЗA ДЛЯ BЫДAЧИ
 GIV J:,BSS,
 ,ITA,L
 ,ASN,64-40
 ,ATX,WS1
 ,XTA,STATOP
 ,AAX,B42/19
 ,ACX,
 ,ATI,M
 M,UTM,-1
  :,24,2003B
 T,VTM,-7
 GJ 1:T,XTA,WL+7
 ,UZA,GJ 2
 M,VZM,YES
 ,AEX,WS1
 ,AAX,B48/41
 ,UZA,YES
 GJ 2:T,VLM,GJ 1
  F,UJ,
 YES:T,XTA,WL+7
 ,ATX,WS
 GJ 3:T,XTA,WL+8
 T,ATX,WL+7
 :,UZA,*+1
 T,VLM,GJ 3
 :,XTA,LWL
 ,UZA,GJ 4
 ,ARX,C77777
 ,AAX,C77777
 GJ 4:,ATX,LWL
C-----   ПOДЗAПYCK БYФEPИЗAЦИИ TT
 ,XTA,B47
 ,AOX,BUSY SC
 ,ATX,BUSY SC
  ,XTA,WS
 R,UJ,
C
C-----   ЗAKAЗ HA ПPИBЯЗKY ГЛABHOЙ KOHCOЛИ
C
  CON/1:,BSS,
  ,ITA,13
  ,ATX,CONNOP
  13,XTA,B24-1
  ,AOX,INITOP
  ,ATX,INITOP
  ,UJ,CALL*OP
C
C=====   П P И B Я З K A
C
C-----   ПPOBEPKA HOBЫX "CTYЧAЩИXCЯ"
 CH/CONN:,24,2003B
 ,XTA,INITOP
  ,ASN,64-24
 ,UZA,TT TASK
 ,ANX,
 ,ATI,N
  N,XTS,B24-1
  ,AEX,INITOP
  ,STX,INITOP
  ,AEX,CONNOP
  L,VTM,0
  ,UZA,CONN/1
  ,XTA,INITOP
  ,AAX,B35
  ,U1A,CH/CONN.-> ЗAHЯT
  L,VTM,1
  ,UTC,BUF1
  CONN/1:C,VTM,BUF0
 L,XTA,B36
 ,AOX,INITOP
 ,ATX,INITOP
 ,XTA,
 C,ATX,LJOB
 C,ATX,OWNER
 ,ITA,N
 ,AOX,TIMER0
 ,ITS,L
 ,ARX,B1
 ,ASN,64-15
 15,AOX,
 C,ATX,XNT
  :,24,3
 N,MTJ,14.N ФИЗ.KAHAЛA
 12,VTM,0.N OПEP. П/C
 ,ITA,C
 13,VTM,CH/CONN
 ,UJ,CONN*SS
C
C*****   ПPИBЯЗKA/OTBЯЗKA ГЛABHOЙ KOHCOЛИ
C
 CONN*OP:,ENTRY,
  13,VTM,-NSS1
  15,VTM,WSD.PAБ.ЯЧ.
  L/TIM:13,XTA,STATOP+NSS1
  ,APX,B42/19
  15,ATX,
  13,AOX,TIMOP+NSS1
  13,STX,TIMOP+NSS1
  ,AOX,JLINE
  ,ATX,JLINE
  13,VLM,L/TIM
  ,XTA,
  ,ATX,JTIM
 ,XTA,CONS*0
 ,AAX,C37
 :,U1A,*+1
 ,XTA,MAIN*C
 :,ATI,13
 ,AEX,CONNOP
 ,AAX,C37
 ,UZA,CALL*OP.-> BCE CTAPOE
 13,XTA,CIN
 ,AAX,C77777
 ,U1A,CALL*OP.-> HOBЫЙ ЗAHЯT
  13,XTA,B48-1
  ,AAX,MAIN*C
  ,UZA,CALL*OP.-> ЗAПPEЩEH
 ,XTA,CONNOP
 ,AAX,C37
 ,UZA,CON/1.-> CTAPOГO HET
 ,ATI,14
 14,XTA,CIN
 ,AAX,C77777
 ,UZA,CON/1.-> CTAPЫЙ OTBЯЗ.
C-----   ЗAKAЗ OTBЯЗKИ CTAPOMY
 14,XTA,B24-1
 ,AOX,TIMOP
 ,ATX,TIMOP
C
C*****   BXOД : ЗAПYCK "OPERTERM"
C
 CALL*OP:,ENTRY,
 CALL*OP:,BSS,
 ,XTA,B44
 14,VTM,RESET*TL
 ,UJ,PUTPIR
C
 TIMER0:,GOST,6H0'173'0000
  M*IN:,OCT,00014001 777 00000
  J*IN:,OCT,44514000 260 00006
  J*OUT:,OCT,40500000 260 00025
  C*CONT:,OCT,40501401
 WORK:,BSS,5
 ,END,
 WHO/USER:,NAME,
C
C*****  CПPABKA O TEPMИHAЛЬHЫX ПOЛЬЗOBATEЛЯX
C
 TERM*LOC:,SUBP,
 ALLTOISO:,SUBP,
 *TLSIZE:LC,BLOCK,(1),XNPC(2),XNSS
 NPC0:,WEQ,XNPC
 NSS:,WEQ,XNSS
 NPC:,EQU,NPC0-1
 NPC1:,EQU,NPC-1
 NSS1:,EQU,NSS-1
 *TLSYS:LC,BLOCK,
 *TLBUFI:LC,BLOCK,FCIN
  DISPBASE:LC,BLOCK,(6),NEVM
 *700:B,BLOCK,(5),PB43
 *1000:B,BLOCK,STACK(64),MESS(5),FI(10)
 ,CONT,IW,CIN,GOST,N*OP,BIT
 FIO:,EQU,2000B
 NPF:,P/P,(FIO)16
 *1:,BLOCK,B,AP,R,T,L,D
C*****
 B,BASE,*
  ,*65,NEVM
  ,ARX,
  :,U1A,*+1
  ,UTC,NPC.ДЛЯ ЭBM-2
  :D,VTM,
 15,VTM,STACK
 L,VTM,-NSS1.KOЛ-BO П/C
 ,FUN,70100B+114B
 ,AAX,=1
 ,ASN,64-40
 ,ATX,N*OP.HOMEP KOHCOЛИ
C-----   ЧTEHИE TAБЛИЦЫ  Ф И O
 ,*65,564B
 ,ATI,13
 13,*65,2
  D,J+M,D
 ,ARX,IW0
 ,ATX,IW
 ,TAPE,IW
 ,XTA,=0100 00000001
 ,ARX,IW
 ,ATX,IW
 ,TAPE,IW
C
C=====   CПPABKA ПO ПOДCИCTEMAM
C
 AP,VTM,NA*SS-2
 T,VTM,MESS
 REF0:AP,UTM,2
 L,*65,*TLSYS+NSS1
 ,AAX,B42/19
 ,UZA,REF0E
 ,ACX,
 AP,XTS,
 T,ATX,
 AP,XTA,1
 T,STX,1
 ,ASN,64-32
 ,AOX,=6H 0 ПOЛ
 T,ATX,2
  ,XTA,=6HЬЗ.;
 T,ATX,3
  T,UTM,4
 REF0E:L,VLM,REF0
 L,VTM,-NPC1
  T,XTA,-1
  ,ASN,64+24
  ,ASN,64-24
  T,ATX,-1
  T,VTM,MESS
  R,VJM,OUT
C
C=====   ГЛABHЫЙ ЦИKЛ ПO KAHAЛAM
C
 M/LOOP:,BSS,
  T,VTM,MESS
 L,*65,FCIN+NPC
 ,ATX,CIN
C-----   ИMЯ ПOДCИCTEMЫ
 L,*65,PB43+NPC
 ,ATX,BIT
 R,VTM,-NSS1
 SE*SS:R,*65,*TLSYS+NSS1
 ,AAX,BIT
 ,U1A,WRS
 R,VLM,SE*SS
  ,UJ,E/LOOP
C-----   HOMEP ФИЗ.KAHAЛA
 WRS:L,UTC,NPC1
 13,VTM,1
 ,ITA,13
 ,ASN,64-42
 ,AUX,=6H'''''''7''7'''
 R,UTC,NSS1
 ,AOX,NA*SS/2
 T,ATX,
C-----   TИП TEPMИHAЛA/KAHAЛA
 ,XTA,CIN
 ,ASN,64+21
 ,AAX,=27
 ,ATI,14
 14,UTM,TYP*T
 ,ASN,64+3
 :,UZA,*+1
 14,UTM,-17B.TS-1 /=1/
 :14,XTA,
 T,ATX,1
 ,XTA,=6H : '1''1''1'
 T,ATX,2
C-----   ЛOKAЛИЗAЦИЯ TEPMИHAЛA
 L,UTC,NPC1
 L,UTC,NPC1
 13,VTM,TERM*LOC
  D,J+M,13.YЧET N ЭBM
 13,XTA,
 T,ATX,3
 13,XTA,1
 T,ATX,4
C-----   Ф И O  ПOЛЬЗOBATEЛЯ
 ,XTA,
 ,ATX,FI
 ,ATX,FI+1
 ,ATX,FI+2
  R,UTM,NSS1
  R,VZM,S/OUT.OP
  ,XTA,CIN
  ,ATI,13
  13,VZM,S/OUT
  13,*65,3
  ,AAX,=1777
  ,UZA,S/OUT
 ,ASN,64-1
 ,ATI,13
 13,XTA,FIO-2
 ,ATX,FI
 13,XTA,FIO-1
 ,ATX,FI+1
 13,VTM,-1
 L1:12,VTM,-5
 13,XTA,FI+1
 L2:,ASN,64-8
 15,ATX,
 ,YTA,
 ,ATX,GOST
 11,VTM,-177B
 L3:11,*65,ALLTOISO+177B
 ,ASN,64+32
 ,AEX,GOST
 ,AAX,=177
 ,UZA,SYM/IS
 11,VLM,L3
 11,VTM,43B-177B
 SYM/IS:11,UTM,177B
 ,ITA,11
 :11,V1M,*+1
 ,XTA,=40
 :15,AOX,
 12,VLM,L2
 13,ATX,FI+1
 13,VLM,L1
C-----   И, HAKOHEЦ, BЫДAЧA OПEPATOPY
 S/OUT:R,VJM,OUT
  E/LOOP:,BSS,
 L,VLM,M/LOOP
 ,*62,
 OUT:,BSS,
 ,ITA,T
 ,AOX,N*OP
 ,AOX,=:001
 ,FUN,76B
 R,UJ,
 IW0:,010,NPF
 ,,1
 B42/19:,OCT,00777777 77
 NA*SS:,BSS,
  ,ISO,12HOПEPATOP -'1''1'
 ,ISO,12HMYЛЬTИTAЙП -
  ,ISO,12HSCREEN -'1''1''1''1'
 ,ISO,12HMOHИTOP    -
 NA*SS/2:,BSS,
 ,ISO,6HOP.00=
 ,ISO,6HMT.00=
 ,ISO,6HЭP.00=
 ,ISO,6HSS.00=
 ,ISO,6H   00=
 TYP*T:,BSS,
 ,ISO,6HVT-340
 ,ISO,6H TS-1
 ,ISO,6HKOHCYЛ
 ,ISO,6H#52130
 ,ISO,6H15-ИЭ
 ,END,
 TERM*LOC:,NAME,
C
C*****   OПИCAHИE ЛOKAЛИЗAЦИИ TEPMИHAЛOB
C        ( ":" - 300 ГЦ.,  ";" - 150 )
C
  01,ISO,12HMAШ.ЗAЛ    :
  02,ISO,12HMAШ.ЗAЛ    :
  ,ISO,12H CETEBOЙ-0 :
  ,ISO,12H CETEBOЙ-1 :
  ,ISO,12H CETEBOЙ-2 :
  ,ISO,12H CETEBOЙ-3 :
  ,ISO,12H CETEBOЙ-4 :
  ,ISO,12H CETEBOЙ-5 :
  ,ISO,12H CETEBOЙ-6 :
  ,ISO,12H CETEBOЙ-7 :
  ,ISO,12H CETEBOЙ-8 :
  ,ISO,12H CETEBOЙ-9 :
  ,BSS,2.CBOБOДHЫЙ
  ,BSS,2.CBOБOДHЫЙ
  10,ISO,12HMEЖДYHOГYC :
   9,ISO,12HMOCЭHEPГO  :
   8,ISO,12H/KOMH-229/ :
   7,ISO,12HЗAЛ БЭCM-6 :
  ,ISO,12H   KAДPЫ   ;
   5,ISO,12HA T C  OИЯИ;
   4,ISO,12HЗAЛ БЭCM-6 ;
   3,ISO,12HY ПPИXOДЬKO;
   2,ISO,12HЗAЛ BB/BЫB ;
   1,ISO,12HCИTHИK(ЛBЭ);
C
C....  ECЛИ HAДO, CДEЛAЙTE ЗДECЬ
C      TAKOЙ ЖE CПИCOK ДЛЯ ЭBM-2
C      И HE ЗAБYДЬTE ПPO WHO/USER !
C
 ,END,
 TTTASK:,NAME,.15.01.86
C
C*****   ЗAДAЧA БYФEPИЗAЦИИ BЫBOДA
C      OПEPATOPCKИX KOHCOЛEЙ (ДHЗ 13)
C
C-----   ШKAЛA PAБOT (BUSYSC) :
C   P.48 - P E З E P B
C   P.47 - БYФEPИЗAЦИЯ KOHCOЛEЙ
C   P.46 - "OPERTERM"
C-----
 *127:B,BLOCK,BUF(128),BUFE(0)
 *TLBUFOP:LC,BLOCK,BUSYSC,LWL,WL(9)
 *327:B,BLOCK,(1),IFTT
C-----
 SELECT:,SUBP,.
 CLTASK:,SUBP,.
 PUTPIR:,SUBP,
 OPERTERM:,SUBP,
C-----
 *TLCONST:LC,BLOCK,(3),B47/40(6)
 ,CONT,C200*,C177*
 FULWOR:,LC,1
 C77777:,LC,1
 DISREG:,LC,1.
 C7:,LC,1
 *700:B,BLOCK,B48,B47,B46,B45(44),B1
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 F:,EQU,11
 T:,EQU,12
 R:,EQU,13
 W:,EQU,14
C=====
C
 BEGIN:,XTA,BUSYSC
 ,UZA,KOHEЦ.
 ,ANX,C77777
 ,ATI,W
 ,XTA,BUSY SC
 W,AEX,B48
 ,ATX,BUSY SC.
 W,UJ,SWITCH.
 SWITCH:,BSS,.
 :,33,-2.PEЗEPB
 BUFF:R,VTM,WL*-1.БYФEPИЗAЦИЯ
 ,UJ,M LOOP
 :,,.= OPERTERM
 ,UJ,OPERTERM
 M LOOP:,BSS,.
 R,UTM,1
 R,XTA,
 ,UZA,BEGIN.-> BCE ЗAKAЗЫ
 ,ARX,
 ,UZA,EXEC.-> HA ИCПOЛHEHИE
C-----   БYФEPИЗAЦИЯ ЗAKAЗA
 ,ATI,F.
 ,AAX,B47/40
 ,AOX,A/BUF
 ,AOX,B48
 R,ATX,
   :   ,24,3.
  ,ATI,T
 MOVE:,BSS,
 ,ITA,T.
 ,AEX,E/BUF
 ,U1A,WORD
 T,VTM,BUF
 WORD:F,XTA,
 T,ATX,.
 F,UTM,1.
 T,UTM,1.
C-----   ПPOBEPKA KOHЦA ЗAKAЗA
 ,AAX,C177*
 ,ARX,C177*
 ,AAX,C200*
 ,AEX,C200*
 ,UZA,MOVE
C-----   OБHYЛEHИE XBOCTA CЛOBA
 ,ANX,C77777
 ,ATI,W
 ,XTA,FULWOR
 W,ASN,64
 ,AEX,FULWOR
 T,AAX,-1
 T,ATX,-1
   :   ,24,2003B
 ,ITA,T
 ,ATX,A/BUF
 R,XTA,
C-----   ЗAKAЗ HA ИCПOЛHEHИE
 EXEC:,WTC,LWL
 W,VTM,-7. ИCП.OЧEPEДЬ
 W,VZM,M LOOP.-> ПOЛHA
 ,AEX,B48
 W,ATX,WL+7
 W,UTM,8
 ,ITA,W
 ,ATX,LWL
 ИCKЛ:R,XTA,1
 R,ATX,
 ,UZA,ИЗM CЧ.
 R,VLM,ИCKЛ
 ИЗMCЧ:R,UTM,-WL*
  ,ITA,R
 ,ATX,LWL*
 ,XTA,B46. PAБOTA =
 ,AOX,BUSYSC.OPERTERM
 ,ATX,BUSYSC
 ,UJ,BUFF
C
C-----   ЗAKAЗЫ ЗAДAЧИ ИCЧEPПAHЫ
 KOHEЦ:,XTA,ADR
 ,ATX,IFTT+3.AДPEC BXOДA
 ,XTA,DIS REG.
 ,ATX,IFTT+5.PEЖИM BXOДA
 13,VTM,SELECT.
 ,UJ,CL TASK.
 ADR:,,
 ,Z00,BEGIN
 LWL*:,LOG,
 TEL OUT:,ENTRY,.
 TT PRINT:,ENTRY,.
 ,AAX,C77777
 :,AAX,CHM
 ,UJ,OKEY
 TTPRINT1:,ENTRY,
 OKEY:,BSS,
   :   ,24,2003B
 ,WTC,LWL*
 ,ATX,WL*
 ,XTA,B47
 ,AOX,BUSYSC
 ,ATX,BUSYSC
 ,XTA,LWL*
 ,ARX,B1
 ,AAX,C7.
 ,UZA,PUT
 ,ATX,LWL*
C-----   ЗAПYCK TTTASK OT TTPRINT
 PUT:,XTA,B45
 ,UJ,PUTPIR
 A/BUF:,,
 ,Z00,BUF
 E/BUF:,,
 ,Z00,BUFE
 CHM:,OCT,0170 0000 0007 7777
 WL*:,BSS,9
 ,END,.
 PR/TIMER:,NAME,.
C
C*****   БYДИЛЬHИKИ , ПPOBEPKИ ГOTOBHOCTEЙ
C             PAБOTAET  OT  "ITIMEB10"
C
 REACT:,EQU,763B
C
 *ИПД:LC,BLOCK,XNF(9),Ш/FULL(27),PRTFLAG
 *ИПK1:LC,BLOCK,PRTSTAT
  NMAT1:,WEQ,XNF
 *YCЫ:LC,BLOCK,(1),RDSCAL
 ДHЗ:,LC,1
 MSTART:,LC,1
 NSTAJOB:,LC,1
 ABTIME:LC,BLOCK,(1),NINT
 *SWCMN:LC,BLOCK,(5),LOWJOB(2),NOLOW
 SCALES:LC,BLOCK,(3),STCLTA(4),SCWPERF
 NDIV:LC,BLOCK,(1),BR/PERF
 CONTIME:LC,BLOCK,(4),BEGUNIT(8),TMTEC(2)
 KOHK:,LC,1
 БAЗAПPИЗ:LC,BLOCK,(7),ЗBЗAHЯTA(12),BYHEPAБ
 ,CONT,(6)
 NRP:,P/P,(NRES71)1024
 ANRP:,P*P,(NRP)1024
 RNR71:,EQU,NRES71-ANRP
 TPCHEK:,SUBP,
 DESCR:,EQU,NRTABL+NRP
C
  TYP/PL:,SUBP,
 RETURN:,SUBP,.
 NEWTA:,SUBP,.
 STARTJOB:,SUBP,
 COБЫTИE :,SUBP,
 ЗAПYCK  :,SUBP,
 ПEPФOPAЦ:,SUBP,.
 NRTABL:,SUBP,.
 NRES71:,SUBP,.
  MPX*TIM:,SUBP,
  ПPOB BY:,SUBP,
  ПPOB MЛ :,SUBP,
  ПPOB MБ:,SUBP,
C
 FULWOR:,LC,1
 C77:,LC,1
 C37:,LC,1
 C7:,LC,1
 B30/16:LC,BLOCK,MSHIFR
  *CB:LC,BLOCK,(13),I0
  B16/1:,LC,1
C
  *542:B,BLOCK,ASTIME,MASTIME
 *677:B,BLOCK,BITS(28),B21(17),B4(3),C1
 BITOVP:,EQU,B21
C
C========
C
 ,XTA,NINT
 ,AAX,C7
 ,ATI,14
 14,UJ,SW*PHASE
 SW*PHASE:,BSS,
 :,XTA,ДHЗ
 ,UJ,PHA*0
  :13,VTM,PHA*1
  ,UJ,ПPOB MБ
 :,XTA,REACT
 ,UJ,PHA*2
 :14,VTM,-1
 ,UJ,PHA*3
 :14,VTM,BEGUNIT-TMTEC
 ,UJ,PHA*4
 :,XTA,NINT
 ,UJ,PHA*5
  :13,VTM,PHA*6
  ,UJ,ПPOB BY
  :,XTA,MASTIME
  ,UZA,PHA*7
C-----   KOPPEKTИPOBKA BPEMEHИ
  ,EXT,4175B
  ,AAX,B16/1
  ,ASN,64-24
  ,ATX,ASTIME
  ,EXT,4176B
  ,AOX,ASTIME
  ,AOX,I0
  ,A*X,=R1.0E-6
  ,ATX,ASTIME
  ,UJ,PHA*7
C
C=====   0-Я ФAЗA ПPEPЫBAHИЙ
 PHA*0:,BSS,
 ,ATI,13.
  ,XTA,Ш/FULL
  13,AAX,BITS
 ,UZA,DISP
 13,XTA,PRTSTAT-NMAT1.
 ,AAX,C77
 ,ASN,64-6
 13,ARX,PRTSTAT-NMAT1
 13,ATX,PRTSTAT-NMAT1
 ,AAX,BITOVP
 ,U1A,OVERFLOW
 13,XTA,PRTSTAT-NMAT1
 ,AAX,=3 000000
 ,AEX,=3 000000
  ,U1A,DISP
  ,XTA,ДHЗ
  ,AEX,NOLOW
  ,UZA,DISP
  ,XTA,
  ,ATX,NOLOW
 DISP:,BSS,.
C.....    ПPOBEPKA ЗAKAЗA HA ЗAПYCK ЗAДAЧИ
 ,XTA,MSTART.
 ,UZA,RETURN
  ,ATX,NSTAJOB
 ,XTA,.
 ,ATX,MSTART.
 ,UJ,STARTJOB.
 OVERFLOW:,BSS,
 ,ATX,PRTFLAG
 ,XTA,ДHЗ
 ,AEX,LOWJOB
 ,U1A,TO*NEWTA
 ,XTA,ДHЗ
 ,ATX,NOLOW
 ,UJ,TO*NEWTA
C
C=====   1-Я ФAЗA ПPEPЫBAHИЙ
 PHA*1:,BSS,
 13,VTM,RETURN
 ,UJ,ПPOB MЛ
C
C=====   2-Я ФAЗA ПPEPЫBAHИЙ
C
 PHA*2:,BSS,
 ,ATI,14
  ,UJ,MPX*TIM.OTTYДA ПO И14
C
C=====   3-Я ФAЗA ПPEPЫBAHИЙ
 PHA*3:14,XTA,BR/PERF
 ,UZA,EL1
 ,EXT,4031B.- AЦПY
 14,V1M,CHR.-> ДA
 :,EXT,4102B.ПИ/ПЛ
 ,AEX,FULWOR
  CHR:14,AAX,BR/PERF.ГOTOBO
  14,AEX,BR/PERF
 ,UZA,EL1.HИKTO HE ГOTOB
 ,XTA,RDSCAL.OTKPЫTИE
 14,AOX,SCWPERF.ЖДYЩИX
 ,ATX,RDSCAL.ЗAДAЧ
 ,XTA,
 14,ATX,SCWPERF
 14,ATX,BR/PERF
 ,UJ,TO*NEWTA
 EL1:14,VLM,PHA*3
 ,UJ,RETURN
C
C=====   4-Я ФAЗA ПPEPЫBAHИЙ
 PHA*4:14,XTA,TMTEC
 ,ATI,13
 13,U1A,
 TIME10:,ENTRY,
 14,VLM,PHA*4
 ,UJ,RETURN
C
C=====   5-Я ФAЗA ПPEPЫBAHИЙ
  PHA*5:,BSS,
  6,IFNE,FREQ,150
  5,IFNE,FREQ,600
  ,AAX,B4
  ,UZA,HE COБ
  ,XTA,NINT
  ,ASN,64+4
  1,ELSE,
  ,ASN,64+3
 ,AAX,C37
 ,ATI,13
 13,XTA,*YCЫ+16
 ,AAX,MSHIFR
 ,U1A,HA COБ
  ,CALL,CHKTIMER
 HE COБ:,BSS,
 ,XTA,7
 ,AEX,KOПИЯTP7
 ,UZA,RETURN
 ,XTA,7
 ,ATX,KOПИЯTP7
 ,XTA,RDSCAL
 ,AOX,STCLTA
 ,ATX,RDSCAL
 ,XTA,
 ,ATX,STCLTA
 TO*NEWTA:,BSS,
 ,XTA,RDSCAL
 ,ASN,64+25
 ,U1A,RETURN
 ,UJ,NEWTA
 HA COБ:,BSS,
 13,XTA,*YCЫ+16
 ,AEX,
 ,XTA,INF
 ,UJ,COБЫTИE
 INF:4,,
 ,Z00,HE COБ
C
C=====   6-Я ФAЗA ПPEPЫBAHИЙ
 PHA*6:,BSS,
  ,XTA,TYP/PL+1.ABT.ЗAПYCK
  ,AAX,C1
  ,UZA,RETURN.TOЛЬKO ПPИKAЗ
 ,XTA,ЗBЗAHЯTA
 ,UZA,RETURN.HET ЗAД.BB.
 ,XTA,BYHEPAБ
 ,UZA,RETURN.BY PAБOTAET
 ,XTA,KOHK
 ,U1A,RETURN.ПPOГP.CБOЙ YBBK
 ,EXT,4102B.ГOTOBHOCTЬ
 ,AAX,=42000000
 ,AEX,=42000000
 ,U1A,ЗAПYCK
 ,UJ,RETURN
C
C=====   7-Я ФAЗA ПPEPЫBAHИЙ
 PHA*7:,BSS,
 ,XTA,DESCR
 ,AAX,C37
 ,UZA,RETURN
 ,ASN,64-10
 ,ATI,13
 ,XTA,RNR71
 ,ASN,64+15
 ,UZA,RETURN
 13,UTM,ПEPФOPAЦ-ANRP
 13,UJ,TPCHEK-ПEPФOPAЦ
C
 KOПИЯTP7:,BSS,1
 ,END,
 ITIMEB10:,NAME,
C
C*****  ПPEPЫBAHИЯ ПO ГPП-10 ( FREQ>500 )
C           ИЛИ    ПO ГPП-40 ( FREQ<500 )
C
 *542:B,BLOCK,ASTIME,MASTIME
C
 *YCЫ:LC,BLOCK,ГYC
 BISTIME:,EQU,110B
 ABTIME:LC,BLOCK,(1),NINT
  *ЧACTOTA:1,IFEQ,FREQ,150
  SOT:,EQU,=R6.6666666666E-3
  *ЧACTOTA:1,IFEQ,FREQ,300
  SOT:,EQU,=R3.3333333333E-3
  *ЧACTOTA:1,IFEQ,FREQ,600
  SOT:,EQU,=R6.6666666666E-3
  *ЧACTOTA:1,IFEQ,FREQ,1200
 SOT:,EQU,=R3.3333333333E-3
 REWINDSC:LC,BLOCK,(7),ДOЛБEЖ,PEЖPAЗ
 ,CONT,TIME*ENT
 PR/TIMER:,SUBP,
 TIM*TERM:,SUBP,
 B30/16:LC,BLOCK,MSHIFR
 C3:,LC,1
 *701:B,BLOCK,BIT47,BIT46(44)
 ,CONT,BIT2,BIT1
C
C*****      KOPPEKTИPOBKA BPEMEH
C*****   PAЗMETKA , TEPM-ЗAПYCKИ , ...
 ,NTR,2
C-----   BPEMEHA HA ЗAДAЧY
 ,XTA,ГYC
 ,ATI,14
 ,AAX,MSHIFR
 ,UZA,NO MATH
 14,XTA,BISTIME
 ,A+X,SOT
 14,ATX,BISTIME.KOMMEP.BPEMЯ
 NO MATH:,BSS,
 14,XTA,-1
 ,A+X,SOT
 14,ATX,-1.CЧET.BPEMЯ
C-----   ДИCПETЧEPCKИE BPEMEHA
 ,XTA,ABTIME
 ,A+X,SOT
 ,ATX,ABTIME
 ,XTA,ASTIME
  ,A+X,SOT
 TO AST:,ATX,ASTIME.ACTP.BPEMЯ
 ,XTA,NINT
  ,ARX,BIT1
  ,ATX,NINT
  3,IFNE,FREQ,150
  2,IFNE,FREQ,600
 ,AAX,BIT1
  ,U1A,SWOR
C-----   ПOPAБOTAEM ДЛЯ PAЗMETKИ
 ,WTC,PEЖPAЗ
 ,UJ,SWOR
C---
 ПPOДOЛБ:,A-X,=R6.6666666667E-3
 ,ATX,ДOЛБEЖ
 ,UZA,SWOR
 ,XTA,BIT2
C---
 HAЧДOЛБ:,EXT,141B
 ,XTA,BIT1
 ЗAДEPЖ:,ARX,PEЖPAЗ
 ,ATX,PEЖPAЗ
C---
 SWOR:14,VTM,PR/TIMER
 ,UJ,TIM*TERM
 :,XTA,BIT47
 ,UJ,ЗAДEPЖ.MЛ
 :,XTA,C3.HAЧAЛO
 ,UJ,HAЧДOЛБ.PAЗMETKИ
 :,XTA,ДOЛБEЖ
 ,UJ,ПPOДOЛБ.BЫДEPЖKA
 :,XTA,BIT46
 ,UJ,ЗAДEPЖ.60 MCEK
 :,XTA,
 ,ATX,PEЖPAЗ
 15,VTM,SWOR.BOЗBPAT OT ДЯДИ
 ,WTC,TIME*ENT.BXOД ПO
 13,VTM,.БYДИЛЬHИKY
 13,UJ,.ПOXOД
 ,END,
 PROGINT:,NAME,
C
C*****         O Б P A Б O T K A
C*****   ПPOГPAMMHO-ИMMИTИPYEMЫX ПPEPЫBAHИЙ
C
C     PP.48 - KOMAHДA OTЛAДЧИKA "ШAГ"
C        47 - ЗAПYCK "CIO*TL"
C        46 - PEЗEPB
C        45 - ЗAПYCK ЗAДAЧИ "TTTASK"
C        44 - ЗAПYCK "OPERTERM"
C        43 - ЗAПYCK "TTANAL"
C
 *YCЫ:LC,BLOCK,(1),RDSCAL(3),PPIR,MPPIR
 *TLBUFOP:LC,BLOCK,BUSYSC
C
 OCT67:,SUBP,
 CIO*TL:,SUBP,
 RETURN:,SUBP,
 NEWTA:,SUBP,
 TTENTRY:,SUBP,
  SW INT:,SUBP,
  PRT MASK:,EQU,SW INT-1
C
 C77777:,LC,1
 *700:B,BLOCK,B48(2)
 ,CONT,B46(8),B38(32),B6
 B*OPT:,EQU,B46
 B*TTT:,EQU,B38
C
C========
C
 ,XTA,PPIR
 ,AAX,MPPIR
 ,UZA,RETURN.= HET ПPEPЫB.
 ,ANX,C77777
 ,ATI,14
 14,XTA,B48
 ,AEX,PPIR
 ,ATX,PPIR
 ,AAX,MPPIR
 14,UZA,SWITCH
C
C-----   ECTЬ EЩE ГOTOBЫE ПPEPЫBAHИЯ
C-----       = ПOДЗAПYCTИMCЯ =
C
 ,XTA,B6
 ,EXT,31B
 14,UJ,SWITCH
C
C-----   ПEPEKЛЮЧATEЛЬ ПPИЧИH ПPEPЫBAHИЙ
C
 SWITCH:,BSS,
  :,ГMAC,XTA
  ,UJ,ШAГ
 :13,VTM,-2.= ЧИCЛO PAБOT
 ,UJ,CIO*TL
  :,33,46
  ,UJ,*
 :,UJ,ACTIV.= TTTASK
 :,XTA,B*OPT.= OPERTERM
 ,UJ,OPERT
 :,UJ,TTENTRY.= TTANAL
C-----
 OPERT:,AOX,BUSYSC
 ,ATX,BUSYSC
C-----
 ACTIV:,XTA,B*TTT
 ,AOX,RDSCAL
 ,ATX,RDSCAL
 ,UJ,NEWTA
C-----
  ШAГ:,ATX,PRT MASK.BOCCTAH.
  ,UJ,OCT67.OБЫЧHOЙ MACKИ
 ,END,
 TERMINAL:,NAME,.25,07.78
C
C*****   HEPEЗИДEHT PAБOTЫ C TEPMИHAЛAMИ
C                (ЭK-71)
C
C=====   C T P Y K T Y P Ы :
C
C...  ИHФ.CЛOBO HA BXOДE :
C
C   B48/45 - ИP(AИCП) HAЧAЛA
C   B43 = 1 - ПPИЗHAK COSY
C   B42 = 1 - PAБOTA C TEPMИHAЛAMИ
C   B41/40 - TИП PAБOTЫ
C          = 0 - BЫBOД
C          = 1 - BBOД C ПOДCKAЗKOЙ
C          = 2 - 'ЧИCTЫЙ' BBOД
C          = 3 - C П E Ц . Ф Y H K Ц И И
C   B39/25 - AДPEC HAЧAЛA
C   B24 = 1 - COSY = GOST
C   B23/22 - TИП BBOДA И ПOДCKAЗKИ:
C          0 - OБЫЧHЫЙ BBOД (ПPИ 'ЧИCTOM'
C              BBOДE CTAHД.ПOДCKAЗKA = "?")
C          1 - ГPYППOBOЙ ПPOЗPAЧHЫЙ BBOД
C              720 БAЙT, ПOДCK. = "HOME"
C          2 - BBOД 1440 БAЙT, "HOME"
C          3 - BBOД 1440 БAЙT, ПOДCK.= ">"
C   B19/16 - N KAHAЛA ЭK71
C   B15 = 1 - BЫBOД HEOБЯЗAT.
C
C...  TИП CПEЦ.ФYHKЦИИ OПPEДEЛЯETCЯ :
C       AИCП , PP.24,23,21,18
C     XXXXX X X 1 0 : ЗAПPOC TEPMИHAЛA
C     XXXXX X X 1 1 : ЗAПPOC OTЛAДKИ
C     77777 X X 0 X : BXOД ИЗ ЭK74
C     XXXXX 0 X 0 X : OПPOC KAHAЛA
C     XXXXX 1 1 0 X : ЗAMOPOЗKA MT-KAHAЛA
C     XXXXX 1 0 0 X : PAЗMOPOЗKA
C
C...  ПPИ OПPOCE KAHAЛA BЫДAEM :
C
C   0 - HET MYЛЬTИTAЙПA / KAHAЛA
C       ИHAЧE
C   PP.48/43 - HOMEP ФИЗ.KAHAЛA
C   PP.02/02 - ECTЬ ПEPEБИBKA
C   PP.01/01 - ECTЬ TEPMИHAЛ
C
C...  CЛOBO OЧEPEДИ (WL1)
C
C   B48/43 - Д H З
C   B42    - ПPИЗHAK COSY-BЫBOДA
C   B41/40 - TИП PAБOTЫ
C   B39/25 - ИCП.AДPEC HAЧAЛA
C   B24    - COSY = GOST
C   B23/22 - TИП BBOДA И ПOДCKAЗKИ
C   B21    - ПPИЗHAK : 'ЗAKAЗ BЫДAH'
C   B20    - ПPИЗHAK : OБMEH C ЗAKPЫTИEM
C   B19/16 - N KAHAЛA ЭK71
C   B15    - ПPИЗHAK : HEOБЯЗ. BЫBOД
C   B10/01 - N ПOЛЬЗOBATEЛЯ (ПO TPAS)
C
C=====
C
C-----   ПAPAMETPЫ KOЛ-BA MT-KAHAЛOB
 NCH:,EQU,10
 NC1:,EQU,NCH-1
 NC2:,EQU,NCH-2
 NC3:,EQU,NCH-3
 NC*2:,P*P,(NCH) 2
 NC*3:,P*P,(NCH) 3
C
C-----   OБЩИE ДИCПETЧEPCKИE COMMON
 *ИПД:LC,BLOCK,(1),XNFM(5),XNCM
 NFM:,WEQ,XNFM
 NCM:,WEQ,XNCM
  MOЖHOKAЧ:,EQU,*ИПД+67B
 *ИПK:,LC,
 INFEX:,EQU,*ИПK+NCM
 SCALES:LC,BLOCK,(10),SC/CLJ
 SMASAV:LC,BLOCK,SAVAC(3),SAVI15(2),SAVI13
 *YCЫ:LC,BLOCK,ГYC
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
 WSD:LC,BLOCK,WSD1
C
C-----   TEPMИHAЛЬHЫE COMMON
 *TLSYS:LC,BLOCK,(1),STATMT
 *TLBUFI:LC,BLOCK,CIN
 *0:,BLOCK,LJOB(2),XNT,OWNER(2)
 ,CONT,(1),STRI
 *TLSTAT:LC,BLOCK,(11),SPEC*CH
 *TLCONST:LC,BLOCK,(12),Z*CIN
 *SCAL71:LC,BLOCK,SC71,REDY71,SCTER
 ,CONT,SCAL67,SCШAГ,SCB71
  ,CONT,REDY/2
 LWL:,EQU,8
 LWL1:,EQU,LWL-1
 *TASK71:LC,BLOCK,WL1(LWL)
 ,CONT,CHAN/J(NC2)
C
C-----   ИCПOЛЬЗYEMЫE B ИПЗ ЯЧEЙKИ
 *100:B,BLOCK,REGSCAL
 *103:B,BLOCK,BUFS27,M74
 *600:B,BLOCK,IW71,(1),N*TSK,TSK
 ,CONT,(1),BCH,ZBCH
 ,CONT,SAV32(5),SAVI9
 DELT:,EQU,M74-SAV32
C
C-----   ПOДПPOГPAMMЫ ДИCПETЧEPA
 TTPRINT:,SUBP,
 COБЫTИE:,SUBP,
  OUTMACRO:,SUBP,
 CLANEWTA:,SUBP,
 ERRMACRO:,SUBP,
 NRESOFF :,SUBP,
 NRTERM  :,SUBP,
 MACRO71*:,SUBP,
C
C-----   0-Й ЛИCT MYЛЬTИTAЙПA
 NPAБЛИCT:LC,BLOCK,PAБЛ
 *67:B,BLOCK,S/BUS
 *640:B,BLOCK,SC ЖДY
 *670:B,BLOCK,JOB(NC*2)
 ,CONT,NUMBUS(NC*3)
 ,CONT,ASTR(NCH)
  *1202:B,BLOCK,ASPBUF(NCH)
C
C-----   OБЩИE KOHCTAHTЫ
 FULWOR:,LC,1
 B30/16:,LC,1
 C1777:,LC,1
 C377:,LC,1
 *CB:LC,BLOCK,(1),C17
  C14:,LC,1
 *700:B,BLOCK,B48(7),B41(8),B33(8),B25
 ,CONT,B24,B23(2),B21,B20(2)
 ,CONT,B18(3),B15(13),B2,B1
 B/READY:,EQU,B21
 B/INTER:,EQU,B20
 B/OUTPUT:,EQU,B15
C
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 C:,EQU,9
 J:,EQU,10
 T:,EQU,11
 S:,EQU,12
 B:,EQU,13
 A:,EQU,14
C
C------------------------------------
 *B:B,REL,*
C-----
 ,WTC,ГYC
 15,VTM,
 ,XTS,BITJ
 ,AOX,SCB71.ЗAHЯTOCTЬ
 ,ATX,SCB71. ЭK71
  ,XTA,ZBITJ
  ,AAX,MOЖHOKAЧ
 ,STX,MOЖHOKAЧ
 ,UZA,ENTRY/2.= ПOBT.BXOД
C.....   YПPЯTЫBAHИE И13 , И15
 ,XTS,SAVI15
 ,ASN,64-15
 ,AEX,SAVI13
 ,AAX,B30/16
 ,AEX,SAVI13
 15,STX,M74-1
C.....   ПOЛYЧEHИE AИCП HAЧAЛA
 ,ASN,64+44
 ,ATI,14
 ,AEX,C17
 ,UZA,IND15
 ,AEX,B2
 ,UZA,IND13
 14,ITA,
 ,ATX,SAVI15
 IND15:,UTC,SAVI15-SAVI13
 IND13:,XTA,SAVI13
 ,ASN,64-24
 ,ARX,SAVAC
C.....   ДOOФOPMЛEHИE ЗAKAЗA
 ,AEX,SAVAC
 ,AAX,B39/25
 ,AEX,SAVAC
 ,APX,MSK1
 ,AUX,MSK2
 ,XTS,ДHЗ
 ,ASN,64-42
 15,AOX,
 ,WTC,ДHЗ
 ,XTS,INFEX-NFM
 ,AAX,C1777
 15,AOX,
 15,ATX,IW71
C.....   ДOП.YПPЯTЫBAHИE PEГИCTPOB
 14,VJM,SAV*IR
C-----
 ENTRY/2:15,XTA,IW71
 ,AAX,B41/40
 ,AEX,B41/40
 ,UZA,SPEC FUN.-> CПEЦ.ФYHKЦИИ
 15,XTA,IW71
 ,UZA,PROCESS.-> ПPOB.KO
 ,AAX,C1777
 ,UZA,HE ЗAK.-> HE ЗAKAЗAH
C-----   ПOИCK MECTA B OЧEPEДИ ЗAKAЗOB
 14,VTM,-LWL1
 CH*T:14,XTA,WL1+LWL1
 ,UZA,TASK ON
 14,VLM,CH*T
 ,UJ,CLOSE J
C-----   ПPИEM ЗAKAЗA B OБCЛYЖИBAHИE
 TASK ON:14,UTM,LWL
 15,XTA,IW71
  ,AAX,Z/READY
 14,ATX,WL1-1
 ,XTA,
 15,ATX,IW71
 ,ITA,14
 15,ATX,N*TSK
C
C-----   OCHOBHAЯ OБPAБOTKA ЗAKAЗA
 PROCESS:,BSS,
 ,24,3
 15,XTA,N*TSK
 ,UZA,R*MAC
 ,ATI,J
  :,24,2003B
 J,XTA,WL1-1
 T,VJM,SE*CH.=ПOИCK KAHAЛA=
 ,UZA,CLOSEJ.-> EГO HET
C-----   OБCЛYЖИBAHИE ЗAKAЗA B MT-KAHAЛE
 ,XTA,REDY71
  ,AOX,REDY/2
 15,AAX,BCH
 ,UZA,CLOSE C.-> KAHAЛ ЗAHЯT
 ,AAX,SCTER
 ,UZA,NO TER.-> HET "TEP"
C-----   CTAДИЯ BЫПOЛHEHИЯ ЗAKAЗA
 J,XTA,WL1-1
 ,ASN,64+24
 ,ATI,A
  T,VTM,1-24
 J,XTA,WL1-1
 ,AAX,B/READY
 S,UTM,STRI-LJOB
 ,U1A,KOH OБM
C-----   ИHИЦИAЛИЗAЦИЯ OБMEHA
  S,XTA,LJOB-STRI
  ,AAX,B25
  ,U1A,NO TER. - ИДET BBOД
  ,XTA,ZB42*40.ЧTOБЫ HAM
  S,AAX,LJOB-STRI.HE ИCПOPTИЛИ
  S,ATX,LJOB-STRI. БYФEP
  ,XTA,
  Z*S:T,UTC,23
  S,ATX,
  T,VLM,Z*S
  ,XTA,S*M1
  S,ATX,-1
  T,VTM,1-23
  J,XTA,WL1-1
  ,AAX,B41
  ,UZA,B CTPOKY
  J,XTA,WL1-1
  ,AAX,B23/22
  ,ACX,
  ,ATI,T
  T,XTA,S*M1+1.CTAHДAPTHOE
  S,ATX,-1.ПPИГЛAШEHИE
  ,UJ,ЗAПYCK
C.....   ПEPEПИCЬ BЫДABAEMOГO B CTPOKY
 BCTPOKY:,BSS,
 15,WTC,BUFS27
 ,24,
 T,UTC,22
 A,XTA,
 ,24,3
 T,UTC,22
 S,ATX,
 ,AAX,C377
  ,U1A,ETRAN
  J,XTA,WL1-1.B ГOCT'E
  ,AAX,B24."0" - ЗHAЧAЩИЙ
  ,UZA,ЗAПYCK.CИMBOЛ !
  E TRAN:,BSS,
 T,VLM,BCTPOKY
 S,AEX,22
 S,ATX,22
C-----   ФOPMИPOBAHИE 'JOB' ДЛЯ MT
 ЗAПYCK:,BSS,
 ,24,2003B
  J,XTA,WL1-1
  ,AAX,B23/22
  ,UZA,NORM
C-----   ЗAKAЗ HA ГPYППOBOЙ BBOД
  ,AAX,B23
  ,ASN,64+22
  ,ATI,T
  C,XTA,ASPBUF
  ,AAX,C1777
  T,AOX,CAL*STR
  C,ATX,ASPBUF
  ,XTA,IW/BIG
  ,UJ,TO JOB
C-----   OБЫЧHЫЙ BBOД/BЫBOД
  NORM:,BSS,
 J,XTA,WL1-1
 ,APX,B42*24
 ,ASN,64+18
 ,ARX,IW/OUT
  TO JOB:,BSS,
  C,ARX,ASTR
 C,ATX,JOB.JOB = ГOTOB
 15,XTA,BCH
 ,AOX,SC71
 ,ATX,SC71
 J,XTA,WL1-1
 ,AOX,B/READY.- ЗAKAЗ BЫДAH
 J,ATX,WL1-1
C-----   YБEPEM ГOTOBHOCTЬ ЭK71
 15,XTA,ZBCH
 ,AAX,REDY71
 ,ATX,REDY71
  15,XTA,ZBCH
  ,AAX,REDY/2
  ,ATX,REDY/2
C-----   YБEPEM ЗAHЯTOCTЬ CTPOЧHИKA
 15,XTA,ZBCH
 ,WTC,PAБЛ
 ,AAX,S/BUS
 ,WTC,PAБЛ
 ,ATX,S/BUS
C-----   ПEPEДAДИM ЗAKAЗ "VALERINE"
 ,ITA,B
 ,ARX,TO*VR
 ,ATX,SAVAC
 ,XTA,STATMT
 ,ASN,64+42
 ,ATI,14
 14,XTA,*YCЫ
 ,AEX,
 ,XTA,SAVAC
 ,UJ,COБЫTИE
 TO*VR:,010,
 ,Z00,CLOSEC-*B
C
C-----   OБPAБOTKA ЗAKOHЧИBШEГOCЯ OБMEHA
 KOH OБM:,BSS,
  J,XTA,WL1-1
  ,AAX,B41/40
  ,UZA,ENDEXCH.БЫЛ BЫBOД
  15,XTA,BCH
  ,AAX,REDY/2
  ,UZA,EJ1.OБЫЧH.BBOД
  ,AEX,REDY/2
  ,ATX,REDY/2
  J,XTA,WL1-1
  ,ARX,=:000 00030
  J,ATX,WL1-1
C-----   ПEPEПИCЬ ИЗ ЗAПACHOГO БYФEPA
  C,XTA,ASPBUF
  ,ARX,PAБЛ
  ,ATI,S
  EJ 0:,BSS,
  S,XTA,
  15,WTC,BUFS27
  :,24,
  A,ATX,
  :,24,3
  S,UTM,1
  A,UTM,1
  T,VLM,EJ 0
  ,UJ,PROCESS
C-----   ПEPEПИCЬ BBEДEHHOЙ CTPOKИ
  EJ 1:,BSS,
 S,XTA,
 15,WTC,BUFS27
  :,24,
 A,ATX,
  :,24,3
  ,AAX,C377
  ,UZA,ENDEXCH
  S,UTM,1
 A,UTM,1
 T,VLM,EJ 1
 END EXCH:,BSS,
 ,24,2003B
 15,XTA,ZBCH
 ,AAX,SC71
 ,ATX,SC71
 OЧ/XOP:,BSS,
 ,XTA,
 J,ATX,WL1-1
 15,ATX,N*TSK
 ,ITA,B
  ,ARX,Ш/COБ
  ,ATX,SAVAC
 ,XTA,ГYC
 ,AEX,
  ,XTA,SAVAC
 ,UJ,COБЫTИE
 Ш/COБ:1,,
 ,Z00,R*MAC-*B
 R*MAC:,BSS,
C-----   BOCCTAHOBЛEHИE PEГИCTPOB
 15,UTM,SAVI9+1
 15,XTA,
 ,STI,9
 ,STI,10
 ,STI,11
 ,ATI,12
 15,XTA,-2
 ,ATI,32B
 ,ITA,B
 ,ARX,NROF 1
 ,UJ,NRESOFF
 NROF 1:,Z00,NRTERM
 ,Z00,RET1-*B
 RET1:,BSS,
C-----   BOЗBPAT ПOД ЭKCTPAKOД
 15,XTA,
 ,ATX,SAVI13
 ,ASN,64+15
 ,ATX,SAVI15
 ,WTC,ГYC
 ,XTA,BUFS27
 ,ATI,27B
  ,UJ,OUTMACRO
C-----   ЗAKPЫTИE ЗAДAЧИ ПO OЖИДAHИЮ COБЫTИЙ
 NO TER:,BSS,
 J,XTA,WL1-1
 ,AAX,B41/40
 ,UZA,CLOSE C.-> BЫBOД
 J,XTA,WL1-1
 ,AAX,Z/READY
 J,ATX,WL1-1
  CLOSE C:,24,2003B
 ,ITA,C
 ,AAX,C1777
 ,ATI,C
 ,XTA,BITJ
 C,ATX,CHAN/J-2
 ,UJ,CLOSE
C...   ЗAKPЫTИE ПO ЗAHЯTOCTИ KAHAЛA:
 CLOSE J:,BSS,
 ,24,2003B
 J,XTA,WL1-1
 15,AOX,REGSCAL
 ,AAX,B/OUTPUT
 ,U1A,OЧ/XOP.-> HE OБЯЗ.BЫBOД
 ,XTA,BITJ
 ,AOX,SC/CLJ
 ,ATX,SC/CLJ
 CLOSE:,BSS,
 14,VTM,0
 ,ITA,B
 ,ARX,NROF 2
 ,UJ,NRESOFF
 NROF 2:,Z00,NRTERM
 ,Z00,RET2-*B
 RET 2:,XTA,
 ,ATX,SAVAC
 14,VTM,MACRO71*
 14,MTJ,33B
 14,VTM,2013B
 14,MTJ,27B
  ,WTC,ГYC
  ,XTA,BUFS27
  ,AAX,C14
  ,U1A,CLANEWTA.ДИCП.PEЖИM
  ,XTA,BITJ
  ,AOX,MOЖHOKAЧ
  ,ATX,MOЖHOKAЧ
 ,UJ,CLANEWTA
C
C=====   C П E Ц . Ф Y H K Ц И И
 SPEC FUN:,BSS,
 15,XTA,IW71
 ,AAX,B21
 ,UZA,OПPOC
C-----   ЗAПPOC KAHAЛA / OTЛAДKИ
 ,WTC,ДHЗ
 ,XTA,INFEX-NFM
 ,U1A,RET/R
 14,VTM,T/REQ
 ,XTA,ГYC
 ,ASN,64-27
 ,AUX,MSK/TT
 ,AOX,T/TT
 14,ATX,
 ,ITA,14
 14,UTM,CLOSEJ-T/REQ
 ,UJ,TTPRINT
 RET/R:,BSS,
 15,XTA,IW71
 ,AAX,B18
 ,UZA,R*MAC
C-----   ЗAПPOC OTЛAДKИ
 15,AOX,REGSCAL
 15,ATX,REGSCAL
 ,XTA,BITJ
 ,AOX,SC ШAГ
 ,ATX,SC ШAГ
 ,XTA,BITJ
 ,AOX,SCAL67
 ,ATX,SCAL67
 ,UJ,R*MAC
C-----   OПPOC / ФИKC. / PACФИKC.
 OПPOC:,BSS,
 15,XTA,IW71
 T,VJM,SE*CH
 ,UZA,ANSWER.-> HET KAHAЛA
 15,XTA,IW71
 ,AEX,B39/25
 ,AAX,B39/25
 ,UZA,MAC*74
 C,XTA,NUMBUS
 ,AAX,B/INTER
 ,UZA,OПP 1
 C,AEX,NUMBUS
 C,ATX,NUMBUS
 ,XTA,B2
 OПP 1:,AOX,B1
 ,ATX,SAVAC
 ,ITA,S
 ,ATX,/ADR
 ,ITA,14
 ,ASN,64-42
 ,AOX,SAVAC
 ANSWER:,ATX,SAVAC
 ,UZA,R*MAC
 15,XTA,IW71
 ,AAX,B24
 ,UZA,R*MAC
C-----   ФИKCAЦИЯ MT-KAHAЛA
 15,XTA,IW71
 ,AAX,B23
 ,UZA,DEFIX
 14,XTA,B48-1
 ,AOX,SPEC*CH
 ,ATX,SPEC*CH
 14,XTA,CIN
 ,AAX,Z*CIN
 ANS/C:14,ATX,CIN
 ,UJ,R*MAC
C-----   PACФИKCAЦИЯ KAHAЛA
 DEFIX:14,XTA,B48-1
 ,AAX,SPEC*CH
 ,UZA,HE ЗAK
 ,AEX,SPEC*CH
 ,ATX,SPEC*CH
 14,XTA,CIN
 ,AAX,Z*CIN
 ,AOX,/ADR
 ,AOX,B33
 ,UJ,ANS/C
C
C=====   BXOД : "KOHEЦ ЗAДAЧИ"
 MAC*74:,WTC,PAБЛ
 ,XTA,SC ЖДY
 15,AAX,ZBCH
 ,WTC,PAБЛ
 ,ATX,SC ЖДY
 ,XTA,Z48/43
 S,AAX,OWNER
 S,ATX,OWNER
 ,XTA,ZBITJ
 ,AAX,SCB71
 ,ATX,SCB71
 ,ITA,C
 ,AAX,C1777
 ,ATI,C
 ,XTA,
 C,ATX,CHAN/J-2
 ,XTA,SC TER
 15,AAX,BCH
 ,UZA,CLE*TA
 15,XTA,ZBCH
 ,AAX,SC71
 ,ATX,SC71
 CLE*TA:15,XTA,N*TSK
 ,UZA,R*MAC
 ,ATI,J
 ,XTA,
 J,ATX,WL1-1
 15,ATX,N*TSK
 ,UJ,R*MAC
C
C-----   П / П : "ПOИCK KAHAЛA"
 SE*CH:,BSS,
 15,ATX,TSK
 ,XTA,STATMT
 ,ASN,64+42
 ,UZA,SE*NO
 C,VTM,-NC3
 SEC1:,WTC,PAБЛ
 C,XTA,NUMBUS+NC1
 15,AEX,TSK
 ,AAX,=17 01777
 ,UZA,SEC2
 C,VLM,SEC1
 SE*NO:,XTA,
 T,UJ,
 SEC2:C,XTA,B48+NC1
 15,ATX,BCH
 ,AEX,FULWOR
 15,ATX,ZBCH
 ,WTC,PAБЛ
 C,UTM,NC1
 C,XTA,ASTR
 ,AOX,PAБЛ
 ,ATI,S
 S,UTM,LJOB-STRI
 S,XTA,OWNER
 ,ASN,64+42
 ,UZA,SEC3
 ,AEX,ДHЗ
 ,U1A,SE*NO
 SEC3:,XTA,ДHЗ
 ,ASN,64-42
 S,AOX,OWNER
 S,ATX,OWNER
 S,WTC,XNT
 14,VTM,
 T,UJ,
C
C-----   ДOП.YПPЯTЫBAHИE PEГИCTPOB
 SAV*IR:,BSS,
 ,ITA,32B
 15,UTM,SAV32
 15,XTS,DELT-1
 ,ITS,12
 ,ITS,11
 ,ITS,10
 ,ITS,9
 ,XTS,
 15,UTM,-SAV32-6
 14,UJ,
C
C-----   ДИAГHOCTИKA : HE ЗAKAЗAH TEPMИHAЛ
  HEЗAK:14,VTM,T/HEЗ
  :,24,2003B
  ,XTA,NROF 3
 ,ATX,WSD1
 15,XTA,M74
 ,ATI,13
 ,ASN,64+15
 ,ATI,15
 ,XTA,WSD1
 ,UJ,NRESOFF
 NROF 3:,Z00,NRTERM
 ,Z00,ERRMACRO
C
C-----   K O H C T A H T Ы
 T/HEЗ:,GOST,12HHEЗAK.TEPM.'231'
 T/REQ:,ISO,12HШ10:TEPM?''''''
 MSK/TT:,GOST,6H077000
 T/TT:,ISO,6HШ00:TE
 IW/OUT:,BSS,
 ,OCT,6053 4100 005 77777
  IW/BIG:,OCT,6053 411 726 5 77777
 B42*24:,OCT,00400000 4
 S*M1:,BSS,
 ,GOST,6H111111      .BЫBOД
 ,GOST,6H111D82.BBOД
  ,GOST,6H1111/2
  ,GOST,6H111Я82
 B39/25:,OCT,00077777
 MSK1:,OCT,01377777 7774
 MSK2:,OCT,00777777 7774
 Z48/43:,LOG,00777777 77777777
 Z/READY:,LOG,77777777 73777777
 B41/40:,OCT,003
  B23/22:,LOG,3000 0000
  ZB42*40:,LOG,7727 7777 7777 7777
  CAL*STR:,OCT,26.5 CTPOK
  ,OCT,14.10 CTPOK
 /ADR:,BSS,1
 ,END,
 TTANAL:,NAME,.07.01.86
C
C*****   AHAЛИЗATOP ПPИKAЗOB OПEPATOPA
C
C-----
 *ИПД:LC,BLOCK,
 ,CONT,XNF(4),XNW(4)
 ,CONT,Ш/CЛYЖ,Ш/FULL,Ш/ПOTOK(21)
 ,CONT,S/BUFPR
 ,CONT,BATCH(7)
 ,CONT,PRIPL/SC(3)
 ,CONT,OUTJOBSC(11)
 ,CONT,ПAPTИЗAH
 NF :,WEQ,XNF
 NЖДY:,WEQ,XNW
 *ИПK1:LC,BLOCK,PRTSTAT
C-----
 *YCЫ:LC,BLOCK,(1),RDSCAL(2),COMPIR(4)
 ,CONT,STCLTA
 TIME:,EQU,-1
 BISTIME:,EQU,110B
 MAXTIME:,EQU,111B
 PULT:,EQU,113B
C-----   HOMEPA CЛYЖEБHЫX ЗAДAЧ
 PLAN/COD:,EQU,10B.ПЛAHИPOBЩИK
 NBOUT:,EQU,11B.B Ы B O Д
 NDAYF:,EQU,61B.DAY-FILE
 NPAЗM:,EQU,62B.PAЗMETKA
 NCBЯ:,EQU,70B.ЗAДAЧA CBЯЗИ
 NBINP:,EQU,74B.ПAKETHЫЙ BBOД
 NSERV:,EQU,75B.CEPBИC OПEPATOPA
C-----
 *766:B,BLOCK,DD*D(4)
 TODAY:,LC,2
 *542:B,BLOCK,ASTIME,MASTIME
 ABTIME:,LC,1
 WSD:LC,BLOCK,BUFS(2)
C-----
 *SWCMN:LC,BLOCK,(4),OPRT
 TTEXT:I,BLOCK,LOWPRT,UPRT,SUPRT
 *STATBUF:LC,BLOCK,MBLO,MOUT
C-----
 SELECT:,SUBP,
 STATIST:,SUBP,.
 COБЫTИE:,SUBP,
 TTPRINT:,SUBP,
 STOP:,SUBP,
 SWINGRET:,SUBP,
 ISOTOALL:,SUBP,
C-----
 *436:B,BLOCK,TELIS(2),TLG1(14),TLG2
 *TLSIZE:LC,BLOCK,(1),XNPHCH(2),XNSS
 NSS:,WEQ,XNSS
 NSS*2:,P*P,(NSS) 2
 NSS*3:,P*P,(NSS) 3
 *TLSYS:,LC,NSS*3
 STATMT:,EQU,*TLSYS+1
  CHLINER:,EQU,*TLSYS+2
 REFOP:,EQU,*TLSYS+NSS*2
 *TLSTAT:LC,BLOCK,(12),SC*BLOCK
 *TLBUFI:LC,BLOCK,CIN
 *TLBUFOP:LC,BLOCK,(11),SCOP,MAINC
 XNT:,EQU,-4
C-----
 PLAN/IS:,LC,1.ДHЗ ПЛAHИPOBЩИKA
 NSTAJOB:,LC,1.
 MШ:,LC,1
 FSBASENR:,LC,1
 FFPT:,LC,1
 ADOFACC:LC,BLOCK,(2),CNUMT(2)
 STARTJOB:,SUBP,
 ЗAПYCK:,SUBP,
 STARTFSM:,SUBP,
 EFSMNRS:,SUBP,
C-----
 TABLEMT:LC,BLOCK,(16),T1MT(32)
  ,CONT,(16),T2MT(32)
  ,CONT,(16),TMT(32)
 STATUSMT:LC,BLOCK,(1),OLD(4),NEW(23)
  ,CONT,ШHГ(4),MISTERX,ЯEЩETYT
 REWINDSC:LC,BLOCK,(2),***C
 LISTSTRA:LC,BLOCK,WL1
 SCALSTRA:LC,BLOCK,(12),SJMT(32)
 CMDREC:LC,BLOCK,(1),BLMD,SMWR
 *DISCS:,SUBP,
 MTDISPAC:,SUBP,
 OPENWAIT:,SUBP,
 TOЛЧOK:,SUBP,
C-----
 FLSTOPCB:,EQU,102B
 *LINKPAR:LC,BLOCK,(1),SC/CONC
 INF7CH:LC,BLOCK,NЗAД,W110,NЗCB,W107(7)
 ,CONT,FBACK,STPLINK,FLACT70
 R37B:,SUBP,
C-----
 *CB:LC,BLOCK,(6),NUMB(7),I0
 FULWOR:,LC,1
 B30/16:,LC,1
 C7777:,LC,1
 C3777:,LC,1
 C377:,LC,1
 C77:,LC,1
 C37:,LC,1
 C7:,LC,1
 C3:,LC,1
C-----
 *677:B,BLOCK,BITS
 ,CONT,B48,B47,B46,B45,B44,B43
 ,CONT,B42,B41,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33,B32,B31
 ,CONT,B30,B29,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21,B20,B19
 ,CONT,B18,B17,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B9,B8,B7
 ,CONT,B6,B5,B4,B3,B2,B1
 POINT:,EQU,B4
C-----   PAБOЧИE ЯЧEЙKИ
 LWORK:,EQU,11
 WORK:I,BLOCK,FTAP,WS(0),SV,WS1(0),NT
 ,CONT,WS2,SYM,TABL,TN
 ,CONT,PCHAN,LCHAN
 ,CONT,BUFTA,ADR8A
C-----   OБOЗHAЧEHИЯ PEГИCTPOB
 SR:,EQU,2
 L :,EQU,10
 RT:,EQU,11
 J :,EQU,11
 M :,EQU,12
 V3:,EQU,12
 V :,EQU,13
 IB:,EQU,15
C
C-----   БAЗИPOBAHИE
 B:IB,REL,*
 :,24,3
 ,UJ,COR*DAT
 BEGIN:,BSS,
C
C====================================
C==  A H A Л И З  BXOДHOЙ  CTPOKИ  ==
C====================================
C
 ,24,2003B
 ,XTA,SCOP
 ,AAX,B48/25
 ,UZA,NRESRET
 ,ANX,
 ,ATI,14.ФИЗ.N KAHAЛA
 ,ATX,PCHAN
 14,WTC,CIN
 SR,VTM,6.AДPEC TEKCTA
 SR,MTJ,V.- KOПИЯ
 SR,XTA,XNT
 ,ASN,64+15
 ,ARX,C37
 ,AAX,C37
 ,ATX,LCHAN.ЛOГ.N KAHAЛA
 ,ATI,J
 ,AEX,SCOP
 ,AAX,C7
 14,AOX,B48-1
 ,AEX,SCOP
 ,ATX,SCOP
 SR,XTA,
 ,UZA,NOTUND.-> ПPEДЫД.ПPИKAЗ
 ,AEX,=6HTEЛ
 ,ASN,64+24
 ,UZA,TEЛ.ПPИKAЗ "TEЛ"
 ,AEX,=6H   TEЛ
 ,AEX,=6H   MT-
 ,UZA,TEЛ/MT
  ,AEX,=6H   MT-
  ,AEX,=6H   ЭP-
  ,UZA,TEЛ/ЭP
  ,AEX,=6H   ЭP-
  ,AEX,=6H   CB-
  ,UZA,TEЛ/CB
 SR,XTA,
 ,ASN,64+32
 ,AAX,C377
 ,ATI,14
 14,UTM,-75B
 14,VZM,COБЫT
 14,UTM,75B-55B
 14,VZM,COБЫT
C
C-----   ПEPEKOДИPOBKA COOБЩEHИЯ B TEXT*
 ,XTA,
 ,ATX,BUFTA
 ,ATX,ADR8A
 ,24,3
 MS 1:V,XTA,
 L,VTM,-5
 MS 2:,ASN,64-8
 ,ATX,WS
 ,YTA,
 ,ATI,M
 M,XTA,ISOTOALL
 ,ASN,64+8
 ,AAX,C377
 ,ATX,WS1
 ,ASN,64+6
 ,ATI,M
 ,ASN,64-6
 ,AEX,WS1
 ,ATX,WS1
 M,UJ,TYPE
C-----   ПEPEKЛЮЧATEЛЬ TИПOB CИMBOЛOB
 TYPE:,BSS,
 :,XTA,BUFTA.= KOHEЦ COOБЩ.
 ,UJ,ANAL
 /LET:,XTA,BUFTA.= БYKBA
 ,UJ,LETTER
 :,AAX,C7
 ,UJ,DIGIT
 LETTER:,ASN,64-6
 ,AOX,WS1
 ,ATX,BUFTA
 ,XTA,WS
 L,VLM,MS 2
 V,VLM,MS 1
 DIGIT:,ATX,WS2
 ,XTA,ADR8A
 ,ASN,64-3
 ,AOX,WS2
 ,ATX,ADR8A
 ,UJ,/LET
C-----   ПOЛYЧИЛИ KOHEЦ COOБЩEHИЯ
 ANAL:,BSS,
 ,24,2003B
 ,ATX,BUFS+1
 ,XTA,7
 ,AAX,B32
 ,U1A,SRC*KEY
C-----   ЗAПИШEM  B  DAY-FILE
 ,XTA,ASTIME
 ,ATX,BUFS
 ,XTA,LCHAN
 ,ASN,64-16
 ,AOX,S/INF
 ,ATX,WS
 ,ITA,IB
 ,ARX,WS
 ,UJ,STATIST
 S/INF:2,Z11,BUFS
 ,Z01,SRC*KEY-B
 SRC*KEY:,BSS,
C
C-----   ПOИCK KЛЮЧEBOГO CИMBOЛA
  SR,VTM,TABCOM
  V,VTM,-1
 ,24,3
 L2:SR,XTA,
 ,UZA,NOT UND
 L3:V,UTM,1
  ,ATX,TABL
  ,AEX,BUFTA
  ,AAX,C77
 V,UZA,SWITCH
  ,XTA,TABL
  ,ASN,64+6
  ,U1A,L3
  SR,VLM,L2
C
C=====   ПEPEKЛЮЧATEЛЬ ПPИKAЗOB
C
 SWITCH:,BSS,
 :,ITA,V3  .ПPИKAЗ ":"
   ,UJ,PRIKAZ0  .
 :SR,VTM,ЗAПYCK.ПPИKAЗ "B"
   ,UJ,ПPOBBOД
 :SR,VTM,STOP.ПPИKAЗ "."
   ,UJ,KILL
 :,UJ,ORD*C.ПPИKAЗ "C"
 :14,VTM,-2.ПPИKAЗ "П"
    ,UJ,П/ANAL
 :  ,UJ,JOBTIME  .ПPИKAЗ "T"
 : ,XTA,FFPT    .ПPИKAЗ "Л"
 ,UJ,PAPERTAP
 :  ,UJ,CBBOД  .ПPИKAЗ "/"
 : ,UJ,INPUT.ПPИKAЗ "I"
 :,UJ,H/BATCH.ПPИKAЗ "H"
 :13,VTM,K/TEX-H/TEX
 ,UJ,OПOЗH.ПPИKAЗ "O"
 :,UJ,NOTUND.ПPИKAЗ "+"
 :,XTA,BUFTA.ПPИKAЗ "N"
 ,UJ,NEWL
 :,UJ,LISTTOT.ПPИKAЗ "A"
 :,UJ,LINEPR.ПPИKAЗ "Y"
 :,XTA,BUFTA.ПPИKAЗ "P"
   ,UJ,TAPEPR
 :,XTA,BUFTA.ПPИKAЗ "D"
    ,UJ,DATAINP
 :,XTA,BUFTA.ПPИKAЗ "F"
   ,UJ,ORD*F
 : ,UJ,ORD*Б
C
C===========================================
C==   C O O Б Щ E H И Я   З A Д A Ч A M   ==
C===========================================
C
C-----   TEЛEГPAMMA ЗAДAЧE CBЯЗИ
C        (ЛEHИHГPAДCKИЙ BAPИAHT)
  TEЛ/CB:,XTA,NЗCB
  ,UJ,IF/T
C-----   TEЛEГPAMMA ДЛЯ ЭP
  TEЛ/ЭP:,UTC,CHLINER-STATMT
C-----   TEЛEГPAMMA ДЛЯ MT
 TEЛ/MT:,XTA,STATMT
 ,ASN,64+42
  IF/T:,UZA,IABSENT
  ,NTR,3...
 ,ATI,M
 ,X-A,XNW
 14,VTM,-24
 ,UJ,COБЫT1
C
C-----   BBEДEHA CTPOKA ДЛЯ ЗAДAЧИ
 COБЫT:,BSS,
 SR,XTA,
 ,ASN,64+40
 14,VJM,CH*TERM
 ,XTA,WS
 14,VTM,-16
 COБЫT1:,AOX,=1440
 J,ATX,TELIS
 ,ITA,IB
 ,ARX,I/COБ
 ,ATX,WS
 M,XTA,*YCЫ
 ,AEX,
 ,XTA,WS
 14,MTJ,M
 ,UJ,COБЫTИE
 I/COБ:,Z04,.= BIT42
 ,Z00,COБ1-B
 COБ 1:14,VTM,NRESRET
C-----   ПEPEПИCЬ CTPOKИ B БYФEP CO CДBИГOM
 MOVE:L,VTM,-13
 ,24,3
 MO 1:L,UTC,13
 SR,XTA,
 ,AAX,C377
 ,UZA,MO 2
 L,VLM,MO 1
 MO 2:,XTA,
 L,VZM,MO 4
 L,UTM,1
 MO 3:L,UTC,13
 SR,ATX,
 L,VLM,MO 3
 MO 4:L,VTM,-12
 J,VZM,MO 5
 ,UTC,TLG2-TLG1
 MO 5:J,VTM,TLG1
 SR,MTJ,V
 MO 6:V,XTA,
 M,ASN,64
 ,ATX,WS
 V,XTA,1
 M,ASN,64
 ,YTA,
 ,AOX,WS
 J,ATX,
 V,UTM,1
 J,UTM,1
 L,VLM,MO 6
 14,UJ,
C-----   ПPOBEPKA TEPMИHATOPA ЗAДAЧИ
 CH*TERM:,BSS,
 ,AAX,C37
 ,ATX,WS
 ,NTR,3
 ,X-A,XNW
 ,ATI,M
 M,XTA,*YCЫ
 ,AAX,B30/16
 ,UZA,IABSENT
 14,UJ,
C
C===========================================
C==  B H E Ш H И E   Y C T P O Й C T B A  ==
C===========================================
C
C*****   ПPИKAЗ : "Б"
 ORD*Б:,XTA,BUFTA
  ,ARX,=1010 00 06060606 00
  ,AAX,=4040 77 40404040 77
  ,AEX,=0000 55 00000000 02
  ,U1A,NOT UND
C
C---  ПPИKAЗ : <NMФ>M<NБOБ>Б
C
  ,XTA,BUFTA
  ,APX,=:0707
  ,ASN,64+42
  ,ATI,M.N MФ
  ,XTA,BUFTA
  ,ASN,64-18
  ,ATX,BUFTA
  ,XTA,B48
  M,ASN,64-30B
  ,AAX,MISTERX
  ,UZA,HEЛЬЗЯ
  M,XTA,T1MT-30B
  ,ASN,64+42
  ,U1A,HEЛЬЗЯ
  :,24,3
  L,VTM,-3
C---
  FORMNB:,ATX,WS
  ,ASN,64-1
  ,ATX,WS1
  ,ASN,64-2
  ,ARX,WS1
  ,ATX,WS.*10
  ,XTA,BUFTA
  ,ASN,64-6
  ,ATX,BUFTA
  ,YTA,
  ,AAX,=17
  ,ARX,WS
  L,VLM,FORMNB
  :,24,2003B
  5,CALL,MTDISPAC
  ,AAX,C7777
  ,AOX,NOCHECK
  :,24,3
  ,ATX,WS
  5,VTM,-31
  SNAM:5,XTA,TMT+31
  ,AEX,WS
  ,UZA,YЖEECTЬ
  5,VLM,SNAM
  ,XTA,WS
  :,24,2003B
  M,ATX,TMT-30B
  5,CALL,OPENWAIT
  ,UJ,O/KEY
  YЖEECTЬ:,ATX,TTEXT+2
  ,XTA,=6HYЖE EC
  ,ATX,TTEXT
  ,XTA,=6HTЬ '41'
  ,ATX,TTEXT+1
  ,UJ,TO TEL
C
C*****   ПPИKAЗЫ : <NYCTP> . . "O"
 OПOЗH:,BSS,
 RT,VTM,KOPOHO
 ПOП:,XTA,BUFTA
 ,ASN,64+6
  13,UTC,H/TEX-K/TEX
  ,AEX,K/TEX
 ,AAX,C77
 ,UZA,ПPOBHOM
 13,VLM,ПOП
  ,XTA,BUFTA
  ,AEX,PANNO
  ,UZA,RMD
 ,UJ,NOTUND
C******
 KOPOHO:,BSS,
 ,XTA,BUFTA.OПPEДEЛEHИE :
 ,ASN,64+12.ДИCK / ЛEHTA
 ,AEX,Д/TEX
 ,AAX,C77
 13,U1A,TOMX.-> ЛEHTA
 13,WTC,TOMX.
 IB,UJ,.-> ДИCK
 :,UJ,END EXCH.= "KO"
 ,Z00,DENDEXCH-B.= "ДKO"
 :IB,UJ,TONX1-B.= "PO"
 ,Z00,ДHPO-B.= "ДPO"
 TOMX:IB,UJ,TONX1-B.= "HO"
 ,Z00,ДHPO-B.= "ДHO"
C
C*****   ПPИKAЗЫ : "PO" , "HO"
 TONX1:,BSS,
 ,XTA,MISTERX
 14,AOX,B48-30B
 13,VZM,TOMX2
 14,AEX,B48-30B
 TOMX2:,ATX,MISTERX
  14,AAX,B48-30B
    ,U1A,BЫX
  14,XTA,T1MT-30B
  ,ASN,64+42
    ,UIA,BЫX  .ЗAHЯTA MЛ - HE ДEPГAEM
   :    ,24,2003B
  2,XTA,B16
  1,AOX,OLD-3
  1,ATX,OLD-3
   ,UJ,BЫX
C
C*****   ПPИKAЗ : "KO"
 ENDEXCH:14,XTA,T1MT-30B
 ,ASN,64+25
 ,AAX,C37
 ,UZA,HEЛЬЗЯ
 14,XTA,T1MT-30B
 ,AOX,B8
 14,ATX,T1MT-30B
 ,UJ,BЫX
C
C*****   ПPИKAЗЫ : "ДPO" , "ДHO"
 ДHPO:,BSS,
 14,XTA,*DISCS-30B
   ,U1A,HEЛЬЗЯ   .HMД B PAБOTE
 ,ITA,14
 ,ASN,64+3
 ,ARX,C3
 ,AAX,B4
   ,U1A,NOTUND
 ,XTA,BLMD
 14,AOX,B48-30B
 13,VZM,ДHO
C*****   ПPИKAЗ : "ДPO"
 14,AEX,B48-30B
 ,ATX,BLMD
 ,XTA,SMWR
 14,AOX,B48-30B
 ,ATX,SMWR
 ,UJ,BЫX
C*****   ПPИKAЗ : "ДHO"
 ДHO:,ATX,BLMD
   ,UJ,BЫX
C
C*****   ПPИKAЗ : "ДKO"
 DENDEXCH:,BSS,
 14,XTA,*DISCS-30B
 ,UZA,HEЛЬЗЯ .MOДYЛЬ ПYCT
 14,XTA,B16-30B
  ,AOX,CMDREC
  ,ATX,CMDREC
  , UJ,BЫX
C
C*****   ПPИKAЗЫ : <MФ> "ПEP"
C                  "HA" <MФ> "ПEP"
C
 CHANGEMT:,XTA,BUFTA
 ,ASN,64+30.YЖE
   ,U1A,CTOИT  .ПEPECTABЛEHA
 ,XTA,ЯEЩETYT
 ,U1A,HEЛЬЗЯ.KOHЧИ C OДHИM
   :   ,24,2003B
 1,XTA,ШHГ-3
 2,AAX,B8
   ,UZA,HEЛЬЗЯ  .MФ = ГOTOB
 1,XTA,NEW-3
 2,AAX,B24.HOMEP
 2,AEX,B24.CTAPOГO MФ
 ,AOX,ADR8A.И ПPИЗHAK
 ,ATX,ЯEЩETYT.ЗAПИCИ
   ,UJ,O/YES .COГЛACHЫ
 CTOИT:,XTA,ЯEЩETYT
   ,UZA,NOTUND  .PAHOBATO
 ,ATI,10.CTAPЫЙ MФ
 ,ASN,64+16
 2,VJM,ASK.HA HOBOM MФ
 14,MTJ,2
 ,XTA,TABL
    ,ATI,11
 ,ASN,64-42
 ,AUX,KPAKYC.ДЛЯ ИCПPABЛEHИЯ
 ,ATX,FTAP.KYC-OB
  11,XTA,T1MT-30B
 ,ASN,64+36.A ЛEHTA
   ,UIA,HEЛЬЗЯ  .ЗAXBAЧEHA
 10,XTA,B48-30B
 11,AOX,B48-30B
 ,AAX,MISTERX.XOTЯ БЫ OДHA
   ,UIA,ИCKYC  .HEИMEHOBAHA
  10,XTA,TMT-30B
  11,AEX,TMT-30B
   ,UIA,HEЛЬЗЯ  ..KOHTPOЛЬ ИMEHИ
 ИCKYC:,BSS,
 10,XTA,SJMT-30B
    ,UZA,HEЛЬЗЯ  .HAC OБMAHYЛИ
 11,ATX,SJMT-30B
 KYCИKИ:  ,UZA,BCEKYCЫ
 ,ANX,
 ,ATI,12
 12,XTA,WL1-1
 ,AOX,KPAKYC.ПPABKA
 ,AEX,KPAKYC.KYC-OB
 ,AOX,FTAP
 12,ATX,WL1-1
 10,XTA,SJMT-30B
 12,AEX,BITS
 10,ATX,SJMT-30B.CЛEД. KYC
   ,UJ,KYCИKИ
  BCEKYCЫ:,BSS,
  10,XTA,T1MT-30B
  11,ATX,T1MT-30B
  10,XTA,T2MT-30B
  11,ATX,T2MT-30B
 ,XTA,
  10,ATX,T1MT-30B.ЗAMETAEM
  10,ATX,T2MT-30B.CЛEДЫ
 ,ATX,ЯEЩETYT.  MФ
 ,XTA,TПЛOX
 10,ATX,TMT-30B
  12,VTM,-1
  CHANBWC:12,XTA,***C
  10,AAX,B48-10B
    ,UIA,ECHBWC
  12,XTA,***C
  10,AOX,B48-10B
  11,AEX,B48-10B
  12,ATX,***C
  ECHBWC:  ,BSS,
  12,VLM,CHANBWC
 ,ITA,10
 ,ASN,64+3
 ,ATI,11
 ,ITA,10
 ,AAX,C7
 ,AEX,C7
 ,ATI,12
 11,XTA,ШHГ-3
 12,AOX,B8
 12,AEX,B8
 11,ATX,ШHГ-3
  15,MTJ,11
 5,VJM,TOЛЧOK
  11,MTJ,15
   ,UJ,O/KEY
C
C-----   ПPOBEPKA HOMEPA YCTPOЙCTBA
 ПPOBHOM:,XTA,ADR8A
 ,AAX,C77
 ,ATX,TABL
 ,ATI,14
 ,ASN,64+3
 ,ATI,1
 ,ARX,B1
 ,AAX,B3
   ,UZA,NOT UND
 ,ITA,14
 ,AAX,C7
 ,AEX,C7
 ,ATI,2
 RT,UJ,
C
C-----   ПPOBEPKA ГOTOBHOCTИ
 ASK:,ATX,SV
 ,ITA,2
 ,ATX,TN
 ,XTA,TABL
 ,ASN,64+3
 ,ATI,2
 ,XTA,TABL
 ,AEX,C7
 ,AAX,C7
 ,ATI,14
   :   ,24,2003B
  ,ITA,2
  ,ARX,B1
  ,AAX,B3
    ,UIA,ASK2
  2,XTA,NEW-1
  ,ASN,64+24
 ,ATX,WS2
    ,UJ,ASK3
  ASK2:2,XTA,NEW-3
  ,ATX,WS2
  ASK3:,BSS,
 14,AAX,B16
   ,UZA,CHW
 2,VTM,TNR.HET ГOTOBHOCTИ
 TTE:,XTA,TABL.
 ,ASN,64-42.
 ,AUX,MSK1.
 2,AOX,.
 TTE1:,ATX,TTEXT.
 ,XTA,.
 ,ATX,TTEXT+1.
   ,UJ,TOTEL  .
 CHW:,XTA,SV.ПPOBEPЯTЬ ЗП
   ,UZA,EXST  . - HET
  ,XTA,WS2
 14,AAX,B24
 2,VTM,TNW.HET ЗП
   ,UIA,TTE  .
 EXST:,BSS,
   :   ,24,3
   ,WTC,TN
 ,UJ,
C
C===================================
C===   C B Я З H Ы E   Д E Л A   ===
C===================================
C
C*****   ПPИKAЗ : "TEЛ"
 TEЛ:,BSS,
 SR,XTA,
 ,ASN,64+32
 J,ATX,TELIS
 M,VTM,-32
 14,VJM,MOVE
 SR,XTA,
 ,AEX,=6H0
 ,ASN,64+42
 ,UZA,BЫX
 TEЛCB:,BSS,
   :   ,24,2003B
 ,XTA,NЗCB
 ,UZA,IABSENT
  ,XTA,W107
   ,U1A,BЫX
 ,XTA,NЗAД
 ,UIA,TOFL70
 ,XTA,COMPIR
 ,AAX,SC/CONC
 ,UZA,TOFL70/
  ,XTA, COMPIR
  ,AAX,=7777 7777 7777 7400
  ,ATX,COMPIR
  ,033,34B
  ,XTA,C7
  ,ATX,W110
  ,ATX, FBACK
   ,XTA,NЗCB
   ,ATX,NЗAД
   SR,VTM,R37B
    ,UJ,NRESRET
 TOFL70:,AEX,NЗCB
 ,UZA,BЫX
 TOFL70/:,XTA,C7
 ,ATX,FLACT70
 ,UJ,BЫX
C
C*****   ПPИKAЗ : "I"
C
 INPUT:,BSS,
 ,XTA,NЗCB
   ,U1A,BЫX
 V,VTM,N CBЯ
    ,UJ,TONSTJ
C
C*****   ПPИKAЗ : "LINKSTOP"
 STP/LINK:,ATX,FLSTOPCB
 ,UJ,TEЛCB
 C*STPL:,LOG,77770011 00220055
C
C*****
 STPLJOB:14,XTA,BITS
 ,AOX,STPLINK
 ,ATX,STPLINK
 14,XTA,BITS
 ,AOX,OUTJOBSC
 ,ATX,OUTJOBSC
C*****
 BЫX:SR,VTM,SELECT
 ,UJ,NRESRET
C
C=============================
C===   T E P M И H A Л Ы   ===
C=============================
C
C*****   ПPИKAЗ : <ИMЯ П/C> "STOP"
 STP/ПC:,BSS,
 14,XTA,*TLSYS
 ,ASN,64-6
 ,ASN,64+24
 14,AOX,REFOP
 14,ATX,REFOP
 ,UJ,BЫX
C
C*****   ПPИKAЗЫ : . . ."DOWN"   . . ."UP"
 UPDOWN:,BSS,
 ,XTA,BUFTA
 V,ASN,64+12
 ,AEX,ALL/TEX
 ,U1A,UPDOWN 1
C*****   ПPИKAЗЫ : "ALLDOWN" , "ALLUP"
 V,VZM,ALL 1
 ,XTA,FULWOR
 ALL 1:,ATX,SC*BLOCK
 ,UJ,NRESRET
C
C*****   ПPИKAЗЫ : <NT>"DOWN"   <NT>"UP"
 UPDOWN 1:,NTR,3
 ,XTA,ADR8A
 ,UZA,NOTUND.-> NTERM=0
 ,ATI,14
 ,A-X,XNPHCH
 ,UZA,NOTUND.-> NTERM>MAX
 14,XTA,B48-1
 V,V1M,ONE 1
 ,XTA,
 ONE 1:,AEX,SC*BLOCK
 14,AAX,B48-1
 ,AEX,SC*BLOCK
 ,UJ,ALL 1
C
C===========================================
C==  Y П P A B Л E H И E   M A Ш И H O Й  ==
C===========================================
C
C*****   ПPИKAЗ : "."
 KILL:,BSS,
 RT,VJM,ДAЙДHЗ
 KILL1:,BSS,
  ,XTA,ПAPTИЗAH
  14,AAX,BITS
    ,U1A,HEЛЬЗЯ
 ,ITA,14
 ,AEX,NЗCB
 ,UZA,HEЛЬЗЯ
 ,AEX,NЗCB
 ,AEX,NЗAД
 ,UZA,STPLJOB
 SR,VTM,STOP
 ,UJ,NRESRET
C********
 CH*STP:,BSS,
 ,XTA,BUFTA
 ,ASN,64+24
 ,ATX,WS
 14,VTM,PT/STP-LI/STP
 STP1:14,XTA,LI/STP
 ,AEX,WS
 14,UZA,STPSW E
 14,VLM,STP1
 ,UJ,NOTUND
C
C-----   ПEPEKЛЮЧATEЛЬ CПEЦ-ЗAДAЧ
 :,XTA,CNUMT
 ,UJ,STP/PT
 :14,VTM,1.= MTSTOP
 ,UJ,STP/ПC
 :14,VTM,2.= SCSTOP
 ,UJ,STP/ПC
 STPSW E:,BSS,
 :,XTA,C*STPL
 ,UJ,STP/LINK
C
C*****   ПPИKAЗ : "PTSTOP"
 STP/PT:,UZA,IABSENT
 ,ATI,14
 ,UJ,KILL1
C
C*****   ПPИKAЗ : "H"
 H/BATCH:,BSS,
 ,XTA,BUFTA.ПPИЗHAK :
 ,ASN,64+6.CTOП-ПOTOK
 ,AEX,S/TEX.
 ,AAX,C77.
    ,UZA,CLEAR/
  ,XTA,FULWOR
  CLEAR/:,BSS,
 ,ATX,SYM....
 ,XTA,ADR8A
    ,UZA,CKOПOM
  RT,VJM,ДAЙ ДHЗ
  ,AAX,Ш/FULL
  ,UZA,NOT UND
  ,XTA,SYM
    ,U1A,B/SET
  14,XTA,BITS
  ,AEX,FULWOR
  ,ATX,SYM
    ,UJ,B/SET
  CKOПOM:14,VTM,Ш/ПOTOK-BITS
  B/SET :,XTA,BATCH
  14,AOX,BITS
  ,AAX,SYM
  ,ATX,BATCH
    ,UZA,BЫX
  ,XTA,PLAN/IS
    ,U1A,BЫX
 V,VTM,PLAN/COD
 ,UJ,TONSTJ
C
C*****   ПPИKAЗЫ : "N" , ..."DOWN"
 NEWL:,BSS,
 ,AEX,DOWN/TEX
 ,ASN,64-24
 V,VTM,12
 ,UZA,UPDOWN
 ,XTA,BUFTA
 ,ASN,64+6
 14,VJM,CH*TERM
 NEWL1:,XTA,BUFTA
 ,ATX,101B
   ,UJ,BЫX
C
C*****   ПPИKAЗ : "Y"
 LINEPR:,BSS,
 RT,VJM,ДAЙ ДHЗ
  ,XTA,S/BUFPR
 14,AOX,BITS
 14,AEX,BITS
 ,ATX,S/BUFPR
 OPEN:,24,2003B
 ,XTA,STCLTA
 ,AOX,RDSCAL
 ,ATX,RDSCAL
 ,XTA,
 ,ATX,STCLTA
   ,UJ,BЫX
C
C*****   ПPИKAЗЫ : . . . "A"
 LISTTOT:,BSS,
  ,XTA,BUFTA
  ,AEX,STA/TEX
  ,ASN,64-30
    ,U1A,NO/STAT
C*****   ПPИKAЗЫ : "OSTA" , "CSTA"
   :    ,24,2003B
  14,VTM,1
  ,XTA,BUFTA
  ,ASN,64+18
  ,AEX,C/TEX
  ,AAX,C77
    ,U1A,O/CTA
  14,VTM,
  O/CTA:,ITA,14
  ,ATX,MBLO
  ,ATX,MOUT
    ,UJ,BЫX
C*****   ПPИKAЗ : <N ШИФPA> "A"
  NO/STAT:,BSS,
 RT,VJM,ДAЙ ДHЗ
 ,XTA,Ш/FULL
 14,AAX,BITS
   ,UZA,HEЛЬЗЯ
 ,AOX,S/BUFPR
 ,ATX,S/BUFPR
 ,UJ,OPEN
C
C*****   ПPИKAЗ : "P"
 TAPEPR:,BSS,
 ,AEX,ПEP/TEX
 ,ASN,64-30
 RT,VTM,CHANGEMT
   ,UZA,ПPOBHOM
 ,XTA,BUFTA
 ,AEX,STOP/TEX
 ,ASN,64-24
 ,24,2003B
 ,UZA,CH*STP
 ,XTA,BUFTA
 ,AEX,UP/TEX
 ,ASN,64-36
 V,VTM,0
 ,UZA,UPDOWN
 ,XTA,BUFTA
 ,ASN,64+6
   ,UZA,TAPR
 ,AEX,M/TEX
 ,AAX,C77
   ,UZA,PAЗM
 ,XTA,BUFTA
 ,ASN,64+12
 V,VJM,CH DIG
   ,UZA,NEWL1
 TAPR:,BSS,
 ,XTA,ADR8A
 ,ATX,101B
 V,VTM,N BOUT
   ,UJ,TONSTJ
C
C*****   ПPИKAЗ : "MP"
 PAЗM:,BSS,
 ,XTA,ADR8A
 ,ASN,64-9
 ,ATI,V
 V,UTM,NPAЗM
 ,XTA,BUFTA
 ,ASN,64+12
 ,AEX,И/TEX
 ,AAX,C77
   ,U1A,TONSTJ
 V,UTM,300B
   ,UJ,TONSTJ
C
C*****   ПPИKAЗЫ : "DF" , "REF"
 ORD*F:,BSS,
 ,AEX,CONSOL
 ,U1A,DAYFIL
  V,VTM,0
  ,UJ,ORD*REF
C
C*****   ПPИKAЗ: "PANNO"
  R M D:,BSS,
  ,XTA,PCHAN
  ,ASN,64-6
  ,ATI,V
  V,UTM,47B.N ИЗ БCЗ
  ORD*REF:,BSS,
C
C*****   ПPИKAЗ : "REF" (OTKAЗ OT KOHCOЛИ)
 ,XTA,PCHAN
 ,ATI,14
 ,AEX,MAINC
 ,AAX,C37
 ,UZA,HEЛЬЗЯ.-> ГЛAB.KOHCOЛЬ
 ,24,2003B
 14,XTA,B24-1
 ,AOX,REFOP
 ,ATX,REFOP
  V,V1M,TO N STJ
 ,UJ,BЫX
C
C*****   ЗAПYCK ЗAДAЧИ BЫДAЧИ DAYFILE'A
 DAYFIL:,XTA,BUFTA
 ,ATX,101B
 V,VTM,NDAYF
 ,UJ,TONSTJ
C
C*****   ПPИKAЗ : ":"
 PRIKAZ0:,BSS,
 ,XTA,BUF TA
 ,ASN,64+18
 ,AEX,Ш/TEX.
 ,AAX,C77
   ,U1A,PRIK0
  V,VTM,16B.PUT PULT
 RT,VJM,ДAЙДHЗ
 14,WTC,*YCЫ
 14,VTM,
 14,VZM,TONSTJ
 14,UTM,PULT
 ,XTA,ADR8A
 ,ASN,64+6
 14,ATX,
 ,ITA,14
 ,ATX,ADR8A
 PRIK0:,BSS,
C......   ПEPEKOДИPOBKA B-CЛOBA B ISO
 14,VTM,1-4.CЧETЧИK
 V3,VTM,0.CДBИГ
 L24:,WTC,ADR8A.
 ,XTA,.
 V3,ASN,64.
 ,AUX,MUP.
 ,AOX,CBN.
 14,ATX,TTEXT+3.
 V3,UTM,-12.
 14,VLM,L24.
 END/TEL:,BSS,
  ,XTA,
  ,ATX,TTEXT+4
C......
 TO TEL:,BSS,
   :   ,24,2003B.
 SR,VTM,SELECT.
  14,VTM,TTEXT
  ,ITA,14
 ,ATX,WS
 ,XTA,LCHAN
 ,ASN,64-40
 ,AOX,WS
  14,VTM,NRESRET
 ,UJ,TTPRINT+1
C
C*****   ПPИKAЗЫ : "B" , "ПB"
 ПPOBBOД:,BSS,.
 ,XTA,1.
 ,AAX,B48
 ,ATX,NSTAJOB.
 ,XTA,BUFTA
 ,ASN,64+6
 ,AAX,C77
 ,AEX,П/TEX.
 V,VTM,NBINP
 ,UZA,TONSTJ.-> ПPИKAЗ "ПB"
 ,XTA,BUF TA.
 ,ASN,64+6.
 ,AEX,BC/TEX
 ,AAX,C7777
   ,U1A,CHBBOД
C.....   BBOД C ПACПOPTOM
 ,XTA,B48
 ,ATX,NSTAJOB
 CHBBOД:,XTA,ADR8A
   ,UZA,NRESRET
 RT,VJM,ДAЙ ДHЗ
 RT,VJM,ПPOB ДHЗ
 ,ITA,14
 ,ATX,MШ
   ,UJ,NRESRET
C
C*****   ПPИKAЗ : "/"
 CBBOД:,XTA,BUFTA
 ,ASN,64+6
 V,VJM,CH DIG
   ,UZA,TOSERV
 ,XTA,ADR8A
   ,UZA,NOT UND  .
 ,ATI,V
    ,UJ,TONSTJ
 TO SERV:,XTA,BUFTA
 ,ASN,64+6
 ,ATX,101B
 V,VTM,NSERV
C
C=====   ЗAПYCK CЛYЖEБHOЙ ЗAДAЧИ
C
 TONSTJ:,ITA,V
 ,ATX,NSTAJOB
  SR,VTM,STARTJOB
    ,UJ,NRESRET
C
C-----   ПPOBEPKA : CИMBOЛ = ЦИФPA
 CH DIG:,BSS,
 ,AAX,C77
 ,ATI,L
 ,XTA,B48
 L,ASN,64
 ,AAX,SC DIG
 V,UJ,
C
C*****   ПPИKAЗЫ : "ПЛ" , "KПЛ"
 PAPERTAP:,BSS,
C......   ПPИKAЗЫ ПEPФOЛEHTЫ:
 ,UZA,IABSENT.-> П/Л HET
 ,WTC,FSBASENR
 13,VTM,
   :   ,24,2003B
 14,VTM,NRESRET
C         HE OKOHЧAHИE ЛИ ЭTO ПЛ:
 ,XTA,BUFTA
 ,ASN,64+12
 ,AEX,K/TEX
 13,U1A,STARTFSM-EFSMNRS
 ,XTA,B48.YCTAHOBKA
 ,ATX,FFPT.ФЛAГA KOHЦA ПЛ
 ,UJ,NRESRET
C
C*****   ПPИKAЗ : . . . "П"
  П/ANAL:,BSS,
  14,UTC,2
  ,XTA,TYPPRT
  ,AEX,BUFTA
  ,AAX,C7777
    ,UZA,PRIOR/PL
  14,VLM,П/ANAL
C
C*****   ПPИKAЗ : <N ШИФPA> "П"
 RT,VJM,ДAЙ ДHЗ
 ,XTA,Ш/FULL
 14,AAX,BITS
   ,UZA,NOTUND
 ,XTA,OPRT
  ,AAX,C7777
 ,ATX,LOWPRT
 ,XTA,OPRT
 ,ASN,64+15
 ,AAX,C7777
 ,ATX,UPRT
 ,XTA,OPRT
 ,ASN,64+30
 ,ATX,SUPRT
 ,ITA,14
 ,AEX,SUPRT.
   ,UZA,NRESRET
 ,ITA,14
 ,AEX,UPRT.
   ,UZA,P1  .
 ,XTA,UPRT.
 ,ATX,LOWPRT.
 P1:,XTA,SUPRT.
 ,ATX,UPRT.
 ,ITA,14
 ,ATX,SUPRT.
 :,24,2003B
 14,VTM,-2
 LPRT:,BSS,
 14,XTA,SUPRT
 ,ATI,RT
 RT,XTA,PRTSTAT-NF
 ,AAX,B3
 ,U1A,LPRTE
 RT,XTA,PRTSTAT-NF
 ,AAX,C77
 RT,AEX,PRTSTAT-NF
 14,AOX,B4
 RT,ATX,PRTSTAT-NF
 LPRTE:,BSS,
 14,VLM,LPRT
 ,XTA,SUPRT
 ,ASN,64-15
 ,AOX,UPRT
 ,ASN,64-15
 ,AOX,LOWPRT
 ,ATX,OPRT
   ,UJ,NRESRET  .
C********
  PRIOR/PL:,BSS,
  ,XTA,BUFTA
  ,ASN,64+12
  ,AEX,Y/TEX
  ,AAX,C77
    ,UZA,TOPRSC
C
C*****   ПPИKAЗЫ : NN"ФП"  NN"БП"  NN"ПП"
  14,XTA,PRIPL/SC+2
  ,ASN,64-6
  14,ATX,PRIPL/SC+2
  ,XTA,ADR8A
  ,AAX,C77
  14,AOX,PRIPL/SC+2
 ,UJ,TOPRSC
C
C*****   ПPИKAЗЫ : "YФП" , "YБП" , "YПП"
  TOPRSC:14,ATX,PRIPL/SC+2
    ,UJ,BЫX
C-----
 ДAЙ ДHЗ:,BSS,
 ,XTA,ADR8A
 ,AAX,C77
 ,NTR,3
 ,X-A,XNW
   ,U1A,NOTUND
 ,ATI,14
 ,XTA,Ш/CЛYЖ
 ,AOX,Ш/FULL
 П ДHЗ:14,AAX,BITS
   ,UZA,NOTUND
 RT,UJ,
C-----
 ПPOB ДHЗ:,BSS,
 ,XTA,Ш/ПOTOK
   ,UJ,ПДHЗ
C
C======================================
C===   B P E M E H A  ,  Д A T Ы   ====
C======================================
C
C*****   ПPИKAЗ : "C"
 ORD*C:,BSS,
 RT,VJM,ДAЙ ДHЗ
 14,XTA,*YCЫ
 ,ATI,J
 ,AAX,B21/16
    ,UZA,IABSENT
 J,VZM,HEЛЬЗЯ
 J,XTA,BISTIME.
 M,VTM,0.
 V,VJM,TIMCOD.KOM.BPEMЯ
 ,XTA,TTEXT.
 ,ARX,SYM/K1.
 ,ATX,TTEXT.
 J,XTA,TIME
 V,VJM,TIMCOD.CЧET.BPEMЯ
 ,XTA,TTEXT+2.
 ,ARX,SYM/C1.
 ,ATX,TTEXT+2.
 J,XTA,MAXTIME
 V,VJM,TIMCOD.ЛИMИT BPEMEHИ
 ,XTA,TTEXT+4
 ,ARX,SYM/Л1
 ,ATX,TTEXT+4
 J,XTA,80.
 ,ATX,TTEXT+6
 J,XTA,81.
 ,ATX,TTEXT+7
 J,XTA,82.
 ,ATX,TTEXT+8
   ,UJ,TOTEL  .
C
C*****   ПPИKAЗ : "T"
 JOBTIME:,BSS,.
 ,XTA,BUF TA.
 ,ASN,64+6.
 ,AAX,C77.
 ,AEX,A/TEX.
 ,UZA,PRI*DAT.ACTPOH. BPEMЯ
 ,XTA,BUF TA.
 ,ASN,64+18.
 ,AEX,POINT.
 ,AAX,C77.
   ,UZA,INTIM  .BBOД BPEMEHИ
 ,XTA,ADR8A.
 ,AAX,C77
   ,UZA,ABSTIME  .
 ,ATI,J.
 ,XTA,JOBSCAL.
 J,AAX,BITS.
   ,UZA,NOT UND  .
 J,WTC,*YCЫ.
  ,XTA,TIME.
 M,VTM,0.ПEЧATЬ
 ,UJ,L/TIM
C
C*****   ПPИKAЗЫ : . . . "D"
  DATAINP:,BSS,
  ,ASN,64+6
 ,UZA,PRI*DAT
 ,AEX,D/TEX
 ,AAX,C77
    ,UIA,FOR*DAT
C
C*****   ПPИKAЗ : "DD"
 14,VTM,-3.ПEPEПИCЬ
 L*DD:14,XTA,DD*D+3
 14,ATX,TTEXT+3
 14,VLM,L*DD
 ,UJ,END/TEL
C
C*****   ПPИKAЗ : ДДMMГГ"D"
 FOR*DAT:,XTA,BUFTA
  ,APX,=:0003 1701 1717 17
  ,ATX,WS
  ,AUX,=6H'3''17''1''17''17''17'
  ,ARX,=6H'''6''''6''6''6'
C
C...  B 1989 ГOДY CЛEД.KOMAHДY ЗAMEHИTЬ !!!
C
  ,AEX,=6H'''''''''16''17'.ГOД.NE.89: ЗAMEHИЛИ
  ,AAX,=6H'''20''''20''377''377'.ИЛИ ЦИФPЫ
    ,U1A,NOTUND  .HE ДECЯTИЧHЫE
  ,XTA,WS
  ,ASN,64+42
    ,UZA,NOTUND  .ЧИCЛO=0
  ,XTA,WS
  ,AAX,=:0076
    ,UZA,NOTUND  .MECЯЦ=0
  ,XTA,WS
  ,AUX,=:077 076.HE БPEДOBЫE
  ,ARX,=:016 032.ЛИ MECЯЦ
  ,AAX,=:100 1  . И ЧИCЛO
    ,U1A,NOTUND
  ,XTA,WS
  ,ASN,64+5
  ,ATX,TODAY
C
C-----   ПEЧATЬ ДATЫ И ACTPOH.BPEMEHИ
  PRI*DAT:,BSS,
 ,XTA,TODAY
  ,ASN,64-5
  ,AUX,=6H'003''017''000''001''017''000'
  ,ARX,=6H00/00/
  ,ATX,TTEXT
  ,XTA,TODAY
  ,ASN,64-16
  ,AUX,=6H'017''017'
  ,ARX,=6H00 T='1'
  ,ATX,TTEXT+1
  ,XTA,ASTIME
  M,VTM,2
    ,UJ,L/TIM
C
C*****   OCOBPEMEHИBAHИE ДATЫ И BPEMEHИ
 COR*DAT:,BSS,
 ,NTR,2
 ,XTA,ASTIME
 ,A-X,DAYEND
 ,U1A,GOODMRG
C-----   ПEPEBAЛИЛИ ЧEPEЗ 00.00 ЧACOB
   :    ,24,2003B
  ,ATX,ASTIME
 V,VJM,PUTTIMER
   :    ,24,3
C
C-----   HAPA 24/11/77   -----
C---  KOPPEKЦИЯ ДATЫ B 'TODAY'
C---     CTPYKTYPA ДATЫ :
C---  ДEHЬ  = B43/42 И B41/38
C---  MECЯЦ = B37 И B36/33
C---  ГOД   = B32/29 И B28/25
C
 ,XTA,TODAY
 ,ATX,WS
C--LAST DAY OF MONTH COMPLEMENT COMPUTATION
 ,AEX,B34.2M
 ,AAX,=:000174.37M
   ,U1A,NOTFEB
C--FEBRUARY
 ,XTA,WS
 ,AAX,B29.20Y
 ,ASN,64+3.29 B 26
 ,AEX,WS
 ,ASN,64-22.26-25 B 48-47
   ,UZA,LEAPYR
C--ADD ONE IF NOT LEAPYEAR
 ,XTA,B38.1D
 LEAPYR:,AEX,B41.10D
   ,UJ ,ENDMON
C--NOT FEBRUARY
 NOTFEB:,AOX,=:00003.6M
 ,ACX,B1 .(37,36,33)+3
 ,AAX,B1
C--ADD ONE IF SHORT MONTH
 ,ASN,64-37.1 B 38 (1D)
 ENDMON:,ARX,=:0036.17D
 ,ARX,WS
 ,ATX,WS1
 ,AAX,B44.100D
   ,UZA,OLDMON
C--CORRECTION FOR END OF MONTH
 ,AEX,WS1
 ,ARX,B33.1M
 ,ATX,WS
 ,ARX,=:00003.6M
 ,ATX,WS1
 ,AAX,=:000074.17M
C--IS THERE CARRY
   ,U1A,OLDMON
 ,XTA,WS1
 ,ATX,WS
 OLDMON:,XTA,WS
 ,ARX,B38.1D
 ,ATX,WS
 ,ARX,=:0014.6D
 ,ATX,WS1
 ,AAX,=:0036.17D
C--IS THERE CARRY
   ,U1A,ENDDAY
 ,UTC,WS1-WS
 ENDDAY:,XTA,WS
 ,ATX,TODAY
C--------
  GOODMRG:,BSS,
  ,XTA,ASTIME
  ,A/X,NUMB+3
  ,NTR,3
  ,A+X,I0
  ,AAX,C3777
  ,ATX,WS.MИHYTЫ
  ,XTA,TODAY
  ,APX,=:0141 0360.ДECЯTKИ
  ,AUX,=006 002 036
  ,ATX,WS1.*2
  ,ASN,64-2.*8
  ,ARX,WS1
  ,ATX,WS1
  ,XTA,TODAY
  ,APX,=:0036 7417.EДИHИЦЫ
  ,AUX,=017 017 017
  ,ARX,WS1
  ,A-X,=104.-1968
  ,ASN,64+18
  ,ATX,WS1
  ,YTA,
  ,ASN,64-13
  ,ATX,WS2.ГOД B 48-44 P.
  ,YTA,
  ,ASN,64-1
  ,AOX,WS1.ЧИCЛO И MECЯЦ
  ,ASN,64-11
  ,AOX,WS
  ,ATX,WS.И MИHYTЫ
  ,XTA,WS2
  ,ASN,64+23
  ,AOX,WS
  ,ATX,TODAY+1
  ,UJ,BEGIN
C
C*****   ПPИKAЗ : "ЧЧ.MMT"
 INTIM:,BSS,.
 ,XTA,.
 ,ATX,NT.
 ,XTA,BUF TA.
 ,ASN,64-12.
 ,ATX,WS2
 14,VTM,-3.
 IT1:,BSS,.
 ,XTA,WS2
 ,ASN,64-6.
 ,ATX,WS2
 ,YTA,.
 ,ATX,SYM.
 ,AEX,POINT.
   ,UZA,IT1  .
 ,XTA,SYM.
 ,NTR,3.
 ,X-A,=31
 ,U1A,NOT UND  .CИMBOЛ > 31
 ,X-A,=11
   ,U1A,NOT UND  .CИMBOЛ < 20
 ,AOX,I0.ПOЛYЧEHA ЦИФPA
 ,NTR,2.
 14,A*X,NUMB+3
 ,A+X,NT.
 ,ATX,NT.
 14,VLM,IT1.
  ,24,2003B
 ,ATX,ASTIME.
 V,VTM,TO STAT
C    YCTAHOBKA CЧETЧИKA BPEMEHИ
 PUTTIMER:,XTA,MASTIME
  V,UZA, .HET
 ,XTA,ASTIME
  ,A*X,=R1.0E6
  ,NTR,3
  ,A+X,I0
  ,AEX,I0
  ,EXT,176B.MЛAДШИE
  ,ASN,64+24
  ,EXT,175B.CTAPШИE
 ,NTR,2
 V,UJ,
 TO STAT:,BSS,
 ,ITA,IB.
 ,ARX,STATIM.ACTPOH.BPEMЯ
 ,UJ,STATIST.B CTATИCTИKY
 STATIM:1,Z00,ASTIME.
 ,Z02,AFTSTA-B.
 AFTSTA:,24,3.
  ,XTA,MASTIME
  ,UZA,PRI*DAT
  ,XTA,BUFTA
  ,APX,= 1717 00 1717 00
  ,ASN,64+24
  ,EXT,177B.TAБЛO
   ,UJ,PRI*DAT
 ABSTIME:,XTA,ABTIME.
 M,VTM,0.
 V,VJM,TIMCOD.ДИCПETЧEPA
 ,XTA,TTEXT.
 ,ARX,SYM/Д1.
 ,ATX,TTEXT.
 ,WTC,*YCЫ+NЖДY
 ,XTA,TIME.
 V,VJM,TIMCOD.BPEMЯ 'ЖДY'
 ,XTA,TTEXT+2.
 ,ARX,SYM/Ж1.
 ,ATX,TTEXT+2.
   ,UJ,TOTEL  .
C
C-----   KOДИPOBKA OДHOГO BPEMEHИ
 L/TIM:V,VTM,TO TEL
C
 TIMCOD:,ATX,NT.
 L,VTM,1-6.
 TC 1:,NTR,2.
 ,XTA,NT.
 L,A/X,5+NUMB.
 ,NTR,3.
 ,A+X,I0.
 ,ATX,SYM.
 ,NTR,2.
 L,A*X,5+NUMB.
 ,X-A,NT.
 ,ATX,NT.
 ,XTA,WS2
 ,ASN,64-4.
 ,AOX,SYM.
 ,ATX,WS2
 L,VLM,TC 1.
 ,ASN,64-24.
 ,AUX,MUT 1.
 ,AOX,MOT 1.
 M,ATX,TTEXT.
 ,XTA,WS2
 ,ASN,64-40.
 ,AUX,MUT 2.
 ,AOX,MOT 2.
 M,ATX,TTEXT+1.
 M,UTM,2.
 ,XTA,.
 M,ATX,TTEXT .
 V,UJ,.
C
C===============================
C===  Д И A Г H O C T И K A  ===
C===============================
C
 NOTUND:,XTA,*ERR1
 ,UJ,TTE1
 IABSENT:,XTA,THET
 ,UJ,TTE1
 HEЛЬЗЯ:,XTA,THEЛЬЗЯ
 ,UJ,TTE1
 O/YES:,XTA,ДEPЗAЙ
 ,UJ,TTE1
 O/KEY:,XTA,TOKEY
 ,UJ,TTE1
C
C=============================
C===  BOЗBPAT  ИЗ  TTANAL  ===
C=============================
C
 NRESRET:,BSS,.
   :   ,24,2003B.
 13,VTM,SELECT
 13,MTJ,33B
 13,VTM,2007B
 13,MTJ,27B
 ,XTA,ADR8A
  SR,MTJ,13
C...  ПPOБA SR : ЧTOБ HE БЫЛ БPEДOB.
  13,UTM,-STARTJOB
  13,VZM,SWINGRET
  13,UTM,STARTJOB-STOP
  13,VZM,SWINGRET
  13,UTM,STOP-ЗAПYCK
  13,VZM,SWINGRET
  13,UTM,ЗAПYCK-R37B
  13,VZM,SWINGRET
  SR,VTM,SELECT
 ,UJ,SWINGRET.
C
C=====   OCHOBHЫE YПP. CИMBOЛЫ
  TABCOM:,BSS,
 ,TEXT,8H/ЛTПC'10'B'33'
 ,TEXT,8HPYAN+OHI
 ,TEXT,8H     БFD
 ,OCT,
C
C=====   ДOПOЛHEHИE K ПPИKAЗAM
  PANNO:,TEXT,8H   PANNO
 CONSOL:,TEXT,8H     REF
 A/TEX:,TEXT,8H       A
 C/TEX:,TEXT,8H       C
 D/TEX:,TEXT,8H       D
 BC/TEX:,TEXT,8H      BC
 S/TEX:,TEXT,8H       S
 П/TEX:,TEXT,8H       П
 Ш/TEX:,TEXT,8H       Ш
 STOP/TEX:,TEXT,8H    STOP
 DOWN/TEX:,TEXT,8H    DOWN
 UP/TEX  :,TEXT,8H      UP
 ALL/TEX :,TEXT,8H     ALL
 PT/STP  :,TEXT,8H      PT
          ,TEXT,8H      MT
          ,TEXT,8H      SC
 LI/STP  :,TEXT,8H    LINK
 K/TEX:,TEXT,8H       K
       ,TEXT,8H       P
 H/TEX:,TEXT,8H       H
  STA/TEX:,TEXT,8H     STA
 ПEP/TEX:,TEXT,8H     ПEP
 M/TEX:,TEXT,8H       M
 И/TEX:,TEXT,8H       И
 Д/TEX:,TEXT,8H       Д
  Y/TEX:,TEXT,8H       Y
 TYPPRT:,TEXT,8H      ФП
        ,TEXT,8H      БП
        ,TEXT,8H      ПП
C
 JOBSCAL:,OCT,0034 2067 774.
 SC DIG:,OCT,0000 0377 6
C......   K-TЫ ПEPEBOДOB BPEMEHИ
 MUT 1:,GOST,6H0  0
 MUT 2:,GOST,6H0  000
 MOT 1:,ISO,6H'1'00.00
 MOT 2:,ISO,6H.00 '1''1'
 SYM/C1:,ISO,6HB''''''''''
 SYM/K1:,ISO,6HJ''''''''''
 SYM/Д1:,ISO,6HЦ''''''''''
 SYM/Л1:,ISO,6H'153'''''''''''
 SYM/Ж1:,ISO,6H'165'''''''''''
  DAYEND:,REAL,86400.
C......   ПOЗИЦИOHHЫE MACKИ
 B48/25:,OCT,7777 7777
 B21/16:,LOG,77 00000
 KPAKYC:,LOG,70 0000 0000 1600.
C......   K-TЫ ПEPEBOДA B-CЛOBA B ISO
 MUP:,GOST,6H077770
 CBN:,ISO,6H 0000'1'
 ,BSS,
C......   PAЗHЫE TL-TEKCTЫ
 *ERR1:,ISO,6H'41''41''41'''''''
 TNR:,ISO,6HГT-00
 TNW:,ISO,6HЗП-00
 THEЛЬЗЯ:,ISO,6HHEЛЬЗЯ
 ДEPЗAЙ:,ISO,6HДEPЗAЙ
 TOKEY:,ISO,6HO'47'KEY
 THET:,ISO,6HHET !
 NOCHECK:,TEXT,8HNO CHE''''
 TПЛOX:,TEXT,8HПЛOXOЙ
 MSK1:,GOST,6H000770.PACПAK. NMФ
C-----   БYФEP PAБOЧИX ЯЧEEK
 WORK:,BSS,LWORK
 TTEXT:,BSS,10
C-----
 ,END,
 NRESLINE:,NAME,
C****************************************
C*    HEPEЗИДEHT  ЭKCTPAKOДA  OБMEHA
C*      C  ФИЗИЧECKИM  TEPMИHAЛOM
C*---------------------------------------
C* ABTOP:ПOПOB M.Ю.           ДYБHA,OИЯИ
C*        AПPEЛЬ-81   MAЙ-83
C*---------------------------------------
C*         O Б P A Щ E H И E
C*           , XTA , CODE
C*           , *61 , - 1
C*
C*    OTBET OT ЭKCTPAKOДA HA CYMMATOPE
C*---------------------------------------
C*
C*   ПOЛЯ CYMMATOPA ПPИ OБPAЩEHИИ
C*   ----------------------------
C*
C*  48/46 - P E З E P B
C*  45/41 - HOMEP KAHAЛA  (J*CH)
C*
C*          З A K A З  H A  P A Б O T Y
C*     40 - PEГEHEPAЦИЯ  (/ECHO)
C*          CИMBOЛA ПPИ ПOCИMB.BBOДE ИЛИ
C*          YПP.CИMBOЛOB HA CTPOKE
C*     39 - PAБOTA БEЗ ЗAKPЫTИЯ
C*  38/38 - P E З E P B
C*  37/33 - HOMEP ПPИKAЗA
C*          00-BЫДAЧA CTPOKИ HA WATANABE
C*          01-ПOCИMBOЛЬHЫЙ BBOД
C*          02-BBOД CTPOKИ C HAЧAЛA
C*          03-BBOД CTPOKИ B ПPOДOЛЖEHИE
C*          04-BЫBOД CTPOKИ
C*          05-ЗAKAЗ HA TAБYЛЯЦИЮ
C*          06-ЗAKAЗ CИMBOЛOB KOHЦA CTPOKИ
C*          07-OПPOC CTATYCA KAHAЛA
C*          10-ЗAKAЗ HA ПPИBЯЗKY
C*          11-OTBЯЗKA KAHAЛA
C*          12-OTBЯЗKA BCEX KAHAЛOB
C*          13-OПEPAЦИЯ *WAIT*
C*          14-ПOДCKAЗKA + BBOД ЗA
C*          15-ПOДCKAЗKA + BBOД C HAЧAЛA
C*          16-ПPИHYД. CHЯTИE ЗAKAЗA
C*          17-ЗAПPOC ШKAЛЫ ПPИB.KAHAЛOB
C           20-ПPИBЯЗKA K BINARY-CTPOЧHИKY
C           21-OБMEH ДBOИЧHOЙ ИHФOPMAЦИEЙ
C*          22-ЗAПPOC XAP-KИ TEPM.KAHAЛA
C*          23-YCTAHOBKA KOOPДИHAT ПO ЭKPAHY
C*          24-ПOДCKAЗKA + BBOД 1 CИM.
C*          25-BЫBOД БEЗ ПEPEKOДИPOBKИ B CIO
C*             (C ФOPMИPOBAHИEM ЧETHOCTИ)
C*
 MAXTY:,EQU,=25.N ПOCЛ.ПPИKAЗA
C*
C*  32/25 - MAX.ПOЗИЦИЯ BBOДA  (MAXPOS)
C*  24/17 - ЧИCЛO CИMBOЛOB  (J*NSYM)
C*  16/01 - ПOЛE ДOП.ИHФOPMAЦИИ  (J*FLD)
C*          ПPИ ПPИKAЗE N10 Э.P. ЗAДAET
C*          B P.P. 10/01 HOMEP PASS USERA,
C*          ПPИ ПPИKAЗE N23
C*          PP.16/09-HOMEP CTPOKИ
C*             08/01-HOMEP ПOЗИЦИИ
C*
C*   ПOЛЯ CYMMATOPA ПPИ BOЗBPATE
C*   ---------------------------
C*
C*  48/46 - P E З E P B
C*  45/41 - HOMEP KAHAЛA  (J*CH)
C*
C*          C T A T Y C  K A H A Л A
C*  40/39 - KOПИЯ ИЗ ЗAKAЗA
C*     38 - ЗAKAЗ EЩE HE OTPAБOTAH
C*     37 - ЗAKAЗ OTPAБOTAH
C*     36 - ПEPEБИBKA HA BЫBOДE
C*     35 - OШИБKA B ЗAKAЗE
C*     34 - ЗAKAЗ HE ПPИHЯT
C*     33 - KAHAЛ HE ПPИBЯЗAH
C*     32 - KOHEЦ ПO "MAXPOS"
C*     31 - KOHEЦ ПO BЫXOДY ЗA CTPOKY
C*     30 - KOHEЦ ПO "CTRL"
C*
C*  24/17 - TEK.ПOЗИЦИЯ KYPCOPA
C*  16/09 - ПOЗИЦИЯ KYPCOPA ПEPEД BBOДOM
C*  08/01 - ПOCЛEДHИЙ CИMBOЛ BBOДA
C*
C*     ПO ПPИKAЗY N22 BЫДAETCЯ
C*
C*  48/46 - P E З E P B
C*  45/36 - HOMEP ПOЛЬЗOBATEЛЯ ПO "TPAS"
C*  35/33 - HOMEP TEPM.ПOДCИCTEMЫ
C*          0 : KAHAЛ HE ПPИBЯЗAH
C*          1 : KOHCOЛЬ OПEPATOPA
C*          2 : MYЛЬTИTAЙП
C*          3 : PEДAKTOP
C*          4 : MOHИTOP П/C
C*  32/19 - OПИCATEЛЬ KAHAЛA (KAK B "CIN")
C*  18/16 - P E З E P B
C*  15/01 - AДPEC ДECKPИПTOPA KAHAЛA
C*
C*-----------------------------------------
C*
C=====   O Б Щ И E   C O M M O N
 *YCЫ:LC,BLOCK,ГYC,RDSCAL(2),COMPIR
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 SMASAV:LC,BLOCK,SAVAC,SAVSR(2),SAVI15(2)
 ,CONT,SAVI13
 WSD:LC,BLOCK,WS1,WS2
 SCALES:LC,BLOCK,(3),STCLTA
 ABTIME:,LC,1
 BPEMЯ:,EQU,542B
C
C=====   ИCПOЛЬЗYEMЫE ЯЧEЙKИ  И П З
 *51:B,BLOCK,M/Ф
  *117:B,BLOCK,PASS
 *140:B,BLOCK,
 140,CONT,J*SAVE(0),J*R1
 141,CONT,J*S15
 142,CONT,J*S32
 143,CONT,J*S27
 144,CONT,J*S11
 145,CONT,J*ACC
 146,CONT,J*STAT
 147,CONT,J*LSYM
  150,CONT,J*FLD.ПOPЯДOK
 151,CONT,J*NSYM
  152,CONT,J*CH.CYЩECTBEH !
C
C=====   П O Д П P O Г P A M M Ы
 RETURN:,SUBP,
 STATIST:,SUBP,
 NEWTA:,SUBP,
 CLANEWTA:,SUBP,
 TTPRINT:,SUBP,
 NRESOFF:,SUBP,
 CLOPIR:,SUBP,
 SETTIMER:,SUBP,
 DELTIMER:,SUBP,
 NR/LINE:,SUBP,
 PUTPIR:,SUBP,
 SET*OUT:,SUBP,
 STRT*DWN:,SUBP,
 RESET*TL:,SUBP,
   NRESLINE:,SUBP,
   NRTABL:,SUBP,
   NLED:,P/P,(NRESLINE)1024
   DESCLED:,EQU,NRTABL+NLED
C
C=====   TEPMИHAЛЬHЫE  COMMON
 *TLSIZE:LC,BLOCK,(1),XNPHCH
 *TLSYS:LC,BLOCK,(2),CHLINER
  *TLSTAT:LC,BLOCK,(9),JLINE(2),SPEC*CH
 *TLBUFI:LC,BLOCK,CIN
 *TLBUFO:LC,BLOCK,COT
 *TLCONST:LC,BLOCK,(1),B48/41(7),MCIN(4)
 ,CONT,Z*CIN(5),B42/19
  *TLPRMT:LC,BLOCK,T*NIX
C
C=====   K O H C T A H T Ы
  C3:,LC,1
 C13:,LC,1
 C37:,LC,1
 C177:,LC,1
 C377:,LC,1
 C1400:,LC,1
 C1777:,LC,1
 DISREG:,LC,1
 C7777:,LC,1
 C77777:,LC,1
  C76000:,LC,1
 B16/1:,LC,1
 FULWOR:,LC,1
C
C=====   Б И T Ы
 *677:B,BLOCK,BITS
  ,CONT,B48,B47,B46,B45,B44,B43
  ,CONT,B42,B41,B40,B39,B38,B37
  ,CONT,B36,B35,B34,B33,B32,B31
  ,CONT,B30,B29,B28,B27,B26,B25
  ,CONT,B24,B23,B22,B21,B20,B19
  ,CONT,B18,B17,B16,B15,B14,B13
  ,CONT,B12,B11,B10,B9,B8,B7
  ,CONT,B6,B5,B4,B3,B2,B1
C
 B40:I,BLOCK,
 40,CONT,/ECHO
 39,CONT,/NOCL
 38,CONT,/BUSY
 37,CONT,/READY
 36,CONT,/BREAK
 35,CONT,INP1BIT
 34,CONT,/INP (0),/DROP
 33,CONT,/NOCON
C
 B32:I,BLOCK,
 32,CONT,/MAX
 31,CONT,/LINE
 30,CONT,/CTRL
 29,CONT,/PROM1
 28,CONT,/PROM2
  27,CONT,NOCIN
  26,CONT,NOCOUT
C
C===   Б Y Ф E P  K A H A Л A   ===
 *0:B,BLOCK,
     ,CONT,(1)    .PAБ.CЛOBO
  ,CONT,NSTR.N STR ПO ЭKPAHY
  ,CONT,IADR.AДPEC HA BBOДE
  ,CONT,OWNER. N PASS ЮЗEPA
     ,CONT,(2)    .P E З E P B
     ,CONT,MAXPOS .MAKC.ПOЗ. BBOДA
     ,CONT,LIPOS  .ПOЗ.KYPCOPA
     ,CONT,MSK    .MACKA CИMBOЛA
     ,CONT,NPOS   .ПOЗИЦИЯ KYPCOPA
     ,CONT,ADR    .TEKYЩИЙ AДPEC
     ,CONT,DSCR   .ДECKPИПTOP KAHAЛA
     ,CONT,PROC   .AДPEC ПPOЦECCA
     ,CONT,CHAR   .CИMBOЛ
  ,CONT,STR(14).CTPOKA
  ,CONT,ZERO.ЧИCTЫЙ HOЛЬ
     ,CONT,CTRL   .CИMB. KOHЦA BBOДA
     ,CONT,TABUL1 .TAБYЛЯTOP 1-40
     ,CONT,TABUL2 .TAБYЛЯTOP 41-80
C
C===   KOHCTAHTЫ TEKTRONIX И WATANABE
 WSTROBE:,EQU,B11 .CTPOБ WATANABE
 CSTROBE:,EQU,B10 .CTPOБ TEKTRONIX
 TBUSY:,EQU,B9 .TEXTRONIX BUSY
 TIMEWX:,EQU,-59 .WATANABE-TIMEOUT
 WXBITS:,EQU,=24000 .^ERR+^BUSY
 TXBITS:,EQU,C1400 .TBUSY+CSTROBE
 WBUSY:,EQU,B12 .WATANABE BUSY
 TSTROBE:,EQU,B9 .CTPOБ TEKTRONIX
 CLRBUSY:,EQU,B10 .CLEAR CBUSY SIGN
 INTBIT:,EQU,B21 .БИT B ПPП
C
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
  SS:,EQU,8
 C:,EQU,9
 N:,EQU,10
 L:,EQU,11
 S:,EQU,12
 F:,EQU,13
 E:,EQU,14
 R:,EQU,15
C
C********************************
C***   ПEPEKЛЮЧATEЛЬ BXOДOB   ***
C********************************
C
 B:13,REL,B
 :,UJ,NRSTART .= NRESCALL
 LINER*NR:,ENTRY,
 :13,UTM,-1.= STRINGER
 ,UJ,INTERRUP
 MUX152B:,ENTRY,
  :13,UTM,-1
  ,UJ,MUX152.= EXTINTER
C
C**********************************
C***   HEPEЗИДEHT  ЭKCTPAKOДA   ***
C**********************************
C
 NRSTART:,BSS,
 ,ITA,13.ПPOCTABИM БAЗY
 ,ARX,B1
  ,AEX,CHLINER
  ,AAX,C77777
 ,AEX,CHLINER.ДЛЯ LINER*TL
 ,ATX,CHLINER
 S A V E:,BSS,
 ,WTC,Г Y C
 15,VTM,J*SAVE
 ,XTA,
 ,XTS,SAVI15
 ,AEX,SAVSR
 ,ITS,32B
 ,ASN,64-15
 ,AEX,SAVI13
 ,ITS,12
 ,ASN,64-15
 ,ITS,27B
 15,AEX,
 ,ITS,11
 ,ASN,64-15
 ,ITS,10
 15,AEX,
 ,ASN,64-15
 ,ITS,9
 15,AEX,
 ,XTS,SAVAC
  ,XTS,.--> J*STAT
  ,XTS,.--> J*LSYM
 ,NTR,3
 ,WTC, Г Y C
 9,VTM,
 9,XTS,J*ACC
  :,24,3
  ,AAX,B16/1.--> J*FLD
  9,XTS,J*ACC
  ,ASN,64+16
  ,AAX,C177.--> J*NSYM
  9,XTS,J*ACC
  ,ASN,64+40
  ,AAX,C37
  15,ATX,.--> J*CH
 ,ATI,10.N Ф-KAHAЛA
 ,A-X,XNPHCH
 ,UZA,HE HAШ
 9,XTA,J*ACC
 ,ASN,64+32
 ,AAX,C37
 ,ATI,14
 ,X-A,MAX TY
 ,U1A,HE HAШ
 14,XTA,B48
 ,AAX,SCFORCON
 ,U1A,FORCON
 10,XTA,CIN
 ,AAX,C77777
 ,ATI,R
 FORCON:,BSS,
  ,UZA,HE HAШ
 9,XTA,J*CH
 14,UJ,SW/JOB
C
C===   ПEPEKЛЮЧATEЛЬ PAБOT   ===
C
 SW/JOB:,BSS,
C---   0 = WATANABE
 :,U1A,HE HAШ
  ,UJ,WATANABE
C---   1 = ПOCИMBOЛЬHЫЙ BBOД
 :,UZA,HE HAШ
 ,UJ,RQINP1
C---   2 = BBOД CTPOKИ
 :,UZA,HE HAШ
 ,UJ,RQINP
C---   3 = BBOД CTPOKИ
 :,UZA,HE HAШ
 ,UJ,RQINPC
C---   4 = BЫBOД CTPOKИ
 :,UZA,HE HAШ
 ,UJ,RQOUT
C---   5 = ЗAKAЗ TAБYЛЯЦИИ
 :,UZA,HE HAШ
 ,UJ,RQTAB
C---   6 = YПPABЛЯЮЩИE CИMBOЛЫ
 :,UZA,HE HAШ
 ,UJ,RQCTRL
C---   7 = OПPOC CTATYCA KAHAЛA
 :,UZA,HE HAШ
 ,UJ,RQSTAT
C---  10 = ПPИBЯЗKA
  :15,VTM,
 ,UJ,REQCONN
C---  11 = OTBЯЗKA KAHAЛA
 :,UZA,HE HAШ
 ,UJ,DISCONN
C---  12 = OTBЯЗKA ПOЛHAЯ
 :11,VTM,1
 ,UJ,KILL ALL
C---  13 = WAIT* ИЛИ ЗAKPЫTИE
 :,24,2003B
 ,UJ,REQWAIT
C---  14 = ПOДCKAЗKA C ПPOДOЛЖEHИEM
 :,UZA,HE HAШ
 ,UJ,RQPROM1
C---  15 = ПOДCKAЗKA C HAЧAЛA
 :,UZA,HE HAШ
 ,UJ,RQPROM2
C---  16 = ПPИHYД. CHЯTИE ЗAKAЗA
 :,24,2003B
 ,UJ,KILL/TA
C---  17 = BЫДAЧA ПPИBЯЗAHHЫX KAHAЛOB
 :11,VTM,
 ,UJ,REQCHAN
C---  20 = ПPИBЯЗKA  BINARY-CTPOЧHИKA
  :,UJ,BINCONN
C---  21 = OБMEH ДBOИЧHOЙ ИHФOPMAЦИEЙ
  :,UZA,HE HAШ
  ,UJ,BINEXCH
C---  22 = BЫДAЧA XAP-KИ ФИЗ.KAHAЛA
 :,24,2003B
 ,UJ,GIV*DSCR
C---  23 = YCTAHOBKA KOOPДИHAT ПO ЭKPAHY
 :9,XTA,J*FLD
 ,UJ,PUT**
C---  24 = ПOДCKAЗKA + BBOД 1 CИM.
 :,UZA,HE HAШ
 ,UJ,RQPROM3
C---  25 = BЫBOД БEЗ ПEPEKOДИPOBKИ B CIO
  :,UZA,HE HAШ
  ,UJ,RQPHOUT
C
C***   ЗAKAЗ : ПPИBЯЗKA BINARY-CTPOЧHИKA
C        1/15 P. CYMM. = ФИЗ.AДPEC БYФEPA
C        CTPOЧHИK - B HAЧAЛE БYФ.ЛИCTA
  BIN CONN:9,WTC,J*ACC
  15,VTM,
C
C***   ЗAKAЗ : ПPИBЯЗKA   ***
 REQCONN:,BSS,
  :,24,2003B
 ,UZA,HE HAШ
 10,XTA,CIN
 ,AAX,C77777
 ,U1A,HE HAШ
  ,ITA,15.CBOЙ БYФEP
  ,U1A,SETREF. - ДA
 ,XTA,POOL
 ,UZA,HE HAШ
 ,ANX,
 ,ATI,14
 ,ASN,64-5
 ,ATI,15
 ,XTA,POOL
 14,AEX,B48-1
 ,ATX,POOL
 15,UTM,BUF0
  10,XTA,B42-1
  ,AOX,CHLINER
  ,ATX,CHLINER
  ,ITA,15
  ,AOX,B34.П/C = "ЭP"
  ,UJ,SETREF1
  SETREF:10,XTA,B48-1
  ,AOX,SPEC*CH
  ,ATX,SPEC*CH
  ,XTA,
  9,ATX,J*FLD.HET PASS
  ,ITA,15
  ,AOX,NOCIN.БЛOKИPOBKA
  ,AOX,NOCOUT.ПEPEKOДИPOBKИ
  SETREF1:10,XTS,CIN
  ,AAX,Z*CIN
  15,AOX,
  10,ATX,CIN
  ,AAX,C76000
  15,ATX,PROC
 ,XTA, Г Y C
 ,AAX,=:77
 15,ATX,DSCR
  9,XTA,J*FLD
  ,AAX,C1777
  ,U1A,*+2
  :9,XTA,PASS
  ,AAX,C1777
  :15,AOX,DSCR
  15,ATX,OWNER
 ,XTA,SETCTRL
 15,ATX,CTRL
 ,XTA,B1
 15,ATX,NPOS
 15,ATX,NSTR
 ,XTA,MSK1
 15,ATX,MSK
 ,XTA,B34
 15,ATX,TABUL1
 ,XTA,B8
 15,ATX,TABUL2
 ,ITA,10
 ,AEX,T*NIX
 ,U1A,CON*DF
 ,XTA,CLRBUSY
 ,EXT,152B
 CON*DF:11,VTM,NRSRET
 ,XTA,=6H>ЭP00''
 ,UJ,TO*DF
C
C***   ЗAKAЗ : OTBЯЗKA   ***
 DISCONN:,BSS,
  12,VJM,CHAN*
 11,VJM,RESPOOL
  11,VTM,
C
C-----   ПPOBEPKИ KOHЦA HEPEЗИДEHTA
  NR*DROP:12,VJM,REQ CH
C-----
  DROP1:9,XTA,J*ACC
  ,U1A,NRSRET
C
C-----   KAHAЛOB Y ЗAДAЧИ БOЛЬШE HET
 ,ITA,13
 ,ARX,SYSRET
 ,UJ,NRESOFF
  CLBAS:,XTA,DESCLED
  ,ASN,64+15.CЧ-K ЗAKAЗOB
  ,AAX,C37.K HEPEЗИДEHTY
  ,U1A,NRSRET
  ,XTA,MSKG+3.B48/17
  ,AAX,CHLINER.ГACИM
  ,ATX,CHLINER. БAЗY
  ,UJ,NRSRET
C
C***   ЗAKAЗ : OTBЯЗKA ПOЛHAЯ   ***
 KILL ALL:,BSS,
 ,XTA,DSCR+BUF0
 ,AEX,ГYC
 ,ASN,64+42.= WATANABE
 ,U1A,NR*DROP.-> HET
 ,ATX,DSCR+BUF0
 ,UJ,NR*DROP
C
C***   ЗAKAЗ : BBOД 1 CИMBOЛA   ***
 RQINP1:12,VJM,CHAN*
 9,XTA,J*ACC
 ,AAX,/ECHO
 9,ATX,J*R1
 ,XTA,INP1 A
 15,ATX,PROC
 ,UJ,SET PROC
C
C***   ЗAKAЗ : BBOД HOBOЙ CTPOKИ   ***
  RQINP:11,VJM,RQBEG*
 ,XTA,MSK1
 R,ATX,MSK
 15,UTC,STR
 14,VTM,
 ,ITA,14
 15,ATX,ADR
 RQINP*:,BSS,
 ,XTA,
 9,ATX,J*R1
 ,XTA,INP A
 15,ATX,PROC
 RQINPT:,BSS,
 ,XTA,
 R,ATX,ZERO
 R,XTA,STR+13
 ,AAX,MSKG+1
 R,ATX,STR+13
 9,XTA,J*FLD
 15,ATX,IADR
 9,XTA,J*ACC
 ,AAX,/ECHO
 ,AOX,/INP
 9,AOX,J*R1
 9,ATX,J*R1
 9,XTA,J*ACC
 ,ASN,64+24
 ,AAX,C177
 15,ATX,MAXPOS
 ,UJ,SETPROC
C
C***   ЗAKAЗ : BBOД CTPOKИ ДAЛЬШE   ***
  RQINPC:11,VJM,RQBEG*
 15,XTA,NPOS
  ,A-X,B1
 ,A*X,C1/6
 ,ATI,14
 ,ASN,64-1
 9,ATX,J*R1
 ,ASN,64-1
 9,ARX,J*R1
 15,X-A,NPOS
 ,ATI,12
 12,XTA,MSK6
 15,ATX,MSK
 R,UTC,STR
 14,UTM,
 ,ITA,14
 15,ATX,ADR
 ,UJ,RQINP*
C
C***  ЗAKAЗ : ПOДCKAЗKA + BBOД 1 CИM.  ***
 RQPROM3:,BSS,
  ,UTC,/PROM1 - B8
C
C***   ЗAKAЗ : BЫBOД БEЗ ПEPEKOДИPOBKИ
  RQPHOUT:,XTA,B8
 9,ATX,J*R1
C
C***   ЗAKAЗ : BЫBOД CTPOKИ   ***
  RQOUT:11,VJM,RQBEG*
 14,VTM,SETPROC
 ROUT1:,XTA,OUT A
 15,ATX,PROC
 ,XTA,MSK1
 15,ATX,MSK
 15,UTC,STR
 11,VTM,
 ,ITA,11
 15,ATX,ADR
  :,24,2003B
 ,UJ,STRT*DWN
C
C***  ЗAKAЗ : ПOДCKAЗKA + BBOД ДAЛЬШE  ***
 RQPROM1:,UTC,/PROM1-/PROM2
C
C***  ЗAKAЗ : ПOДCKAЗKA + HOBЫЙ BBOД  ***
 RQPROM2:,XTA,/PROM2
 9,ATX,J*R1
  11,VJM,RQBEG*
 14,VTM,RQINPT
 ,UJ,ROUT1
C
C***   ПPИHYД. CHЯTИE ЗAKAЗA   ***
 KILL/TA:,BSS,
 R,XTA,DSCR
 ,AAX,/BUSY
 ,UZA,RQSTAT
 R,AEX,DSCR
 ,AOX,/READY.= ГPYБOBATO
 R,ATX,DSCR
 ,XTA,MCIN
 10,AAX,CIN
 10,ATX,CIN
C
C***   ЗAKAЗ : OПPOC CTATYCA KAHAЛA   ***
 RQSTAT:15,XTA,DSCR
 ,AEX,ГYC
 ,AAX,=:77
 ,U1A,HE HAШ.KAHAЛ
 RQSTAT1:,24,3
 15,XTA,DSCR
  ,AAX,/READY
  ,UZA,NRSRET
  15,XTA,DSCR
 ,AAX,=:00034377
 9,AOX,J*STAT
 9,ATX,J*STAT
 15,XTA,NPOS
 ,AAX,C177
 9,ATX,J*NSYM
 15,XTA,DSCR
 ,AAX,/INP
 ,UZA,STATOUT
 15,XTA,LIPOS
 ,ASN,64-8
 9,ATX,J*FLD
C
C-----   ПEPEПИCЬ CTPOKИ ЗAKAЗЧИKY
 11,VTM,1-14
 15,UTC,STR
 12,VTM,.= OTKYДA
 R,WTC,IADR
 14,VTM,.= KYДA
 TRA1:12,XTA,
 9,WTC,J*S27
  :,24,
 14,ATX,
  :,24,3
 ,XTA,
 12,ATX,
 12,UTM,1
 14,UTM,1
 11,VLM,TRA1
 R,ATX,ZERO
C-----
 STATOUT:,BSS,
 15,XTA,CHAR
 ,ASN,64+40
 9,ATX,J*LSYM
 15,XTA,DSCR
 ,AAX,=:77
 15,ATX,DSCR
 ,UJ,NRSRET
C
C***   OЖИДAHИE COБЫTИЙ / ПAYЗA   ***
 REQWAIT:,BSS,
 12,VJM,GI*RDY
 9,XTA,J*ACC
 ,U1A,NRSRET0
  :,24,2003B
 9,XTA,M/Ф
 ,AOX,B17
 9,ATX,M/Ф
  ,XTA,C13
  ,ATI,27B
  ,XTA,=R2.0
  ,*57,13B
  12,VTM,NRSRET0
C
C-----   ПOЛYЧEHИE ШKAЛЫ ГOTOBЫX ЗAKAЗOB
 GI*RDY:,BSS,
 ,24,2003B
 9,XTA,M/Ф
 ,AOX,B17
 ,AEX,B17
 9,ATX,M/Ф
  ,XTA,Д H З
  ,ASN,64-15
  ,CALL, DELTIMER
  ,24,3
  ,WTC,CHLINER.BOCCT.
 13,VTM,-1.БAЗЫ
 ,XTA,
  11,VTM,
  ,UJ,REQCH/R
C
C***  ЗAKAЗ : ДAЙ ШKAЛY ПPИBЯЗAHHЫX  ***
 REQCHAN:,BSS,
 12,VTM,NRSRET0
 REQ CH:,XTA,
  ,UTC,FULWOR-/READY
  REQCH/R:14,VTM,/READY
 9,ATX,J*ACC
 ,XTA,CHLINER
 ,APX,B42/19
 9,ATX,J*CH
  ,UJ,REQCH1
  REF CH:11,VJM,RESPOOL
 REQCH1:9,XTA,J*CH
 12,UZA,
 ,ANX,
 ,ATI,10
 ,YTA,
 10,ASN,64
 9,ATX,J*CH
 10,WTC,CIN
 ,XTA,DSCR
 ,AEX,ГYC
 ,ASN,64+42
 ,U1A,REQCH1
  11,VIM,REF CH.HA OTBЯЗKY
  10,WTC,CIN
  ,XTA,DSCR
  14,AAX,
  ,UZA,REQCH1
  10,XTA,BITS
 9,AOX,J*ACC
 9,ATX,J*ACC
 ,UJ,REQCH1
C
C***  ЗAKAЗ : YCTAHOBKA TAБYЛЯЦИИ  ***
  RQTAB:11,VJM,CHAN*W
 15,ATX,TABUL1
 14,VTM,1
 12,VJM,GETW
 15,ATX,TABUL2
 ,UJ,NRSRET
C
C***  ЗAKAЗ : YCTAHOBKA YПP.CИMBOЛOB  ***
  RQCTRL:11,VJM,CHAN*W
 15,ATX,CTRL
 ,UJ,NRSRET
C
C
C***  ЗAKAЗ : OБMEH ДBOИЧHOЙ ИHФOPMAЦИEЙ
C       16/23 P. CYMMATOPA ЗAДAЮT BPEMЯ
C       OЖИДAHИЯ KOHЦA OБMEHA.
C       HA CTPOЧHИK XOДЯT ПO 13 PEГИCTPY.
C       MOЖHO ПOPTИTЬ: SS,C,L,S.
C       E=БAЗA,  N=AДPEC CIN,  R=<ДECKP.>
C       HA BЫXOДE ИЗ CTPOЧHИKA CYMMATOP =
C         0, ECЛИ HAДO ПPOДOЛЖИTЬ BBOД;
C         7...7, ECЛИ ЗAKOHЧИTЬ OБMEH;
C        CИMBOЛ+B8, ECЛИ HAДO BЫДATЬ CИMBOЛ.
  BINEXCH:12,VJM,CHAN*
  14,VJM,STRT*DWN.ПYCK CTPOЧHИKA
  ,XTA,C13
  ,ATI,27B
  ,XTA,/BUSY
  R,AOX,DSCR
  R,ATX,DSCR
  9,XTA,J*NSYM.TIME
  :,U1A,*+1. - ЗAДAHO
   ,XTA,C77777.MAKCИMYM
  CLOSE:,AOX,=I0
  ,*57,13B
  :,24,3
  ,UJ,KILL/TA
C
C***  ЗAKAЗ : BЫДAЧA XAP-KИ TEPMИHAЛA   ***
 GIV*DSCR:,BSS,
 10,XTA,CIN
  ,ATI,15
  15,V1M,GIVD1
  ,AAX,Z*CIN
  ,UJ,GIVD2
  GIVD1:,BSS,
 ,ARX,B33
 ,AAX,MDS*1
 9,ATX,J*ACC
  ,ASN,64+32
  ,AEX,C3
  ,U1A,GIVDP.HE Э.P.
  ,ITA,15
  ,AEX,CHLINER
  ,AAX,C76000
  ,U1A,NRSRET0
  GIVDP:,BSS,
  15,XTA,OWNER
 ,AAX,C1777
 ,ASN,64-35
 9,AOX,J*ACC
 GIVD2:9,ATX,J*ACC
 ,UJ,NRSRET0
C
C***  ЗAKAЗ : YCT-KA KOOPДИHAT  ***
 PUT**:,BSS,
 ,ASN,64+8
 R,ATX,NSTR
 9,XTA,J*FLD
 ,AAX,C377
 R,ATX,NPOS
 ,UJ,NRSRET0
C
  RQBEG*:12,VTM,GETSTR
C-----   ПPOBEPKA ЗAДAHHOГO KAHAЛA
 CHAN*:15,XTA,DSCR
 ,AEX,ГYC
 ,ASN,64+42
 ,U1A,HEHAШ
 15,XTA,DSCR
 ,AAX,/BUSY
 12,UZA,.KAHAЛ CBOБOДEH
  ,UTC,/DROP -/NOCON. PAHO
 HE HAШ:,XTA,/NOCON
 ,UJ,STAT/RET
C
  CHAN*W:12,VJM,CHAN*
  11,MTJ,12
  14,VTM,0
C-----   "ДAЙ CЛOBO OT MATEMATИKA"
 GETW:,BSS,.READ 1 WORD
 9,WTC,J*FLD
 14,UTM,
 9,WTC,J*S27
  :,24,
 14,XTA,
  :,24,3
 12,UJ,
C
C-----   "ДAЙ CTPOKY OT MATEMATИKA"
 GETSTR:9,XTA,J*NSYM
 ,UZA,GET 3
  10,VTM,0
 GET 1:10,MTJ,14
 10,UTM,1
 12,VJM,GETW
 10,UTC,-1
 15,ATX,STR
 9,XTA,J*NSYM
 ,ARX,=7777 7777 7777 7771.-6
 9,ATX,J*NSYM
 ,U1A,GET 1
 ,ATI,14
 ,AEX,FULWOR
 ,U1A,GET 2
 10,UTM,1
 GET 2:,BSS,
 14,XTA,MSKG+6
 10,UTC,-1
 15,AAX,STR
 10,UTC,-1
 GET 3:15,ATX,STR
  ,XTA,
  9,ATX,J*NSYM
 9,WTC,J*CH
 10,VTM,
 11,UJ,
C
C-----   BOЗBPAT  БYФEPA
 RESPOOL:,BSS,
  :,24,2003B
  10,XTA,CIN
  ,AEX,CHLINER
  ,AAX,C76000.БYФEP ЮЗEPA
  ,U1A,CLCIN. - ДA
 ,NTR,3
 10,XTA,CIN
 ,AAX,C1777
 ,A-X,A/BUF
 ,ASN,64+5
 ,ATI,15
 15,XTA,BITS
 ,AOX,POOL
 ,ATX,POOL
  ,XTA,
  ,UJ,CLCIN1
  CL CIN:,BSS,
  10,XTA,B48-1
  ,AEX,FULWOR
  ,AAX,SPEC*CH
  ,ATX,SPEC*CH
  ,XTA,NOCIN
  ,AOX,NOCOUT
  CLCIN1:,AEX,Z*CIN
 10,AAX,CIN
 10,ATX,CIN
 10,XTA,B42-1
 ,AEX,FULWOR
 ,AAX,CHLINER
 ,ATX,CHLINER
 ,XTA,=6H<ЭP00''
C
C-----   HAЧAЛO/KOHEЦ CEAHCA B DAY-FILE
 TO*DF:,ATX,WS2
  ,XTA,.И B CTATИCTИKY
  ,ATX,531B. ПO TEPMИHAЛAM
 ,XTA,7
 ,AAX,B32
 11,U1A,.-> БЛOKИPOBAH
  ,XTA,Г Y C
  ,AEX,CHLINER
  ,AAX,=:77
  11,U1A,.-> HE Э.P.
 ,ITA,10
 ,ASN,64-42
 ,AUX,=6H'''''''7''7'''
 ,AOX,WS2
 ,ATX,WS2
 ,XTA,BPEMЯ
 ,ATX,WS1
 ,ITA,11
 ,AOX,STA INF
 ,UJ,STATIST
 STA INF:2,Z11,WS1
 ,,
C
C-----   ДOOФOPMЛEHИE  ПPOЦECCA
 SETPROC:,BSS,
 15,XTA,DSCR
 ,AAX,=:77
 9,AOX,J*R1
 ,AOX,/BUSY
 :,24,2003B
 ,AOX,INTBIT
 9,WTC,J*CH
 10,VTM,
 ,XTS,MCIN
 10,AAX,CIN
 10,ATX,CIN
  ,APX,B29.ГAШEHИE "/ECHO"
  ,AUX,/ECHO.ECЛИ ECTЬ
  ,AEX,FULWOR.БЛOKИPOBKA
  15,AAX,.PEГEHEPAЦИИ
  15,ATX,DSCR
 9,XTA,J*CH
 ,AEX,T*NIX
 ,U1A,NOSETX
 14,VJM,STRT*DWN
 NOSETX:,BSS,
 9,XTA,J*ACC
 ,AAX,/NOCL
  ,U1A,RQSTAT1.-БEЗ ЗAKPЫTИЯ
  ,XTA,C13
  ,ATI,27B
  ,XTA,B24
  ,UJ,CLOSE.HA OГPOMHOE BPEMЯ
C
C===   BOЗBPATЫ   ИЗ   HEPEЗИДEHTA   ===
C
 STAT/RET:9,AOX,J*STAT
 9,ATX,J*STAT
C=====
 NRSRET:,BSS,
 9,XTA,J*CH
 ,ASN,64-24
 9,AOX,J*NSYM
 ,ASN,64-16
 9,AOX,J*STAT
 9,AOX,J*FLD
  9,AOX,J*LSYM
 9,ATX,J*ACC
C=====
 NRSRET0:,24,2003B
 9,MTJ,15
 15,XTA,J*S32
 ,ASN,64+15
 ,ATI,33B
 15,XTA,J*S11
 ,ATI,9
 ,ASN,64+15
 ,ATI,10
 ,ASN,64+15
 ,ATI,11
 15,XTA,J*S27
 ,ATI,27B
 ,ASN,64+15
 ,ATI,12
 15,XTA,J*S32
 ,AAX,C77777
 ,ATX,SAVI13
 15,XTA,J*S15
 ,ATX,SAVSR
 ,AAX,C77777
 ,ATX,SAVI15
 15,XTA,J*ACC
 ,ATX,SAVAC
 ,UJ,RETURN
C
C*******************************
C***   П P E P Ы B A H И Я   ***
C***   (BXOД OT STRINGERA)   ***
C*******************************
C
 INTERRUP:,BSS,
 C,MTJ,R.AДPEC БYФEPA
 R,VZM,RESET*C.= HE ПPИBЯЗAH
 R,XTA,DSCR
 ,AAX,/BUSY
 ,UZA,RESET*C.= HET ЗAKAЗA
  R,XTA,PROC
  ,AAX,C76000
  R,WTC,PROC
  F,UZA,
  ,ATI,E. - БAЗA
C
C...   HA CTPOЧHИK ЮЗEPA :
C
  N,XTA,COT.KAHAЛ
  ,U1A,RESET*C.ЗAHЯT
  N,UTM,CIN
  N,XTA,.CTPOKA  C I N
  R,WTC,PROC
  F,VJM,. - П O X O Д
  ,WTC,CHLINER.BOCCT.
  F,VTM,-1.БAЗЫ
  N,UTM,-CIN. И PEГ. N
  ,UZA,RESET*C. - ЭTO BBOД
  ,AEX,FULWOR
  ,UZA,FIN*OP. - CHЯTЬ ЗAKAЗ
  ,AEX,FULWOR
  N,ATX,COT. - ПPOДOЛЖИTЬ
  R,VTM,RESET*TL.   BЫBOД
 ,UJ,SET*OUT
C
C===   ПPOЦECC : BBOД 1 CИMBOЛA   ===
 INP1:,BSS,
 N,XTA,CIN
 ,AAX,B48/41
 ,UZA,RESET
 R,ATX,CHAR
 FIN*IN:,BSS,
 R,XTA,DSCR
 ,AOX,INP1BIT
 ,AOX,/CTRL
 R,ATX,DSCR
 ,AAX,/ECHO
 ,UZA,FIN*OP
 ,XTA,WA*COT A
 R,ATX,PROC
 ECHO:R,XTA,NPOS
 R,ATX,LIPOS
 N,XTA,CIN
 ,AAX,MCIN
 N,ATX,CIN
 S,VTM,B29.ПPИЗHAK "BBOД"
 ,UJ,OUT*SYM
C
C===   ПPOЦECC : BBOД CTPOKИ   ===
 INP:,BSS,
 N,XTA,CIN
 ,AAX,B48/41
 ,UZA,RESET
 R,ATX,CHAR
 ,ASN,64+40
 ,ATI,C
 ,ASN,64+5
 ,U1A,NOTCTRL
 C,XTA,BITS
 R,AAX,CTRL
 ,U1A,FIN*IN
 ,ITA,C
 C,UJ,SW/CHAR
C
C-----   BBOД OБЫЧHЫX CИMBOЛOB
 NOTCTRL:,BSS,
 R,XTA,ADR
 ,ATI,S
 N,XTA,CIN
 R,AUX,MSK
 S,AEX,
 R,AAX,MSK
 S,AEX,
 S,ATX,
C
C-----   ШAГ  ПO  БYФEPY
 STEP/B:,BSS,
 R,XTA,MSK
 ,ASN,64+8
 R,ATX,MSK
 ,U1A,ECHO.PETPAHCЛЯЦИЯ
 R,WTC,ADR
 E,VTM,1.NEXT WORD
 ,XTA,MSK1
 ,UJ,S/ADR
C
C-----   "CTPEЛKA BПPABO"
 RCURS:,BSS,
 R,XTA,ADR
 ,ATI,S
 S,XTA,
 R,AAX,MSK
 ,UZA,RESET*C.ДAЛЬШE HEЛЬЗЯ
 ,UJ,STEP/B
C
C-----   "CTPEЛKA BЛEBO"
 LCURS:R,XTA,NPOS
 ,AEX,B1
 ,UZA,RESET*C.ДAЛЬШE HEЛЬЗЯ
 R,XTA,MSK
 ,ASN,64-8
 R,ATX,MSK
 ,U1A,ECHO
 R,WTC,ADR
 E,VTM,-1
 ,XTA,MSK6
 S/ADR:R,ATX,MSK
 ,ITA,E
 R,ATX,ADR
 ,UJ,ECHO
C
C-----   CTPEЛKA B HAЧAЛO CTPOKИ
 SETBEG:R,UTC,STR
 E,VTM,
 ,XTA,MSK1
 ,UJ,S/ADR
C
C-----   BCTABKA CИMBOЛA
 INSCHAR:,BSS,
 R,XTA,ADR
 ,ATI,S
 C,VTM,STR+14
 R,J+M,C
 S,XTA,
 ,ATX,RR
 ,XTA,
 S,ATX,
 INSC1:C,UTM,-1
 C,XTA,
 ,UZA,INSC2
 ,ASN,64+8
 C,ATX,
 ,YTA,
 C,AOX,+1
 C,ATX,+1
 ,UJ,INSC1
 INSC2:,ITA,C
 R,AEX,ADR
 ,U1A,INSC1
 ,XTA,RR
 S,ATX,
 ,ASN,64+8
 ,YTA,
 C,AOX,+1
 C,ATX,+1
 R,XTA,MSK
 ,AEX,FULWOR
 ,ATX,RR
 R,XTA,STR+13.LAST WORD
 ,AAX,MSKG+1
 R,ATX,STR+13
 S,XTA,
 ,AUX,RR
 ,XTS,BLANK6
 R,AAX,MSK-1.***
 15,AOX,
 S,ATX,
 ,UJ,ECHO
C
C-----   ИCKЛЮЧEHИE CИMBOЛA
 DELCHAR:,BSS,
 R,XTA,ADR
 ,ATI,S
 R,XTA,MSK
 ,AEX,FULWOR
 ,ATX,RR
 S,XTA,
 ,APX,RR
 S,ATX,
 DELC1:S,UTM,1
 S,XTA,
 ,UZA,ECHO
 ,ASN,64-8
 S,ATX,
 ,YTA,
 S,AOX,-1
 S,ATX,-1
 ,UJ,DELC1
C
C===   ПPOЦECC : TAБYЛЯЦИЯ   ===
 TABCH*:,BSS,
  ,XTA,TABCH A
 R,ATX,PROC
 TABCH:,BSS,
 N,XTA,COT
 ,U1A,RESET
 R,XTA,NPOS
 ,ATI,E
 ,NTR,3
 ,A-X,=50 .40 ПOЗ.
 ,U1A,TABCH1
 R,XTA,TABUL2
 E,AAX,B40-40
 ,UJ,TABCH2
 TABCH1:R,XTA,TABUL1
 E,AAX,B40
 TABCH2:,BSS,
 ,UZA,DO TAB
 ,XTA,INP A
 R,ATX,PROC
 DO TAB:R,XTA,ADR
 ,ATI,S
 S,XTA,
 R,APX,MSK
 R,ATX,CHAR
 ,U1A,STEP/B
 ,XTA,B46
 R,ATX,CHAR
 R,AUX,MSK
 S,AOX,
 S,ATX,
 ,UJ,STEP/B
C
C===   ПPOЦECC : BЫBOД ПO KAHAЛY   ===
 OUT:N,XTA,COT
 ,U1A,RESET
 R,WTC,ADR
 E,VTM,1
 E,XTA,-1
 R,APX,MSK
 R,ATX,CHAR
  ,UZA,FIN*OUT
  R,XTA,DSCR
  ,AAX,B8.БEЗ ПEPEKOДИP.
  R,AOX,CHAR
  R,ATX,CHAR
 R,XTA,MSK
 ,ASN,64+8
 ,U1A,OUT1
 ,ITA,E
 R,ATX,ADR
 ,XTA,MSK1
 OUT1:R,ATX,MSK
 S,VTM,0.= "BЫBOД"
 OUT*SYM:,BSS,
 R,XTA,CHAR
 N,ATX,COT
 ,ASN,64+40
 ,ATI,C
  ,YTA,
  ,U1A,PHOUT
 R,XTA,NPOS
 ,ATI,L
 E,VJM,SIMULAT
 ,ITA,L
 R,ATX,NPOS
  PHOUT:,BSS,
 ,ITA,N
 ,AEX,T*NIX
 ,UZA,TXGO
 R,VTM,RESET*TL
  N,XTA,CIN.PEГEHEPAЦИЯ
  S,AAX,.HA BBOДE
 :,UZA,*+2
  ,XTA,
  N,ATX,COT
  :N,XTA,COT
 ,UJ,SET*OUT
 FIN*OUT:,BSS,
 R,XTA,DSCR
 ,AAX,/PROM1
 ,U1A,EPROMT1
 R,XTA,DSCR
 ,AAX,/PROM2
 ,U1A,EPROMT2
 N,XTA,CIN
 ,AAX,B48/41
 ,UZA,FIN*OP
 R,ATX,CHAR
 ,XTA,/BREAK .БЫЛA ПEPEБИBKA
 ,UJ,FIN*OP
C
C-----   ПEPEXOД HA BBOД C HAЧAЛA
 EPROMT2:,BSS,
 ,XTA,MSK1
 R,ATX,MSK
 R,UTC,STR
 E,VTM,
 ,ITA,E
 R,ATX,ADR
C
C-----   ПEPEXOД HA BBOД ДAЛЬШE
 EPROMT1:,BSS,
 R,XTA,DSCR
 ,AAX,/INP
 ,UZA,EPROMT3
 ,XTA,INP A
 R,ATX,PROC
 ,UJ,INP
C
C-----   ПEPEXOД HA BBOД 1 CИM.
 EPROMT3:,BSS,
 R,XTA,DSCR
 ,ASN,64+42
 ,ATI,14
 ,XTA,
 14,WTC,*YCЫ
 ,ATX,J*FLD
 ,XTA,INP1 A
 R,ATX,PROC
 ,UJ,RESET*C
C
C===   ПEPEKЛЮЧATEЛЬ YПP.CИMBOЛOB   ===
C     ( CYM = 0:SIMULAT , 1:BBOД )
C
 SW/CHAR:,BSS,
 :E,UJ, .NULL
 :,UZA,STEP .SOH
 ,UJ,NOTCTRL
 :,UZA,STEP .STX
 ,UJ,NOTCTRL
 :,UZA,STEP .ETX
 ,UJ,NOTCTRL
 :,UZA,STEP .EOT
 ,UJ,NOTCTRL
 :,UZA,STEP
 ,UJ,NOTCTRL.ENQ
 :,UZA,STEP .ACK
 ,UJ,NOTCTRL
 :,UZA,STEP .BELL
 ,UJ,NOTCTRL
 :,UZA,CUR*L .BS
 ,UJ,LCURS
 :,UZA,NEXTLINE .TAB
 ,UJ,TABCH*
 :,UZA,NEXTLINE .LF
 ,UJ,NOTCTRL
 :,UZA,LINE OUT.IL
 ,UJ,NOTCTRL
 :,UZA,HOME.HOME
 ,UJ,NOTCTRL
 :,UZA,STEP .CR
 ,UJ,NOTCTRL
 :,UZA,STEP .SO
 ,UJ,NOTCTRL
 :,UZA,STEP .SI
 ,UJ,NOTCTRL
 :,UZA,STEP .DLE
 ,UJ,NOTCTRL
 :,UZA,STEP .DC1
 ,UJ,NOTCTRL
 :,UZA,STEP .DC2
 ,UJ,NOTCTRL
 :,UZA,STEP .DC3
 ,UJ,NOTCTRL
 :,UZA,STEP .DC4
 ,UJ,NOTCTRL
 :,UZA,STEP .NAK
 ,UJ,NOTCTRL
 :,UZA,STEP .SYN
 ,UJ,NOTCTRL
 :,UZA,SET1 .PRINT
 ,UJ,SETBEG
 :,UZA,STEP .C.RIGHT
 ,UJ,RCURS
 :,UZA,CUR*UP.C.UP
 ,UJ,NOTCTRL
 :,UZA,CUR*DWN.C.DOWN
 ,UJ,NOTCTRL
 :,UZA,STEP .ESC
 ,UJ,NOTCTRL
 :E,UZA,.IC
 ,UJ,INSCHAR
 :E,UZA,.DC
 ,UJ,DELCHAR
 :,UZA,LINE OUT .DL
 ,UJ,NOTCTRL
 :,UZA,HOME.ERASE
 ,UJ,NOTCTRL
C
C===   CИMYЛЯTOP KYPCOPA   ===
C   ( S = 0:BЫBOД  1:BBOД )
 SIMULAT:,ITA,C
  ,ASN,64+5
 C,UZA,SW/CHAR
 ,ITA,C
  ,ARX,B1.KOДЫ,
  ,ASN,64+7.БOЛЬШИE 176,
  E,U1A,.ИГHOPИPYEM
C
C-----   ШAГ  ПO  ЭKPAHY   -----
 STEP:L,UTM,-80
 L,VZM,NEXTLINE
 L,UTM,81
 E,UTC,
 S,VZM,
 R,XTA,NPOS
 R,AEX,MAXPOS
 ,UZA,LIMIT
 E,UJ,
 NEXTLINE:R,XTA,NSTR
 ,AAX,B5
 ,U1A,SET1
 R,UTC,NSTR
 HOME:,XTA,
 ,ARX,B1
 R,ATX,NSTR
 L,VTM,1
 S,V1M,LINE OUT
 E,UJ,
 CUR*DWN:,BSS,
 R,XTA,NSTR
 ,ARX,B1
 R,ATX,NSTR
 ,AEX,C21
 CUR*UP:,U1A,LINE OUT
 R,XTA,NSTR
 ,ARX,C37
 ,AAX,C37
 :,U1A,*+1
 ,XTA,B5
 :R,ATX,NSTR
 LINE OUT:,UTC,/LINE-/MAX
 LIMIT:,XTA,/MAX
 R,AOX,DSCR
 R,ATX,DSCR
 E,UTC,
 S,VZM,
 ,XTA,WA*COT A
 R,ATX,PROC
 E,UJ,
 CUR*L:L,UTM,-1
 L,VZM,PRELINE
 E,UJ,
 PRELINE:L,VTM,80
 S,V1M,CUR*UP
 E,UJ,
 SET1:L,VTM,1
 E,UJ,
C
C===   K O H Ц Ы   П P O Ц E C C O B   ===
C
 WA*COT:N,XTA,COT
 ,U1A,RESET*C
C=====
 FIN*OP:R,AOX,DSCR
 ,AEX,/BUSY
 ,AOX,/READY
 ,AOX,INTBIT
 ,AEX,INTBIT
 R,ATX,DSCR
 ,ASN,64+42
  ,ASN,64-15
  ,CALL,DELTIMER
C
C===   BOЗBPAT ИЗ ПPEPЫBAHИЙ   ===
C
 RESET*C:,XTA,MCIN
 N,AAX,CIN
 N,ATX,CIN
C
 RESET:,ITA,N
 ,AEX,T*NIX
 ,UZA,TXGO
 ,UJ,RESET*TL
C
C********************************
C***   WATANABE , TEKTRONIX   ***
C********************************
C
  W*W:,XTA,DISREG
  ,ATI,27B
  ,AOX,=I0
  ,*57,13B
 WATANABE:,BSS,
  ,XTA,DSCR+BUF0
 ,UZA,WXBEG
 ,AEX,Г Y C
 ,ASN,64+42
 ,UZA,WXDONE
C
C-----   PLOTTER ЗAHЯT
 14,VTM,WXT/1
 10,VJM,TT/PRI
 ,XTA,BITJ
 ,AOX,STCLTA
 ,ATX,STCLTA
  ,UJ,W*W
 WXBEG:,24,2003B
 ,XTA,ГYC
 ,AAX,=:77
 ,ATX,DSCR+BUF0
 9,XTA,J*ACC
 ,AAX,/NOCL
 ,U1A,WXBEG1
 14,VTM,WXT/3
 10,VJM,TT/PRI
 ,XTA,DISREG
 ,ATI,27B
  W/ANSW:,*57,3
  ,XTA,ГYC
  ,ASN,64+15
  ,ASN,64-6
  ,AOX,=4056
  ,AEX,101B
  ,AAX,C7777
  ,U1A,W/ANSW
  ,ATX,101B
 WXBEG1:9,XTA,J*ACC
 ,AAX,/ECHO
 ,U1A,WXDONE
 ,XTA,=6HH'12''0'
 ,ATX,STR+BUF0
 14,VTM,STR+BUF0
 ,ITA,14
 ,ATX,ADR+BUF0
 ,XTA,MSK1
 ,ATX,MSK+BUF0
 11,VJM,WXWRITE
 WXDONE:R,VTM,BUF0
  11,VJM,GETSTR
 ,XTA,MSK1
 R,ATX,MSK
 R,UTC,
 14,VTM,STR
 ,ITA,14
 R,ATX,ADR
 11,VJM,WXWRITE
 ,EXT,4152B
 ,AEX,WXBITS
 ,APX,WXBITS
 ,ASN,64+46
 9,ATX,J*ACC
 ,UJ,NRSRET0
 WXWRITE:,BSS,
 R,VJM,WXCHAR
 10,VTM,TIMEWX
  WXWAIT:,XTA,DISREG
  ,ATI,27B
  ,XTA,=R2.0
  ,*57,13B
 WAITWX:,BSS,
 ,24,2003B
 ,XTA,DSCR+BUF0
 ,AAX,INTBIT
 ,UZA,WXEND
 15,VTM,WXWAIT
 10,VLM,WXGO
 14,VTM,WXT/2
 10,VJM,TT/PRI
 10,VTM,TIMEWX
 ,UJ,WAITWX
C
C-----   Д И A Г H O C T И K A
 TT/PRI:,XTA,ГYC
 ,ASN,64-27
 ,AUX,=6H'''7''7'''''''
 ,AOX,=6HШ00('100')
  14,ATX,
 ,APX,=6H'''7''7'''''''
 ,ASN,64+34
 14,AOX,
 14,ATX,
 ,ITA,14
 10,MTJ,14
 ,UJ,TTPRINT
  WXDRV:,XTA,DSCR+BUF0
  ,AAX,INTBIT
  ,UZA,CLMSK
  15,VTM,RETURN
C
C     ЭTOT БЛOK PAБOTAET OT ПPEPЫBAHИЙ
C     И OT ИMEHИ ПOЛЬЗOBATEЛЯ
 WXCHAR:,24,2003B
 ,WTC,ADR+BUF0
 ,XTA,
 ,APX,MSK+BUF0
 ,ATX,CHAR+BUF0
 ,UZA,WXCH 1
 ,XTA,MSK+BUF0
 ,ASN,64+8
 ,ATX,MSK+BUF0
 ,U1A,WXGO
 ,XTA,MSK1
 ,ATX,MSK+BUF0
 ,XTA,ADR+BUF0
 ,ARX,B1
 ,ATX,ADR+BUF0
 ,UJ,WXGO
 WXCH 1:,XTA,DSCR+BUF0
 ,AOX,INTBIT
 ,AEX,INTBIT
 ,ATX,DSCR+BUF0
 ,ASN,64+42
  ,ASN,64-15
  13,VTM,NEWTA
  ,UJ,DELTIMER
 WXEND:,BSS,
 :,24,3B
 11,UJ,
  WXGO:,XTA,INTBIT
  ,CALL,PERPIR
  ,WTC,CHLINER.BOCCTAHOBИM
  13,VTM,-1.  БAЗ.PEГ.
 ,XTA,INTBIT
 ,AOX,DSCR+BUF0
 ,ATX,DSCR+BUF0
 ,XTA,CHAR+BUF0
 ,ASN,64+40
 ,AOX,WSTROBE
 ,EXT,152B
 15,UJ,
C
C     BXOД ПO ПPEPЫBAHИЮ ИЗ EXTINTER
C
  MUX152:,EXT,4152B
 ,AAX,TXBITS
 ,AEX,TBUSY
 ,U1A,TXDRV
 MAYBEWX:,EXT,4152B
 ,AAX,WBUSY
 ,U1A,WXDRV
 CLMSK:,BSS,
  ,XTA,CIN*TX
 ,AAX,C77777
 ,UZA,CLMSK1
 ,ATI,15
 15,XTA,DSCR
 CLMSK1:,AOX,DSCR+BUF0
 ,AAX,INTBIT
 ,AEX,INTBIT
 ,UZA,RETURN
 13,VTM,RETURN
 ,UJ,CLOPIR
 TXDRV:,XTA,CIN*TX
 ,AAX,C77777
 ,UZA,TXGOGO
 ,ATI,15
 15,XTA,DSCR
 ,AAX,INTBIT
 ,U1A,TXDRV1
  TXGOGO:,XTA,CLRBUSY
 ,EXT,152B
 ,UJ,MAYBEWX
 TXDRV1:,BSS,
 ,EXT,4152B
 ,AAX,CSTROBE
 ,U1A,TXDRV3
 TXDRV2:,EXT,4152B
 ,AAX,TBUSY
 14,VTM,MAYBEWX
 ,U1A,TX/NOCL
  ,XTA,COT*TX
 ,UZA,TX/NOCL
 ,ASN,64-8
  ,ATX,COT*TX
 ,YTA,
 ,AOX,TSTROBE
 ,EXT,152B
 14,UJ,
 TXDRV3:14,VTM,TXDRV2
  ,XTA,CIN*TX
 ,U1A,TX/NOCL
 ,EXT,4152B
 ,ASN,64-40
  ,AOX,CIN*TX
  ,ATX,CIN*TX
 ,XTA,CLRBUSY
 ,EXT,152B
  TX/NOCL:,XTA,B46
  ,AOX,JLINE
  ,ATX,JLINE
  ,XTA,B47
  ,UJ,PUTPIR
C
  TXGO:,XTA,INTBIT
  ,CALL,PERPIR
  ,WTC,CHLINER.BOCCTAHOBИM
  13,VTM,-1.БAЗ.PEГИCTP
 ,EXT,4152B
 ,AAX,TBUSY
 14,VTM,RESET*TL
 ,U1A,TX/NOCL
 ,XTA,TSTROBE
 ,EXT,152B
 14,UJ,
C
C-----   A Д P E C A
 WA*COT A:,,.OЖИДAHИE "COT"
 ,Z00,WA*COT-B
 TABCH A:,,.TAБYЛЯTOP
 ,Z00,TABCH-B
 OUT A:,,.BЫBOД
 ,Z00,OUT-B
 INP1 A:,,.ПOCИMB.BBOД
 ,Z00,INP1-B
 INP A:,,.BBOД
 ,Z00,INP-B
 SYSRET:,Z00,NR/LINE.= NRESOFF
  ,Z00,CLBAS-B
 A/BUF:,,.HAЧAЛO БYФEPOB
 ,Z00,BUF0-B
 NEWTA A:,,
 ,Z00,NEWTA
C
C-----   ШKAЛA CBOБOДHЫX БYФEPOB
 POOL:,OCT,7770.9 KAHAЛOB
C
C-----   ШKAЛA PAБOT БEЗ BЫБOPKИ KAHAЛA
C           (JOB=0,10,12,13,17,20,22)
 SCFORCON:,GOST,6H'200''261''240'000
C
C-----   CTAHД.CИMBOЛЫ OKOHЧAHИЯ BBOДA
C               ( ETX , LF )
 SETCTRL:,GOST,6H'40''100'0000
  CIN*TX:,LOG,
  COT*TX:,LOG,
C
C-----   TEKCTЫ ДИAГHOCTИK
 WXT/1:,ISO,8H
      ,CONT,14HPLOTTER ЗAHЯT'0'
 WXT/2:,ISO,8H
      ,CONT,17HPLOTTER BЫKЛЮЧEH'0'
 WXT/3:,ISO,8H
      ,CONT,18HБYMAГY HA PLOTTER'0'
C
C-----   K O H C T A H T Ы
 MDS*1:,LOG,0000 3777 77777777
 BLANK6:,ISO,6H
 C1/6:,OCT,4002525252525253
 MSK6:,ISO,6H'''''''''''377'
 MSK1:,ISO,6H'377'''''''''''
       :,ISO,6H'''377'''''''''
       :,ISO,6H'''''377'''''''
       :,ISO,6H'''''''377'''''
       :,ISO,6H'''''''''377'''
       :,ISO,6H'''''''''''377'
 MSKG:,ISO,6H'377'''''''''''
      :,ISO,6H'377''377'''''''''
      :,ISO,6H'377''377''377'''''''
      :,ISO,6H'377''377''377''377'''''
 :,ISO,6H'377''377''377''377''377'''
 C21:,LOG,21
 RR:,BSS,1
C
C-----   Б Y Ф E P A
 BUF0:,BSS,32 .CH=0 WATANABE
 :,BSS,288.32*9.CM. POOL
 NR*LWA:,BSS,
 ,END,
 NRES074 :  , NAME ,.01.02.86
C
C*****   HEPEЗИДEHT ЭKCTPAKOДA KOHЦA
C
C-----  И H Ф O P M A Ц И O H H Ы E  П O Л Я
 *ИПД:LC,BLOCK,
 00,CONT,XNF
 01,CONT,XNFM(3)
 04,CONT,XNW(2)
 06,CONT,XNCM(2)
 10,CONT,Ш/CЛYЖ
 11,CONT,Ш/FULL(5)
 16,CONT,*INCOGNI(15)
 35,CONT,LISTFLAG(3)
 40,CONT,BATCH(2)
 42,CONT,ИПЗ/ECTЬ(8)
 52,CONT,OUTJOBSC
 53,CONT,LIMTSC(2)
 55,CONT,БЫЛ*64
 56,CONT,SCOUT(6)
 64,CONT,ERRSC(10)
 76,CONT,БЫЛ*ПФ
 77,CONT,SCENDJO
 NF:,WEQ,XNF
 NFM:,WEQ,XNFM.N ПEPBOЙ ПOЛHOЙ
 NCM:,WEQ,XNCM.KOЛ-BO ПOЛHЫX
 NW :,WEQ,XNW .ДHЗ 'ЖДY'
 NCMM1:,EQU,NCM-1
C-----
 *ИПK:LC,BLOCK,*INFBA
 INFEX:,EQU,*INFBA+NCM
 *ИПK1:LC,BLOCK,PRTSTAT
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
 *YCЫ:LC,BLOCK,ГYC,RDSCAL(2),COMPIR(5)
 ,CONT,AЦПY(2)
 YC/ЖДY:,EQU,*YCЫ+NW
C
C-----   ИCПOЛЬЗYEMOE  B  И П З
 CPTIME:,EQU,-1
 TMATH:,EQU,30B
 REGSCAL:,EQU,100B
 BISTIME:,EQU,110B
 T LIM:,EQU,111B
 AUS:,EQU,117B
 NAME:,EQU,120B
 SCEM:,EQU,123B
 S/S32:,EQU,125B
 LPSTR:,EQU,126B
 W/POST:,EQU,135B
 LOMIDZSC:,EQU,162B
 *507:B,BLOCK,CB(2),KB(2)
 ИП PEД:,EQU,1000B
 M/END:,EQU,11.= ПO 'ИП PEД'
 *566:B,BLOCK,ФИO(3),STAT1
 ,CONT,STAT2(2),STAT3,STAT4
  ,CONT,ФИO/ISO(2)
C
C-----   O Б Щ И E  M A C C И B Ы
 WSD:LC,BLOCK,WSD1
 SMASAV:LC,BLOCK,(1),SAVSR
 SCALES:LC,BLOCK,(3),STCLTA
 TPHYS:,LC,1
 POST:LC,BLOCK,TNPBOX
 PLAN/IS:,LC,1
 ЧИCЛOCП:,LC,1
 NY:,EQU,13
 YCTP:,LC,1
 CONTIME:LC,BLOCK,(10),TCB
 REWINDSC:LC,BLOCK,(3),CHBOSS(4)
 ADOFACC:LC,BLOCK,(1),NFSM,JFSM(2)
 БAЗAПPИЗ:LC,BLOCK,(7),ЗBЗAHЯTA(19)
 *SWCMN:LC,BLOCK,(4),OPRT
  LISTSTRA:,LC,1
 KOHHИЗ:,LC,
 LNRT:,P/P,(KOHHИЗ) 1024
C
C-----   П O Д П P O Г P A M M Ы
 CLOMIR:,SUBP,
 CLOPIR:,SUBP,
 SELECT  :  ,SUBP,
 STATIST:,SUBP,
 DECLET:,SUBP,
 TTPRINT :  ,SUBP,
 NRTABL   :  , SUBP ,
 NRESCALL:,SUBP,
 NRESOFF:,SUBP,
 NR/64:,SUBP,
 NRES064:,SUBP,
 *WRBF64:,SUBP,
 *CБPOC64:,SUBP,
 NR/LINE:,SUBP,
 NRL*P:,P/P,(NR/LINE) 1024
 TBCП    :  , SUBP ,
 ЛTBCП:,P/P,(TBCП)1024
 HЛTBCП:,P*P,(ЛTBCП)1024
 HTBCП:,EQU,TBCП-HЛTBCП
C
C-----   Д Y Б H E H C K И E  C B Я З И
 INF7CH:LC,BLOCK,NЗAД,W110,NЗCB,W107
 ,CONT,(6),FBACK,(1),FLACT70
 *LINKPAR:LC,BLOCK,(1),SC/CONC
  BNR7CH :,LC,1
  SCCLJ  :,LC,1
 R37BR:,SUBP,
 NRES7CH:,SUBP,
  PCBЯЗЬ :,P/P,(NRES7CH)1024
  ACBЯЗЬ :,P*P,(PCBЯЗЬ )1024
 ALBUF:,EQU,435B
 SCMUJ:,EQU,1755B
C
C-----   TEPMИHAЛЬHOE  XOЗЯЙCTBO
 NPAБЛИCT:,LC,1
  *TLSIZE:LC,BLOCK,(1),XNPC(2),XNSS
  NPC:,WEQ,XNPC
 NSS:,WEQ,XNSS
  NPC1:,EQU,NPC-1
  NSS1:,EQU,NSS-1
  *TLSYS:LC,BLOCK,STATSS,STATMT
  INITSS:,EQU,STATSS+NSS
  TIMESS:,EQU,INITSS+NSS
 *TLBUFI:LC,BLOCK,CIN
 *TLCONST:LC,BLOCK,(12),ZCIN(5),B42/19
 *SCAL71:LC,BLOCK,(5),SCB71
C
C-----   B P E M E H A , Д A T Ы
  *542:B,BLOCK,BPEMЯ
 *770:B,BLOCK,DDDATE
 ABTIME:LC,BLOCK,DT
 OT:,LC,2
 TODAY:,LC,1.ДATA
C
C-----   C T A T И C T И K A
 *540:B,BLOCK,MDRU,ADRU
 *USESTA:LC,BLOCK,ИMЯMЛ,HAЧЗOH
 LIST:,EQU,2000B
  KOЗA:,EQU,LIST+1018.ЗAПYCKИ
 P*MD:,EQU,LIST+1019
 P*MT:,EQU,LIST+1020
C
C-----   C O M M O N - K O H C T A H T Ы
 C5:,LC,1
 C7:,LC,1
  C13:,LC,1
 C37:,LC,1
 C77:,LC,1
 C177:,LC,1
 C377:,LC,1
 C1777:,LC,1
  C77777:,LC,1
 B24/1:,LC,1
 MASK12:LC,BLOCK,B48/37
 FULWOR:,LC,1
C
C-----   Б И T Ы :
 *677:B,BLOCK,BITS
 ,CONT,B48,B47,B46,B45,B44,B43
 ,CONT,B42,B41,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33,B32,B31
 ,CONT,B30,B29,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21,B20,B19
 ,CONT,B18,B17,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B9,B8,B7
 ,CONT,B6,B5,B4,B3,B2,B1
 SK*O:,EQU,B43
C
C-----   P A Б O Ч И E  Я Ч E Й K И
 PAБЯЧ:,EQU,*B-72
 PAБЯЧ:I,BLOCK,/S32,/PAY,/И15(7),/И8
 ,CONT,/И7(6),/И1
 ,CONT,DAT0(4),H(20)
 ,CONT,IW(3),TIM,T1,T2
 ,CONT,/OUTSC,ПCЛYЖ
  ,CONT,TEL(4),S(0),TELNA(11)
  P1:,P/P,(IW)1024
 P2:,P*P,(P1)1024
 EX:,EQU,IW-P2
C
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 NJ:,EQU,2
 IP:,EQU,3
 J4:,EQU,4
 B:,EQU,5
C*
C*******************************
C*    H A П O M И H A H И E    *
C*                             *
C*   YCTAHABЛИBATЬ 27 PEГИCTP  *
C*     ПEPEД ЭKCTPAKOДAMИ      *
C*******************************
C*
C-----   Б A З И P O B A H И E
 *B:B,REL,*
C
C-----   ПOДГOTOBKA PEГИCTPOB K ПEЧATИ
 ,WTC,ГYC
  IP,VTM,
 ,WTC,ДHЗ
 NJ,VTM,
  IP,XTA,S/S32
  ,NTR,3
 ,ASN,64+15
 ,ATX,/S32
 ,XTA,SAVSR
 ,ASN,64+41
 ,ATX,/PAY
 14,VTM,-14
 SAVIR:IP,UTC,
 14,XTA,25B
 14,ATX,/И15+14
 14,VLM,SAVIR
C
C-----   CHЯTИE OCTAHOBOB ПO AЧ , NK
 ,XTA,
 IP,ATX,SCEM
  IP,ATX,26B
  IP,ATX,27B
  :,VTMS,2002B
  ,ATI,34B
  ,ATI,35B
  :,VTMS,3
C
C-----   OЖИДAHИE KOHЦA OБMEHOB
 15,VTM,2000B
C
 ПPOB KO:14,VTM,13B
  14,MTJ,27B
 ,ITA,15
 ,FUN,200B
 ,AEX,B1.  ЛИCT
 ,UIA,П KO.= HE B OБMEHE
  :,VTMS,2000B
 15,XTA,1
 П KO:,VTMS,3
 15,UTM,2000B
 15,VIM,ПPOB KO
C
C-----   HA BCЯKИЙ CЛYЧAЙ ДOЗAKAЖEM
C           ЛИCTЫ : 01 , 40-47
  14,VTM,13B
  14,MTJ,27B
  13,VTM,LISTSTRA
  ,*72,ЗAK ЛИ
C
C-----   OЖИДAHИE ЗABEPШEHИЯ B WL1 :
C
  CHWL:13,XTA,
  ,UZA,ECHWL
  ,AEX,ГYC
  ,AAX,=:77
  13,UTM,1
  ,U1A,CHWL
  13,VTM,LISTSTRA
  14,VTM,13B
  14,MTJ,27B
  ,*57,3
  :,24,3
  ,UJ,CHWL
  ECHWL:,BSS,
C
C-----   OTKAЗ  OT  CП Д-68
 ,XTA,NRTABL+ЛTBCП
 ,ASN,64-10
 ,ATI,13
 15,VTM,-287
 CL SP:13,UTM,1
 ,XTA,ЧИCЛOCП
 ,UZA,F*TXT
 13,XTA,HTBCП
 ,ASN,64+42
 ,AEX,ДHЗ
 ,UIA,SP NO
 13,ATX,HTBCП
  :,VTMS,2003B
 ,XTA,ЧИCЛOCП
 ,A-X,B1
 ,ATX,ЧИCЛOCП
  :,VTMS,3
 SP NO:15,VLM,CL SP
C
C=====   ПOДГOTOBKA TEKCTOB ДЛЯ ПEЧATИ
C
 F*TXT:,BSS,
C-----   Д A T A , H O M E P  Э B M
 15,VTM,DAT0
 ,XTA,/T41
 ,XTS,/T42
 ,XTS,TODAY
 ,ASN,64-5
 ,AUX,/UM2
 ,AOX,/T5.ЧИCЛO , MECЯЦ
 ,XTS,TODAY
 ,ASN,64-16
 ,AUX,/UM3
 ,AOX,/T6.ГOД
 ,XTS,7
 ,ASN,64+33
 ,AAX,C7
 ,ASN,64-24
 ,AOX,/T7.N ЭBM C TP7
 ,XTS,Ш/CЛYЖ
 ,AAX,BITJ
 ,ATX,П CЛYЖ
 :,UZA,*+1
 ,UTC,/T02-/T01
 :,XTA,/T01.CДBИГ TEKCTA
 ,XTS,TTE2
 ,ATX,TEL
 ,ATX,TEL+2
 ,ATX,TEL+3
C-----   CTPOKA  "KOHEЦ ЗAДAЧИ"
 14,VTM,TEXEND
 13,VTM,-3
 PR1:13,XTA,БЫЛ*64
 ,AAX,BITJ
 ,U1A,PR2
 14,UTM,2
 13,VLM,PR1
 PR2:14,XTA,
 14,XTS,1.TИП KOHЦA (1,2)
 ,XTS,/T1.2 ПPOБEЛA
 ,XTS,/T31.ПOKA TИП CЛYЖ.
 ,XTS,ГYC.
 ,ASN,64-27
 ,AUX,S34/7
 ,AOX,/T2
 15,ATX,.ШИФP
 13,UTM,3
 ,AEX,/T21
 ,ATX,TEL+1.= "KШ.."
 ,XTA,ERRSC
 ,AAX,BITJ
 ,UZA,PR21
 ,XTA,SK*O
 ,AEX,TEL+1
 ,ATX,TEL+1.= "OШ.."
 13,VTM,
 PR 21:,XTA,П CЛYЖ
 ,U1A,CЛYЖ*1
 ,ITA,13
 ,ASN,64-45
 IP,AOX,STAT1
 IP,ATX,STAT1
 13,VTM,
 NJ,XTA,*INFBA-NFM
 ,AAX,B30/25
 ,U1A,PR3
  13,VTM,1
  NJ,XTA,*INFBA-NFM
  ,AAX,B19
  ,U1A,PR3
 13,VTM,2
 PR3:13,XTA,/T3
 ,ATX,H+5.TИП ЗAДAЧИ
 ,ITA,13
 ,ASN,64-45
 IP,AOX,STAT2
 IP,ATX,STAT2
C-----
 ,XTA,/T32.BЫ/BB.
 NJ,XTS,*INFBA-NFM
 ,ASN,64-12.N BЫ,N BB
 ,AUX,S1234
 ,AOX,/T33
 ,XTS,/T35.OTДEЛ=
 IP,XTS,AUS.
 ,AUX,/UM1
 ,AOX,/T4
 IP,XTS,ФИO  . Ф И O (1)
 IP,XTS,ФИO+1. Ф И O (2)
 ,XTS,
 CЛYЖ*1:,BSS,
 ,XTA,/END
 ,XTS,/END+1
 ,XTS,/END+2
 ,XTS,/END+3
 ,XTS,DDDATE  .ДEHЬ И MECЯЦ
 ,AEX,/TC1    .ГEHEPAЦИИ DD
 ,XTS,DDDATE+1.ГOД И N BEPCИИ
 ,AEX,/TC2    .      DD
 ,XTS,/END+4.OCTATOK
 IP,XTS,REGSCAL.ЗBEЗДOЧEK
 ,AAX,B16.
 ,AOX,П CЛYЖ.БEЗ ЛИCTOBAHИЯ
 :,U1A,*+1.ПOCЛEДHИЙ
 ,UTC,1.ПPOГOH БYMAГИ
 :,XTA,/END+5.HE ДEЛAEM
 ,XTS,БЫЛ*64  .CTEK CCФOPMИPOBAH
 ,AOX,SC OUT
 ,AEX,SC OUT
 ,AAX,BITJ
 ,UZA,ДOCБPOC
C
C-----   ПEЧATЬ PEГИCTPOB И BPEMEH
 ,XTA,OUTJOBSC
 ,ATX,/OUTSC
 ,AAX,ZBITJ
 ,ATX,OUTJOBSC
 ,XTA,B8
 IP,AAX,REGSCAL
 IP,AEX,REGSCAL
 IP,ATX,REGSCAL
 13,VTM,TRA
 ,PRINT,IPRH
 ,PRINT,IPREG1
 13,UTM,TR7-TRA
 ,PRINT,IPRH
 ,PRINT,IPREG2
 ,*50,71B
 ,XTA,П CЛYЖ
 ,U1A,CЛYЖ*2
 15,VTM,TEL+2
 IP,XTA,KB
 ,AEX,/T22
 IP,XTS,KB+1
 ,AEX,/T23.= KOM.BPEMЯ
C
C ---- ПOДГOTOBKA И ЗAПИCЬ ИTOГOBOГO
C      COOБЩEHИЯ B DAYFILE
 ,XTS,TDF1.= "KOHEЦ "
 IP,XTS,CB
 ,AEX,/M1
 IP,XTS,CB+1
 ,AEX,/M12.= CЧET.BPEMЯ
 IP,XTS,KB
 ,AEX,/M2
 IP,XTS,KB+1
 ,AEX,/M12.= KOM.BPEMЯ
  NJ,XTS,*INFBA-NFM
  13,VTM,0."CB"
  ,AAX,=7000 0000.KAHAЛЫ CBЯЗИ
  ,U1A,PR31
  13,VTM,1."MT"
  NJ,XTA,*INFBA-NFM
  ,AAX,B21
  ,UZA,PR31
  13,VTM,2."OП"
  PR31:13,XTA,TDF2
 15,ATX,
 15,MTJ,12
 13,VJM,G*LPS
  :,VTMS,2003B
 15,CALL,DECLET
  :,VTMS,3
 ,ASN,64-16.= <БYMAГA>
 ,AOX,=6H''''''''.
 12,MTJ,15
 IP,XTS,ФИO/ISO
 IP,XTS,ФИO/ISO+1.= <ФAMИЛИЯ>
 IP,XTS,AUS
 ,AUX,/M3
 ,AOX,TDF3.= N ПO "TPAS"
 ,XTS,
 15,ATX,
 NJ,XTA,*INFBA-NFM
 ,ASN,64-1.ПPOЧИCTKA
 ,ASN,64+1.ПPИЗHAKA
 NJ,ATX,*INFBA-NFM. ' П P T '
 15,VTM,S
 ,ITA,15
 ,AOX,=7770 0000 7760 0000
 ,*72,4.B DAYFILE
C
C-----   ЗABEPШAЮЩAЯ ПEЧATЬ
 CЛYЖ*2:,BSS,
 13,VTM,DAT0
 ,PRINT,IPRH
 ,XTA,/OUTSC
 ,ATX,OUTJOBSC
 ДOCБPOC:,BSS,
 ,XTA,БЫЛ*64
 ,AOX,БЫЛ*ПФ
 ,AAX,LISTFLAG
 ,AOX,SC OUT
 ,AEX,SC OUT
 ,AAX,BITJ
 ,UZA,HECБPOC
  ,AAX,БЫЛ*ПФ
  :,U1A,*+1
  IP,UTC,REGSCAL
  :,XTA,
  ,AAX,B7
  ,U1A,HECБPOC
  ,ITA,B
  ,ARX,INM64
  ,UJ,NRESCALL
  INM64:,Z00,NR/64
  ,Z00,AFTWRBF-*B
 AFTWRBF:,WTC,ГYC
 15,VTM,ИП PEД
  ,ATI,7
  7,UTC,-NRES064
  13,VJM,*WRBF64
 ,XTA,FULWOR
 15,ATX,M/END
  7,UTM,*WRBF64-NRES064
  7,UTC,*CБPOC64-*WRBF64
  13,VJM,
 HECБPOC:,BSS,
 ,XTA,П CЛYЖ
 ,U1A,CЛYЖ*21
 NJ,XTA,*INFBA-NFM
 ,ASN,64+24
 ,AAX,C77
 ,UZA,CЛYЖ*21.HE C Ф.BBOДA
 ,ASN,64-4
 ,ATI,13
 ,XTA,RCATI
 ,*57,7
 ,XTA,B48
 :,24,
 13,AOX,LIST-16
 13,ATX,LIST-16
 :,24,3
 14,VTM,2013B
 14,MTJ,27B
 ,XTA,WCATI
 ,*57,7
 CЛYЖ*21:,BSS,
C
C-----   ПOДЧИCTKИ ПO CBЯЗЯM
 ,XTA,NЗCB
 ,AEX,ДHЗ
 ,UIA,NOTASK70
 ,ATX,NЗCB
 ,ATX,W107
 NOTASK70:,XTA,NЗAД
 ,AEX,ДHЗ
 ,U1A,NOLINK
 ,ATX,NЗAД
 ,ATX,W110
 ,ATX,TCB
 ,XTA,C377
 ,CALL,CLOPIR
  ,XTA,SCCLJ
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  ,XTA,
  ,ATX,SCCLJ
 ,XTA,B31
 ,AOX,B25
 13,VJM,CLOMIR
 NOLINK:,BSS,
 15,VTM,-1.ДЛЯ "OTKAЦП"
C
C-----   OCBOБOЖДEHИE ЗAДAЧИ BBOДA
 ,XTA,ЗBЗAHЯTA
 ,AEX,ДHЗ
 ,U1A,*+2
 :,*60,.OTKAЗ OT ЧИTAЛKИ
 ,000,.
C
C-----   OCBOБOЖДEHИE FS-1500
 :,VTMS,2003B
 ,XTA,JFSM
 ,AEX,ДHЗ
 ,U1A,OTK AЦП
 ,ATX,JFSM
 ,WTC,NFSM
 ,EXT,10B
 ,WTC,NFSM
 ,XTA,B42
 ,CALL,CLOMIR
C
C-----   OCBOБOЖДEHИE PEAЛЬHЫX AЦПY
 OTK AЦП:,XTA,ДHЗ
  ,ASN,64-36
  15,AEX,AЦПY+1
  ,AAX,=:0077
  ,UIA,NAЦП
  15,XTA,AЦПY+1
  ,AAX,=7700 7777 7777 7777
  15,ATX,AЦПY+1
  NAЦП:15,VLM,OTK AЦП
 14,VTM,13B
 14,MTJ,27B
C
C-----   OTKAЗ OT BETBЛEHИЯ
  ,FUN,51B
C
C-----   OTKAЗ OT OПEPATИBHOЙ ПAMЯTИ
C        (CПEЦ.34-ЛИCT Y MYЛЬTИTAЙПA)
 ,XTA,STATMT
 ,ASN,64+42
 ,AEX,ДHЗ
 :,U1A,*+1
 IP,ATX,TMATH+34B
 :,*72,OTKAЗ ЛИ
 ,XTA,ПCЛYЖ
 :,U1A,*+1
C
C-----   OTKAЗ OT ПAMЯTИ HA MБ
 ,*72,OTKAЗ MБ
C
C-----   OTKAЗ OT ИCПOЛЬЗOBAHHЫX MЛ
 :,XTA,FULWOR
 ,*57,4000B
C
C-----   ДEMOHOПOЛИЗAЦИЯ HAПPABЛEHИЙ KBY
 :,VTMS,2003B
  14,VTM,-3
 REFKBY:14,XTA,CHBOSS+3
 ,ASN,64+24
 ,AEX,ДHЗ
 ,AAX,C77
 :,U1A,*+1
 14,ATX,CHBOSS+3
 :14,VLM,REFKBY
C
C.....   OTKAЗ OT MД
  ,XTA,OTKAЗ MД
  ,*57,-1
C
C.....   OTKAЗ OT NRESLINE
 ,XTA,NRTABL+NRL*P
 ,AAX,C37
 ,UZA,NRL/NO
 ,XTA,OTKAЗNRL
 ,*61,-1
C
C.....   OTKAЗ OT 71 ЭK
 NRL/NO:,XTA,SCB71
 ,AAX,BITJ
 ,UZA,NRT/NO
 ,*71,OTKAЗ*71
 NRT/NO:,BSS,
C
C-----   OTKAЗ OT ФAЙЛOBЫX CИCTEM
  ,XTA,C13
  IP,ATX,W/POST+4
  FSLOOP:,24,3
  14,VTM,2013B
  14,MTJ,27B
  IP,XTA,LOMIDZSC
  ,ASN,64-33
  ,UZA,REFPOST
  ,ANX,C77777
  ,ATI,12
  ,ASN,64-36
  ,AOX,=0070 0010 0470 0000
  ,*52,2
  :12,XTA,B15
  IP,AEX,LOMIDZSC
  IP,ATX,LOMIDZSC
  ,UJ,FSLOOP
C.....   OTKAЗ OT ПOЧTOBOГO ЯЩИKA
  REFPOST:NJ,XTA,TNPBOX-NF
  ,UZA,LOG TIM
  ,XTA,C5
  ,ASN,64-15
  ,*52,2
C
C=====   CTATИCTИKA ПO ПOЛЬЗOBATEЛЯM
 LOG TIM:,BSS,
  ,XTA,7
  ,AAX,B30
  ,UZA,DEV/REF.-> БЛOKИPOBAHA
 ,XTA,ADRU.
 ,UZA,DEV/REF.-> HE BEДETCЯ
 ,ASN,64-36
 ,AUX,=770077
 ,AOX,=:001401
 ,ATX,IW.
 ,AEX,B40
 ,ATX,IW+1
   :   ,24,2003B
 ,XTA,B48
 IP,ATX,TMATH+1
 IP,AOX,REGSCAL
 IP,ATX,REGSCAL
 ,XTA,B22
 IP,AOX,TMATH+8
 IP,ATX,TMATH+8
 ,MOD,30B
 ,ATI,
   :   ,VTMS,2000B.
 ,XTA,2000B.
 TI1:,24,2003B
 ,XTA,MDRU
 ,UZA,TI3
 ,AEX,ДHЗ
 ,UZA,TI2
 ,*57,3
 ,UJ,TI1
 TI3:,XTA,ДHЗ
 ,ATX,MDRU
 TI2:,*50,67B
 :,24,3
 ,ATX,T1
 ,XTA,IW
 ,DRUM,
 :,24,
 ,XTA,P*MD
 ,ATI,12
 ,XTA,LIST
 :,24,2003B
 ,AEX,CODE
 ,UZA,ST/IS
 13,VTM,-1019
 14,VTM,ДAT
 ,ITA,14
 14,VJM,TTPRINT
 :,24,
 ,XTA,
 CLST:13,ATX,LIST+1023
 13,VLM,CLST
 12,VTM,LIST
 :,24,3
 ,XTA,CODE
 13,VJM,WRITW
 13,VJM,WRITD
 ,WTC,POINT0
 12,VTM,
 ST/IS:12,MTJ,11
 ,XTA,П CЛYЖ
 ,U1A,CЛYЖ*3
 IP,XTA,AUS
 ,AAX,C1777
 ,UZA,CЛYЖ*3.HET PASS
 IP,XTA,AUS
 ,ASN,64+36
 ,UZA,CЛYЖ*3.HET OTДEЛA
 14,VTM,-2
 TRN:14,UTC,2
 IP,XTA,NAME
 13,VJM,WRITW
 14,VLM,TRN
 13,VJM,WRITD
 IP,XTA,CPTIME
 ,A+X,=R.5
 ,NTR,3
 ,A+X,=I0
 ,ATX,T2.
C.....  ПPOДBИЖKA CЧETЧИKA ЗAПYCKOB :
  ,XTA,B1
  :,24,
  ,ARX,KOЗA
  ,ATX,KOЗA
 ,VTMS,3
 ,XTA,LIMT SC
 ,AAX,BITJ
 ,UZA,TI21.
 ,UTC,TLIM-BISTIME
 TI21:IP,XTA,BISTIME
 ,A+X,=R.5
 ,A+X,=I0
 ,ASN,64-19
 ,AOX,T2
 ,ASN,64-10
 ,ATX,T2
 ,XTA,LISTFLAG
 ,AAX,BITJ
 ,UZA,TI23.PEAЛЬHЫЙ BЫBOД
C  ECTЬ ЛИ *LIST OUT
C  ИЛИ HET EГO - BCE PABHO ПPO AЦПY MOЛЧИM.
 ,XTA,
 IP,ATX,STAT2.BЫBOД ПK,ПЛ
 ,UJ,*NPUP*
 TI23:,BSS,
 13,VTM,*NPUP*
 G*LPS:IP,XTA,LPSTR
 ,AAX,B24/1
 ,NTR,3
 ,A*X,C1/72
 ,AAX,C1777
 13,UZA,
 ,ARX,B1
 13,UJ,
  *NPUP*:,BSS,
 ,AOX,T2
 13,VJM,WRITW
 ,NTR,2
 14,VTM,-5
 IP,XTA,AUS
 IP,ATX,STAT3
 TRE:14,UTC,STAT4
 IP,XTA,
 13,VJM,WRITW
 14,VLM,TRE
 12,UTC,-1
 11,VTM,
 CЛYЖ*3:,BSS,
 12,VTM,LIST+2
 ,XTA,BPEMЯ
 13,VJM,WRITW
 ,XTA,TODAY
  10,VTM,2570B.БЫЛO:2170
 13,VJM,WRITW
 12,VTM,LIST+1021
 14,VTM,1
 13,VJM,WRITD
 ,WTC,YC/ЖДY
 ,XTA,-1
 13,VJM,TWRIT
 14,VTM,
 ,XTA,DT
 13,VJM,TWRIT
 ,ITA,11
 ,NTR,3
 ,A-X,LIMITP
 ,U1A,CБPOCMБ
 SE*MT:,24,3
  13,VTM,30B
 ,XTA,ИMЯMЛ
 14,VTM,13B
 14,MTJ,27B
 10,*57,
 ,ATX,TIM
 ,ITA,11
 ,AEX,MAXP
 ,U1A,CБPOCMБ
 ,XTA,TIM
 ,UZA,HET MЛ
 ,ASN,64+45
 ,UZA,ECTЬ MЛ
 HET MЛ:,BSS,
 ,*57,3
 10,VTM,2570B
 ,UJ,SE*MT
 TWRIT:,ATX,TIM
 14,A-X,OT
 ,ATX,T2
 ,XTA,TIM
 14,ATX,OT
 ,XTA,T2
 :,24,
 12,A+X,
 WRITW:,24,
 12,ATX,
 :,24,3
 ,UJ,RET*
 WRITD:,XTA,T1
 ,UJ,WRITW
 EX TAP:,24,3
 ,ITA,12
 ,ASN,64+4
 ,U1A,OVERFL
 ,ITA,12
 14,ARX,
 14,VTM,10B
 14,MTJ,27B
 ,TAPE,
 RET*:12,UTM,1
 13,UJ,
 ECTЬ MЛ:,24,
 ,XTA,P*MT
 :,24,3
 ,ATI,12
 ,U1A,MЛ 2
 ,WTC,HAЧЗOH
 12,VTM,
 ,DRUM,EX+1
 MЛ 1:14,VTM,INFTR
 13,VJM,EX TAP
  :,24,
 ,XTA,LIST
 ,24,3
 ,AEX,CODE
 ,UZA,MЛ 1
 12,UTM,-1
 ,DRUM,EX
  MЛ 2:,24,3
 14,VTM,INFTW
 ,WTC,POINT0
 11,VTM,
 13,VJM,EX TAP
 ,ITA,12
 ,ATX,P*MT
  CБPOC MБ:,24,3
  ,ITA,11
  ,AEX,POINT0
  ,U1A,HE ПYCT
C.....  OБHYЛEHИE BCEX KBAHTOB
C       CTATИCTИKИ HA БYФEPHOM
C       TPAKTE :
 :,VTMS,
 14,VTM,-1013
 CL/KV:14,ATX,LIST+1017
 14,VLM,CL/KV
 ,UJ,HE ПYCT
C
C-----   ПEPEПOЛHEHИE ПOЛЬЗ.CTATИCTИKИ
 OVERFL:,BSS,
 ,XTA,П CЛYЖ
 ,U1A,HE ПYCT
 14,VTM,DIAGN
 ,ITA,14
 :,24,2003B
 14,VJM,TTPRINT
  HE ПYCT:,24,
  ,ITA,11
 ,ATX,P*MD
  14,VTM,2013B
  14,MTJ,27B
 ,DRUM,EX+1
   :   ,24,2000B
 ,XTA,LIST
   :   ,24,2003B
 IP,XTA,TMATH+1
 ,ASN,64+30
 ,AAX,C177
 ,ATI,14
 ,XTA,
 14,ATX,TPHYS
 ,ATX,MDRU.
 ,XTA,=:4000 02
 ,*57,4000B.OTKAЗ OT MЛ-30
C
C-----   OTKAЗ OT ЗAXBAЧEHHЫX YCTPOЙCTB
 DEV/REF:,24,3
 J4,VTM,NY
 DR1:J4,XTA,YCTP-1
  ,ASN,64+42
 ,AEX,ДHЗ
  ,U1A,DR2
  J4,ATX,YCTP-1
  J4,ATX,CONTIME-1
 DR2:J4,UTM,-1
  J4,VIM,DR1
C
C-----   OTKAЗ OT HEPEЗИДEHTOB
  12,VTM,LNRT
  14,VTM,R*NRS
  ,ITA,14
  ,ATX,IW
 R*NRS:,VTMS,3
  ,ATI,
 :,VTMS,2003B
  12,XTA,NRTABL
  ,AAX,C37
  ,UZA,RN 3
  ,ASN,64-10.AДPEC NR-ЛИCTA
  ,ATI,13
  13,XTA,
  ,ATI,14.ЧИCЛO HEPEЗИД.
 RN 1:14,UTC,
  13,XTA,
 NJ,AAX,BITS-15
  ,UZA,RN 2
  ,ITA,12
  ,ASN,64-10
  ,ATI,15
  14,J+M,15
  ,ITA,15
  ,ASN,64-24
  ,AOX,IW
  ,UJ,NRESOFF
  RN 2:14,UTM,-1
  14,VIM,RN 1
 RN 3:12,UTM,-1
  12,VIM,R*NRS
C
C-----   ЧИCTKA БAЗЫ HEPEЗИДEHTA CBЯЗИ
  ,XTA,NRTABL+PCBЯЗЬ
  ,AAX,C37
  ,UZA,CL*7C
  ,ASN,64-10
  ,ATI,13
  13,XTA,NRES7CH-ACBЯЗЬ
  ,ASN,64+15
  ,UZA,CL*7C
 ,XTA,BNR7CH
 CL*7C:,ATX,BNR7CH
 14,VTM,-2
C
C-----   ДOФOPMИPOBAHИE TT-COOБЩEHИЯ
 ,XTA,П CЛYЖ
 ,U1A,TR NAME
 NJ,XTA,*INFBA-NFM
 ,ASN,64-12.N BЫ,N BB
 ,AUX,S1234
 ,AOX,TTE1
 ,ATX,TEL
 ,AEX,TTE1
 ,U1A,TRNAME
 ,XTA,TTE2
 ,ATX,TEL
 TRNAME:14,UTC,2. ПEPEПИCЬ
 IP,XTA,NAME.NAME ЗAДAЧИ
 14,ATX,TELNA+2.
 14,VLM,TRNAME....
 ,XTA,
 ,ATX,TELNA+3
   :   ,24,2003B
 ,XTA,ПCЛYЖ
 ,U1A,CЛYЖ*4
 NJ,XTA,*INFBA-NFM
 ,ASN,64+16
 ,AAX,SC/CONC
 ,UZA,CL*IB.HE KOHЦ-P
 ,XTA,TELNA
 ,ASN,64+16
 ,AEX,TDF2
 ,AAX,C377
 ,ATI,12
 ,UZA,RUNJOB
 ,XTA,TELNA
 ,AEX,S/MUJ
 ,ASN,64-24
 ,UIA,CL*IB
  ,XTA,TELNA+1
  ,ASN,64+16
  ,APX,MASKN
  ,ASN,64+44
  ,ATI,13
 RUNJOB:,BSS,
 ,XTA,NЗCB
 ,UZA,CL*IB.HET TASK70
 ,XTA,ALBUF
 ,UZA,CL*IB.HET БYФEPA
 ,XTA,ERRSC
 ,APX,BITJ
 ,ASN,64+47
 ,ARX,C5
 ,ATX,WL1.ФЛAГ OШ.
 ,WTC,ALBUF
 14,VTM,
 12,VZM,RUNJ1
 ,XTA,
 ,ATX,WL
 15,VTM,LMUJ
  13,UTC,-1
 14,XTA,SCMUJ
 ,UZA,CL*IB
  LMUJ:13,UTC,-1
  14,XTA,SCMUJ
 ,UZA,ACT70
 ,ANX,WL
 ,ATX,WL
 ,ATI,12
  12,UTM,-1
 ,YTA,
  13,UTC,-1
 14,ATX,SCMUJ
 WERUN:14,J+M,12.ALBUF+NT
 ,XTA,
 12,ATX,20B
 ,XTA,WL1
  12,ATX,1760B.EOJ
 15,UJ,
 RUNJ1:,XTA,TELNA
 ,APX,MASKN
 ,ASN,64+44
 ,ATI,12
 15,VJM,WERUN
 ACT70:,BSS,
 ,XTA,W107
 ,UIA,CL*IB
 ,XTA,NЗAД
 ,UIA,TOFL70
 ,XTA,COMPIR
 ,AAX,SC/CONC
 ,UZA,TOFL70
 ,XTA,COMPIR
 ,AAX,=7777 7777 7777 7400
 ,ATX,COMPIR
 ,033,34B
 ,XTA,B1
 ,ATX,W110
 ,ATX,FBACK
 ,XTA,NЗCB
 ,ATX,NЗAД
 15,VTM,CL*IB
 ,UJ,R37BR
 TOFL70:,AEX,NЗCB
 ,UZA,CL*IB
 ,XTA,B1
 ,ATX,FLACT70
 CL*IB:,BSS,
 ,XTA,
 NJ,ATX,*INFBA-NFM
 NJ,ATX,INFEX-NFM
 14,VTM,
 ,ITA,NJ
 ,ASN,64-30
 ,AEX,OPRT
 ,ASN,64+30
 ,UZA,RP1.SUPRT
 14,VTM,-1
 ,ITA,NJ
  ,ASN,64-15
  ,AEX,OPRT
  ,ASN,64+15
  ,AAX,C77777
  ,UZA,RP1.UPRT
  14,VTM,-2.ПPOЧИE
 RP1:NJ,XTA,PRTSTAT-NF
 ,AAX,C77
 NJ,AEX,PRTSTAT-NF
 14,AOX,B4
 NJ,ATX,PRTSTAT-NF
 IP,XTA,CPTIME
 :,24,2003B
 ,NTR,3
 ,A+X,=I0
 ,ASN,64-20
 ,ATX,WSD1
 IP,XTA,BISTIME
 ,A+X,=I0
 ,AOX,WSD1
 ,ASN,64-8
 ,AOX,ДHЗ
 ,ATX,WSD1
 ,ITA,B
 ,ARX,INFSTA.
 ,UJ,STATIST.
 INFSTA:1,Z00,WSD1
 ,Z04,RET-*B
 CЛYЖ*4:,BSS,
C
C-----   OCBOБOЖДEHИE TEPMИHAЛЬHЫX KAHAЛOB
C        ПPИ CБOE ПOДCИCTEMЫ
  12,VTM,-NSS1+1.ПO ПOДCИCTEMAM
  14,VTM,-NPC1.ПO ФИЗ.KAHAЛAM
  CH/SS:12,XTA,STATSS+NSS1
  ,ASN,64+42
  ,AEX,Д H З
  ,U1A,ECH/SS
  12,UTC,NSS1.OTBЯЗKY KAHAЛOB
  15,VTM,-2. PEДAKTOPA
  15,VZM,EDITOR.CДEЛAЛ ЭKCTPAKOД
  12,ATX,TIMESS+NSS1. =0
  15,UTM,1.MYЛЬTИTAЙП
  15,V1M,CH/PC. - HET
  ,ATX,NPAБЛИCT
  ,ATX,531B.METKA TEPM.CTAT.
  CH/PC:12,XTA,STATSS+NSS1
  14,AAX,B42+NPC1
  ,UZA,ECH/PC
  12,AEX,STATSS+NSS1
  12,ATX,STATSS+NSS1
  ,XTA,ZCIN
  14,AAX,CIN+NPC
  14,ATX,CIN+NPC
  ECH/PC:14,VLM,CH/PC
  EDITOR:,BSS,
  ,XTA,Z48/43
  12,AAX,STATSS+NSS1
  12,ATX,STATSS+NSS1
  ,XTA,B48/37
  12,AAX,INITSS+NSS1
  12,ATX,INITSS+NSS1
 ,UJ,RET
  ECH/SS:12,VLM,CH/SS
  ,XTA,PLAN/IS
 ,AEX,ДHЗ
 ,AAX,C77
 ,U1A,RET
 ,ATX,PLAN/IS
 ,ATX,BATCH
 RET:,XTA,PLAN/IS
 ,UZA,CH*TT
 ,AOX,B48
 ,ATX,PLAN/IS
 CH*TT:,24,3.= OKOШKO =
 ,ATI,
 :,24,2003B.=========
 ,XTA,OUTJOBSC
 ,AOX,ERRSC
 ,AEX,FULWOR
 ,AAX,*INCOGNI
 ,AAX,BITJ
 ,U1A,NO TT
 ,XTA,TELNA
 ,UZA,NO TT
 14,VTM,TEL.TEKCT O KOHЦE
            ,  ITA  , 14            .HA TT-ПEЧATЬ
          14,  VJM  , TTPRINT       .KOHEЦ Ш2
 NO TT:,BSS,
C
C-----   ПPOЧИCTKA HOMEPA ШИФPA
 ,XTA,ГYC
 ,AAX,K04536
 ,ATX,ГYC
C
C-----   ПPOЧИCTKA ШKAЛ OT БИTA ЗAДAЧИ
 15,VTM,OUTJOBSC-SCENDJO
 CL SC:,XTA,ZBITJ
 15,AAX,SCENDJO
 15,ATX,SCENDJO
 15,VLM,CL SC
C
C-----   OCBOБOЖДEHИE 0-ГO MAT.ЛИCTA
 ,ITA,B
 ,ASN,64+10
 ,ATI,15
 ,XTA,
 15,ATX,TPHYS
C
C-----   OCBOБOЖДEHИE ЛИCTA ИПЗ
 ,XTA,Ш/FULL
 ,AAX,BITJ
 ,UZA,CLRDSC
 ,ITA,IP
 ,ASN,64+10
 ,ATI,15
 ,XTA,ZBITJ
 ,AAX,ИПЗ/ECTЬ
 ,ATX,ИПЗ/ECTЬ
 ,XTA,ГYC
 ,AAX,Z15/1
 ,ATX,ГYC
 ,XTA,
 15,ATX,TPHYS
C
C-----   HAC ИЗ ШKAЛЫ ГOTOBЫX
  CLRDSC:,BSS,
 ,XTA,ГYC
 NJ,ATX,*YCЫ
 ,XTA,RDSCAL.
 ,AAX,ZBITJ
  ,AOX,STCLTA
 ,ATX,RDSCAL.
 ,XTA,.
  ,ATX,STCLTA
C
C=====   И HA BЫБOP ДPYГИX
C        (БOЛEE ДOCTOЙHЫX)
C
 ,UJ,SELECT
 WL :,BSS,1.
 WL1:,BSS,1.
 S/MUJ:,ISO,6H''''''-MU
 IPRH:13,,
 13,,
 :0,,
 8,,
 IPREG1:B,Z00,/S32-*B
  B,Z00,/И8-*B
 :2,003,5
 0,,
 :2,011,3
 0,,
 :2,015,5
 8,006,7
 IPREG2: B,Z00,/И7-*B
  B,Z00,/И1-*B
 :2,023,5
 8,006,6
 RCATI:9,,
 ,,LIST
 WCATI:10,,
 ,,LIST
 DIAGN:,ISO,24HПEPEПOЛHEHA ПOЛЬЗ.CT-KA''
 TEXEND:,BSS,
 ,GOST,12HЗAДAЧA CHЯTA
 ,GOST,12HИCTEK. BPEMЯ
 ,GOST,12HЛИMИT БYMAГИ
 ,GOST,12HKOHEЦ ЗAДAЧИ
 /T01:,GOST,6H    '200'1
 /T02:,GOST,6H    '200''24'
 /T1:,GOST,6H '265''' '265'''
 /T2:,GOST,6HШ-00
 /T21:,GOST,6H'163''160'PPB.
 /T22:,GOST,6HЛГ'24'PPA
 /T23:,GOST,6HPPAPPB
 /T3:,GOST,6HПOTOK
     ,GOST,6HTEPM.
     ,GOST,6HBBOД
 /T31:,GOST,6HCЛYЖ.
 /T32:,GOST,6HBЫ/BB=
 /T33:,GOST,6H0000
 /T35:,GOST,6HOTДEЛ=
 /T4:,GOST,6H000 -
 /T41:,GOST,6H'212'   '200''47'
 /T42:,GOST,6H ДATA=
 /T5 :,GOST,6H00/00/
 /T6 :,GOST,6H00  ЭB
 /T7 :,GOST,6HM-0'214''214'
 /UM1:,GOST,6H   000
 /UM2:,GOST,6H3 01 0
 /UM3:,GOST,6H  0000
 /END:0,GOST,6H'214''214' *'265''20'
 1,GOST,9HOC ДYБHA
 ,CONT,4H1.04
 ,CONT,5H  OT
 4,GOST,6H'265''17''214' *'265'
 5,GOST,6H'75''214''265''12'.'231'
 6,GOST,6H'75''214'.'231'
 /TC1:,GOST,6HPPГPPГ.MACKИ ПEPEBOДA
 /TC2:,GOST,6HPPПFP*.  ISO B GOST
 TRA:,BSS,
 ,GOST,9H'201''136''200''76''136''214'
 ,CONT,6HAДPEC
 ,CONT,4HPAY
 ,CONT,6H*И15*
 ,CONT,6H*И14*
 ,CONT,6H*И13*
 ,CONT,6H*И12*
 ,CONT,6H*И11*
 ,CONT,6H*И10*
 ,CONT,6H*И9**
 ,CONT,6H*И8**'231'
 TR7:,GOST,6H    '200''23'
 ,CONT,6H*И7**
 ,CONT,6H*И6**
 ,CONT,6H*И5**
 ,CONT,6H*И4**
 ,CONT,6H*И3**
 ,CONT,6H*И2**
 ,CONT,6H*И1**'231'
 ДAT:,ISO,12HДATA'46'BPEMЯ'77'''
 TTE1:,ISO,6H0000-'1'
 TTE2:,GOST,6H111111
 S1234:,GOST,6H777700
 S34/7:,GOST,6H007700
 B30/25:,LOG,77 0000 0000
 Z15/1 :,LOG,7777 7777 7770 0000
 Z48/43:,LOG,0077 7777 7777 7777
 K04536  :  ,LOG, 77000000 00077777
 MASKN:,GOST,6H000017
 TDF1:,ISO,6HKOHEЦ
  TDF2:,ISO,18HCB  Л=MT  Л=OП  Л=
 TDF3:,ISO,6H (000)
 /M1 :,GOST,6H'162''140'ИPPA
 /M2 :,GOST,6H'141''140'ИPPA
 /M3 :,GOST,6H00   0
 /M12:,GOST,6HPPAPPП
C.........
 CODE:,TEXT,8HOC ДYБHA
 POINT0:,LOG,2004
 LIMITP:,LOG,2016
 MAXP  :,LOG,3754
 INFTR:,LOG,10 0100 0030 0000
 INFTW:,LOG,00 0100 0030 0000
 C1/72:,LOG,40001616 16161617
 ЗAK ЛИ:,OCT,11 01 7647 77
 OTKAЗ ЛИ:,OCT,00 4147 77
 OTKAЗ MБ:,OCT,41 77777777
 OTKAЗ MД:,OCT,6470 7240 406
 OTKAЗ*71:,OCT,00777777
 OTKAЗNRL:,GOST,6H0'12'0000
 ,END,
 DD71:,NAME,.
C
C              HAЧAЛO PAБOTЫ - 13.03.1971 Г.
C
C
C              ПPOMEЖYTOЧHЫЙ ФИHИШ  -  10.06.1971 Г.
C
 'PEДAKЦИЯ OT 30.05.73'
 'PEДAKЦИЯ OT 25.06.78'
 'PEДAKЦИЯ OT 01.04.81'
 '
C-----
 *ИПД:LC,BLOCK,(4),XNЖДY
 ,CONT,XNC,XNCM,XNSEM
  ,CONT,(8),XLFATA,XLTDIS,XLTPH
  ,CONT,(4),XLQTRA,XLQTIM
  *ПДИCK:,LC,
  LTDR1:,WEQ,*ПДИCK
  LTDR:,EQU,LTDR1+16
 NЖДY:,WEQ,XNЖДY
 NC  :,WEQ,XNC
 NCM :,WEQ,XNCM
 NSEM:,WEQ,XNSEM
 LFAT:,WEQ,XLFATA
 LTPH:,WEQ,XLTPH
  LTDIS:,WEQ,XLTDIS
  NC*2:,P*P,(NC)2
  NC*3:,P*P,(NC)3
 NCM*3:,P*P,(NCM) 3
  LQTRA:,WEQ,XLQTRA
  LQT*2:,P*P,(LQTRA)2
  LQTIM:,WEQ,XLQTIM
  LQT1:,EQU,LQTIM+1
 *TLSIZE:LC,BLOCK,XMTR,XPCH,XCON,XSS
 LMTR:,WEQ,XMTR
 NPCH:,WEQ,XPCH
 NCON:,WEQ,XCON
 NSS:,WEQ,XSS
 NCON*LB:,P*P,(NCON)36
 NSS3:,P*P,(NSS)3
C-----
  EXCHNRS:,SUBP,
 MAINBLCS:,SUBP,.
C
C              ЗAKAЗЫ HA PACПPEДEЛEHИE ПAMЯTИ
C
C---------------------------------------
C   ФИKCИPOBAHO OTHOCИTEЛЬHOE ПOЛOЖEHИE:
C     S M A S A V  ПOCЛE  * Y C Ы
C     C M D R E C  ПOCЛE  T A B L E M T
C     B L S T O U T  ПEPEД  S T A T I S T
C     OT  * П Д И C K   ДO   * T L P R M T
C     OT     Д H З      ДO      O T
C     (ДЛЯ TAPEPRNT B БCЗ)
C---------------------------------------
  TPHYS:,LC,128
 ШЛAГБAYM:,LC,NSEM
  TABDRU:,LC,LTDR
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,(2),M1RDSC,STCLTA.
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR
 ,CONT,SAVS16
  Д H З :,LC,3
 ABTIME:,LC,2
 TODAY:,LC,2
 OT:,LC,2
 STARTJOB:,SUBP,.
 MACRO64:,SUBP,.
  *PR/COM:,SUBP,
 CHEKMDFL:,LC,2.
 OUTCW:,LC,2.
 TABLEMT:LC,BLOCK,.
  ,CONT,T1M(16),T1(32),T2M(16),T2(32),TNM(16),TANAMEMT(32)
 C MD REC:LC,BLOCK,SC MDR(5),(1)
 *STATBUF:,LC,1.
 BLSTOUT:,LC,3.
 STATIST:,SUBP,.
 KOHTPOЛЬ:,SUBP,.
  PUT TMP:,SUBP,
C
C...   OЧEPEДЬ БYДИЛЬHИKOB
C      (CM. MACRONEW)
C
  QUETIM:,LC,LQT1
  MACRONEW:,SUBP,
C
  MACRO72:,SUBP,
  MACRO73:,SUBP,
  STATUSMT:LC,BLOCK,(1),OLD(4),(29)
 SCDICH:,SUBP,
 TRABUS:,LC,1.
 TRACNT:,LC,1.
 FULQUESC:,LC,1.
  REWINDSC:,LC,10
 WANTCHAN:,LC,1.
 IW70:,LC,1.
 CWJFOTRA:,LC,1.
 CONTIME:LC,BLOCK,(12),TMTEC
 ,CONT,FOMAMБ
 MAЛOMБ:,SUBP,
  NFRITR:,LC,1
  COPYTR1:,LC,1
 YCTP:,LC,13
 WSD:LC,BLOCK,WS0D,WS2,FULLRD
 FULWOR:,LC,1.
 C3:,LC,1.
 C5:,LC,1.
 C7:,LC,1.
 C13:,LC,1.
 C14:,LC,1.
 C37:,LC,1.
 C77:,LC,1.
 C177:,LC,1.
 C377:,LC,1.
  C777:,LC,1
 C1400:,LC,1.
 C1777:,LC,1.
 C2003:,LC,1.
 DISREG:LC,BLOCK,C2013
 C3777:,LC,1.
C.....   12-PAЗPЯДHЫE MACKИ :
  MASK12:,LC,3
 C7777:,LC,1.
 C76000:,LC,1.
 C77357:,LC,1.
 C77777:,LC,1.
 B16/1:,LC,1.
 B24/1:,LC,1.
 B48/31:,LC,1.
 B30/16:,LC,1.
 C2004:,LC,1
  B48/47:,LC,1
  Z28/21:,LC,1
  *C:LC,BLOCK,C6(2),C574,C176000
  *CB:LC,BLOCK,B48/44,C17,Z25/7
  ,CONT,B36/31,B48/13,B13/2
 MSTART:,LC,1.
 NSTAJOB:,LC,1.
 EXTINTER:,SUBP,.
 INTER:,SUBP,.
 PERMIR:,SUBP,.
 CLOMIR:,SUBP,.
 INTINTER:,SUBP,.
 ENTFOLIC:,SUBP,.
  K COCEДY:,SUBP,
 DISPBASE:LC,BLOCK,(1),DISMBASE
 ,CONT,(2)
  ,CONT,DISPFIL,DISPNAM
  ,CONT,DSHIFT
 OPERTERM:,SUBP,
 *SWCMN:,LC,1
  LISTSTRA:,LC,LQT*2
 DRIDENT:,LC,2
 SCALSTRA:,LC,63
 ПPOBMЛ:,SUBP,
  RECMDT:,SUBP,
 BUFTRA:,LC,37
  COMPUT16:,LC,3
 ДOПYПP:,LC,11
 NRESCALL:,SUBP,.
  FLMAMБ:,LC,1
 CIO*TL:,SUBP,
 POST:,LC,128
  DECLET:,SUBP,
  MACRO75:,SUBP,
 INF7CH:,LC,13
  *TAKCA:,SUBP,
 TASKSTRA:,LC,18
  *TDIS:,LC,LTDIS. ДЛИHA MEHЯETCЯ !
 TRAM70:,SUBP,.
  CALCOMP*:,SUBP,
 MACRO61:,SUBP,
 ERES*1:,LC,.
 *NRP1:,PC,2.
 ПEPФOPAЦ:,SUBP,.
  NRERRMAC:,SUBP,
 *NRP2:,PC,2.
 NRES066:,SUBP,.
 NRES074:,SUBP,.
 *NRP3:,PC,
 NRES73:,SUBP,.
  POГATKA:,SUBP,
  CЛYГA:,SUBP,
 *NRP4:,PC,.
  MAKE MT:,SUBP,
   MULTITYP:,SUBP,
   VALERINA:,SUBP,
  *PL/MT:,LC,1
 ENRP4:,LC,.
 *NRP5:,PC,2
 EFSMNRS :,SUBP,.
 INTPT   :,SUBP,.
 FSCONTR :,SUBP,.
 YBBKNRS :,SUBP,.
 TA2M60  :,SUBP,.
 TA1M60  :,SUBP,.
 CORRADR:,SUBP,
 ПPEPKAPT:,SUBP,..
C
C...  БYФEPA ЩETOK И ИПЗ ЗAДAЧ BBOДA
C     COBMEЩEHЫ C П/П  STARTDD !
C
  STARTDD:,SUBP,
  *DRUMBAS:,SUBP,
 *NRP6:,PC,2
 NR7CH:,SUBP,
  TERM7:,SUBP,
 AEROPLAN:,SUBP,
 *NRP7:,PC,
  ZOO60:,SUBP,
  STATTT:,SUBP,
 OCCUPYD:,SUBP,
  NRSMT*SE:,SUBP,
 *NRP8:,PC,1
 NRESPOST:,SUBP,
 SPECMON:,SUBP,
 WHO/USER:,SUBP,
 TERM*LOC:,SUBP,
 *NRP9:,PC,
 NRSMDREC:,SUBP,
 DISPINIT:,SUBP,
 PRINTDR:,SUBP,
  PUT PULT:,SUBP,
 *NRP10:,PC,4
  NRCDC405:,SUBP,
  BUF405:,SC,0.CEKT.БYФEP CДC-ЧИTAЛKИ
  OCTOPOЖH:,SUBP,
  ПPOOБMEH:,SUBP,
  EC*608:,SUBP,
  *NRP11:,PC,1
 NRESERR:,SUBP,
 TERMINAL:,SUBP,
 DISPAC71:,SUBP,
 *NRP12:,PC,2
 TASKSAV:,SUBP,
 POIN12:,LP,0
 LEN12:,EQU,POIN12-*NRP12
 REZ12:,LC,1320B-LEN12
 TARES:,SUBP,
  *NRP13:,PC,1
 EMULATOR:,SUBP,.
  *NRP14:,PC,1
  PRINTASK:,SUBP,
  *BUFLP1:,SUBP,
  *BUFLP2:,SUBP,
  *NRP15:,PC,1
  NRES064:,SUBP,
  *WRBF64:,SUBP,
 PROC/OUT:,SUBP,
C
C---   ЛИCT ДЛЯ   M.Ю.ПOПOBA
C
  *NRP16:,PC,1
  NRESLINE:,SUBP,
C
C----------------------------
C
 *NRP17:,PC,1.
 NRESCODE:,SUBP,
  NRES072:,SUBP,
  ПYCKAЧ:,SUBP,
  BEGTTP:,PP,0
  TTANAL:,SUBP,
 PAЗHИЦA:,SUBP,
C-----------------------------------------------------------------------
 KOHHИЗ:,LC,.
 MAINSW:,SUBP,.
 TESTTRAK:,SUBP,
 WRITDISP:,SUBP,
 DB0*:,LP,.
  HAЧHИЗ:,EQU,64000B
  DB0*1:,LP,HAЧHИЗ-DB0*
 ДИCПHAMБ:,SUBP,.
 *TLPRMT:,SUBP,
 *TLSTAT:,SUBP,
 *TLCONST:,SUBP,
  *TLSYN:,SUBP,
  *TLCONN:,SUBP,
 *TLSYS:,LC,NSS3
 *TLBUFO:,LC,NPCH
 *TLBUFOP:,LC,NCON*LB+13
 *ИПK :,LC,NCM*3
 *ИПK1:,LC,NC *2
  ALLTOISO:,SUBP,
  ISOTOALL:,SUBP,
 *TASK71:,LC,16
 *SCAL71:,LC, 7
    NPAБЛИCT:,LC,1
  SCALES:LC,BLOCK,(1),MRDSCAL,(8)
 ,CONT,SC/CLJ
  SWING:,SUBP,
 FATA:,LC,LFAT
 TESTTA:,SUBP,.
  TABPRT:,LC,128
 *EFIX2M*:,LC,.ИHДИKAЦИЯ
 DD71/W:,ENTRY,
C
C      ФOPMИPOBAHИE ДИCПETЧEPCKOГO БAPAБAHA
C
 :,UJ,WRITDISP
 ,DATA,.
 *MБ21:,LOG,21 0000
       ,LOG,22 0000
C
C...  ДЛЯ BЫЗOBA ДИCПETЧEPA C ДИCKA :
C  A) 48-33 : ШKAЛA ФИЗ.MБ, ПEPEAДPECYEMЫX
C             HA ФAЙЛ C ДИCПETЧEPOM.
C     19-13 : HOMEP ЭTOГO ФAЙЛA ПO FATA
C             (BCTABЛЯETCЯ ПPOГPAMMHO)
C     12-1  : HAЧAЛЬHAЯ ЗOHA ФAЙЛA
C  Б) 48-1  : ИMЯ CПEЦ-ФAЙЛA ДЛЯ ДИCПETЧEPA
C
  ,LOG,0060 0000 0000 0400.MБ=16+17
  ,TEXT,8HMONSYS '11'
C         CTAHДAPTHOE ИMЯ MЛ
 STNAME:,LOG,2245 1252 5122 4512.
  BIT16/9:,LOG,17 7400 0017 7400
C         OБЩИE KOHCTAHTЫ
 CONST:,BSS,.
 ,LOG,7777 7777 7777 7777.
 ,LOG,3.
 ,LOG,5.
 ,LOG,7.
 ,LOG,13.
 ,LOG,14.
 ,LOG,37.
 ,LOG,77.
 ,LOG,177.
 ,LOG,377.
  ,LOG,777
 ,LOG,1400.
 ,LOG,1777.
 ,LOG,2003.
 ,LOG,2013.
 ,LOG,3777.
  ,OCT,7777
  ,OCT,0000 7777
  ,LOG,7777 0000
 ,LOG,7777.
 ,LOG,76000.
 ,LOG,77357.
 ,LOG,77777.
 ,LOG,17 7777.
 ,LOG,7777 7777.
 SCMDR0:,BSS,
 ,OCT,7777 77.
 C1:,BSS,.
 CIMT1:,LOG,1.
  MAX*T:,OCT,775.ПYCTOЙ TAЙMEP
 C30/16:,LOG,77777 00000.
 ,LOG,2004
  ,OCT,6
  ,OCT,7777 7760 0377 7777
 C*48:,OCT,4
 NJOBPR:,LOG,15.
 :1,SET,NJOBPR.
 1,,MSTART.
 :1,SET,NJOBPR.
 1,,NSTAJOB.
 :4,SET,C30/16
 1,,B30/16.
 :26,SET,CONST.
 1,,FULWOR.
  :1,SET,C1
  1,,QUETIM
  :1,SET,MAX*T
  1,,QUETIM+1
 :1,SET,CONST.
  3,,REWINDSC
 :1,SET,STNAME.
  48,,TNM
 :1,SET,BIT16/9.
 8,,OLD.
 :1,SET,C1.= ИПЗ
 1,,TPHYS+27.- CЛYЖ.ЗAДAЧ
 :1,SET,C1.
 5,,TPHYS+28.
 :1,SET,CIMT1.
  48,,T1M
 :4,SET,*MБ21
 1,,DISPBASE+2
 1,SET,C*48
  1,,FLMAMБ.ЗAПPET ПYCKA
 ,END,
 STARTDD:,NAME,
 PERMIR:,SUBP,
 SELECT:,SUBP,
  ********:,SUBP,
 TESTTA:,SUBP,
 STATIST:,SUBP,
 SCDICH:,SUBP,
  *ПДИCK:,SUBP,
  DISPBASE:,LC,
  LINCOM:LC,BLOCK,ISLINK.MEЖMAШ.CBЯЗЬ
  *D71DATA:,EQU,765B.***
 SCALES:LC,BLOCK,(1),MRDSCAL
 BUFTRA:LC,BLOCK,(1),(24),TRPRIP
 *KOHCTPA:,LC,1
 TPHYS:,LC,
  TTTASK:,SUBP,
  *327:B,BLOCK,(1),TTTASKIF
  *360:B,BLOCK,(1),TESTIF
 *PRT:LC,BLOCK,MINP,MAXP,NC,RP,RP1,RP2
 TABPRT:LC,BLOCK,TPRT
 *NRP1:,PC,
 FREEP:,P/P,(*NRP1)1024
  MASK12:,LC,
  C377:,LC,1
  C177:,LC,1
  C77:,LC,1
 C13:,LC,1
 C77777:,LC,1
 FULWOR:,LC,1
 DISREG:LC,BLOCK,C2013
 *TYP/MEM:,LC,1
  *ИПД:,LC,
  LENTPL:,EQU,*ИПД+22B.ДЛИHA TPHYS
  C7:,LC,1
  *TLBUFI:LC,BLOCK,CIN
  *TLPRMT:LC,BLOCK,T*NIX(2),MOT(10),/UVCH/
  *TLSTAT:LC,BLOCK,(5),REQOUT
  *TLSYN:LC,BLOCK,S*PAD,C*WAIT
  *TLSIZE:LC,BLOCK,S*SYN,XNPCH
  L MTR:,WEQ,S*SYN
  NPCH:,WEQ,XNPCH
  MPX*T:,SUBP,
  MPXMASK:,LC,1
  MAIN*C:,SUBP,
  SW PINT:,SUBP,
  RETURN:,SUBP,
  SW INT:,SUBP,
  PRT MASK:,EQU,SW INT - 1
  *YCЫ:LC,BLOCK,(2),HAЧMACKA
  TYPEMT:,SUBP,
  FL405:,EQU,TYPEMT+4
  NORECTP:,EQU,TYPEMT+7
  STATUSMT:LC,BLOCK,(20),ШKEC(12),MISTERX
  БAЗAПPИЗ:LC,BLOCK,(10),MEOF
  *527:B,BLOCK,LSTAT,TSTAT
  *USESTA:LC,BLOCK,(3),STPOINT
  STATOUT:,SUBP,
C---
  *677:B,BLOCK,BITS,B48,B47,B46,B45,B44
  ,CONT,B43,B42,B41,B40,B39,B38
  ,CONT,B37,B36,B35,B34,B33,B32
  ,CONT,B31,B30,B29,B28,B27,B26
  ,CONT,B25,B24,B23,B22,B21,B20
  ,CONT,B19,B18,B17,B16,B15,B14
  ,CONT,B13,B12,B11,B10,B9,B8
  ,CONT,B7,B6,B5,B4,B3,B2,B1
C---
 KOHHИЗ:,LC,
 NP:,P/P,(KOHHИЗ)1024
 NP1:,EQU,NP+1.
 HAЧBEPX:,P*P,(NP1)(1024)
 KC:,EQU,100B.
 KC0:,EQU,101B.
 TESTTRAK:,EQU,103B
C
C
C---  BXOД ПOCЛE ЧTEHИЯ C MБ :
C
  START:6,BASE,START
  ,XTA,DISPBASE+1
  ,ASN,64+12
  ,AAX,C77
  ,ATI,14.MБ ДИCПETЧEPA
  ,XTA,DISPBASE+4
  14,AAX,B48-10B
  ,U1A,NOKS. - ДИCK
  13,VJM,CALCSUM
  14,VTM,. - MБ
  ,AEX,KC0
  ,UZA,NOKS
  ,33,
  NOKS:12,VTM,.БAЗA TESTTRAK
  13,VJM,TESTTRAK
C
C---  BЫЯCHИM PAЗMEP ПAMЯTИ :
C
  ,XTA,
  ,ATX,-1
  ,ATX,-2
  4,VTM,-10
  :,ATX,1
  4,VLM,*
  ,XTA,=440 0000 1777.0==>137
  ,MOD,20B.1==>77
  :,24,2002B
  ,ATX,1777B
  ,ATX,3776B
  3,VTM,HAЧBEPX
  :,24,2003B
  4,VTM,-10
  :,ATX,1
  4,VLM,*
  ,XTA,-2
  ,U1A,TRAN2.32K
  4,VTM,1
  ,XTA,-1
  ,U1A,TRAN2.64K
  4,VTM,2.128K
C
  TRAN2:,BSS,
C       ПEPEПИCЬ 2ГO PEЗИДEHTA
 1,VTM,1-4096.
 2,VTM,70000B.
  L4:3,XTA,7777B
     2,ATX,7777B
     2,UTM,-1
     3,UTM,-1
 1,VLM,L4.
  ,XTA,*ПДИCK
  ,AAX,=:0000 14
  ,ATX,ISLINK
 :,UZA,*+1
  ,XTA,B24.MEЖMAШ.CBЯЗЬ
  :,AOX,HAЧMACKA+1
  ,ATX,HAЧMACKA+1
C
C...   KOPPEKTИPOBKA TAБЛИЦ TL-KOMПЛEKCA
  ,XTA,S*SYN
  ,ASN,64+9
  ,AAX,C177
  ,UZA,REST M
  ,ARX,C177.ИCПPABЛEHHЫE
  ,ASN,64-40.BEЛИЧИHA
  ,ATX,C*WAIT.ЗAДEPЖKИ
  ,XTA,S*SYN.И ПYCTЫШKA
  ,ASN,64-40.ДЛЯ CИHXPO-
  ,ATX,S*PAD.  HИЗAЦИИ
  REST M:14,VTM,L MTR.ДЛИHY MATPИЦЫ
  ,ITA,14. HAПPЯЖEHИЙ
  ,ATX,S*SYN.- BOCCTAHOBИЛИ
  14,VTM,NPCH
  S/GOI:14,UTM,-1
  14,VZM,CHMPX
  14,XTA,CIN.ЗAПYCK
  ,AAX,B25.ПPOГPAMMHOЙ
  14,ASN,64-24.CИHXPOHИЗAЦИИ
  ,AOX,REQOUT.KAHAЛOB
  ,ATX,REQOUT
  ,UJ,S/GOI
  CHMPX:,XTA,CIN.ШK.OПEP.TEPM.
  ,ATX,MAIN*C.HA CBOE MECTO
  ,XTA,B25.KAHAЛ TEKTRONIX
  ,APX,MOT
  :,UZA,*+1.OTCYTCTBYET
  ,ANX,.
  :,ATX,T*NIX
  ,XTA,MOT
  ,ASN,64+36.MACKИ BBOДA
  ,AAX,=6000.ДЛЯ CONSUL
  :,AOX,HAЧMACKA+1
  ,ATX,HAЧMACKA+1
C....     ЗAПYCK CПEЦ-KAHAЛA (ПЭM-2)
 ,XTA,/UVCH/
 ,UZA,NO*NO
C
C...   MOДИФИKAЦИЯ ПEPEKЛЮЧATEЛЯ
C        П P E P Ы B A H И Й :
C
  ,ASN,64+36
  ,AAX,=6000
  ,ATX,MPXMASK
  ,UZA,ПЭM2
C...    MYЛЬTИПЛEKCOP  Г O И
  ,AAX,B12
  ,UZA,CH11
  ,XTA,MPX/JMP
  ,ATX,SW PINT+12. ПPП-12
  CH11:,XTA,/UVCH/
  ,AAX,B47
  ,UZA,CL/UVCH
  ,XTA,B25
  ,ARX,MPX/JMP
  ,ATX,SW PINT+13. ПPП-11
  ,XTA,
  CL/UVCH:,ATX,/UVCH/
  ,UJ,NO*NO
C...   MYЛЬTИПЛEKCOP  И B T A H
  ПЭM2:,XTA,MPX/JMP
  ,ATX,SW PINT+5. ПPП-19
 ,XTA,B19
 NO*NO:,AOX,HAЧMACKA+1
 ,ATX,HAЧMACKA+1
  ,EXT,34B. ===> M ПPП
  ,ATI,
  :,UZA,*+1
  ,XTA,B37
  :,AOX,B*START
  *ЧACTOTA:2,IFGE,FREQ,600
  ,AEX,B40
  ,AEX,B10
  ,AOX,HAЧMACKA
  ,ATX,HAЧMACKA
  ,CALL,RESMASK
  ,ГMAC,XTA
  ,ATX,PRT MASK
C.....   ПPИBЯЗKA  MAIN-CONSOLE
 ,XTA,B6
 ,EXT,31B
C.....
 ,XTA,FULWOR
 ,ATX,MRDSCAL
 ,XTA,
 1,VTM,-4095
 CL/IPZ:,UTC,60000B
 1,ATX,4095
 1,VLM,CL/IPZ
  1,VTM,300B-477B
  CL/BEG:1,ATX,477B
  1,VLM,CL/BEG
  13,VTM,TESTTA
 ,ITA,13.
  ,ATX,TESTIF+3
  ,XTA,C13
  ,ATX,TESTIF+5
  10,VTM,*D71DATA
  ,ITA,10
 14,CALL,TTPRINT
C
C...   ЗAПИCЬ B SCDICH ПPИЗH. "29 MБ"
C
  15,VTM,SCDICH+3
  ,XTA,*ПДИCK
  ,APX,B30
  ,XTS,*ПДИCK
  ,APX,B29
 ,XTS,C2013.
 ,ATI,21B.
  ,ATX,TTTASKIF+5
  13,VTM,TTTASK
  ,ITA,13
  ,ATX,TTTASKIF+3
 ,XTA,UJ/OCT
  ,ATX,1000B
  *ЧACTOTA:,IFGE,FREQ,600
  PER*40:,SUBP,
 :,XTA,B*START
  ,ANX,
  ,ATI,13
  ,XTA,TOPER40
 :13,ATX,SW INT-1
  ,UJ,*+2
  TOPER40:13,VTM,RETURN
  ,UJ,PER*40
  *ЧACTOTA:,ENDIF,
C
C---   ДOOФOPMЛEHИE ПO ЛEHTAM :
C
  14,VTM,-3
  15,VTM,W.CTEK
  LTMT:14,XTA,TYPEMT+3
  ,ASN,64+46
  ,ATI,13
  ,UZA,TMT1
  13,XTA,TEC-1
  TMT1:14,ATX,ШKEC+3
  14,XTA,TYPEMT+3
  ,AAX,=6200 0000 0000 0070
  14,ATX,TYPEMT+3
  ,UZA,TMT5
  13,VTM,-3
  TMT2:13,XTA,TYPEMT+3
  14,AEX,TYPEMT+3
  ,AAX,C77
  ,U1A,TMT3
  ,ITA,13
  ,ITS,14
  15,AEX,
  ,U1A,TMT4
  TMT3:13,VLM,TMT2
  14,MTJ,13
  TMT4:13,UTM,6
  ,ITA,13
  ,ASN,64-18
   14,AOX,TYPEMT+3
  ,AOX,=11 00000 000000
   14,ATX,TYPEMT+3
  TMT5:14,VLM,LTMT
  ,XTA,FL405.CЧ-K BPEMEHИ
  ,ATX,543B.TOЛЬKO B ДYБHE !
  ,UZA,HE ДYБ
  ,XTA,=2200.HAЧ.COCTOЯHИE
  15,CALL,TOCDC405. KHOПKИ
  ,ATX,MEOF."END FILE"
  ,XTA,B35
  ,AOX,TYPEMT+1.ПPИЗHAK
  ,ATX,TYPEMT+1.CDC608,405
  HE ДYБ:,BSS,
  ,XTA,NORECTP
  ,AOX,MISTERX
  ,ATX,MISTERX
C
C---   HAЧAЛЬHOE COCTOЯHИE TAБЛИЦ,
C      CBЯЗAHHЫX C PAЗMEPAMИ ПAMЯTИ:
C
  ,XTA,B46
  ,AAX,*TYP/MEM
  4,AOX,LMEM
  ,AAX,MASK12
  ,ATX,*TYP/MEM
  4,XTA,LMEM
  ,ASN,64+12
  ,AAX,C377
  ,ATX,LENTPL
  ,XTA,FP
  ,ATX,TPRT.MAXP
  ,ARX,B1
  ,ASN,64-15
  ,AEX,TPRT
  ,ATX,TPRT.MINP,MAXP
  4,XTA,LMEM
  ,AAX,C377
  1,VTM,FREEP
  1,ATX,TPRT
  ,XTA,FP
  ,ARX,B2
  ,ASN,64-15
  1,ATX,TPRT+1
  ,AOX,FP
  ,ATX,W
  1,UTM,1
  MAKE1:1,UTM,1
  ,ITA,1
  ,AEX,LMEM.L32
  ,AAX,C377
  ,UZA,CHLSTP
  ,AEX,LMEM
  4,AEX,LMEM
  ,AAX,C377
  ,UZA,LASTP
  ,XTA,W
  ,ARX,STEP
  1,ATX,TPRT
  ,ATX,W
  ,UJ,MAKE1
  CHLSTP:4,VZM,LASTP.32K
  ,XTA,B18
  ,ARX,W
  ,ARX,STEP
  1,ATX,TPRT
  ,ARX,STEP
  1,ATX,TPRT+5
  ,ARX,B3
  ,ATX,W
  1,UTM,5
  ,UJ,MAKE1
  LASTP:,XTA,W
  ,AAX,C377
  ,ARX,B1
  ,ATX,W
  ,XTA,FP
  ,ASN,64-15
  ,AOX,W
  1,ATX,TPRT
  7,VTM,SELECT
   ,XTA,
  4,VZM,CLCONDR.32K
  4,UTM,-2
  4,VIM,STAT.64K
 ,XTA,7
 ,AAX,B47
 ,UZA,STAT.ИCПPABHA BCЯ ПAM
C       БЛOKИPOBKA CEГMEHTA 1
 ,XTA,B1
  ,ATX,TPHYS+137B.ЛИCT CEKT.OБM
  15,VTM,TPHYS+32
 1,VTM,-1
 LBL:3,VTM,1-32
  L32:15,ATX,
 3,VLM,L32
  15,VTM,TPHYS+96
 1,VLM,LBL
C       ИЗ'ЯTИE OTCYT. ЛИCTOB ИЗ TABPRT
 1,VTM,TABPRT
 ,XTA,CF33P
 1,ATX,33B
  ,XTA,CF100P
 1,ATX,100B
  14,VTM,FREEP
  ,ITA,14
  ,ASN,64-15
  ,AOX,CF137P
 1,ATX,137B
 ,XTA,CFMAXP
 1,ATX,FREEP
C       CДBИГ ЛИCTA ДЛЯ CEKTOPHOГO
 ,XTA,CRP2
 ,ATX,RP2
C           OБMEHA C MД.
 ,XTA,KYCMД
 ,ATX,SCDICH.ЛИCT 137B
 ,XTA,ПPПTRA
 ,ATX,TRPRIP+1.ПPИПИCKA
C       CДBИГ ЛИCTA KOHTPOЛЯ MБ-ЗAП.
 ,XTA,*KOHCTPA
 ,UZA,STAT.HE KOHTP-CЯ.
 ,XTA,KYCMБ
 ,ATX,*KOHCTPA
 ,XTA,B1
 ,ATX,TPHYS+100B
C       ЗAПYCK DD - B CTATИCTИKY
 STAT:,BSS,
  ,XTA,LSTAT
  ,ASN,64-25
  ,ARX,B28
  ,ATX,STATOUT-1.NZMAX
C  ПPABKA YKAЗATEЛЯ TEPMИHAЛЬHOЙ CTATИCTИKИ
  ,XTA,DISPBASE+6.N ЭBM
  ,ARX,
  :,U1A,*+1
  ,UTC,12
  :1,VTM,64-38
  ,XTA,ST POINT
  1,ASN,
  ,ASN,64+38
  ,ATX,STPOINT
  ,U1A,IS TST
  ,ATX,TSTAT
  IS TST:,BSS,
  ,ITA,7.HA SELECT
 ,UJ,STATIST.
C
  CLCONDR:,ATX,*KOHCTPA
  ,UJ,STAT
C
C---   KOHTPOЛЬHOE CYMMИPOBAHИE ДИCПETЧEPA:
C
 CALCSUM:,ENTRY,
 CALCSUM:,BSS,
 KH:,EQU,HAЧBEPX+4095
 1,VTM,KC0-KH
 ,XTA,
 L6:1,UTM,KH+1
 ,ATX,KC
 ,ARX,KC
 ,ARX,KC
 1,ARX,
 1,UTM,-KH
 1,V1M,L6
 13,UJ,
  UJ/OCT:,NTR,3
  ,UJ,********
  MPX/JMP:14,VTM,0.
  ,UJ,MPX*T
  CF33P :,LOG,100 00032
 CF100P:,LOG,101 00033
  CF137P:,LOG,136
 CFMAXP:,LOG,000 137
 CRP2:,LOG,101
 KYC MД:,LOG,1 0137 0000
 KYC MБ:,LOG,1 0040 0000
 ПPПTRA:,LOG,10 0370 0000
  TEC:,BSS,
  ,LOG,0000 0764 0000 0377.ПPM+BГTB+KЛ+HЛ+CДB+HЗЗ
  ,LOG,4000 0777 0000 0377.BCE, KPOME MГЗ
  ,LOG,6000 0777 0000 0377. ---"---
  LMEM:,LOG,4000 0000 0040 0033.32K
   ,LOG,2000 0000 0100 0077.64K
   ,LOG,0000 0000 0200 0177.128K
  FP:,,
  ,,FREEP
  STEP:,LOG,1 00001
  W:,BSS,1
 ,END,
 WRITDISP:,NAME,.04.05.76
C
C*****   ФOPMИPOBAHИE И ЗAПИCЬ ДИCПETЧEPA
C*****   И MOHИTOPHOЙ CИCTEMЫ
C*****   ( TT - COOБЩEHИE )
C
 MONITOR*:,SUBP,
  DATA*:,LC,2
C
C.....   CBЯЗИ C HOBЫM ДИCПETЧEPOM
C
 MAINSW:,SUBP,
  EMSW:,EQU,MAINSW+277B
 HAЧHИЗ:,EQU,64000B
 CДBHИЗ:,EQU,HAЧHИЗ-70000B
 KOHHИЗ:,LC,
 NP:,P/P,(KOHHИЗ)1024
 HAЧBEPX:,P*P,(NP+1)1024
 *DRUMBAS:LC,BLOCK,*B
C
C...   HAЧAЛO И KOHEЦ HACTPOЙKИ
C      (B OБCЛYГE HAЧAЛO = 70B)
C
  DISPBASE:LC,BLOCK,DD/KYC,DD/IW70
  *TLSIZE:,SUBP,
C
C
 EXCHNRS:,SUBP,
 KC0:,EQU,101B.ЭTAЛOH KC
 *677:B,BLOCK,BITS,B48,B47,(5),B41(2)
 ,CONT,B39,(7),B31,(12)
 ,CONT,B18,B17,B16,B15,(11)
 ,CONT,B3,B2,B1
 I:,EQU,3
 C3:,LC,1
 C377:,LC,1
 C77777:,LC,1
 STARTDD:,SUBP,
 CALCSUM:,SUBP,
  *D71DATA:,EQU,MAINSW+270B
 *TYP/MEM:,LC,1
 *PRT:LC,BLOCK,(4)
 *ИПД:LC,BLOCK,(5),XNC,XNCM
 NCS:,WEQ,XNC
 NCM:,WEQ,XNCM
  MTRACNT:,EQU,*ИПД+27B
 *ИПK1:LC,BLOCK,PRTSTAT
 TABPRT:LC,BLOCK,TPRT
 *0:,BLOCK,MINP,MAXP,NC,RP,RP1
  TPHYS:,LC,1
 *NRP1:,PC,
    FREEP:,P/P,(*NRP1)1024
   *NRP4:,LC,
  ENRP4:,LC,
  LMLT:,EQU,ENRP4-*NRP4
  BMLT:,P/P,(*NRP4)1024
  KMLT:,P/P,(LMLT )1024
C
C.....   PAБOЧИE ЯЧEЙKИ
C
 *10:B,BLOCK,INF0,INF,WS1,DELT,MTNRS,MMT
C
C.....   ПEPEПИCЬ 'WRITDISP' B БEЗOПACHOE MECTO
 START:1,VTM,*-END
 2,VTM,
 ПEPE:2,UTC,START
 ,XTA,
 2,UTC,74000B
 ,CTX,
 2,UTM,1
 1,VLM,ПEPE
 7,VTM,74000B
 7,REL,START
 ,UJ,CONT.HA HOBOE MECTO
C.....   ПEPEПИCЬ 'MAINSW' HA CBOE MECTO
 CONT:1,VTM,MAINSW-EMSW
 ,DRUM,SAVMNT
 2,VTM,
  13,VTM,*D71DATA
  ,XTA,DATA*
  13,ATX,
  ,XTA,DATA*+1
  13,ATX,1
 L1:2,UTC,MAINSW
 ,XTA,
 2,UTM,1
 2,CTX,477B
 1,VLM,L1
C       ДЛЯ ЗAПYCKA DD
 ,XTA,JSTDD
 ,CTX,1000B
 ,CTX,600B
 ,CTX,603B
C
C
C...   ИHBEPTИPYEM ДЛИHY OЧEPEДИ
C      ЗAKAЗOB HA OБMEH, C YЧETOM
C      HEOБXOДИMOГO PEЗEPBA ДЛЯ
C      OПOЗHABAHИЯ ДИCKOB.
C
    ,XTA,MTRACNT
   ,NTR,3
   ,A-X,=10
   ,AEX,=3777 7777 7777 7777
   ,ATX,MTRACNT
 I,VTM,PRTSTAT
 13,VJM,CORADDR
 1,VTM,NCM
 LP:1,UTM,-1
 ,XTA,B1-5
 1,UTC,
 I,ATX,NCS-NCM
 1,V1M,LP
 ,XTA,B1-4
 I,ATX,NCS-3
 ,XTA,B1-3
 I,ATX,NCS-4
 I,VTM,*PRT
 13,VJM,CORADDR
 ,XTA,FP
 ,ATX,MAXPS
 ,ARX,B3
 I,ATX,RP1
 I,ATX,RP
C.....   ФИKCAЦИЯ ЛИCTOB 1 PEЗИДEHTA
  I,VTM,TPHYS
  13,VJM,CORADDR
  1,VTM,FREEP
  ,XTA,B1
  FIXPAG:1,UTM,-1
  I,UTC,
  1,ATX,
  1,VIM,FIXPAG
  9,VTM,*B.*DRUMBAS
C.....   CДBИГ 2-OЙ ЧACTИ PEЗИДEHTA ДИCПETЧEPA
 1,VTM,1-4096
 2,VTM,HAЧHИЗ
 3,VTM,HAЧBEPX
 L2:2,XTA,
 3,CTX,
 2,UTM,1
 3,UTM,1
 1,VLM,L2
C.....   HACTPOЙKA ДИCПETЧEPA HA ЗAДAHHЫЙ MБ
  9,XTA,.*DRUMBAS
 ,ASN,64+12.ЗAПИCЬ
 ,ATX,MMT
 ,UZA,TO DR 1. HA MБ
 ,ASN,64+3
 ,UJ,TO DT 1. HA MЛ
  TO DR 1:9,XTA,.*DRUMBAS
 TO DT 1:,ASN,64-36
  ,ATX,SAVDB
 ,AUX,C770077
 ,AOX,B39
 ,ATX,INF
 ,ATX,INF0
 ,ATX,DD/IW70
 ,APX,C770037
 ,AUX,UPMKYC
 ,ATX,DD/KYC
C.....   PAЗMEЩEHИE MT HEPEЗИДEHTA
 ,UTC,EXCHNRS
 ,XTA,.MECTO
 ,ATX,MT NRS.MT-HEPEЗИД.
 ,AAX,B39
 ,U1A,FIXNRS.- ЗAДAHO
 ,XTA,DD/IW70
 ,ARX,D MTNRS
 ,UTC,EXCHNRS
 ,ATX,
C.....   HA ПOДCЧET KOHTP.CYMMЫ
  ,XTA,DMTNRS
  COPYNRPL:,AAX,C777
  ,AOX,SAVDB
  ,ATX,SAVDB
  ,XTA,
 ,CTX,102B
  ,CALL,CALCSUM
 ,ATX,KC0
C.....   ПOДГOTOBKA K ЗAПИCИ ДИCПETЧEPA
 ,XTA,
 ,ATX,DELT
 ,XTA,MMT
 ,UZA,WR DISP.ЗAПИCЬ HA MБ
  9,XTA,.*DRUMBAS
 ,ASN,64-33
 ,AUX,C770777
 ,ATX,INF
 ,AOX,B41
 ,ATX,MMT
C.....   OПPEДEЛEHИE ФИЗ.AДPECA ПO MЛ
C.....   ( ДЛЯ TT - ПEЧATИ )
 ,FUN,113B.
C   CYMMATOP = ДEЛЬTA, A ИP 14 = ФИЗ HOMEPY MФ.
 ,ATX,DELT
 ,ITA,14
 ,ASN,64-12
 ,ATX,INF0.ФИЗ. N MЛ
 ,XTA,INF
 ,AAX,C777.N HAЧ.ЗOHЫ БEЗ
 ,AOX,INF0.YЧETA ДEЛЬTЫ
 ,ATX,INF0.....
C.....   ЗAПИCЬ ДИCПETЧEPA HA MБ ИЛИ MЛ
 WR DISP:1,VTM,-NP-4
  ,XTA,INF
  ,ARX,=100 0000 0036
  ,ATX,TPП
  ,ARX,=1
  ,ATX,TPП+1
 L3:,*70,INF
 ,XTA,INF
 ,ARX,B31*1
 ,ATX,INF
 1,VLM,L3
 ,ATX,WS1
 ,ARX,C777.ИHДИKAЦ.
 ,ATX,INF.N KOH.ЗOHЫ
C
C.....  YCTAHOBKA HOMEPOB MAT.ЛИCTOB
C         ДЛЯ  MT - KAHAЛOB
  ,XTA,MT NRS
  ,AAX,=0004 3700 0077 7777
  ,ATX,W
  ,ASN,64+20
  ,ATI,1
  ,DRUM,MT NRS.ЧTEHИE NR-MT
  1,XTA,11B.CCЫЛKA
  ,AAX,=1777.B FETCH-E
  ,ATI,14
  14,J+M,1.BUFSAP
  14,VTM,KMLT
  ,XTA,=:0777 7774 172.3-25,32-35,37
  PSCAL:,ATX,LMEM
  ,XTA,=:4
  14,ASN,64+BMLT.ИCKЛЮЧEHИE
  ,AEX,LMEM.MT-ЛИCTOB
  14,VZM,EPSCAL
  14,UTM,-1
  ,UJ,PSCAL
  EPSCAL:2,VTM,-1
  3,VTM,-8
  PUT PAG:,ATX,LMEM
  ,ANX,=7777 7777
  ,ATI,14
  ,ASN,64-30
  3,UTC,8
  1,ATX,1
  ,XTA,=:4
  14,ASN,64
  ,AEX,LMEM
  3,VLM,PUT PAG
  3,VTM,-8
  1,UTM,10
  2,VLM,PUT PAG
  ,XTA,
  1,ATX,-20
  1,ATX,-10
  ,DRUM,W.ЗAПИCЬ NR-MT
 ,XTA,MT NRS
 ,AAX,B39.MECTO MT NRS
 ,U1A,L4.- ЗAДAHO
C.....   ПEPEПИCЬ MT HEPEЗИДEHTA
C.....   BCЛEД ЗA ДИCПETЧEPOM
 ,DRUM,MT NRS
 ,XTA,WS1
 ,AAX,MINF
 ,AOX,B31
 ,ATX,INF
 ,*70,INF
C
C.....    ЗAПИCЬ   T P П   HA  36-37
C.....    ЗOHЫ  ЭKCTEHTA  ДИCПETЧEPA
C
  ,XTA,INF
  ,AEX,TPП+1
  ,AAX,C777
  ,AEX,INF
  ,ATX,INF
  ,DRUM,I1/1
  ,TAPE,TPП
  ,DRUM,I1/2
  ,XTA,17B
  ,ATX,3774B
  ,XTA,
  ,ATX,3775B
  ,TAPE,TPП+1
  9,XTA,.CИCTEMY
 ,ASN,64+27.ПEPEПИCЫBATЬ
 ,UZA,L4. - HET
C.....   ПEPEПИCЬ MOHИTOPHOЙ CИCTEMЫ
 1,VTM,1-64
 ПEPEMC:,DRUM,INFMS
 ,XTA,INF
 ,ARX,B1
 ,ATX,INF
 ,TAPE,INF
 ,XTA,INFMS
 ,ARX,C7741
 ,AAX,Z12/6
 ,ATX,INFMS
 1,VLM,ПEPEMC
C.....   ПOДГOTOBKA И ПEЧATЬ TT-COOБЩEHИЯ
 L4:,XTA,INF0
 ,ASN,64-30
 ,AUX,UPM1
 ,AOX,CTT1.HOMEP
 ,ATX,TT+2.YCTPOЙCTBA
 1,VTM,-1
 L5:1,XTA,INF0+1
 ,ARX,DELT
 ,ASN,64-39
 ,AUX,UPM2.HOMEPA
 1,AOX,CTT2+1.HAЧ. И KOH.
 1,ATX,TT+4.  ЗOH
 1,VLM,L5
  14,VTM,NP+6
  ,ITA,14
  ,ASN,64-39
  ,AUX,=6H'''''7''7''7'''
  ,AOX,=6HД=000
  ,ATX,TT+5
 1,VTM,TT
 2,VJM,TT PR
 ,XTA,MMT.MБ-ЗAПИCЬ
 ,UZA,END WR. - ДA
 ,TAPE,MMT.ПOДBOД K HAЧAЛY
 END WR:,BSS,
  ,XTA,DISPBASE+1
  ,ASN,64+12
  ,ATI,14
  ,XTA,DISPBASE+4.ДИCПETЧEP
  14,AAX,B48-10B.HA ДИCKE
  ,UZA,NO SERV. - HET
C
C...  ЗAПИCЬ, ECЛИ HAДO, HACTPOЙKИ
C     B  0-Й ЛИCT OБCЛYГИ HA 9/MONSYS
C
  3,VTM,
  ,*70,=0014 0100 0016 0020
  1,VTM,DISPBASE-*TLSIZE
  2,VTM,2070B
  NEW GEN:1,XTA,*TLSIZE
  2,AEX,
  :,UZA,*+1
  3,UTM,1
  :2,AEX,
   2,ATX,
  2,UTM,1
  1,VLM,NEW GEN
  3,VZM,NO SERV.БEЗ ИЗM.
  1,VTM,-3
  ,XTA,=3053 4576 1634 0112
  ,*76,1
  NEW TRAN:1,XTA,*53
  1,CTX,2053B
  1,VLM,NEW TRAN
  ,*70,=0004 0100 0016 0020
  1,VTM,TNG
  2,VJM,TTPR
C---
  NO SERV:,BSS,
 ,DRUM,I1/1
 ,DRUM,I2/1
 ,DRUM,I1/2
 ,XTA,17B
 ,ATX,3774B.
 ,XTA,
 ,ATX,3775B
 ,DRUM,I2/2
 ,DRUM,RESMNT
  ,XTA,SAVDB
  ,ATX,120B
 ,XTA,=14 3700 0021 0000
 ,ATX,61B
 ,XTA,44B
 ,AOX,=:4
 ,ATX,44B
 ,UJ,MONITOR*+1
C       KOPPEKTИPOBKA AДP. ИЗ 2-Г0 PEЗИДEHTA
 CORADDR:,ITA,I
 ,AAX,B15
 13,UZA,
 I,UTM,CДBHИЗ
 13,UJ,
  JSTDD:6,VTM,STARTDD
  6,UJ,
  *50:6,VTM,DISPBASE-*TLSIZE
  2,VTM,70B
  *51:2,XTA,
  2,UTM,1
  *52:6,ATX,*TLSIZE+1024
  6,VLM,51B
  *53:,UTC,
 I1/1:,LOG,10 0100 0020 0000
 I2/1:,LOG,00 0100 0000 0034
 I1/2:,LOG,10 0100 0020 0001
 I2/2:,LOG,00 0100 0000 0035
 SAVMNT:,LOG,00 0000 0000 0033
 RESMNT:,LOG,10 0000 0000 0033
 HET MЛ:,BSS,
 1,VTM, T HET
 2,VTM,END WR
 TT PR:,BSS,
  ,ITA,1
  ,FUN,76B
  2,UJ,
  FIXNRS:,XTA,MTNRS
  ,UJ,COPYNRPL
  SAVDB:,LOG,
C.....
 TT:,ISO,12HOC '47'ДYБHA'47'
 ,BSS,4
  ,ISO,6HЗOH.''''
  TNG:,ISO,30HБЛOK BЫЗOBA ДИCПETЧEPA ЗAПИCAH
     :,ISO,30H B 420 ЗOHY ФAЙЛA 9/MONSYS.''
 T HET:,ISO,12HЗAKAЗ MЛ'47'''
 ,BSS,1
 UPM1:,GOST,6H000770
 CTT1:,ISO,6HHA 00/
 UPM2:,GOST,6H777000
 CTT2:,ISO,6H000-'1''1'
  ,CONT,6H000/.
 DMTNRS:,Z01,100B
 ,,NP+5
 INFMS:,014,100B
 ,021,
 FP:,,
 ,,FREEP
 STEP:,LOG,1 00001
 MINF:,LOG,4 0000 0077 0777
 UPMKYC:,LOG,70 0000 0000 1774
 C770777:,LOG,77 0777
 C770077:,LOG,77 0077
 C770037:,LOG,77 0037
 C7741  :,LOG,7741
 C777   :,LOG,777
 Z12/6:,LOG,7777 7777 7777 0037
 B48/43:,OCT,77
 B31*1:,LOG,100 0000 0001
 MAXPS:,BSS,1
 W:,BSS,1
 LMEM:,BSS,1
  TPП:,BSS,2
 END:,BSS,1
 ,END,
 EMULAT:,NAME,.04.04.76
C
C*****   ПOДПPOГPAMMA , OPГAHИЗYЮЩAЯ
C        BЫЗOB HEPEЗИДEHTA
C        ИHTEPПPETATOPA ЭKCTPAKOДOB
C
 ДHЗ:,LC,1.
 *YCЫ:LC,BLOCK,ГYC
 SCEM:,EQU,83
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR
 NRESCALL:,SUBP,
 NREMULAT:,SUBP,
 B24/1:,LC,1
 DISREG:LC,BLOCK,C2013
 C37:,LC,1
 BIT3:,EQU,755B
C
 ,ATX,KOД.
 ,WTC,ГYC.ЗAKAЗ ЗAДAЧИ
 ,XTA,SCEM.  +
 ,AOX,SCEM0.CTAHД.ИHTEPПP.
 ,AAX,KOД.
 ,AAX,B48/25. ИTOГO :
 ,UZA,NO.- HE ИHTEPПP.
 ,ANX,B24/1
 ,AAX,C37.
 ,ASN,64-15
 ,ATX,SAVSR.HOMEP ЭK
 ,ITA,14
 ,AOX,SAVSR.
 ,ATX,SAVSR.PEГИCTP14
 ,ITA,27B
 ,APX,C2013
 ,ASN,64+24
 ,AOX,SAVSR.PEЖИM.BOЗBPATA ( И27 )
 ,ATX,SAVSR.
 ,ITA,27B.
 ,AAX,BIT3.
 ,ASN,64-20.
 ,AOX,SAVSR.
 ,ATX,SAVSR.
 ,WTC,ГYC.
 ,XTA,SCEM.ИHTEPПPETИPYEMЫ
 ,AAX,B48/25.ЭKCTPAKOДЫ
 ,AOX,SAVSR
 ,WTC,ГYC.ИHФOPMAЦИЯ
 ,ATX,SCEM.HEPEЗИДEHTY
 ,XTA,NRWORD.
 ,UJ,NRESCALL.EГO BЫЗOB
 NRWORD:,Z00,NREMULAT
 ,Z00,TO EMUL
 TO EMUL:,ATI,14
 14,UJ,
 NO:,XTA,SAVAC.
 ,WTC,KOД.
 ,UJ,.
 B48/25:,OCT,7777 7777.
 SCEM0:,BSS,.
C.....   CTAHДAPTHO ИHTEPПPETИPYЮTCЯ :
C        ЭK50 , ЭK62 ,ЭK72
 ,OCT,4002 004
 KOД:,BSS,1.PAБ.ЯЧEЙKA
 ,END,
 EMULATOR:,NAME,.04.04.76
C
C*****   ИHTEPПPETATOP ЭKCTPAKOДOB
C
C.....   BXOДHAЯ ИHФOPMAЦИЯ :
C
C         SAVAC' - CYMMATOP ,
C        ПOДAHHЫЙ ЭKCTPAKOДY
C
C         ЯЧEЙKA ИПЗ 'SCEM' :
C
C     48-25 : ШKAЛA ИHTEPПPET. ЭK
C     24-21 : PAЗPЯДЫ(11,4,2,1) И27
C     20-16 : HOMEP ЭK - 50B
C     15- 1 : ИCПOЛH.AДPEC ЭK
C
C*****
  * И П Д :LC,BLOCK,XNF
  ,CONT,(7)
  ,CONT,Ш/CЛYЖ
  ,CONT,Ш/FULL
  ,CONT,(39)
  ,CONT,SCEM*64
  ,CONT,(6)
  ,CONT,ШKП
  ,CONT,(1)
  ,CONT,LIB/BOSS
  ,CONT,(4)
  ,CONT,SCENDJO
  XNSEM:,EQU,*ИПД+7
  NSEM:,WEQ,XNSEM
  NSEM1:,EQU,NSEM-1
  NMAT1:,WEQ,XNF
  XNC:,EQU,XNF+5
   NC:,WEQ,XNC
  XLTP:,EQU,XNF+22B
   LTP:,WEQ,XLTP.LEN TPHYS
   LTP1:,EQU,LTP-1
  XLFATA:,EQU,XNF+20B
   LFATA:,WEQ,XLFATA
   LFATAM1:,EQU,LFATA-1
C*****
  CLTASK:,SUBP,
C
C...  PAБ.ПOЛE ЭK "TTPRINT" ДЛЯ CЛYЖ.ЗAД.
  *102:B,BLOCK,BUF5076(15)
C...  PAБ.ПOЛE ЭK ЗAMEHЫ CTPAHИЦ
  *121:B,BLOCK,
 ,CONT,C/TM(2)
 ,CONT,M/ПTP(2)
 ,CONT,A/ПTP(2)
C
  TEL IS:,EQU,436B.БYФEPA
  ATEL1 :,EQU,440B.ПPИKAЗA
  ATEL2 :,EQU,456B."TEЛ"
 NREMULAT:,SUBP,
 NRES OFF:,SUBP,
  MACRO60:,SUBP,
 MACRO64:,SUBP,.
 MACRO70:,SUBP,.
 MACRO70S:,SUBP,
 MACRO74:,SUBP,.
 MACRO76:,SUBP,.
 REWINDSC:LC,BLOCK,(1),ЗAKЗAП,ЗЧKOH
  ,CONT,CHBOSS(4)
 CALL1MEM:,SUBP,
 CALL1FME:,SUBP,
 OUTMACRO:,SUBP,
  ERREXT:,SUBP,
 SEMDOWNS:,SUBP,
  SEM UP :,SUBP,
 ASTIME:,EQU,542B.
 TELOUT:,SUBP,.
 CL OPER:,SUBP,
 NEWTA :,SUBP,
 BOC ИПД:,SUBP,
  TAKETR*:,SUBP,
 STOP/NP:,SUBP,
  DRIDENT:,LC,1
 *YCЫ:LC,BLOCK,ГYC
C
C-----  ДИAГHOCTИKA:
C
 T OШИБ:,EQU,32
 T ЧYЖЛ:,EQU,33
C
C.....   ЯЧEЙKИ ИЗ  И П З
C
  ST/EXCH:,EQU,-2
 TIC:,EQU,-1.CЧET.BPEMЯ
C
C-----   ПOЛE YПPЯTЫBAHИЯ  И П З  :
C
 '00 - CYMMATOP
 '01 - PEЖИM  A Y
 '02 - PEГИCTP MЛAДШИX PAЗPЯДOB
 '03 - AДPEC ПPEPЫBAHИЯ (И33)
 '04 - AДPEC ЭKCTPAKOДA (И32)
 '05 - PEЖИM  Y Y  (И27)
C
 ' 06  07  10  11  12  13  14  15
 'И16 И15 И14 И13 И12 И11 И10  И9
C
 ' 16 17 20 21 22 23 24 25  26  27
 ' И8 И7 И6 И5 И4 И3 И2 И1 И34 И35
C
C-----
C
 AП:,EQU,3.
C.....   TAБЛИЦA MATEMATИЧECKИX ЛИCTOB
 TMATH:,EQU,30B.PAЗPЯДЫ 48-31   ДЛИHA : 50B
C.....   TAБЛИЦA ПPИПИCKИ
 TПPИП:,EQU,30B.PAЗPЯДЫ 24-1    ДЛИHA : 8
C.....   TAБЛИЦA ЗAЩИTЫ
 TЗAЩ:,EQU,40B.PAЗPЯДЫ 28-21   ДЛИHA : 4
C.....   CЛOBO 40B , PAЗPЯДЫ 6-1
     'ЖEЛAEMOE ЗAДAЧE KOЛ-BO ФИЗ.ЛИCTOB
C
  NPPW:,EQU,41B
C.....   CЛOBO 41B , PAЗPЯДЫ 6-1
     'HAЛИЧHOE KOЛ-BO ФИЗ.ЛИCTOB Y ЗAДAЧИ
C
C.....   CЛOBO 42B , PAЗPЯД 1
     'ЗAДAЧA BЫДAЛA ДOЛГИЙ OБMEH
C
 SAV NER:,EQU,45B
C.....   CЛOBO 45B, PAЗPЯДЫ 15-1
     'ПOЛE CПACEHИЯ AДPECA ABOCTA
C.....   CЛOBO 46B , PAЗPЯДЫ 15-1
     'ПOЛE CПACEHИЯ И32 (OCTAHOB AЧ,NK)
C
C.....   CЛOBO 47B , PAЗPЯДЫ 15-1
     'ПOЛE CПACEHИЯ И14 (OCTAHOB AЧ,NK)
C
 П YПP:,EQU,50B
     'PP.20/16 - ДOПYCTИMAЯ PEKYPCИBHOCTЬ
     '           BETBЛEHИЯ
     'PP.15/01 - Ф-AДPEC TEK.ПOЛЯ YПPЯTЫBAHИЯ
C
 M/Ф:,EQU,51B
     '18P. - ECTЬ ПPИЧИHA BETBЛEHИЯ
     '17P. - ЗAДAЧA ЗAKPЫTA ДO COБЫTИЯ
     '16P. - БЛOKИPOBKA BETBЛEHИЯ ПO
     '       HEXBATKE ПOЛЯ YПPЯTЫBAHИЯ
     'PP.15/01 - KOД ДЛЯ ПEPEBOДA Ф-AДPECA
     '           ПOЛЯ YПPЯTЫBAHИЯ B M-AДPEC
C
 MC:,EQU,52B
     'PP.24/01 - MACKA ШKAЛЫ COБЫTИЙ
C
 ШC:,EQU,53B
     'PP.24/01 - ШKAЛA COБЫTИЙ
C
 M:,EQU,100B.
 REGSCAL:,EQU,M
C.....   PAЗHOOБPAЗHЫE ФЛAГИ
C.....
 '    P48 - PAЗPEШEHИE ФИЗ.ДEЙCTBИЙ
 '    P46 - PAЗPEШEHИE HA ИHTEPПPETAЦИЮ
 '          ЭK75 C AИCП = 0 , 1
 '    P43 - ECTЬ PEAKЦИЯ HA ABOCTЫ
 '    P 5 - OCTAHOB ПO ЗП/ЧT ПPИ COBПAД. И35
 '          = 1 (ЗAПИCЬ) , = 0 (ЧTEHИE)
 '    P 4 - (=1) PEЖИM ЗAПИCИ KOMAHД
 '          (OДHOBPEMEHHO CTOП ПO KOHTPOЛЮ)
 '          (=0) PEЖИM ЗAПИCИ ЧИCEЛ
 '               (HET CTOПA)
C.....
 OШBHYПP:,EQU,M+1
C.....
 '    PP.46-40 - ПPИЧИHA ABOCTA
 '    PP.39-31 - KOЛ-BO OБPAБATЫB.ABOCTOB
 '    PP.30-16 - PEЖИM BXOДA ПO ABOCTY
 '    PP.15- 1 - AДPEC BXOДA ПO ABOCTY
C.....
 M72:,EQU,M+2.MACRO64
 BUFI14:,EQU,M+3.MACRO70,MACRO75
 BUFS27:,EQU,M+4.MACRO70,MACRO75
 M75:,EQU,M+5.MACRO64
 COPYS33:,EQU,M+6.MACRO67
 RETM67:,EQU,M+7.MACRO67
 TIB:,EQU,110B.KOMMEP.BPEMЯ
 TJOB:,EQU,TIB.BPEMЯ BЫБPOCA
 TLIM:,EQU,111B.ЛИMИT BPEMEHИ
 ДШ:,EQU,112B
     'PP.48/17 - ШKAЛA M-ЛИCTOB C KOH.OБM.
     '16P. - БЛOKИP.BETBЛEHИЯ (OT ЗAДAЧИ)
     'PP.15/01 - M-AДPEC ДEШИФPATOPA
C
 PULT:,EQU,113B.TEЛEГPAMMA
 PASS:,EQU,114B.ШИФP Д-68/PASS
 SYSMD:,EQU,115B.ФИЗMБ-MД (21,22)
 NAME:,EQU,80.* ДЛИHA 3
 SCEM:,EQU,83
 TLIMS:,EQU,84.
 I60/74:,EQU,85.
C.....
 '    P48 - ПEPBOE OБPAЩEHИE K ЭK60(=1)
 '    P47 - =0 - ЭK60 C MЛ
 '          =1 - ЭK60 C MБ
 '    PP.46-31 - YKAЗATEЛЬ MЛ/MБ
 '    PP.30-16 - CЧETЧИK ПO ЛИCTY
 '    PP.15- 1 - AДPEC ПEPEXBATA ЭK74
C.....
  WS/ПФ:,EQU,135B
  П T P  :,EQU,163B.TPAKTЫ ПOДKAЧKИ
  MATMБ  :,EQU,175B.TPAKTЫ MAT.MБ
  FIELD1 :,EQU,475B.P.П.1 ДЛЯ MAT.ЗAДAЧ
  FIELD2 :,EQU,515B.P.П.2 ДЛЯ MAT.ЗAДAЧ
 ФИO:,EQU,566B
 ФИO/ISO:,EQU,576B
  DRU/MEM:,EQU,777B
C
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR
 ,CONT,SAVI15,SAVI14,SAVI13
 TPHYS:,LC,1.
 TABLEMT:LC,BLOCK,.
 ,CONT,(16),T1MT(96),TNAM
  FATA:,LC,1
 STATUSMT:LC,BLOCK,(5),NEW(4)
  ШЛAГБAYM:LC,BLOCK,(4)
  ,CONT,SCJOB(3)
  ,CONT,SEM/EM
  ,CONT,(1),SEM212
  YДABЛEHЫ:,LC,1
  TYPEMT:,SUBP,
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 *TLSYS:LC,BLOCK,(1),STATMT
  SCALES:LC,BLOCK,(1)
  ,CONT,MRDSCAL
  ,CONT,(2)
  ,CONT,SCALCLTA
  GIVE PAGE:,SUBP,
  SAVEMOD:,SUBP,
  MASK12:LC,BLOCK,B48/37(0),M12B
  *CB :LC,BLOCK,(1),C17,(1),B31/36
 ,CONT,(2),NUMB(6),R50,INT0
  C7777:,LC,1
  C777 :,LC,1
  C377:,LC,1
  B30/16:,LC,1
 FULWOR:,LC,1
 B48/31:,LC,1
 B24/1:,LC,1
 B16/1:,LC,1
 C77777:,LC,1
 C76000:,LC,1
 DISREG:,LC,1
  C1400:,LC,1
 C1777:,LC,1.
 C177:,LC,1
 C37:,LC,1
 C77:,LC,1.
 C7:,LC,1
 C3:,LC,1
  BC1700:,SUBP,
  C50:,EQU,BC1700+5
  C60:,EQU,BC1700+6
 *677:B,BLOCK,BITS
 ,CONT,B48,B47,B46,B45,B44,B43
 ,CONT,B42,B41,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33,B32,B31
 ,CONT,B30,B29,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21,B20,B19
 ,CONT,B18,B17,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B 9,B 8,B 7
 ,CONT,B 6,B 5,B 4,B 3,B 2,B 1
 BITININ:,EQU,B43
 BETB:,EQU,B18
 ЗAKP:,EQU,B17
 БЛOK:,EQU,B16
C-----   COCTAB PAБOЧEГO ПOЛЯ EMULATOR-A
 *0:,BLOCK,
  0,CONT,MSAV(7)
  7,CONT,TAЦПY
  8,CONT,FUL
  9,CONT,EFR
 10,CONT,FR
 11,CONT,FR1(0),KДHЗ
 12,CONT,SWORD
 13,CONT,S12(0),KMБ
 14,CONT,KTP(0),S15
 15,CONT,SUM
C-----
  TODAY:,LC,1.ДATA
C
 BAS:14,REL,*
 13,VJM,GIVADR.
C.. ЗAПOMИHAHИE COCTOЯHИЯ B ПOЛE YПPЯTЫBAHИЯ
  YПPЯT:,XTA,SAVAC
  15,ATX,SUM
   ,XTS,SAVSR
  ,ITS,32B
  ,XTS,SAVI15
  ,XTS,SAVI13
  ,ITS,12
  ,ITS,11
  15,ATX,
  15,UTM,-7
 ,WTC,ГYC.
 11,VTM,.AДPEC ИПЗ
 11,XTA,SCEM.
 ,ATI,12.ИCП.AДPEC ЭK
 ,ASN,64+15.
 ,AAX,C37.
 ,ATI,13.N ЭK - 50B
  13,XTA,B48.БИT N ЭK.
  15,ATX,S15.ДЛЯ CHECK PR
  ,AEX,B32
 ,UZA,READ M.- ЭK70
  ,AAX,ШЭ ПAM.ЭK.C ИHФ.CЛ.
 ,UZA,ЭK CYM. - HET
C.....   ИЗBЛEЧEHИE ИHФ.CЛOBA ИЗ ПAMЯTИ
 11,XTA,SCEM.
 ,AAX,B23.
 ,U1A,READ.ПO ФИЗ.AДPECY
 READ M:,BSS,
  12,VZM,ЭK CYM
C......   A HE HA ЧYЖOM ЛИ ЛИCTE ИHФ.CЛOBO
 ,ITA,12
 ,ASN,64+10
 ,ATI,13
 11,UTC,
 13,XTA,TMATH
 ,ASN,64+30
 ,UZA,OШ/ЧYЖ.-ЛИCT 'ЧYЖOЙ'
 ,AEX,B18
 ,UZA,OШ/ЧYЖ.- HE БЫЛO OБPAЩ.
   :   ,24,2000B
 READ:12,XTA,.ИHФ.CЛOBO
   :   ,24,2003B.
 15,ATX,SUM.
C.....
 ЭK CYM:12,VJM,CHECK PR.
   :    ,24,2003B
 15,XTA,SUM.
 ,ATX,SAVAC.
  15,XTA,S15.БИT N.ЭK.
  ,APX,INTMACR
  ,UZA,OШ/ЭK
  ,ANX,C77777
  ,ATI,13
  11,WTC,SCEM
  15,VTM,.ИCП.AДP.ЭK
  13,UJ,MAIN/SW
 ЭKCTPA:,BSS,.
C.....   BOCCTAHOBЛEHИE ЗAДAЧИ ,
C        ПEPEДAЧA ПO И13 ,
C        MИHYЯ OTKAЗ OT HEPEЗИДEHTA .
 ,ITA,13.
 ,ATX,SAVAR.
 11,XTA,SCEM.
 ,ASN,64-24.
 ,AUX,DISREG.
 ,ATI,27B.
 13,VJM,BOCCTAH.
 ,WTC,ГYC.
 ,WTC,SCEM.
 14,VTM,.
 ,XTA,SAVAC.
 ,WTC,SAVAR.
 ,UJ,.
C*****
  MAIN/SW:,ITA,15
  ,UJ,ЭK50
  :13,VTM,MACRO60+2
  ,UJ,ЭKCTPA
  :,XTA,ZBITJ
  ,UJ,ЭK62
  :,ITA,15
  ,UJ,ЭK63
  ЭK64:13,VTM,MACRO64+2
  ,UJ,ЭKCTPA
 ЭK70:,BSS,.
C*****   ИHTEPПPETAЦИЯ ЭK70
C     (ПPOCTO OБMEH И BOЗBPAT B ЗAДAЧY)
 13,VTM,MACRO70+2.
 ,UJ,ЭKCTPA.
  :,NTR,2
  ,UJ,ЭK72
 ЭK76:,BSS,.
C*****   ИHTEPПPETAЦИЯ ЭK76
 13,VTM,MACRO76+5.
 ,UJ,ЭKCTPA.
 ЭK72:,BSS,.
C*****   ИHTEPПPETAЦИЯ ЭK72
C     HA BXOДE :
C     ИCX.CYMMATOP B MSAV ,
C     ИHФ.CЛOBO B SUM
 13,VJM,GIVADR
   :   ,24,3.
C OTKPЫTЫMИ ПPEPЫBAHИЯMИ
 15,MTJ,11.
 11,XTA,MSAV.
 ,AEX,KOД74.
 ,UZA,ПEP74/72
 11,XTA,SUM
 11,ATX,SWORD.
 ,ASN,64+42.
 11,ATX,FR.
 ,YTA,.
 11,ATX,FUL.
 13,VTM,SW72-E72.
 12,VTM,SW72.
 AN72:12,XTA,.
 11,AEX,FR.
 ,AAX,C77.
 12,UZA,.
 12,UTM,1.
 13,VLM,AN72.
 ,UJ,OШЭK 0.HET TИПA PAБOTЫ
 SW72:,BSS,.
C.....   ПEPEKЛЮЧATEЛЬ TИПOB ЭK72
 :,UJ,OTK OП.
 ,,00B.
 :,UJ,ЗAM OП.
 ,,10B.
 :,UJ,ДAЙ OП.
 ,,11B.
 :,UJ,OTK MЛ.
 ,,20B.
  :,UJ,NRS RET
  ,,30B
 :,UJ,OTK MБ.
 ,,40B.
 :,UJ,OTKMБ Д.
 ,,41B.
 :,UJ,ПEЧ MБ.
 ,,42B.
 :,UJ,NRS RET.ПYCTOЙ ЭK
 ,,47B.
 :,UJ, ЗAM MБ.
 , ,50B
 E72:,BSS,.
  :,UJ,NRS RET."ПOДBOД"
 ,,70B.
C
C... ЗAKAЗ ЛИCTOB OП
C
  ДAЙ OП:12,VJM,MEMORY
  Д OП1:,XTA,B48.ЗAK.B TMATH
  :13,AEX,.БEЗ
   13,ATX,.ИЗMEHEHИЙ
  :,,.ЛИCT БЫЛ
C.....
 KЦ OП:,24,3.
  11,WTC,S12
  12,VTM,
 11,XTA,FR.
 ,ARX,B1.
 11,ATX,FR.
 11,AEX,EFR.
 ,UZA,MEMORY.K CЛEД.ФPAГMEHTY
 11,XTA,FR.
 ,UJ,Ц OП.K CЛEД.ЛИCTY
C
C... BЫБOPKA HOMEPA MAT.ЛИCTA
C
  MEMORY:,ITA,12
  11,ATX,S12
  12,VJM,GIV1
  15,VZM,NRS RET.БЫЛ KOHEЦ
  11,ATX,EFR
  ,AAX,B6
  ,UZA,RG2
  11,AEX,FR
  11,ATX,FR
  11,XTA,FUL
  ,UZA,OШЭK0
  ,ASN,64-6
  11,ATX,FUL
  ,YTA,
  ,NTR,3
  ,A-X,C50
  ,UZA,OШЭK0
  ,A+X,C50
  11,ATX,EFR
  11,A-X,FR
  ,U1A,OШЭK0
  RG2:11,XTA,EFR
  ,ARX,B1
  11,ATX,EFR
  11,XTA,FR
C..
  Ц OП:11,WTC,S12
   12,VTM,
C
C... ПPOBEPKA CTATYCA MAT.ЛИCTA
C
  ПPOB ЛИ:,24,2003B
  ,ATI,13
  ,WTC, Г Y C
  13,UTM,TMATH
  13,XTA,
  ,ASN,64+30
  12,UZA,.HE ЗAKAЗAH
  ,AEX,B18
  12,UZA,1.HE ПOTPEБЛЯЛCЯ
  ,AAX,C177
  12,UZA,2.B ПOДKAЧKE
  12,UJ,3 .B ПAMЯTИ
C
C... OTKAЗ OT ЛИCTOB OП
C
  OTK OП:12,VJM,MEMORY
  :,UJ,KЦ OП
  :,UJ,Д OП1
  :11,XTA,FR
  ,U1A,OTK ПOДK
  :,WTC, Г Y C
  13,VTM,
C
C... OTKAЗ OT ЛИCTA, KOTOPЫЙ B ПAMЯTИ
C
  ,ITA,11
  ,ATX,SYM
  ,ITA,5
  ,ATX,TEX
  11,WTC,FR
  11,VTM,.MAT.HOMEP
  11,VZM,OШ/ЭK.0-Й ЛИCT
  14,MTJ,15
  5,CALL,CLOS PAGE
  15,MTJ,12
  ,WTC, Г Y C
  15,VTM,
  14,CALL,PUT TMP
  12,MTJ,14
  ,WTC,TEX
  5,VTM,
  ,WTC,SYM
  11,VTM,
  ,WTC, Г Y C
  13,VTM,
 13,XTA,41B
 ,ARX,=7777 7777 7777 7776
 13,ATX,41B
  11,WTC,FR
  13,UTM,TMATH
 13,XTA,.XAPAKTEPИCTИKA
 ,ASN,64+30.
 ,ATI,15.N ФИЗ.ЛИCTA
 ,ASN,64-30.
 13,AEX,.* ГACИM
 13,ATX,.* TMATH
 ,XTA,B7
 15,AAX,TPHYS.* ГACИM
 15,ATX,TPHYS.* TPHYS
  ,UJ,KЦ OП
C
C... OTKAЗ OT ЛИCTA, KOTOPЫЙ B ПOДKAЧKE
C
  OTK ПOДK:,AOX,B42
  11,ATX,KTP
 13,XTA,
 ,AEX,B47
 13,ATX,
  12,VTM,1
  13,VTM,KЦ OП
  ,UJ,ЧИCTKA
C...
 ЗAM OП:,BSS,.
C.....   CMEHA HOMEPOB ЛИCTOB OП
   :    ,24,3
  ,XTA,ГYC
  ,AAX,C77777
  11,ATX,S12
  ,XTA,ДHЗ
  ,ASN,64-27
  11,AOX,S12
  11,ATX,S12
  11,ATX,S15
  11,ATX,SUM
 12,VJM,GIV1
 15,VZM,NRSRET
 11,ATX,FR1.HOMEP
 11,ATX,EFR.CTAPOГO 1-ГO
 12,VJM,GIV1
 15,VZM,OШЭK 0. = HET 2-ГO
C.....   BXOД OT ,*50,212B :
  ЗAM 2Л:11,XTA,S12
  ,ATI,15."CBOE" ИПЗ
  :,24,2003B. !!!
  15,UTM,17.MECTO И5
C
C      ДOЖИДAEMCЯ OKOHЧAHИЯ OБMEHOB
C
 11,XTA,S15
 11,ARX,FR
 ,ATI,13
 11,XTA,S12
 11,AEX,S15
   ,AAX,C77777
   ,UZA,ЗAM
 13,XTA,TMATH
  11,WTC,EFR
  15,AOX,TMATH-17
 ,AAX,B46.CM.MACRO70
  ,UZA,ЗAM
  13,VTM,13B
  13,MTJ,27B
  14,MTJ,13
  ,*57,3
  13,MTJ,14
  ,UJ,ЗAM 2Л
C
C...   COБCTBEHHO ЗAMEHA CTPAHИЦ
C    1. YПPЯTЫBAHИE PEГИCTPOB 1-5
C
  ЗAM:,24,2003B
  ,ITA,5
  ,ITS,4
  ,ITS,3
  ,ITS,2
  ,ITS,1
  15,ATX,
  11,MTJ,1
  14,MTJ,4
  4,REL,BAS.***
  15,VTM,-1
C
C    2. BЫБOPKA XAPAKTEPИCTИK ЛИCTOB
C
  ЗAM1:1,XTA,EFR
  ,ATI,11.MAT.ЛИCT
  ,AAX,C3
  ,ATI,12
  12,XTA,M12B
  15,ATX,M/ПTP+1.MACKA ПTP
  ,ITA,11
  ,ASN,64+2
  1,ARX,S12
  15,ATI,3.AДPEC B ПTP
  1,WTC,S12
  11,XTA,TMATH
  15,ATX,C/TM+1.KOПИЯ TMATH
  ,ASN,64+30
  ,AAX,C177
  ,UZA,KЗAM1
C
C    3. ECЛИ ЛИCT B MOЗY, MEHЯEM
C       EГO ИДEHTИФИKATOP B TPHYS
C
  ,ATI,5.ФИЗ.ЛИCT
  1,WTC,S12
  13,VTM,."CBOE" ИПЗ
  1,XTA,FR
  ,ASN,64-21
  1,AOX,S15."ЧYЖOЙ" ИДEHT.
  ,ATI,12."ЧYЖOE" ИПЗ
  5,AEX,TPHYS
  ,AAX,B33/22
  5,AEX,TPHYS
  5,ATX,TPHYS
C
C    4. KOPPEKЦИЯ ЧИCЛA ЛИCTOB B MOЗY
C
  ,XTA,B1.HOBOMY
  12,ARX,NPPW.BЛAДEЛЬЦY
  12,ATX,NPPW.ПPИБЫЛO,
  ,XTA,=7777 7777 7777 7776
  13,ARX,NPPW.Y CTAPOГO
  13,ATX,NPPW. - YБЫЛO
  5,CALL,CLOSPAGE.OTПИCKA
C...
  KЗAM1:1,UTM,1
  15,VLM,ЗAM1
C
C    5. ПEPECTAHOBKA B ПTP
C
  15,VTM,A/ПTP
  2,XTA,ПTP
  ,APX,M/ПTP
  3,XTS,ПTP
  ,APX,M/ПTP+1
  15,AEX,
  15,ATX,
  ,AUX,M/ПTP
  2,AEX,ПTP
  2,STX,ПTP
  ,AUX,M/ПTP+1
  3,AEX,ПTP
  3,ATX,ПTP
C
C    6. ПEPECTAHOBKA B TMATH
C
  3,VTM,-1
  ЗAM2:1,XTA,FR-2
  1,ARX,S15-2
  ,ATI,13."ЧYЖOE" ИПЗ
  3,XTA,C/TM+1."CBOЯ" CTPOKA
  13,AEX,TMATH
  ,AAX,B48/31
  13,AEX,TMATH
  13,ATX,TMATH
  ,ASN,64+30
  ,ATI,13.ФИЗ.ЛИCT
  1,UTM,-1
  ,AAX,B17.ЗAKPЫT ПO
  ,U1A,KЗAM2.ПPИOPИTETY
  13,VZM,KЗAM2.ИЛИ YKAЧAH
  15,CALL,OPENPAGE.ПPИПИCKA
  KЗAM2:3,VLM,ЗAM2
C
C    7. YCTAHOBKA PП И PЗ
C
  1,MTJ,11
  ,WTC,ГYC
  15,VTM,
  14,CALL,PUT TMP
C
C    8. BOCCTAHOBЛEHИE PEГИCTPOB
C
  15,UTM,-2
  4,MTJ,14
  14,REL,BAS.***
  11,XTA,S12
  11,AEX,S15
  ,STI,12
  ,STI,1
  ,STI,2
  ,STI,3
  ,STI,4
  ,ATI,5
  :,24,3
  12,VZM,ЗAM OП
  ,UJ,RET/212
C-----------------------
 OTK MЛ:,BSS,.
C.....   OTKAЗ OT MAГHИTHЫX ЛEHT
  ,XTA,
  11,ATX,SWORD
  OTKMЛ1:12,VJM,GIV1
  ,UZA,OTKMЛ2
  ,ATI,12
  12,XTA,B48-30B
  11,AOX,SWORD
  11,ATX,SWORD
  ,UJ,OTKMЛ1
  OTKMЛ2:,XTA,DISREG
  ,ATI,27B
  11,XTA,SWORD
  ,UZA,NRS RET
  14,MTJ,12
  ,*57,4000B
  12,MTJ,14
  ,UJ,NRS RET
 OTK MБ:,BSS,.
C......   OTKAЗ OT ИCПOЛЬЗOBAHHOЙ MБ-ПAMЯTИ
 Ц MБ:12,VJM,GIV1.ЗA HOMEPOM MБ
  15,VZM,NRS RET.- * BCE
 ,UZA,Ц MБ.- ПYCTOЙ ФPAГM.
 ,ASN,64+3.
 ,AAX,C3.
 ,AEX,C3.
 ,UZA,OШЭK 0.- HE MБ
 11,XTA,FR.
 ,AAX,C37.ЗAГOTOBKA
 ,ASN,64-5. KOДA MБ
 11,ATX,KTP.
 11,XTA,FR.
 ,AAX,B6.  OTKAЗ
 ,UZA,TPAKT.- ПO TPAKTAM
  12,VTM,32
 13,VTM,Ц MБ.OT MБ
 ,UJ,ЧИCTKA.ПOЛHOCTЬЮ
 TPAKT:,BSS,.
 12,VJM,GIV1.N HAЧ. TPAKTA
 15,VZM,OШЭK 0.
 ,UZA,Ц MБ.- KOHEЦ TPAKTOB
 11,AEX,KTP
 ,AAX,C37
 11,AEX,KTP
  13,VTM,TPAKT
 11,ATX,KTP.
 11,XTA,FR.
 ,AAX,B6.
 12,VTM,1.
  ,UZA,ЧИCTKA
  12,VJM,GIV1.
 15,VZM,OШЭK 0.- HET KOЛ-BA
 ,AAX,C37.
 ,UZA,OШЭK 0.
 ,ATI,12.
  ,UJ,ЧИCTKA
 OTKMБ Д:,BSS,.
C.....   OTKAЗ OT MБ , ЗAДAHHЫX ШKAЛOЙ
 11,XTA,FUL.
 ,AOX,B24/1.
 ,AEX,B24/1.
 11,ATX,FUL.
 ,XTA,C37.
 11,ATX,KMБ.
 ЦMБ Д:11,XTA,FUL.
 ,UZA,NRS RET.- BCE MБ
 11,ANX,KMБ.
 11,ATX,KMБ.
 ,YTA,.
 11,ATX,FUL.OCTATOK MБ
 11,XTA,KMБ.
 ,AAX,C37.
 11,ATX,KMБ.
 ,ASN,64-5.
 11,ATX,KTP.
  12,VTM,32
 13,VTM,ЦMБ Д.
 ЧИCTKA:,BSS,.
C.....   OTKAЗ OT ЗAДAHHЫX MБ / TPAKTOB
  ,ITA,13
  11,ATX,KДHЗ
  MAKADR:,24,2003B
  ,WTC, Г Y C
  15,VTM,12.MECTO И.P.10
  ,ITA,10
  ,ITS,9
  ,ITS,8
  ,ITS,7
  ,XTS, Д H З
  ,ASN,64-42
  11,AOX,KTP
  11,ATX,KTP
  ,ATX,DRIDENT
  14,MTJ,15.CПACEM БAЗY
  ,CALL,TAKETR*.HA П/П OTKAЗA
  15,MTJ,14.BOCCT.БAЗЫ
  11,XTA,KTP
  ,AEX,C37
  ,AAX,C37
  ,UZA,KOЛЬЦYEM
  11,XTA,KTP
  ,ARX,B1
  ,UJ,CЛEДTP
  KOЛЬЦYEM:11,XTA,KTP
  ,AAX,=7777 7777 7777 7740
  CЛEДTP:,WTC,ГYC
  15,VTM,16
  11,STX,KTP
  ,STI,7
  ,STI,8
  ,STI,9
  ,ATI,10
   :    ,24,3
  12,UTM,-1
  12,VIM,MAKADR
  11,WTC,KДHЗ
  ,UJ,
 ПEЧ MБ:,BSS,.
C.....   ПEЧATЬ ИCПOЛЬЗOBAHHЫX TPAKTOB
 11,XTA,SWORD.
 ,ATI,12.MACCИB ШKAЛ
 13,VTM,1-24.
 ,XTA,.
   :   ,24,.
 ПБ 1:13,UTC,23. EГO ЧИCTKA
 12,ATX,.
 13,VLM,ПБ 1....
   :    ,24,3
  11,ATX,KTP
  ПБ2:,BSS,
  11,XTA,KTP
  ,ASN,64+2
  ,ARX, Г Y C
  ,ATI,13.AДPEC B MATMБ
  11,XTA,KTP
  ,AAX,C3
  ,ATI,15
  15,XTA,M12B
  13,AAX,MATMБ
  ,UZA,ПБ3
  11,XTA,KTP
  ,AAX,C37
  ,ATI,15.N TPAKTA
 11,XTA,KTP.
 ,ASN,64+5.
 11,ARX,SWORD.
 ,ATI,13.AДPEC ШKAЛЫ
  15,XTA,B48
   :   ,24,.
  13,AOX,
 13,ATX,.
  ПБ3:,24,3
  11,XTA,KTP
  ,ARX,B1
  11,ATX,KTP
  ,ASN,64+8
  ,AEX,C3
  ,U1A,ПБ2
 11,XTA,SWORD.
 ,AAX,B16. ПEЧATЬ
 ,U1A,NRS RET.- БЛOKИPOBAHA
  11,ATX,EFR
  11,MTJ,15
  ,WTC,ГYC
  11,VTM,
C.....   OPГAHИЗAЦИЯ ПEЧATИ TAБЛИЦЫ
 Ц ПEЧ:,24,3.
  15,XTA,SWORD
  15,ARX,EFR
  ,ATI,13
   :   ,24,.
 13,XTA,. ШKAЛA
   :   ,24,2003B.
  15,ATX,FR
  13,VTM,INFTR-BAS
  12,VJM,PRINT
  15,XTA,EFR
  ,ARX,B1
  15,ATX,EFR
  ,ASN,64+3
  ,AEX,C3
  ,U1A,Ц ПEЧ
 ,UJ,NRS RET.HA BOЗBPAT
 ЗAM MБ:,BSS,.
C.....   ПEPEИMEHOBAHИE MATEMAT. MБ
 З MБ:12,VJM,GIV1.ЗA MБ1
 12,VJM,ПPO MБ1.EГO ПPOBEPKA
  15,MTJ,13
 12,VJM,GIV1.ЗA MБ2
 12,VJM,ПPO MБ2.
   :    ,24,2003B
  12,VTM,-7
  ПOДCT:15,XTA,MATMБ
  ,AEX,
  13,XTA,MATMБ
  15,ATX,MATMБ
  ,YTA,
  13,ATX,MATMБ
  13,UTM,1
  15,UTM,1
  12,VLM,ПOДCT
   :   ,24,3
 ,UJ,З MБ.HA CЛEД.ПAPY MБ
 ПPO MБ1:15,VZM,NRS RET.- * BCE
 ПPO MБ2:15,VZM,OШЭK 0.- HET MБ2
  ,ATI,15
 ,ARX,B4.
 ,ASN,64+5.
 ,U1A,OШЭK 0.
  ,WTC, Г Y C
  ,XTA,DRU/MEM
  15,AAX,B48
  ,U1A,OШЭK0
 11,XTA,FR.
  ,ASN,64-3.*8
  ,ARX, Г Y C
  ,ATI,15
 12,UJ,.
 ,BSS,.
C.....   П/П ПOЛYЧEHИЯ ФPAГMEHTOB
C        ИЗ ИHФ.CЛOBA ЭK72
 GIV1:11,XTA,FUL.
 ,UZA,OШЭK 0.
 ,ASN,64-6.
 11,ATX,FUL.
 ,YTA,.
 11,ATX,FR.
 15,VTM,0.
 ,AEX,C77.
 12,UZA,.
 15,VTM,1.
 ,AEX,C77.
 12,UJ,.
C-----   HA 'NEWTA' БEЗ OTKAЗA OT HEPEЗИДEHTA
  PROCRET:,BSS,
 13,VJM,BOCCTAH
 ,WTC,ГYC
 ,XTA,SCEM
 ,ASN,64-24
 ,AUX,DISREG
 ,ATI,27B
 ,ITA,32B
 ,ATI,33B
 ,UJ,NEWTA
C---
  Э207:,BSS,
C     MOHOПOЛИЗAЦИЯ KBY-HAПPABЛEHИЯ MЛ
C     ПEPEXBAT ПPOXOДA ЗOHЫ MЛ.
  ,AAX,C7
  ,ATI,15.HAПP-E
  ,ARX,B1
  ,AAX,B3
  ,UZA,OШ/ЭK
  15,XTA,TYPEMT-3
  ,ASN,64+18
  ,ATI,13.COПPЯЖ.HAПP.
  ,XTA,DISREG
  ,ATI,27B
  15,XTA,CHBOSS-3
  ,UZA,FREE/CH
  ,ASN,64+24
  ,AAX,C77
  ,AEX, Д H З
  ,U1A,OШ/ЭK.ЗAHЯTO
  FREE/CH:,XTA,SAVAC
  ,AAX,C77777
  13,ATX,CHBOSS-3
  15,ATX,CHBOSS-3.ЗAXBAT
  14,MTJ,11
  ,UZA,TOCH/.OCBOБOЖДEHИE
  ,XTA, Д H З
  ,ASN,64-24
  15,AOX,CHBOSS-3
  15,ATX,CHBOSS-3
  13,ATX,CHBOSS-3
  ,XTA,SAVAC
  ,ARX,
  ,U1A,NRSRET.БEЗ ПEPEXBATA
C--  ЗAДEPЖKA ДЛЯ TOГO, ЧTOБЫ B
C    HAПPABЛEHИИ BCE YTИXЛO.
  ,XTA,NUMB+4.10 CEK.
  ,*57,13B
C--  CTABИM ПPИЗHAK ПEPEXBATA
  ,XTA,B48
  15,AOX,CHBOSS-3
  15,ATX,CHBOSS-3
  11,UJ,BRES-BAS
  TOCH/:15,MTJ,14
  15,CALL,TRA TAPE
  BRES:,24,3
  11,MTJ,14
C
C
C---  BOЗBPAT C OTKAЗOM OT HEPEЗИДEHTA
 NRS RET:,BSS,
 13,VJM,BOCCTAH.
 ,WTC,ГYC
 ,XTA,SCEM
  ,ATX,SAVI14
 ,ASN,64-24.PEЖИM
 ,AUX,DIS REG.BOЗBPATA B
 ,ATI,27B.ЗAДAЧY (И27)
  ,XTA,NR OFF.OTKAЗ OT
  ,ATX,SAVAR.HEPEЗИДEHTA
  ,UJ,NRESOFF+2.И BOЗBPAT
  NR OFF:,Z00,NR EMULAT
  ,Z00,OUTMACRO
 ПEP74/72:,WTC,ГYC
 ,XTA,SCEM
 ПEP74:,BSS,
C.....   ЗAKAЗ HA ПEPEXBAT ЭK74
 11,AEX,I60/74
 ,AAX,C77777
 11,AEX,I60/74
 11,ATX,I60/74.
  ,ATI,13
  ,XTA,BITJ
 ,AOX,ШKП
 13,V1M,ПE 74
  ,AEX,BITJ
 ПE 74:,BSS,
 ,ATX,ШKП
 ,UJ,NRS RET.HA BOЗBPAT
 ЭK50:,BSS,
C*****   ИHTEPПPETAЦИЯ ЭK50
 ,NTR,3
 ,A-X,C50
 ,U1A,OШ/ЭK.AИCП.LT.50
 ,A-X,C60
 ,UZA,CHE050.AИCП.GT.127
 15,XTA,B48-50B
 ,APX,ADR50
 ,UZA,OШ/ЭK.ПЛOXOЙ AИCП
 ,ANX,
 ,ATI,15
 ,NTR,2
 ,XTA,SAVAC
 15,UJ,SW50-1
 ADR50:,BSS,
 ,GOST,6H'377''317''377''377''076''010'
 SW50:,BSS,
C-----   ПEPEKЛЮЧATEЛЬ AДPECOB ЭK50
 :,AAX,C77777.YCTAH.ДEШИФP.
 ,UJ,A50
 :11,XTA,ПYПP.OTKAЗ OT BETBЛ.
 ,UJ,A51
 :,ASN,64+24.YCTAH.MACKИ
 ,UJ,A52
 :11,XTA,MC.ЗAПPOC MACKИ
 ,UJ,A53*55
 :,AAX,B24.YCTAH.COБЫTИЯ
 ,UJ,A54
 :11,XTA,ШC.ЗAПPOC ШKAЛЫ
 ,UJ,A53*55
 :,XTA,БЛOK.БЛOK.BETBЛEH.
 ,UJ,A56
 A57/0:,XTA,БЛOK.ДEБЛOK.BETBЛEH.
 ,UJ,A57
 :11,XTA,П YПP.BOЗBPAT ИЗ BETBИ
 ,UJ,A60
 :11,XTA,MC.ЗAKP.ДO COБЫTИЯ
 ,UJ,A61
 :,ATI,12.ЗAПИCЬ *NAME
 ,UJ,Э64. (64)
 :11,VTM,-1. -TAPES-
 ,UJ,TAPES. (65)
 :,,.ЗAПPOC ДИPEKTИBЫ
 ,UJ,Э66
 :12,VTM,TAЦПY. -DATE*-
 ,UJ,Э67
 SW63:,BSS,
 :,,.OCTATOK BPEMEHИ
 ,UJ,Э630. (70)
 :,,.ПEЧATЬ BPEMEHИ
 ,UJ,Э631. (71)
 :,,.ЛИMИT BPEMEHИ
 ,UJ,Э632. (72)
 :,,.BPEMЯ HA ABOCT
 ,UJ,Э633. (73)
 :,,.ПEPEXBAT ЭK74
 ,UJ,ПEP74. (74)
 :,,.KOMAHД.CBEPTKA
 ,UJ,Э075
  :11,VTM,-13.-TELOUT-
 ,UJ,Э76
 :,,.-FIMFIX-
 ,UJ,Э77
 :11,XTA,PASS.BЫДAЧA ШИФPA
 ,UJ,RET AC. (100)
  :11,XTA,SAV NER.ПPИЧИHA
  ,UJ,Э101.ABOCTA
  :,ASN,64-30.YCT.KPATHOCTИ
  ,UTC,B31/36 - C77777.ИЛИ
  :15,VTM,.AДPECA
  ,UJ,Э102/103.ABOCTA
 :,ATI,12.BЫДAЧA ФAM.
 ,UJ,Э104.ПOЛЬЗOBATEЛЯ
 :,,.ЗAПPOC N TOMA
 ,UJ,Э105
 :11,XTA,ФИO.BЫДAЧA ФAMИЛИИ
 ,UJ,RET AC.Э106
 :11,XTA,ФИO+1.BTOPAЯ ЧACTЬ ФAM.
 ,UJ,RET AC.Э107
 :11,VTM,-1.YCTAH.CДBИГA MЛ
 ,UJ,Э112
 :,,.ЗAПPOC CДBИГA MЛ
 ,UJ,Э113
 :,XTA,TODAY.ЗAПPOC ДATЫ
 ,UJ,Э114
  :,,.115,116 -
  :,UJ,NRS RET.- ПYCTЫE
 :,UJ,NRS RET.124 - ПYCTOЙ
 CHE050:,BSS,
  11,XTA,SCEM
  ,AAX,C1777
  ,ATI,13
C..  ПPOБA HA ЭK PAБOTЫ C ИПЗ :
C     ,*50,AДP
C     AДP =     15-13   12-11   10-1 PAЗPЯДЫ
C                 7      TИП    AДPEC ПO ИПЗ
C                              +CMEЩEHИE
C..   TИП = 0   ЧTEHИE ИПЗ
C     TИП = 1   ЗAПИCЬ B ИПЗ
C     TИП = 2   OПEPAЦИЯ 'OR'
C     TИП = 3   OПEPAЦИЯ 'AND'
C............................................
  CMEЩEHИE:,EQU,100B
  11,XTA,SCEM
  ,ASN,64+10
  ,AAX,C37
  ,AEX,C34
  ,ATI,12
  ,UZA,NOCHREG
  ,ASN,64+2
  ,UZA,CHREG
  15,MTJ,12
  12,UTM,4-200B
  ,ITA,12
  ,A-X,B5
  ,UZA,OШ/ЭK
  12,XTA,B48-4
  ,AAX,ЭK200/R
  ,UZA,NOCHREG
  CHREG:,BSS,
C.. ПPOBEPKA PEЖИMA
  ,XTA,3
  ,WTC,ДHЗ
  ,APX,BITS-NMAT1
  11,AOX,REGSCAL
  ,AAX,B48
  ,UZA,OШ/ЭK
  NOCHREG:,BSS,
  ,XTA,SAVAC
  11,J+M,13
  12,UJ,ЭK/ИПЗ
  ЭK/ИПЗ:13,XTA,-CMEЩEHИE.ЧTEHИE
  ,UJ,RETAC
  *WR:13,ATX,-CMEЩEHИE.ЗAПИCЬ
 ,UJ,RETAC
  :13,AOX,-CMEЩEHИE.OR
  ,UJ,*WR
  :13,AAX,-CMEЩEHИE.AND
  ,UJ,*WR
C..  ПEPEKЛЮЧATEЛЬ ЭK50/200-210/
  :,ASN,64+10
  ,UJ,Э200
  :,,
  ,UJ,Э201
  :12,VTM,-2
  ,UJ,Э202
  :,,
  ,UJ,Э203
  :,XTA,ГYC
  ,UJ,RETAC
  :,24,3.BBOД CTPOKИ
  ,UJ,Э205.C OПEP.TEPM.
  :13,VTM,
 ,UJ,Э206.STOP JOB
  :,ASN,64+15
  ,UJ,Э207.MNPL-KBY
  :,,
  ,UJ,Э210.SEMAFOR
  :,ATI,13
  ,UJ,Э211.CLOSE
  :,24,3
  ,UJ,Э212.ДAЙ ИПЗ
  :,APX,=377 1777 77777
  ,UJ,Э213
C
C=====   ЭKCTPAKOДЫ BETBЛEHИЯ   =====
C
 A50:,BSS,
C
C.....   AДPEC ДEШИФPATOPA +
C        PEKYPCИBHOCTЬ BETBЛEHИЯ +
C        MACKA ШKAЛЫ COБЫTИЙ
C
 11,ATX,ДШ
 12,VTM,-3
 A50/1:12,UTC,3
 11,XTA,П YПP
 ,AAX,B48/31
 12,UTC,3
 11,ATX,П YПP
 12,VLM,A50/1
 ,XTA,SAVAC
 ,AAX,B20/16
 ,UZA,OШ/ЭK
 11,AOX,П YПP
 11,ATX,П YПP
 ,AAX,B20/16
 ,ASN,64+11
 ,NTR,3
 11,X-A,ДШ
 11,AEX,ДШ
 ,AAX,C76000
 ,U1A,OШ/ЧYЖ
 ,XTA,SAVAC
 ,ASN,64+24
 11,AOX,MC
 11,ATX,MC
 11,XTA,ДШ
 15,VJM,FIM FIX
 ,XTA,SAVAC
 11,AOX,П YПP
 11,ATX,П YПP
 11,AEX,ДШ
 ,AAX,C76000
 11,AOX,M/Ф
 11,ATX,M/Ф
 ,UJ,NRS RET
 A51:,BSS,
C
C.....   OTKAЗ OT BETBЛEHИЯ
C
 ,AAX,C77777.ДEШИФPATOPA
 ,UZA,A51/1.= HE БЫЛO
 ,ASN,64+10
 ,ATI,12
 12,XTA,TPHYS.PACФИKCAЦИЯ
 ,AEX,B1. ЛИCTA
 12,ATX,TPHYS.ДEШИФPATOPA
 ,XTA,
 A51/1:11,ATX,ДШ
 ,UJ,NRS RET
 A52:,BSS,
C
C.....   YCTAHOBKA MACKИ ШKAЛЫ COБЫTИЙ
C
 ,ATX,SAVAR
 11,XTA,MC
 ,AAX,B48/31
 ,AOX,SAVAR
 11,ATX,MC
C.....   ГACИTЬ ЛИ ЗAДAHHЫE COБЫTИЯ
 ,XTA,SAVAC
 ,AAX,B24
 ,U1A,YCT B. = HET
 A52/1:,XTA,SAVAR
 ,AEX,FULWOR
 11,AAX,ШC
 11,ATX,ШC
C.....   COБЫTИE : KOHEЦ OБMEHA
 ,XTA,SAVAR
 ,AAX,B24
 ,UZA,NRS RET. = HET
 11,XTA,ДШ.ГAШEHИE
 ,AAX,B16/1. ШKAЛЫ
 ,UJ,A51/1.OKOH.OБMEHOB
C.....
 YCT COБ:,XTA,SAVAC
 ,ASN,64+24
 11,AOX,ШC
 11,ATX,ШC
 YCT B:,BSS,
C.....   HE ПOЛYЧИЛOCЬ ЛИ COБЫTИЯ
 11,XTA,ШC
 11,AAX,MC
 ,ASN,64-24
 ,UZA,NRS RET. = HE ПOЛYЧИЛOCЬ
 11,XTA,M/Ф
 ,AOX,BETB
 11,ATX,M/Ф
 ,UJ,PROC RET
 A53*55:,BSS,
C
C.....   ЗAПPOC MACKИ/ШKAЛЫ COБЫTИЙ
C
 11,AAX,MC
 ,ASN,64-24
 ,ATX,SAVAC
 ,UJ,NRS RET
 A54:,BSS,
C
C.....   YCTAHOBKA/ГAШEHИE ШKAЛЫ COБЫTИЙ
C
 ,U1A,YCT COБ.= YCTAHOBKA
 ,XTA,SAVAC
 ,ASN,64+24
 ,ATX,SAVAR.HA ГAШEHИE
 ,UJ,A52/1. COБЫTИЙ
 A56:,BSS,
C
C.....   БЛOKИPOBKA BETBЛEHИЯ
C
 11,AOX,ДШ
 ,UJ,A51/1
 A57:,BSS,
C
C.....   CHЯTИE БЛOKИPOBKИ BETBЛEHИЯ
C
 ,AEX,FULWOR
 11,AAX,ДШ
 11,ATX,ДШ
 ,UJ,YCT B
 A60:,BSS,
C
C.....   BOЗBPAT ИЗ BETBИ
C
 ,ATI,15
 11,AEX,ДШ
 ,AAX,C1777
 ,UZA,OШ/ЭK. = HET BETBEЙ
C.....   OTKPЫTИE ЗAKPЫTЫX ПO
C        PEKYPCИBHOCTИ BETBЛEHИЯ
 11,XTA,П YПP
 ,ARX,B16*5
 11,ATX,П YПP
 ,XTA,БЛOK
 ,AEX,FULWOR
 ,ATX,WORD
 11,AAX,M/Ф
 11,ATX,M/Ф
 15,UTM,13
 ,XTA,SAVAC.ПPИ CYM. HE 0
 ,U1A,NCLДШ.БЛOK HE YБИPEAM.
 ,XTA,WORD
 11,AAX,ДШ
 11,ATX,ДШ
C.....   BOCCTAHOBЛEHИE ЗAДAЧИ ИЗ ПOЛЯ YПP.
 NCLДШ:,BSS,
 15,XTA,
 11,STX,REGSCAL
 ,STI,11
 ,STI,12
 14,VTM,NEWTA
 ,UJ,BOC ИПД
 A61:,BSS,
C
C.....   CAMOЗAKPЫTИE ЗAДAЧИ ДO BETBЛEHИЯ
C
 ,AAX,B24/1.ЗAKPЫBAEMCЯ , A
 ,UZA,OШ/ЭK.B MACKE-ПYCTO
 11,AAX,ШC
 ,U1A,A57/0.ECTЬ COБЫTИЯ
 11,XTA,M/Ф
 ,AOX,ЗAKP
 11,ATX,M/Ф
 13,VTM,PROC RET
 ,UJ,CL OPER
C
C=====
C
 Э075:,BSS,.
C.....   YCTAHOBKA PEЖИMA ЗAПИCИ KOMAHД
 11,XTA,REGSCAL.
 ,AOX,B4.
 ,AOX,B46.
 ,AEX,B46.
 11,ATX,REGSCAL.
C.....   CHЯTИE OCTAHOBA ПO И35
 ,XTA,.
 11,ATX,27B.
 ,UJ,NRS RET.
 Э101:,BSS,.
C.....   BЫДAЧA ПPИЧИHЫ ABOCTA
 11,AEX,SCEM
 ,AAX,C77777
 11,AEX,SCEM
 11,ATX,SCEM
C     HA BЫXOДE B И14 - AДPEC ABOCTA
 11,XTA,OШBHYПP.
 ,ASN,64+39.
 ,AAX,C177.
 ,ATX,SAVAC
 ,ASN,64-39
 ,UJ,Э101/1.C ПEPEXBATOM
  B5TOS:,BSS,
 ,XTA,B5.(ЧYЖOЙ ЛИCT)
 ,UJ,RET S.
  Э102/103:,BSS,
C.....   KPATHOCTЬ ABOCTOB
C.....   AДPEC BXOДA ПO ABOCTY
  11,AEX,OШBHYПP
  15,AAX,C77777.ИЛИ B31/36
 Э101/1:,BSS,
  11,AEX,OШBHYПP
 11,ATX,OШBHYПP.
 11,XTA,REGSCAL.
 ,AOX,BITININ
 11,ATX,REGSCAL.
 ,UJ,NRS RET
 Э105:,BSS,.
C.....   ЗAПPOC HOMEPA TOMA
 15,VJM,GIV MT.
  11,VTM,1-LFATA
  ,UZA,TO ISO
  SFATA:11,XTA,FATA+LFATAM1
  15,AEX,SUM
  ,AAX,B48/37
    ,UZA,B5TOS
  11,VLM,SFATA
  NEGR*212:,BSS,
  BP 3 :,BSS,
  Э5/1:,XTA,
  ,UJ,RET AC
  TO ISO:12,XTA,TNAM-30B
  12,VTM,-2
  Э202:,BSS,
C..... ПOЛYЧEHИE HOMEPA БOБИHЫ B ISO
 ,AAX,C7777.
  ,ATX,SAVAC
  13,VJM,GIVADR
  ,XTA,SAVAC
  15,ATX,SUM
  :,24,3
  ,ATI,11
  ,ASN,64-36
  ,AUX,C171717
  ,ARX,C060606
  ,AAX,C202020
  15,ATX,SWORD
  ,UZA,FIN/2105
  **1:12,XTA,CON/2105+2
  15,ATX,FUL
  ,ASN,64+22
  15,AAX,SWORD
  ,U1A,TRAN2105
  15,XTA,FUL
  ,ASN,64+15
  ,AAX,C1777
  ,ATI,13
  13,J+M,11
  15,XTA,SUM
  15,ASX,FUL
  ,AAX,C17
  ,ATI,13
  ,UJ,**4
  **2:,BSS,
  13,UTM,-1
  12,WTC,CON/2105+3
  11,UTM,
  **4:13,VIM,**2
  12,VLM,**1
C
C...   ПEPEBOД BOCЬMEPИЧHOГO KOДA
C      B  2-10  CИCTEMY :
C
  TRAN2105:,24,2003B
  ,ITA,11
  15,MTJ,13
  15,CALL,DECLET
  :,24,3
  13,MTJ,15
  ,APX,=6H'''''17''17''17''17'
  ,ASN,64+32
  15,ATX,SUM
  FIN/2105:15,XTA,SUM
  ,WTC, Г Y C
  ,WTC,SCEM
  13,VTM,-105B
  13,VZM,RET AC
  ,ASN,64-32
  ,AUX,=6H'''''17''17''17''17'
  ,AOX,=6H''''0000
  ,UJ,RET AC
  Э203:,BSS,
C.... ПEPEBOД NБOБ ИЗ 2-10 KOДA B T1MT
  ,ASN,64-32
  ,ATX,SAVAC
  13,VJM,GIVADR
  ,XTA,SAVAC
  11,VTM,-3
   :    ,24,3
  15,ATX,SUM
  ,XTA,
  15,ATX,FUL
  /3105/:15,XTA,FUL
  ,ASN,64-1
  15,ATX,EFR
  ,ASN,64-2
  15,ARX,EFR
  15,ATX,FUL
  15,XTA,SUM
  ,ASN,64-4
  15,ATX,SUM
  ,YTA,
  15,ARX,FUL
  15,ATX,FUL
  11,VLM,/3105/
  Э201:,BSS,
C.... ПEPEBOД NБOБ ИЗ ДBOИЧHOГO KOДA B T1MT
   :    ,24,3
  5,MTJ,11
  6,MTJ,12
  9,MTJ,13
   :    ,24,2003B
  5,CALL,MTDISPAC
  13,MTJ,9
  12,MTJ,6
  11,MTJ,5
  ,AAX,C7777
  ,ATX,SAVAC
  ,UJ,NRSRET
 Э112:,BSS,.
C.....   ЗAДAHИE CДBИГA ПO MЛ
C   ПPOЧИCTKA "ДOБPA" OT BOЗMOЖHЫX ПOЧИTATEЛEЙ TЮPИHA
 ,AAX,MAS/T1
 ,ATX,SAVAC
 TAPES:13,VJM,GIVADR
 ,XTA,SAVAC
 15,ATX,TAЦПY+6
 MAK/PT:,24,3
 ,AAX,MAS/T1.BЫБOPKA
 11,UTC,1.YKAЗATEЛEЙ
 15,ATX,TAЦПY+2.  MЛ
   :   ,24,2003B
 ,ATX,SAVAC.HOMEPA
 15,VJM,GIV MT. M Ф
 ,UZA,T*72
 ,MTJ,12
 T*72:,ITA,12
 11,UTC,1
 15,ATX,TAЦПY
 15,XTA,TAЦПY+6
 ,ASN,64+24
 11,VLM,MAK/PT
 15,XTA,TAЦПY+1
 15,AOX,TAЦПY
 ,UZA,OШЭK72T.= HИ OДHOЙ MЛ
 15,XTA,TAЦПY+3
 ,UZA,*1MЛ
 15,AEX,TAЦПY+2
 *1MЛ:15,ATX,TAЦПY+4
  11,VTM,1
  DEL///:11,UTC,
 15,XTA,TAЦПY
  11,UTM,-1
 ,UZA,ФИЗПYCTO
 ,ATI,12
 11,UTC,1.MEHЯEM
 15,XTA,TAЦПY+2.YKAЗATEЛИ
 15,AEX,TAЦПY+4.MECTAMИ
 ,APX,MAS/T1.ПOДГOTOBKA
 ,AUX,MAS/T2. HOBOЙ
 ,AOX,B1. CTPOKИ
 15,ATX,TAЦПY+5
 ,XTA,ДHЗ.ДЛЯ ЗAПИCИ
 ,ASN,64-42
 15,AOX,TAЦПY+5.B T1MT
 12,ATX,T1MT-30B
 ФИЗПYCTO:11,VZM,DEL///
 RET S:,BSS,.
 RET AC:,24,2003B
 ,ATX,SAVAC
 ,UJ,NRS RET.
 Э113:,BSS,.
C.....   ЗAПPOC CДBИГA ПO MЛ
 15,VJM,GIV MT.
 ,U1A,Э5/1.HET ЛEHTЫ
 12,XTA,T1MT-30B..
 ,ASN,64+12.
 ,AAX,C1777.
 ,AOX,B48.
 ,UJ,RET AC.
 Э114:,BSS,.
C.....   ЗAПPOC ДATЫ PEШEHИЯ
 ,ASN,64+8.
 ,AAX,B35/17.
 ,ATX,SAVAC. ДATA
 ,XTA,7.
 ,ASN,64+33.
 ,AAX,C7.HOMEP MAШИHЫ
  ORSAV:,BSS,
 ,AOX,SAVAC.
 ,UJ,RET S.
 Э200:,BSS,.
C.....   ЗAПPOC CTATYCA MAT.ЛИCTA
 '    0 - CBOБOДEH
 '    1 - ЗAKPЫT ПO OБMEHY
 '    2 - OБMEH ПPOШEЛ,HO ПЛOXO
 '    3 - B ПOДKAЧKE
 '    4 - HE БЫЛO OБPAЩEHИЯ
 '    7 - BOOБЩE HE ЗAKAЗAH
C.....
 ,AAX,C37.
 ,ATI,15.HOMEP ЛИCTA
  12,VJM,ПPOB ЛИ
  :12,VTM,7
  ,UJ,RETS12
  :12,VTM,4
  ,UJ,RETS12
  :,XTA,
  ,UTC,3
  :12,VTM,
  ,ATI,13.ФИЗ.ЛИCT ИЛИ 0
  11,XTA,ST/EXCH
  15,AAX,B48
  :,UZA,*+2
  11,AEX,ST/EXCH.ГACИM
  11,ATX,ST/EXCH
  12,VTM,2
  :13,XTA,TPHYS
  ,AAX,B7
  ,UZA,RETS12
  12,VTM,1
  RETS12:,ITA,12
  ,UJ,RETS
C    ЭK 0076B (TELOUT)
 Э76:13,VJM,GIVADR
  ,U1A,DO76B
  15,VTM,BUF5076-TAЦПY
 ,XTA,STATMT
 ,ASN,64+42
 ,AEX,ДHЗ
  ,UZA,DO76B
  ,ITA,14
  ,ARX,W///SEM
 ,UJ,SEMDOWNS
  W///SEM:,Z00,SEM/EM
  ,Z00,DO76B-BAS
  DO76B:,BSS,
 ,XTA,SAVAC
 ,ATI,12
  ,AAX,B48/37
  15,ATX,TAЦПY
  *SEND:,24,2000B
  12,XTA,
   :    ,24,3
  11,UTC,13
  15,ATX,TAЦПY+1
  ,AAX,C377
  ,UZA,SOC*76
  12,UTM,1
  11,VLM,*SEND
  ,XTA,
  15,ATX,TAЦПY+15
  SOC*76:,BSS,
  15,UTM,TAЦПY+1
  ,ITA,15
  15,AOX,-1
  15,ATX,-1
  :,24,2003B
 14,MTJ,11
 ,XTA,STATMT
 ,ASN,64+42
 ,AEX,ДHЗ
  ,UZA,ЗBOH
 OCMOTP:,XTA,TELOUT-1.ECЛИ OЧEPEДЬ
 ,ASN,64+1.CИЛЬHO ЗAБИTA
 11,UZA,ЗBOH-BAS
 ,XTA,DISREG.- БYДEM
 ,ATI,27B.  ЖДATЬ
 ,*57,3.OCBOБOЖДEHИЯ
 11,UJ,OCMOTP-BAS
  ЗBOH:15,XTA,-1
 14,VJM,TELOUT+1
  11,MTJ,14
  ,UJ,NRSRET
C.....   ЭK 0064 - ЗAПИCЬ *NAME
 Э64:13,VTM,-2
 Э64/1:,24,
 13,UTC,2
 12,XTA,
  :,24,2003B
 13,UTC,2
 11,ATX,NAME
 13,VLM,Э64/1
 ,UJ,NRS RET
 ,SPACE,8
 Э104:,BSS,
C     ,  * 5 0  , 1 0 4 B
C  BЫДAЧA ФAMИЛИИ ПOЛЬЗOBATEЛЯ.
C  HA CYMMATOPE :
C    B48   : =1 - ФAM. B ISO,
C              ИHAЧE B GOST'E
C    B15-1 : AДPEC, KYДA ПOMECTИTЬ
C            ФAMИЛИЮ (ДBE ЯЧ.)
 ,ARX,
 ,U1A,Э104/1
 ,UTC,ФИO/ISO-ФИO
 Э104/1:11,UTM,ФИO
 11,XTA,
 :,24,
 12,ATX,
 :,24,2003B
 11,XTA,1
 :,24,
 12,ATX,1
 :,24,2003B
 ,UJ,NRS RET
C    ЭK 0066 - ЗAПPOC ДИPEKTИBЫ.
 Э66:13,VJM,GIVADR.
 ПPЖДY:,XTA,101B.
 ,ATX,SAVAC.
 ,ASN,64-36.
 ,AEX,TTN.
 ,UZA,BЫX/Э.
  11,ATX,KTP
  ,ASN,64-6
  ,U1A,MOЛЧИM
C-----   ПPOБA HA 'TEPMИHATOP'
  ,XTA,ГYC
    ,ASN,64+15
    ,ASN,64-42
  11,AEX,KTP
  ,AEX,OCT50
 ,UZA,BЫX/Э.
  MOЛЧИM:,BSS,
 15,XTA,SUM.
 ,UZA,RET AC.HE ЖДEM.
 14,MTJ,13.
 ,XTA,DISREG.
 ,ATI,27B.
 ,*57,3.ЖДEM
 13,MTJ,14.
 ,UJ,ПPЖДY
 BЫX/Э:,ATX,101B
 ,UJ,NRS RET
C
C       ЭK 0205 - ПPИEM CTPOKИ C OПEP.
C       TEPMИHAЛA. CYMMATOP=AДPEC,KYДA
C       ПИCATЬ COOБЩEHИE (KOД=ISO, KOHEЦ
C       -ПYCTOЙ БAЙT). БИT 16 = 1, ECЛИ
C       OБЯЗATEЛЬHO ДOЖИДAEMCЯ COOБЩEHИЯ
C       HA BЫXOДE CYMMATOP=0, ECЛИ HE
C       БЫЛO COOБЩEHИЯ, ИHAЧE NTT+1.
C
  Э205:13,VJM,GIVADR
  S/MES:12,VTM,ATEL1
  11,VTM,-1
  MESSA:,XTA,ГYC
  ,ASN,64+15
  ,AOX,C1400
  ,AOX,B6
  11,AEX,TELIS+1
  ,AAX,C77777
  ,UZA,MESSB
  12,VTM,ATEL2
  11,VLM,MESSA
  15,XTA,SUM
  ,AAX,B16
  ,UZA,RETAC
  ,XTA,DISREG
  ,ATI,27B
  14,MTJ,13
  ,*57,3
  13,MTJ,14
  ,UJ,S/MES
  MESSB:,24,2003B
  11,ATX,TELIS+1
  15,WTC,SUM
  15,VTM,
  TT1:12,XTA,
  12,UTM,1
  :,24,
  15,ATX,
  :,24,3
  ,AAX,C377
  ,U1A,TT1
  11,UTM,2
  ,ITA,11
  ,UJ,RETAC
C
C    ЭK 0067  (DATE*).
 Э67:13,VJM,GIVADR.
 15,J+M,12
 ,XTA,ASTIME
 13,VJM,K8/10
   :   ,24,2003B.БЛПP
 ,ASN,64-26
 ,AUX,MTIM1
 ,ATX,SAVAC
  ,XTA,TODAY
 ,ASN,64-5
 ,AUX,MTIM2
  ,UJ,ORSAV
C    ЭKCTPAKOД ПEPEHOCA ЛИCTA
C    B 1-Ю ПAMЯTЬ И EГO ФИKCA-
C    ЦИИ.   HA CYMMATOPE -
C    AДPEC ЯЧEЙKИ ЛЮБOГO ЛИCTA,
C    B TOM ЧИCЛE И ФOPMAЛЬHOГO,
C    ПOCЛE BЫXOДA ИЗ ЭKCTPAKOДA
C    ИP 14 COДEPЖИT COOTBETCTBY-
C    ЮЩИЙ ФИЗИЧECKИЙ AДPEC.
 Э77:,BSS,.
 15,VTM,NRS RET
 FIM FIX:,BSS,
 14,MTJ,13
 ,ATI,14
 ,AAX,B16.
 13,REL,BAS
 12,VTM,CALL1MEM
 ,UZA,GIV P
 12,VTM,CALL1FME
 ,XTA,SAVAC
 ,ASN,64+10
 ,AAX,C77
 ,ASN,64-24
 GIV P:,ATX,SAVAC
 13,UTM,TAKP-BAS
 ,ITA,13
 13,UTM,BAS-TAKP
 ,ARX,SAVAC
 12,UJ,
 TAK P:,AAX,C77777
 ,ATX,SAVAC.
 ,ASN,64+10.
 ,ATI,12
 12,XTA,TPHYS.
 ,AOX,B1.ФИKCAЦИЯ
 12,ATX,TPHYS.ЛИCTA
 ,ITA,14
 ,AAX,C1777.
 ,AOX,SAVAC.
 ,ATX,SAVAC.ФИЗ.AДPEC
 ,WTC,Г Y C.
 ,XTA,SCEM.
 ,ASN,64+15.
 ,ASN,64-15.
 ,AOX,SAVAC.
 ,WTC,Г Y C .
 ,ATX,SCEM.
 13,MTJ,14
 14,REL,BAS
 15,UJ,
  Э210:,BSS,
C--    SEMUP/SEMDOWN
  15,VTM,SEMUP
  ,ARX,
  ,U1A,Э210/UP
  15,VTM,SEMDOWNS
  Э210/UP:,ASN,64-24
  ,ARX,W/SEM
  ,ATX,SAVAC
  ,ITA,14
  ,ARX,SAVAC
  15,UJ,
  W/SEM:,Z00,ШЛAГБAYM
  ,Z00,NRSRET-BAS
  Э211:,BSS,
C... ЗAKPЫTИE ЗAДAЧИ C
C    ПPOCTAHOBKOЙ B ШKAЛЫ ИЗ SCALES.
C    CYMMATOP=AДPEC ШKAЛЫ
C    ( OTHOCИTEЛЬHO SCALCLTA ).
  ,XTA,B24
  13,ASN,64
  ,AAX,SC211.ШKAЛA PAЗPEШEHA
  ,UZA,OШ/ЭK.HET
  ,XTA,BITJ
  13,AOX,SCALCLTA
  13,ATX,SCALCLTA
  13,VTM,PROCRET
  ,UJ,CLTASK
 W212:14,MTJ,13.ЖДEM, ПOKA
   ,*57,3.KЛИEHT BЫЙДET
  :,24 ,3.ИЗ KPИT.
 13,MTJ,14.ИHTEPBAЛA
  Э212:,BSS,
C
C... ЭKCTPAKOД PAБOTЫ C ЧYЖOЙ ПAMЯTЬЮ
C    1:6 P.CYMMATOPA - N ЛИCTA KЛИEHTA
C                 И П З = 50 ЛИCT
C    10:15 P. -   Д H З   KЛИEHTA
C    31:35 P. - N CBOEГO MAT.ЛИCTA
C      48     -   ЧTEHИE
C      47     - БEЗ ДЛИTEЛЬHOГO HAPKOЗA
C
  13,VJM,GIVADR
  15,XTA,SUM
  ,ASN,64+9
  ,ATI,12
  ,ASN,64+21
  ,AAX,C77
  15,ATX,EFR.CBOЙ
  15,ATX,FR1.ЛИCT
  15,XTA,SUM
  ,AAX,=6000 0000 0000 0077
  15,ATX,FR.ЧYЖOЙ ЛИCT
  :,24 ,2003B
   ,XTA,DISREG
   ,ATI,27B
 11,VTM,-NSEM1
 S212:,ITA,12.ECЛИ KЛИEHT
 11,AEX,ШЛAГБAYM+NSEM1.CИДИT B
   ,AAX,C77.KPИT.ИHTEPBAЛE
   ,UZA,W212. - HAДO ЖДATЬ
 11,VLM,S212
  ,XTA, Г Y C
  ,AAX,C77777
  15,ATX,S12
  ,XTA, Д H З
  ,ASN,64-27
  15,AOX,S12
  15,ATX,S12.CBOЙ
  15,ATX,SUM.IDENT
  ,XTA,Ш/FULL
  ,AOX,Ш/CЛYЖ
  12,AAX,BITS.KЛИEHT
  ,UZA,NEGR*212.ЗAПPEЩEH
  ,AAX,SCENDJO
  ,U1A,NEGR*212.KOHЧAETCЯ
  12,XTA,*YCЫ
  ,AAX,B30/16
  ,UZA,NEGR*212.KOHЧИЛCЯ
  ,ITA,14
  ,ARX,ASEM212
  ,UJ,SEMDOWNS
  ASEM212:,Z00,SEM212
  ,Z00,БAЙ/БAЙ - BAS
  BSEM212:,Z00,SEM212
  ,Z00,BOЗBPAT - BAS
  БAЙ/БAЙ:,BSS,
C... BPEMEHHЫЙ HAPKOЗ KЛИEHTY
  12,XTA,BITS
  ,ATX,YДABЛEHЫ
  15,MTJ,11
  ,AEX,FULWOR
  ,AAX,MRDSCAL
  ,ATX,MRDSCAL
  ,ITA,12
  ,ASN,64-9
  ,ATI,15
  ,ASN,64-18
  11,ATX,S15
  15,UTM,50B.ИПЗ
  ДAЙ ИПЗ:13,VTM,ДAЙ ИПЗ
  13,MTJ,33B
  13,VTM,GIVEPAGE
  12,XTA,*YCЫ
  ,AAX,C77777
  ,UZA,SAVEMOD.HA ДOБЫЧY
  11,AOX,S15.ЧYЖOЙ
  11,ATX,S15.IDENT
  ,AAX,C76000
  ,ATI,12.ФИЗ.AДP.
  ,ASN,64+10
  ,ATI,15
  15,XTA,TPHYS
  ,AOX,B1.ДOБЫTOГO
  15,ATX,TPHYS.ИПЗ
  :,24,3
  11,XTA,FR
  ,AAX,C77
  ,AEX,C50.HA ЗAMEHY
  ,U1A,ЗAM 2Л.CTPAHИЦ
C.....  TOЛЬKO ДOCTYП K ИПЗ :
  11,XTA,FR
  ,ARX,
  ,U1A,RET/212
  11,XTA,EFR
  ,ASN,64-10
  ,ATI,13.MAT.AДP.
  15,VTM,-1023
  ПEPEПИCЬ:12,XTA,
  12,UTM,1
  :,24,
  13,ATX,
  :,24,3
  13,UTM,1
  15,VLM,ПEPEПИCЬ
  RET/212:,BSS,
  11,XTA,FR
  ,ASN,64+46
  ,AEX,B2
  ,UZA,BOЗBPAT
  :,24,2003B
  11,XTA,S15
  ,ASN,64+10
  ,ATI,15
  ,XTA,Ш/FULL
  ,APX,YДABЛEHЫ.PACФИKCAЦИЯ
  ,ASN,64-1.ИПЗ
  ,YTA,.MAT.
  15,AEX,TPHYS.ЗAДAЧИ
  15,ATX,TPHYS
  ,ITA,14
  ,ARX,BSEM212
  ,UJ,SEMUP
  BOЗBPAT:11,XTA,S15.A ИПЗ
  ,UJ,RET S
C-----------------
  Э206:,BSS,
C
C  BЫБPOC ЗAДAЧИ ПO ШИФPY.
C  CYMMATOP HA BXOДE:
C   1- 8 PP - N CЧETHOГO KAHAЛA
C   9-48 PP - CПEЦ. KЛЮЧ
C  CYMMATOP HA BЫXOДE:
C   0 - BCE B ПOPЯДKE
C   1 - ЧTO-TO HE B ПOPЯДKE
C ------------------------------
 ,ATX,SYM
 ,ASN,64+8
 ,AEX,CODE206
 ,UIA,OШ/ЭK
 ,ATX,SAVAC
 15,VTM,RETAC
  15,MTJ,33B
 ,XTA,DISREG
 ,ATI,27B
 ,ITA,14
 ,ATX,SAVI14
 ,XTA,SYM
 ,UJ,STOP/NP
  Э213:,BSS,
C... YCTAHOBKA ДЛЯ Э060 PEЖИMA
C    ЧTEHИЯ OБPAЗOB KAPT C MБ/MЛ
C    CYMMATOP= YK.MБ/MЛ (16-33P.)
C              CЧ-K ПO ЛИCTY (1-15)
  ,AOX,B48
  11,AEX,I60/74
  ,AAX,=7777 7777 7770 0000
  11,AEX,I60/74
  11,ATX,I60/74
  ,UJ,NRS RET
 GIV MT:,BSS,.
C.....   ПOИCK MЛ ПO MAT.HOMEPY
 ,ITA,15.
 ,ATX,SI15.
 13,VJM,GIVADR.
 ,XTA,SI15.
 15,ATX,S15.
 ,XTA,SAVAC.
 ,ASN,64-30.
 ,ASN,64+6.
 15,ATX,SUM.
 ,XTA,ДHЗ.
 ,ASN,64-42.
 15,AOX,SUM.
 15,ATX,SUM.
   :   ,24,3.
 12,VTM,1-48.+MOДEЛИ
 SEAR MT:,BSS,.
 12,XTA,T1MT+31.
 15,AEX,SUM.
 ,AAX,B48/37.
 ,UZA,RET MT.
 12,VLM,SEAR MT.
   :   ,24,2003B.
 ,UJ,ABS/MT
 RET MT:,24,2003B.
 12,UTM,31+30B.ФИЗ.N MФ
 ,WTC,Г Y C.
 ,XTA,SCEM.
 ,ASN,64+15.
 ,ASN,64-15.
 ,ATX,TEX
 ,ITA,12.
 ,AOX,TEX.
 ,WTC,Г Y C.
 ,ATX,SCEM.
 ,XTA,.
 ABS/MT:,BSS,.
 15,WTC,S15.
 ,UJ,.
 ЭK62:,BSS,.
C*****   ИHTEPПPETAЦИЯ ЭK62
 15,V1M,Э62/1.
C.....   БEЗYCЛOBHЫЙ KOHEЦ ЗAДAЧИ
 ,AAX,ШKП.
 ,ATX,ШKП.
 ,UJ,MACRO74.
 Э62/1:,BSS,.
C.....   MЛ-OTKAЗ , MЛ-CMEЩEHИE
 ,ITA,15.
 ,ASN,64-33.
 ,AUX,MSK MT.
 ,ATX,SAVAC.
 ,AAX,C777.
 ,AEX,C777.
  11,VTM,-1
  ,U1A,TAPES.-CMEЩEHИE
 15,VJM,GIV MT.
 ,U1A,Э5/1.HET ЛEHTЫ
C.....   OTKAЗ OT ЛEHTЫ
 ,XTA,B1.
 12,ATX,T1MT-30B.
 ,UJ,RET AC.HA BOЗBPAT
 ЭK63:,BSS,.
C*****   ИHTEPПPETAЦИЯ ЭK63
 ,ARX,C3
 ,ASN,64+3
 ,U1A,ЧTФИЗЯ.ЧTEHИE ЯЧEЙKИ
 15,UTM,-4
 15,VZM,Э634
 15,UJ,SW63+4
 Э630:,BSS,.
 11,XTA,TLIM.
 ,NTR,2
 11,A-X,TJOB.
 ,UJ,RET S.
 Э631:,BSS,.
C.....   ПEЧATЬ BPEMEH HA AЦПY
 13,VJM,GIVADR.
   :   ,24,3.
  15,UTM,EFR
 15,MTJ,12.
 ,XTA,CHAЧ.
 12,ATX,.
 12,UTM,1.
 ,XTA,CB.ПOДГOTOBKA
 12,ATX,.CЧET.BPEMEHИ
 11,XTA,TIC.
 13,VJM,K 8/10....
 ,XTA,KB.
 12,ATX,.KOMMEPЧECKOГO
 11,XTA,TIB.
 13,VJM,K 8/10....
 ,XTA,AB.
 12,ATX,.ACTPOHOMИЧ.
 ,XTA,ASTIME.
 13,VJM,K 8/10....
  13,VJM,GIVADR
 12,XTA,-1.
 ,AEX,C226.KOPPEKTИP.
 12,ATX,-1.KOHЦA
  12,VTM,NRSRET
  13,VTM,INFPR-BAS
  ,UJ,PRINT
 Э632:,BSS,.
C.....   БYДИЛЬHИK ПO BPEMEHИ
 11,XTA,TLIMS.BOCCTAHOBЛEHИE
 ,UZA,Э632/1.ПACПOPTHOГO
 11,ATX,TLIM.  ЛИMИTA
 ,XTA,.
 11,ATX,TLIMS.
 Э632/1:,BSS,.
 13,VJM,K 10/8.ПEPEBOД BPEMEHИ
 ,AOX,.OTKAЗ OT БYД.
 ,UZA,NRS RET. - ДA
C.....   ЗAKAЗ БYДИЛЬHИKA
 11,A+X,TJOB.
 ,ATX,SAVAC.HOBЫЙ ЛИMИT
 11,A-X,TLIM.
 BP 2:,UZA,BP 3.- HE ПPOЙДET
 11,XTA,TLIM.CTAP.ЛИMИT -
 11,ATX,TLIMS.ЗAПOMHИM
 ,XTA,SAVAC.HOBЫЙ -
 11,ATX,TLIM.YCTAHOBИM
 ,UJ,RET S.
 Э633:,BSS,.
C.....   BPEMЯ HA ABOCTHYЮ BЫДAЧY
 13,VJM,K 10/8.ПEPEBOД BPEMEHИ
 11,XTA,TLIMS.HOBЫЙ ЛИMИT
 ,U1A,BP 3.- YЖE ЗAДAH
 11,XTA,TLIM.
 ,A-X,WORD.OПPEДEЛИM
 ,ATX,SAVAC.HOBЫЙ ЛИMИT
 11,X-A,TJOB.
 ,UJ,BP 2.HA ПPOBEPKY
 Э634:,BSS,.
 11,XTA,TJOB.ПOЛYЧEHИE
 ,NTR,2.KOЛИЧECTBA
 ,A*X,R50.50-ГEPЦOBOK
 ,NTR,3
 ,A+X,INT0.
 ,AAX,B24/1
 ,UJ,RET S
 ЧTФИЗЯ:,BSS,.
 ,ITA,15.
 ,ASN,64+3.
 ,UZA,OШ/ЭK.
 15,UTC,
 ,XTA,
 ,UJ,RET S.
 K 10/8:,BSS,.
C.....   ПEPEBOД BPEMEHИ ИЗ TEKCTA
 15,VTM,1-6.
 ,XTA,INT0.
 ,ATX,WORD.
 ,XTA,SAVAC.
 ,AEX,SPECN.
 13,UZA,.
 K 1:,XTA,SAVAC.
 ,ASN,64-8.
 ,ATX,SAVAC.
 ,YTA,.
 ,AOX,INT0.OЧEP.ЦИФPA
 15,A*X,NUMB+5.
 ,A+X,WORD.BPEMЯ B
 ,ATX,WORD.CEKYHДAX
 15,VLM,K 1.
 13,UJ,.
 K 8/10:,BSS,.
C.....   ПEPEBOД BPEMEHИ B TEKCT
   :   ,24,2003B.
 15,VTM,1-6.BPEMЯ B
 K 3:,NTR,2.
  ,ATX,WORD.CEKYHДAX
 15,A/X,NUMB+5.
 ,NTR,3.
 ,A+X,INT0.
 ,ATX,SYM.OЧEP.CИMBOЛ
 ,NTR,2.
 15,A*X,NUMB+5.
  ,X-A,WORD.
 ,ATX,WORD.OCTATOK
 ,XTA,TEX.
 ,ASN,64-4.BPEMЯ B
 ,AOX,SYM.ШECTHAДЦAT.
 ,ATX,TEX.ПPEДCTABЛEHИИ
  ,XTA,WORD
 15,VLM,K 3.
  ,XTA,TEX
 ,ASN,64-24.
 ,AUX,MUT1.ПPEOБPAЗOB.
 12,AOX,.BPEMEHИ
 12,ATX,.B KOД 'ГOCT'
 ,XTA,TEX.
 ,ASN,64-32.
 ,AUX,MUT2.
 ,AOX,MOT2.
 12,ATX,1.
 12,UTM,2.
 ,XTA,TEX.BPEMЯ
   :   ,24,3.OПP
 13,UJ,.
 GIVADR:,BSS,.
  ,WTC,ГYC
  15,VTM,WS/ПФ+5
  ,XTA,Ш/FULL
 ,AAX,BITJ
  13,UZA,.CЛYЖ.ЗAД
C.. ДЛЯ MAT.ЗAДAЧИ ИCПOЛЬЗYEM ПOЛЯ B ИПЗ:
C   FIELD1, ECЛИ HE ИЗ *WRBF, ИHAЧE FIELD2
  ,WTC,ГYC
  15,VTM,FIELD2
  ,AAX,SCEM*64
  13,U1A,
  15,UTM,FIELD1-FIELD2
  ,XTA,B1
  13,UJ,
 OШЭK72T:15,MTJ,11
 11,UTM,MSAV-SWORD
 OШЭK 0:,BSS,.
 11,XTA,SWORD.
   :   ,24,2003B.
 ,ATX,SAVAC.
  OШ/ЭK:,BSS,
 13,VJM,BOCCTAH.
 15,VTM,TOШИБ
 TO ERRM:,BSS,
C.....   ПOДГOTOBKA K "ERRMACRO'
 ,WTC,ГYC
 13,VTM,
 13,XTA,SCEM
 ,ATX,SAVI14.ИCПOЛ.AДPEC
 ,ASN,64+15
 ,AAX,C37
 ,ARX,C550.
 13,ATX,AП.HOMEP ЭK
  ,MTJ,27B
 14,MTJ,13.
 15,MTJ,14.TEKCT OШИБKИ
  ,UJ,ERREXT
 OШ/ЧYЖ:,BSS,
 13,VJM,BOCCTAH
 15,VTM,TЧYЖЛ
 ,UJ,TO ERRM
 BOCCTAH:,BSS,.
C.....   BOCCTAHOBЛEHИE COCTOЯHИЯ
C        ИЗ BHYTP.ПOЛЯ YПPЯTЫBAHИЯ
   :   ,24,2003B.
  ,ITA,14
  ,ARX,R/SEM
  ,UJ,SEMUP
  R/SEM:,Z00,SEM/EM
  ,Z00,NO SEM - BAS
  NO SEM:,BSS,
 ,ITA,13.
 ,ATX,SI15.
 13,VJM,GIVADR
 15,UTM,7.
 15,XTA,.
 ,STI,11.
 ,STI,12.
 ,ATX,SAVI13.
 ,STI,13.
 ,STX,SAVI15.
 ,STI,32B.
 ,STX,SAVSR.
 ,XTR,SAVSR.
 ,WTC,SAVI15.
 15,VTM,.
 ,WTC,SI15.
 ,UJ,.
 CHECK PR:11,XTA,SCEM.
 ,AAX,B25.
 12,UZA,.
  11,XTA,SCEM.TPACCИPYEM
  15,AAX,S15.TOЛЬKO TEX
  12,UZA,.KOГO ЗAKAЗAЛИ
  ,AEX,B32
  ,U1A,NO70
C
C...  HE ПEЧATAEM ПO Э070 OT ЗAГPYЗЧИKA
C
  ,WTC,3
  13,VTM,-71717B
  13,VZM,NO70
  15,XTA,2
  ,ASN,64+9
  12,UZA,.<1000
  ,ASN,64+1
  ,AEX,C37
  12,UZA,.>76000
  ,XTA,LIB/BOSS
  ,AAX,BITJ
  12,U1A,.LOADLIBR
  NO70:,BSS,
  ,XTA,SCEM*64
  ,AAX,BITJ
  12,U1A,
 11,XTA,SCEM.
  13,VTM,INФO-BAS
 ,ASN,64-28.
 ,AUX,CPP1.
 ,ARX,CPP2.
 15,ATX,7.N ЭKCTPK
 ,XTA,CPP3.
 15,ATX,9. /
 15,XTA,SUM.
 15,ATX,11.ПEЧATAEMOE
 ,ASN,64+24.
 15,ATX,10. CЛOBO
 ,XTA,CPP4.
 15,ATX,12.BЭ =
 11,XTA,SCEM.
 ,AAX,B23.
 ,UZA,AДPM.
 ,XTA,CPP5.
 15,ATX,12.BЭФ=
 AДPM:15,XTA,2.
 15,ATX,13.
C---  ПOДПPOГPAMMA ПEЧATИ
C     HA BXOДE :
C     И.P.13 - OTHOCИT.AДPEC ИHФ.CЛ.-64
C     И.P.15 - AДPEC ПOЛЯ YПPЯTЫBAHИЯ
C     И.P.11 - AДPEC  И П З
C
  PRINT:,24,2003B
  11,XTA,SCEM
  15,ATX,FUL
  ,XTA,DISREG
  ,ATI,27B
  ,ITA,14
  13,J+M,14
  ,ATI,13
  13,ARX,A/RET64-BAS
  ,ATI,32B
  A/RET64:,UJ,MACRO64+2
  ,Z00,RET/M64-BAS
  RET/M64:13,MTJ,14
  15,XTA,FUL
  11,ATX,SCEM
  12,UJ,
 INФO:15,,7.
 15,,13.
 :0,010,.
 ,005,.
 :2,016,5.
 ,,.
 :0,024,.
 ,001,.
 :2,026,8.
 ,011,1.
 :0,050,.
 ,004,.
 :2,055,5.
 8,,.
C.....   ШKAЛA ЭK C ИHФOPM.CЛOBAMИ
  ШЭ ПAM:,OCT,0000 4040.Э70 - HE HAДO!
C.....
 CPP1:,GOST,6H037000
 CPP2:,GOST,6HЭ50 A'231'
 CPP3:,GOST,2H/'231'
 CPP4:,GOST,6HBЭ ='231'
 CPP5:,GOST,6HBЭФ='231'
  INFPR:15,,EFR
  15,,EFR
  ,,
 8,,
  INFTR:15,,EFR
  15,,FR
  2,010,16
  8,024,1
CONST:
  OCT50:,OCT,50
 TTN:,TEXT,2H'10'N
 MTIM1:,OCT,0000 0003 7777 7760
 MTIM2:,OCT,7707 7774 0000 0000
 CHAЧ:,GOST,6H '214'
 CB:,GOST,6HCB=00.
 KB:,GOST,6HKB=00.
 AB:,GOST,6HAB=00.
 C226:,LOG,226.
 CODE206:,ISO,6H''STOPJ
 B16*5:,LOG,1 00020
 B20/16:,LOG,37 00000
 MAS/T1:,LOG,77 1777
 MAS/T2:,OCT,0077 0000 1777
 C550:,LOG,550.
 SPECN:,GOST,6H777777
 MUT1:,GOST,6H000  0
 MUT2:,GOST,6H  0  0
 MOT2:,GOST,6H00.00
 INTMACR:,OCT,4013 4242
 B35/17:,OCT,0000 3777 776
  C171717:,LOG,171717
  C060606:,LOG,060606
  C202020:,LOG,202020
  CON/2105:,BSS,
  ,OCT,440 4 000 1604 76030
  ,OCT,420 00 4 00 132 77634
  ,OCT,460 0000 4 012 77766
  C34:,LOG,34
  SC211:,LOG,1 4000 0000.ШKAЛЫ ДЛЯ Э211
  ЭK200/R :,OCT,0076
  B33/22:,LOG,0777 7000 0000
 MSK MT:,LOG,77 0777.
 KOД74:,LOG,2264 2531 2123 3462
 WORD:,BSS,1
  SI15:,BSS,1.
 SYM:,BSS,1.
 TEX:,BSS,1.
 ,END,
 TESTTRAK:,NAME,
 *677:B,BLOCK,BITS
 ,CONT,BIT48,BIT47,BIT46,BIT45
 ,CONT,BIT44,BIT43,BIT42,BIT41
 ,CONT,BIT40,BIT39,BIT38,BIT37
 ,CONT,BIT36,BIT35,BIT34,BIT33
 ,CONT,BIT32,BIT31,BIT30,BIT29
 ,CONT,BIT28,BIT27,BIT26,BIT25
 ,CONT,BIT24,BIT23,BIT22,BIT21
 ,CONT,BIT20,BIT19,BIT18,BIT17
 ,CONT,BIT16,BIT15,BIT14,BIT13
 ,CONT,BIT12,BIT11,BIT10,BIT 9
 ,CONT,BIT 8,BIT 7,BIT 6,BIT 5
 ,CONT,BIT 4,BIT 3,BIT 2,BIT 1
 BLOCK:,EQU,BIT43.БЛOKИPOBKA
 BCMD:,EQU,BIT48.KATAЛOГE BHE
 BCLI:,EQU,BIT47.ЧИCTKA BBOДA
 BCLO:,EQU,BIT46.ЧИCTKA BЫBOДA
 DISPBASE:LC,BLOCK,(2),CHANS(2)
 C3:,LC,1
 C1777:,LC,1
 C77777:,LC,1
 C377:,LC,1
 FULWOR:,LC,1
  C7:,LC,1
  C37:,LC,1
  C7777:,LC,1
  TABDRU:,LC,16
  COPYTR1:,LC,1
  B16/1:,LC,1
  STATUSMT:LC,BLOCK,(32),MISTERX
 C:,EQU,1
 J:,EQU,2
 K:,EQU,4
 L:,EQU,5
 R:,EQU,10
  DEF:,EQU,7
 M:,EQU,8
 N:,EQU,9
 B:,EQU,12
 RI:,EQU,15
 NS:,EQU,11
 C77:,LC,1
 ДOПYПP:LC,BLOCK,(10),NTRFRO
  TODAY:,LC,1
  DATA:,EQU,76003B
  TIME:,EQU,76002B
  ASTIME:,EQU,542B
  MASTIME:,EQU,543B
 AI:,EQU,506B
 AO:,EQU,507B
 JSTAT:,EQU,541B.
 BEGIN:,EQU,103B.WORK PLACE
  DD71:,SUBP,
 *417:B,BLOCK,SCBDR,SCFW(16),SCEY(16)
 ,CONT,ADSPTR(2),SCSEACH,W3
 ,CONT,BDR,NDCATN,NDCAT,COTR2
 ,CONT,COTR1,KYC,W1,W2
 ,CONT,XR,SCBCDR
 PAGE:,EQU,76000B
  ASIGN:,EQU,1777B.AДPEC ПP.BBOДA
  COMX:,EQU,1776B.KOПИЯ MISTERX
 BEG:B,REL,*-BEGIN
C..  И14 = 0 : C MБ ИHAЧE C MД
  14,MTJ,DEF
  N,VTM,-3
 ,XTA,1
 ,ATX,COTR1
  ,AAX,B16/1
  ,ATX,COPYTR1
C         ЧИCTKA MACCИBA CBЯЗИ C DISPINIT
 K,VTM,SCBDR-NDCAT
 ,XTA,
 SETZ:K,ATX,NDCAT
 K,VLM,SETZ
 ,XTA,2
 ,ATX,COTR2.KOПИЯ TR2
C   OTHЫHE HEЛЬЗЯ ЗAБЛOKИPOBATЬ TESTTRAK (BIT 43 TP-2)
C   ПOЛOЖEHИE  ROLL-TPAKTA ЗAДAETCЯ (DATA B TESTTRAK'E)
C   B BИДE KYC-A B NTRFRO
C   ---------------------
C   HOMEP AБЗAЦA BCEГДA = 3
 BCLR:,EQU,BIT45
 SIGNRO:,EQU,SIGN+1
 ,XTA,NTRFRO
 ,UZA,YЧET
  ,AAX,UPM1
  DEF,VIM,NORR
 R,VJM,CLODRSP.ЗAKPЫЛИ ROLL
 REROTR:R,VJM,READ.ПЫTAEMCЯ ЧИTATЬ
 :,UJ,STOP.HET KO ЧT ROLL
 :N,VLM,REROTR.OШM ПOBTOP
C   ECЛИ OБMEH ПPOШEЛ XOPOШO,CYMMATOP=0
 :,ATX,W3
  NORR:,BSS,
 ,XTA,2
 ,AAX,BCLR
 ,U1A,YЧET.БYДEM ЧИCTИTЬ
 ,XTA,W3
 ,U1A,STOP.OШM И HE ЧИCTИM
 ,XTA,PAGE+ASIGN
 ,AEX,SIGNRO
 ,U1A,STOP.HET ИMEHИ ROLL
 ,XTA,PAGE+COMX
 ,ATX,MISTERX
 YЧET:,BSS,
 ,XTA,JSTAT
  ,UZA,WRIDA.HET YЧETA
 ,APX,PAM1
 ,AUX,UPM1
  DEF,VIM,NORS
  R,VJM,CLODRSP
  R,VJM,READ
  :,XTA,
  ,UJ,WRIDA
 ZTD:,XTA,
 ,UJ,WRIDA
 NORS:,XTA,76000B
 ,AEX,STCODE
 ,U1A,ZTD .HET ДATЫ
 ,XTA,TIME
 ,ATX,ASTIME
 ,XTA,DATA
  WRIDA:,ATX,TODAY
C...  ECЛИ ДИCПETЧEP HA ДИCKE
C     MБ 16 MOЖHO ПOЛЬЗOBATЬ !
  DEF,VIM,DD1
 ,XTA,DISPBASE.ADDR.OF DD
 ,AAX,B41A10/8
 ,ATX,KYC.CREATING
 ,ASN,64+7.N OF THE DRUM
 ,ATI,M.OF DISP
C   8*NCHANAL  (ЭKOHOMИM)
 ,ASN,64+30
 ,ATI,C.N OF CHANAL
 C,J+M,M
 DD:,XTA,AODD1.ADDR.OF RET.
 ,ATX,XR.FROM CLODR
 M,XTA,BIT16.CLOSE THE DRUM
 ,AOX,COTR1.IN THE SCALE
 ,ATX,COTR1.OF SLOSED
 ,UJ,NOMDR.
 PAM1:,LOG,3737.
 UPM1:,LOG,30 0000 0000 1774.
 B41A10/8:,LOG,20 0000 0000 1600.
  ЛИKYC:,LOG,137 0000
 STCODE:,TEXT,8HOC ДYБHA
 DD1:,BSS,.
C         OПPEДEЛEHИE ШKAЛЫ: KAKИE
C         TИПЫ TPAKTOB ИCKATЬ. SCSEACH(1)=
C         .NOT.(BCMD.OR.(BCLI.AND.BCLO))
 ,XTA,COTR2
 ,AEX,FULWOR
 ,ASN,64+1.
 ,ARX,B46/45
 ,AAX,BIT48.TOЛЬKO IN/OUT
 ,ATX,SCSEACH
 ,UZA,TTRAC.KAT.I/O HA MД
C
 ,XTA,AOELS
 ,ATX,XR
 C,VTM,
 LSC:,BSS,
 ,ITA,C
 ,ASN,64-39
 ,ARX,BEKYC
 ,ATX,KYC
 M,VTM,1-8
 N,VTM,1-3
 LSC1:,BSS,
 M,MTJ,K
 C,VZM,CH1
 K,UTM,8
 CH1:K,XTA,BIT16+7
 ,ATX,BDR
 ,AAX,COTR1
 ,U1A,ELS1
 CALRE:R,VJM,READ
 :,UJ,NOMDR
 :,UJ,ERYBY1
 :,XTA,PAGE+ASIGN
 ,AEX,SIGN
 ,UZA,CATIS
 ERYBY1:N,VLM,CALRE
 ELS1:N,VTM,1-3
 ,XTA,KYC
 ,ARX,BIT8
 ,ATX,KYC
 ELS2:,BSS,
 M,VLM,LSC1
 C,V1M,STOP
 C,VTM,1
 ,UJ,LSC
 NOMDR:,BSS,
 ,XTA,SCBDR
 ,AOX,BDR
 ,ATX,SCBDR
 L,VTM,1-32
 ,XTA,KYC.YCTAHOBKA
 ,AAX,Z7/1.YKAЗATEЛЯ
 ,ATX,KYC.HA HAЧAЛO MБ
 LCLOSD:R,VJM,CLODR
 ,XTA,KYC
 ,ARX,BIT3
 ,ATX,KYC
 L,VLM,LCLOSD
 ,WTC,XR
 B,UJ,
 STOP:,BSS,
C  OCTAHOB,ECЛИ:
C   1) HET KO ДЛЯ ROLL-TPAKTA
C   2) OШM И HE ЧИCTИM ROLL-TPAKT
C   3) ROLL-TPAKT ЧИTAETCЯ,HO HE ИMEET CПEЦ-ИMEHИ
C   4) KATAЛOГИ I/O HA MБ И HE HAЙДEHЫ(БEЗ ЧИCTKИ)
 :,33,52525B
 ,UJ,*
 CATIS:,BSS,
 ,XTA,KYC
 ,AAX,UPM1
 ,ATX,ADSPTR.ДЛЯ DISPINIT
 NS,VTM,-1
 CLSER:,BSS,
C         OPГAHИЗAЦИЯ БЛOKИPOBKИ CEPИИ TPA-
C         KTOB. ДЛЯ ROLL - 1, ДЛЯ KAT.- 2
  R,VJM,CLODR
 ,XTA,KYC
 ,ARX,BIT3
 ,ATX,KYC
 NS,VLM,CLSER
 TTRAC:,BSS,
 ,XTA,COTR1
 ,AOX,SCBDR
 ,ATX,SCBCDR
 ,XTA,AOLT1DR
 ,ATX,XR
 K,VTM,1-2
 STOFS:,BSS,
C--- ECЛИ MOHИTOPHAЯ CИCTEMA HA ДИCKE -
C        БAPAБAHЫ ПYCKAEM B ДEЛO !
 ,XTA,BIT41.
 K,ASN,64+1.
 ,AAX,2
 ,UIA,MБДИCK.
 K,XTA,CHANS+1
 ,ASN,64+5.
 ,ATX,KYC
 ,ASN,64+7.
 ,ATI,M
 ,ASN,64+3
 ,ATI,C
 C,UTM,-1
 M,XTA,BIT16-10B
 ,AOX,SCBCDR
 ,ATX,SCBCDR
 M,VTM,1-32
 CLST:R,VJM,CLODR
 ,XTA,KYC
 ,ARX,BIT3
 ,ATX,KYC
 M,VLM,CLST
 MБДИCK:,BSS,.
 K,VLM,STOFS
  DEF,VTM,-2
C
C...  OTБPAKOBKA TPAKTOB BЫПOЛHЯETCЯ
C     TPOEKPATHO B PAЗHЫX PEЖИMAX
C     ЭЛEKTPOПИTAHИЯ : "БOЛЬШE", "MEHЬШE"
C     И "HOMИHAЛ".   TPEБYETCЯ ПEPEД
C     BЫЗOBOM ДИCПETЧEPA YCTAHOBИTЬ
C     KЛЮBИK HA CTOЙKE YBY B ПOЛOЖEHИE
C     " 1 " .
C
  L/DEF:,BSS,
  DEF,XTA,DEFKUS+2
  ,EXT,147B
 ,MTJ,M.
 C,VTM,
 T1CH:,BSS,
 ,ITA,C
 ,ASN,64-39
 ,ARX,BEKYC
 ,ATX,KYC
 LT1DR:,BSS,
 M,XTA,BIT16
 ,ATX,BDR
 ,AAX,SCBCDR
 ,UZA,BT1TR
 ,XTA,KYC
 ,ARX,BIT8
 ,ATX,KYC
 ,UJ,ELT1DR
 BT1TR:N,VTM,-32
 T1TR:,BSS,
C         LOOP FOR CHECKING TRATCS 1 MD.
 K,VTM,1-1024
 R,VJM,IFBUSY
 ,U1A,E1TR
 ,XTA,CHESS
 PCTP:K,ATX,PAGE+1023
 ,AEX,FULWOR
 K,VLM,PCTP
 R,VJM,WRITE
 :,UJ,NOMDR
 :,UJ,BADTR
 :R,VJM,READ
 :,UJ,BADTR
 :,UJ,BADTR
 :K,VTM,1-1024
 ,XTA,CHESS
 ,ATX,W1
 COMP:K,XTA,PAGE+1023
 ,AEX,W1
 ,U1A,RBADT
 ,XTA,W1
 ,AEX,FULWOR
 ,ATX,W1
 K,VLM,COMP
 ,ITA,C
 ,ASN,64-3.ADDRESS OF
 ,ATI,J.SPECIAL WORDS
 K,VTM,1-4
 CHECKSW:J,XTA,11B
  ,AEX,C7777.THE SUMM
 ,U1A,RBADT
 ,ITA,K.CHECKING OF
 ,ARX,C3.THE ADDRESS
 ,AAX,C77777
 ,ARX,KYC.OF THE SECTOR
 J,AEX,10B
 ,U1A,RBADT
 J,UTM,2
 K,VLM,CHECKSW
 E1TR:N,UTM,1
 ,XTA,KYC
 ,ARX,BIT3
 ,ATX,KYC
 N,V1M,T1TR
 ELT1DR:,ASN,64+2
 ,AAX,C377
 M,UTM,1
 ,U1A,LT1DR
 C,V1M,ENDJOB
 C,VTM,1
 ,UJ,T1CH
 RBADT:M,MTJ,J
 ,UJ,RBBR
 BADTR:M,MTJ,J
 J,UTM,SCEY-SCFW
 RBBR:N,XTA,BIT48+32
 J,AOX,SCFW
 J,ATX,SCFW
 R,VTM,E1TR
 ,UJ,CLODR
 ABAS:,EQU,BEG-BEGIN
 AODD1:,Z00,
       ,Z00,DD1-ABAS
 AOELS:,Z00,
 ,Z00,ELS2 - ABAS
 AOLT1DR:,Z00,
 ,Z00,ELT1DR-ABAS
 BEKYC:,LOG,10 0000 0137 0000
 CHESS:,LOG,71634 71634 716347
 WRITE:,BSS,
 ,ITA,C
 ,ASN,64-3
 ,ATI,J
 ,XTA,KYC
 WR1:,ATX,W1
 ,ATX,W2
 K,VTM,1-4
 L,VTM,1-8
 KWSW:,BSS,
 J,ATX,10B
  ,XTA,C7777
 J,ATX,11B
 J,UTM,2
    ,XTA,W2
 ,ARX,BIT1
 ,ATX,W2
 K,VLM,KWSW
 ,UJ,TRANSF
 READ:,BSS,
 ,XTA,KYC
 ,AOX,BIT18
 ,ATX,W1
 L,VTM,1-8
 TRANSF:,BSS,
 ,ATX,1
 L,VLM,TRANSF
 ,XTA,W1
 ,ATI,
 C,033,1
 ,ATI,
 L,VTM,50000B
 WAIT:,MOD,237B
 C,AAX,BIT46
 ,U1A,EOT
 L,VLM,WAIT
 C,XTA,BIT22
 ,033,31B
 R,UJ,
 EOT:,033,4035B
 C,AAX,BIT7
 R,U1A,1
 R,UJ,2
C------
  CLODRSP:,BSS,
  ,AOX,ЛИKYC
  ,ATX,KYC
  ,ASN,64+40
  ,ATI,C
 CLODR:,BSS,
 RI,VJM,GAAMTT
 J,AOX,
 J,ATX,
 R,UJ,
 IFBUSY:,BSS,
     RI,VJM,GAAMTT
    J,AAX,
 R,UJ,
 GAAMTT  :  , BSS ,
C         OBTAINING A COLUMN'S MASK AND
C         ADDRESS FOR TABDRU.
 ,XTA,KYC
  ,ASN,64+2
  ,AAX,C37
  ,ATI,14.TPAKT
  ,XTA,KYC
  ,ASN,64+7
  ,AAX,C7
  ,ATI,J
  C,VZM,*1H
  J,UTM,8
  *1H:,BSS,
  14,XTA,BIT48
 J,UTM,TABDRU
 RI,UJ,
C       BOЗBPAT B STARTDD
 ENDJOB:,BSS,
  DEF,VLM,L/DEF
  15,VTM,227B.ПEPEПИCЬ
  DEF,VTM,-47B.ИHФOPMAЦИИ
  TR/INF:DEF,XTS,SCBDR+47B.ДЛЯ
  DEF,VLM,TR/INF.DISPINIT-A
 13,UJ,
C...  KYC-Ы HAПPЯЖEHИЙ :
  DEFKUS:,BSS,
  ,LOG,31000."БOЛЬШE"
  ,LOG,30000."MEHЬШE"
  ,LOG,."HOMИHAЛ"
   SIGN:,ISO,6HD78INP
 ,ISO,6HROLLTR
 B46/45:,OCT,14
 Z7/1:,OCT,7777 7777 7777 76
 ENDR:,BSS,
 LENPRO:,EQU,ENDR-BEG
  LENFIC:,EQU,204-LENPRO
 ,BSS,LENFIC-1.
C   ПOЛOЖEHИE  ROLL-TPAKTA
  ROTR:,LOG,20 0000 0000 6164.2035.3
 1,SET,ROTR
 1,   ,NTRFRO
  204,SET,BEG
 1,   ,BEGIN
 ,END,
 PRINTDR:,NAME,.
C
C******   PACПEЧATKA COCTOЯHИЯ MБ
C
 TPБP:,EQU,2.
 ББЛ:,EQU,=:02
 SCD:,EQU,230B.
  BIT16:,EQU,740B
 DISPBASE:LC,BLOCK,
 ,CONT,(1),DISP,DR21,DR22
  ,CONT,DMOD
  *YCЫ:LC,BLOCK,(8),AЦПY(2)
  *ИПД:LC,BLOCK,(45),БЫЛ*64
 *100:B,BLOCK,
 ,CONT,BITMD.
 ,CONT,BIT,SCS,SCM(33)
 ,CONT,STRH(18),STR(18)
C
C--- ЗAДEPЖKA ДЛЯ BOЗMOЖHOCTИ OПOЗHABAHИЯ
C          ДИCKOBЫX ПAKETOB.
C
  7,BASE,*
  ,*64,
  ,XTA,=R16.0
  ,*57,13B.
 ,*65,TPБP.
  ,ATX,TE
 ,AAX,ББЛ.
 ,UIA,NO TAB.
 ,ATX,SCS.
  ,ATX,SYSBIT
  ,*65,DMOD
  ,ATX,BITMD
  1,VTM,3
  CSB:1,UTM,-1
  1,*65,DISP
  ,ASN,64+12
  ,AOX,=20
  ,AEX,=30
  ,ATI,2
C--- HE OTMOДEЛИPOBAHЫ ЛИ MБ MOHИTOPKИ 'Q'
  2,*65,700B
  ,AAX,BITMD
  1,VZM,/DISP/
  ,U1A,MБДИCK
 ,XTA,=:002
  1,ASN,64-1
 ,AAX,TE.
  /DISP/:,BSS,
 ,UIA,MБДИCK.OTMOДEЛИPOBAH
  2,*65,BIT16
  ,AOX,SYSBIT
  ,ATX,SYSBIT
 MБДИCK:,BSS,.
  1,V1M,CSB
 1,VTM,1-33.
 LSC 1:2,VTM,1-16.
 1,*65,SCD+32.
 1,ATX,SCM+32.
 ,AOX,SCS.
 ,ATX,SCS.
 1,VLM,LSC 1.
 ,UZA,NO TAB.
 ,*65,1.
 ,ATX,TP1.
 ,PRINT,I HE.'TAБЛИЦA'
 5,VTM,STR0.
 ,PRINT,I PR.ПOДЧEPK.
 5,VTM,STRH.
 1,VTM,10B.
 ,XTA,T1.
 5,ATX,.
 PREP 1:,ITA,1.
 ,ASN,64-42.
 ,AUX,BY2*4.
 ,AOX,T2.
 2,ATX,STRH+16.
 1,UTM,1.
 2,VLM,PREP 1.
 ,XTA,T3.
 5,ATX,17.
 ,PRINT,I PR.HOMEPA MБ
 1,VTM,1-17.
 ,XTA,T4.
 PREP 2:1,ATX,STRH+16.
 1,VLM,PREP 2.
 ,XTA,T5.
 ,ATX,STRH.
 1,VTM,1-32.
 2,VTM,.
 TRACK:5,VTM,STRH.
 ,PRINT,I PR.
 5,VTM,STR.
 ,ITA,2.
 ,ASN,64-42.
 ,AUX,BY34.
 ,AOX,T6.
 5,ATX,.HOMEP TPAKTA
 3,VTM,1-16.
 ,XTA,B16.
 1,ASN,64-1.
 ,ATX,BIT.БИT TPAKTA
 DRUM:,XTA,B16.
 3,ASN,64+15.
 ,ATX,BIT MD.БИT БAPAБAHA
  4,VTM,TCИC
  ,AAX,SYSBIT
  ,UIA,WRDR
  ,XTA,BITMD
 ,AAX,TP1.
 4,VTM,TZAK.
 ,UIA,WR DR.
 ,XTA,BITMD.
 ,AAX,SCM.
 4,VTM, T HET.
 ,UIA,WR DR.
 3,XTA,SCM+16.
 ,AAX,BIT.
 4,VTM,T ЗAП.
 ,UIA,WR DR.
 3,XTA,SCM+32.
 ,AAX,BIT.
 4,VTM,T OШM.
 ,UIA,WR DR.
 4,VTM,TECTЬ.
 WR DR:4,XTA,.
 3,ATX,STR+16.
 3,VLM,DRUM.
 ,XTA,T3.
 5,ATX,17.
 ,PRINT,I PR.OШИБKИ
 2,UTM,1.
 1,VLM,TRACK.
 5,VTM,STR0.
C--- ПPOГOH БYMAГИ K HAЧAЛY ЛИCTA
  ,XTA,ПPOГOH
  5,ATX,1
 ,PRINT,I PR.
C--- OTKAЗ OT AЦПY (CM. NRES074)
  ,XTA,.TAKOE БEЗOБPAЗИE
  ,*52,БЫЛ*64.MOЖHO ДEЛATЬ
  ,AEX,=:00 77.T O Л Ь K O
  ,*53,AЦПY.ПPИ ПOЛHOM
  ,XTA,.OTCYTCTBИИ
  ,AEX,=:00 77.ЗAДAЧ, KOTOPЫE
  ,*53,AЦПY+1.MOГYT ПEЧATATЬ!
 NO TAB:,BSS,.
 1,VTM,KOH.
 ,*65,DISP.
 ,APX,C770077.
 ,AUX,BY3/6.
 ,AOX,TDI.
 ,ATX,TTE.
 5,VTM,TTE+2.
 ,*65,DR21.
 ,ASN,64-6.
 ,ATX,W0001
 4,VTM,HET.
 ,*65,DR22.
 ,AOX,W0001
 ,ASN,64-24
 ,ATX,W0001
 ,*65,2.
 ,AAX,=:003
 ,ASN,64+39.
 ,ATI,14.
 14,UJ,*+1
 :,UJ,ONLY MБ.
 :1,MTJ,3.
 ,UJ,MБMД.
 :1,MTJ,2
 1,VTM,MБ2.
 MБДИ:,XTA,MONSYS.
 ,*57,1400B.
 ,ASN,64-42.
 4,UZA,.HET MOД. C CИCTEMOЙ!
 ,AUX,BY34
 ,AOX,=6HФ'1'00,'1'
 5,ATX,.
 5,UTM,1.
 1,UJ,.
 MБ2:,XTA,W0001.
 ,ASN,64-6.
 ,ATX,W0001
 MБT:,XTA,W0001.
 ,AUX,BY34
 ,AOX,=6H'1''1'00,'1'
 5,ATX,.
 5,UTM,1.
 2,UJ,.
 MБMД:2,VJM,MБT.
 3,MTJ,1
 ,UJ,MБДИ.
 ONLY MБ:2,VJM,MБT.
 1,MTJ,2
 ,UJ,MБ2.
 KOH:14,VTM,TE.
 14,XTA,3
 ,AAX,=:7777 7777 776
 14,ATX,3
 ,ITA,14.
 ,FUN,76B.
 13,UJ,.
 HET:14,VTM,HETCИC.
 ,ITA,14.
 4,VTM,WAIT.
 ,FUN,76B.
 WAIT:,*57,3.
 ,UJ,MБДИ.
C--- MOHИTOPKA ПOMEЩAETCЯ HA MOДEЛИ
C         9/MONSYS !
 MONSYS:,TEXT,8HMONSYS '11'
C-----------------------------------
 HETCИC:,ISO,12HHET CИCTEMЫ'41'
 ,OCT,.
 W0001:,OCT,.
C
 C770077:,LOG,77 0077.
 BY2*4:,GOST,6H070700
 BY34:,GOST,6H007700
 BY3/6:,GOST,6H007777
 B16:,LOG,10 0000
 I HE:,Z00,HEAD.
 ,Z00,HEAD.
 :0,060,.
 8,,.
 HEAD:,BSS,.
 ,GOST,18HTAБЛИЦA COCTOЯHИЯ
 ,CONT,11HTPAKTOB MБ'231'
  TCИC:,GOST,6H  C  I
  SYSBIT:,BSS,1
 TP1:,LOG,.
 I PR:5,,.
 5,,.
 :0,,.
 8,,.
  STR0:,GOST,12H '265''4'-'265''140''231'
  ПPOГOH:,GOST,6H'214''265''33'.'231'
 TZAK:,BSS,.
 T1:,GOST,6H     I
 T2:,GOST,6H 0-0 I
 T3:,GOST,6H'231'
 T4:,GOST,6H-----I
 T5:,GOST,6H ----I
 T6:,GOST,6H -00-I
 TECTЬ:,GOST,6H  P  I
 THET:,GOST,6H  -  I
 TOШM:,GOST,6H OШM I
 TЗAП:,GOST,6H ЗAП I
 TE:,BSS,.
 TTE:,ISO,24HД-2500  MC-'1'
 TDI:,ISO,6HД-0000
  ,END,
 *NRP1:,NAME,.
C          KATAЛOГ HEPEЗИДEHTOB HA 1-M HEPEЗ. ЛИCTE
C
 ПEPФOPAЦ:,SUBP,.
 ,,.
C     ЧИCЛO HEPEЗИДEHTOB
 ,,EC1-BC1.
 BC1:,BSS,.
 NRES71:,ENTRY,.
 :,Z00,.
 ,Z00,ПEPФOPAЦ.
  NRERROR:,ENTRY,
  NRERRMAC:,SUBP,
  :,Z00,
  ,Z00,NRERRMAC
 EC1:,BSS,.
 ,END,.
 *NRP2:,NAME,.
 NRES066:,SUBP,.
  ,LOG,1
 NRES66:,ENTRY,.
 ,Z00,.
 ,Z00,NRES066.
 ,END,.
 *NRP3:,NAME,.
 NRES73:,SUBP,.
  ,LOG,1
 NR73:,ENTRY,.
 ,Z00,.
 ,Z00,NRES73.
 ,END,.
 *NRP5:,NAME,
C         БAЗИPOBAHИE BCEГO HEPEЗИДEHTA BBOДA
C         ПPOИЗBOДИTCЯ ПO HA4AЛY EFSMNRS
C         B CИЛY ЛEHИ
 EFSMNRS:,SUBP,
 ,LOG,1.
 NRSINPUT:,ENTRY,
 ,,
 ,Z00,EFSMNRS
 ,END,
 *NRP6:,NAME,
 NR7CH:,SUBP,
 TERM7:,SUBP,
 ,LOG,2
 NRES7CH:,ENTRY,
 ,  ,
 ,Z00,NR7CH
 NRTERM7:,ENTRY,
  ,,
  ,Z00,TERM7
 ,END,
  *NRP7:,NAME,
  ,LOG,4
  ZOO60:,SUBP,
  NRS60*:,ENTRY,
  ,Z00,
  ,Z00,ZOO60
  STAT TT:,SUBP,
  NR/STAT:,ENTRY,
  ,Z00,
  ,Z00,STAT TT
  OCCUPYD:,SUBP,
  NROCCD:,ENTRY,
  ,Z00,
  ,Z00,OCCUPYD
  NRSMT*SE:,SUBP,
  NR//SEAR:,ENTRY,
  ,Z00,
  ,Z00,NRSMT*SE
  ,END,
  *NRP8:,NAME,
  NRESPOST:,SUBP,
  ,LOG,1
  NRPOST:,ENTRY,
  ,,
  ,Z00,NRESPOST
  ,END,
 *NRP9:,NAME,.KATAЛOГ HEPEЗИДEHTOB 9-ГO ЛИCTA
  ,LOG,1
C
 NRSMDREC:,SUBP,
 NR/MD:,ENTRY,
 ,,
 ,Z00,NRSMDREC
 ,END,
 *NRP10:,NAME,
 NRCDC405:,SUBP,
  EC*608:,SUBP,
  ,LOG,2
 NRECMT:,ENTRY,
 ,Z00,
  ,Z00,EC*608
 NR405:,ENTRY,
 ,Z00,
 ,Z00,NRCDC405
 ,END,
   *NRP11:,NAME,
 ,LOG,3
 NRESERR:,SUBP,
 NRERR:,ENTRY,
 ,   ,
 ,Z00,NRESERR
 TERMINAL:,SUBP,
 NRTERM:,ENTRY,
 :,,
 ,Z00,TERMINAL
 DISPAC71:,SUBP,
 TЮPИH*71:,ENTRY,
 ,,
 ,Z00,DISPAC71
 ,END,
 *NRP12:,NAME,
  ,LOG,1
 TASKSAV:,SUBP,
 NRESTS:,ENTRY,
 ,Z00,
 ,Z00,TASKSAV
  ,END,
  *NRP13:,NAME,
 ,LOG,1
 NREMULAT:,ENTRY,
 :,,.
 EMULATOR:,SUBP,
 ,Z00,EMULATOR
 ,END,
  *NRP14:,NAME,
  ***:,LOG,1
  PRINTASK:,SUBP,
  NRTABL:,SUBP,
  NL:,P/P,(***)1024
  N:,EQU,NRTABL+NL
  NRPRTA:,ENTRY,
  ,Z00,
  ,Z00,PRINTASK
  ,DATA,
  B:,OCT,1
  1,SET,B
  1,,N
  ,END,
  *NRP15:,NAME,
  ,LOG,1
  NRES064:,SUBP,
  NR/64:,ENTRY,
  ,Z00,
  ,Z00,NRES064
  ,END,
  *NRP16:,NAME,
C
C   HEPEЗИДEHT ДPAЙBEPA BИДEOTOHOB
C         (  ПOПOB M.Ю.  )
C
  NRESLINE:,SUBP,
  :,LOG,1
  NR/LINE:,ENTRY,
  :,Z00,
  ,Z00,NRESLINE
  ,END,
 *NRP17:,NAME,
  ,LOG,3
C
 NRESCODE:,SUBP,
  NR/CODE:,ENTRY,
  ,,
  ,Z00,NRESCODE
C
  NRES072:,SUBP,
  NR/72:,ENTRY,
  ,,
  ,Z00,NRES072
C
  ПYCKAЧ:,SUBP,
 NR/START:,ENTRY,
  ,,
  ,Z00,ПYCKAЧ
C
 ,END,
 MAINBLCS:,NAME,.
C
C*****   OCHOBHЫE БЛOKИ ДИCПETЧEPA
C
 *ИПД:LC,BLOCK,XNF,XNFM(3),XNW(2),XNCM
 ,CONT,XNSEM
    LIB/BOSS:,EQU,*ИПД+72B.ДEPЖAT LIBRARY
 NSEM:,WEQ,XNSEM
 ШЛAГБAYM:,LC,NSEM
 C77:,LC,1
  CALLBSC:,EQU,ШЛAГБAYM+5
  FREESEM:LC,BLOCK,(1),MSELECT
 NFM:,WEQ,XNFM
 ДHЗ ЖДY:,WEQ,XNW
 Ш/FULL:,EQU,XNF+11B
 NCM:,WEQ,XNCM
 NUM1:,EQU,NCM-1
 NUSE1:,WEQ,XNFM
 ДHЗLM:,EQU,NFM+NUM1.ДHЗ ПOCЛEДHEЙ C ПOЛHЫM ИПЗ
 NF:,WEQ,XNF
 NS:,EQU,NFM-NF
 Ш/CЛYЖ:,EQU,XNF+10B
  Ш/ДИCП:,EQU,XNF+23B
 INDI SC:,EQU,XNF+24B
 INDI M :,EQU,XNF+25B
 ИПЗ/ECTЬ:,EQU,XNF+42B
 PRTFLAG:,EQU,XNF+44B
 STARTCW:,EQU,XNF+45B
 LIMTSC:,EQU,XNF+53B
 SCMAMБ:,EQU,XNF+57B
 ROLOUTSC:,EQU,XNF+60B
  SCEM*64:,EQU,XNF+61B
 SCENDJO:,EQU,XNF+77B
  SCDEBUG:,EQU,*ИПД+71B
   ADRERR:,SUBP,
 *ИПK1:LC,BLOCK,PRTSTAT
 NPRTJ:,EQU,PRTSTAT+NS
 C377:,LC,1
 SI5:,EQU,21B
 M:,EQU,100B.
 B30/16:,LC,1.
C
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42
 ,CONT,BIT41,BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34
 ,CONT,BIT33,BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26
 ,CONT,BIT25,BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18
 ,CONT,BIT17,BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10
 ,CONT, BIT9,BIT8,BIT7,BIT6,BIT5,BIT4,BIT3,BIT2,BIT1
 TPHYS:,LC,32.
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR(2)
 ,CONT,PPIR(2),M1RDSC
 NOKHA:,EQU,16B
  *SWCMN:LC,BLOCK,SBUSYFLG,SWSCAL,RCNT(3)
 ,CONT,(3),CWJOB(2),SWINGIF
 PRTSW:,EQU,XNF+73B
 SWING:,SUBP,
 *SCAL71:LC,BLOCK,(3),SCAL67
C.........OБOЗHAЧEHИЯ ЯЧEEK  И П З
 S33:,EQU,3.
 S27:,EQU,5.
 REGSCAL:,EQU,M.
 BISTIME:,EQU,110B.
 OШBHYПP:,EQU,M+1.
 COPYS33:,EQU,M+6.
 MAXTIME:,EQU,111B.
 TLIMS:,EQU,84.
C.........
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15
 ,CONT,SAVI14,SAVI13(2),SAVS16
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 SCALES:LC,BLOCK,PRTMASK,MRDSCAL,S1CLTA
 MATBIT:,EQU,BITS+NUSE1
 SC OPER:,EQU,SCALES+5
 WSD:LC,BLOCK,(2),FULLRD
 FULWOR:,LC,1.
 C13:,LC,1.
 C14:,LC,1.
 C2003:,LC,1.
 DISREG:LC,BLOCK,C2013
 INTER:,SUBP,.
 ENTFOLIC:,SUBP,.
  T/ЧYЖKOM:,EQU,5.HOMEP ДИAГH.
  TBPEM:,EQU,4.HOMEP ДИAГH.
  ERRMACRO:,SUBP,
 TMATH:,EQU,30B.
 EXCHBIT:,EQU,BIT7.
 ДOПYПP:LC,BLOCK,(3),M33,M32,M27,(4)
 TASKSAVR:,SUBP,.
  DPRT:,EQU,BIT19
  SW INT:,SUBP,
  MPRTMASK:,EQU,SWINT-1
C
C                         ПOЛHOE YПPЯTЫBAHИE
C
 FULSAV:,ENTRY,.
 FULSAV:,BSS,.
 ,XTA,Г Y C.
 ,ATI,15.AДPEC ИПЗ
 :,XTA,SAVAC
 ,XTS,SAVSR
 ,XTS,SAVAR
 ,ITS,33B
 ,ITS,32B
 ,ITS,27B
 ,XTS,SAVS16
 ,XTS,SAVI15
 ,XTS,SAVI14
 ,XTS,SAVI13
 ,ITS,12
 ,ITS,11
 ,ITS,10
 ,ITS,9
 ,ITS,8
 ,ITS,7
 ,ITS,6
 ,ITS,5
 ,ITS,4
 ,ITS,3
 ,ITS,2
 ,ITS,1
 15,ATX,.
 13,UJ,.
C
C
C            BЫXOД ИЗ ЭKCTPAKOДOB
C
  OUTMACRO:,ENTRY,
  ,ITA,32B
  ,ATI,33B
C
C                 BOЗBPAT ИЗ ПPEPЫBAHИЯ
C
 RETURN:,ENTRY,.
 RETURN:,002,237B.CЧИTЫBAHИE ГPП
 ,AAX,COMMIR.KOПИЯ MACKИ ГPП
 ,U1A,INTER.ECTЬ EЩE ПPEPЫBAHИЯ
  ,XTA,MSELECT
  ,U1A,NEWTA
 ,ITA,27B.
 ,AAX,C14.ПPOBEPKA ДИCП.PEЖИMA
 ,U1A,RESET.BOЗBPAT B ДИCПETЧEP
  ,XTA,SCDEBUG
  ,AAX,BITJ
  ,U1A,ADRERR
 ,ITA,33B.
 ,ASN,64+10.
 ,ATI,15.HOMEP ЛИCTA,KYДA BOЗBPAT
 14,VTM,T/ЧYЖKOM
 ,WTC,ГYC
 15,XTA,TMATH
C
C...   OБXOД MAШИHHOЙ OШИБKИ :
C      BBЫXOД B БЛOK PEAKЦИИ HA ЗAЩИTY
C      ECЛИ ЛИCT ЗAKPЫT ПO ПPИOPИTETY,
C      ПOДKAЧKE ИЛИ OБMEHY.
C      ECЛИ ЛИCT ЧYЖOЙ - ПYCTЬ ЗAДAЧA
C      ПPEPBETCЯ CAMA.
C
  ,ASN,64-3
  ,YTA,
  ,U1A,ENTFOLIC
 RESET:,BSS,.
 ,XTA,ГYC
 ,ATI,13
 ,AAX,B30/16
 ,U1A,MATJOB
 ,XTA,C2013
 ,UJ,RESY
 MATJOB:,BSS,
 ,XTA,FREESEM
 ,U1A,NEWTA.ДЛЯ ПOHИЖEHИЯ ПPИOPИTETA
 ,ITA,27B
 ,AAX,=77677.YCT.0 ПOK
 ,ATI,27B
 ,XTA,SCAL67
  ,AAX,BITJ
 ,UZA,NOPPIR
C   ПPOГPAMHOE ПPEPЫBAHИE
 ,XTA,BIT48
 ,AOX,PPIR
 ,ATX,PPIR
 ,XTA,BIT6
 ,EXT,31B
  ,XTA,BIT30.AБC.ПPИOPИTET
  ,ATX,MPRTMASK.ШAГOBOMY ПPEP.
 ,XTA,BIT12.YCT.ABTБ
C          (ИДEЯ ПETPOBA)
 NOPPIR:,BSS,
 13,AOX,REGSCAL
 ,AAX,=4020.ABTБ+ЗП(M29)
 ,AOX,FORI21B
 RESY:,ATI,21B
C   BOCCTAHOBЛEHИE PEГИCTPOB ИЗ ИПД
 15,VTM,SAVI13+1
 ,XTA,SAVS16
 ,STI,16
 ,STI,13
 ,STI,14
 ,ATI,15.
 ,XTA,SAVAR
 ,AEX,.BOCCTAHOBЛEHИE MЛ.PAЗPЯДOB
 ,XTA,SAVAC.
 ,XTR,SAVSR.
 3,32,.BOЗBPAT ИЗ  ПPEPЫBAHИЯ
C     ****************************
C
C--- ЗAKPЫTИE ПO MAЛOMБ B MAT.PEЖИME
C
  CL MAMБ:,BSS,
  ,AOX,S1CLTA
  ,ATX,S1CLTA
C
C
C
C                   БЛOK BЫБOPA ЗAДAЧ
C
 SELECT:,ENTRY,.
  SELECT:,24,2003B
  15,VTM, Д H З
  12,VTM,NOKHA
  ,ITA,12
  12,XTS,BITS. Д H З
  15,ATX,. B I T J
  ,AEX,FULWOR. Z B I T J
  12,XTS,*YCЫ
  ,ATX,ГYC
  ,XTA,
  ,ATX,FREESEM
  ,ATX,MSELECT
  12,VTM,1000B. = BXOД =
  15,VTM,-7
  :,ATX,1
  15,VLM,*
  12,MTJ,33B
  12,VTM,13B
  12,MTJ,27B
  3,IJ,
C
C...   ПOCЛE OCTAHOBA MAШИHЫ B ЯЧ.1000
C         BOЗMOЖEH "OБЩИЙ CБPOC" !!!
C
  ********:,ENTRY,
  12,VIM,RTASK.
  ,CALL,RESMASK
  RTASK:,XTA,BIT25
  ,ATX,RCNT
  :,24,2003B
  2,VTM,ANAL
C
C...   OПPEДEЛEHИE ШKAЛЫ ЗAДAЧ
C      ДЛЯ ПOCЛEДYЮЩEГO AHAЛИЗA
C
  CHSCALS:,XTA,SBUSYFLG
  ,U1A,ЗAH ПOДK
  ,XTA,RDSCAL.BCE ЗAДAЧИ
  ,UJ,CBO ПOДK
  ЗAH ПOДK:,XTA,RDSCAL.TOЛЬKO TE, KTO
  ,AOX,SWSCAL.HE TPEБYET
  ,AEX,SWSCAL.ПOДKAЧKИ
  ,AAX,ИПЗ/ECTЬ
  CBO ПOДK:,AOX,S1CLTA.ИCKЛЮЧИM TEX,
  ,AEX,S1CLTA.KTO ЖДET YCTP-B,
  ,AAX,MRDSCAL.ИЛИ БЛOKИPOBAH
  ,AAX,M1RDSC.ДPYГИMИ ЗAДAЧAMИ
  ,AOX,BITS+ДHЗ ЖДY
  2,UJ,
C
C...   COБCTBEHHO BЫБOP ЗAДAЧИ
C
  ANAL:,ATX,FULLRD
  11,VTM,SEL END.BOЗBPAT ИЗ SMAXP
  ,XTA,CALLBSC
  ,AAX,C77
  ,ATI,13
  13,XTA,BITS
  ,AOX,Ш/ДИCП
  ,AAX,FULLRD
  ,U1A,GETFIRST
  ,XTA,FULLRD
  ,AAX,PRTMASK.ПPИOPИTETHЫE
  ,U1A,GET FIRST.MAT.ЗAДAЧИ
  ,XTA,Ш/CЛYЖ
  ,AAX,FULLRD
  GET FIRST:,UZA,SEL USER
  ,ANX,
  ,ATI,13
  ,UJ,JOB IS
C
C...  BЫБOP CPEДИ ЗAДAЧ ПOЛЬЗOBATEЛEЙ
C
  SEL USER:13,VTM,ДHЗ ЖДY
  ,XTA,FULLRD
  ,AAX,Ш/FULL
  ,UZA,JOB IS.ИX HET
  :,24,3.ECTЬ ЛИ
  ,AAX,PRTSW.CPEДИ HИX
  :,U1A,*+1.KЛИEHTЫ ПOДKAЧKИ
  ,XTA,FULLRD.-HET
  :,ATX,ШK2
  ,XTA,PRTFLAG.ПPИOPИTETЫ
  ,UZA,SAMEPRT.ПOKA TE ЖE
  2,VTM,
  ,XTA,7
  ,AAX,BIT27
  ,UZA,RECALC
  ,XTA,NPRTJ+NUM1
  ,AAX,C77
  ,AEX,BIT6
  ,U1A,RECALC
  2,VTM,ДHЗLM.ФOHOBЫЙ=Ш1
C
C...  ПEPECЧET ЧИCEЛ ПPИOPИTETA
C
  RECALC:1,VTM,-NUM1
  15,VTM,NPRTJ
  2,XTA,BITS
  ,STX,БИTФOHA
  NEWPRT:1,XTS,NPRTJ+NUM1
  ,AAX,MPRT
  :,UZA,*+1
  ,XTA,DPRT
  :1,X-A,NPRTJ+NUM1
  1,VLM,NEWPRT
  ,XTS,
  ,ATX,PRTFLAG
C
C...  ШKAЛA ЗAДAЧ, ЗAXBATИBШИX CEMAФOPЫ
C
  SAMEPRT:15,VTM,SCSEM
  1,VTM,NSEM.CYMMATOP=0
  FORMSS:1,UTM,-1
  1,XTS,ШЛAГБAYM
  ,AAX,C77
  ,STI,14
  14,AOX,BITS
  1,VIM,FORMSS
  ,AOX,LIB/BOSS
  ,AOX,STARTCW
  ,AOX,SCENDJO
  ,AAX,ШK2
  :,UZA,*+1
  ,ATX,ШK2
  :,XTA,БИTФOHA.ИCKЛЮЧИM
  ,AEX,Ш/FULL.ФOHOBYЮ
  ,AAX,ШK2.ЗAДAЧY
  ,U1A,SMP
  ,XTA,БИTФOHA.-OHA OДHA
  ,UZA,SEL END
C
C...  ПOИCK B ШK2 ЗAДAЧИ C
C     MИHИMAЛЬHЫM ПPИOPИTETHЫM ЧИCЛOM
C
C
  SMAXP:,ENTRY,.CЮДA XOДИT SWING
C
  SMP:,ATX,ШK2
  ,ANX,
  ,ATI,1
  1,XTA,NPRTJ-NUSE1
  ,AAX,MPRT
  ,A-X,RCNT
  ,UZA,ESMP
  ,A+X,RCNT
  ,ATX,RCNT
  1,MTJ,13
  ESMP:1,XTA,BITS
  ,AEX,ШK2
  ,U1A,SMP
  11,UJ,
  SEL END:,24,2003B.ПOKA MЫ
  2,VJM,CHSCALS.TPYДИЛИCЬ,
  ,AEX,FULLRD.OБCTAHOBKA
  ,U1A,RTASK.ИЗMEHИЛACЬ
C
C...   MAT.ЗAДAЧY C YKAЧAHHЫM ИПЗ
C      BЫБEPYT TOЛЬKO ECЛИ ПOДKAЧKA
C           CBOБOДHA !
C
  JOB IS:,XTA,ИПЗ/ECTЬ
  13,AAX,BITS
 ,UZA,HET ИПЗ
 13,WTC,* Y C Ы .ДOПOЛHИTEЛЬHAЯ
 15,VTM,        .ПPOBEPKA
 15,V1M,ECTЬ ИПЗ.HAЛИЧИЯ ИПЗ
C.....   CИTYAЦИЯ: B ИПЗ/ECTЬ CTOИT BITJ,
C        A B COOTBETCTBYЮЩEM YC'E HET AДPECA ИПЗ.
C        BЫPEЗAEM BITJ ИЗ 'ИПЗ/ECTЬ'.
 ,AEX,ИПЗ/ECTЬ
 ,ATX,ИПЗ/ECTЬ
 ,UJ,RTASK
 HET ИПЗ:,BSS,
 13,XTA,*YCЫ
 ,ATX,CWJOB
 ,ATX,SBUSYFLG
 13,XTA,BITS
 ,AOX,SWSCAL
 ,ATX,SWSCAL
 13,VTM,SWING
 ,ITA,13
 ,ATX,SWINGIF+3
 13,VTM,24B.ДHЗ ПOДKAЧKИ
 ,XTA,=1050.ЗAПPOC ИПЗ
 ,ATX,SWINGIF+SI5
 13,XTA,BITS
 ,AOX,RDSCAL
 ,ATX,RDSCAL
 ECTЬ ИПЗ:,BSS,
  ,ITA,13
  ,ATX, Д H З
  13,XTA,BITS
  ,ATX,BITJ
  ,AEX,FULWOR
  ,ATX,ZBITJ
 ,XTA,BITJ
 ,APX,INDI SC
 ,AUX,INDI M
 ,UIA,WR B
 ,XTA,BITJ
 ,AAX,Ш/CЛYЖ
 14,VTM,BIT18
 ,UIA,WR A
 ,XTA,BITJ
 ,AAX,Ш/FULL
 14,VTM,BIT17
 ,UZA,WR B
 WR A:14,XTA,
 WR B:,BSS,
  ,AEX,COMMIR
  ,AAX,=7777 4000
  ,AEX,COMMIR
 ,ATX,COMMIR
 ,002,36B
 ,ATI,
 13,XTA,* Y C Ы.
 ,ATX,Г Y C.
 ,ATI,15.AДPEC ИПЗ
C.........ПPOBEPKA ИCЧEPПAHИЯ KOMMEPЧECKOГO BPEMEHИ ЗAДAЧИ
 ,MOD,101B.CBEPTKA KOMAHД
 ,AAX,B30/16.
 ,UZA,NOMATH.HE MAT.ЗAДAЧA
 ,XTA,6.BIT7(TP6)=ПOK
 ,ASN,64+3
 ,AAX,BIT4
  ,ATX,SAVI13+1.SAVMIR
 ,AOX,C2003
 ,ATX,FORI21B
 15,XTA,REGSCAL.
 ,AAX,BIT4.
 ,U1A,NO DIF.
 ,MOD,107B.CBEPTKA ЧИCEЛ
 NO DIF:,BSS,.
 ,XTA,STARTCW.  CTAPT
 ,AOX,SCENDJO.ИЛИ KOHEЦ
  ,AOX,SCEM*64
 ,AAX,BITJ. ЗAДAЧИ
 ,UIA,NOMATH1. = ДA
 ,NTR,.
 15,XTA,MAXTIME.
 15,A-X,BISTIME.
 ,UZA,NOMATH.BPEMЯ HE ИCЧEPПAHO
C*****   OPГAHИЗAЦИЯ БYДИЛЬHИKA
 15,XTA,TLIMS.БЫЛ ЗAKAЗ
 ,UZA,KILL T. - HET
 15,ATX,MAXTIME.
 15,XTA,S33.
 15,ATX,COPYS33.ДЛЯ ПEЧATИ
  14,VJM,NEW EN.
C*****   PAБOTA OT ИMEHИ ЗAДAЧИ :
  ,WTC, Г Y C .AДPEC
  ,XTA,COPYS33.ПOCЛEДHEГO
  ,ATI,33B.ПPEPЫBAHИЯ
  14,VTM,T BPEM
  ,UJ,ERRMACRO.HA ПEЧATЬ
 KILLT:,XTA,LIMTSC
 13,AOX,BITS
 ,ATX,LIMTSC
C.........BЫБPACЫBAEM ЗAДAЧY ПO BPEMEHИ
 14,VTM,574B.
 NEW EN:,ITA,14.
 15,ATX,S33.
 ,XTA,DISREG.
 15,ATX,S27.
C.........
 NOMATH:,BSS,.
 15,XTA,5
 ,AAX,C14
 ,U1A,NOMATH1
 ,XTA,BITJ
 ,AEX,ROLOUTSC
 ,UZA,BLSAVE
 ,XTA,SCMAMБ
 13,AAX,BITS
 ,U1A,CLMAMБ
 14,CALL,BETBЛEH
 NOMATH1:,BSS,
C
C       ПOЛHOE BOCCTAHOBЛEHИE
C
 14,CALL,PUTTMP
 14,VTM,-11.
 15,XTA,.
   :   ,24,2002B.ДЛЯ ПPEPЫBAH. B MAT. PEЖИME
 ,ATI,35B.PEГ.ПPEP. ПO AДP.ЧИCЛA
   :   ,24,2003B.
 15,XTA,.
   :   ,24,2002B.
 ,ATI,34B.PEГ.ПPEP. ПO AДP.KOMAHДЫ
   :   ,24,2003B.
 15,XTA,.
 ,ATX,1.
 :14,STI,12.BOCCTAH. PEГИCTPOB.
 14,VLM,*.
 14,VTM,RETURN
 BOCИПД:,ENTRY,
 ,STX,SAVI13.BOCCTAHOBЛEHИE ИПД
 ,STX,SAVI14.
 ,STX,SAVI15.
 ,STX,SAVS16.
 ,STI,27B.
 ,STI,32B.
 ,STI,33B.
 ,STX,SAVAR.
 ,STX,SAVSR.
 ,STX,SAVAC.
 14,UJ,
 CLANEWTA:,ENTRY,.
 13,VTM,NEWTA.
 ,UJ,CL TASK
 CL OPER:,ENTRY,
  ,XTA,BITJ
 ,AOX,SC OPER
 ,ATX,SC OPER
 CLTASK:,ENTRY,.
 CLTASK:,BSS,
 ,XTA,RDSCAL.
 ,AAX,ZBITJ
 ,ATX,RDSCAL.
 13,UJ,.
 NEWTA*:,ENTRY,
 ,AOX,RD SCAL
 ,ATX,RD SCAL
 NEWTA:,ENTRY,.
 NEWTA:13,VTM,SELECT.
 ,UJ,FULSAV.
 SAVIND:,ENTRY,.
 C7:,LC,1.
   :   ,24,2003B.
 ,ATX,SAVACC.
 ,ITA,15.
 ,WTC,Г Y C.
 15,VTM,.
 15,ATX,3.
 ,XTA,C7.
 15,ATX,5.
 ,RTE,177B.
 15,ATX,1.
 15,UTM,7.
 ,XTA,SAVACC.
 ,ITS,14.
 14,VTM,13.
 :14,ITS,
 14,UTM,-1.
 14,V1M,*-1.
 15,ATX,.
 13,VTM,SELECT
 ,UJ,CLTASK
 BLSAVE:,BSS,
 ,ATX,ROLOUTSC
 15,XTA,3
 ,ATX,M33
 15,XTA,4
 ,ATX,M32
 15,XTA,5
 ,ATX,M27
 14,VTM,TASKSAVR
 ,ITA,14
 15,ATX,3
 ,XTA,DISREG
 15,ATX,5
 ,UJ,NOMATH1
 FORI21B:,LOG,2003
 MPRT:,LOG,77000000
 БИTФOHA:,BSS,1
 ШK2:,BSS,1
 SCSEM:,BSS,1
 SAVACC:,BSS,1.
 ,END,
 MAINSW:,NAME,.
 INTINTER:,SUBP,.
  * И П Д :LC,BLOCK,XNF,XNFM(4),XNC,XNCM
  * И П K :LC,BLOCK,INFBA
  * И П K 1 :LC,BLOCK,PRTSTAT
 BPEMEHA:,LC,4
  NF :,WEQ,XNF
  NFM:,WEQ,XNFM
  NC :,WEQ,XNC
  NCM:,WEQ,XNCM
  *INFEX:,EQU,INFBA+NCM
   INFEX:,EQU,*INFEX-NFM
 R37BR:,SUBP,
 EXTINTER:,SUBP,.
 RETURN:,SUBP,.
 NEWTA:,SUBP,.
 CLANEWTA:,SUBP,.
 MACRO50:,SUBP,
 MACRO51:,SUBP,
 MACRO52:,SUBP,
 MACRO53:,SUBP,
 WRPHYS :,SUBP,
 WRPHYSM:,SUBP,
 MACRO54:,SUBP,
 MACRO55:,SUBP,
 MACRO56:,SUBP,
 MACRO7CH:,SUBP,
 MACRO57:,SUBP,
 MACRO NEW:,SUBP,
 MACRO60:,SUBP,
 MACRO61:,SUBP,.
 MACRO63:,SUBP,.
 MACRO64:,SUBP,.
 MACRO66:,SUBP,.
 MACRO67:,SUBP,.
 MACRO70:,SUBP,.
 MACRO71:,SUBP,.
 MACRO72:,SUBP,.
 MACRO73:,SUBP,.
 MACRO74:,SUBP,.
 MACRO75:,SUBP,.
 MACRO76:,SUBP,.
  *USESTA:,SUBP,
 BADMACRO:,SUBP,.
 TTPRINT:,SUBP,.
 TRAPHY:,SUBP,.
  SW PINT:,SUBP,
  SW INT :,SUBP,
 *YCЫ:,LC,1.
 TPHYS:,LC,1.
 ДHЗ:,LC,1
 SCDICH:,SUBP,
  ДOПYПP:LC,BLOCK,(10),NTRFRO
  TABLEMT:LC,BLOCK,(16),TMT(96),TDELT(32)
  INF7CH:,LC,1
  *LINKPAR:,LC,
 *SCAL71:,LC,6
  TABDRU:,LC,1
 CHEKMDFL:,LC,1.
 POST:,LC,1
 REWINDSC:,LC,1.
  SCALES:LC,BLOCK,(4),ЖДYMЛMД
 STATUSMT:,LC,1
  TYPEMT:,SUBP,
 DISPBASE:,LC,2.
 *TLSYS:,LC,1
  EMULAT  :,SUBP,
  EXCHNRS :,SUBP,
  STATIST :,SUBP,
  OUTJOBSC :,EQU, * И П Д +52B
 OUTCW:,LC,2
 OUTJOB:,SUBP,
  *STATBUF:,LC,1
  *TDIS   :,LC,1
  *DISCS  :,LC,1
  FATA:,LC,1
  *TYPELP :LC,BLOCK,(4),*LIMITLP
  *NRP1:,PC,
 KOHHИЗ:,LC,
  ISOTOALL:,SUBP,
  ALLTOISO:,SUBP,
 SMASAV:LC,BLOCK,SAVAC
 ,ATX,SAVAC.500B
 ,UJ,INTINTER.BXOД ПPИ BHYTPEHHEM ПPEPЫBAHИИ
 ,ATX,SAVAC.501B
 ,UJ,EXTINTER.BXOД ПPИ BHEШHEM ПPEPЫBAHИИ
C*********         БAЗA TAБЛИЦ И ПOДПPOГPAMM ДИCПETЧEPA
 :,,.
 ,Z00,*YCЫ.
 :,,.
 ,Z00,TPHYS.
 :,,.
 ,Z00,TMT.
 :,,.
 ,Z00,TDELT.
 :,LOG,.KAT. MБ
 :,,
 ,Z00,ДHЗ
 :,,.
 ,Z00,TTPRINT.
  *511:,Z00,NTRFRO
 ,Z00,TABDRU.
 :,Z00,POST
 ,Z00,CHEKMDFL.
 FREESEM:LC,BLOCK,(1),MSELECT
 :,Z00,MSELECT
 ,Z00,TRAPHY.
 :,,.
 ,Z00,CLANEWTA.
 :,,.
 ,Z00,RETURN.
 :,,.
 ,Z00,NEWTA.
 :,,.
 ,Z00,REWINDSC.
 :,,.
 ,Z00,ЖДYMЛMД
 :,  ,
 ,Z00,R37BR.521B
  *522:,LOG,..ПP.ДMHOГO ШИФPOBД
 *523:,,.
 ,Z00,DISPBASE.
 *524:,,
 ,Z00,*NRP1
 *525:,,
 ,Z00,KOHHИЗ
  *526:,Z00,ISOTOALL
  ,Z00,ALLTOISO
C   ДЛИHA ДHEBHOЙ ИHЖ. CTAT. HA 5/D73STA.
C   OHA PABHA ДЛИHE  D73STA  - 40B.
 :,LOG,100.100 ЗOH
C   ПPИЗHAK BEДEHИЯ TEPMИHAЛЬHOЙ CTATИCTИKИ
  *530:,OCT,0000 004.БИT 30 HA TP-2
  *531:,OCT,775.BPEMЯ OЧ.CБPOCA
C
  *532:,BSS,6.PEЗEPB
 *540:,BSS,1.ПPИЗHAK PAБOTЫ C 'TB'
  *541:,LOG,2034
 *542:,LOG, .ACTPOH.BPEMЯ(ASTIME)
C
C      ПPИЗHAK HAЛИЧИЯ CЧETЧИKA
C      BPEMEHИ HA  1 MГЦ.
C
 *543:,LOG,2   .ECTЬ
 *544:,BSS,2
 *546:,Z00,INFEX
 ,,.
  *547:,33,547B.CBOБOДHA
C         ПEPEKЛЮЧATEЛЬ ЭKCTPAKOДOB
 :,UJ,MACRO50
  ,Z00,TYPEMT
 :,UJ,MACRO51
 ,Z00,SCDICH.ГYPEBИЧ
 SWTCHM52:,SUBP,
 :14,V1M,SWTCHM52
 ,UJ,MACRO52
 :14,V1M,WRPHYSM
 ,UJ,MACRO53
 :,UJ,MACRO54
  ,Z00,*TLSYS
 :,UJ,MACRO55
  ,Z00,INF7CH
 :14,VZM,MACRO56
 ,UJ,MACRO7CH
 :14,VZM,MACRO57
 ,UJ,MACRO NEW
 :,UJ,MACRO60
 ,Z00,*LINKPAR.560B
 :,UJ,MACRO61.
 ,Z00,*SCAL71.561B
 :,XTA,712B.
 ,UJ,EMULAT.
 :,ATX,SAVAC.
 ,UJ,MACRO63.
 :,UJ,MACRO64.
  ,Z00,*USESTA
 :,UJ,MACRO63+2.DISPAK,*65,
 ,Z00,OUTCW
 :,UJ,MACRO66.
 ,Z00,OUTJOBSC
 :,UJ,MACRO67.
 ,Z00,OUTJOB
 :,UJ,MACRO70.
 ,Z00,*STATBUF.
 :,UJ,MACRO71.
 ,Z00,EXCHNRS
 :,UJ,MACRO72.
 ,Z00,STATIST.
 :,UJ,MACRO73.
 ,Z00,*LIMITLP.
 :,UJ,MACRO74.
 ,Z00,*TDIS
 :,UJ,MACRO75.
 ,Z00,*DISCS.
 :,UJ,MACRO76.
  ,Z00,FATA
 :14,VTM,577B.
 ,UJ,BADMACRO.
 :,BSS,100B.
C         KOHCTAHTЫ PAЗPЯДOB CЛOBA
 :,OCT,4.
 :,OCT,2.
 :,OCT,1.
 :,OCT,04.
 :,OCT,02.
 :,OCT,01.
 :,OCT,004.
 :,OCT,002.
 :,OCT,001.
 :,OCT,0004.
 :,OCT,0002.
 :,OCT,0001.
 :,OCT,0000 4.
 :,OCT,0000 2.
 :,OCT,0000 1.
 :,OCT,0000 04.
 :,OCT,0000 02.
 :,OCT,0000 01.
 :,OCT,0000 004.
 :,OCT,0000 002.
 :,OCT,0000 001.
 :,OCT,0000 0004.
 :,OCT,0000 0002.
 :,OCT,0000 0001.
 ,LOG,4000 0000.
 ,LOG,2000 0000.
 ,LOG,1000 0000.
 ,LOG,400 0000.
 ,LOG,200 0000.
 ,LOG,100 0000.
 ,LOG,40 0000.
 ,LOG,20 0000.
 ,LOG,10 0000.
 ,LOG,4 0000.
 ,LOG,2 0000.
 ,LOG,1 0000.
 ,LOG,4000.
 ,LOG,2000.
 ,LOG,1000.
 ,LOG,400.
 ,LOG,200.
 ,LOG,100.
 ,LOG,40.
 ,LOG,20.
 ,LOG,10.
 ,LOG,4.
 ,LOG,2.
 ,LOG,1.
  *760:,,STATUSMT
  ,Z00, * И П Д
  *761:,,
  ,Z00, * И П K
 *762:,Z00,BPEMEHA
  ,Z00, * И П K 1
 *763:,,.CBOБOДHO
 ,Z00,RETURN.2-Я ФAЗA ITB10
  *764:,REAL,1.04.ПOKOЛEHИE DD
  *765:,ISO,6HOИЯИ.  .ФИPMA
  *766:,ISO,12HOC ДYБHA OT
  *770:,BSS,2.ДATA OC
  *772:,BSS,3.= P E З E P B
 *775:,BSS,1.= P E З E P B
C
C.....   ЯЧEЙKA 776 - KOПИЯ "EXCHNRS"
 *776:,LOG,
C
C...   ДЛЯ ЛЮБИTEЛEЙ ПEPEXBATA
C        П P E P Ы B A H И Й
C
  *777:,Z00,SW INT. Г P П - 4 8
  ,Z00,SW PINT. П P П - 2 4
 ,END,.
 TESTTA:,NAME,.
C
C         ЗAДAЧA - 'ЖДYЩИЙ TECT'
C
 TESTBUF:LC,BLOCK,(1),TESTIF(36)
 IFS27:,EQU,TESTIF+5.
 IFI11:,EQU,TESTIF+13B.
 BIT1:,EQU,757B.
 TL0:15,VTM,-47.
 ,XTA,BIT1.
 TL1:14,VTM,1.
 ,ATI,.
 TL2:,ATX,1.
 ,ATI,.
 14,VLM,TL2.
 ,ASN,64-1.
 15,VLM,TL1.
 ,UJ,TL0.
 ,DATA,.
C         PEЖИM YY
 S27:,LOG,13.
C         TEKCT 'ЖДY' HA PEГИCTPЫ 11-4
 I11:,BSS,.
 ,LOG,52145.
 ,LOG,52245.
 ,LOG,34245.
 ,LOG,34245.
 ,LOG,52243.
 ,LOG,52241.
 ,LOG,52766.
 ,LOG,00420.
 :1,SET,S27.
 1,,IFS27.
 :8,SET,I11.
 1,,IFI11.
 ,END,.
 TESTTA:,NAME,.
 BIT16:,EQU,740B.
 BIT5:,EQU,753B.
 BIT1:,EQU,757B.
 IFS27:,EQU,5.
 L0:,XTA,BIT1.
 ,ATX,CODEIR.
 L1:,XTA,BIT1.
 ,ATX,NIR.
 L2:,XTA,CODEIR.
 ,WTC,NIR.
 ,ATI,.
 ,XTA,NIR.
 ,ARX,BIT1.
 ,ATX,NIR.
 ,AAX,BIT5.
 ,UZA,L2.
 ,XTA,.
 ,ATX,COUNT.
 L3:,XTA,COUNT.
 ,ARX,BIT1.
 ,ATX,COUNT.
 ,AEX,MAXCOUNT.
 ,U1A,L3.
 ,XTA,BIT1.
 ,ATX,NIR.
 L4:,WTC,NIR.
 ,ITA,.
 ,AEX,CODEIR.
 ,U1A,STOP.
 ,XTA,NIR.
 ,ARX,BIT1.
 ,ATX,NIR.
 ,AAX,BIT5.
 ,UZA,L4.
 ,XTA,CODEIR.
 ,ASN,64-1.
 ,ATX,CODEIR.
 ,AAX,BIT16.
 ,UZA,L1.
 ,UJ,L0.
 STOP:,BSS,.
 :,WTC,NIR.
 ,33,.
 ,UJ,L0.
 MAXCOUNT:,BSS,.
 ,LOG,10000.
 NIR:,BSS,1.
 CODEIR:,BSS,1.
 COUNT:,BSS,1.
 ,END,.
 *YCЫ:,NAME,.
 ,LIST,F
 *SWCMN:LC,BLOCK,SBUSYFLG,SWSCAL,LOWPRT,UPRT,SUPRT,(3)
 ,CONT,CWJOB,STIME,SWINGIF(24)
 BUFTRA:LC,BLOCK,(1),IFTRA(36).
C=== PACПOЛOЖEHИE ИПЗ ===
  LEN:,EQU,200B.ДЛИHA CЛYЖ.ИПЗ
 IFMAT1:,EQU,0.HEPEЗИДEHTHOE ИПЗ
 IFMAT2:,EQU,0.HEPEЗИДEHTHOE ИПЗ
 IFMAT3:,EQU,0.HEPEЗИДEHTHOE ИПЗ
  IFSM1 :,EQU,66003B
  IFSM2 :,EQU,IFSM1+LEN
  IFSM3 :,EQU,IFSM2+LEN
  IFSM4 :,EQU,IFSM3+LEN
C=======================
 ГYC:12,,
  ,Z00,361B.ИПЗ "ЖДY"
 RDSCAL:,LOG,1
  COMMIR:,LOG,10 0240 0000 0000
  COMPIR:,OCT,
  P PIR :,OCT,02.ДЛЯ OPERTERM
  MPPIR:,OCT,77
 M1RDSC:,LOG,7777 7777 7777 7777.
 STCLTA:,LOG,0.
 YCЫ:,BSS,.
 :2,,.
  ,Z00,
 :2,100,.
  ,Z00,
 :2,20,.
  ,Z00,.ИПЗ BBOДA 1
 :2,30,.
  ,Z00,330B.ИПЗ TTTASK
 ,BSS,2.
 :3,20,. 16
  ,Z00,601B.ИПЗ OKHA
 :,BSS,4.
 :4,30,.
  ,Z00,.ИПЗ BBOДA 2
 :5,,.
 ,Z00,SWINGIF.
 ,OCT,. 25
 :5,20,. 26
 ,Z00,IFTRA.
 :5,30,.27
  ,Z00,632B.ИПЗ OПOЗHABAHИЯ
C------
 ,OCT,3000 0000 0006 6003
 ,OCT,3100 0000 0006 6203
 ,OCT,3200 0000 0006 6403
 ,OCT,3300 0000 0006 6603
 ,OCT,3400 0000 0006 7003
 ,OCT,3500 0000 0006 7203
 ,OCT,3600 0000 0006 7403
 ,OCT,3700 0000 0006 7603
C------
 ,OCT,40
 ,OCT,41
 ,OCT,42
 ,OCT,43
 ,OCT,44
 ,OCT,45
 ,OCT,46
 ,OCT,47
 ,OCT,50
 ,OCT,51
 ,OCT,52
 ,OCT,53
 ,OCT,54
 ,OCT,55
 ,OCT,56
 ,OCT,57
C------
 :12,,
  ,Z00,361B.ИПЗ "ЖДY"
 ,LIST,*
 ,END,.
 EXTINTER:,NAME,.
 ,LIST,F
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 BITSWI:,EQU,BIT29.
 EXCHBIT:,EQU,BIT7.
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR
 ,CONT,SAVS16
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,PPIR,MPPIR,M1RDSC,STCLTA
 CWTRA:,EQU,*YCЫ+26B.
 TMATH:,EQU,30B.
 SCALES:LC,BLOCK,(2),S1CLTA.
 RETTRA:,LC,1.
 CMDREC:,LC,1
 TPHYS:,LC,1.
 WSD:LC,BLOCK,WSD1,WSD2,WSD3.
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 FULWOR:,LC,1.
 DISREG:,LC,1.
 C3:,LC,1
  C5:,LC,1
 C7:,LC,1.
 C37:,LC,1.
 C77777:,LC,1.
 BASE*NR:LC,BLOCK,(1),BASENR1,(1)
  YCTP:LC,BLOCK,(5),YCALC
  COMLP:,LC,1
  TTPRINT:,SUBP,
 RETURN:,SUBP,.
 NEWTA:,SUBP,.
 CLANEWTA:,SUBP,.
 ERRPRI:,SUBP,.
 KOHTPOЛЬ:,SUBP,.
 OCTAHOB:,SUBP,
 CALCPRT:,SUBP,.
 SWING:,SUBP,.
 *SWCMN:LC,BLOCK,SBUSYFLG,SWSCAL,RCNT,EXCHSC,SUPRT,(3)
 ,CONT,CWJOB,STIME,SWINGIF
 IFSWI:,EQU,SWINGIF.
 S33:,EQU,3.
 S32:,EQU,4.
 S27:,EQU,5.
 I14:,EQU,10B.
 COPYS32:,EQU,46B.
 COPYI14:,EQU,47B.
 M:,EQU,100B.
 REGSCAL:,EQU,M
 COPYS33:,EQU,M+6.
 RETM67:,EQU,M+7.
 I5:,EQU,21B.
 IC1/2:,SUBP,.
 IC3/6:,SUBP,.
 DISINT:,SUBP,.
 BIO*TL:,SUBP,
 ITIMEB10:,SUBP,
 PUTPIR  :,SUBP,
 CONINT/I:,SUBP,
 CONINT/O:,SUBP,
 ПPEPKAPT:,SUBP,.
 ПPEPKAPT:I,BLOCK,ПPEPKAP0(2),ПPEPKAP1(2)
 ,CONT,CИBY7000(2),CИBY7001(2)
 ,CONT,HK И CИ0(2),HK И CИ1
 ЗAПYCK:,SUBP,
 STARTJOB:,SUBP,.
 NSTAJOB:,LC,1.
  BASEPRTA:,LC,1
  PRINTASK:,SUBP,
 CИ AЦПY:,SUBP,.
 HYЛИAЦПY:,SUBP,.
 PROGINT:,SUBP,.
 STOP:,SUBP,.
 INTPT:,SUBP,
 TTENTRY:,SUBP,.
 *TLSYS:LC,BLOCK,(2),EDITOR
  *TLPRMT:LC,BLOCK,(12),/UVCH/
 NRESLINE:,SUBP,
 MUX152B:,SUBP,
 SIGNSAVE:,LC,1
 ПEPФOPAЦ:,SUBP,.
 CИПEPФ:,SUBP,.
 CИKOHTP:,SUBP,.
 CИПЛ:,SUBP,.
  C377:,LC,1
  BNR7CH:,LC,1
  NR7CH:,SUBP,
 KOHOБM7:,SUBP,
 BЗBП:,SUBP,
 ПYCП:,SUBP,
  OT COCEДA:,SUBP,
 FSBASENR:LC,BLOCK,(1),BASE405
 NRCDC405 :,SUBP,
 ENDEXT6:,SUBP,
 EFSMNRS:,SUBP,
  TYPEMT:,SUBP,
  FL405:,EQU,TYPEMT+4.ПPИЗHAK ДYБHЫ
  FIRM:,IFSEQ,D,DD**FI
  K*N/SEND:,LC,1
  K*RECEIV:,SUBP,
  K*SEND:,SUBP,
  FIRM:,ENDIF,
 CONTIME:LC,BLOCK,(5),TCALC,(8)
 BINP:,EQU,EFSMNRS.БAЗA BBOДA
 *STATBUF:LC,BLOCK,(9),CTATПEЧ(2),(4),ПOДK
  *5:,BLOCK,ЧYЖKOM,ЧYЖЛИC,ЗAПPKOM,ПEPEПOЛH,ДEЛHA0
  *ИПД:,LC,1
  LIBBOSS:,EQU,*ИПД+72B
C
C         OБPAБOTKA BHEШHИX ПPEPЫBAHИЙ
C
            ,  RTE  , 07777B        .
            ,  ATX  ,SAVSR          .
 ,XTA,DISREG.
 ,ATI,21B.OCTAHOB KK,KЧ
            ,  ITA  , 15            .
 15,VTM,SAVI15
 ,ITS,14
 ,ITS,13
 ,ITS,16
 ,ATX,SAVS16
 ,YTA,
 ,ATX,SAVAR
            ,  MOD  , 00237B        .
  ,ATX,SAVMIR
            ,  AAX  , COMMIR        .
            ,  UZA  ,L15710         .
 INTER:,ENTRY,.
C
C      BXOД ИЗ БЛOKA 'BOЗBPAT ИЗ ПPEPЫBAHИЯ'
C         *ECTЬ EЩE ПPEPЫBAHИE*
C
 ,ATX,PERREG
 ,AAX,PRT/MASK
 :,U1A,*+1
 ,XTA,PERREG
            :,  ANX  ,               .
            ,  ATI  , 14            .
          14,  XTA  ,BITS           .
  ,AEX,CLEMIR.ГAШ.BH.ПPEP.
            ,  ATI  ,               .
            ,  MOD  , 00037B        .
          14,   UJ  , SWINT-1       .
 INTINTER:,ENTRY,.
C
C         OБPAБOTKA BHYTPEHHИX ПPEPЫBAHИЙ
C
 ,RTE,7777B.
 ,ATX,SAVSR.
 ,XTA,DISREG
 ,ATI,21B.OCTAHOB ПO KOHTPOЛЮ
 ,ITA,15
 15,VTM,SAVI15
 ,ITS,14
 ,ITS,13
 ,ITS,16
 ,ATX,SAVS16
 ,YTA,
 ,ATX,SAVAR
 ,MOD,237B.
 ,ATX,SAVMIR.
 ,XTA,CLEMIR.
 ,ATI,.
 ,MOD,37B.
 ,ATI,.
 ,XTA,Г Y C.
 ,AEX,CWTRA.
 ,U1A,NOTRA.
  ,XTA,SAVAC
 ,WTC,SAVI15
 15,VTM,
 ,WTC,RETTRA.
 ,UJ,.
 NOTRA:,BSS,
 ,XTA,SAVMIR.
 ,AAX,WELINT.
  ,UZA,L15710
 ,ANX,.
 ,ATI,14.
 14,UJ,SWINT-1.
C
C   ПPИOPИTETHЫE ПPEPЫBAHИЯ :
  PRT/MASK:,OCT,.6010 01
C
C
C     ===================================
C     I     ПPEPЫBAHИЯ ПO   Г P П :     I
C     ===================================
C
  SW INT:,ENTRY,.ПOCЛE PRT/MASK !!!
C
 SWINT:,BSS,.
 :13,VTM,.
 ,UJ,CИ .
 :13,VTM,1.
 ,UJ,CИ .
 :14,VTM,1. 46
 ,UJ,IC1/2.
 :14,VTM,2. 45
 ,UJ,IC1/2.
 :,WTC,FSBASENR
 ,UJ,HKИCИ0-BINP
 :,WTC,FSBASENR
 ,UJ,HKИCИ1-BINP
 :,WTC,FSBASENR
 ,UJ,INTPT-EFSMNRS
  FIRM:3,IFSEQ,D,DD**FI
  /41:,EXT,4015B.ЧT.KOДA
  ,UJ,K*RECEIV.41
  FIRM:2,ELSE,
 :,WTC,FSBASENR
 ,UJ,INTPT-EFSMNRS
 :,NTR,3
 ,UJ,BIO*TL.40 P. ГPП
 :13,VTM,.
 ,UJ,HYЛИ.
 :13,VTM,1.
 ,UJ,HYЛИ.
 :,XTA,BASENR1. 37
 ,UJ,PERINT.
 :14,VTM,3. 36
 ,UJ,IC3/6.
 :14,VTM,4. 35
 ,UJ,IC3/6.
 :14,VTM,5. 34
 ,UJ,IC3/6.
 :14,VTM,6. 33
 ,UJ,IC3/6
 :,XTA,6. 32
 ,UJ,ORDER.
  :,WTC,BNR7CH
  ,UJ,ПYCП-NR7CH.31
 :,UJ,PROGINT.
 :14,VTM,3. 29
 ,UJ,DISINT.
 :14,VTM,4. 28
 ,UJ,DISINT.
 :,33,27.
 :,WTC,BASE405 .26
  ,UJ,ENDEXT6-NRCDC405
  :,WTC,BNR7CH
  ,UJ,KOHOБM7-NR7CH.25
 :,33,24.
 :14,VTM,ДEЛHA0. 23
 ,UJ,ERRPRI.
 14,VTM,ПEPEПOЛH. 22
 ,UJ,ERRPRI.
 :14,VTM,0.KOHTPOЛЬ ЧИCЛA
 ,UJ,KOHTPOЛЬ.
 :13,VTM,ЗAЩЧИCЛ. 20
 ,UJ,S27COR.
 :,33,19.
 ,UJ,*.
 :,33,18.
 ,UJ,*.
 13,VTM,OCTAHЧИC. 17
 ,UJ,S27COR.
 :13,VTM,OCTAHЧИC. 16
 ,UJ,S27COR.
 :14,VTM,1.KOHTPOЛЬ KOM-ДЫ
 ,UJ,KOHTPOЛЬ.
 :13,VTM,ЗAЩKOM. 14
 ,UJ,S27COR.
 :14,VTM,ЗAПPKOM. 13
 ,UJ,ERRPRI.
 :13,VTM,OCTAHKOM. 12
 ,UJ,S27COR.
 ,XTA,
 ,UJ,ECMEДЛ
 :,UJ,ITIMEB10.10 P. ГPП
C   ==================
C
 S27COR:,BSS,.
 ,XTA,ГYC.
 ,ATI,15.
 ,ITA,27B.
 ,ATX,WSD1.
 ,AAX,BIT10.
 ,ASN,64+1.
 ,ATX,WSD2.
 ,AEX,BIT9.
 ,AEX,WSD1.
 ,ATI,27B.
 ,AOX,WSD2.
 13,UJ,.
 S33COR1:,BSS,. 534B
 ,XTA,WSD1.
 ,AEX,WSD2.
 ,ATI,27B.
 S33COR:,BSS,.
 ,AAX,BIT9.
 13,UZA,.
 ,ITA,33B.
 ,ARX,C77777.
 ,ATI,33B.
 13,UJ,.
 ЗAЩЧИCЛ:,BSS,.
 14,VTM,ЧYЖЛИC
 13,VJM,S33COR.
 ,XTA,SAVMIR.
 ,ASN,64+4.
 ,AAX,C37.
 ,ATI,15.
 ENTFOLIC:,ENTRY,.
C
C*****   PEAKЦИЯ HA ЗAKPЫTЫЙ ЛИCT
C
 ЗAЩOБЩ:,BSS,.
 ,WTC,ГYC.
 15,XTA,TMATH.
 ,ASN,64+30.
 ,UZA,ERRPRI
 ,ATI,14
 ,ASN,64+16
 ,U1A,PRTASWI
 14,XTA,TPHYS
 ,AAX,EXCHBIT.
 ,U1A,ЗAKPOБM.
 ,UJ,RETURN.
 PRTASWI:,BSS,
 ,XTA,PPIR
 ,AAX,BIT48
 ,AEX,PPIR.ГACИM PIR T.K.
 ,ATX,PPIR.EЩE HE БЫЛO ПPOTAЛKИBAHИЯ
 14,VZM,GIVEPAGE
 ,XTA,BIT1.BЫЧИCЛ. ПPИOP.
 ,ARX,ПOДK.CЧET. ПPИOPИT.
 ,ATX,ПOДK.B CTATИCTИKY
 ,ITA,14
 ,UJ,CALCPRT.
 GIVEPAGE:,ENTRY,.
C
C         BXOД ДЛЯ OБPAЩEHИЯ K ПOДKAЧKE OT ЗAДAЧИ
C
 GIVEPAGE:,BSS,.
 ,XTA,SWSCAL
 ,AOX,BITJ
 ,ATX,SWSCAL
 ,XTA,SBUSYFLG.
  ,U1A,NEWTA
 ,XTA,BIT37.
 ,ARX,ПOДK.CЧET. ПOДKAЧ.
 ,ATX,ПOДK.B CTATИCTИKY
 ,XTA,RDSCAL.
 ,AOX,BITSWI.
 ,ATX,RDSCAL.
 14,VTM,SWING.
 ,ITA,14.
 ,ATX,IFSWI+S33.
 ,ITA,15.
 ,ATX,IFSWI+I5.
 ,XTA,Г Y C.
 ,ATX,CWJOB.
 ,ATX,SBUSYFLG.
 ,UJ,NEWTA
 ЗAKPOБM:,BSS,.
 ,ITA,14
 ,ASN,64-30
 ,AOX,ГYC
 ,ATX,ГYC.
 ,WTC,Д H З.
 ,ATX,*YCЫ.
  14,XTA,TPHYS
  ,ASN,64-42.БИT6-->48
  ,AUX,BITJ
  ,AOX,EXCHSC
  ,ATX,EXCHSC
 ,UJ,CLANEWTA.
 ЗAЩKOM:,BSS,.
 14,VTM,ЧYЖKOM
 13,VJM,S33COR1.
 ,ITA,33B.
 ,ASN,64+10.
 ,ATI,15.
 ,UJ,ЗAЩOБЩ.
 OCTAHЧИC:,BSS,.
  14,UTM,-32.0-ЗП,1-ЧT.
 13,VJM,S33COR.
 15,XTA,REGSCAL
 ,AOX,BIT19
 15,ATX,REGSCAL
  ,UJ,SETR13
 OCTAHKOM:,BSS,.
  14,VTM,2.OCT.ПO NKOM.
 13,VJM,S33COR1.
 15,XTA,REGSCAL
 ,AOX,BIT19
 ,AEX,BIT19
 15,ATX,REGSCAL
  SETR13:15,MTJ,13
 ,UJ,OCTAHOB
C
  CИ:,WTC,BASEPRTA
  14,VTM,
  14,UJ,CИAЦПY-PRINTASK
  HYЛИ:,WTC,BASEPRTA
  14,VTM,
  14,UJ,HYЛИAЦПY-PRINTASK
C
 PERINT:,BSS,.
 ,ATI,13. БAЗA ЛИCTA ПEPФOPAЦИИ
 ,EXT,4030B.
 ,ATX,PERREG.
 ,EXT,4034B.
 ,AOX,PERREG.
 ,AAX,COMPIR.
 ,UZA,RETURN.
 ,ANX,.
 ,ATI,15.
 15,XTA,BITS.
 ,AEX,FULWOR.
 ,EXT,30B.
 ,XTA,BIT37.
 ,AEX,FULWOR.
 ,ATI,.
 ,MOD,37B.
  15,XTA,BITS
  ,AAX,C377
  15,UZA,SWPINT-25
  :,WTC,BNR7CH. П E P E Д
  ,UJ,BЗBП-NR7CH."SWPINT" !!!
C
C
C     ===================================
C     I     ПPEPЫBAHИЯ ПO   П P П :     I
C     ===================================
C
  SW PINT:,ENTRY,
C
 SWPINT:,BSS,.
  :,UJ,OT COCEДA.MEЖMAШ.CBЯЗЬ
 :,WTC,FSBASENR
 ,UJ,CИBY7001-BINP
 :,WTC,FSBASENR
 ,UJ,ПPEPKAP0-BINP
  :,UJ,CHWXTX.ПOПOB M.Ю.
 :14,VTM,.
 13,UJ,CИKOHTP-ПEPФOPAЦ.
  14,VTM,1
  13,UJ,CИ KOHTP - ПEPФOPAЦ
 :14,VTM,.
 13,UJ,CИПEPФ-ПEPФOPAЦ.
 :14,VTM,1.
 13,UJ,CИПEPФ-ПEPФOPAЦ.
 :14,VTM,.
 13,UJ,CИПЛ-ПEPФOPAЦ.
  FIRM:3,IFSEQ,D,DD**FI
  /15:,XTA,K*N/SEND
  ,UJ,K*SEND
  FIRM:2,ELSE,
 :14,VTM,1.
 13,UJ,CИПЛ-ПEPФOPAЦ.
 :14,VTM,2.
 13,UJ,CИПЛ-ПEPФOPAЦ.
  :,XTA,YCALC
  ,UJ,ПPП13.CALCOMP
 :14,VTM,0.VT/CONS
 ,UJ,CONINT/I.INP-0
 :14,VTM,1.VT/CONS
 ,UJ,CONINT/I.INP-1
 :14,VTM,0.VT/CONS
 ,UJ,CONINT/O.OUT-0
 :14,VTM,1.VT/CONS
 ,UJ,CONINT/O.OUT-1
 ORDER:,BSS,.
 ,AAX,C7.
 ,ATI,13.
 :,UZA,RETURN.= 0-Й ПPИKAЗ
  13,UJ,*
 :,XTA,1.
 ,UJ,B.
 :15,VTM,1.ПPИЗHAK 'STOP'
 ,UJ,TOSTOP
 :15,VTM,.ПPИЗHAK 'SAVE'
 ,UJ,TOSAVE
  :13,VTM,RETURN.PEЗEPB, T.K.ЭTO
  ,UJ,RESMASK.ДEЛAET И "YCT.0"
 :,XTA,3. ПPИKAЗ 5
 ,UJ,ЗAПИCЬ.
 :,XTA,5. ПPИKAЗ 6
 ,UJ,NSJOB.
 :,XTA,5.ПPИKAЗ 7 = "ДKO"
 ,ATI,13
 ,ITA,13
 ,ASN,64+3
 ,AEX,C3
 ,UZA,ДKO
 ,AEX,C7
 ,U1A,RETURN
 ДKO:13,XTA,BIT16-30B
 ,AOX,CMDREC
 ,ATX,CMDREC
 ,UJ,RETURN
 NSJOB:,BSS,.
C.........         ЗAПYCK CTAHДAPTHOЙ ЗAДAЧИ
 ,AAX,C77777.
 ,ATX,NSTAJOB.
 ,UZA,RETURN.
 ,UJ,STARTJOB.
 B:,AAX,BIT48.
 ,ATX,NSTAJOB.
 ,UJ,ЗAПYCK.
  ЗAПИCЬ:,WTC,5
  14,VTM,-LIBBOSS
  14,VZM,NEWTA.HE ПИШEM
  ,MOD,101B.KOM.CBEPTKA
  14,ATX,LIBBOSS
  ,UJ,NEWTA
 TOSTOP:,XTA,5
 ,UJ,STOP
 TOSAVE:,BSS,
 ,XTA,5.
 ,AAX,C37
 ,UIA,STOP
 ,XTA,C37
 ,ATX,SIGNSAVE
 ,UJ,STARTJOB
C---
 CHECKLP:,ENTRY,
 TIME10:,SUBP,
 13,VTM,0
 ,UJ,CHTLP
 :13,VTM,1
 CHTLP:,BSS,
 13,XTA,CONTIME+8
 ,ARX,BIT45
 13,ATX,CONTIME+8
 ,U1A,TIME10
 ,XTA,BIT25
 13,ARX,CTATПEЧ
 13,ATX,CTATПEЧ
  ,UJ,KOPMAC
  ECMEДЛ:,EXT,4027B
  ,ATI,
  ,ATX,PERREG
  ,AAX,COMLP
  ,UZA,L15711
  ,ANX,
  ,ATI,13
  13,UTM,-45
 KOPMAC:,BSS,
 ,XTA,
 13,ATX,CONTIME+8
 ,XTA,COMLP
 13,AOX,BIT4
 13,AEX,BIT4
 ,ATX,COMLP
 ,033,26B.
  ,EXT,4000B
 CLOMIR:,SUBP,
 ,XTA,RDSCAL
 13,AOX,BIT41
 ,ATX,RDSCAL
 ,XTA,COMLP
 ,U1A,NEWTA
 ,XTA,BIT11
  13,VTM,NEWTA
  ,UJ,CLOMIR
C
C...   BOCCTAHOBЛEHИE MACOK ГPП И ПPП
C      ПO ИX ПPOГPAMMHЫM KOПИЯM.
C
  RESMASK:,ENTRY,
  RESMASK:,XTA,COMPIR
  ,UZA,PERMIR.HET MПPП
  ,XTA,/UVCH/
  ,UZA,PERPIR.NO MPX
  ,AOX,C5
  ,ATX,/UVCH/.-BOCCT.MACOK
  ,EXT,155B. CПEЦ.KAHAЛA
  ,XTA,BIT19.-ПOДTBEPЖДEHИE
  ,EXT,165B. ПPИEMA
  ,XTA,FULWOR.-BЫДAЧA
  ,EXT,164B. CИHXP.БAЙTA
  ,XTA,
C
C...   PAЗPEШEHИE ПPEPЫBAHИЙ ПO ПPП
C
 PERPIR:,ENTRY,
  PERPIR:,24,2003B
 ,AEX,FULWOR
 ,EXT,30B
 ,AEX,FULWOR
 ,AOX,COMPIR
 ,ATX,COMPIR
 ,EXT,34B
 ,XTA,BIT37
C...
 PERMIR:,ENTRY,.
C
C      ГAШEHИE ГPП , PAЗPEШEHИE ПPEPЫBAHИЙ B ГPM
C
  PERMIR:,24,2003B
 ,AEX,FULWOR
 ,MOD,37B
 ,AEX,FULWOR
 SETMIR:,ENTRY,
 ,24,2003B
 ,AOX,COMMIR.
 WRMASK:,BSS,.
C      ЗAПИCЬ B ГPM И KOПИЮ ГPM
 ,ATX,COMMIR.
 ,MOD,36B.
 ,ATI,.
 13,UJ,.
  CHWXTX:,XTA,FL405.B ДYБHE
  ,WTC,FSBASENR.BMECTO YBBK-2
  ,UZA,ПPEPKAP1-BINP."WX4675" И
 ,XTA,EDITOR
 ,ATI,13
 13,UTC,-1
 13,V1M,MUX152B-NRESLINE
 ,XTA,BIT21
 13,VTM,RETURN
 0,CALL,CLOPIR
  ПPП13:,ASN,64+42
  ,ATI,13
  13,VZM,CL13
  13,XTA,BITS
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  CL13:13,VTM,NEWTA
  ,XTA,BIT13
 CLOPIR:,ENTRY,
 ,AEX,FUL WOR
 ,AAX,COMPIR
 ,ATX,COMPIR
 ,EXT,34B
 ,XTA,BIT37
 ,AEX,FUL WOR
 ,ATI,
 ,MOD,37B
 ,XTA,COMPIR
 13,U1A,
 ,XTA,BIT37
C   ----------------------
 CLOMIR:,ENTRY,.
C
C         ЗAПPET ПPEPЫBAHИЙ B ГPM
C
 :,24,2003B.
 ,AEX,FULWOR.
 ,AAX,COMMIR.
 ,UJ,WRMASK.
C
C---  ЧYЖOE ПPEPЫBAHИE
C
  L15710:,UTC,TEXT-TEXTA
  L15711:14,VTM,TEXTA
  ,ITA,14
  14,VTM,RETURN
  ,UJ,TTPRINT
  TEXT :,ISO,12HOШ.ПPEPЫB.''''
  TEXTA:,ISO,12HOШ.ПPEP.AЦП''
 CLEMIR:,LOG,7777 7777 0140 3000.
 WELINT:,LOG,7637 4000.
 PERREG:,BSS,1.
 ,LIST,*
 ,END,.
  K COCEДY:,NAME,
C*
C***  30.9.84   AЛMA-ATA, KAЗГY
C*               A.П.CAПOЖHИKOB
C*
C*     MEЖMAШИHHЫЙ OБMEH COOБЩEHИЯMИ
C*     ------------------------------
C*        OCHOBHЫE ПOЛOЖEHИЯ :
C*
C*  1. KAЖДAЯ ИЗ ДBYX MAШИH CПOCOБHA
C*     ПEPEДATЬ COCEДHEЙ 24 БИTA ИHФOPMAЦИИ.
C*     ЭTO ДEЛAETCЯ KOMAHДOЙ ,033,153B
C*     ПPИ ЭTOM ПEPEДABAEMAЯ ИHФOPMAЦИЯ
C*     HAXOДИTCЯ B 1-24 PAЗPЯДAX CYMMATOPA.
C*     "1" 24 PAЗPЯДA BЫЗЫBAET HA COCEДHEЙ
C*     MAШИHE ПPEPЫBAHИE ПO 24 P.  П P П.
C*
C*     ПOЛYЧИB ПPEPЫBAHИE, MAШИHA-AДPECAT
C*     CЧИTЫBAET ПEPEДAHHYЮ EЙ ИHФOPMAЦИЮ
C*     KOMAHДOЙ  ,033,4153B .
C*     ПPEPЫBAHИE ГACИTCЯ KOMAHДOЙ ,033,30B
C*     ЗAПИCИ B ПEPИФ. PEГИCTP ПPEPЫBAHИЙ.
C*
C*  2. AППAPATYPA MEЖMAШИHHOГO OБMEHA
C*     MOЖET БЫTЬ ИCПOЛЬЗOBAHA ДЛЯ PAЗЛИЧHЫX
C*     ЦEЛEЙ.  ДAHHAЯ ПPOГPAMMA ЗAДYMAHA ДЛЯ
C*     CИHXPOHИЗAЦИИ ДOCTYПA K ЛИЧHЫM ФAЙЛAM
C*     OT ДBYX MAШИH, ИMEЮЩИX OБЩИЙ KMД.
C*     ДPYГИE ЦEЛИ MOГYT БЫTЬ PEAЛИЗOBAHЫ
C*     ДOБABЛEHИEM B ПPOГPAMMY HOBЫX TИПOB
C*     COOБЩEHИЙ.
C*
C*  3. CTPYKTYPA COOБЩEHИЯ :
C*     --------------------
C*      1:17 - ИHФOPMAЦИOHHAЯ ЧACTЬ (I)
C*     18:22 - TИП COOБЩEHИЯ (T)
C*      23 - БИT ЧETHOCTИ.
C*      24 - БИT ПPEPЫBAHИЯ.
C*     БИTЫ 24 И 23 ФOPMИPYЮTCЯ ПPOГPAMMOЙ.
C*
C*         TИПЫ COOБЩEHИЙ :
C*
C*     T=0     - OTBET HA PAHEE BЫДAHHЫЙ
C*               ЗAПPOC
C*     T<20B   - ИHФOPMAЦИOHHAЯ ПOCЫЛKA,
C*               HE TPEБYЮЩAЯ OTBETA
C*     T<40B   - ЗAПPOC, TPEБYЮЩИЙ OTBETA
C*
C*
C*  4. ПPИ ЗAKAЗE ДИCKOBЫX PECYPCOB
C*     KAЖДAЯ MAШИHA OБPAЩAETCЯ K COCEДY ЗA
C*     PAЗPEШEHИEM И ДOЖИДAETCЯ OTBETA :
C*        ,XTA, <ЗAПPOC>
C*        ,CALL, K COCEДY
C*     HA BЫXOДE CYMMATOP = 0,  ECЛИ
C*     PAЗPEШEHИE ПOЛYЧEHO.
C*     OБPAБOTKA ЗAПPOCA И ПOCЫЛKA OTBETA
C*     ПPOИЗBOДЯTCЯ БЛOKOM PEAKЦИИ HA
C*     ПPEPЫBAHИE.  B CЛYЧAE BCTPEЧHЫX
C*     ЗAПPOCOB ПPOИЗBOДИTCЯ ПOBTOPHAЯ
C*     ПOCЫЛKA OБOИMИ MAШИHAMИ.
C*
C*
C*  5. BЫXOД ИЗ БЛOKA CBЯЗИ ПO 13 PEГИCTPY.
C*     ПPEPЫBAHИЯ ЗAKPЫTЫ.
C*     ПPИ  T<20B  ПOPTИTCЯ TOЛЬKO SAVS16.
C*     ПPИ T=>20B ПPOИЗBOДИTCЯ CПACEHИE
C*     И BOCCTAHOBЛEHИE PEГИCTPOB B ПOЛE
C*     MAЛOГO YПPЯTЫBAHИЯ.
C*     ИTAK, ДЛЯ ИCПOЛЬЗOBAHИЯ ПPOГPAMMЫ
C*     MEЖMAШИHHOГO OБMEHA TPEБYETCЯ
C*     TOЛЬKO 13-Й PEГИCTP.
C*     ПOPTЯTCЯ CПEЦ.PEГИCTPЫ: 27,33,SAVS16
C*
C*
  *677:B,BLOCK,BITS
  ,CONT,B48,B47,B46,B45,B44,B43
  ,CONT,B42,B41,B40,B39,B38,B37
  ,CONT,B36,B35,B34,B33,B32,B31
  ,CONT,B30,B29,B28,B27,B26,B25
  ,CONT,B24,B23,B22,B21,B20,B19
  ,CONT,B18,B17,B16,B15,B14,B13
  ,CONT,B12,B11,B10,B9,B8,B7
  ,CONT,B6,B5,B4,B3,B2,B1
  C77777:,LC,1
  C7777:,LC,1
  C77:,LC,1
  C37:,LC,1
  C7:,LC,1
  C377:,LC,1
  FULWOR:,LC,1
  B24/1:,LC,1
  B16/1:,LC,1
  DISREG:,LC,1
  *CB:,LC,
  C17:,EQU,*CB+1
  MASK12:,LC,
C---
  *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR
  SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR
  ,CONT,SAVI15,SAVI14,SAVI13
  ,CONT,(1),SAVS16
  Д H З:LC,BLOCK,(1),BITJ,ZBITJ
  ШЛAГБAYM:LC,BLOCK,(12),SEM
  *ПДИCK:,LC,
  YДABЛEHЫ:,LC,1
  SCALES:LC,BLOCK,(1),MRDSCAL(3),SCCLTA
  TABLEMT:LC,BLOCK,T1(48),T2
  DISPBASE:LC,BLOCK,(6),NUMA
  FREESEM:,LC,1
  *ИПД:,LC,
  FATA:,LC,
 *TLSIZE:LC,BLOCK,(1),XNPHCH
 NPC:,WEQ,XNPHCH
 NPC1:,EQU,NPC-1
 NPC2:,EQU,NPC-2
 *TLBUFI:LC,BLOCK,CIN
 XNT:,EQU,1
  C1777:,LC,1
  FREXT:,EQU,*ИПД+34B
  NSEM:,EQU,*ИПД+7
  SEM212:,EQU,9.ДOCTYП K ИПЗ
  XLFATA:,EQU,*ИПД+20B
  MONO:,EQU,*ИПД+33B
  LFATA:,WEQ,XLFATA
  LFAT1:,EQU,LFATA-1
C---
  CLANEWTA:,SUBP,
  RETURN:,SUBP,
  NEWTA:,SUBP,
  DELTIMER:,SUBP,
C---
C
  LINCOM:LC,BLOCK,ISLINK.ЧTO ПPИHЯЛИ
  ,CONT,AN/SW.ПOCЛE OTBETA
  ,CONT,ANSWER.OTBET
  ,CONT,SAVR(5).PAY, И15-И13, AC
  ,CONT,MESS/S(2).ПOCЫЛAEMOE
C
C
 TERP:I,BLOCK,.PAБ. ЯЧ.
  ,CONT,MESS(0),MACKA
 TERT:I,BLOCK,.PAБ. ЯЧ.
  ,CONT,SR13(0),OБPAЗ
C
C--------------------------
C
   B:,24,2003B
  ,ATX,SAVS16
  ,AAX,B22
  ,UZA,SND ONLY
  ,XTA,ISLINK
  13,UZA,.HET CBЯЗИ
C
C---   BXOД B KPИT. ИHTEPBAЛ ЗAПPOCA
C
 :13,MTJ,16
  ,CALL,SAVEMOD
  ,XTA,DISREG
  ,ATI,27B
  ENTRY:,XTA,SEM
  ,UZA,FREE
  ,AEX,ДHЗ
  ,AAX,C77
  ,UZA,OWN
  ,WTC,ДHЗ
  ,XTA,BITS-6
  ,AOX,SEM
  ,ATX,SEM
  13,VTM,ENTRY1
   CLOSE:13,MTJ,33B
  ,UJ,CLANEWTA
  ENTRY1:,XTA,SAVS16.ПOBTOPHЫЙ
  ,ARX,.BXOД
  ,U1A,ENTRY.OT SEMDOWN
  ,UJ,DWN. - ДA
  FREE:,XTA,ДHЗ
  ,ATX,SEM
C
C...   CПACEHИE BXOДHЫX PEГИCTPOB
C
 OWN:15,VTM,SAVR
  ,ITA,32B
  ,AOX,SAVSR
  ,XTS,SAVI15
  ,XTS,SAVI14
  ,XTS,SAVI13
  ,XTS,SAVAC
  ,XTS,SAVS16
  15,ATX,
  ,ARX,
  ,U1A,TO SEND
C
C...   ПOCЫЛAEMOE COOБЩEHИE - OT SEMDOWNS
C
  ,ASN,64+24
  ,ARX,SPECDWN
C
C---  OЧEPEДHAЯ ПOПЫTKA ПOCЫЛKИ COOБЩEHИЯ
C
  TO SEND:14,VTM,TIME OUT
  ,ITS,14
  ,STX,AN/SW
  13,VJM,SEND
  ,XTA,TIME
  ,*57,13B.ЗAKPЫЛИCЬ
  ,WTC,AN/SW
  ,UJ,
C
C...   ПEPEДAЧA ПPOШЛA C OШИБKOЙ
C      ИЛИ БЫЛ BCTPEЧHЫЙ ЗAПPOC.
C
  REPEAT:,XTA,MESS/S+1
  ,ARX,B45.CЧETЧИK
  ,U1A,TO SEND.ПOBTOPEHИЙ
  ,UTC,TERP-TERT
C
C...   ИCTEKЛO ДOПYCTИMOE BPEMЯ
C      OЖИДAHИЯ OTBETA.
C
  TIME OUT:14,VTM,TERT
  ,XTA,NUMA
  ,ASN,64+46
  ,AEX,=6HБЭCM-3
  14,ATX,
  ,XTA,
  ,ATX,ANSWER
  ,ATX,ISLINK
  ,ITA,14
  14,CALL,TTPRINT
C
C...   OTBET ПOЛYЧEH.  BЫXOД.
C
  EXIT:,XTA,SEM
  ,ASN,64+6
  ,AOX,RDSCAL
  ,ATX,FREESEM
  ,STX,RDSCAL
  ,XTA,
  ,STX,SEM
  ,STX,SAVAC
  ,ATX,SAVI13
  ,STI,13
  ,ATX,SAVI14
  ,STI,14
  ,ATI,15
  ,ATX,SAVI15
  ,XTA,SAVR
  ,ATX,SAVSR
  ,ATI,32B
  ,XTR,SAVSR
  ,XTA,MESS/S
  ,ARX,
  ,UZA,SEM/CONT
  ,XTA,ANSWER
  13,UJ,
C
C     *************************************
C     *                                   *
C---  * ПPOЦEДYPЫ ДЛЯ PAБOTЫ C CEMAФOPAMИ:*
C     *   S E M D O W N S,   S E M U P    *
C     *                                   *
C     *************************************
C
C      ИHФOPMAЦИOHHOE CЛOBO - HA CYMMATOPE:
C          1-15   : BOЗBPAT
C         25-39   : AДPEC CEMAФOPA
C           48    : "1", ECЛИ OH 2-MAШИHHЫЙ
C                 ПOPTЯTCЯ : SAVS16, И33.
C
  SEMDOWNS:,ENTRY,
  :,24,2003B
  ,ATX,SAVS16
  13,MTJ,16
  ,CALL,SAVEMOD
C
C...  BXOД +2  - ДЛЯ NRESCALL
C
  :,XTA,DISREG
  ,ATI,27B
  DWN:,XTA,SAVS16
  ,ASN,64+24
  ,ATI,13.CEMAФOP
  ,XTA,NSEM
  13,APX,B48-ШЛAГБAYM.+ ПPИЗHAK
  ,AOX,SAVS16.ДBYXMAШИHHOГO
  ,ATX,SAVS16.CEMAФOPA
  13,XTA,
  ,AAX,C77.Y HAC
  ,UZA,FRSEM.-CBOБOДEH
  ,AEX,ДHЗ
  ,UZA,RETDWN.CBOЙ
  BUSY:,WTC,ДHЗ
  ,XTA,BITS-6
  13,AOX,.ЗAKPЫTИE
  13,ATX,.  ПO
  13,VTM,DWN.ЗAHЯTOCTИ
  ,UJ,CLOSE.CEMAФOPA
C
  SEM/CONT:,WTC,MESS/S+1.TOT ЖE
  13,VTM,ШЛAГБAYM.CEMAФOP
  ,XTA,ANSWER.Y COCEДA
  ,U1A,BUSY. - ЗAHЯT
  ,XTA,ДHЗ. - CBOБOДEH
  13,AOX,
  13,ATX,
  ,UJ,RETDWN
C
  FRSEM:,XTA,ISLINK.ECTЬ CBЯЗЬ
  ,UZA,OCCSEM. - HET
  ,ARX,SAVS16.2-MAШ.CEMAФOP
  ,UZA,ENTRY. - ДA
  OCCSEM:,XTA,ДHЗ
  13,ATX,.CYГYБO CBOЙ
  RETDWN:,WTC,SAVI13
  13,VTM,
  ,WTC,SAVS16
  ,UJ,
C
C
  SEM UP:,ENTRY,
  :,24,2003B
  ,ATX,SAVS16
  ,ITA,13
  ,ATX,SR13
  ,XTA,SAVS16
  ,ASN,64+24
  ,ATI,13
  13,XTA,
  ,AEX,ДHЗ
  ,AAX,C77.БЫЛ "DWN"
  ,U1A,RETUP. - HET
  13,XTA,
  ,ASN,64+6
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  ,ATX,FREESEM
  ,XTA,
  13,ATX,
  ,XTA,YДABЛEHЫ
  13,UTM,-ШЛAГБAYM-SEM212
  13,VIM,NO212
  ,AOX,MRDSCAL
  ,ATX,MRDSCAL
  ,XTA,
  NO212:,ATX,YДABЛEHЫ
  13,UTM,SEM212
  ,XTA,NSEM
  13,AAX,B48
  ,UZA,RETUP
  ,ITA,13
  ,AOX,B19
  13,VJM,SEND
  RETUP:,WTC,SR13
  13,VTM,
  ,WTC,SAVS16
   ,UJ,
  SPECDWN:,Z00,
  2,Z04,-ШЛAГБAYM
C
C
C---  BXOД ИЗ БЛOKA PEAKЦИИ HA ПPEPЫBAHИE
C     ПPИEM COOБЩEHИЯ OT 24 P.   П P П.
C     ПOCЫЛKA, ECЛИ HAДO, OTBETA.
C
  OT COCEДA:,ENTRY,
  ,EXT,4153B.*****
  ,AAX,B23/1
  ,ATX,ISLINK.COOБЩEHИE
  ,ACX,B1
  ,AAX,B1
  ,U1A,PARITY.OШ.ЧETH.
  ,XTA,ISLINK
  ,AAX,=1777 7777
  ,ATX,ISLINK
  ,ASN,64+17
  ,ATI,14.TИП
  ,AAX,B5
  14,UZA,SW/SEND.ПOCЫЛKA
  13,VTM,RETURN
  ,XTA,SEM.BCTPEЧHЫЙ
  ,AAX,C77.ЗAПPOC
  14,UZA,SW/QUEST-16. - HET
C
C...   ПPOCИM ПOBTOPИTЬ ЗAПPOC
C
  OTLUP:,XTA,B24."ЧETHAЯ"
  13,VJM,SEND*.ПOCЫЛKA
  :,XTA,
  ,UTC,REPEAT-EXIT
C
C...   ПOCЫЛKA C  T=00.  I = <OTBET>.
C      AHAЛИЗ OTBETA HA HAШ ЗAПPOC
C
  ANAL:13,VTM,EXIT
  ,ATX,ANSWER
  ,ITA,13
  ,ATX,AN/SW
  ,XTA,SEM
  ,ASN,64-15.CHИMAEM
  13,VTM,NEWTA.TAЙMEP
  ,UJ,DELTIMER
  PARITY:,XTA,ISLINK
 ,AAX,B23/1
  ,UZA,OTLUP+1.CEБE-ПOBTOP
  ,AAX,B22
  ,U1A,OTLUP.OБOИM - ПOBTOP
  ,UJ,RETURN.ПPOИГHOPИPYEM
C    ===========================
C---   ПEPEKЛЮЧATEЛЬ ЗAПPOCOB :
C    ===========================
  SW/QUEST:,BSS,
  :15,VTM,-LFAT1
  ,UJ,Q/DISK
  :,UJ,Q/SEM
 :,UJ,YES.P E З E P B
 :14,VTM,-NPC2
  ,UJ,Q/PASS.T=23B
  :,XTA,B1.T=24 - ЗAПPOC:
  ,UJ,SEND."ЖИB ЛИ COCEД"
C ..................................
C    ДAЛEE EЩE 11 PEЗEPBHЫX ПOЗИЦИЙ
C ..................................
C
C
C    ===========================
C---   ПEPEKЛЮЧATEЛЬ ПOCЫЛOK :
C    ===========================
  SW/SEND:,BSS,
  :,XTA,ISLINK
  ,UJ,ANAL.OTBET
  :13,VTM,SCCLTA
  ,UJ,PUSH
  :,UJ,OP/SEM
C .....................................
C    ДAЛEE EЩE 13 PEЗEPBHЫX ПOЗИЦИЙ
C .....................................
C
C
C
C   ********* ЗAПPOCЫ **********
C
C
C...   ЗAПPOC C T=20B
C      ЗAXBAT ФAЙЛA ИЛИ ПAKETA
C    17-14 : HOMEP MOДYЛЯ-30B
C      13  : "1", ECЛИ ЗAПИCЬ ИЛИ MOHOПOЛИЯ
C    12-1  : HAЧ.ЗOHA ФAЙЛA ИЛИ 7777
C
  Q/DISK:,XTA,ISLINK
 ,AAX,B17
 :,UZA,*+1
 ,UTC,1
 :,XTA,B 34
 ,AAX,*ПДИCK
 ,UZA,YES
  ,XTA,ISLINK
  ,ASN,64+13
  ,AAX,C17.HOMEP
  ,ATI,14.MOДYЛЯ
C
C---    ECЛИ Y HAC MOHOПOЛИЯ HA ПAKET -
C        OTBETИM OTKAЗOM
  ,XTA,MONO
  14,AAX,B16
  ,U1A,NO
  ,XTA,ISLINK
  ,AAX,C7777
  ,AEX,C7777
  ,U1A,Q/FILE
C
C---   ECЛИ Y HAC ПAKET ЗAHЯT, A COCEД
C     ЖAЖДET MOHOПOЛИИ - OTKAЖEM.
C
  ,XTA,ISLINK
  ,AAX,B13
  ,UZA,YES
  ,XTA,MONO
  14,AAX,B48
  ,U1A,NO
  ,UJ,YES
C
C---   AHAЛИЗ ФAЙЛOBOЙ TAБЛИЦЫ
C
  Q/FILE:,XTA,= 0000 7740 7777 0000
  ,ATX,MACKA
  ,XTA,ISLINK
  ,ARX,B18.+30 K
  ,ARX,B17.HOMEPY MOДYЛЯ
  ,ASN,64-29
  ,AUX,MACKA
  ,ATX,OБPAЗ
  ,AAX,B30
  ,AEX,MACKA
  ,ATX,MACKA
  ,XTA,B30
  ,AOX,OБPAЗ
  ,ATX,OБPAЗ
 Q/F1:15,XTA,FATA+LFAT1
  ,AEX,OБPAЗ
  ,AAX,MACKA
  ,UZA,Q/F2
  15,VLM,Q/F1
  ,UJ,YES
 Q/F2:15,XTA,FATA+LFAT1
  ,AAX,MASK12
  ,U1A,NO.ЛИЧH.ФAЙЛ
C
C...   ПOИCK ПO TAБЛИЦE MOДEЛEЙ
C
  14,VTM,-15
  Q/F3:14,XTA,T1+15
  ,AAX,MASK12
  ,U1A,Q/F5
 Q/F4:14,VLM,Q/F3
  ,UJ,YES
  Q/F5:15,UTM,LFATA
  ,ITA,15
  15,UTM,-LFATA
  14,AEX,T2+15
  ,AAX,C77777
  ,U1A,Q/F4
C
C---   ПOCЫЛKA OTBETA
C
  NO:,UTC,B1
  YES:,XTA,
  ,UJ,SEND
C
C...   ЗAПPOC C  T=21B :
C      ЗAПPOC KPИT.ИHTEPBAЛA.
C      1-15 : HOMEP CEMAФOPA
C
  Q/SEM:,WTC,ISLINK
  ,XTA,ШЛAГБAYM
  ,AAX,C77
  ,UJ,SEND
C
C...   ЗAПPOC C  T=23B  (MYЛЬTИTAЙП)
C      CBOБOДEH ЛИ PASS, HOMEP KOTOPOГO
C      ЗAДAH B 1:10 PAЗPЯДAX.
C
 Q/PASS:14,XTA,CIN+NPC1
 ,ATI,15
 15,VZM,L/PASS
 15,XTA,XNT
 ,ASN,64+20
  ,AEX,ISLINK
  ,AAX,C1777
  ,UZA,NO
 L/PASS:14,VLM,Q/PASS
  ,UJ,YES
C
C
C
C   ********** ПOCЫЛKИ *************
C
C
C...   ПOCЫЛKA C  T=01 .
C      Y COCEДA OCBOБOДИЛИCЬ PECYPCЫ.
C        OПEPAЦИЯ "OPENWAIT".
C        I - HECYЩECTBEHHO
C
  PUSH:13,XTA,
  ,UJ,OPEN
C
C...   ПOCЫЛKA C  T=02 :
C      OCBOБOДИЛCЯ KPИT.ИHTEPBAЛ
C      1-15 : HOMEP CEMAФOPA
C
  OP/SEM:,WTC,ISLINK
  13,VTM,ШЛAГБAYM
  13,XTA,
  ,ASN,64+6
  OPEN:,BSS,
  ,ATX,FREESEM
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  ,XTA,
  13,ATX,
  ,UJ,RETURN
C
C
C
  SND ONLY:,XTA,SAVS16
C
C...   БЛOK ПOCЫЛKИ COOБЩEHИЯ
C
  SEND:,AAX,B23/1
  ,ATX,MESS
  ,ACX,B1
  ,ASN,64-22
  ,AEX,MESS
  ,AOX,B24
  SEND*:,BSS,
  ,EXT,153B
  ,AAX,B23/1
  ,EXT,153B
  13,UJ,
C
C-----------------------------
C
  TERP:,ISO,18HБЭCM-1 : OШ.ЧETH.''
  TERT:,ISO,18HБЭCM-1 MOЛЧИT.''''''''
  B23/1:,LOG,3777 7777
  TIME:,REAL,2.0
  ,END,
 KOHTPOЛЬ:,NAME,
C*********   OБPAБOTKA ПPEPЫBAHИЙ
C           ПO KOHTPOЛЮ
 *YCЫ:LC,BLOCK,ГYC
 ДHЗ:,LC,1
 SCALES:LC,BLOCK,(2),S1CLTA
 SMASAV:LC,BLOCK,SAVAC,(2),SAVI15,SAVI14,
 ,CONT,(1),SAVMIR
 WSD:,LC,1
 TPHYS:,LC,1
 TMATH:,EQU,30B
  * И П Д :LC,BLOCK,XNF,XNFM(4),XNC,XNCM(2)
  ,CONT,Ш/CЛYЖ,Ш/FULL
  NJ:,WEQ,XNF
  * И П K 1 :LC,BLOCK,NPRTJ
 FULWOR:,LC,1
 DISREG:,LC,1
 C2003:,LC,1
 C1777:,LC,1
 C177:,LC,1
 MNP:,EQU,C177
 C77:,LC,1
 C37:,LC,1
 C14:,LC,1.
 C7:,LC,1
 STATIST:,SUBP,
 RETURN:,SUBP,
 TELOUT:,SUBP,
  *10:,BLOCK,KOHTPЧИC,KOHTPKOM,T/CБOЙ
 ERRPRI:,SUBP,
 *NRP1:,PC,
 ENDRES*1:,EQU,*NRP1-1
 *700:B,BLOCK,B48(8),B40(16),B24(15)
 ,CONT,B9(2)
 ,CONT,B7(3),B4,B3(2),B1
  BITS   :,EQU,677B
  BREP   :,EQU,677B
  BKK/KЧ :,EQU,677B
 EXCH BIT:,EQU,B7
 FIX BIT:,EQU,B1
 B32K:,EQU,B48
 B64K:,EQU,B48+1
 B64K/8K:,EQU,B48+2
 ,WTC,ДHЗ.
 13,VTM,.HOMEP ЗAДAЧИ
 ,XTA,ГYC.
 ,ASN,64+15.ПPИЗHAK: OHA
 ,ATI,15.ДИCПETЧEPCKAЯ
 14,V1M,KOHTP. - KOHTP. KOM
 ,XTA,SAVMIR.HOMEP БPЗ/MOЗY
 ,AAX,C7.
 ,ATX,WSD.
 ,XTA,SAVMIR.
 ,AAX,B4.
 ,U1A,KOHTP. - KЧ MOЗY
C.........   KOHTPOЛЬ ЧИCЛA - БPЗ
 ,XTA,WSD.TT-TEKCT
 ,ASN,64-24.'KЧ БPЗ-N'
 ,AOX,TTE1.
 14,VTM,T KЧБPЗ.
 14,ATX,1....
 ,XTA,WSD.
 ,ASN,64-15.
 KЧ/CTAT:,ARX,ИC KЧ.ПOXOД HA
 ,UJ,STATIST.CTATИCTИKY
 ИC KЧ:,Z05,
 ,Z00,KЧ/TT
 KЧ/TT:,ITA,14.
 14,CALL,TELOUT.TT-ПEЧATЬ
 15,V1M,MATJ.KЧ-HE ДИCП.
 ,XTA,FULLBLOK.БЛOKИPOBKA ПOЧTИ
 ,ATX,S1CLTA.BCEX ЗAДAЧ
 14,VTM,T KOHTP.
 ,ITA,14.TT-ПEЧATЬ
 14,CALL,TELOUT.'ЧИHИ MOЗY'
 :,24,3.
 ,UJ,*.
 MATJ:14,VTM,KOHTPЧИC.
 ,XTA,B1.
C.........   COOБЩEHИE ЗAДAЧE HA AЦПY
 KOHAЦПY:,ATX,WSD.
 13,XTA,B REP.ГAШEHИE ПPИЗH.
 ,AEX,FULWOR.KOHTPOЛЬ-ПPOB.
 ,AAX,CON SC.
 ,ATX,CON SC....
 ,XTA,WSD.
 ,U1A,OШMAШИHЫ.OШИБKA MOЗY
 ,UJ,ERRPRI.OШИБKA MATEM.
  OШMAШИHЫ:14,VTM,T/CБOЙ
  ,UJ,ERRPRI
C.........   KOHTPOЛЬ KOMAHДЫ / KЧ MOЗY
 KOHTP:,XTA,CON SC.ПPOБA: KOHTPOЛЬ
 13,AAX,B REP.HA ПPOBEPKE
 ,U1A,П KOHTP. - ДA
 ,XTA,CON SC.YCTAHOBKA
 13,AOX,B REP.ПPИЗHAKOB
  ,ATX,CONSC
  ,XTA,SCKK/KЧ
 13,AOX,B KK/KЧ.ПPOBEPKA , KK/KЧ
 14,V1M,KOH 1.
 13,AEX,B KK/KЧ.
  KOH1:,ATX,SCKK/KЧ
 ,XTA,C2003.
 ,ATI,21B.
 15,VZM,KOHДИC.
 14,VIM,KOHKOM.
 ,UJ,KOHЧИC.
C.........   ПOИCK ПЛOXOГO ЧИCЛA B ДИCПETЧEPE
 KOHДИC:,BSS,.
 15,VTM,1-2.
 14,VTM,100B.ПPOBEPKA 1-Й
 13,VTM,100B-ENDRES*1.OБЛACTИ
 KOH Д:14,XTA,.
 ,ATI,.
 14,UTM,1.
 13,VLM,KOH Д.
 14,VTM,70000B.ПPOBEPKA 2-Й
 13,VTM,-7777B.OБЛACTИ
 15,VLM,KOH Д.
 ,XTA,WSD.MOЗY-Д - O'KEY
 ПOДГ TKЧ:14,VTM,T KЧMOЗY+2
 12,VJM,OШAДP
 14,UTM,-2
 15,VZM,KЧ/TT.ДИCП. KOHTPOЛЬ
 ,XTA,WSD.
  ,AUX,=:00077777 007
 ,AOX,B40.K ПOXOДY HA
 ,UJ,KЧ/CTAT.CTATИCTИKY
C.........   KOHTPOЛЬ KOMAHДЫ
 KOHKOM:,ITA,33B.
 ,ATI,14.
 ,ITA,27B.
 ,AAX,B9.
 ,U1A,KOKO0.AДPECA
 14,UTM,-1.KOMAHДЫ
 KOKO0:,ITA,27B.
 ,AAX,C14.
 ,U1A,KOKO1. - ФИЗИЧECKИЙ
      ,24,2000B.
 KOKO1:14,XTA,.KOMAHДY
 ,ATI,.
   :   ,24,2003B.
 ,ATX,SAVAC.MATEMATИKY
 ,ITA,14.AДPEC K-ДЫ
 ,ATI,33B.MATEMATИKY
 ,XTA,.OШИБKA MATEMATИKA
 14,VTM,KOHTPKOM.
 ,UJ,KOHAЦПY.
C.........   KOHTPOЛЬ ЧИCЛA - MOЗY
  KOHЧИC:,BSS,
 ,XTA,WSD.
 ,ATI,15.
  ,XTA,Ш/CЛYЖ
  13,AAX,BITS
  13,VTM,1-32
  ,U1A,ПPO Л
 ,WTC,ДHЗ.
 ,XTA,NPRTJ-NJ.MAKCИM.
 ,ATX,OLDPRT.ПPИOPИTET
  ,XTA,.ЗAДAЧE
 ,WTC,ДHЗ.
 ,ATX,NPRTJ-NJ....
 ПPO Л:,24,2003B.
 ,WTC,ГYC.
 13,XTA,TMATH+31.MAT. ЛИCT
 ,ASN,64+30.ЗAHИMAET
 ,AAX,MNP.ФИЗИЧECKИЙ
 ,UZA,CЛEД Л. - HET
 ,ATI,12.
 12,XTA,TPHYS.
 ,AAX,EXCH BIT.OH B OБMEHE
 ,U1A,CЛEД Л. - ДA
 12,XTA,TPHYS.ФИKCAЦИЯ
 ,AOX,FIXBIT.ЭTOГO
 12,ATX,TPHYS.ЛИCTA
 ,ITA,13.
 ,ARX,C37.ПOЛYЧEHИE
 ,ASN,64-10.MAT. AДPECA 1-ГO
 ,ATI,14.KOHTPOЛ. CЛOBA
 15,J+M,14.
  :,24,.ЦИKЛ
  11,VTM,1-128.ПPOBEPKИ
 ПPO KЧ:14,XTA,.OДHOГO
 ,ATI,.MOЗY
 14,UTM,10B.
 11,VLM,ПPO KЧ.
   :   ,24,2003B.ПPOБЫ:
 ,ITA,14.MOЖHO ЛИ
 ,ASN,64+11.PACФИKCИPOBATЬ
 ,UZA,CЛEД Л. - HET
 12,UTM,-34B.
 12,VZM,CЛEД Л. - HET
 12,XTA,TPHYS+34B.....
 ,AEX,FIXBIT.PACФИKCAЦИЯ
 12,ATX,TPHYS+34B....
 CЛEД Л:,24,3.HA
 ,ATI,.ПPOBEPKY
 13,VLM,ПPO Л.CЛEД. ЛИCTA
   :   ,24,2003B.
  ,XTA,Ш/CЛYЖ
  ,WTC, Д H З
  ,AAX,BITS
  ,U1A,HA ПEЧ
 ,XTA,OLDPRT.BOCCTAHOBЛEHИE
 ,WTC,ДHЗ.ПPИOPИTETA
 ,ATX,NPRTJ-NJ.ЗAДAЧИ
 HA ПEЧ:,ITA,15.
 15,VTM,1
 ,UJ,ПOДГ TKЧ.
C.........   KOHTPOЛЬ ЧИCЛA ПPИ ПPOBEPKE
 П KOHTP:15,VZM,П KOHДИC.ДИCП. KOHTPOЛЬ
 ,XTA,SAVI14.
 ,ATI,33B.
  ,XTA,SCKK/KЧ
  13,AAX,BITS
 ,U1A,П KOHKOM.KOHTP. K-ДЫ
C.........   HAШЛИ ПЛOXOE ЧИCЛO ПPИ KЧ
 ,ITA,12.
 ,ASN,64-10.ПOЛYЧEHИE
 ,ATX,WSD.ФИЗИЧECKOГO
 ,XTA,SAVI14.AДPECA
 ,AAX,C1777.ЧИCЛA
 ,AOX,WSD....
 ,UJ,ПOДГ TKЧ.
C.........   KOHTPOЛЬ ПPИ ПPOBEPKE ДИCПETЧEPA
 П KOHДИC:,XTA,SAVI14.ФИЗ. AДPEC
 ,UJ,ПOДГ TKЧ.
C.........   KOHTPOЛЬ ПPИ ПPOBEPKE KK
 П KOHKOM:,ITA,27B.ПPOБA: K-ДA
 ,AAX,B1.C ФИЗ. AДP.
 ,U1A,ПKK2. - ДA
 ,XTA,SAVI14.
 ,ASN,64+10.ПOЛYЧEHИE
 ,ATI,14.ФИЗИЧECKOГO
 ,XTA,SAVI14.AДPECA
 ,AAX,C1777.KOM-ДЫ
 ,ATX,WSD.
 ,WTC,ГYC.
 14,XTA,TMATH.
 ,ASN,64+20.
 ,AAX,B17/11.
 ,AOX,WSD....
 ПKK1:14,VTM,T KK+1
 12,VJM,OШAДP
 14,UTM,-1
 ,XTA,WSD.
  ,AUX,=:00077777 007
 ,AOX,ИC KK.И ПOXOД HA
 ,UJ,STATIST.CTATИCTИKY
 ИC KK:,Z07,.
 ,Z00,KK/TT.
 KK/TT:,ITA,14.
 14,CALL,TELOUT.TT-ПEЧATЬ
 14,VTM,KOHTPKOM.
 ,XTA,B1.HA ПEЧATЬ
 ,UJ,KOHAЦПY.HA AЦПY
 ПKK2:,XTA,SAVI14.
 ,UJ,ПKK1.
C.........   BЫЧИCЛ. AДPECA CБOЯ
 OШAДP:,BSS,
 ,ASN,64-30
 ,ATX,WSD
 ,AUX,UPM1. B KYБE.
 ,AOX,TTE2
 14,ATX,
 12,UJ,
 T KЧБPЗ:,ISO,12H'12'KЧ БPЗ-0'12'''
 TTE1:,ISO,6HЗ-0'12'''
 T KOHTP:,ISO,12H'12'ЧИHИ MOЗY'12'''
 T KЧMOЗY:,ISO,12H'12'KЧ MOЗY,A='1'
 ,CONT,6H000000
 ,GOST,6H+00000
 T KK:,ISO,6H'12'KK A=
 ,CONT,6H000000
 ,GOST,6H+00000
 UPM1:,GOST,6H777777
 TTE2:,ISO,6H000000
 FULLBLOK:,OCT,0015 7777 77
 B17/11:,LOG,376000
 OLDPRT:,BSS,1
  SCKK/KЧ:,LOG,
  CONSC  :,LOG,
 ,END,
 IC1/2:,NAME,.
  *677:B,BLOCK,BITS,BIT48,BIT47,BIT46
  ,CONT,BIT45,BIT44,BIT43,BIT42,BIT41
  ,CONT,BIT40,BIT39,BIT38,BIT37,BIT36
  ,CONT,BIT35,BIT34,BIT33,BIT32,BIT31
  ,CONT,BIT30,BIT29,BIT28,BIT27,BIT26
  ,CONT,BIT25,BIT24,BIT23,BIT22,BIT21
  ,CONT,BIT20,BIT19,BIT18,BIT17,BIT16
  ,CONT,BIT15,BIT14,BIT13,BIT12,BIT11
  ,CONT,BIT10,BIT9, BIT8, BIT7, BIT6
  ,CONT,BIT5, BIT4, BIT3, BIT2, BIT1
 OШM/T:,EQU,BIT36
 KO/T:,EQU,BIT27
 BITTRA:,EQU,BIT27.
 O Ш M:,EQU,BIT8.
 *YCЫ:LC,BLOCK,(1),RDSCAL,COMMIR
 NEWTA:,SUBP,.
 RETURN:,SUBP,.
 TRAINT:,SUBP,
 BUFTRA:LC,BLOCK,(1),IFTRA(36)
 IFS33:,EQU,3.
 TRABUS:,LC,1.
  FREESEM:LC,BLOCK,(1),MSELECT
  COPYTR1 :,LC,1
  NFRITR:,LC,1
  TABDRU:,LC,1
  FULWOR:,LC,1
  TDR27 :,EQU,TABDRU+27B
  B16/1   :,LC,1
  DISINT:,SUBP,
  SCDICH:,SUBP,
  CLOMIR:,SUBP,
  *ПДИCK:,SUBP,
  TYPEMT:,SUBP,
  REWINDSC:LC,BLOCK,(3),BOSS(4)
  TRAMASK:LC,BLOCK,(1),FINZON
  TIMERS:LC,BLOCK,TMБ(2),TMД(2),TMЛ(4)
  C377:,LC,1
  C7  :,LC,1
  BC1700  :,SUBP,
  TTPRINT :,SUBP,
  STATUSMT:LC,BLOCK,(5),NEW(10),ДBECA(4)
  TASKSTRA:LC,BLOCK,TBUC(12),SCMOV(6)
  TABLE MT:LC,BLOCK,(16),T1MT(32),(16),T2MT
C
C*****   KOHEЦ OБMEHA C MБ
 ,EXT,4035B.
 14,APX,OШM
 ,AUX,OШM/T
  ,ATX,SCAL
  ,UJ,DRUM
  KO MБ :14,XTA,BIT23.ИMИTAЦИЯ
  ,EXT,31B.ПPEP.B ГPП
  ,XTA,KO/T
  ,ATX,SCAL
  DRUM:,BSS,
   ,XTA,.CБPOC TAЙMEPA
 14,ATX,TMБ-1
 14,XTA,BIT47
 ,CALL,CLOMIR
 14,XTA,TBUC-1
 ,AAX,CLM
 ,AOX,SCAL
 14,ATX,TBUC-1
  14,XTA,BITS.ЗAПYCK
  15,VJM,GIVTRA.ЗAД.OБMEHA
   AFGVTR:,ENTRY,
C*** BXOД ДЛЯ ДИCKOBOГO ДPAЙBEPA
  AFGVTR:,U1A,RETURN.YЖE ECTЬ
  ,UJ,NEWTA
 IC3/6:,ENTRY,
C
C*****   ПPEPЫBAHИE : ПPOXOД ЗOHЫ MЛ
C
  IC3/6:,BSS,
  15,VTM,AFGVTR
  14,XTA,BOSS-3
  ,ATI,13
  ,ARX,
  ,UZA,ПEPEXBAT
  ,XTA,*ПДИCK
  14,AAX,BITS
  ,ASN,64+10.ПPOГP.ДYБЛЬ
  ,AOX,FINZON.БИTOB ПPOXOДA
  ,ATX,FINZON.ЗOHЫ B ГPП.
C
C...   BXOД B TRAM70 ПO ЛEHTAM :
C      OБPAЩEHИE ПO И15
C      HA И14 Д.Б. HOMEP KBY-HAПPABЛEHИЯ
C
  TRA TAPE:,ENTRY,
  TRA TAPE:,24,2003B
  14,XTA,TYPEMT-3
  ,ASN,64+18
  ,ATX,SCAL
  ,WTC,SCAL.COПPЯЖEHHOE
  ,XTA,BIT47.HAПPABЛEHИE
  14,AOX,BIT47. И CBOE
  ,ATX,SCAL.B TRABUS
  ,ASN,64+8
  ,AEX,FULWOR.И ИЗ
  ,AAX,COMMIR.MACKИ
  ,ATX,COMMIR.ГPП
  ,MOD,36B
  ,XTA,SCAL
  GIVTRA:,ENTRY,
  GIVTRA:,BSS,
C****** ПOДПPOГPAMMA ЗAПYCKA TRAM70.
C       CYMMATOP - БИT ДЛЯ TRABUS.
C       И15 - BOЗBPAT.
C       HA BЫXOДE CYMMATOP = 0, ECЛИ
C       ЗAДAЧA OБMEHA HE БЫЛA YЖE
C       PAHEE ЗAПYЩEHA.
C
 ,ATX,SCAL
  ,XTA,TRABUS
  ,UZA,FREETRA
  ,AOX,SCAL
  ,ATX,TRABUS
  15,UJ,
  FREETRA:,XTA,SCAL
  ,ATX,TRABUS
C.....   ЗAДAЧA OБMEHA - CBOБOДHA
 ,XTA,ENTRA
 ,ATX,IFTRA+IFS33.
 ,XTA,RDSCAL.
 ,AOX,BITTRA.
 ,ATX,RDSCAL.
  ,ATX,MSELECT.ДЛЯ RETURN
  ,XTA,
  15,UJ,
  ПEPEXBAT:14,XTA,BIT39.ГAШEHИE ГPM
  ,UJ,CLOMIR.И YXOД ПO AДPECY
 ПPOB MБ:,ENTRY,.
C
C*****   PEAKЦИЯ HA T.P. 1
C
  ,XTA,1
  ,AEX,COPYTR1
  ,AAX,B16/1
  ,UZA,NODIV1
  ,ATX,SCAL
  15,VTM,1-16
C--
  CHDIVTR:15,AAX,BIT1
  ,UZA,NODIVTR
  ,AAX,1
  ,UZA,OPEND
C--  MБ ЗAKPЫЛИ HA T.P.1
  CLOSED:,BSS,
  15,UTM,TDR27
  15,XTA,-10B
  ,AAX,=7777 7777 7760 0000
  15,ATX,-10B
  ,ACX,
  ,ATI,14
  ,WTC,NFRITR
  14,UTM,-40B
  ,ITA,14
  ,UJ,CORNFR
C--  MБ OTKPЫЛИ HA T.P.1
  OPEND:15,UTM,27B
  ,ITA,15
  15,UTM,TABDRU
  15,AOX,-10B
  15,ATX,-10B
  ,AEX,FULWOR
  ,ASN,64+16
  ,ACX,NFRITR
  CORNFR:,ATX,NFRITR
  15,UTM,-TDR27
C--
  NODIVTR:,XTA,SCAL
  15,VLM,CHDIVTR
C--
  NODIV1:,XTA,1
  ,AAX,B16/1
  ,ATX,COPYTR1
C
C*****   TAЙMEP : KOHEЦ OБMEHA C MБ,MД,MЛ
C
  14,VTM,-7
  COUNT:14,XTA,TMБ+7
  ,UZA,ECOUNT
  ,ARX,B16/1
  ,AAX,B16/1
  14,UZA,EN TIM +7
  14,ATX,TMБ+7
  ECOUNT:14,VLM,COUNT
  13,UJ,
C
C...... ДOПYCTИMOE BPEMЯ OБMEHA
C              ИCTEKЛO
C
  EN TIM:,UTC,1-2
  :14,VTM,2
  ,UJ,KO MБ
  :,UTC,3-4
  :15,VTM,4
  ,UJ,KO MД
  :,UTC,3-4
  :,UTC,4-5
  :,UTC,5-6
 KO MЛ:14,VTM,6
  14,XTA,BOSS-3
  13,U1A,
  14,XTA,ДBECA-3
  14,AOX,SCMOV-1
  ,AAX,C377
  13,UZA,
  ,ANX,C7
  ,AAX,C7
  ,ATI,13
  ,AEX,C7
  14,ARX,BC1700
  ,ATI,15
  ,XTA,BIT12."KДB"
  15,AOX,T1MT-30B
  15,ATX,T1MT-30B
  ,XTA,BIT36."MГЗ"
  15,AOX,T2MT-30B
  15,ATX,T2MT-30B
  14,XTA,NEW-3.ПPИ HEГOTOBHOCTИ
  13,AAX,BIT16.ИMИTИPYEM
  ,U1A,IC3/6.ПPEPЫBAHИE
  ,XTA,BIT13.ECЛИ MФГOT - ДAEM
  15,EXT,50B.ПPOГPAMMHЫЙ
  ,UJ,RETURN.CБPOC CДB
 KO MД:,BSS,
   ,ITA,15
   ,AOX,=6H.KMД-0
  14,VTM,DTEX
  14,ATX,1
  ,ITA,14
  14,CALL,TTPRINT
  15,MTJ,14
  ,UJ,DISINT
 DTEX:,ISO,12HHET ПP.KMД-3
 ENTRA:,,
 ,Z00,TRAINT
 CLM:,LOG,7777 3773 7777 7777
  SCAL:,BSS,1
 ,END,.
 STARTJOB:,NAME,.
C
C=====   ЗAПYCK PAЗHOOБPAЗHЫX MAT.ЗAДA4
C
 'PEДAKЦИЯ OT 30.10.74' - (ЛИMИT БYMAГИ)
 'PEДAKЦИЯ  K 01.08.74'
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
 *YCЫ:LC,BLOCK,ГYC,RDSCAL
 *ИПД:LC,BLOCK,XNF,XNFM(3),XNW
 ,CONT,XNC,XNCM(2),Ш/CЛYЖ
  ,CONT,Ш/FULL
 SCALES:LC,BLOCK,PRTMASK
 NF:,WEQ,XNF
 NFM:,WEQ,XNFM
 NW:,WEQ,XNW
 NC:,WEQ,XNC
 NCM:,WEQ,XNCM
 NCЛY:,EQU,NC-NCM
 NLMJ:,EQU,NW-1
 Ш/ПOTOK:,EQU,XNF+12B
 *INCOGNI:,EQU,XNF+16B
 Ш/ДИCП:,EQU,XNF+23B
 ИHДДHЗ:,EQU,XNF+40B
 STARTCW:,EQU,XNF+45B
  SC/DEBUG:,EQU,XNF+71B
 *TYPELP:LC,BLOCK,(4),STLIM
 LIMITLP:,EQU,116B
 C1777:,LC,1
 C77777:,LC,1
 B16/1:,LC,1
 *ИПK:LC,BLOCK,*INFBA
 INFEX:,EQU,*INFBA+NCM
  AДP/ИПЗ:,EQU,INFEX+NCM
 *ИПK1:LC,BLOCK,
 MONO:,EQU,*ИПK1+NC
 PRTSTAT:,EQU,*ИПK1
 SELECT:,SUBP,.
 NEWTA:,SUBP,.
 TELOUT:,SUBP,.
 RETURN:,SUBP,.
 NEWTA*:,SUBP,
 C77:,LC,1
 ШЛAГБAYM:LC,BLOCK,(6),SCAL73
 DISPBASE:LC,BLOCK,(1),DISMBASE.
 NSTAJOB:LC,BLOCK,NSTJ
 FLMAMБ:,LC,1
 MШ:,LC,1
 C13:,LC,1.
  C3:,LC,1
 I:,EQU,15.
 J:,EQU,14.
 K:,EQU,13.
 M:,EQU,100B.
 REGSCAL:,EQU,M.
 B30/16:LC,BLOCK,MSHIFR.
 TMATH:,EQU,30B.
 TDEFENC:,EQU,40B.
 MAXTIME:,EQU,111B.
 C5:,LC,1
 *677:B,BLOCK,BITS,(43),BIT5,BIT4,BIT3,BIT2,BIT1
  DEB/JOBS:,EQU,564B.ШK.PAБOT OTЛAДЧИKA /ИПЗ/
 SAVESUBP:,EQU,645B.YTOЧHEHИE ИДEHTИФИKATOPA
  BIT44:,EQU,704B
 BIT21:,EQU,733B
 BIT16:,EQU,740B
 BIT11:,EQU,745B
 BIT7:,EQU,751B
 OWNBIT:,EQU,700B.
 *710:B,BLOCK,ЧTEHИE.
 PUTTMP:,SUBP,
 NRESCALL:,SUBP,.
 SIGNSAVE:,LC,1.ПPИЗHAK ЗAKAЗA HA BOCCTAHOBЛEHИE
 TARES:,SUBP,.ЗAДAЧA BOCCTAHOBЛEHИЯ
 HAЧБAPBO:,P/P,(TARES)(2000B)
 *NRPTAR:,P*P,(HAЧБAPBO)(2000B)
 HAЧBOCCT:,EQU,TARES-*NRPTAR
  NR/START:,SUBP,
 CLMTSP:,SUBP,.ЧИCTKA ДЛЯ MT
 STATIST:,SUBP,.
 *TLBUFOP:LC,BLOCK,(11),SCOP
  *112:B,BLOCK,A1,PULT,PASS,A2
  БПYCK:,EQU,=:0000 6.БEЗYCЛOBHO ПYCKATЬ
C*****
  J,VTM,NLMJ-1
  ,XTA,BITS+1.B48
  ,WTC,NSTAJOB
  ,ASN,64-1
  ,AAX,БПYCK
  ,U1A,MHOГOMБ
  ,XTA,FLMAMБ
  ,U1A,ЗAHЯTA
  MHOГOMБ:,BSS,
  ,XTA,NSTAJOB
  ,ATI,K
 ,UZA,L0.
 ,ARX,.
 ,UZA,L0.
C   ПЛAHИPOBЩИK И MYЛЬTИTAЙП ПPИ ЗAПYCKE ЗAДAЧ
C   ДOЛЖHЫ ЗAДABATЬ NSTAJOB=BIT47 ,
C   ПPИ ЭTOM ЗAДAЧИ HE БYДYT 'TEPЯTЬCЯ'
C   STARTJOB'OM ИЗ-ЗA ЗAHЯTOCTИ  SCAL73 .
 ,AEX,BITS+2.BIT47
 ,UZA,NO73.OT MT ИЛИ ПOTOK
 I,VTM,1-NCЛY
 J,VTM,NFM-1.ПOCЛEДHЯЯ CЛYЖEБHAЯ
 ,UJ,L1.
 L0:,BSS,.
 ,XTA,SCAL73
 ,UZA,NO73
 ,AAX,C77
 ,ATI,13
 13,XTA,BITS
 ,UJ,NEWTA*
 NO73:,BSS,
  ,XTA,MШ
  ,U1A,L1
  ,XTA,Ш/ПOTOK
  ,ASN,64+2.БEЗ Ш1
  ,UZA,ЗAHЯTA
  ,ACX,
  ,NTR,3
  ,X-A,BIT1
  ,ATI,I
  ,XTA,SIGNSAVE
  ,UZA,L1
  K,VTM,76000B.ROLLOUT
  ,ITA,K
  ,ATX,NSTJ
 ,XTA,
 ,ATX,SIGNSAVE
  I,UTM,-1
  J,UTM,1
 L1:,BSS,
 ,XTA,MШ
 ,UZA,L1C
 ,ATI,J
 I,VTM,
 ,XTA,
 ,ATX,MШ
 L1C:,BSS,
 J,XTA,*YCЫ
 ,UZA,ЗAHЯTA.
 ,AAX,MSHIFR.
 ,UZA,INITJOB.
 J,UTM,-1.
 I,VLM,L1C.
 ЗAHЯTA:,BSS,.
  14,VTM,RETURN
  K,UTM,-5
  K,VZM,CLMTSP.MULTITYP
 ,XTA,
 ,ATX,NSTAJOB
 ,ATX,SIGNSAVE
  ,XTA,MШ
  ,UZA,TELLBUZ
  ,ATI,I
  ,XTA,
  TELLBUZ:,ATX,MШ
  I,VTM,DRESURS
  ,ITA,I
  ,UJ,TELOUT
C--------------
  INITJOB:,NTR,3
  ,XTA,PRTMASK
  ,AOX,Ш/ДИCП
  J,AOX,BITS
  ,ATX,PRTMASK
 ,ITA,J
 ,X-A,XNW
 ,ASN,64-15
 J,AOX,*YCЫ
 J,ATX,*YCЫ
  ,ATI,I
 J,XTA,BITS
 ,AOX,STARTCW
 ,ATX,STARTCW.
 ,XTA,NSTJ
 ,APX,=40000000 00077777
 ,ASN,64+32
 J,AEX,MONO-NF
 ,AAX,B16/1
 J,AEX,MONO-NF
 J,ATX,MONO-NF
 ,XTA,RDSCAL
 J,AOX,BITS
 ,ATX,RDSCAL
  ,XTA,
  ,ATX,NSTJ
C... ДЛЯ MAT.ЗAДAЧ ИПЗ ГOTOBИT ПOДKAЧKA
  K,VTM,-127
  I,VIM,ZSIF
  J,ATX,AДP/ИПЗ-NFM.ЧИCTKA
  ,UJ,NEWTA.AДPECA ИПЗ
  ZSIF:I,UTC,-3
  K,ATX,127
  K,VLM,*-1
C...  B ИПЗ CЛYЖEБHOЙ ЗAДAЧE :
 ,XTA,SCOP
 ,AAX,C77777
  I,ATX,PASS.TEPMИHAЛA
 K,VTM,START.
 ,ITA,K.
 I,ATX,3.
 ,XTA,C13.
 I,ATX,5
  ,UJ,NEWTA
C-----   PAБOTA OT ИMEHИ ЗAДAЧИ
  START:,ENTRY,
  START:,BSS,
  ,XTA,INF
  ,UJ,NRESCALL
  INF:,Z00,NR/START
  ,Z00,13
 DRESURS:,BSS,.
 ,ISO,12HA Я ЗAHЯTA''''
 ,END,
  ПYCKAЧ:,NAME,
C
C=====  HEPEЗИДEHT STARTJOB-A
C
 'PEДAKЦИЯ OT 30.10.74' - (ЛИMИT БYMAГИ)
 'PEДAKЦИЯ  K 01.08.74'
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
 *YCЫ:LC,BLOCK,ГYC,RDSCAL
 *ИПД:LC,BLOCK,XNF,XNFM(3),XNW
 ,CONT,XNC,XNCM(2),Ш/CЛYЖ
  ,CONT,Ш/FULL
 SCALES:LC,BLOCK,PRTMASK,MRDSCAL
 NF:,WEQ,XNF
 NFM:,WEQ,XNFM
 NW:,WEQ,XNW
 NC:,WEQ,XNC
 NCM:,WEQ,XNCM
 NCЛY:,EQU,NC-NCM
 NLMJ:,EQU,NW-1
 Ш/ПOTOK:,EQU,XNF+12B
 *INCOGNI:,EQU,XNF+16B
 Ш/ДИCП:,EQU,XNF+23B
 XLSMB:,EQU,XNF+26B
 LISTFLAG:,EQU,XNF+35B
 C/BUF:,EQU,XNF+37B
 ИHДДHЗ:,EQU,XNF+40B
 STARTCW:,EQU,XNF+45B
 EXT SC:,EQU,XNF+63B
  SC/DEBUG:,EQU,XNF+71B
 *TYPELP:LC,BLOCK,(4),STLIM
 LIMITLP:,EQU,116B
 C77777:,LC,1
 B16/1:,LC,1
 *ИПK:LC,BLOCK,*INFBA
 INFEX:,EQU,*INFBA+NCM
 *ИПK1:LC,BLOCK,PRTSTAT
 MONO:,EQU,*ИПK1+NC
 SELECT:,SUBP,.
 NEWTA:,SUBP,.
 TELOUT:,SUBP,.
 RETURN:,SUBP,.
 NEWTA*:,SUBP,
  SMASAV:LC,BLOCK,SAVAC,SAVSR(5)
  YДABЛEHЫ:,LC,1
  FULWOR  :,LC,1
 C77:,LC,1
 ШЛAГБAYM:LC,BLOCK,(6),SCAL73
 DISPBASE:LC,BLOCK,(1),DISMBASE(5),NUMEVM
 NSTAJOB:LC,BLOCK,NSTJ
 FLMAMБ:,LC,1
 PLAN/IS:,LC,1.
 WHO/USER:,SUBP,
 AEROPLAN:,SUBP,
 ПPOOБMEH:,SUBP,.
 OCTOPOЖH:,SUBP,.
 MULTITYP:,SUBP,.
 PAЗHИЦA:,SUBP,.
  POГATKA:,SUBP,
  CЛYГA:,SUBP,
  DISPINIT:,SUBP,
  PUT PULT:,SUBP,
 SPECMON:,SUBP,.
 NOSPMON:,EQU,17B
 MШ:,LC,1
 C13:,LC,1.
 I:,EQU,15.
 J:,EQU,14.
 K:,EQU,13.
 M:,EQU,100B.
 REGSCAL:,EQU,M.
 B30/16:LC,BLOCK,MSHIFR.
 TMATH:,EQU,30B.
 TDEFENC:,EQU,40B.
 MAXTIME:,EQU,111B.
 SYSMD:,EQU,115B
  IDENT:,EQU,137B.Y ЗAПYCKAЮЩEГO
  TABLEMT:LC,BLOCK,(48),T2MT(48),TNAMT
 C5:,LC,1
 *677:B,BLOCK,BITS,(43),BIT5,BIT4,(3)
  DEB/JOBS:,EQU,564B.ШK.PAБOT OTЛAДЧИKA /ИПЗ/
 SAVESUBP:,EQU,645B.YTOЧHEHИE ИДEHTИФИKATOPA
C  ЯЧEЙKИ TИПA  P
 ИП PEД:,EQU,1000B
  *12:B,BLOCK,M/EXT,(4),LB,CNT(2),BT
  *31:B,BLOCK,TE,EBUF(2),LBUF
  BIT44:,EQU,704B
  BIT8 :,EQU,750B
 BIT21:,EQU,733B
 BIT16:,EQU,740B
 BIT7:,EQU,751B
 BIT1:,EQU,757B
 OWNBIT:,EQU,700B.
 *710:B,BLOCK,ЧTEHИE.
 PUTTMP:,SUBP,
  NR/START:,SUBP,
  NRESOFF :,SUBP,
 NRESCALL:,SUBP,.
 SIGNSAVE:,LC,1.ПPИЗHAK ЗAKAЗA HA BOCCTAHOBЛEHИE
 TARES:,SUBP,.ЗAДAЧA BOCCTAHOBЛEHИЯ
 HAЧБAPBO:,P/P,(TARES)(2000B)
 *NRPTAR:,P*P,(HAЧБAPBO)(2000B)
 HAЧBOCCT:,EQU,TARES-*NRPTAR
 CLMTSP:,SUBP,.ЧИCTKA ДЛЯ MT
 STATIST:,SUBP,.
C*****
  ***:K,REL,***
C*****
   :    ,24,3
  ,WTC, Г Y C
  I,VTM,
 ,XTA,=R300 000.
 I,ATX,MAXTIME
 ,XTA,STLIM
 I,ATX,LIMITLP
  J,VTM,-15
  SMS:J,XTA,TNAMT+15
  ,AEX,MONSYS
  ,UZA,SYSMOD
  J,VLM,SMS
  ,UJ,NOSYSDIS
C
C...  ФOPMИPOBAHИE SYSMD - ЯЧEЙKИ B ИПЗ
C     ЗAПYCKAEMOЙ ЗAДAЧИ.  PAЗPЯДЫ :
C    39:38 - MБ 21:22 ПEPEAДPECYЮTCЯ HA MД
C    27:13 - HOMEP ФAЙЛA ПO TAБЛИЦE ФAЙЛOB
C    12:1  - HOMEP HAЧAЛЬHOЙ ЗOHЫ MБ 21
C
  SYSMOD:,XTA,2
  ,AAX,=:003
  ,ASN,64+2
  I,ATX,SYSMD
  J,XTA,T2MT+15
  ,AAX,C77777
  ,ASN,64-12
  I,AOX,SYSMD
  I,ATX,SYSMD
  NOSYSDIS:,BSS,
 ,XTA,OWNBIT.
 I,ATX,TMATH
 I,ATX,TMATH+1
  J,VTM,-7
C..  ЗAKAЗ  8 ФOPMAЛЬHЫX ЛИCTOB
  ZFL:I,UTC,TMATH+40B
  J,ATX,7
  J,VLM,ZFL
   :   ,24,2003B
 ,XTA,ДHЗ
 ,ATI,J
 ,XTA,Ш/CЛYЖ
 ,AAX,BITJ
 ,U1A,CЛYЖ
  ,XTA,NUMEVM
  ,AAX,=:6
  ,ASN,64+1
  J,AOX,*INFBA-NFM
  J,ATX,*INFBA-NFM
  ,AAX,=7700 0000
  :,U1A,*+1
  ,XTA,BIT21
  :J,AOX,*INFBA-NFM
   J,ATX,*INFBA-NFM
  ,XTA,C/BUF
 ,AEX,LISTFLAG
 ,AAX,BITJ
 ,AEX,LISTFLAG
 ,ATX,LISTFLAG
C
C  ФOPMИPYEM HAЧ.COCTOЯHИE ИПЗ PEДAKTИPOBAHИЯ
C
 1,VTM,10-1023
 ,ITA,1
 I,MTJ,1
 1,UTM,ИП PEД
 1,ATX,CNT
 ,XTA,XLSMB.ДЛЯ ЗAПИCИ:
 1,ATX,LB.ДЛИHA CBOБ.MECTA
 ,AEX,C77777
 ,ARX,BIT1
 1,ATX,LBUF.ЦИKЛ M.БYФEPA
 1,UTM,140B
 ,ITA,1.ДЛЯ CБPOCA:
 1,ATX,BT-140B.HAЧAЛO ДAHHЫX B M.БYФ
 1,ATX,TE-140B.KOHEЦ ДAHHЫX
  1,ARX,LB-140B
 1,ATX,EBUF-140B.KOHEЦ M.БYФ
 ,XTA,=:12.ПPИЗHAK ГЛOБAЛЬHOCTИ
 I,ATX,SAVESUBP.ДЛЯ OTЛAДЧИKA
 ,XTA,Ш/ПOTOK
 ,APX,BITJ
 ,ASN,64+23
 ,AOX,CTCT
  ,ATX,WS1
  ,ITA,K
  ,ARX,WS1
 ,UJ,STATIST
 CTCT:0,,
  ,Z05,CЛYЖ-***
 CЛYЖ:,BSS,
  J,WTC,MONO-NF
  1,VTM,-5
  ,XTA,C77
  J,AAX,PRTSTAT-NF
  J,ATX,PRTSTAT-NF
  1,VZM,MTSTART
  ,XTA,ZBITJ
  ,AAX,PRTMASK
  ,ATX,PRTMASK
  MTSTART:,24,3
 J,XTA,MONO-NF
 ,AAX,BIT16
 ,UZA,БEЗПACП
 ,XTA,OWND
 J,VTM,-3.
 :I,UTC,.
 J,ATX,TDEFENC+3.
 J,VLM,*-1.
   :   ,24,2003B.
  ,XTA,ZBITJ
  ,AAX,STARTCW
  ,ATX,STARTCW
 ,XTA,BIT4
 ,AOX,BIT44.ПPOTЯЖKИ B HAЧ.ЛИCTA
 I,ATX,REGSCAL.
  ,XTA,INF73
  ,UJ,NRESOFF
  INF73:,Z00,NR/START
  ,Z00,573B
 БEЗПACП:,BSS,.
 ,XTA,OWNBIT.
 J,VTM,-35B
 :I,UTC,.
 J,ATX,TMATH+35B
 J,VLM,*-1.
  I,ATX,TMATH+37B.OБM.ЛИCT=37
 ,XTA,OWNDEF.
 J,VTM,-3.
 :I,UTC,.
 J,ATX,TDEFENC+3.
 J,VLM,*-1.
  ,XTA,Ш/CЛYЖ
  ,APX,BITJ
  ,AUX,BIT16
  ,AOX,=7300 0000 0000 0010
 I,ATX,REGSCAL.
 ,XTA,BIT5
 I,ATX,M+1.
  K,MTJ,6
 14,VJM,PUTTMP.
   :    ,24,3
  6,MTJ,K
  1,UTM,5-10B
  1,VIM,NO PLAN
  ,XTA,ДHЗ
  ,ATX,PLAN/IS
  NO PLAN:1,UTM,10B-76000B.ROLLOUT
 1,VZM,TOTARES
  1,UTM,76000B
 1,V1M,TONSJOB
 ,XTA,INFMON.
 3,VTM,100B
 TOJOB1:,BSS,.
  15,VTM,-11
  14,VTM,2013B
  14,MTJ,27B
  ,DRUM,.CYMMATOPHЫЙ Э70
   :   ,24,2003B.
  ,ITA,K
  ,ARX,REFUS
  ,UJ,NRESOFF
  REFUS:,Z00,NR/START
  ,Z00,ZERO-***
  ZERO:,BSS,
 3,MTJ,33B
 ,XTA,
  RZER:15,ATI,12
  15,VLM,RZER
  14,VTM,-5
  CLS:14,ATX,SAVAC+5
  14,VLM,CLS
  ,ATI,27B
C
C...   A ЧTO, ECЛИ ГACИTЬ ЭTO ПOCЛE INPUTCAL ??
C
  ,XTA,ZBITJ
  ,AAX,STARTCW
  ,ATX,STARTCW
  ,WTC,ДHЗ
  ,XTA,MONO-NF
  ,ATI,3.ДЛЯ ЗAДAЧИ
  ,ASN,64+16
  ,ATI,14.KTO ЗAПYCTИЛ
  ,NTR,7
  ,RTE,7777B
  ,ATX,SAVSR
  ,XTA,YДABЛEHЫ
  ,AAX,BITJ
  ,AEX,FULWOR
  ,AAX,MRDSCAL
  14,AOX,BITS
  ,ATX,MRDSCAL
  ,XTA,
  ,WTC,ДHЗ
  ,ATX,MONO-NF
  14,VZM,NEWTA
  14,WTC,*YCЫ
  ,XTA,IDENT
  ,WTC,ГYC
  ,ATX,80.NAME ЗAДAЧИ
  ,UJ,NEWTA
 TONSJOB:,BSS,.
 ,NTR,3
 ,ITA,1
  3,VTM,SPECMON
  ,ASN,64+4.>17
  ,U1A,NO NAME
  1,XTA,BITS
  ,APX,SCJOBS
  ,UZA,NO NAME. - B БCЗ !
  ,ANX,
  ,ATI,3
  3,XTA,TABLJOBS-1
  ,ATI,3
  ,ASN,64+24
  ,ATI,4
  4,VZM,NONAME
  K,J+M,4
 ,WTC,ГYC
 2,VTM,
  4,XTA,
  2,ATX,80
  4,XTA,1
  2,ATX,81
  NONAME:,ITA,3
 ,ASN,64+10.
 ,ATX,WS1.
 ,ASN,64-30.
 ,AOX,WS1.
 ,ARX,DISMBASE.
 ,AOX,ЧTEHИE.
 ,UJ,TOJOB1.
 TOTARES:,BSS,
C.....   ЗAПYCK BOCCTAHOBЛEHИЯ ЗAДA4И
 ,XTA,INFFORRE
 ,ARX,DISMBASE
 3,VTM,HAЧBOCCT
 ,UJ,TOJOB1
 INFFORRE:,BSS,
 ,Z01,
 ,Z00,HAЧБAPBO
 TABLJOBS:,BSS,.
C---------
 :,,
 ,Z00,WHO/USER
  :,Z00,PERNAM-***
 ,Z00,ПPOOБMEH.
  :,Z00,PERNAM-***
 ,Z00,OCTOPOЖH.
  :,Z00,MLTNAM-***
 ,Z00,MULTITYP.
 :,,.
 ,Z00,PAЗHИЦA.
  :,Z00,
  ,Z00,POГATKA.7
  :,Z00,PL/NAME-***
  ,Z00,AEROPLAN.
  :,Z00,PRINTNAM-***
 ,Z00,SPECMON.11 (БCЗ!)
  :,Z00,SERVNAM-***
  ,Z00,CЛYГA.13
  :,Z00,INITNAM-***
  ,Z00,DISPINIT.15
  :,,
  ,Z00,PUT PULT.16
C---------
  SCJOBS:,OCT,57726.1,3-11,13,15,16
 OWND:,LOG,17 7400 0000
 OWNDEF:,OCT,40000017 74000000.
 INFMON:,OCT,40140000 00210201.
  WS1:,BSS,1
  SERVNAM:,ISO,12HHACTPOЙKA''''''
  PERNAM  :,ISO,12HПEPEПИCЬ''''''''
  MLTNAM  :,ISO,12HMYЛЬTИTAЙП''''
  INITNAM :,ISO,12HINITDISP''''''''
 PRINTNAM:,ISO,12HB Ы B O Д''''''
 PL/NAME:,ISO,12HПЛAHИPOBЩИK''
  MONSYS:,TEXT,8HMONSYS '11'
 ,BSS,
 ,END,
  POГATKA:,NAME,
C*
C****  YCTAHOBKA OПEPATOPOM ЧИCЛA
C*     CЧETHЫX KAHAЛOB ДЛЯ ПOTOKA,
C*     CBЯЗИ И MYЛЬTИTAЙПA.
C*
  *YCЫ:LC,BLOCK,ГYC
  *ИПД:,LC,1
  Ш/ПOTOK:,EQU,*ИПД+12B
  Ш/ПYCK:,EQU,*ИПД+13B
  Ш/CBЯ:,EQU,*ИПД+15B
  1,BASE,*
  ,*63,ГYC
  ,ASN,64+15
  ,ASN,64-40
  ,AOX,=6H'100'N ) П
  ,ATX,ADR+1
  2,VTM,-2
  5,VTM,
  7,VTM,QUEST
  ,*63,Ш/ПOTOK
  ,ATX,SCAL
  ,*63,Ш/ПYCK
  ,ATX,SCAL+2
  ,*63,Ш/CBЯ
  ,AEX,SCAL
  ,ATX,SCAL+1
  ,NTR,3
  ,UJ,LOOP
  ERR:2,XTA,MIN+2
  ,ASN,64-40
  ,AOX,=6H0 MAX=
  ,ATX,TMIN
  2,XTA,MAX+2
  ,ASN,64-40
  ,AOX,=6H0''''''''''
  ,ATX,TMAX
  14,VTM,TER
  ,ITA,14
  ,FUN,76B
  LOOP:2,XTA,NTYP+2
  ,ATX,TYP
  2,XTA,SCAL+2
  ,ACX,
  ,ASN,64-8
  ,AOX,=6HOKA=0''
  ,ATX,OLD
  ,ITA,7
  ,FUN,76B
  ,XTA,=1
  ,FUN,66B
  ,ASN,64+12
  ,AAX,=7
  ,ATI,3
  2,A-X,MIN+2
  ,U1A,ERR
  ,ITA,3
  2,X-A,MAX+2
  ,U1A,ERR
  3,J+M,5
  ,ATI,4
  2,XTA,MASK+2
  4,ASN,64
  2,AAX,MASK+2
  2,ATX,SCAL+2
  2,VLM,LOOP
C---
  ,*52,Ш/ПYCK
  ,XTA,SCAL
  ,*52,Ш/ПOTOK
  ,AOX,SCAL+1
  ,*52,Ш/CBЯ
C---
  14,VTM,ITOG
  ,ITA,14
  ,FUN,76B
  ,SJ,
  QUEST:,ISO,24HYKAЖИ ЧИCЛO ШИФPOB ДЛЯ
  TYP:,BSS,1
  ADR:,ISO,12H ( ...
  OLD:,ISO,6HПOKA=4
  NTYP:,ISO,18HCEБЯ: CBЯЗИ:TEPM.:
  TER:,ISO,12HOШИБKA: MIN=
  TMIN:,BSS,1
  TMAX:,BSS,1
  ITOG:,ISO,12HCOГЛACEH.''''''
  MIN:,LOG,0
  ,LOG,
  ,LOG,2
  MAX:,LOG,4
  ,LOG,3
  ,LOG,4
  MASK:,LOG,36
  ,LOG,340
  ,LOG,36 0000
  SCAL:,BSS,3
  ,END,
 SPECMON:,NAME,
 DLIBMT:,LC,2.BTOPOЙ PEЗИДEHT
  *113:B,BLOCK,PULT,PASS
  *YCЫ:LC,BLOCK,ГYC
 MN*TL:,EQU,1067B
C......   MOHИTOPHЫE COMMON'Ы.
 INFLOAD*:,LC,2
  MONITOR*:,SUBP,
  /VERE/:LC,BLOCK,(2)
  ,CONT,STALOA(0),M/STL,A/CAT,INF0
 RM*:,LC,5
 A/I0:,LC,1
 A/MINUS:,LC,1
  *REGIM//:,LC,1
 BASE:,BSS,
 1,BASE,BASE
C====================================
 'ПPOBEPKA CПEЦИФИKИ ЗAДA4И
C---------
  ,FUN,70100B+PASS.N TT
  ,ASN,64-40
 ,AAX,=:016
  ,ATX,N*TT
 ,ITA,3
 ,AAX,=77
 ,AEX,=77
  ,UZA,SETDELTA
  ,ITA,3
  ,ASN,64-42
  ,AUX,=6H'''''''''7''7'
  ,AOX,=6HTASK00
  ,ATX,NAME
 14,VTM,NAME
 ,ITA,14
 ,FUN,64B.= ЗAПИCЬ NAME
C
C...   ЗAXBAT ЛEHTЫ C БCЗ :
C
  GT:13,VTM,66B
  ,*63,DLIBMT+1.ИMЯ
  ,U1A,*+1.ЗAДAHO
  ,XTA,LIBMT.CTAHДAPT
  :,*57,2050B
  ,UZA,STOP.HET MЛ
  ,AAX,=:3
  ,U1A,STOP.HEГOT/ЗAHЯT
  ,*65,DLIBMT
  ,AOX,/FIZIM
  ,FUN,112B
  ,*72,=:11 40 35 00 37 77
C
C...   ПPOБA HAЛИЧИЯ CTAT.ЗAГPYЗЧИKA
C      B KATAЛOГE БCЗ
C
  ,*70,=0010 3500 0066 0000
  ,XTA,73400B
  ,AEX,=6HSTALOA
  ,U1A,R/SYS.-HET
  4,VTM,-1023
  :4,XTA,73777B.ПEPEПИCЬ
  4,ATX,-1.KATAЛOГA HA
  4,VLM,*-1.OБM.ЛИCT
  ,UJ,R/SYS+1.OБXOД ЧT.ЗAГP.
  R/SYS:,BSS,
  ,*70,INFLOA.ПOCAДKA
                           'ЗAГPYЗЧИKA'
C---------OФOPMЛEHИE MOHИTOPHЫX CBЯЗEЙ
 ,XTA,ALOAD
 ,ATX,INFLOAD*
 ,ATX,RM*+2
 ,ATI,15
 ,XTA,=1100
 ,ATX,17B.MECTO PAЗДEЛA
  ,XTA,
  ,ATX,*REGIM//
 ,XTA,=76000.
 ,ATX,43B.ЛИCT OБMEHA
 ,XTA,=I0
 ,ATX,A/I0
 ,XTA,=:002
 ,ATX,A/MINUS
 ,XTA,STOP
 ,CTX,20B
 'ПOДПPABKA ЗAГPYЗЧИKA'
 CHLOAD:,BSS,
  ,XTA,/FIZIM
  ,ATX,M/STL
  ,ATX,A/CAT
  ,ATX,INF0
C=========================================
 'OФOPMЛEHИE ИMEHИ PAЗДEЛA=CЛ.ЗAДAЧИ'
C---------
 ,ITA,3.ИMЯ ИЗ 3 И.P.
 ,ASN,64+6
 ,ATX,INFORTA.ИHФ ДЛЯ ЗAДA4И
 ,YTA,
 ,AUX,TMASK.ПPEOБP. B TEXT
 ,ARX,STAND.OФOPMЛEHИE
 ,ATX,NAME
C==================================
 'ПEPECЫЛKA БЛOKA OTKAЗA OT ЛEHTЫ
C---------
 LENTGH:,EQU,HEAD-ENDHEAD
 4,VTM,LENTGH
 LOOP:,BSS,
 4,XTA,ENDHEAD
 ,UTC,1000B
 4,CTX,-LENTGH
 4,VLM,LOOP
C=======================================
 'ПY HA CЛYЖEБHYЮ ЗAДA4Y
C---------
 ,XTA,
 ,ATX,1077B.
 ,XTA,NAME
 ,ATX,1070B
 ,WTC,ALOAD
 13,VJM,
C===================================
 'ECЛИ HET ЗAДAЧИ HA MЛ'
C---------
 13,VTM,MIST
  TO TEL:,ITA,13
  ,AOX,N*TT
  ,FUN,76B
  STOP:,SJ,
 MIST:,ISO,6HTASK'041'
 ,OCT,
 SETDELTA:,BSS,
 ,ITA,3
  ,ASN,64+6
C---------  YCTAHOBKA ДEЛЬTЫ
  ,ATI,14
  14,UTM,-777B
  14,VZM,SETNAM
  ,*52,DLIBMT
  PRIZ:,*63,DLIBMT+1
  :,UZA,FST
  ,AUX,=6H'137''137''137''137''137''137'
  FN:,ATX,ZONE
  ,*63,DLIBMT
  ,ASN,64-39
 ,AUX,=6H'7''7''7''0''0''0'
  ,ARX,=6H000''''''
 ,ATX,ZONE+2
 13,VTM,ZONE
  ,UJ,TOTEL
  FST:,XTA,=6HD73LIB
  ,UJ,FN
C
C...   ЗAПPOC HOBOГO ИMEHИ БCЗ
C      ( ПPИKAЗ 77777/ )
C
  SETNAM :12,VTM,TGN
  ,*63,ГYC
  ,ASN,64+15
  ,ASN,64-40
  ,AOX,=6H'100':ИMЯ
  12,ATX,
  ,ITA,12
  ,AOX,N*TT
  ,FUN,76B
  ,XTA,=1
  ,FUN,66B
  ,ASN,64+12
  ,ATX,ZONE
  NORM:,XTA,ZONE
  ,UZA,WRN
  ,AAX,=:77
  ,U1A,WRN
  ,XTA,ZONE
  ,ASN,64-6
  ,ATX,ZONE
  ,UJ,NORM
  WRN:,XTA,ZONE
  ,*52,DLIBMT+1
  ,UZA,PRIZ
  ,FUN,66B.ЗA NБOБ
  ,APX,=171717170000
  ,ASN,64+32
  ,FUN,203B
  ,AEX,
  ,XTA,=7777
  ,*53,DLIBMT+1
  ,UJ,PRIZ
 ZONE:,ISO,12HD73LIB ЗOHA
 ,OCT,
  TGN:,ISO,12HQ:ИMЯ БCЗ '77'''
C====================
 ' OTKAЗ OT ЛEHTЫ OT ИMEHИ ЗAДA4И
C---------
 HEAD:,BSS,
 1,BAS,*
 1,VTM,1000B
  ,XTA,N*TT
 ,ATX,MN*TL
 15,VTM,73401B.
  ,*70,ПOДBOД
  ,XTA,BIT66
  ,*57,4000B
 ,XTA,INFORTA
 ,ATI,1
 ,WTC,1077B
 ,UJ,
  ПOДBOД:,030,
  ,066,
  BIT66:,OCT,0000 0000 004
  N*TT:,LOG,
 ENDHEAD:,BSS,
 INFORTA:,BSS,1
C---------
C====================================
 'BCЯKAЯ BCЯЧИHA'
C---------
 INFLOA:8,014,3503B.
 ,021,101B.C 2101 - 1 CEKT
  /FIZIM:,LOG,10 0000 0066 0000
C---------
 ALOAD:,LOG,73401.
 LIBMT:,TEXT,8HD73LIB '05'
 TMASK:,TEXT,8H    '07''07'
 TRACENAM:,BSS,
C---------
 STAND:,TEXT,8HTASK00
 NAME:,BSS,1
 ,BSS,2
 ,END,SPECMON
  PUT PULT:,NAME,
C
C   ЗAДAHИE ЗHAЧEHИЯ  IFPULT  ДЛЯ ЗAДAЧИ
C
  *113:B,BLOCK,PULT,PASS
  B:1,BASE,B
  ,FUN,70100B+PULT
  ,ASN,64+6
  ,ATX,KOD
  ,YTA,
  ,ASN,64+42.ШИФP
  ,NTR,3
  ,X-A,=60.ДHЗ
  3,VTM,NO TASK
  ,ASN,64-9
  ,AOX,=50
  ,ATX,ADR
  ,AOX,=:4
  ,FUN,212B.ДAЙ ИПЗ
  ,ATI,2
  2,VZM,EXIT
  ,XTA,KOD
  2,*52,PULT
  ,XTA,ADR
  ,FUN,212B.HA ИПЗ
  4,VTM,-3
  5,VTM,
  TRAN:,XTA,KOD
  5,ASN,64
  ,AUX,=6H'7''7''7''7'''''
  ,AOX,=6H0000'1'
  4,ATX,ANSW+3
  5,UTM,-12
  4,VLM,TRAN
  3,VTM,ANSW
  EXIT:,ITA,3
  ,ATX,KOD
  ,FUN,70100B+PASS.N TT
  ,AAX,=1
  ,ASN,64-40
  ,AOX,KOD
  ,FUN,76B
  ,*62,
  NOTASK:,ISO,6H HET ''
  ANSW:,BSS,4
  ADR:,BSS,1
  KOD:,BSS,1
  ,END,
 PUTTMP:,NAME,.
C---------          ПOДПPOГPAMMA OTKPЫTИЯ ПPИПИCKИ И ЗAЩИTЫ
  Z28/21:,LC,1
 15,UTM,44B
 13,VTM,-3
 L1:15,XTA,
 13,MOD,33B
 13,VLM,L1
 13,VTM,-7
 L2:15,XTA,
 ,ASN,64-8.
  ,AUX,Z28/21
 13,MOD,27B
 13,VLM,L2
 14,UJ,
C---------
 ,END,.
 MACRO67 :  ,NAME,
C
C         ЭKCTPAKOД OTЛAДKИ
C
C      PEДAKЦИЯ OT 20.02.76
C    (Л.KAMИHCKИЙ,И.CИЛИH,A.ГYCEB)
C  1-CTAHДAPTHAЯ ПEЧATЬ(ПEPEД OCTAHOBOM)
C   2-BЫXOД ПOД Э67
C   3-ПPOTAЛKИBAHИE KOMAHДЫ
C   4 BOЗBPAT B ПPEPBAHHOE MECTO
C     ПPИ BOЗBPATE  BOCCTAHABЛИBAЮTCЯ:
C      SR,И14,И16
 ERRMACRO:,SUBP,
  ПЛOX67:,EQU,15.HOMEP ДИAГHOCTИKИ
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,PPIR,MPPIR,M1RDSC,STCLTA
 C77777  :  ,LC,1
 *SCAL71:LC,BLOCK,(3),SCAL67,SCШAГ
 SMASAV:LC,BLOCK,
            ,CONT,      SAVAC
            ,CONT,      SAVSR
            ,CONT,      SAVAR
            ,CONT,      SAVI15
            ,CONT,      SAVI14
            ,CONT,      SAVI13
            ,CONT,      SAVMIR
            ,CONT,      SAVS16
 S 3 3   :  , EQU,00003B
 S 2 7   :  , EQU,00005B
 S 3 4   :  , EQU,00026B
 S 3 5   :  , EQU,00027B
 M:,EQU,100B.
 REGSCAL:,EQU,M
 COPYS32:,EQU,46B
 COPYI14:,EQU,47B
 I14:,EQU,10B
 B48/31:,LC,1
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 C14:,LC,1
 RETURN:,SUBP,
 OCTAHOB:,SUBP,
 COPYS33:,EQU,M+6.
 RETM67:,EQU,M+7.
 SELECT  :  ,SUBP,
 FULSAV  :  ,SUBP,
            ,  ATX  ,SAVAC          .
   :   ,24,2000B
          14,  XTA  ,               .
   :              ,   24  , 02003B        .
 ,ATX,WS.
 ,YTA,
 ,ATX,SAVAR
 13,MTJ,16
 ,CALL,SAVEMOD
 15,VTM,BUFMAR
 ,WTC,ГYC
 13,VTM,
 ,XTA,WS
C         PACKPYTKA ИHФOPMAЦИOHHOГO CЛOBA
            ,  AAX  ,BIT24          .
 ,ITS,32B
 15,AOX,
 13,ATX,RETM67
 ,XTA,WS
            ,  AAX  , C77777        .
 ,XTS,WS.
 ,AAX,B21/22
 ,XTS,WS.
            ,  ASN  ,64+24          .
 ,ATI,33B
 ,MTJ,27B
          15,  XTA  ,               .
            ,  U1A  , STOPNUM       .
 ,XTA,WS
 ,AAX,BIT23
 ,U1A,KPYTИ
          15,  XTA  ,               .
          13,  ATX  , S 3 4         .
   :   ,24,2002B
 ,ATI,34B.OCT.ПO HK
   :   ,24,2003B
 ,UJ,BЫXOД
C      ---------------------
 KPYTИ:,BSS,
 ,AOX,BIT24.ДЛЯ CTAHД.ПEЧATИ
 13,AOX,RETM67
 13,ATX,RETM67
 15,XTA,.AKOH
 13,AEX,COPYS33
 ,AAX,C77777
 ,UZA,RETURN.KOHЧИЛИ ПPOKPYTKY
C         --------------     BЫXOД ПO AПYKOH
C   ПPOДOЛЖAEM KPYTИTЬ
 ,UJ,CONTINUE
C      --------------
 ЧTEH:13,XTA,REGSCAL
 ,AOX,BIT5
 ,AEX,BIT5
 ,UJ,ЧTЗП
C     ----------------------
 STOPNUM:,BSS,
 ,AAX,BIT22
 ,UZA,ЧTEH
 ,XTA,BIT5
 13,AOX,REGSCAL
 ЧTЗП:,BSS,
 13,ATX,REGSCAL
 15,XTA,
   :   ,24,2002B
 ,ATI,35B.OCT.ПO ЧT/ЗП
   :   ,24,2003B
          13,  ATX  , S 3 5         .
 BЫXOД:,BSS,
 ,ITA,33B
 ,U1A,RETURN.ПY ПO AДP.YKAЗ.B Э67
 CONTINUE:,BSS,.
C         BOЗBPAT HA ПPEPBAHHOE MECTO
          13,  XTA  , COPYS33       .
 ,UZA,ПЛOXO
 ,ATI,33B
 ,ASN,64+15.
 ,ATI,27B
 ,AAX,C14
 ,U1A,ПЛOXO
C    ДЛЯ BOЗBPATA B ПPEPB.MECTO
 13,XTA,COPYI14
 ,ATX,SAVI14
 ,ASN,64+15
 ,ATX,SAVS16
 13,XTA,COPYS33
 ,AAX,B48/42
 ,ATX,SAVSR
 TOЛKAЙ:,ENTRY,
C    BЫKЛЮЧEHИE OCTAHOBA
C  BIT19 B REGSCAL-ПPИЗHAK OCTAHOBA ПO ЧИCЛY
 13,XTA,REGSCAL
 ,AAX,BIT19
 ,U1A,CHЯTЬЧ
 13,XTA,S34
 ,ASN,64-15
 13,ATX,S34
 ,ATI,34B
 ,UJ,YCTФЛ
 CHЯTЬЧ:,BSS,
 13,XTA,S35
 ,ASN,64-15
 13,ATX,S35
 ,ATI,35B
C   YCT.ФЛAГA ДЛЯ ПPOГP.ПPEPЫBAHИЯ
 YCTФЛ:,BSS,
  ,XTA,BITJ
 ,AOX,SCAL67
 ,ATX,SCAL67
 ,UJ,RETURN.HA ПPOTAЛKИBAHИE KOMAHДЫ
C        --------------------
 ПЛOXO:,BSS,
 14,VTM,ПЛOX67
 ,UJ,ERRMACRO
C     ------------------
C     21P.-OCTAHOB ПO ЧИCЛY
C     22P.-OCTAHOB ПO ЗAПИCИ
C     23P.-ПPOKPYTKA (AПYKOH,BIT23,AKOH)
C        ШKAЛA ЗAДAЧ,KOTOPЫM HYЖHO ПPOГPAMHOE ПPEPЫBAHИE
C       -----------------------
 OCT67:,ENTRY,
C   PEAKЦИЯ HA ПPOГPAMHOE ПPEPЫBAHИE
C    ПOCЛE OCTAHOBA
 ,WTC,ГYC
 13,VTM,
 ,XTA,SCAL67
  ,AAX,BITJ
 ,UZA,RETURN.ЧYЖOE ПPEPЫBAHИE
C   HEЛЬЗЯ BKЛ.OCT ПO NK
C   ПPИ ПY HA ПPAB.KOMAHДY
 ,XTA,SCШAГ
  ,AAX,BITJ
 ,U1A,BKЛ34
 ,ITA,33B
 ,ASN,64-15
 13,AEX,S34
 ,ASN,64+15
 ,AAX,C77777
 ,UZA,BKЛ35
 BKЛ34:,BSS,
  ,XTA,BITJ
 ,AEX,SCAL67
 ,ATX,SCAL67
C   BOCCTAHOBЛEHИE И34,35
 13,XTA,S34
 ,AAX,C77777
 ,U1A,BKЛ35
 13,XTA,S34
 ,ASN,64+15
 13,ATX,S34
   :   ,24,2002B
 ,ATI,34B
   :   ,24,2003B
 BKЛ35:,BSS,
 13,XTA,S35
 ,AAX,C77777
 ,U1A,YЖEBKЛ
 13,XTA,S35
 ,ASN,64+15
 13,ATX,S35
   :   ,24,2002B
 ,ATI,35B
   :   ,24,2003B
 YЖEBKЛ:,BSS,
 13,XTA,REGSCAL
 ,AAX,BIT18
 ,U1A,ШAГ.PAБOTA C OTЛAДЧИKOM
 13,XTA,RETM67
 ,AAX,BIT23
 ,UZA,RETURN.ПPOДOЛЖEHИE ЗAДAЧИ
 ,XTA,SCAL67
  ,AAX,ZBITJ
 ,ATX,SCAL67
 13,XTA,REGSCAL
 ,AOX,BIT19
 ,AEX,BIT19
 13,ATX,REGSCAL
 ,ITA,27B
 ,AAX,C14
 ,UZA,MATJOB
C  YCT.OCTAHOBA ПO BЫXOДY ИЗ ЭKCTPAKOДA
 ,ITA,32B
 13,ATX,S34
   :   ,24,2002B
 ,ATI,34B
   :   ,24,2003B
 ,UJ,RETURN.B ПPEPBAHHOE MECTO
C        ------------------
 MATJOB:,BSS,
  14,VTM,3.HA
  ,UJ,OCTAHOB.ПPOKPYTKY
C        ---------------------
 MICROSAV:,ENTRY,
C   ЗAПOMИHAEM MECTO ПPEPЫBAHИЯ
 ,ITA,27B
 ,ASN,64-15
 13,ATX,COPYS33
 ,ITA,33B
 13,AOX,COPYS33
 13,ATX,COPYS33
  ,XTA,SAVSR
  ,AAX,B48/42
  13,AOX,COPYS33
  13,ATX,COPYS33
C   ЗAПOMИHAEM И14,16 ДЛЯ BOЗBPATA B ПPEPBAHHOE MECTO ЧEPEЗ Э67
 ,XTA,SAVI14
 ,AAX,C77777
 ,ATX,SAVI14
 13,XTA,COPYS32
 ,AAX,B48/31
 13,ATX,COPYS32
 ,ITA,32B
 13,AOX,COPYS32
 13,ATX,COPYS32
 13,XTA,COPYI14
 ,AAX,B48/31
 ,AOX,SAVI14
 13,ATX,COPYI14
 ,XTA,SAVS16
  ,AAX,C77777
 ,ASN,64-15
 13,AOX,COPYI14
 13,ATX,COPYI14
 15,UJ,
  ШAГ:,BSS,
  ,XTA,SCШAГ
  ,AAX,BITJ
  ,UZA,RETURN
 13,XTA,REGSCAL
 ,AOX,BIT19
 ,AEX,BIT19
 13,ATX,REGSCAL
  14,VTM,2
  ,UJ,OCTAHOB
C         ------------------
 B48/42:,OCT,774
 B21/22: ,LOG,1400 0000
 WS:,BSS,1.
 BUFMAR:,BSS,2
 ,END,
