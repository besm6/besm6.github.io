 MACRO70 :  ,NAME,
C
C         ЭKCTPAKOД OБMEHA
C
  * И П Д :LC,BLOCK,XNF,XNFM
 NMAT1:,WEQ,XNF
 ШCЛYЖ:,EQU,XNF+10B
  MTRACNT:,EQU,XNF+27B
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 BITTRA:,EQU,BIT27.
 BITPHYS:,EQU,BIT48.
 *YCЫ:LC,BLOCK,Г Y C,RDSCAL.
 READSCAL:  ,LC,1
 SMASAV:LC,BLOCK,
            ,CONT,      SAVAC
            ,CONT,      SAVSR
            ,CONT,      SAVAR
            ,CONT,      SAVI15
            ,CONT,      SAVI14
            ,CONT,      SAVI13
 ERRMACRO:  ,SUBP,
  TEXTOШ:,EQU,16.HOMEP ДИAГHOCTИKИ
 TRABUS  :  ,LC,1
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 I W 7 0 :  ,LC,1
 TRACNT  :  ,LC,1
 CLTASK  :  ,SUBP,
 DISREG  :  ,LC,1
 C3:,LC,1
  C14:,LC,1
 C37     :  ,LC,1
 C77:,LC,1.
 C177:,LC,1
 MNP:,EQU,C177
 C76000:,LC,1
 C77357:,LC,1
 FULWOR:,LC,1
 TMATH   :  , EQU,00030B
 TPHYS   :  ,LC,1
 TRAM70:,SUBP,.
 BUFTRA:LC,BLOCK,(1),IFTRA
 S33:,EQU,3.
 S27:,EQU,5.
 C7:,LC,1.
 I13:,EQU,11B.
 M:,EQU,100B.
 REGSCAL:,EQU,M.
 BUFI14:,EQU,M+3.
 BUFS27:,EQU,M+4.
 BUFIW:,EQU,M+5.
 BISTIME:,EQU,110B.
  W70/POST:,EQU,135B
  LOMIDZSC:,EQU,162B
  DRU/MEM:,EQU,777B
  C377:,LC,1
  GIVEPAGE:,SUBP,
 CWJFOTRA:,LC,1.
 FULQUESC:,LC,1.
 NEWTA   :  ,SUBP,
  NRESCALL:,SUBP,
  NR POST:,SUBP,
  SWTCHM52:,SUBP,
  VMCHANG:,SUBP,.ЗAMEHA ЛИCTOB
 EMULAT:,SUBP,.
  *TAKCA:LC,BLOCK,TIMEDRUM
 :,ATX,SAVAC
 ,XTA,I/EM
 ,UJ,EMULAT
 L00570  :  ,  RTE  , 07777B        .
            ,  ATX  ,SAVSR          .
            ,  ITA  , 27B           .
            ,  AAX  , C77357        .
 ,WTC,Г Y C.
            ,  ATX  , BUFS27.   .
 ,XTA,SAVAC
 14,VZM,M/ACC
   :   ,24,2000B.
 14,XTA,.
 MACRO70S:,ENTRY,.
 M/ACC:,BSS,
   :              ,   24  , 02003B        .
            ,  ATX  , I W 7 0       .
 ,WTC,Г Y C.
 14,VTM,.
  14,XTA,BUFS27
  ,ATI,27B
  ,XTA,IW70
C-----   ПPOBEPKИ PAЗPEШEHHOCTИ   -----
 ,ATX,SAVAC
  ,ASN,64+12
  ,AAX,C77
  14,ATX,BUFIW.HOMEP MБ/MЛ
  ,ASN,64+3
 ,ATX,SAVAR
 ,AEX,C7
 ,UZA,BADIW.= HAПP.7
 ,ARX,C3
 ,ASN,64+3
 ,UZA,CH T.= HAПP.3-6
 ,XTA,IW70
 ,AAX,BIT39
 ,UZA,MAT DRUM
 ,XTA,SAVAR
 ,UZA,BAD IW.= HAПP.0(Ф)
 ,XTA,IW70
 ,AAX,BIT46
  ,U1A,CHPH1.= MOДEЛЬ
  CL DR:,BSS,
C.....   OБMEH C MБ
 ,NTR,2
 14,XTA,BISTIME
 ,A+X,TIMEDRUM
 14,ATX,BISTIME
 ,XTA,IW70
 ,AAX,CLM 1
 ,ATX,IW70
  CH NS:,AAX,BIT36
  ,UZA,CH PH
C-----   ПPИBEДEHИE HECTAHДAPTHOГO IW70
  ,XTA,IW70
  ,AAX,C377
  14,ATX,BUFIW
  ,ASN,64-8
  14,AOX,BUFIW
  ,ASN,64+2
  ,AAX,C377
  14,AEX,BUFIW
  ,AEX,IW70
  ,ATX,IW70
 CH PH:,XTA,IW70
 ,AAX,B40/39.ФИЗ.ЗAПИCЬ
 ,AEX,BIT39
 ,U1A,OKEY. = HET
 CHPH 1:,XTA,3
 ,WTC,ДHЗ
 ,APX,BITS-NMAT1
 14,AOX,REGSCAL
 ,AAX,BITPHYS
 ,U1A,OKEY
  14,XTA,BUFS27
  ,AAX,C14
  ,U1A,OKEY
C-----   ПЛOXOE ИHФOPMAЦИOHHOE CЛOBO
 BAD IW:14,VTM,TEXT OШ
 ,UJ,ERRMACRO
 CH T:,XTA,IW70
 ,AAX,BIT39
 ,U1A,CH PH
C.....   OБMEH C MAT.MЛ
 ,XTA,IW70
 ,AAX,CLM 2
 ,ATX,IW70
  14,XTA,LOMIDZSC
  14,WTC,BUFIW
  ,AAX,BIT48-30B
  ,UZA,OKEY
C
C---  K ПOЧTOBOЙ CЛYЖБE CO CПEЦ-ЗAKAЗOM
C
  ,XTA,C14
  14,ATX,W70/POST+4
  ,XTA,IW70
  14,ATX,W70/POST+5
  14,ATX,W70/POST+19
  ,AAX,=:0000 37
  ,AOX,=0060 0077 1470 0000
  ,UJ,SWTCHM52+1
C
C
C
 OKEY:,BSS,
            ,  XTA  , I W 7 0       .
          14,  ATX  , BUFIW.    .
 RET1FQ:,BSS,.
 ,XTR,SAVSR
 ,AAX,B42/41.
  ,UZA,NO MOVE. OБMEH
  ,XTA,IW70
  ,ASN,64+42.48-43 PAЗP.
  ,U1A,BAD IW.BPEДOHOCHЫ !
  ,UJ,AFULQUE
  NO MOVE:,XTA,IW70
            ,  ASN  ,64+20          .
            ,  AAX  , C76000        .
            ,  ATI  , 14            .
            ,  XTA  , I W 7 0       .
            ,  ARX  ,               .
            ,  UZA  , SWINREAD      .
            ,  AAX  ,BIT40          .
            ,  UZA  , SWINREAD      .
            ,  XTA  , READSCAL      .
  ,AOX,BITJ
            ,  ATX  , READSCAL      .
 SWINREAD:  ,   24  , 02000B        .
          14,  XTA  , 00001B        .*****
 AFULQUE:,BSS,.
   :   ,24,2003B.
  ,XTA,ZBITJ
 ,AAX,READSCAL
 ,ATX,READSCAL.
 ,ITA,13
 ,ATX,SAVI13
 ,ITA,15
 ,ATX,SAVI15
 ,XTA,TRACNT.
 ,ARX,MTRACNT
            ,  U1A  , NOFULQUE      .
 13,VTM,RET2FQ.
 13,MTJ,33B.
 13,VJM,CLTASK.
            ,  XTA  , FULQUESC      .
  ,AOX,BITJ
            ,  ATX  , FULQUESC      .
            ,  XTA  , DISREG        .
            ,  ATI  , 27B           .
 ,UJ,NEWTA
 NOFULQUE:,WTC,ГYC
 14,VTM,
 14,XTA,BUFIW
 ,ATX,IW70
 ,AAX,B42/41.
 ,U1A,NFL1. ЗAKAЗ HA ПOДBOД
 ,XTA,IW70.
            ,  ASN  ,64+30          .
            ,  AAX  , C37           .
  ,ATI,13
  14,UTC,
  13,XTA,TMATH
  ,AOX,BIT46
  14,UTC,
  13,ATX,TMATH
            ,  ASN  ,64+30          .
 ,AAX,MNP
  ,ATI,13
  13,XTA,TPHYS
            ,  AOX  ,BIT7           .
  13,ATX,TPHYS
 NFL1:,BSS,.
  14,XTA,BUFS27
  ,ATI,27B
  ,ASN,64+15.V-OБMEH
  ,U1A,VEXCH.-ДA
            ,  XTA  , Г Y C         .
            ,  ATX  , CWJFOTRA      .
 ,ATX,IFTRA+I13.
            ,  XTA  ,BIT40          .
  ,AOX,TRABUS
            ,  ATX  , TRABUS        .
            ,  ITA  , 32B           .
            ,  ATI  , 33B           .
            ,  XTA  , RDSCAL        .
            ,  AOX  , BITTRA        .
            ,  ATX  , RDSCAL        .
 14,VTM,TRAM70.
 ,ITA,14.
 ,ATX,IFTRA+S33.
 ,XTA,C7.
 ,ATX,IFTRA+S27.
 ,UJ,NEWTA
 RET2FQ:,WTC,Г Y C.
 ,XTA,BUFIW.
 ,ATX,IW70.
 ,UJ,RET1FQ.
 MAT DRUM:,BSS,
 ,XTA,ШCЛYЖ
 ,AAX,BITJ
  ,U1A,BADIW
C-----   ПPOБA: MOДEЛИPYETCЯ ЛИ
C               HAШ MБ B MOЗY
  14,XTA,DRU/MEM
  14,WTC,BUFIW
  ,AAX,BIT48
  ,UZA,CL DR.-HET
  14,AOX,BUFS27
  14,ATX,BUFS27.ФЛAГ V-OБMEHA
  ,ASN,64+24
  14,AAX,DRU/MEM
  ,U1A,CHANGE
  ,XTA,IW70
  ,UJ,CH NS
C
C...   BMECTO OБMEHA C MБ -
C      - ЗAMEHA CTPAHИЦ .
C
  CHANGE:,XTA,IW70.CEKT.OБMEH
  ,ARX,.OБCЛYЖИBAEM
  ,UZA,CHNS.OБЫЧHO
  ,ATX,SAVAC
  14,VTM,
  ,UJ,VMCHANG
C
C-----   B ПOДKAЧKY CO CПEЦ-ЗAKAЗOM :
C        OБMEH MEЖДY MAT.ЛИCTOM И
C        BИPTYAЛЬHЫM ЛИCTOM.
C
  V EXCH:,XTA,DISREG
  ,ATI,27B
  13,VTM,V EXCH
  13,MTJ,33B
  15,VTM,-1. K O П
  ,UJ,GIVEPAGE
 I/EM:,Z00,200B.БИT ЭK70
 ,Z00,L00570.BOЗBPAT
 CLM 1:,LOG,4017 7777 7777 7777
 CLM 2:,LOG,0377 7777 7777 7777
 B42/41:,OCT,006.
 B40/39:,OCT,0014.
 ,END,
 COБЫTИE:,NAME,
C
C*****   П/П YCTAHOBKИ COБЫTИЯ
C
C     OБPAЩEHИE C ЗAKPЫTЫMИ ПPEPЫBAHИЯMИ
C
C     CYMMATOP :
 '    PP. 48/25 - ШKAЛA COБЫTИЙ
 '    PP. 15/01 - AДPEC BOЗBPATA
C
C     PEГИCTP MЛAДШИX PAЗPЯДOB :
 '    YПP.CЛOBO COOTBETCTBYЮЩEЙ ЗAДAЧИ
C
 *YCЫ:LC,BLOCK,(1),RDSCAL
 SCALES:LC,BLOCK,(5),SC OPER
C.....   ЯЧEЙKИ ИПЗ :
 S33:,EQU,3
 S27:,EQU,5
 И13:,EQU,9
 П YПP:,EQU,50B
 M/Ф:,EQU,51B
 MC:,EQU,52B
 ШC:,EQU,53B
 M:,EQU,100B
 ДШ:,EQU,112B
C.....
 B30/16:,LC,1
 B24/1:,LC,1
 C77777:,LC,1
 BITS:,EQU,677B
  DISREG:,LC,1
  *727:B,BLOCK,B25
 *736:B,BLOCK,B18,B17,B16
C.....   PAЗHЫE ПPИЗHAKИ :
 BETB:,EQU,B18.HAДO BETBЛ.
 ЗAKP:,EQU,B17.ЗAKPЫTA ДO BETB.
 БЛOK:,EQU,B16.БЛOKИP.BETBЛ.
C*****
C
  :,24,2003B.OT ГPEXA
 ,ATX,CYM.ШKAЛA+BOЗBPAT
 ,ITA,14
 ,ATX,*14
 ,YTA,
 ,ATX,PMP.YC ЗAДAЧИ
 ,ATI,14.AДPEC ИПЗ
  14,VZM,RET
 ,AAX,B30/16.ECTЬ ЗAДAЧA
 ,UZA,RET. = HET
 14,XTA,ДШ
 ,UZA,RET
 ,XTA,CYM.ГEHEPИPYEMЫE
 ,ASN,64+24. COБЫTИЯ
 14,AOX,ШC
 14,ATX,ШC
 14,AAX,MC
 ,AAX,B24/1
 ,UZA,RET.= ЗAMACKИP.
 14,XTA,M/Ф
 ,AOX,BETB
 14,ATX,M/Ф.ЗAДAЧA ЖДAЛA
 ,AAX,ЗAKP. BETBЛEHИЯ
 ,UZA,RET. = HET
 14,AEX,M/Ф
 14,ATX,M/Ф
 ,XTA,PMP
 ,ASN,64+42
 ,ATI,14
 ,XTA,SC OPER
 14,AOX,BITS
 14,AEX,BITS
 ,ATX,SC OPER
 ,XTA,RDSCAL
 14,AOX,BITS
 ,ATX,RDSCAL
C-----   BOЗBPAT K OБPATИBШEMYCЯ
 RET:,WTC,*14
 14,VTM,
 ,WTC,CYM
 ,UJ,
 BETBЛEH:,ENTRY,
C*****   ПPOBEPKA HEOБXOДИMOCTИ BETBЛEHИЯ
C        И EГO OPГAHИЗAЦИЯ
C
C     ПPИ BXOДE B И15 - AДPEC ИПЗ
C     BOЗBPAT ПO И14
C
 15,XTA,ДШ
 14,UZA,.= HET ДEШИФP.
 15,AOX,M/Ф
 ,AAX,БЛOK.БЛOKИP.BETBЛEH.
 14,U1A,. = ДA
 15,XTA,M/Ф
 ,AAX,BETB.ECTЬ BETBЛEH.
 14,UZA,. = HET
 15,XTA,П YПP
 ,AAX,N YПP.ECTЬ ПOЛE YПP.
 ,UZA,CLOSE. = HET
C-----   OPГAHИЗYEM KBAЗИПAPAЛЛEЛЬHЫЙ
C-----   ПPOЦECC
 15,XTA,П YПP
 ,ARX,C MIN
 15,ATX,П YПP.= AДPEC ПOЛЯ
 ,ATI,13.  YПPЯTЫBAHИЯ
C.....   ПEPEПИCЬ ИПЗ B ИПB
 12,VTM,1-12
 ПEPE:15,UTC,
 12,XTA,11
 13,UTC,
 12,ATX,11
 12,VLM,ПEPE
 15,XTA,M
 13,ATX,12.= REGSCAL
 15,XTA,ДШ.= ШKAЛA ЛИCTOB
 13,ATX,13.  C KOH.OБM.
C.....   ФOPMИPOBAHИE HOBOГO ИПЗ
 15,ATX,S33
 ,AAX,C77777
 ,AOX,БЛOK
 15,ATX,ДШ
 15,XTA,M/Ф
 ,AEX,BETB
 15,ATX,M/Ф
 15,AEX,П YПP.= M-AДPEC
 15,ATX,И13.  ПOЛЯ YПP.
 15,XTA,ШC
 15,AAX,MC
 ,ASN,64-24
 15,ATX,S27.= PEЖИM YY
 15,UTC,
 ,ATX,.= ШKAЛA COБ.
 ,ASN,64+24
 15,AEX,ШC
 15,ATX,ШC
  ,AAX,B25
  14,UZA,
  ,XTA,DISREG
  15,ATX,S27
 14,UJ,
 CLOSE:,BSS,
C.....   HEЗAПYCK BETBИ ПO HEXBATKE
C.....   ПOЛЯ YПPЯTЫBAHИЯ
 ,XTA,БЛOK
 15,AOX,M/Ф
 15,ATX,M/Ф
 14,UJ,
C.....
 N YПP:,LOG,37 00000
 C MIN:,LOG,7777 7777 776 77757
 CYM:,BSS,1
 PMP:,BSS,1
 *14:,BSS,1
 ,END,
 MACRO75 :  ,NAME,
C
C         ЭKCTPAKOД ЗAПИCИ KOMAHД
C
 NMAT1:,EQU,30B.
 M:,EQU,100B.
 REGSCAL:,EQU,M.
 SMASAV:LC,BLOCK,SAVAC(8)
 OUTMACRO:,SUBP,
 BUF27:,EQU,M+4.
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 *YCЫ:LC,BLOCK,Г Y C.
 Д H З   :  ,LC,1
 C77357  :  ,LC,1
 ,ATX,SAVAC
            ,  ITA  , 27B           .
            ,  AAX  , C77357        .
 ,WTC,Г Y C.
            ,  ATX  , BUF27   .
 ,XTA,SAVAC
   :              ,   24  , 02000B        .
          14,  ATX  ,               .
   :   ,24,2003B.
 ,MOD,101B.
   :   ,24,2000B.
          14,  ATX  ,               .
   :              ,   24  , 02003B        .
 ,WTC,Г Y C.
 ,XTA,REGSCAL.
 ,AAX,BIT46.
 ,UZA,PUSH.
 14,VZM,NO DIF.
 14,UTM,-1.
 14,VZM,DIF.
 PUSH:,WTC,Г Y C.
 ,XTA,REGSCAL.
 PUSH1:,BSS,.
 ,AAX,BIT4.
 14,VTM,-3
 ,U1A,TOMEM.
C         YCTAHOBKA CBEPTKИ 'ЗAПИCЬ ЧИCЛA'  ДЛЯ HEЧETHOГO ШИФPA
            ,  MOD  , 00107B        .
 TOMEM:,BSS,
 13,MTJ,16
 ,CALL,SAVEMOD
 ДOBЫT:,BSS, .ДOBЫTAЛKИBAHИE(ЧACTИЧHO
 ,ATX,1 .BЫTOЛKHYЛO MAЛOE YПPЯTЫBAHИE)
 14,VLM,ДOBЫT
 ,WTC,Г Y C.
            ,  XTA  , BUF27   .
            ,  ATI  , 27B           .
 ,UJ,OUTMACRO
 DIF:,WTC,Г Y C.
 ,XTA,REGSCAL.
 ,AOX,BIT4.
 ,AEX,BIT4.
 SETR:,WTC,Г Y C.
 ,ATX,REGSCAL.
 ,UJ,PUSH1.
 NO DIF:,WTC,Г Y C.
 ,XTA,REGSCAL.
 ,AOX,BIT4.
 ,UJ,SETR.
 ,END,
 MACRO76:,NAME,.
C
C         ЭKCTPAKOД ПPOИЗBOЛЬHЫX ФИЗИЧECKИX ДEЙCTBИЙ
C
 M:,EQU,100B.
 REGSCAL:,EQU,M.
  * И П Д :LC,BLOCK,XNF,XNFM
 NMAT1:,WEQ,XNF
 ERRMACRO:,SUBP,.
  ERTEXT:,EQU,17.HOMEP ДИAГHOCTИKИ
 *677:B,BLOCK,BITS,BIT48.
 BITPHYS:,EQU,BIT48.
 *YCЫ:LC,BLOCK,Г Y C.
 SMASAV:LC,BLOCK,(3),SAVI15,SAVI14,SAVI13.
 Д H З:,LC,1.
  TODAY:,LC,1
 TMATH:,EQU,30B.
 C37:,LC,1.
 C1777:,LC,1.
  C77357:,LC,1
 CALL1MEM:,SUBP,.
 OUTMACRO:,SUBP,
 ,ATX,SMASAV.
 13,MTJ,16
 ,CALL,SAVEMOD
 ,ITA,16
 ,ATI,13
 EMULAT:,SUBP,.ИHTEPПPETATOP
 :,XTA,*+1.
 ,UJ,EMULAT.
 :,,2.БИT ЭK76
 ,Z00,*+1.BOЗBPAT
 14,VZM,PHOFF.
 14,UTM,-1.
 14,VZM,PHON.
 14,UTM,1.
 ,XTA,3.
 ,WTC,Д H З.
 ,APX,BITS-NMAT1.
 ,WTC,Г Y C.
 ,AOX,REGSCAL.
 ,AAX,BITPHYS.
 ,UZA,ЗAПPEЩ.
 ,XTA,RET.
 RET:,UJ,CALL1MEM.
 ,Z00,*+1.
 ,BSS,.
 ,ATX,WS.
 ,ITA,14.
 ,AAX,C1777.
 ,AOX,WS.
 ,ATI,14.ФИЗ. AДPEC ПY
 ,XTA,SMASAV.
 14,UJ,.
 PHOFF:,BSS,.
 ,WTC,Г Y C.
 ,XTA,REGSCAL.
 ,AOX,BITPHYS.
 ,AEX,BITPHYS.
 MR:,WTC,Г Y C.
 ,ATX,REGSCAL.
 ,MTJ,27B
 ,UJ,OUTMACRO
 PHON:,AEX,=30534576 16340112.
 ,U1A,ЗAПPEЩ
 ,WTC,Г Y C.
 ,XTA,REGSCAL.
 ,AOX,BITPHYS.
 ,UJ,MR.
 ЗAПPEЩ:,BSS,.
C---------         ЗAДAЧE HE PAЗPEШEHO ПOЛЬЗOBATЬCЯ ЭTИM ЭKCTPAKOДOM
 :14,VTM,576B.
 BADMACRO:,ENTRY,.
C
C.........         BXOД ПO ПEЧATИ OБ OTCYTCTBYEЩEM(ЗAПPEЩEHHOM)
C                  ЭKCTPAKOДE
C
 ,ITA,15.
 ,ATX,SAVI15.
 ,ITA,14.
 ,ATX,SAVI14.
 ,ITA,13.
 ,ATX,SAVI13.
 :14,VTM,ERTEXT.
 ,UJ,ERRMACRO.
 MACRO63:,ENTRY,.
C
C         ЭKCTPAKOД ЧTEHИЯ ФИЗ. ЯЧEЙKИ
C
 :,XTA,*+1.
 ,UJ,EMULAT.
 :,001,.БИT ЭK63
 ,Z00,*+1.BOЗBPAT
  ,ITA,27B
 ,AAX,C77357
 ,ATI,27B
 13,MTJ,16
 ,CALL,SAVEMOD
  14,UTM,-4
  14,VZM,DATE1
    14,XTA,4B
 ,UJ,MACRET1
  DATE1:,BSS,.ПOДMEHA 43-24 PAЗPЯДOB 4 T.P.
  ,XTA,4B
  ,AAX,=7600 0000 7777 7777
   ,AOX,TODAY
 MACRET1:,ATX,SMASAV
 ,UJ,OUTMACRO
 WS:,BSS,1.
 ,END,.
 MACRO60 :  ,NAME,
 *YCЫ:LC,BLOCK,Г Y C.
  *102:B,BLOCK,S15,S14,S27,P15
  Д H З :LC,BLOCK,(1),BITJ
  SCEM:,EQU,83
  I60/74:,EQU,85
  NRS60*:,SUBP,
  EMULAT:,SUBP,
 NRSINPUT:,SUBP,.
 NRESCALL:,SUBP,.
 EFSMNRS:,SUBP,
 YBBKNRS:,SUBP,
  NR405   :,SUBP,
  NRCDC405:,SUBP,
 FSBASENR:LC,BLOCK,BASINPUT,BASE405
  FSCONTR:,SUBP,
  ADOFACC:LC,BLOCK,(2),CNUMT
  C2004:,LC,1
 C14:,LC,1.
 SMASAV:LC,BLOCK,(4),SAVI14
  * И П Д :LC,BLOCK,XNF,XNFM(4)
  ,CONT,XNC,XNCM(2)
  ,CONT,Ш/CЛYЖ,Ш/FULL
 NUSE1:,WEQ,XNF
  * И П K 1 :LC,BLOCK,PRTSTAT
 C77777:,LC,1.
 C77:,LC,1
  *677:B,BLOCK,BITS
  ,CONT,B48,B47,B46,B45,B44,B43
  ,CONT,B42,B41,B40,B39,B38,B37
  ,CONT,B36,B35,B34,B33,B32,B31
  ,CONT,B30,B29,B28,B27,B26,B25
  ,CONT,B24,B23,B22,B21,B20,B19
  ,CONT,B18,B17,B16,B15,B14,B13
  ,CONT,B12,B11,B10,B9,B8,B7,B6
  ,CONT,B5,B4,B3,B2,B1
C
 БAЗAПPИЗ:LC,BLOCK,BASEFLAG,AKЖПM,З1BШГ
 ,CONT,БЫЛ ДK,BЫKЛ Д,БЫЛA KП
 ,CONT,ЗB CBOЯ,ЗB ЗAHЯTA,KЖПM
 ,CONT,CЧKЖПM,HOMEP BY
 ,CONT,CЧПPOПK,ЧПCTPOK
 ,CONT,AПBБЩ,AПHБЩ
 ,CONT,TPЗ2OTЗ1,KПOДBБЩ
 ,CONT,KПOДHБЩ,AKЖOБPЗ1
 ,CONT,BY HE PAБ,PЯЗ1,CЧ OШ K
 ,CONT,CЧ KBЫKBY,CБOЙ BY
 ,CONT,HET KAPT,ПPOД
  DN405   :,EQU,ЗB ЗAHЯTA
  KД      :,EQU,CЧK ЖПM
  STARENDF:,EQU,HOMEP BY
 ПPOBYNRS:,SUBP,.
 RETURN  :  ,SUBP,
 NEWTA*:,SUBP,.
 STARTJOB:,SUBP,.
C
  VJ:,EQU,15
C
  KЛЮЧCЧBP:,LC,1
C
C---   ПPИЗHAK HAЛИЧИЯ CDC405
C
  TYPEMT:,SUBP,
  FL405:,EQU,TYPEMT+4
C
C----------------------------------
C
  :,XTA,*+1
  ,UJ,EMULAT
  :,Z01,
  ,Z00,*+1
  :,ITA,15
  ,WTC,Г Y C
  15,VTM,S15
  ,ITS,14
  ,ITS,27B
  ,XTS,Ш/FULL
  ,AAX,BITJ
  ,UZA,RIW
C---   ПPOБA ПEPEXBATA Э060 :
  15,XTA,SCEM-P15
  ,AAX,B40
  ,U1A,ПEP60
C---   ПOBЫШEHИE ПPИOPИTETA :
 ,WTC,ДHЗ
 ,XTA,PRTSTAT-NUSE1
 ,AAX,C77
 ,WTC,ДHЗ.
 ,ATX,PRTSTAT-NUSE1.
C---   ЧTEHИE KOMAHДЫ 060 :
  RIW:,ITA,32B
  ,ATI,14
  15,XTA,S27-P15
  ,AAX,C14
  ,UZA,MAT
  ,UTC,3
  MAT:,24,2000B
  14,XTA,-1
  :,24,2003B
  ,ATX,BASEFLAG
  ,AEX,B1
  ,AAX,C77777
  ,UZA,CALL NR.FSM
  ,XTA,FL405
  ,UZA,CALLNR.HET CDC405
  ,AAX,7
  ,U1A,CALL NR.БЛOKИP.
  ,UTC,NR405-NRS60*
  Э60/MБ:,UTC,NRS60*-NRSINPUT
  CALL NR:14,VTM,NRSINPUT
  ,ITA,14.ИMЯ
  ,ASN,64-24.HEPEЗИДEHTA
  ,AOX,=15.БAЗ.PEГ.
  ,STX,INF. = 13
  ,STI,27B
  ,STI,14
  ,ATI,15
  ,XTA,INF
  ,UJ,NRESCALL
  ПEP60:15,XTA,I60/74-P15
  ,ASN,64+15
  ,U1A,Э60/MБ
  13,VTM,50000B
  ,ITA,32B
  13,MTJ,32B
  ,ATI,13
  15,XTA,S15-P15
  ,ATI,15
  ,MTJ,27B
  2,IJ,
C
C---   OT ЗAПPOCA ИЛИ ПPИKAЗA "B" :
C
  ЗAПYCK:,ENTRY,
  ,XTA,FL405
  ,UZA,ЗAПYBBK
  ,AAX,7
  ,U1A,ЗAПYBBK
  ЗAП405:,BSS,
  ,XTA,
  ,ATX,BY HEPAБ
  ЗAПYBBK:,BSS,
 ,XTA,ЗB ЗAHЯTA.
 ,UZA,STARTJOB
   ,XTA,BYHEPAБ.
 ,UZA,RETURN.BY PAБOTAET
 ,XTA,.
   ,ATX,ПPOД.
   ,ATX,З1 B ШГ.
   ,ATX,CБOЙ BY.
   ,ATX,BYHEPAБ.
   ,ATX,БЫЛA K П.
   ,ATX,CЧ OШ K.
   ,XTA,B30
 ,UJ,NEWTA*.
 ПPOB BY:,ENTRY,
 ,XTA,KЛЮЧCЧBP.
 ,WTC,FSBASENR
  15,VTM,
  15,U1A,ПPOBYNRS-EFSMNRS
  ,XTA,CNUMT
  15,U1A,FSCONTR-EFSMNRS
  ,XTA,FL405
  13,UZA,
  ,AAX,7
  ,AOX,KД
  13,U1A,
  ,XTA,=2200
 VJ,VJM,TOCDC405
 ,AEX,STARENDF
 13,UZA,.OБЫЧHO ЗДECЬ BOЗBPAT B ITIMEB10
C     ------------------------
 ,AEX,STARENDF
 ,ATX,STARENDF
 ,XTA,B11
 VJ,VJM,TOCDC405
 13,U1A,
 ,XTA,C2004
 VJ,VJM,TOCDC405
 13,UZA,
  ,UJ,ЗAП405
 TOCDC405:,ENTRY,
 TOCDC405:,BSS,
 ,EXT,145B
 ,036,.ЗAДEPЖKA 6 MKCEK
  ,ATI,
 ,EXT,4101B
   ,AAX,B11
 VJ,UJ,
  INF:,BSS,1
 ,END,
  ZOO60:,NAME,
C     HEPEЗИДEHT BBOДA C MБ/MЛ ПO ,*60,
C     B KAЧECTBE БYФEPA ИCПOЛЬЗYETCЯ
C     45 ФOPMAЛЬHЫЙ ЛИCT ЗAДAЧИ
  *YCЫ:LC,BLOCK,ГYC
  S27/70:,EQU,104B
  *535:B,BLOCK,AC,SR,AR,R33
  ,CONT,R32,R27,R16,R15
  ,CONT,R14,R13,R12,R11
  ,CONT,R10,R 9,R 8,R 7
  ,CONT,R 6,R 5,R 4,R 3
  ,CONT,R 2,R 1
  WORK1:,EQU,R1
  IW72 :,EQU,R2
  IW70 :,EQU,R3
  *677:B,BLOCK,BITS
  ,CONT,B48,B47,B46,B45,B44,B43
  ,CONT,B42,B41,B40,B39,B38,B37
  ,CONT,B36,B35,B34,B33,B32,B31
  ,CONT,B30,B29,B28,B27,B26,B25
  ,CONT,B24,B23,B22,B21,B20,B19
  ,CONT,B18,B17,B16,B15,B14,B13
  ,CONT,B12,B11,B10,B 9,B 8,B 7
  ,CONT,B 6,B 5,B 4,B 3,B 2,B 1
  NRESOFF:,SUBP,
  NRS60*: ,SUBP,
  BOCИПД:,SUBP,
  RETURN:,SUBP,
  MACRO70S:,SUBP,
  C77777:,LC,1
  I60/74:,EQU,85
 SCEM:,EQU,83
  C14:,LC,1
  C13:,LC,1
  LR:,EQU,7.MЛ.ИCП.PEГ
  R1*2:,EQU,R1+2
  E/FLAG:,EQU,AR
  ERRMACRO:,SUBP,
  FULSAV:,SUBP,
C======================================
C     CTPYKTYPA ЯЧEЙKИ ИПЗ 'I60/74':
C......................................
C     P48 - ПEPBOE OБPAЩEHИE K Э60(=1)
C     P47 - =1 - KOHЧИЛИCЬ KAPTЫ
C     PP.46-31 - YKAЗATEЛЬ MЛ/MБ
C                (10 P.ПOД N ЗOHЫ)
C     PP.30-16 - CЧETЧИK ПO ЛИCTY
C     PP.15- 1 - AДP.ПEPEXBATA ЭK74
C====================================
C     BBOДЯTCЯ 'BINARY' KAPTЫ
C.....................................
C
C
C     CЧETЧИK ПO ЛИCTY ФOPMИPYETCЯ TAK:
C     <CЧETЧИK B ПPЯMOM KOДE>-2000B,
C     ПOCKOЛЬKY TAKOЙ CЧETЧИK
C     ИCПOЛЬЗYETCЯ B MOHИTOPHOЙ CИCT.
C     B LC 'KCOUNT*'
C======================================
  B:13,REL,B
  ,WTC,ГYC
  15,VTM,AC
  ,ITA,32B
  ,ATI,33B
  13,MTJ,14
  13,VJM,FULSAV+1
  14,MTJ,13.ПO I15
  ,XTA,C13
  ,ATI,27B
   :    ,24,3
  ,WTC,ГYC
  7,VTM,
  7,XTA,I60/74
  ,AAX,B47
  7,ATX,E/FLAG
  7,XTA,I60/74
  ,ARX,
  ,U1A,NO FIRST
C      ПEPBOE OБPAЩEHИE.
C   BOЗBPAT YKAЗATEЛEЙ HA 1 KAPTY
  ,ASN,64+15
  ,AAX,C77777
  ,ARX,=77747.-31B
  ,ATI,9
  ,AAX,C77777
  ,ARX,=2000
  ,AAX,=70 0000
  ,U1A,READ/1.I9.GE.-1024
  9,UTM,2000B
  7,XTA,I60/74
  ,ASN,64-2
  ,AUX,=77 1777
  ,NTR,3
  ,A-X,=1
  7,ATX,WORK1
  ,ARX,B16
  ,AAX,B18
  ,U1A,WRIW.C MЛ
  7,XTA,WORK1
  ,AAX,=77 0037
  7,ATX,WORK1
  WRIW:,BSS,
  7,XTA,I60/74
  ,AAX,C77777.CЧ ПO ЛИCTY
  7,ATX,I60/74.B 9 И.P.
  7,XTA,WORK1
  ,APX,=3 77 1777
  7,AOX,I60/74
  7,ATX,I60/74
  READ/1:,BSS,
C     ПOXOД ЗA ЛИCTOM
C     И ЧTEHИE
  ,ITA,
  7,ATX,E/FLAG
  14,VJM,TO MEMORY
  14,VJM,OБMEH
  ,UJ,BEG/E
  NO FIRST:,BSS,
  7,XTA,I60/74
  ,ASN,64+15
   ,ATI,9
  14,VJM,TO MEMORY
  BEG/E:,BSS,
  7,XTA,R14
  ,UZA,REFUSE.,*60,0
  ,ATI,10
  14,VTM,*2/1
  9,VZM,NEW LIST
  *2/1:,24,
  8,UTC,
  9,XTA,1024
   :    ,24,3
  ,AEX,COD
  ,U1A,HET KAPT
  9,UTM,1
  12,VTM,-23
C     ПEPEПИCЬ KAPTЫ
  TRCA:,BSS,
  14,VTM,*2/3
  9,VZM,NEW LIST
  *2/3:,24,
  8,UTC,
  9,XTA,1024
   :    ,24,3
  7,WTC,R27
   :    ,24,
  10,UTC,
  12,ATX,23
   :    ,24,3
  9,UTM,1
  12,VLM,TRCA
  7,WTC,R27
   :    ,24,
  10,XTA,
   :    ,24,3
  ,AEX,ДK
  ,UZA,DISPEND
  END:12,VJM,OFFMEM
  ,UJ,EXIT
  DISPEND:,BSS,
  12,VTM,-22
  IFZERO:,BSS,
  7,WTC,R27
   :    ,24,
  10,UTC,
  12,XTA,23
   :    ,24,3
  ,U1A,END
  12,VLM,IFZERO
  *DK:,BSS,
C     ПOДCOBЫBAEM ДИCП.KOHEЦ.
  14,VTM,-23
  ,XTA,B40
  TRDE:7,WTC,R27
   :    ,24,
  10,UTC,
  14,ATX,23
   :    ,24,3
  14,VLM,TRDE
  ,ITA,
  7,ATX,R14
  ,UJ,END
  HET KAPT:7,XTA,E/FLAG
  ,AEX,B47
  7,ATX,E/FLAG
  ,U1A,*DK
C    BINARY-KAPTЫ ДABHO
C    KOHЧИЛИCЬ
C     ПOДГOTOBKA K ПOXOДY HA
C     ERRMACRO
  12,VJM,OFF MEM
   :    ,24,2003B
  14,VTM,AC-R7
  TRSAV:,BSS,
  7,UTC,AC
  14,XTA,R7
  7,UTC,
  14,ATX,R7
  14,VLM,TRSAV
  ,WTC,ГYC
  15,VTM,R12
  ,STI,
  14,VJM,BOCИПД
  14,VTM,ERRTEXT
  ,UJ,ERRMACRO
C======================================
  EXIT:,BSS,
C     BOCCTAHOBЛEHИE PEГИCTPOB
C     И BЫXOД
   :    ,24,2003B
  ,WTC,ГYC
  15,VTM,R1*2-LR
  14,VTM,LR-12
  ,STI,
  //:14,STI,12
  14,VLM,//
  14,VTM,RETURN
  ,UJ,BOCИПД
C.....................................
  REFUSE:,BSS,
C     OTKAЗ OT HEPEЗИДEHTA
  12,VJM,OFFMEM
  ,ITA,13
  ,ARX,IW/REF
  ,UJ,NRESOFF
  IW/REF:,Z00,NRS60*
  ,Z00,EXIT-B
C======================================
C     ПOДПPOГPAMMЫ ДЛЯ OБЛEГЧEHИЯ
C               ЖИЗHИ
C======================================
  TO MEMORY:,BSS,
C
C     П/П ПOИCKA ДOCTATOЧHO YДAЛEHHOГO
C     OT AИCП  ,*60,  MAT.ЛИCTA И
C     ПEPEKИДЫBAHИЯ TYДA 45 ФOPM.ЛИCTA
C     HA BЫXOДE ИMEEM:
C     I8=AHAЧ ЛИCTA; CYMMATOP=IW70-
C     -ИHФ.CЛOBO ЧTEHИЯ B ЭTOT ЛИCT
C                  BЫXOД ПO I14
  7,XTA,R14
  ,AAX,B15
  ,AEX,B15
  ,AOX,=34000.16 ЛИCT
  ,ATI,8
  ,ASN,64-26
   ,AOX,=:10 0045 77
  7,ATX,IW72
  ,ITA,14
  7,ATX,WORK1
 7,XTA,SCEM
 ,AAX,B25
 7,AOX,R9
 7,ATX,R9
 ,AAX,B25
 7,AEX,SCEM
 7,ATX,SCEM
  14,VTM,13B
  14,MTJ,27B
  7,*72,IW72
  7,XTA,I60/74
  ,AUX,=3 77 1777
  ,AOX,B40
  7,ATX,IW70
  7,XTA,IW72
  ,AAX,=:0077
  ,ASN,64+6
  7,AOX,IW70
  7,ATX,IW70
  7,WTC,WORK1
  ,UJ,
C======================================
  OБMEH:,BSS,
C........ 14,VJM,OБMEH ............
   :    ,24,2003B
  14,MTJ,32B
  14,VTM,13B
  14,MTJ,27B
  ,ITA,27B
  7,ATX,S27/70
  7,XTA,IW70
  ,UJ,MACRO70S
C======================================
  NEWLIST:,BSS,
C     П/П ЧTEHИЯ CЛEДYЮЩEГO TPAKTA
C     (ЗOHЫ) И ПEPEHACTPOЙKИ YKA-
C     ЗATEЛEЙ , T.E.I9 И IW70
C........... 14,VJM,NEWLIST ...........
C
  7,XTA,IW70
  ,ARX,B1
  7,ATX,IW70
  ,ARX,B16
  ,AAX,B18
  ,U1A,ML/READ.MЛ OБMEH
  7,XTA,IW70
  ,ARX,C7740
  ,AOX,C7740
  ,AEX,C7740
  7,ATX,IW70
  NL/1:9,VTM,-1024
  ,UJ,OБMEH
  ML/READ:7,XTA,IW70
  ,UJ,NL/1
C======================================
  OFFMEM:,BSS,
C     П/П ПEPEKИДЫBAHИЯ ЛИCTOB
C     И 'OБHOBЛEHИЯ' I60/74
C     ПEPEД BЫXOДOM
C             ....... 12,VJM,OFFMEM ...
C
  14,VTM,13B
  14,MTJ,27B
  7,*72,IW72
  7,XTA,I60/74
  ,AAX,C77777
  7,ATX,I60/74
  7,XTA,IW70
  ,AAX,=77 7777
  ,APX,=3 77 1777
  7,AOX,I60/74
  7,ATX,I60/74
  ,ITA,9
  ,ASN,64-15
  7,AOX,I60/74
  ,AOX,B48
  ,AEX,B48
  7,AOX,E/FLAG
  7,ATX,I60/74
 7,XTA,R9
 ,AAX,B25
 7,AOX,SCEM
 7,ATX,SCEM
  12,UJ,
C=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=
C        KOHCTAHTЫ
C
  COD:,LOG,77751
  C7740:,LOG,7740
C   ЭTY KOHCTAHTY MOЖHO MEHЯTЬ
  ДK:,OCT,0005 3644 1245 3400.
C       $ДK$(BMECTO ДИCП.KOHЦA;YПП)
C
  ERRTEXT:,GOST,10HMAЛO KAPT'231'
  ,END,
 YBBKNRS:,NAME,.
C*********   OCHOBHAЯ 4ACTЬ ЭKCTPAKOДA BBOДA
C
C
  *TAKCA:LC,BLOCK,(3),EД BPEM
 SELECT:,SUBP,.
 FSBASENR:LC,BLOCK,BBL,(1).
 NRSINPUT:,SUBP,
 FULSAV  :  ,SUBP,
 RETURN  :  ,SUBP,
 CLTASK  :  ,SUBP,
 PERMIR  :  ,SUBP,
 CLOMIR  :  ,SUBP,
 NEWTA   :  ,SUBP,
 CL OPER:,SUBP,
 TTPRINT :  ,SUBP,
 ERRPRI  :  ,SUBP,
 MACRO74 :  ,SUBP,
 TA1M60:,SUBP,.
 TA2M60:,SUBP,.
C
C...  MACCИBЫ, COBMEЩEHHЫE CO STARTDD
C
  STARTDD:,SUBP,
  BUF1M60:,EQU,STARTDD
  BUF2M60:,EQU,BUF1M60+25
  IF1M60:,EQU,BUF1M60+1
  IF2M60:,EQU,BUF2M60+1
  БYФHБЩ:,EQU,BUF2M60+25
  БYФBБЩ:,EQU,БYФHБЩ+24
  CBOБOДHO:,EQU,БYФBБЩ+168
C
 M:,EQU,100B.
 XPMS27:,EQU,M+4.
 MOFFNRS:,LC,1.
 KЛЮЧCЧBP:,LC,1.
 SCALES:LC,BLOCK,PRT MASK,(2)
  ,CONT,(2),SC/YBBK
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 FULWOR  :  ,LC,1
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 SMASAV:LC,BLOCK,
            ,CONT,      SAVAC
            ,CONT,      SAVSR
            ,CONT,      SAVAR
            ,CONT,      SAVI15
            ,CONT,      SAVI14
            ,CONT,      SAVI13
            ,CONT,      SAVMIR
            ,CONT,      SAVS16
 CORRADR :  ,SUBP,
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,(2),M1RDSC,STCLTA.
 XPM:I,BLOCK,XPM15,XPM14,XPM13,XPM26,XPM23,AБYФM
 C77357:,LC,1.
 C13:,LC,1
 DISREG:LC,BLOCK,C2013
 BISTIME:,EQU,110B
 БAЗAПPИЗ:LC,BLOCK,(1),AKЖПM,З1BШГ
 ,CONT,БЫЛ ДK,BЫKЛ Д,БЫЛA KП
 ,CONT,ЗB CBOЯ,ЗB ЗAHЯTA,KЖПM
 ,CONT,CЧKЖПM,HOMEP BY
 ,CONT,CЧПPOПK,ЧПCTPOK
 ,CONT,AПBБЩ,AПHБЩ
 ,CONT,TPЗ2OTЗ1,KПOДBБЩ
 ,CONT,KПOДHБЩ,AKЖOБPЗ1
 ,CONT,BY HE PAБ,PЯЗ1,CЧ OШ K
 ,CONT,CЧ KBЫKBY,CБOЙ BY
 ,CONT,HET KAPT,ПPOД
 C77777:,LC,1
  C777:LC,BLOCK,TPИ 777
 I7:,EQU,15.
 OUTMACRO:,SUBP,
 EFSMNRS:,SUBP,.
 CLANEWTA:,SUBP,.
 ЗAKPЗM:,EQU,CLANEWTA.
 B:,EQU,EFSMNRS.
 NRESOFF:,SUBP,.
 ADOFACC:LC,BLOCK,(2),SNTINFSM,(1)
 SNT1:,EQU,12B.ДHЗ TA1M60
 SNT2:,EQU,23B.ДHЗ TA2M60
 IF1O:,EQU,IF1M60-B.ИПЗ 1 OTH.
 IF2O:,EQU,IF2M60-B.ИПЗ 2 OTH.
 *STATBUF:LC,BLOCK,(7),CTAT BB.
 13,REL,B.
 C14:,LC,1
 ,XTA,SAVI13.
 ,ATX,RET13/7.
            ,  XTA  , ЗBЗAHЯTA      .
            ,  U1A  , ЗB ЗAH Э      .
          14,  VZM  , A Э 0         .
 ,ATX,MOFFNRS.
            ,  XTA  , Д H З         .
            ,  ATX  , ЗBЗAHЯTA      .
            ,  ATX  , ЗB CBOЯ       .
 ,XTA,AБYФBБЩ
 ,ARX,BBL.
            ,  ATX  , AKЖПM         .
            ,  XTA  ,               .
   ,ATX,CБOЙ BY.
            ,  ATX  , БЫЛ ДK        .
            ,  ATX  , БЫЛA K П      .
            ,  ATX  , KЖПM          .
            ,  XTA  ,BIT3           .
            ,  ATX  , BЫKЛ Д        .
 A Э HE 0:,BSS,.
 ,XTA,SAVI14.
 ,ATX,AБYФM.
            ,  ITA  , 32B           .
 ,ATX,XPM26
 ,ITA,27B.
 ,ATX,XPM23.
          14,  VTM  , CONMAC60      .
          14,  MTJ  , 33B           .
 ,XTA,DISREG.
            ,  ATI  , 27B           .
            ,  XTA  , HETKAPT       .
            ,  U1A  , BЫX AЦПY      .
            ,  XTA  ,BIT30          .
            ,  AOX  , RDSCAL        .
            ,  ATX  , RDSCAL        .
 ,XTA,C2013
C   ПOДГOTOBKA PEЖИMA ДЛЯ ЗAДAЧ BBOДA.
 13,ATX,IF1O+5
 13,ATX,IF2O+5
 ,ITA,13.
C   БAЗA ДЛЯ ЗAДAЧ B ИX 7-OЙ MOДИHИKATOP.
 13,ATX,IF1O+I7
 13,ATX,IF2O+I7
 ,ATX,SAVI13.
C   HOPMИPOBKA BXOДOB ДЛЯ ЗAДAЧ.
 ,ARX,BEG1M60.
 13,ATX,IF1O+3
 ,ITA,13.
 ,ARX,BEG2M60.
 13,ATX,IF2O+3
C   BCTABKA B *YCЫ CCЫЛOK HA ИПЗ
C   ПEPBOЙ И BTOPOЙ ЗAДAЧ BBOДA.
 ,ITA,13.БAЗA
 ,ARX,FOR*YC1.ЗAГOTOBKA YCA 1
 ,ATX,*YCЫ+SNT1
 ,ITA,13
 ,ARX,FOR*YC2
 ,ATX,*YCЫ+SNT2
 13,VTM,NEWTA
 ,UJ,CL OPER
 A Э 0:,BSS,.
 ,WTC,BBL.
 13,VTM,.
 ,WTC,Г Y C.
 ,XTA,XPMS27.
 ,AAX,C77357.
 ,ATI,27B.
 ,XTA,SNTINFSM.
 ,U1A,M60RET.
 ,ITA,13
 ,ARX,INFFORRT.
 ,UJ,NRESOFF.
 M60RET:,BSS,
 ,XTA,RET13/7.
 ,ATX,SAVI13
 ,ATX,SAVAC
 ,UJ,OUTMACRO
 ЗB ЗAH Э:  ,  AEX  , Д H З         .
            ,  UZA  , Э TOЙЖEЗ      .
 14,VZM,A Э 0.
          15,  VTM  , TTEKCT        .
            ,  ITA  , 15            .
          14,  VTM  , MACRO74       .
            ,   UJ  , TTPRINT       .
 Э TOЙЖEЗ:14,  V1M  , A Э HE 0      .
 ,XTA,KЛЮЧCЧBP.
 ,UZA,A Э 0 /1.
 ,XTA,ЗB ЗAHЯTA.
 ,ATX,MOFFNRS.
 ,XTA,DISREG.
 ,ATI,27B.
 ,ITA,13.
 ,ATX,SAV I13.
 14,VTM,A Э 0 /1.
 14,MTJ,33B.
 ,UJ,CLANEWTA.
 A Э 0 /1:,BSS,.
 ,XTA,.
 ,ATX,ЗBЗAHЯTA.
 ,ATX,HETKAPT.
 ,UJ,A Э 0.
C         BTOPAЯ ЧACTЬ ЭKCTPAKOДA BBOДA
 CONMAC60:  ,  ITA  , 15            .
          15,  VTM  , XPM15         .
            ,  ITS  , 14            .
 ,XTS,RET13/7.
            ,  XTS  ,               .
 ,ITA,7.
 13,MTJ,7.
 ,WTC,RET13/7.
 13,VTM,.
 7,REL,B.
 ,ATX,RET13/7.
 ,XTA,AБYФM.
            ,  ATI  , 13            .
 ,XTA,AKЖПM.
            ,  ATI  , 14            .
          15,  VTM  , 77751B        .
 ,XTA,SC/YBBK
  ,AAX,ZBITJ
 ,ATX,SC/YBBK.
 ПEPECЫЛ :  ,   24  , 00003B        .*****
          14,  XTA  ,               .
 ,WTC,XPM23.
   :              ,   24  ,               .
          13,  ATX  ,               .
          13,  UTM  , 00001B        .
          14,  UTM  , 00001B        .
          15,  VLM  , ПEPECЫЛ       .
   :              ,   24  , 00003B        .
 ,WTC,ГYC
 ,XTA,BISTIME
 ,A+X,EД BPEM
 ,WTC,ГYC
 ,ATX,BISTIME
   :              ,   24  , 02003B        .
 ,XTA,BIT1.CЧETЧИK
 ,WTC,HOMEPBY.BBEДEHHЫX
 ,ARX,CTAT BB.KAPT
 ,WTC,HOMEPBY.B CTATИCTИKY
 ,ATX,CTAT BB.
            ,  ITA  , 14            .
 7,UTC,
 13,VJM,CORRADR-B
C          KOPPEKЦИЯ AДPECA KAPTЫ ЖДYЩEЙ ПPИEMA MATEMATИKOM
 ,ATX,AKЖПM.
 ,XTA,KЖПM.
            ,  ARX  , TPИ 777       .
            ,  AAX  , TPИ 777       .
C        MИHYC 1 ИЗ ЧИCЛA KAPT ЖДYЩИX ПPИEMA MATEMATИKOM
 ,ATX,KЖПM.
 ,XTA,CЧ KЖПM.
            ,  ARX  , TPИ 777       .
            ,  AAX  , TPИ 777       .
 ,ATX,CЧ KЖПM.
 15,VTM,XPM+5.
            ,  STX  ,               .
 ,STI,27B.
            ,  STI  , 33B           .
 ,STX,SAVI13
 ,STX,SAVI14
 ,ATX,SAVI15
 ,XTA,RET13/7
 ,ATI,7.
 ,UJ,RETURN
C
C          TEKCT BY ЗAHЯTO
  TTEKCT:,BSS,
  ,ISO,12HBY ЗAHЯTO''''''
  BЫX AЦПY:14,VJM,ERRPRI
 ,GOST,12H HET KAPT'231'
 AБYФBБЩ:,Z00,
 ,Z00,БYФBБЩ-B.
 BEG1M60:, ,
 ,Z00,TA1M60-B.
 BEG2M60:, ,
 ,Z00,TA2M60-B.
 INFFORRT:,BSS,.
 ,Z00,NRSINPUT
 ,Z00,M60RET-B.
 FOR*YC1:2,20,
 ,Z00,IF1O
 FOR*YC2:4,30,
 ,Z00,IF2O
  XPM:,BSS,6
 RET13/7:,BSS,1
 ,END,
 ПPEPKAPT:  ,NAME,
 SELECT  :  ,SUBP,
 FULSAV  :  ,SUBP,
 CLTASK  :  ,SUBP,
 RETURN:,SUBP,.
 PERMIR  :  ,SUBP,
 CLOMIR  :  ,SUBP,
 NEWTA   :  ,SUBP,
 TTPRINT :  ,SUBP,
 ERRMACRO:  ,SUBP,
 MACRO74 :  ,SUBP,
 CORRADR :  ,SUBP,
 STARTJOB:,SUBP,.
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 FULWOR  :  ,LC,1
 Д H З   :  ,LC,1
  C3:,LC,1
  C5:,LC,1
  C7:,LC,1
  K3:,EQU,C3
  K5:,EQU,C5
  K7:,EQU,C7
 SMASAV:LC,BLOCK,
            ,CONT,      SAVAC
            ,CONT,      SAVSR
            ,CONT,      SAVAR
            ,CONT,      SAVI15
            ,CONT,      SAVI14
            ,CONT,      SAVI13
            ,CONT,      SAVMIR
            ,CONT,      SAVS16
 YBBK    :  ,LC,1
 PAПPEP  :  ,LC,1
 KOHK    :  ,LC,1
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,(2),M1RDSC,STCLTA.
 BPEMЯ BY:,LC,1
 ПYCT K:,LC,1
 K BCE EД:,LC,1
 KЛЮЧCЧBP:,LC,1
 БAЗAПPИЗ:LC,BLOCK,(1),AKЖПM,З1BШГ
 ,CONT,БЫЛ ДK,BЫKЛ Д,БЫЛA KП
 ,CONT,ЗB CBOЯ,ЗB ЗAHЯTA,KЖПM
 ,CONT,CЧKЖПM,HOMEP BY
 ,CONT,CЧПPOПK,ЧПCTPOK
 ,CONT,AПBБЩ,AПHБЩ
 ,CONT,TPЗ2OTЗ1,KПOДBБЩ
 ,CONT,KПOДHБЩ,AKЖOБPЗ1
 ,CONT,BY HE PAБ,PЯЗ1,CЧ OШ K
 ,CONT,CЧ KBЫKBY,CБOЙ BY
 ,CONT,HET KAPT,ПPOД
 MOFFNRS:,LC,1.
 FFPT:,LC,1
 STARTFSM:,SUBP,
 EFSMNRS:,SUBP,
 FSBASENR:,LC,1
 BAS:,EQU,EFSMNRS.
 *STATBUF:LC,BLOCK,(7),CTAT BB.
 B:,EQU,7.
C
C......   BXOДЫ ИЗ EXTINTER.
C
C         HAЧ. KAPTЫ BY700 И KOHEЦ YBBK.
 :13,VTM, .HOMEP BY
 15,VTM,H700KY-BAS.KYДA ИДTИ
 ,WTC,FSBASENR
 ,UJ,SAVAGO-BAS.CПAC И YCT B
 :13,VTM,1.HOMEP BY
 15,VTM,H700KY-BAS.KYДA ИДTИ
 ,WTC,FSBASENR
 ,UJ,SAVAGO-BAS.CПAC И YCT B
C         CИ BY 700.
 :13,VTM, .HOMEP BY
 15,VTM,CИBY700-BAS
 ,WTC,FSBASENR
 ,UJ,SAVAGO-BAS.CПAC И YCT B
 :13,VTM,4.HOMEP BY
 15,VTM,CИBY700-BAS
 ,WTC,FSBASENR
 ,UJ,SAVAGO-BAS.CПAC И YCT B
C         CИ YBBK И HAЧ. KAPTЫ YBBK.
 :13,VTM, .HOMEP BY
 15,VTM,HKИCИ-BAS
 ,WTC,FSBASENR
 ,UJ,SAVAGO-BAS.CПAC И YCT B
 :13,VTM,4.HOMEP BY
 15,VTM,HKИCИ-BAS
 B,REL,BAS
  SAVAGO:,BSS,
C         CПACEHИE 7 ИHД. И YCTAHOBKA БAЗЫ.
 ,ITA,7
 ,WTC,FSBASENR
 7,VTM,
 ,ATX,SAVEI7C
 7,UTC,
 15,UJ,
C
C         HAЧAЛO KAPTЫ BY700 И KOHEЦ YBBK
C
 H700KY:,BSS,
            ,  XTA  , YBBK          .
            ,  U1A  , KOHKYBBK      .
 ,ATX,CBK1
 ,ATX,CBK2
 ,ATX,BPEMЯ BY.
 ,ATX,PЯ.
            ,  XTA  , ЗB CBOЯ       .
 ,UZA,RESET
            ,  XTA  , БЫЛA K П      .
            ,  U1A  , BЫKЛBY        .
            ,  XTA  , БЫЛ ДK        .
 ,U1A,ГAШKЛЮЧA.
            ,  XTA  , CЧKBЫKBY      .
            ,  UZA  , HETKOHПK      .
            ,  AEX  ,BIT3           .
            ,  UZA  , KOHПK         .
            ,  XTA  , CЧKBЫKBY      .
            ,  ARX  ,BIT1           .
            ,  ATX  , CЧKBЫKBY      .
 HETKOHПK:  ,  XTA  , CЧПPOПK       .
            ,  U1A  , CЧK           .
            ,  XTA  , K5            .
          13,  EXT  , 00150B        .
 CЧK     :  ,  XTA  , CЧПPOПK       .
            ,  ARX  ,BIT1           .
            ,  ATX  , CЧПPOПK       .
            ,  NTR  , 00003B        .
            ,  A-X  , K3            .
            ,  ATX  , KПOДHБЩ       .
            ,  U1A  , RESET        .
            ,  XTA  , BЫKЛ Д        .
            ,  ATI  , 14            .
          14,  UTM  , 77775B        .
            ,  ITA  , 14            .
            ,  ATX  , KПOДBБЩ       .
            ,  XTA  , COMPIR        .
          13,  AEX  ,BIT22          .
          13,  AOX  ,BIT24          .
 ,ATX,KЛЮЧCЧBP
            ,  ATX  , COMPIR        .
            ,  EXT  , 00034B        .
          13,  XTA  ,BIT24          .
            ,  AEX  , FULWOR        .
            ,  EXT  , 00030B        .
          14,  VTM  , 77765B        .
            ,  ITA  , 14            .
            ,  ATX  , ЧПCTPOK       .
 RESET:,BSS,.
 ,WTC,SAVEI7C.
 7,VTM,.
 ,UJ,RETURN.
 KOHПK   :  ,  XTA  , CЧKЖПM        .
            ,  ATX  , KЖПM          .
   ,XTA,CБOЙ BY.
 ,U1A,ЗAKPM
 ,ATX,BPEMЯ BY.
 ,ATX,KЛЮЧCЧBP.
 ЗAKPM:15,VJM,BЫKЛ.
 ,XTA,.
  ,WTC,HOMEP BY
  ,EXT,150B
            ,  XTA  , TPЗ2OTЗ1      .
            ,  UZA  , RESET        .
            ,  XTA  , RDSCAL        .
            ,  AOX  ,BIT30          .
            ,  ATX  , RDSCAL        .
            ,  XTA  ,               .
            ,  ATX  , TPЗ2OTЗ1      .
 YПPЯTBЫБ:,BSS,.BЫXOД HA NEWTA
 ,WTC,SAVEI7C.
 7,VTM,.
 ,UJ,NEWTA.
 ПOДГГAШM:  ,  XTA  ,BIT3           .
            ,  ATX  , BЫKЛ Д        .
          13,  XTA  ,BIT24          .
          13,  AOX  ,BIT22          .
 ГAШMПPП :  ,  AEX  , FULWOR        .
            ,  AAX  , COMPIR        .
            ,  ATX  , COMPIR        .
            ,  EXT  , 00034B        .
          14,  U1A  ,               .
            ,  XTA  ,BIT37          .
          14,  MTJ  , 13            .
            ,   UJ  , CLOMIR        .
 KOHEЦBB:,BSS,.
 ,XTA,.
   ,ATX,ЗB CBOЯ.
 BЫKЛBY:,BSS,.
 15,VTM,RESET.
 ,XTA,YBBK.
 ,UZA,BЫKЛ.
 ,XTA,.
 ,ATX,З 1 B ШГ.
 BЫKЛ:,BSS,.
C         ПPOBEPKA HE БЫЛ ЛИ BЫДAH
C         ЭKCTPAKOД 60 C AДPECOM = 0
 ,XTA,MOFFNRS.
 ,UZA,NOREL.
 ,ATI,14.
 ,ITA,.
 ,ATX,MOFFNRS.
 ,XTA,RDSCAL.
 14,AOX,BITS.
 ,ATX,RDSCAL.
 ,XTA,YBBK.
 ,UZA,NOREL.
 15,VTM,YПPЯTBЫБ.
 NOREL:,BSS,.
 ,XTA,YBBK.
            ,  U1A  , BЫKЛYBBK      .
          13,  EXT  , 00150B        .
 15,MTJ,14
            ,   UJ  , ПOДГГAШM      .
 AYT:  ,ATX,BYHEPAБ
 15,VTM,RESET.
 BЫKЛYBBK:  ,  XTA  ,BIT2           .
          13,  EXT  , 00150B        .
            ,  XTA  ,BIT3           .
            ,  ATX  , BЫKЛ Д        .
          13,  XTA  ,BIT44          .
          13,  MTJ  , 14            .
          13,  VJM  , CLOMIR        .
          14,  MTJ  , 13            .
 15,MTJ,14.
 ПOДГГAШ :13,  XTA  ,BIT22          .
            ,   UJ  , ГAШMПPП       .
  PCБOЙBY:,LOG,1000 0000
 :,LOG,40 0000
 KOHKYBBK:,BSS,
 ,EXT,4102B
 13,AAX,PCБOЙBY
 ,U1A,HEXBATCИ
 ,XTA,KOHK
 ,U1A,HEXBATCИ
 OTKPЗ1:,BSS,.
            ,  XTA  , RDSCAL        .
            ,  AOX  ,BIT39          .
            ,  ATX  , RDSCAL        .
            ,  ATX  , З1 B ШГ       .
            ,  XTA  , BЫKЛ Д        .
            ,  UZA  , YПPЯTBЫБ      .
            ,  ARX  ,BIT1           .
            ,  ATX  , BЫKЛ Д        .
            ,  AEX  , K3            .
            ,  U1A  , ECTЬЛИKB      .
            ,  XTA  ,BIT2           .
          13,  EXT  , 00150B        .
            ,   UJ  , YПPЯTBЫБ      .
 HEXBATCИ:,BSS,.
  ,XTA,BIT1
   ,ATX,CБOЙ BY.
   ,ATX,CЧ OШ K.
 14,VTM,CБOЙYBBK.
 ,ITA,14.
 ,ATX,PAПPEP
 ,XTA,BIT2.
   ,ATX,BЫKЛ Д
 14,VTM,OTKP З1
 ,UJ,ПOДГГAШ.
 CБOЙYBBK:,BSS,.
 ,XTA,BIT1
   ,ARX,CЧ OШ K.
   ,ATX,CЧ OШ K
   ,XTA,HOMEP BY.
 ,ATI,13
 ,UJ,AYT.
 ECTЬЛИKB:  ,  AEX  , K7            .
            ,  U1A  , YПPЯTBЫБ      .
   ,XTA,CБOЙ BY.
 ,U1A,ЗAKP
 ,ATX,BPEMЯ BY.
 ,ATX,KЛЮЧCЧBP.
 ЗAKP:15,VTM,YПPЯTBЫБ.
 ,UJ,BЫKЛ.ЗAKPЫTИE ПPEPЫBAHИЙ
 CИBY700:,BSS,
            ,  XTA  , ЗB CBOЯ       .
 ,UZA,RESET
   ,XTA,CБOЙ BY.
 ,U1A,ПPOBПOЛK
            ,  XTA  , З1 B ШГ       .
            ,  U1A  , ПPEPЗB1       .
 ПPOBПOЛK:,BSS,.
            ,  XTA  , KПOДBБЩ       .
 ,UZA,AHAЛИЗEД
            ,  XTA  , AПBБЩ         .
            ,  ATI  , 15            .
          13,  EXT  , 04142B        .
          15,  ATX  ,               .
          13,  EXT  , 04143B        .
            ,  ASN  ,64-20          .
          15,  AOX  ,               .
          15,  ATX  ,               .
 ,ACX,CBK1.
 ,ATX,CBK1
          13,  EXT  , 04140B        .
          15,  ATX  ,               .
          13,  EXT  , 04141B        .
            ,  ASN  ,64-20          .
          15,  AOX  ,               .
          15,  ATX  ,               .
 ,ACX,CBK1.
 ,ATX,CBK1
            ,  ITA  , 15            .
            ,  ATX  , AПBБЩ         .
            ,  XTA  , KПOДHБЩ       .
            ,  UZA  , CЧCTPOK       .
 CЧИTHБЩ :  ,  XTA  , AПHБЩ         .
            ,  ATI  , 15            .
          13,  EXT  , 04152B        .
          15,  ATX  ,               .
          13,  EXT  , 04153B        .
            ,  ASN  ,64-20          .
          15,  AOX  ,               .
          15,  ATX  ,               .
 ,ACX,CBK2
 ,ATX,CBK2
          13,  EXT  , 04150B        .
          15,  ATX  ,               .
          13,  EXT  , 04151B        .
            ,  ASN  ,64-20          .
          15,  AOX  ,               .
          15,  ATX  ,               .
 ,ACX,CBK2
 ,ATX,CBK2
            ,  ITA  , 15            .
            ,  ATX  , AПHБЩ         .
 CЧCTPOK :  ,  XTA  , ЧПCTPOK       .
            ,  ATI  , 15            .
          15,  VLM  ,L16460         .
            ,  ITA  , 13            .
            ,  ASN  ,64+2           .
            ,  ATI  , 15            .
            ,  XTA  , YBBK          .
 ,UZA,ПPOCMOTP
            ,  XTA  , AПBБЩ         .
            ,  ARX  ,BIT3           .
            ,  ATX  , AПBБЩ         .
 ПPOCMOTP:,BSS,.
 ,XTA,YBBK.
 ,U1A,CMKYBBK.
   ,XTA,KПOДHБЩ.
 ,U1A,CMKBY700.
 ,XTA,CBK1.
 ,ATX,CTAPCB.
 ,UJ,CMEHA A
 CMKBY700:,BSS,
 ,XTA,CBK2.
 ,ARX,CTAPCB.
 ,ATX,CBK2
 ,XTA,CBK1
 ,ATX,CTAPCB.
 ,XTA,CBK2.
 ,UZA,YПYCTK
 ,NTR,3 .
 ,A-X,Z1800.
 ,UZA,BCE EД.
 ,UJ,CMEHA A.
 CMKYBBK:,BSS,.
 ,XTA,CBK2
 ,U1A,CMEHA A.
 ,UJ,YПYCTK
 BCE EД:,BSS,.
 ,XTA,BIT1
 ,ATX,K BCE EД
 YПYCTK:,XTA,BIT1.
 ,ATX,ПYCT K.
 CMEHA A:  ,XTA,AПBБЩ
 7,UTC,
 13,VJM,CORRADR-BAS
            ,  ATX  , AПBБЩ         .
  15,MTJ,13
            ,  XTA  , YBBK          .
            ,  U1A  , KOHCYBBK      .
C
C         AHAЛИЗ БЫЛA ЛИ ЛИШHЯЯ ПPOTЯЖKA
C
   ,XTA,KПOДBБЩ
 ,UZA,AHAЛИЗCБ
 AHAЛИЗOШ:,BSS,
   ,XTA,CБOЙ BY.
 ,U1A,CЧET OШ
 ГAШKOПM:,BSS,.
            ,  XTA  , COMPIR        .
          13,  AEX  ,BIT24          .
          13,  AOX  ,BIT22          .
            ,  ATX  , COMPIR        .
            ,  EXT  , 00034B        .
          13,  XTA  ,BIT22          .
            ,  AEX  , FULWOR        .
            ,  EXT  , 00030B        .
            ,  XTA  , KПOДHБЩ       .
            ,  UZA  , YПPЯTBЫБ      .
            ,  XTA  , RDSCAL        .
            ,  AOX  ,BIT39          .
            ,  ATX  , RDSCAL        .
            ,  ATX  , З1 B ШГ       .
            ,  XTA  , BЫKЛ Д        .
            ,  UZA  , YПPЯTBЫБ      .
            ,  ARX  ,BIT1           .
            ,  ATX  , BЫKЛ Д        .
 ,XTA,BIT3.
          13,  EXT  , 00150B        .
            ,   UJ  , YПPЯTBЫБ      .
 KOHCYBBK:14,VTM,HAЧK.
 ,ITA,14.
            ,  ATX  , PAПPEP        .
          14,  VTM  , 77755B        .
            ,  XTA  ,               .
            ,  ATX  , KOHK          .
  ,ITA,14
  HARET:,ATX,ЧПCTPOK
            ,   UJ  , RESET        .
 L16460  :  ,  ITA  , 15            .
  ,UJ,HARET
 ПPEPЗB1:,BSS,
 ,XTA,BIT1.
   ,ATX,CБOЙ BY.
   ,ATX,BЫKЛ Д
   ,ATX,CЧ OШ K
 ,XTA,BIT2.
   ,ATX,CЧKBЫKBY.
 ,UJ,ПPOBПOЛK.
 AHAЛИЗEД:,BSS,
C
C         ПPOBEPKA HET ЛИ ЛИШHEЙ ПPOTЯЖKИ KAPTЫ.
C
 13,EXT,4142B
 ,ACX,PЯ
 ,ATX,PЯ
 13,EXT,4143B
 ,ACX,PЯ.
 ,ATX,PЯ.
 13,EXT,4140B
 ,ACX,PЯ
 ,ATX,PЯ.
 13,EXT,4141B.
 ,ACX,PЯ.
 ,ATX,PЯ.
 ,UJ,CЧИTHБЩ
 AHAЛИЗCБ:,BSS,.
 ,XTA,PЯ.
 ,NTR,3
 ,A-X,Z900
 ,UZA,AHAЛИЗOШ
 ,XTA,BIT1.
   ,ARX,CЧ OШ K.
   ,ATX,CЧ OШ K.
   ,XTA,CБOЙ BY.
 ,UZA,ГAШKOПM
 CЧET OШ:,BSS,.
 ,XTA,K BCE EД
 ,U1A,ГAШKOПM
 ,XTA,BIT1
   ,ARX,CЧ OШ K.
   ,ATX,CЧ OШ K.
 ,UJ,ГAШKOПM
 HKИCИ:,BSS,
            ,  XTA  ,               .
 ,ATX,BPEMЯ BY
            ,  WTC  , PAПPEP        .
            ,   UJ  ,               .
 HAЧ K:,ENTRY,
 HAЧK:,BSS,.
            ,  XTA  ,BIT1           .
            ,  ATX  , KOHK          .
            ,  ITA  , 13            .
            ,  ASN  ,64+2           .
            ,  ATI  , 13            .
            ,  XTA  ,BIT4           .
          13,  EXT  , 00150B        .
            ,  XTA  , БЫЛA K П      .
            ,  U1A  , BЫKЛBY        .
            ,  XTA  , БЫЛ ДK        .
 ,U1A,ЗAKP ЗB1
 ,ATX,CBK2.
 14,VTM,ПPEPCИ1.
 ,ITA,14.
            ,  ATX  , PAПPEP        .
            ,   UJ  , RESET        .
 ЗAKP ЗB1:,XTA,RDSCAL
            ,  AEX  ,BIT39          .
            ,  ATX  , RDSCAL        .
 ,UJ,ГAШKЛЮЧA
 ПPEPCИ1 :13,  EXT  , 04150B        .
            ,  ASN  ,64-24          .
            ,  WTC  , AПBБЩ         .
            ,  ATX  ,               .
 14,VTM,ПPEPCИ2.
 ,ITA,14.
            ,  ATX  , PAПPEP        .
            ,  ITA  , 13            .
            ,  ASN  ,64+2           .
            ,  ATI  , 15            .
            ,  XTA  ,BIT4           .
          15,  EXT  , 00150B        .
            ,   UJ  , RESET        .
 ПPEPCИ2:13,EXT,4150B
            ,  WTC  , AПBБЩ         .
            ,  AOX  ,               .
            ,  WTC  , AПBБЩ         .
            ,  ATX  ,               .
 ,ACX,CBK2.
 ,ATX,CBK2
            ,  XTA  , AПBБЩ         .
            ,  ARX  ,BIT1           .
            ,  ATX  , AПBБЩ         .
 14,VTM,ПPEPCИ1.
 ,ITA,14.
            ,  ATX  , PAПPEP        .
 ,ITA,13.
 ,ASN,64+2.
 ,ATI,15.
 ,XTA,BIT4.
 15,EXT,150B.
 ,UJ,CЧCTPOK.
 ПPOBYNRS:,ENTRY,.
 ,ITA,7.CПACEHИE 7-ГO
 ,WTC,FSBASENR.MOДИФИKATOPA
 7,VTM,.И YCTAHOBKA
 ,ATX,SAVEI7C.БAЗЫ
 ,XTA,BPEMЯ BY.
 ,AEX,C377
 ,U1A,CЧ BP.
   ,XTA,HOMEP BY
 ,ATI,13
 ,ASN,64-2.
 ,ATI,14.HOMEP BY * 4
   ,XTA,CБOЙ BY.
 ,UIA,CБOЙ.ПPOГP.CБOЙ
   ,XTA,БЫЛ ДK.
 ,U1A,ГAШKЛЮЧA.
 ,EXT,4102B.
 14,AAX,BIT22.ПO ЛAMПOЧKE
 ,UZA,ЗAMЯЛO. - HET CБOЯ
 CБOЙ:,XTA,BIT25.***   CБOЙ CИ
 13,ARX,CTAT BB.
 ,UJ,BЫД OШ.
 ЗAMЯЛO:,XTA,BIT37.***   ЗAMЯЛO
 13,ARX,CTAT BB.
 BЫД OШ:13,ATX,CTAT BB.***   B CTATИC.
   ,XTA,CЧ OШ K
  ,AOX,=6H    K0
  ,ASN,64-32
 ,ATX,TTOШBY+1.
 14,VTM,TTOШBY.
 ,ITA,14
 14,VJM,TTPRINT.
 ,XTA,
   ,ATX,CЧ OШ K.
 ,ATX,KЛЮЧCЧBP
 ,ATX,BPEMЯ BY.
 ,XTA,BIT1.
   ,ATX,BYHEPAБ
 ,UJ,BЫKЛ BY
 ГAШKЛЮЧA:,BSS,
 ,XTA,.
 ,ATX,KЛЮЧCЧBP
 ,ATX,BPEMЯ BY.
 ,UJ,KOHEЦBB
 CЧ BP:,BSS,.
 ,XTA,BPEMЯ BY
 ,ARX,BIT1.
 ,ATX,BPEMЯ BY
 ,XTA,SAVEI7C.
 ,ATI,7.
 13,UJ,
 Z900:,Z00,
 ,Z00,900.
 Z1800:,Z00,
 ,Z00,1800
 C377:,LOG,30.
 PЯ:,BSS,1
 CBK1:,BSS,1
 CBK2:,BSS,1
 CTAPCB:,BSS,1
  TTOШBY:,ISO,6HOШ BY
  ,LOG,
 SAVEI7C:,BSS,1
 ,END,
 TA2M60  :  ,NAME,
 SELECT  :  ,SUBP,
 FULSAV  :  ,SUBP,
 CLTASK  :  ,SUBP,
 RETURN  :  ,SUBP,
 PERMIR  :  ,SUBP,
 CLOMIR  :  ,SUBP,
 NEWTA   :  ,SUBP,
 TTPRINT :  ,SUBP,
 ERRMACRO:  ,SUBP,
 MACRO74 :  ,SUBP,
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 FULWOR  :  ,LC,1
 Д H З   :  ,LC,1
 SMASAV:LC,BLOCK,
            ,CONT,      SAVAC
            ,CONT,      SAVSR
            ,CONT,      SAVAR
            ,CONT,      SAVI15
            ,CONT,      SAVI14
            ,CONT,      SAVI13
            ,CONT,      SAVMIR
            ,CONT,      SAVS16
 YBBK    :  ,LC,1
 PAПPEP  :  ,LC,1
 KOHK    :  ,LC,1
 KЛЮЧCЧBP:,LC,1
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,(2),M1RDSC,STCLTA.
 SNT2:,EQU,23B.ДHЗ TA2M60
 HAЧ K:,SUBP,
 TYP/PL:,SUBP,
 COPY7:,EQU,TYP/PL+1
C
C...  ЭKOHOMИЯ ПAMЯTИ :
C
  STARTDD:,SUBP,
  STARTDD:I,BLOCK,BUF1M60(1),IF1M60(24)
  ,CONT,BUF2M60(1),IF2M60(24)
  ,CONT,БYФHБЩ(24)
  ,CONT,БYФBБЩ(168)
 БAЗAПPИЗ:LC,BLOCK,(1),AKЖПM,З1BШГ
 ,CONT,БЫЛ ДK,BЫKЛ Д,БЫЛA KП
 ,CONT,ЗB CBOЯ,ЗB ЗAHЯTA,KЖПM
 ,CONT,CЧKЖПM,HOMEP BY
 ,CONT,CЧПPOПK,ЧПCTPOK
 ,CONT,AПBБЩ,AПHБЩ
 ,CONT,TPЗ2OTЗ1,KПOДBБЩ
 ,CONT,KПOДHБЩ,AKЖOБPЗ1
 ,CONT,BY HE PAБ,PЯЗ1,CЧ OШ K
 ,CONT,CЧ KBЫKBY,CБOЙ BY
 ,CONT,HET KAPT,ПPOД
 EFSMNRS:,SUBP,
 B:,EQU,EFSMNRS.
 7,REL,B.
 TA2M60:,BSS,.
            ,  XTA  , KЖПM          .
            ,  U1A  , OTKPЗM        .
   ,XTA,CБOЙ BY.
            ,  U1A  , YBYHEPAБ      .
            ,  XTA  , БЫЛ ДK        .
            ,  U1A  , YHETKAPT      .
            ,  XTA  , BЫKЛ Д        .
            ,  AEX  ,BIT3           .
            ,  U1A  , Д BY BKЛ      .
 ,ATX,ПPOX1
   :              ,   24  , 00003B        .
C        OПPEДEЛEHИE N BY.
 ,XTA,7
 ,AAX,BIT1
  ПPOBTИПA:,ATX,HOMEP BY
            ,  ATI  , 12            .
            ,  ASN  ,64-2           .
            ,  ATI  , 11            .
C        OПPEДEЛEHИE TИПA BY
 ,XTA,7.
 ,AOX,COPY7
 12,AAX,BIT26.
 ,ATX,YBBK.
            ,  U1A  , ПPOBYBBK      .
            ,  EXT  , 04102B        .
          11,  AAX  ,BIT24          .
            ,  U1A  , PПYBY700      .
 ПPOBПPOX:,BSS,
 ,XTA,ПPOX1
 ,U1A,BЫДTEЛET.OБA БЫЛИ
            ,  XTA  ,BIT1           .
 ,ATX,ПPOX1
   ,AEX,HOMEP BY.
            ,   UJ  , ПPOBTИПA      .
 BЫДTEЛET:,BSS,
   :   ,24,2003B.
 14,VTM,TBYHEBKЛ.
 ,ITA,14.
          14,  VJM  , TTPRINT       .
  YBYHEPAБ:,XTA,BIT1
  ,ATX,BYHEPAБ
 ЗAKPЗB2 :14,  VTM  , TA2M60        .
            ,  ITA  , 14            .
 ,WTC,*YCЫ+SNT2
            ,  ATX  , 00003B        .*****
            ,  XTA  ,BIT30          .
            ,  AEX  , RDSCAL        .
            ,  ATX  , RDSCAL        .
            ,   UJ  , SELECT        .
 PПYBY700:  ,  EXT  , 04102B        .
          11,  AAX  ,BIT22          .
            ,  U1A  , PПYBY700      .
            ,  ATX  ,               .
 YCTПPИ  :  ,   24  , 02003B        .
            ,  ATX  , BЫKЛ Д        .
            ,  ATX  , CЧKЖПM        .
            ,  ATX  , CЧПPOПK       .
            ,  ATX  , CЧKBЫKBY      .
            ,  XTA  , AKЖПM         .
            ,  ATX  , AKЖOБPЗ1      .
            ,  ATX  , AПBБЩ         .
 7,UTC,
 14,VTM,БYФHБЩ-B
            ,  ITA  , 14            .
            ,  ATX  , AПHБЩ         .
            ,  XTA  , YBBK          .
            ,  UZA  , OПPEP37       .
          12,  XTA  ,BIT44          .
          13,  VJM  , PERMIR        .
C         PAЗPEШEHИE OTCЧETA BPEMEHИ ПPOXOДA KAPTЫ
 ,ATX,KЛЮЧCЧBP
 7,RELS,B.
 13,VTM,HAЧ K.
 7,REL,B.
 ,ITA,13.
            ,  ATX  , PAПPEP        .
 OПPEP37 :  ,  XTA  ,BIT37          .
          13,  VJM  , PERMIR        .
          12,  XTA  ,BIT22          .
            ,  AEX  , FULWOR        .
            ,  EXT  , 00030B        .
  ,XTA,YBBK
  :,U1A,*+1
  12,UTC,BIT24
  :,XTA,
            ,  AEX  , FULWOR        .
            ,  AAX  , COMPIR        .
          12,  AOX  ,BIT22          .
            ,  ATX  , COMPIR        .
            ,  EXT  , 00034B        .
            ,  XTA  , YBBK          .
            ,  U1A  , BKЛ YBBK      .
            ,  XTA  ,BIT3           .
 BKЛ BY  :12,  EXT  , 00150B        .
 ,ATX,KЛЮЧCЧBP.
 Д BY BKЛ:  ,  XTA  ,BIT1           .
            ,  ATX  , TPЗ2OTЗ1      .
            ,   UJ  , ЗAKPЗB2       .
 BKЛ YBBK:  ,  XTA  ,               .
            ,  ATX  , KOHK          .
            ,  ATX  ,W00401         .
          13,  VTM  , 77755B        .
            ,  ITA  , 13            .
            ,  ATX  , ЧПCTPOK       .
            ,  XTA  ,BIT1           .
            ,   UJ  , BKЛ BY        .
 ПPOBYBBK:  ,  EXT  , 04102B        .
          11,  AAX  ,BIT24          .
 ,U1A,ПPOBПPOX.HEГOT
 14,VTM,1.ПOДГOT ЗAДEPЖ
 ПPOB ЗAH:,EXT,4102B
          11,  AAX  ,BIT23          .
 11,AEX,BIT23
 ,UZA,YCTПPИ.HE ЗAHЯT PAБOTOЙ
 ,ASN,
 ,ASN,
 14,VLM,ПPOB ЗAH
 ,UJ,ПPOBПPOX
 YHETKAPT:,XTA,BЫKЛ Д.
 ,AEX,BIT3.
 ,U1A,Y0M14.
 ,ATX,ЗB CBOЯ.
 Y0M14:,XTA,ЗB ЗAHЯTA.
            ,  ATI  , 12            .
            ,  ATX  , HETKAPT       .
            ,  XTA  ,               .
 YCTM14Э :12,  WTC  , *YCЫ          .
            ,  ATX  , 00010B        .*****
 OTKPЗM  :  ,   24  , 02003B        .
            ,  XTA  , RDSCAL        .
            ,  WTC  , ЗBЗAHЯTA      .
            ,  AOX  ,BITS           .
            ,  ATX  , RDSCAL        .
            ,   UJ  , ЗAKPЗB2       .
 TBYHEBKЛ:,BSS,
 ,ISO,12HBY HE BKЛ'0''0''0'
 ПPOX1:,BSS,1
 W00401  :  ,BSS,1
 ,END,
 TA1M60  :  ,NAME,
 FULSAV  :  ,SUBP,
 SELECT  :  ,SUBP,
 CLTASK  :  ,SUBP,
 PERMIR  :  ,SUBP,
 CLOMIR  :  ,SUBP,
 NEWTA   :  ,SUBP,
 TTPRINT :  ,SUBP,
 ERRMACRO:  ,SUBP,
 MACRO74 :  ,SUBP,
 CORRADR :  ,SUBP,
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 DISREG:LC,BLOCK,C2013
 BPEMЯ BY:,LC,1
 ПYCT K:,LC,1
 K BCE EД:,LC,1
 FULWOR  :  ,LC,1
 Д H З   :  ,LC,1
 SMASAV:LC,BLOCK,
            ,CONT,      SAVAC
            ,CONT,      SAVSR
            ,CONT,      SAVAR
            ,CONT,      SAVI15
            ,CONT,      SAVI14
            ,CONT,      SAVI13
            ,CONT,      SAVMIR
            ,CONT,      SAVS16
 YBBK    :  ,LC,1
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,(2),M1RDSC,STCLTA.
C
C...  ЭKOHOMИЯ ПAMЯTИ :
C
  STARTDD:,SUBP,
  STARTDD:I,BLOCK,BUF1M60(1),IF1M60(24)
  ,CONT,BUF2M60(1),IF2M60(24)
  ,CONT,БYФHБЩ(24)
  ,CONT,БYФBБЩ(168)
 БAЗAПPИЗ:LC,BLOCK,(1),AKЖПM,З1BШГ
 ,CONT,БЫЛ ДK,BЫKЛ Д,БЫЛA KП
 ,CONT,ЗB CBOЯ,ЗB ЗAHЯTA,KЖПM
 ,CONT,CЧKЖПM,HOMEP BY
 ,CONT,CЧПPOПK,ЧПCTPOK
 ,CONT,AПBБЩ,AПHБЩ
 ,CONT,TPЗ2OTЗ1,KПOДBБЩ
 ,CONT,KПOДHБЩ,AKЖOБPЗ1
 ,CONT,BY HE PAБ,PЯЗ1,CЧ OШ K
 ,CONT,CЧ KBЫKBY,CБOЙ BY
 ,CONT,HET KAPT,ПPOД
 EFSMNRS:,SUBP,.
 B:,EQU,EFSMNRS.
 7,REL,B.
  TA1M60:,BSS,.
 7,MTJ,13
 13,UTM,БYФHБЩ-B
 ,ITA,13
   ,ATX,AПHБЩ
   ,XTA,AKЖOБPЗ1.
 ,ATI,11.
 12,VTM,.
 10,VTM,.
   ,XTA,CБOЙ BY
 ,U1A,KOHЗ1
 ,XTA,K BCE EД.
 ,U1A,ИHBEPT.
   :   ,24,13B
            ,  XTA  , YBBK          .
            ,  U1A  , K YBBK        .
 ИCXYCT:,BSS,.
 7,UTC,30B
 15,VTM,БYФHБЩ-B
            ,  XTA  , AKЖOБPЗ1      .
            ,  ATI  , 11            .
          10,  VTM  ,               .
          12,  VTM  ,               .
          13,  VTM  , 77751B        .
 ПPOBTY  :  ,  XTA  , YBBK          .
            ,  UZA  , KBY700        .
 11,XTA,27B
 БЛ CPABH:11,ATX,27B
          15,  AEX  ,               .
          11,  UTM  , 77777B        .
 ,UZA,CTP PAB
 11,AOX,30B
 11,ATX,30B
            ,  XTA  , 00007B        .
            ,  AAX  ,BIT38          .
            ,  UZA  , HECP CTP      .
          10,  VTM  , 00001B        .
 CTP PAB:11,XTA,30B.
            ,  AEX  ,BIT40          .
            ,  U1A  , HET 40P       .
          12,  UTM  , 00001B        .
 HET 40P :13,  VLM  , ПPOBTY        .
          11,  UTM  , 00060B        .
          10,  VZM  , AHAЛИЗДK      .
          11,  XTA  , 77750B        .*****
            ,  AOX  ,BIT48          .
          11,  ATX  , 77750B        .*****
 AHAЛИЗДK:  ,   24  , 02003B        .
   ,XTA,CБOЙBY.
 ,U1A,KOHЗ1.
 12,UTM,-24. 24 EДИHИЦЫ
          12,  VZM  , ECTЬ ДK       .
            ,  XTA  , CЧKЖПM        .
            ,  ARX  ,BIT1           .
            ,  ATX  , CЧKЖПM        .
            ,  ITA  , 11            .
 7,UTC,
 13,VJM,CORRADR-B
 YCT AH  :  ,  ATX  , AKЖOБPЗ1      .
            ,  XTA  , BЫKЛ Д        .
            ,  UZA  , ПPOBЧK        .
            ,  AEX  ,BIT3           .
            ,  U1A  , KOH З1        .
 KOPCЧK  :  ,  XTA  , CЧKЖПM        .
            ,  ATX  , KЖПM          .
 KOH З1  :  ,  XTA  ,               .
            ,  ATX  , З1 B ШГ       .
 ,ATX,BPEMЯ BY
 ,ATX,K BCE EД.
 ,ATX,ПYCT K.
            ,  XTA  , TPЗ2OTЗ1      .
            ,  UZA  , ПOДГBOЗB      .
            ,  XTA  , RDSCAL        .
            ,  AOX  ,BIT30          .
            ,  ATX  , RDSCAL        .
            ,  XTA  ,               .
            ,  ATX  , TPЗ2OTЗ1      .
 7,RELS,B.
 ПOДГBOЗB:13,  VTM  , TA1M60        .
 7,REL,B.
            ,  ITA  , 13            .
 7,UTC,IF1M60-B
            ,  ATX  , 00003B        .*****
 ,XTA,C2013
 7,UTC,IF1M60-B
            ,  ATX  , 00005B        .*****
            ,  XTA  , RDSCAL        .
            ,  AEX  ,BIT39          .
            ,  ATX  , RDSCAL        .
            ,   UJ  , SELECT        .
  ПPOBЧK:,WTC,CЧKЖПM
  13,VTM,-4
          13,  V1M  , KOPCЧK        .
 TPBЫKЛД:,BSS,.
            ,  XTA  ,BIT1           .
            ,  ATX  , BЫKЛ Д        .
            ,  ATX  , CЧKBЫKBY      .
            ,   UJ  , KOH З1        .
 ECTЬ ДK :  ,  XTA  ,BIT1           .
            ,  ATX  , БЫЛ ДK        .
  ,UJ,KOPCЧK
 HECP CTP:  ,   24  , 02003B        .
   ,XTA,CБOЙ BY.
 ,U1A,KOHЗ1
 ,XTA,BIT1.
   ,ATX,CБOЙ BY.
   ,ATX,CЧ OШ K.
   ,XTA,BЫKЛ Д
 ,U1A,KOHЗ1
 ,UJ,TPBЫKЛД
 ИHBEPT:,BSS,.
   :   ,24,13B
 13,VTM,-27B
 ,XTA,.
 OБP:,BSS,
 13,UTC,.
 11,ATX,27B.
 13,VLM,OБP.
 KOPAБOK:,BSS,.
 11,UTM,30B
 ,UJ,AHAЛИЗДK
 KBY700:11,XTA,27B
  ,AAX,K16574
            ,  ASN  ,64+10          .
            ,  ATX  , PЯЗ1          .
 11,XTA,27B
  ,AAX,K16575
            ,  ASN  ,64-10          .
            ,  AOX  , PЯЗ1          .
            ,   UJ  , БЛ CPABH      .
 K YBBK  :13,  VTM  , БYФHБЩ        -B.
 7,J+M,13.ДOИABЛEH(E ИAЗЫ
          15,  VTM  , 77765B        .
  ,XTA,A KOHCT
 HEBCECTP:  ,  ATX  , KOHCTCTP      .
            ,  XTA  , AKЖOБPЗ1      .
            ,  ATI  , 11            .
           9,  VTM  , 77777B        .
 OБP2CTPK:12,  VTM  ,               .
          10,  VTM  , 77767B        .
            ,  XTA  ,               .
            ,  ATX  , PЯПPИHФ       .
 OБP1CTPK:11,  XTA  ,               .
            ,  APX  , KOHCTCTP      .
          12,  ASN  ,64+8           .
            ,  AOX  , PЯПPИHФ       .
            ,  ATX  , PЯПPИHФ       .
          12,  UTM  , 00004B        .
          11,  UTM  , 00001B        .
          10,  VLM  , OБP1CTPK      .
          13,  ATX  ,               .
          13,  UTM  , 00001B        .
           9,  VLM  , OБP2CTPK      .
            ,  XTA  , KOHCTCTP      .
            ,  ASN  ,64-1           .
          15,  VLM  , HEBCECTP      .
          13,  VTM  , 77751B        .
 ИЗHБBBБ:7,UTC,БYФHБЩ-B
 13,XTA,27B
            ,  WTC  , AKЖOБPЗ1      .
 13,ATX,27B
          13,  VLM  , ИЗHБBBБ       .
            ,   UJ  , ИCXYCT        .
 K16574  :  ,LOG, 00177700 03776000
 K16575  :  ,LOG, 00000077 74001777
 A KOHCT :  ,LOG, 00010001 00010001
 KOHCTCTP:  ,BSS,1
 PЯПPИHФ :  ,BSS,1
 ,END,
 CORRADR:,NAME,
  STARTDD:,SUBP,
  STARTDD:I,BLOCK,(50),(24),БYФBБЩ(168)
 EFSMNRS:,SUBP,.
 FSBASENR:LC,BLOCK,BASE
 H:,EQU,EFSMNRS.
 K:,EQU,H-168.
 7,REL,EFSMNRS
   :   ,24,2003B
 ,ATX,PЯ
 ,XTA,ДHOBБЩ
 ,ARX,BASE.
 ,AEX,PЯ.
 ,U1A,BЫX
 ,XTA,AБYФBБЩ
 ,ARX,BASE.
 13,UJ,
 BЫX:,BSS,
 ,XTA,PЯ
 13,UJ,
 AБYФBБЩ:,Z00,
 ,Z00,БYФBБЩ-H.
 ДHOBБЩ:,Z00,
 ,Z00,БYФBБЩ-K.
 PЯ:,BSS,1
 ,END,
 EFSMNRS:,NAME,
C.........ЭKCTPAKOД BBOДA C ПEPФOЛEHTЫ
  *TAKCA:LC,BLOCK,(4),R1/500
 NEWTA:,SUBP,
 BISTIME:,EQU,110B
  *677: B,BLOCK,  BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42
  ,CONT, BIT41,BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34
  ,CONT, BIT33,BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,
  ,CONT, BIT25,BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18
  ,CONT, BIT17,BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10
  ,CONT, BIT9,BIT8,BIT7,BIT6,BIT5,BIT4,BIT3,BIT2,BIT1
  RETURN:,SUBP,
 OUTMACRO:,SUBP,
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR
 ,CONT,SAVI15,SAVI14,SAVI13
 TYP/PL:,SUBP,
  YBBKNRS:,SUBP,
  C77777:,LC,1
  C377:,LC,1
  C37:,LC,1
 БAЗAПPИЗ:LC,BLOCK,(7),ЗBЗAHЯTA,(18)
 NRSINPUT:,SUBP,.
 NREFSM:,EQU,NRSINPUT.
 NRESOFF:,SUBP,
 FSBASENR:,LC,1
 TTPRINT:,SUBP,
 FFPT:,LC,1
C         AДPEC CYMMATOPA
   ADOFACC:,LC,4
  NUMFSM:,EQU,ADOFACC+1
C         HOMEP TEKYЩEЙ ЗAДAЧИ
  CNUMT:,EQU,ADOFACC+2
 SYMBOL:,EQU,CNUMT+1
 DISREG:,LC,1
  *YCЫ:LC,BLOCK,ГYC,RDSCAL
 CNTSY:,EQU,571B.CЧETЧИK B ИПЗ
 *ИПД:LC,BLOCK,(9),SC/FULL
  C5:,LC,1
  ДHЗ:,LC,1
  ERRMACRO:,SUBP,
 PERMIR:,SUBP,
 CLOMIR:,SUBP,
 CLANEWTA:,SUBP,
 13,REL,*
 BEGIN:,BSS,
  ,ITA,13
  ,ATX,FSBASENR
  ,XTA,БAЗAПPИЗ
  ,AAX,C77777
  ,AEX,BIT1
  13,U1A,YBBKNRS-BEGIN
 ,XTA,DISREG
 ,ATI,27B
 ,XTA,CNUMT
C         ЗAДAЧA BBOДA C ПЛ CBOБOДHA
 ,UZA,FREE
 ,AEX,Д H З
 ,U1A,MAT1
 FREE:14,V1M,THISJOB
C         ЭTO OTKAЗ
 MACREF:,XTA,CNUMT
 ,UZA,THENSNOT
 ,WTC,ДHЗ
 ,XTA,BITS
 ,AAX,SC/FULL
 ,UZA,ENDZER
 ,XTA,CNTSYOWN.ДOБABЛEHИE
 ,WTC,ГYC. ЧИCЛA
 ,ARX,CNTSY.ПPИHЯTЫX
 ,WTC,ГYC.CИMBOЛOB B
 ,ATX,CNTSY.CЧETЧИK ИПЗ
  ,XTA,
 ENDZER:,ATX,CNTSYOWN
 ,ATX,CNUMT
 ,ATX,SIMAF
 ,WTC,NUMFSM
 ,033,10B
 ,WTC,NUMFSM
 ,XTA,BIT42
 13,VJM,CLOMIR
 THENSNOT:,BSS,
 ,XTA,SAVI13
 ,ATI,13
      ,WTC,FSBASENR
      ,XTA,INFREF-BEGIN
 ,ARX,FSBASENR
 ,UJ,NRESOFF
C         ЭTO BBOД
  THISJOB:,BSS,
 14,VTM,PART2
 14,MTJ,33B.ПOCЛE ПPEPЫB.
  ,XTA,CNUMT
  ,UZA,FIRSTEN
 ,WTC,ГYC
 14,VTM,
 14,XTA,BISTIME
 ,NTR,
 ,A+X,R1/500
 14,ATX,BISTIME
 14,VTM,CLANEWTA
C         BKЛЮЧEHИE ПPOTЯЖKИ
  TINMOVE:,ENTRY,
  TINMOVE:,XTA,C5
  ,ATX,SIMAF
  ,WTC,NUMFSM
  ,033,10B
 14,UJ,
C         ПEPBOE OБPAЩEHИE
  FIRSTEN:,BSS,
  ,XTA,7
 ,ASN,64+1.
  ,AAX,BIT1
  ,ATX,NUMFSM
 ,XTA,SAVI14
 ,ASN,64+6
 ,U1A,ARINPE.BBOД MACCИBA
C         BBOД OДHOГO CИMBOЛA
 ,XTA,SAVI14
  ,AAX,BIT1
  ,U1A,M5NEED
  ,XTA,C377
  ,UJ,GENBRAN
  M5NEED:,XTA,C37
  GENBRAN:,ATX,MASK
 ,WTC,NUMFSM.OПPEДEЛEHИE
 ,XTA,BIT2.TИПA ПPOTЯЖKИ
 ,AAX,TYP/PL
 ,UZA,*1.FSM
 ,XTA,C377.BHИЭM
 *1:,ATX,INVERT
  ,XTA,Д H З
  ,ATX,CNUMT
 ,WTC,ГYC
 ,XTA,BISTIME
 ,NTR,
 ,A+X,R1/1
 ,WTC,ГYC
 ,ATX,BISTIME
 14,VTM,CLANEWTA
C         BKЛЮЧEHИE ДBИГATEЛЯ
 STARTFSM:,ENTRY,
  ,XTA,
 ,ATX,FFPT
  ,ATX,ADOFACC
  ,XTA,BIT7
  ,ATX,BORD
 ,XTA,BIT3
 ,WTC,NUMFSM
 ,033,10B
 14,UJ,
 MAT1:,BSS,
 15,VTM,TOЗAH
 ,ITA,15
 14,VJM,TTPRINT
 14,VTM,TOЗAHA
 ,UJ,ERRMACRO
 ARINPE:,BSS,
C......   ИHИЦИAЦИЯ BBOДA MACCИBA
 ,XTA,BIT40.CЧETЧИK CЛOB
 ,ATX,PNTW.И TOЧKA ЗAПИCИ
 ,E+N,172B.CЧETЧИK CИMBOЛOB
 ,ATX,CSIW.И TOЧKA ЧTEHИЯ
 ,XTA,SAVI13
 ,ATX,MYI13
 ,ITA,13
 ,ATX,SAVI13.БAЗA
 ,XTA,
 ,UJ,GENBRAN
 PART2:,BSS,
C......   PAБOTA ПOCЛE ПPEPЫBAHИЯ
 ,WTC,FSBASENR
 ,XTA,MASK-BEGIN
 ,UZA,IFEND.ИДET MACCИB
 ,AAX,SYMBOL
 KOH:,ATX,SAVAC
 KOH1:,MTJ,27B
 ,UJ,OUTMACRO
 TOVINT:,BSS,
C   ...   V-OПEPAЦИЯ ДЛЯ ПPOTЯЖKИ
 ,XTA,FFPT.БЫЛA ЛИ ABAPИЯ
 ,U1A,AFARINT.БЫЛA
 14,VJM,TINMOVE
C         BOCCTAHOBЛEHИE TOЧKИ ПO MAT.ПAM.
 ,XTA,SAVI14
 ,ATI,14
 AFARINT:,BSS,
C......   ПPИEM CЛOB MACCИBA
 ,WTC,CSIW
 ,XTA,BUF.OЧEPEДHOE CЛOBO
 :,24,
 14,ATX,
 ,24,2003B
 14,UTM,1
 ,ITA,14
 ,ATX,SAVI14
 ,XTA,CSIW.ПPOДBИЖKA
 ,ARX,BIT1.YKAЗATEЛЯ
 ,AAX,MASCI.ЧTEHИЯ
 ,ATX,CSIW
 ,XTA,PNTW.CЧET CЛOB
 ,E+N,64-1.B БYФEPE
 ,ARX,BIT16.И B MACCИBE
 ,ATX,PNTW
 ,E+N,64+1.ЗAKPЫT ЛИ ПYCK
 ,UZA,TOVINT.ЗAKPЫT
C         ECTЬ ЛИ EЩE CЛOBA B БYФEPE:
 ,E+N,64+62
 ,UZA,AFARINT.EЩE ECTЬ
C         HA ЗAKPЫTИE ПOTPEБИTEЛЯ
 14,VTM,IFEND
 14,MTJ,33B
 ,XTA,DISREG
 ,ATI,27B
 ,UJ,CLANEWTA
C         HE KOHЧEH ЛИ MACCИB
 IFEND:,XTA,PNTW
 ,E+N,64+63
 ,UZA,AFARINT.HET, HE KOHЧEH
C         MACCИB OKOHЧEH. ПOДCЧИTAEM
C        KOMMEPЧECKOE BPEMЯ.
 ,XTA,PNTW
 ,ASN,64+15
 ,ASN,64-24
 ,AOX,BIT48
 ,NTR,
  ,E+N,64+16.40-24
  ,A*X,R1/500.ИЗ "*TAKCA"
 ,WTC,*YCЫ
 ,A+X,BISTIME
 ,WTC,*YCЫ
 ,ATX,BISTIME
 ,XTA,MYI13
 ,ATX,SAVI13
 ,XTA,PNTW
 ,ATX,SAVAC
 ,UJ,MACREF
 INTPT:,ENTRY,
C.........PEAKЦИЯ ПPEPЫBAHИЙ ФCM-1500
 ,WTC,FSBASENR
 13,VTM,
  ,XTA,
  ,ATX, COUNTER2
  ,ATX, SIMAF
  ,WTC,NUMFSM
  ,033,4014B
 ,AEX,INVERT
 ,AAX,C377
 ,ATX,SYMBOL
  ,XTA, ADOFACC
  ,U1A, NRNEQ1
C         ПEPBOE ПPEPЫBAHИE
 ,XTA,BIT1
  ,ATX,ADOFACC
 14,VTM,NEWTA
 ,UJ,TINMOVE
C         HE ПEPBOE ПPEPЫBAHИE
 NRNEQ1:,ARX,CNTSYOWN.CЧET
 ,ATX,CNTSYOWN.CИMBOЛOB
 ,XTA,MASK
 ,UZA,ARINI.BBOД MACCИBA
 ,WTC,CNUMT
  ,XTA,BITS
  ,AOX, RDSCAL
 ,ATX,RDSCAL
 RETSTOP:,BSS,
C         CTOП BHИЭM И BЫXOД ИЗ ПPEPЫBAHИЯ
 ,XTA,INVERT
 ,UZA,NEWTA
C      BЫKЛЮЧEHИE ПPOTЯЖKИ.
 ,XTA,BIT3  .ДЛЯ BHИИЭM
 ,WTC,NUMFSM.ДЛЯ BHИИЭM
 ,033,10B   .ДЛЯ BHИИЭM
 ,UJ,NEWTA
 ARINI:,BSS,
C......   ПPEPЫBAHИE B PEЖИME BBOДA
 ,XTA,WORD.HAKOПЛEHИE
 ,ASN,64-8.CИMBOЛOB
 ,AOX,SYMBOL.B CЛOBE
 ,ATX,WORD
 ,XTA,CSIW
 ,E+N,64+1.CЧET CИMBOЛOB
 ,ATX,CSIW.B CЛOBE
 14,VTM,RETURN
 ,U1A,TINMOVE.HA ПYCK FSM
 ,E+N,64-6.YCTAHOBKA CЧET-
 ,ATX,CSIW.ЧИKA CИMBOЛOB
C         ЗAПИCЬ CЛOBA B БYФEP
 ,XTA,WORD
 ,WTC,PNTW
 ,ATX,BUF
C         ПPOДBИЖKA YKAЗATEЛЯ ЗAПИCИ
 ,XTA,PNTW
 ,ARX,BIT1
 ,AAX,MASCI
 ,E+N,64+1.CЧET CЛOB B БYФ.
 ,ATX,PNTW
 ,UZA,RETSTOP.БYФEP ПOЛH
 14,VJM,TINMOVE
C         HE HAДO ЛИ OTKPЫTЬ ЗAДAЧY
 ,XTA,PNTW
 ,E+N,64+62
 ,UZA,RETURN.HE HAДO
 ,WTC,CNUMT
 ,XTA,BITS
 ,AOX,RDSCAL
 ,ATX,RDSCAL
 ,UJ,NEWTA
 INFREF:,Z00,NREFSM
 ,Z00,KOH1-BEGIN
 R1/1  :,REAL,1.0
 MASCI:,OCT,7777 7777 7770 0077
 TOЗAH :, ISO,12HFSM ЗAHЯTO''''
 TOЗAHA:,GOST,12HFSM ЗAHЯTO'231'
 CNTSYOWN:,OCT,
 FSJOBAR:,ENTRY,
 INVERT:,BSS,1
 MYI13:,BSS,1
 WORD :,BSS,1
 CSIW :,BSS,1
 PNTW :,BSS,1
 MASK :,BSS,1
 COUNTER2:,BSS,1
 SIMAF   :,BSS,1
 BORD    :,BSS,1
 BUF  :,BSS,64
            ,END,
 FSCONTR:,NAME,
C.........KOHTPOЛЬ BBOДA C ФCM-1500
 EFSMNRS:,SUBP,
 B:,EQU,EFSMNRS
  RETURN:,SUBP,
 FSBASENR:,LC,1
  * И П Д :LC,BLOCK,XNF
  OUTJOBSC:,EQU,XNF+52B
 *YCЫ:LC,BLOCK,ГYC,RDSCAL
 ADOFACC:,LC,4
 NUMFSM:,EQU,ADOFACC+1
 CNUMT:,EQU,ADOFACC+2
  *677: B,BLOCK,  BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42
  ,CONT, BIT41,BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34
  ,CONT, BIT33,BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,
  ,CONT, BIT25,BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18
  ,CONT, BIT17,BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10
  ,CONT, BIT9,BIT8,BIT7,BIT6,BIT5,BIT4,BIT3,BIT2,BIT1
 RI14:,EQU,8
  FFPT:,LC,1
  C377:,LC,1
  TTPRINT:  ,SUBP,
  TINMOVE:,SUBP,
 FSJOBAR: ,SUBP,
 FSJOBAR:I,BLOCK,(4),PNTW,MASK
 ,CONT,COUNTER2,SIMAF,BORD
 13,REL,EFSMNRS
  ,WTC,FSBASENR
  13,VTM,
 ,XTA,FFPT
 ,U1A,ISTHEND
C         ABAPИИ HE БЫЛO
  13,XTA,BORD-B
  ,UZA,WOZ
  ,ARX,C377
  ,AAX,C377
  13,ATX,BORD-B
  ,U1A,WOZ
 13,ATX,COUNTER2-B
 ,WTC,NUMFSM
 ,XTA,BIT42
 ,CALL,PERMIR
 ,WTC,FSBASENR
 13,VTM,
 13,UTC,
 14,VJM,TINMOVE-EFSMNRS
 WOZ:,BSS,
 13,XTA,SIMAF-B
 ,UZA,LMWR13
 ,XTA,BIT1
 13,ARX,COUNTER2-B
 13,ATX,COUNTER2-B
 ,AEX,BIT5
 ,U1A,LMWR13
C         БЛOK PEAKЦИИ HA ABAPИЮ
 ,WTC,NUMFSM
 ,XTA,BIT42
 ,CALL,CLOMIR
 ,WTC,FSBASENR
 13,VTM,
 ,XTA,BIT1
 ,ATX,FFPT
 ,XTA,
 ,WTC,NUMFSM
 ,033,10B
 13,MTJ,14
 ,ATI,
 ,XTA,ADOFACC
 ,U1A,K1
 ,UTC,TOBЫK-TTABF
 K1:,BSS,
 14,UTM,TTABF-B
 ,ITA,14
  14,CALL,TTPRINT
  LMWR13:14,VTM,
  ,UJ,RETURN
C         БЫЛ ЛИ ПPИKAЗ HA BЫБPOC
 ISTHEND:,BSS,
C         ЗAKPЫTA ЛИ ЗAДAЧA ПO ПOBOДY FS
 13,XTA,PNTW-B
 ,NTR,7
 ,E+N,64+63
 ,UZA,LMWR13.HET
C         HE BЫБPACЫBAЛИ ЛИ ЗAДAЧY:
 ,XTA,OUTJOBSC
 ,WTC,CNUMT
 ,AAX,BITS
 ,U1A,OPENTA.BЫБPACЫBAЛИ
 13,XTA,MASK-B.BBOД MACCИBA:
 ,U1A,LMWR13.HET
 ,ARX,FFPT.ПPИЗHAK KOHЦA:
 ,U1A,LMWR13.HET
 ,WTC,CNUMT
 ,XTA,BITS
 OPENTA:,AOX,RDSCAL
 ,ATX,RDSCAL
 ,XTA,
 ,ATX,FFPT
 ,UJ,LMWR13
  TTABF:,ISO,12HOБPЫB ПЛ''''''''
 TOBЫK :,ISO,12HFSM BЫKЛ.''''''
  ,END,
 MACRO64 :  ,NAME,
 *ИПД:LC,BLOCK,(54),БЛOKAЦПY
  NR/64:,SUBP,
  EMULAT:,SUBP,
 OUTMACRO:,SUBP,
  SAVEMOD:,SUBP,
  C77357:,LC,1
  SMASAV:LC,BLOCK,SAVAC
  NRESCALL:,SUBP,
  M:,EQU,100B
  REGSCAL:,EQU,M
  M72:,EQU,M+2
  M75:,EQU,M+5
  *YCЫ:LC,BLOCK,ГYC
  *677:B,BLOCK,BITS,BIT48
  ,CONT,BIT47,BIT46,BIT45,BIT44
  Д H З :LC,BLOCK,(1),BITJ
  :,XTA,*+1
  ,UJ,EMULAT
  :,Z00,4000B.БИT Э64
  ,Z00,*+1
  :,ITA,27B
  ,AAX,C77357
  ,ATI,27B
  ,WTC,ГYC
  ,ATX,M72
 ,XTA,БЛOKAЦПY
  ,AAX,BITJ
  ,U1A,YДAB/64
  ,WTC,ГYC
  ,XTA,REGSCAL
  ,AOX,BIT44
  14,VZM,STS
  14,UTM,-1
  14,VLM,NOSPEC
  ,AEX,BIT44
  STS:,AEX,BIT44
  ,WTC,ГYC
  ,ATX,REGSCAL
 YДAB/64:,BSS,
 13,MTJ,16
 ,ATX,SAVAC
  13,VTM,OUTMACRO
  ,UJ,SAVEMOD
  MA64*:,ENTRY,
  NOSPEC:,WTC,ГYC
  ,WTC,M72
   :    ,24,
  14,XTA,
   :    ,24,2003B
  ,ATX,SAVAC
  ,ITA,7
  ,WTC,ГYC
  ,ATX,M75
  ,XTA,INF
  ,UJ,NRESCALL
  INF:,Z00,NR/64
  ,,7
  ,END,
  *PR/COM:,NAME,
C... ЯЧEЙKИ ЗAДAЧИ ПEЧATИ
  NSTRI:,BSS,
  ,LOG,35
  ,LOG,35
  OLDBLS:,BSS,2
  NEWBLS:,BSS,2
  ,END,
 PRINTASK:,NAME,.
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 BT:,EQU,4.
 C1:,EQU,BIT1.
 C3:,LC,1
 AB:,EQU,5.
 NS:,EQU,6.
 LB:,EQU,7.
 LN:,EQU,8.
 SM:,EQU,9.
 RI:,EQU,10.
 R1:,EQU,11.
  RT:,EQU,13
  BASEPRTA:,LC,1
  NRPRTA:,SUBP,
  TPHYS:,LC,1
  NRTABL:,SUBP,
  PRINTASK:,SUBP,
  NLPRTA:,P/P,(PRINTASK)1024
  DESCR:,EQU,NRTABL+NLPRTA
  *PR/COM:LC,BLOCK,CNS(2),COBL(2),CNBL(2)
  WRSUM:,SUBP,
  WRSYM:,EQU,WRSUM
  ERROR:,SUBP,
  INITSTR:,SUBP,
  PRINTL:,SUBP,
  CHAT:,SUBP,
  NSTRI:,EQU,75B
  *46:B,BLOCK,NEWBLS,OLDBLS
 SAVIND:,SUBP,.
  C200:,EQU,BIT8
  C177:,LC,1
 C7:,LC,1.
 C14:,LC,1.
 C77777:,LC,1.
 CLOMIR:,SUBP,.
 *YCЫ: LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,(2),M1RDSC,STCLTA
  ,CONT,AЦПY(2)
 CON TIME:LC,BLOCK,(8),TAЦПY(2)
 *STATBUF:LC,BLOCK,(9),CTAT ПEЧ(2),(4),RPRI
 CИ MAX:,EQU,BIT7.
 TIME10:,SUBP,
 TEL OUT:,SUBP,
 CWLP1:,EQU,*YCЫ+10B.
 LMAT:,EQU,20B.
 RETURN:,SUBP,.
  C77:,LC,1
 NEWTA:,SUBP,.
 NLP:,EQU,12B.ИHД12 B ИПЗ PEДAKT.
 NP:,EQU,12
 C377:,LC,1
 CHECKLP:,SUBP,
 ALLTOISO:,SUBP,
 TP:,EQU,RI
 PERMIR:,SUBP,.
CAXAPOB, BEPETEHOB - YПЛOTHEHИE ИПЗ
C     ЯЧEЙKИ TИПA  П
 *460:B,BLOCK,NEMPTY,RQ,FIRST,SCAL,W
 ,CONT,R2,A/OUT,DT,NSI
 ,CONT,SCNT,NSIO,R3,NRC
C     ЯЧEЙKИ TИПA  PП
 *30 :B,BLOCK,QUEFLAG,ET,EBUF
 ,CONT,OVFLAG,LBUF
 BEGMAT:,EQU,500B.
 FULWOR:,LC,1.
 *TYPELP:LC,BLOCK,(1),N ПPOT,CONЖДY,CDT
  C2003:,LC,1
  COMLP:,LC,1
  SEMUP:,SUBP,
  ШЛAГБAYM:LC,BLOCK,(13),SEMLP
C----------------
 PRTA:,BSS,.
   :   ,24,2003B.
  14,REL,PRTA
  ,WTC,BASEPRTA
  14,VTM,
 15,XTA,QUEFLAG.
 ,UZA,CLOSE.
 ,ITA,BT
 15,AEX,ET.KOHEЦ TEKCTA
 ,U1A,PRINT.
 15,ATX,QUEFLAG.
 TP,V1M,CHINOUT
 ,UJ,RETPT.
 CLOSE:,BSS,.
 TP,V1M,SUP.OCBOБOЖДEHИE CEMAФOPA
   :   ,24,2003B.
 ,XTA,C12.
 12,032,14B.BЫKЛЮЧEHИE MOTOPA И ЛEHTЫ
 12,XTA,BIT48.
 12,AOX,BIT39.
 13,VTM,RETPT.
 ,UJ,CLOMIR.
 PRINT:,BSS,
 TP,VZM,PRBESM
 15,XTA,NEMPTY
 ,UIA,MOVE
 PRBESM:,BSS,
 BT,XTA,.HAЧAЛO CTPOKИ
 ,ASN,64-8.
 ,YTA,.
 15,ATX,NEMPTY.ЧИCЛO ПPOTЯЖEK
 ,UZA,FORMAT.HA ФOPMИPOBAHИE MATPИЦЫ
 BT,XTA,.
 ,AAX,CLEMPTY.
 BT,ATX,.CTИPAHИE ЧИCЛA ПPOTЯЖEK
 ,XTA,7
 ,AOX,*TYPELP.ЭKOHOMИЯ
 12,AAX,BIT40.ПPOTЯЖEK
  ,UZA,NOCORR.-HET
 15,XTA,NEMPTY
 ,ARX,C3.ПPOTЯЖEK
 ,ASN,64+3.БOЛЬШE 4
  ,UZA,NOCORR.-HET
 ,XTA,N ПPOT
 15,ATX,NEMPTY
  NOCORR:TP,VIM,MOVE.EC ПPOTЯЖKИ
  RETPT:,ENTRY,
  RETPT:,BSS,
   :    ,24,2003B
  ,XTA,COMMIR
  ,AAX,=:6006
  ,U1A,RETPT1
  ,XTA,DESCR
  ,ATI,13
  ,AAX,= 0370 0000.ЧИCЛO BЛAДEЛЬЦEB
  ,WTC,AЦПY
  ,AOX,QUEFLAG
  ,WTC,AЦПY+1
   ,AOX,QUEFLAG
  ,UIA,RETPT1
  ,ATX,BASEPRTA
  1,VTM,-1
  SAV:1,WTC,AЦПY+1
  2,VTM,
  2,XTA,NSTRI
  1,ATX,CNS+1
  2,XTA,OLDBLS
  1,ATX,COBL+1
  2,XTA,NEWBLS
  1,ATX,CNBL+1
  1,VLM,SAV
  13,XTA,TPHYS
  ,AOX,BIT1
  ,AEX,BIT1
  13,ATX,TPHYS
  RETPT1:,ITA,15
 15,VTM,PRTA.
 ,UJ,SAVIND.ЗAKPЫTИE ЗAДAЧИ
 FORMAT:,BSS,
 TP,V1M,PRINTL
 15,XTA,NSI
 ,ASN,64+3.
 ,ARX,C1.
 15,ATX,RQ.HOMEP ПOДMATPИЦЫ
 ,AEX,C14.
 ,U1A,*1.
 15,ATX,RQ.
 *1:,BSS,.
 15,XTA,FIRST.
 ,U1A,SKSCCHEK.
 15,XTA,SCAL.ШKAЛA HEHYЛEBЫX ПOДMATPИЦ
 15,WTC,RQ.
 ,AAX,BIT48.
 ,UZA,RETPT.
 SKSCCHEK:,BSS,
 15,XTA,NSI
 ,AOX,C1
 15,ATX,NSIO.ПPИЗHAK И HOMEP
  LPWORK:,ENTRY,
   :   ,24,3.
  BT,MTJ,AB
 1,VTM,0.HOMEP ПOЗИЦИИ
 NS,VTM,-4.CЧETЧИK CИMBOЛOB B CЛOBE
 AB,XTA,.
 ,ASN,64-8.
 15,ATX,W.CЛOBO
 LN,VTM,0.
  TP,VZM,LPW
C...  BЫДAЧA ЛEBЫX ПPOБEЛOB HA AЦПY EC
  SM,VTM,-7
  SHIFT:,XTA,BIT7
  2,VJM,WRSYM
  SM,VLM,SHIFT
 LPW:15,XTA,W.
 ,ASN,64-8.
 15,ATX,W.
 ,YTA,.
 ,ATI,SM.CИMBOЛ
 ,AEX,CENDSTR.
 ,UZA,ENDSTR.ECЛИ KOHEЦ CTPOKИ
 ,ITA,1.
 ,ASN,64+7.
 ,U1A,EREND.ПЛOXAЯ CTPOKA
 ,ITA,SM.
 ,AAX,C200.
 ,UZA,CHFIRST.ECЛИ HE ПPOБEЛЫ
 SM,UTM,-200B.
 SM,J+M,1.YЧET N+1 ПPOБEЛOB
 TP,V1M,WRBLS
 ,UJ,ELPW.
 CHFIRST:,BSS,
 TP,V1M,RECOD
 ,ITA,SM
 ,ASN,64+3.
 ,ATI,R1.HOMEP ПOДMATPИЦЫ
 15,XTA,FIRST.
 ,UZA,SKIPSCAL.
 R1,XTA,BIT48
 15,AOX,SCAL.
 15,ATX,SCAL.
 SKIPSCAL:,ITA,R1
 15,AEX,RQ.
 ,U1A,ELPW.
C
C   ФOPMИPOBAHИE ПOДMATPИЦЫ
C
 ,ITA,SM.
 ,AAX,C17.
 ,ATI,2.AДPEC B ДBOЙHOЙ ПOДMATPИЦE
 ,ITA,1.
 ,AAX,C7.
 ,ATI,R1.
  ,UJ,CW
  CW1:2,UTM,16
  R1,UTM,-3
 CW:,ITA,R1.
 ,ARX,C1.
 ,ASN,64+2.
  ,U1A,CW1
 FM:15,UTC,.
 2,UTM,BEGMAT. ,ITA,1.
 ,ITA,1.
 ,AAX,C177.
 ,ASN,64+3.
 ,AEX,C77777.
 15,ATX,R2.
 ,ITA,R1.
 ,ASN,64-4.
 15,ARX,R2.
 ,ATI,3.
 3,XTA,BIT1-31.
 2,AOX,.
 2,ATX,.EДИHИЦA B MATPИЦY
 ELPW:1,UTM,1.
 NS,VLM,LPW.
 NS,VTM,-5.
 RT,VJM,BUFSTEP.ЦИKЛИЧECKOE ПPOДBИЖEHИE
 AB,XTA,.
 15,ATX,W.
 ,UJ,LPW.
  TOBST:RT,VJM,BUFSTEP
 EREND:AB,XTA,.
 ,AAX,C177.
 ,AEX,CENDSTR.
  ,U1A,TOBST
 ENDSTR:,24,2003B.
 TP,V1M,ESTRLP
 15,ATX,FIRST.
 15,ATX,NSIO.
 15,WTC,RQ.
 ,XTA,BIT48.
 ,AEX,FULWOR.
 15,AAX,SCAL.
 15,ATX,SCAL.ПOДMATPИЦA ПOЛHOCTЬЮ BЫДAHA
 ,ASN,64+36.
 ,U1A,RETPT.ECЛИ HE BCЯ CTPOKA OTPAБOTAHA
 ENDSTR1:,BSS,
  RT,VJM,BUFSTEP
 ,XTA,BIT25.ЧИCЛO
 ,ARX,RPRI.PEAЛЬHO
 ,ATX,RPRI.OTПEЧ.CTPOK
 ,XTA,C1.
 15,ATX,FIRST.
 AB,MTJ,BT.HOBOE HAЧAЛO TEKCTA
 LN,J+M,LB.HOBAЯ ДLИHA CBOБ БYФEPA
 15,XTA,OVFLAG
 ,UZA,WAIT
 ,ITA,LB.
 ,NTR,3.
 ,X-A,MINBUF.
 ,UZA,WAIT
 ,XTA,.
 15,ATX,OVFLAG.
  12,XTA,AЦПY
  ,ASN,64+36
  ,AAX,C77
  ,UZA,WAIT.ДOЛГO TEЛИЛИCЬ
  ,ATI,RT
  RT,XTA,BITS
 ,AOX,RDSCAL.
 ,ATX,RDSCAL.OTKPЫTИE ЗAДAЧИ MATEMATИKA
 ,UJ,WAIT
 BUFSTEP:AB,UTM,1.
 LN,UTM,1.
 ,ITA,AB.
 15,AEX,EBUF.
 RT,U1A,.
 15,WTC,LBUF
 AB,UTM,
 RT,UJ,.
  LPWAIT:,ENTRY,
 WAIT:,BSS,
 TP,VZM,RETPT
 RI,VTM,=6000
 ,XTA,BIT10.PAЗBЯЗKA
 RT,VJM,CHAT
 ,U1A,ERROR.HE PAЗBЯЗAЛИCЬ
 ,XTA,COMLP
 NP,AOX,BIT4
 ,ATX,COMLP
 ,033,26B.ДOП MACKA
  ,EXT,4000B. - HAДO !!!
 ,XTA,BIT11
 13,VJM,PERMIR
 NP,UTC,
  13,VTM,CHECKLP
  ,ITA,13
 NP,ATX,TAЦПY
 SUP:,BSS,
 ,ITA,14
 ,ARX,SEMLPUP
 ,UJ,SEMUP
 SEMLPUP:,Z00,SEMLP
 ,Z00,RETPT-PRTA
 MOVE:,BSS,
 15,XTA,NEMPTY
 ,ASN,64+2
 ,UZA,MAЛO
 15,XTA,NEMPTY
 ,ARX,=77775
 ,AAX,C77777
 15,ATX,NEMPTY
 ,XTA,C3
 NP,ARX,CTATПEЧ
 NP,ATX,CTATПEЧ
 ,XTA,=2033.TPOЙHOЙ ПPOПYCK
 ,UJ,CHINOUT
 MAЛO:,BSS,
 15,XTA,NEMPTY
 ,ASN,64-3
 ,AOX,C2003
 15,ATX,RQ
 15,XTA,NEMPTY
 NP,ARX,CTATПEЧ
 NP,ATX,CTATПEЧ
 ,XTA,
 15,ATX,NEMPTY
 ,UJ,INITSTR
 CHINOUT:,BSS,
 15,ATX,RQ
 ,UJ,INITSTR
 WRBLS:,BSS,
 SM,UTM,1
 ,ITA,1
 ,ASN,64+7
 ,U1A,EREND
 WRBL:,BSS,
 ,XTA,BIT7.ПPOБEЛ
 2,VJM,WRSYM
 SM,UTM,-1
 SM,V1M,WRBL
 ,UJ,ELPW
 RECOD:,BSS,
  SM,XTA,ALLTOISO
  ,ASN,64-8
  ,YTA,
 2,VTM,ELPW
 ,UJ,WRSYM
 ESTRLP:,BSS,
 ,XTA,BIT11.KOHЧAЙ CTPOKY
 RI,VTM,BIT11
 RT,VJM,CHAT
 ,UZA,ERROR.HET PEAKЦИИ
 ,AAX,=1422
 ,U1A,ERROR
 ,UJ,ENDSTR1
 CИAЦПY:,ENTRY,.
C    PAБOTA B CИ
C
 13,XTA,CWLP1.
 ,ATI,15.
 15,XTA,NSI.
 ,ARX,C1.
 ,AAX,C77777.
 L77225:15,ATX,NSI.
 ,AEX,C140.
 ,UZA,L77225.
C.........ПPOBEPKA: HE ЖДEM ЛИ MЫ ПOCЛE ПPOTЯЖKИ
 13,XTA,CЧЖДY.
 ,UZA,HEЖДY.HE ЖДEM
 ,ARX,C77777.
 ,AAX,C77777.
 13,ATX,CЧЖДY.CЧЖДY=CЧЖДY-1
 ,U1A,RETURN.HE KOHЧИЛOCЬ ЖДY
 ,XTA,CONЖДY.БЫCTPЫЙ ПPOГOH
 ,UZA,KOH ЖДY. - ДA
 HEЖДY:,BSS,.
 ,032,4031B.OПPOC KOHЦA ПPOTЯЖKИ
 13,AAX,BIT24.
  ,UZA,ПPOBCИ
 KOHЖДY:,BSS,.
 15,XTA,SCNT.ПPOTЯЖKИ
 ,U1A,L10721.
  15,XTA,DT.ЗATЯЖKA BPEMEHИ
 ,UZA,L06465.
 ,ARX,C77777.
 ,AAX,C77777.
 15,ATX,DT.
 ,UJ,RETURN.
 ПPOB CИ:13,XTA,CЧ CИ.ECTЬ ЛИ ЗABИC.
 ,AEX,CИ MAX.ПPOTЯЖKИ
 ,UZA,RETURN. - БЫЛO
 ,AEX,CИ MAX.
 ,ARX,BIT1.KOPPEKTИP.
 13,ATX,CЧ CИ.CЧ.CИ OЖИДAHИЯ
 ,AEX,CИ MAX.
 ,UIA,RETURN.EЩE MAЛO CИ
 ,XTA,BIT25.
 13,ARX,CTAT ПEЧ.ИHTEPBAЛ
 13,ATX,CTAT ПEЧ.B CTATИCTИKY
 15,VTM,HETИHT.
 ,XTA,BIT4.ДЛЯ BЫK ДB
 BЫKДBИ:,BSS,
 13,EXT,14B .BЫKЛ.ДBИГ.
  ,ITA,13
  ,ASN,64-15
  ,AOX,BASEPRTA
  ,ARX,ПPOBRD
 13,ATX,TAЦПY
  ,WTC,BASEPRTA
  14,VJM,ДИAГH-PRTA
 13,XTA,BIT48
 13,VJM,CLOMIR
 ,UJ,RETURN.
 READY:,BSS,
 15,XTA,SCNT.
 ,ARX,C77777.
 ,AAX,C77777.
 15,ATX,SCNT.
  ,U1A,L10724
 ,XTA,CDT.
 15,ATX,DT.
 L10724:,BSS,.
 ,XTA,BIT1.
 13,032,14B.BЫДAЧA ПPOTЯЖKИ
 ,XTA,BIT1.CЧETЧИK
 13,ARX,CTAT ПEЧ.ПEЧ.CTPOK
 13,ATX,CTAT ПEЧ.B CTATИCTИKY
 ,XTA,.
 13,ATX,CЧ CИ.CИ ПPOTЯЖKИ
C.........YCTAHOBKA BЫДEPЖKИ ПOCЛE ПPOTЯЖKИ
 ,XTA,CONЖДY
 13,ATX,CЧЖДY.CЧЖДY=16
 ,UJ,RETURN.
 L06465:,BSS,.
  ,ITA,11
  ,ATX,M11
 15,XTA,NSI.
 ,AAX,C17.
  ,ATI,11
  15,J+M,11
 ,ITA,12.
 ,ATX,W06355.
 12,VTM,3.
 13,VTM,-8.
 LP:,BSS,.
 :12,UTM,-1.
  11,XTA,BEGMAT
 ,UZA,NW.
 ,ASN,64-16.
  11,ATX,BEGMAT
 ,YTA,.
 15,WTC,A/OUT
 13,033,50B.
 ,ATI,.
 ,ATI,.
 ,033,.
 12,V1M,ELP.
 NW:,BSS,.
 :12,J+M,13.
  11,UTM,LMAT
 12,VTM,3.
 ELP:,BSS,.
 :13,VLM,LP.
  ,XTA,M11
  ,ATI,11
 ,XTA,W06355.
 ,ATI,12.
 15,XTA,NSI.
 ,AAX,C7.
 ,U1A,RETURN.
 15,XTA,NEMPTY.
 15,ATX,SCNT
 ,XTA,.
 15,ATX,NEMPTY.
 15,XTA,SCNT
 ,U1A,RETURN.
 15,XTA,NSIO
 ,U1A,CLPRTA.ECTЬ HEДOФOPMИP. ПOДMATPИЦA
 STAPRINT:,BSS,.
 ,XTA,RDSCAL.
 15,WTC,NLP.
 ,AOX,BIT41.
 ,ATX,RDSCAL.
 ,UJ,NEWTA.
 CLPRTA:15,AEX,NSI
 ,ASN,64+3.
 ,UZA,STAPRINT.ДOФOPMИPOBATЬ
 15,WTC,NLP.
 ,XTA,BIT41
 ,AAX,RDSCAL.
 ,AEX,RDSCAL.
 ,ATX,RDSCAL.
 ,UJ,NEWTA.ПOДOЖДEM CЛEДYЮЩEГO OБOPOTA
 HYЛИAЦПY:,ENTRY,.
 ,XTA,COMMIR.ПPOБA:
 13,AAX,BIT48.CБOЙ CИ AЦПY
 ,UZA,YCT15. - HET
 ,XTA,C137.
 13,WTC,CWLP1.
 ,AEX,NSI.
 ,UZA,YCT 15. - HET
 ,XTA,BIT37.
 13,ARX,CTAT ПEЧ.CБOЙ CИ
 13,ATX,CTAT ПEЧ.B CTATИCTИKY
 15,VTM,CБOЙCИ.ДИAГHOCTИKA
 14,VJM,ДИAГH.HA OПEP.TT
  ,WTC,BASEPRTA
  14,VTM,
 YCT15:13,XTA,CWLP1.
 ,ATI,15.
 L06530:,XTA,C137.
 15,ATX,NSI.
 ,EXT,4031B
 13,AAX,BIT20
   ,U1A,L10722
 13,ATX,TAЦПY
 13,XTA,BIT48.
 13,VJM,PERMIR.
 ,UJ,RETURN.
 ПPOB RD:,BSS,
  ,Z00,
  ,Z00,///-PRTA
  ///:,ASN,64+15
  ,ATI,13.NLP
 ПPOД ПP:,BSS,
 ,EXT,4031B
 13,AAX,BIT20
 ,U1A,TIME10.HET READY
 ,XTA,BIT3.BKЛ ДBИГATEЛЯ
 13,EXT,14B
 ,UJ,TIME10
  L10721:,EXT,4031B
  13,AAX,BIT20
  L10722:,UZA,READY
  13,XTA,TAЦПY
  ,U1A,RETURN
  15,VTM,BЫKЛAЦПY
  ,UJ,BЫKДBИ
  ДИAГH:,ITA,13
  ,ASN,64-40
  ,WTC,BASEPRTA
  ,ARX,=6H1'''''''''' - PRTA
  15,ATX,2
  ,ITA,15
  ,UJ,TELOUT
 BЫKЛAЦПY:,ISO,12HBЫKЛ.AЦПY '1''1'
 ,OCT,
 HETИHT:,ISO,12HИHTEPB.AЦПY
  ,LOG,
 CБOЙCИ:,ISO,12HCБOЙCИ AЦПY
  ,LOG,
  M11:,BSS,1
 W06355:,BSS,1.
 C140:,LOG,140.
 C137:,LOG,137.
 CENDSTR:,LOG,176.
 C12:,LOG,12.
 C17:,LOG,17.
 CLEMPTY:,OCT,00177777 77777777.
 MINBUF:,LOG,144.
 CЧЖДY:,BSS,2.
 CЧ CИ:,BSS,2.
 ,END,.
  PRINTL:,NAME,
  FIRM:,IFSEQ,D,DD**FI
  INITSTR:,ENTRY,
  CHAT:,ENTRY,
  ERROR:,ENTRY,
  WRSUM:,ENTRY,
  :,33,
  ,UJ,*
  FIRM:,ELSE,
C
C... KYCOK ДPAЙBEPA  EC-ПEЧATИ
C... ПPИ OTCYTCTBИИ OHOЙ - MOЖHO ЗAMEHИTЬ KYKЛOЙ
C
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 BT:,EQU,4.
 C1:,EQU,BIT1.
 C3:,LC,1
 AB:,EQU,5.
 NS:,EQU,6.
 LB:,EQU,7.
 LN:,EQU,8.
 SM:,EQU,9.
 RI:,EQU,10.
 R1:,EQU,11.
 RT:,EQU,13.
  BASEPRTA:,LC,1
  RETPT:,SUBP ,
  LPWORK: ,SUBP  ,
  LPWAIT:,SUBP,
 SAVIND:,SUBP,.
  C200:,EQU,BIT8
  C177:,LC,1
 C7:,LC,1.
 C14:,LC,1.
 C77777:,LC,1.
 CLOMIR:,SUBP,.
 LBUF:,EQU,320B.
 *YCЫ: LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,(2),M1RDSC,STCLTA
 CON TIME:LC,BLOCK,(8),TAЦПY(2)
 *STATBUF:LC,BLOCK,(9),CTAT ПEЧ(2),(4),RPRI
 CИ MAX:,EQU,BIT7.
 TIME10:,SUBP,
 TEL OUT:,SUBP,
 CWLP1:,EQU,*YCЫ+10B.
 LMAT:,EQU,20B.
 RETURN:,SUBP,.
 PRINTASK:,SUBP,.
 NEWTA:,SUBP,.
 NLP:,EQU,12B.ИHД12 B ИПЗ PEДAKT.
 NP:,EQU,12
 C377:,LC,1
 CHECKLP:,SUBP,
 ALLTOISO:,SUBP,
 TP:,EQU,RI
 PERMIR:,SUBP,.
CAXAPOB, BEPETEHOB - YПЛOTHEHИE ИПЗ
C     ЯЧEЙKИ TИПA  П
 *460:B,BLOCK,NEMPTY,RQ,FIRST,SCAL,W
 ,CONT,R2,A/OUT,DT,NSI
 ,CONT,SCNT,NSIO,R3,NRC
C     ЯЧEЙKИ TИПA  PП
 *30 :B,BLOCK,QUEFLAG,ET,EBUF
 ,CONT,OVFLAG
 BEGMAT:,EQU,500B.
 FULWOR:,LC,1.
 C2004:,LC,1
  COMLP:,LC,1
  ШЛAГБAYM:LC,BLOCK,(13),SEMLP
  SEMDOWNS:,SUBP,
  SEMUP:,SUBP,
 *TYPELP:LC,BLOCK,(1),N ПPOT,CONЖДY,CDT
 PRINTL:,BSS,
 ,XTA,=2001.ПEЧATЬ
 15,ATX,RQ
  INITSTR:,ENTRY,
 INITSTR:,BSS,
  ,WTC,BASEPRTA
  14,VTM,
 ,XTA,SEMLPDWN
 ,UJ,SEMDOWNS
 SEMLPDWN:,Z00,SEMLP
 ,Z00,*+1
 ,XTA,BIT11.ПPOBEPИTЬ BB/BЫB
 RI,VTM,=6000
 RT,VJM,CHAT
 ,UZA,ERROR
 ,AAX,=5422
 ,U1A,ERROR
 15,ATX,NRC
 ,XTA,BIT10.PAЗBЯЗKA
 RT,VJM,CHAT
 ,U1A,ERROR.HE PAЗBЯЗAЛИCЬ
 15,XTA,RQ.COБCTBEHHO KOMAHДA
  14,UZA,.HA HAЧ. PRINTASK
 RT,VJM,CHAT
 ,AAX,=5422
 ,U1A,ERROR
 15,XTA,RQ
 ,AAX,BIT2
  14,U1A,LPWAIT-PRINTASK
 RI,VTM,BIT12
 ,XTA,BIT10.ПYCK KAHAЛA
 RT,VJM,CHAT
 ,UZA,ERROR.HE ПYCTИЛCЯ
  14,UJ,LPWORK-PRINTASK
  CHAT:,ENTRY,
 CHAT:,BSS,.ДABAЙ ПOГOBOPИM
 ,ATI,
 NP,033,70B.BЫCKAЗAЛИCЬ
 ,ATI,
 R1,VTM,-2
 WB:,BSS,
 ,ATI,
 NP,033,4070B.MOЖET OTBETИЛO
 15,ATX,R2
 RI,AAX,
 ,U1A,B.TAKИ OTBETИЛO
 R1,VLM,WB
 RT,UJ,.HE ДOЖДAЛИCЬ HYЖHOГO OTBETA
 B:,BSS,
 15,XTA,R2
 RT,UJ,
  WRSUM:,ENTRY,
  ,AOX,BIT12
  RT,VJM,CHAT.BЫДAЧA CИMBOЛA
  :,24,3
  ,UZA,ERROR.HET OTBETA
  ,AAX,BIT11.TOT ЛИ OTBET
  2,UZA,.-ДA
  ERROR:,ENTRY,
 ERROR:,BSS,
 15,ATX,R3
 ,ASN,64-36
 ,AUX,=6H'0''7''7''7''7''0'
 ,AOX,=6H 0000'0'
   :   ,24,2003B
 ,ATX,TL+1
  ,ITA,NP
  ,ARX,=6HOШ.LP1
  14,VTM,TL
 ,ATX,TL
 ,XTA,BIT10
 RT,VJM,CHAT.ПOПЫTKA PAЗBЯЗKИ
 15,XTA,R3
 ,AAX,BIT2
  ,UZA,PRERR
 ,XTA,C2004.YTOЧHИTЬ COCTOЯHИE
 RI,VTM,BIT11
 RT,VJM,CHAT
 ,XTA,BIT10
 RI,VTM,BIT12
 RT,VJM,CHAT
 15,ATX,W
 ,XTA,BIT10
  RI,VTM,BIT11
 RT,VJM,CHAT
 ,XTA,BIT10
 RT,VJM,CHAT
 15,XTA,W
 ,AAX,BIT12
 ,UZA,ERROR3
 15,XTA,R3
 ,AAX,=5420
  RT,VTM,-1
  :,U1A,*+1
  RT,VTM,776B
  :,ITA,RT
  15,AAX,W
   ,UZA,INITSTR
  ,ASN,64-39
  ERROR3:,BSS,
 ,AUX,=6H'7''7''7''0''0''0'
 ,AOX,=6H000'0''0''0'
  PRERR:,ATX,TL+2
  ,AEX,=6H100''''''
  ,UZA,PRERR3
  ,XTA,BIT37
  NP,ARX,CTATПEЧ
  NP,ATX,CTATПEЧ
  PRERR1:,ITA,14
  14,CALL,TELOUT
  PRERR2:,XTA,BIT13.CБPOC
  RT,VJM,CHAT.KOHTPOЛЛEPA
  ,XTA,SEMLPUP
  15,ATX,QUEFLAG
  ,UJ,SEMUP
  SEMLPUP:,Z00,SEMLP
  ,Z00,*+1
  :,XTA,=R10.0
  ,*57,13B
  :,24,3
  ,UJ,INITSTR
   PRERR3:15,XTA,NRC
  ,ARX,C1
  ,AAX,C7
  15,ATX,NRC
  ,AEX,C1
  ,UZA,PRERR1
  ,UJ,PRERR2
  TL:,BSS,3
  FIRM:,ENDIF,
 ,END,.
 *BUFLP1:,NAME,
CAXAPOB, BEPETEHOB - YПЛOTHEHИE ИПЗ
 PRINTASK:,SUBP,
 ,OCT,
 ИПЗ:,OCT,
 ,OCT,
 ,OCT,
 :,Z00,
 ,Z00,PRINTASK.
 ,OCT,
 ,LOG,2013.
 ,OCT,
 :,Z00,
 ,Z00,ИПЗ
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 ,LOG,317.
 ,OCT,
 ,OCT,
 :,Z00,
  ,Z00,ИПЗ+140B.BT
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 :,Z00,
 ,Z00,ИПЗ+140B.BE
 :,Z00,
  ,Z00,ИПЗ+460B.EBUF
 ,OCT,
 ,LOG,77460.LBUF
 ,BSS,75B-35B
 ,LOG,35.NSTRI
 ,BSS,461B-75B
 ,LOG,1.FIRST
 ,BSS,3
 ,LOG, 0.БAЗA ДЛЯ AЦПY 2
 ,BSS,557B-466B.
 ,END,*BUFLP1
 *BUFLP2:,NAME,
CAXAPOB, BEPETEHOB - YПЛOTHEHИE ИПЗ
 PRINTASK:,SUBP,
 ,OCT,
 ИПЗ:,OCT,
 ,OCT,
 ,OCT,
 :,Z00,
 ,Z00,PRINTASK.
 ,OCT,
 ,LOG,2013.
 ,OCT,
 :,Z00,
 ,Z00,ИПЗ
 ,OCT,
 ,OCT,
 ,LOG,1
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 ,LOG,317
 ,OCT,
 ,OCT,
 :,Z00,
  ,Z00,ИПЗ+140B.BT
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 ,OCT,
 :,Z00,
 ,Z00,ИПЗ+140B.BE
 :,Z00,
  ,Z00,ИПЗ+460B.EBUF
 ,OCT,
 ,LOG,77460.LBUF
 ,BSS,75B-35B
 ,LOG,35.NSTRI
 ,BSS,461B-75B
 ,LOG,1.FIRST
 ,BSS,3
 ,LOG,10.БAЗA ДЛЯ AЦПY 1
 ,BSS,557B-466B.
 ,END,*BUFLP2
 MAЛOMБ:,NAME,
C
C------------------------
  * И П Д :LC,BLOCK,XNF,XNFM(4),XNC,XNCM(2)
  ,CONT,Ш/CЛYЖ,Ш/FULL,Ш/ПOTOK(5)
  ,CONT,MБД
  ,CONT,(26)
  ,CONT,OUTJOBSC(5),SCMAMБ
  ,CONT,ROLOUTSC
  SCENDJO:,EQU,*ИПД+77B
  * И П K :,LC,1
  NMAT  :,WEQ,XNC
  NMATM1:,EQU,NMAT-1
  NF    :,WEQ,XNF
 NFM:,WEQ,XNFM
  NCM   :,WEQ,XNCM
  NMATL:,EQU,NF+NMATM1
  INFEX  :,EQU,*ИПK+NCM
  AДP/ИПЗ:,EQU,INFEX+NCM
C------------------------
  *677:B,BLOCK,BITS
  ,CONT,BIT48,BIT47,BIT46,BIT45,BIT44
  ,CONT,BIT43,BIT42,BIT41,BIT40,BIT39
  ,CONT,BIT38,BIT37,BIT36,BIT35,BIT34
  ,CONT,BIT33,BIT32,BIT31,BIT30
  ,CONT,BIT29,BIT28,BIT27,BIT26,BIT25
  ,CONT,BIT24,BIT23,BIT22,BIT21,BIT20
  ,CONT,BIT19,BIT18,BIT17,BIT16,BIT15
  ,CONT,BIT14,BIT13,BIT12,BIT11,BIT10
  ,CONT,BIT9,BIT8,BIT7,BIT6,BIT5,BIT4
  ,CONT,BIT3,BIT2,BIT1
 SELECT:,SUBP,
 FULSAV:,SUBP,
 NFRITR:,LC,1
 FLMAMБ:,LC,1
 SCALES:LC,BLOCK,(2),S1CLTA
 *YCЫ:LC,BLOCK,ГYC
 CWSWING:,EQU,*YCЫ+24B
  CWMT3:,EQU,*YCЫ+NMATL
 C7:,LC,1
 C77777:,LC,1
 C177:,LC,1
 WANTCHAN:,LC,1
 C1:,EQU,757B
 DRIDENT:LC,BLOCK,KYC
   TABDRU:LC,BLOCK,(16),DRUMOD
  *ПДИCK:,LC,
  LENTMD:,WEQ,*ПДИCK
 TPHYS:,LC,32
  B16/1:,LC,1
  C3:,LC,1
  B30/16:,LC,1
  TPAKTЫ :,EQU,163B
  GTRMASK:LC,BLOCK,MASK
  FICDRU:,EQU,10.ДЛЯ TPAKTOB ПOДKAЧKИ
  FULWOR:,LC,1
  C77:,LC,1
  C37:,LC,1
  MASK12:,LC,
 MAЛOMБ:,BSS,
 C3777:,LC,1
 ,XTA,BIT1
 ,ATX,FLMAMБ. ЗAПPET ЗAПYCKA
 ,XTA,NFRITR. CBOБ TPAK +1
 ,UZA,HETTPAK. COBCEM ПЛOXO
 ,XTA,ROLOUTSC. CБPACЫBAETCЯ
 ,AOX,OUTJOBSC. BЫБPACЫBAЮT
 ,AOX,SCENDJO . CAMA KOHЧAETCЯ
  14,AAX,BITS
  ,U1A,BЫДAЧA.HY И ЛAДHO
C-- ПPOБA - OДHA ЛИ ЗAДAЧA
  8,VTM,1-NMAT
  *//*:8,XTA,CWMT3
  ,AEX,KYC
  ,ASN,64+42
  ,UZA,*/*.ЭTO MЫ
  8,XTA,CWMT3
  ,AAX,B30/16
  */*:,U1A,CLOSET
  8,VLM,*//*.ЗAДAЧA OДHA -
  ,UJ,BЫДAЧA. - TPAKT ДAEM
C
  CLOSET:,BSS,
C--  MЫ HE OДИHOKИ
C--  ПOCEMY HAC CЛEДYET ПPИKPЫTЬ
  ,XTA,SCMAMБ
  14,AOX,BITS
  ,ATX,SCMAMБ
  ,UTC,TMAЛO-THET
  HET TPAK:8,VTM,THET
  14,XTA,*YCЫ
  ,ASN,64-27
  ,AUX,=6H'''''7''7'''''
  ,AOX,=6H Ш00''''
  8,ATX,1
  :,24,2003B
  ,ITA,8
  14,MTJ,8
  14,CALL,TTPRINT
   :    ,24,3
  8,MTJ,14
  ,XTA,NFRITR
  ,UZA,*
  ,UJ,BЫДAЧA
C---------
  TAKETR*:,ENTRY,
C****** BXOД 2 : OTKAЗ OT TPAKTA
C      DRIDENT - KAK ПPИ ЗAXBATE
C      BЫXOД ПO 13 PEГИCTPY.
C      ПOPTЯTCЯ PEГИCTPЫ : 7,8,9,10,14
C
   :    ,24,2003B
  7,VTM,.ПPИЗH. "OTKAЗ"
 GIVTRACK: ,ENTRY,
C****** BXOД 1 : ЗAXBAT TPAKTA
C           ИHФOPMAЦИЯ B  D R I D E N T :
C           48-43    ДHЗ ЗAДAЧИ
C           10-6     MAT. N MБ
C            5-1     MAT. N TPAKTA
C***   ПOДKAЧKA XOДИT TAK ЖE, HO C '1' 42P.
C      ИCПOЛЬЗYЯ 'TPAKTЫ' 00-50.
C***   ПOPTЯTCЯ PEГИCTPЫ: 8,9,10,14
C      BЫXOД ПO 7 PEГ.
C      HA CYMMATOPE - K Y C  ДЛЯ ФИЗ.OБM.
C      ECЛИ TPAKT - ИЗ SCR.OБЛACTИ,
C      TO B 48 P. KYC-A  '1'
C      B ЭTOM CЛYЧAE 'N MБ' B KYC-E
C      ИHTEPПPETИPYETCЯ KAK ГЛOБ.HOMEP
C      ЭKCTEHTA, A 'N TPAKTA' - KAK
C      AДPEC BHYTPИ ЭKCTEHTA.
C      14 PEГ.= 0, ECЛИ БЫЛ ЗAXBAT
C---------------------------------------
  ЗAXBATTP:,XTA,KYC
  ,ASN,64+2
  ,ATI,10.N KЛETKИ B ИПЗ.
  ,ASN,64+40
  ,ATI,14.ДHЗ
  14,WTC,*YCЫ
  10,UTM,TPAKTЫ.CTPOKA B ИПЗ.
  ,XTA,KYC
  ,AAX,C3
  ,ATI,9
  9,XTA,MASK12
C--  ПOЛYЧEHИE MACKИ 12-P. БAЙTA B ИПЗ
  9,VTM,0.HAЧHEM C MБ
  ,ATX,MASK
C--  ДЛЯ USER-A ПPOBEPИM, HE MOДEЛИPYETCЯ
C--  ЛИ EГO БAPAБAH.
  ,XTA,KYC
  ,ASN,64+5
  ,ATI,8.MБ
C--  HE OT ПOДKAЧKИ ЛИ ИДEM
  ,AAX,BIT37
  ,U1A,FROMSWIN
  10,UTM,FICDRU
  ,XTA,MБД
  8,AAX,BIT48
  ,UZA,ISTRACK
  9,VTM,16.HAЧHEM C MД
C--
C--  ПPOБA: ECTЬ ЛИ YЖE ЭTOT TPAKT
  ISTRACK:10,XTA,
  ,APX,MASK
  ,UIA,TRACKIS.ECTЬ
  7,VZM,TAKRET.БЫЛ OTKAЗ
C--  HYЖEH ЗAXBAT.
C--  ПPOБA HA MAЛOMБ.
  ,XTA,NFRITR
  ,ARX,RESERVTR
  ,UZA,MAЛOMБ
  ,UJ,BЫДAЧA
C--
  FROMSWIN:,BSS,
  9,VTM,.SWING-HAЧ C MБ
  ,WTC,KYC
  8,VTM,-50B
  8,VIM,ISTRACK.HE ИПЗ
 14,UTC,-NFM
  10,VTM,AДP/ИПЗ
  ,UJ,ISTRACK
C--
  TRACKIS:9,VTM,
   ,ARX,
   ,U1A,ITISDRUM
   9,VTM,16
   ITISDRUM:7,VIM,GIVRET
   ,AUX,TAKCON
  ,ATI,8.TRAKT
  ,ASN,64+15
  ,ATI,14.MБ
  ,ASN,64+3
  ,UZA,V PAGE
C--  YBEЛИЧEHИE CЧETЧИKA CBOБOДHЫX
  14,XTA,BIT16-10B.
  ,AAX,1
  ,AAX,B16/1
  9,ASN,64
  ,U1A,TAK1
  ,XTA,BIT1
  ,ARX,NFRITR
  ,ATX,NFRITR
  ,ARX,RESERVTR
  ,UZA,TAK1
  ,XTA,
  ,ATX,SCMAMБ
  ,ATX,FLMAMБ
 ,ATX,S1CLTA
  TAK1:,BSS,
C--  ЧИCTKA B ШKAЛE ЗAHЯTOCTИ
  9,VIM,TAK2
  14,MTJ,9
  9,UTM,-7
  ,UJ,TAK3
  TAK2:,ITA,14
 9,UTM,1
   ,UTC,TABDRU-1
  9,AEX,
  ,AAX,C77
  ,U1A,TAK2
  TAK3:8,XTA,BIT48
  ,AEX,FULWOR
  ,UTC,TABDRU-1
  9,AAX,
  ,UTC,TABDRU-1
  9,ATX,
C--  ЧИCTKA KЛETKИ B ИПЗ
  TAK4:10,XTA,
  ,AOX,MASK
  ,AEX,MASK
  10,ATX,
C--
 TAKRET:,BSS,
  13,UJ,
C--   "TPAKT" B ФИЗ.ПAMЯTИ
  V PAGE:10,XTA,
  ,APX,MASK
  ,ASN,64-12
  ,YTA,
  ,ATI,14
  ,XTA,
  14,ATX,TPHYS
  ,UJ,TAK4
C--
C--  ПOИCK CBOБOДHOГO TPAKTA MБ
C--  ИЛИ ЗOHЫ B SCRATCH-OБЛACTИ
  BЫДAЧA:14,VTM,1-LENTMD
  8,VTM,DRUMOD
  9,VIM,S/FREE
  14,VTM,1-16
  ,XTA,WANTCHAN
  ,UZA,S/DRUM
  14,VTM,1-8
  ,UTC,8
  S/DRUM:8,VTM,TABDRU
  S/FREE:8,XTA,
  ,AAX,B16/1
  ,UZA,NEXT
  8,XTA,
  ,AEX,FULWOR
  ,AOX,B16/1
  ,AEX,B16/1
  ,U1A,FR/IS
  NEXT:8,UTM,1
  14,VLM,S/FREE
C--  B OДHOЙ OБЛACTИ HE HAШЛИ
C--  ПOИЩEM B ДPYГOЙ
  9,VIM,БAPAБAH
  ,XTA,WANTCHAN
  9,VTM,16
  ,UZA,BЫДAЧA
C--  БЫЛO ПPOCMOTPEHO TOЛЬKO OДHO
C--  БAPAБAHHOE HAПPABЛEHИE.
C--  ЗAГЛЯHEM B COCEДHEE.
  ,XTA,
  ,ATX,WANTCHAN
  БAPAБAH:,BSS,
  9,VTM,
  ,UJ,BЫДAЧA
C--
C--  TPAKT HAЙДEH. XOMYTHEM EГO.
  FR/IS:,ANX,C77777
  ,ATI,14.N TPAKTA
  14,XTA,BIT48
C--  B ШKAЛY ЗAHЯTOCTИ
  8,AOX,
  8,ATX,
C--  B ИПЗ ЗAДAЧИ ПИШEM N MБ И TPAKTA
C    ECЛИ TPAKT-SCRATCH, TO 'N MБ' -
C   - ECTЬ ГЛOБAЛЬHЫЙ N ЭKCTEHTA ИЗ
C    SCRATCH-OБЛACTИ.
  ,ASN,64-5
  ,ATX,WS
  ,ITA,14
  ,AOX,WS
  ,ASN,64-36
  ,ATX,WS
  ,AUX,MASK
  10,AOX,
  10,ATX,
C--  YMEHЬШEHИE CЧETЧИKA CBOБOДHЫX
  ,XTA,NFRITR
  ,ARX,B16/1
  ,AAX,B16/1
  ,ATX,NFRITR
  9,VIM,DISC**
C-- KOPPEKЦИЯ WANTCHAN
  ,XTA,BIT4
  ,AEX,WANTCHAN
  ,ATX,WANTCHAN
  ,UJ,EXIT
C-- HEOБXOДИMO YBEЛИЧИTЬ PEЗEPB
  DISC**:,XTA,BIGRESER
  ,ATX,RESERVTR
  EXIT:,XTA,WS
  14,VTM,.БЫЛ ЗAXBAT
  GIVRET:,AUX,DRMASK
  7,UJ,
C---
  RESERVTR:,LOG,7777 7777 7777 7767.8 TPAKTOB
  BIGRESER:,LOG,7777 7777 7777 7737.32 TPAKTA
C-----------------------
  TAKCON:,BSS,
   ,LOG,4000 0000 0770 0037
  DRMASK:,BSS,
  ,LOG,4070 0000 0000 1774
  THET:,ISO,6HHET MБ
  WS:,LOG,
  TMAЛO:,ISO,12HMAЛOMБ
 ,END,
  PUT16:,NAME,
  COMPUT16:LC,BLOCK,CANYBY,NUM8,BN8
  TYPEMT:,SUBP,
  BC16MC:,EQU,TYPEMT-3
  BIT11:,EQU,745B
C
C   BЫЧИCЛEHИE YBY-ШHЫX ПAPAMETPOB
C   ЛEHTOЧHOГO KAHAЛA KBY
C   ЗAДAHHOГO HA BXOДE B И.P.14
C
  PUT16:14,XTA,BC16MC
  ,ASN,64+3
  ,ATX,CANYBY
  ,ASN,64+15
  ,ATX,NUM8
  ,ASN,64+15
  ,AAX,BIT11
  ,ATX,BN8
  5,UJ,
  ,END,
  ABCHT:,NAME,
C
C***  ABAPИЙHOE CHЯTИE ЗAKAЗA HA OБMEH
C
C     CYMMATOP =  K Y C
C     PEГИCTP  D   = HOMEP ДИAГHЛCTИKИ
C          ИЛИ 0, ECЛИ ЗAДAЧY HE CHИMATЬ
C     PEГИCTP  X   = AДPEC XAPAKTEPИCTИKИ
C          OБMEHA (CYMM. ИЛИ PMP ЗAДAЧИ)
C     PEГИCTP  S   = 0 ДЛЯ ЛEHT ИЛИ AДPEC
C          PEЗYЛЬTATA OБMEHA ДЛЯ ДИCKOB
C     ДЛЯ ЛEHT PEГ.14 = HOMEP HAПPABЛEHИЯ
C     B  K Y C -E  БИT 38 CЧИTAETCЯ
C     ПPИЗHAKOM 'ЗAДAЧA ЗAKPЫTA',  БИT 18
C     - ПPИЗHAKOM 'HYЖHA BПPABKA KOHTPOЛЯ'
C
C     BЫXOД ПO  R.  ПOPTЯTCЯ: IF,L.
C     HA BЫXOДE B  IF - AДPEC ИПЗ ЗAДAЧИ
C
  PRIP TRA:,SUBP,
  ERRMACRO:,SUBP,
  TYPE MT :,SUBP,
  * Y C Ы :,LC,1
  RET TRA :,LC,1
  TPHYS   :,LC,1
  C2003   :,LC,1
  DISREG  :,LC,1
  C77     :,LC,1
  C13     :,LC,1
  *700:B,BLOCK,B48(10),B38(20),B18
  ST/EXCH:,EQU,-2
  *0:,BLOCK,AC(2),PMP,R33(2),R27(3),R14
  D:,EQU,7
  X:,EQU,9
  S:,EQU,11
  R:,EQU,6
  L:,EQU,10
 IF:,EQU,4
C
  ,ATX,KYC
  ,ASN,64+42
  ,ATI,IF
  IF,WTC,*YCЫ
  IF,VTM,
  ,XTA,KYC
  ,AAX,B38
  ,UZA,ISOPEN
  X,XTA,
  IF,ATX,PMP
  S,XTA,
  IF,ATX,AC
C...  ПPABKA 'KOHTPOЛЯ ЧИCЛA'
  CONTR:,XTA,KYC
  ,AAX,B18
  R,UZA,
  5,MTJ,L
  ,XTA,KYC
  ,AAX,KPMASK
  R,UZA,.HE OБMEH
  5,VJM,PRIP TRA
  L,MTJ,5
  L,VTM,-1023
  ,XTA,A/INT
  ,ATX,RET TRA
C
  CONTR1:,XTA,C2003
  ,ATI,21B
  ,ATI,
   :    ,24,2002B
  L,XTA,70000B+1023
  ,ATI,
  CONTR2:,24,2002B
  L,ATX,70000B+1023
   :    ,24,3
  L,VLM,CONTR1
  S,VIM,EXIT
C...  BOCCT.ПOCЛ.CЛOBA ЛИCTA ДЛЯ ЛEHT
  ,XTA,C2003
  ,ATI,21B
  ,XTA,RET TRA
  ,ASN,64+24
  ,ATX,RET TRA
  14,WTC,TYPE MT - 3
  ,XTA,5.*****
 ,ATI,
 ,ATI,
  CONTR3:,24,2002B
  ,ATX,71777B
C...   B Ы X O Д
  EXIT:,24,2003B
  ,XTA,C13
  ,ATI,21B
  R,UJ,
C
C...  ЗAДAЧA HE БЫЛA ЗAKPЫTA
C
  ISOPEN:,XTA,KYC
  ,APX,KPMASK
 ,ASN,64+41
  ,ATI,L
  L,XTA,TPHYS
  ,ASN,64+21
  ,AAX,C77
  ,ATI,L
  L,XTA,B48
  IF,AOX,ST/EXCH
  IF,ATX,ST/EXCH
  D,VZM,CONTR
C...  ЗAДAЧE - BXOД B ERRMACRO
  X,XTA,
  IF,ATX,AC
  ,ITA,D
  IF,ATX,R14
  ,XTA,DISREG
  IF,ATX,R27
  L,VTM,ERRMACRO
  ,ITA,L
  IF,ATX,R33
  ,UJ,CONTR
  A/INT:,Z00,CONTR3
  ,Z00,CONTR2
  KPMASK:,LOG,1 4037 0000
  K Y C :,BSS,1
  ,END,
 MTDISPAC:,NAME,
  R:,EQU,5
  S:,EQU,6
  J:,EQU,9
  M:I,BLOCK,(1),N,RZ,NAMET
 C7777:,LC,1
  ,AAX,C7777.EE HOMEP
  ,ATX,N
  ,NTR,7
  ,A-X,I10T
  ,UZA,STRCOD.XИTPЫЙ KOД
  J,VTM,-4
  S,VJM,DIV.HA 10
  ,ATX,RZ
  ,XTA,M.ЧACTHOE
  ,ATX,N
  S,VJM,DIV
  ,XTA,M
  ,ASN,64-4
  ,AOX,N.OCTATOK
  ,ASN,64-4
  ,AOX,RZ
  ,UJ,RET
  STRCOD:,ATX,N.ПEPEKOДИPOBKA
  ,XTA,. ИMEHИ
  ,ATX,RZ.BOЛKOBA
  J,VTM,-12
  LOOP:,XTA,N.HOMEP
  J,A-X,CSUB+12.ПPOБA HA.GE.10
  ,UZA,OK.ШECTH.ЦИФPA
  S,VJM,DIV
  ,XTA,M.
  J,ASN,64+4
  J,UTM,4
  ,AOX,RZ
  ,ATX,RZ
  ,UJ,LOOP.ЗA CЛEД.ЦИФPOЙ
  OK:J,A+X,CADD+12.ЦИФP.HA MECTO
  ,A+X,RZ.CTAPШ.ЦИФPЫ
  RET:,AOX,STNAM.CTAHД.ИMЯ
  R,UJ,
  DIV:,BSS,
  ,XTA,N.ДEЛEHИE
  J,A*X,CDIV+12
  ,ATX,M.ЧACTHOE
  J,A*X,CMUL+12
  ,YTA,64
  ,X-A,N.OCTATOK
  ,ATX,N
  S,UJ,
  I10T:,,
  ,,1000
  CDIV:,LOG,4000 0644 0644 0645
  CMUL:8,,
  ,,156
  CSUB:,,
  ,,1560
  CADD:,,
  ,,2560
  :,LOG,4002 5252 5252 5253
  :8,,
  ,,6
  :,,
  ,,60
  :,,
  ,,160
  :,LOG,4001 4631 4631 4632
  :8,,
  ,,10
  :,LOG,
  :,,
  ,,10
  STNAM:,TEXT,8HDISPAC
  M:,BSS,4
 ,END,
 SCDICH:,NAME,.PEЖИMЫ ДИCKA
C...   ПEPBOE CЛOBO - ЛИCT CEKTOPHOГO
C     OБMEHA B BИДE KYCA И PAЗPЯД 19.
C      0 BO 2-OM - COBMEЩEHИE ПOДBOДOB.
C      0 B 3-M - ЗAПИCЬ БEЗ KOHTPOЛЯ.
C      4-OE И 5-OE CЛOBA OБOЗHAЧAЮT TИПЫ
C      ДИCKOB HA 3-M И 4-M HAПPABЛEHИЯX.
C      =:400 OЗHAЧAET ДИCKИ HA29 MEГAБAЙT
C      =0    OЗHAЧAET ДИCKИ HA 7 MEГAБAЙT
 ,LOG,41370000.CEГM.1,ЛИCT 37B
 ,LOG,1
 ,LOG,4
 ,OCT,4
 ,OCT,
 BUFTRA:LC,BLOCK,(1),IFTRA(24),TRPRIP
 TPHYS:,LC,64
 ,DATA,
 CPR:,LOG,43700000.ПPИП. 33B ЛИCTA
 C1:,LOG,1
 1,SET,CPR
 1, ,TRPRIP+1
 1,SET,C1
 1,   ,TPHYS+77B
 ,END,.
  DECLET:,NAME,
C**************************************
C   ПEPEBOД LOG-KOHCTAHTЫ B 10-PИЧHЫЙ
C   TEKCT ISO C ПOДABЛEHИEM ЛEBЫX HYЛEЙ
C**************************************
  BIT5:,EQU,753B
  ,ATX,ACC.
  ,ITA,15
  ,ATX,RET
  ,XTA,=6H
  ,ATX,RES
  ,NTR,7
  15,VTM,48
  ,XTA,ACC
  L1:,A*X,KSP.1/10
  ,ATX,C1.ЧACTHOE
  ,ASN,64-2
  ,ARX,C1
  ,ASN,64-1
  ,X-A,ACC
  ,ATX,ACC.OCTATOK
  ,AOX,BIT5
  15,ASN,64-48
  ,AOX,RES
  ,ATX,RES
  ,XTA,C1
  ,UZA,END
  ,ATX,ACC.ЧACTHOE
  15,UTM,-8
  15,VIM,L1
  END:,XTA,RES
  ,WTC,RET
  ,UJ,
  AUTOR:,ENTRY,
C
C...   ФOPMИPOBKA CЛYЖ.CЛOBA
C      1-E HA MД,  4-E HA MЛ
C   48-43 : ДHЗ ABTOPA ЗAПИCИ
C   42-37 : HOMEP YCTPOЙCTBA
C   36-27 : HOMEP PASS'A ПИCABШEГO
C   25-21 : ГOД-1968
C   20-17 : MECЯЦ
C   16-12 : ДEHЬ
C   11-1  : 60*ЧACЫ+MИHYTЫ
C
  AUS:,EQU,117B
  *YCЫ  :,LC,1
  TODAY :,LC,2
  C1777 :,LC,1
C---
  ,APX,=7770 0000 0000 1600
  ,ATX,RES
  ,ASN,64+42
  ,ATI,9
  9,WTC,*YCЫ
  ,XTA,AUS
  ,AAX,C1777
  ,ASN,64-26
  ,AOX,RES
  ,AOX,TODAY+1
  5,UJ,
  KSP:,LOG,4001 4631 4631 4632
  RET:,BSS,1
  RES:,BSS,1
  ACC:,BSS,1
  C1 :,BSS,1
  ,END,
 DISC:,NAME,
C
C......   MOДYЛИ ДИCKOBOГO ДPAЙBEPA
C          ПAPAMETPЫ CПOCOБA ПOДKЛЮЧEHИЯ
 NCHD:,EQU,2.ЧИCЛO KAHAЛOB
 NMODG:,EQU,16.ЧИCЛO MOДYЛEЙ
C         БЛOKИ, OБЩИE C ЗAДAЧEЙ OБMEHA
  *ИПД:LC,BLOCK,(4),XNW,(22),MONOS
  ,CONT,(14),OUTJOBSC
  MTRACNT:,EQU,*ИПД+27B
  LQTRA:,WEQ,MTRACNT
 RETTRA:LC,BLOCK,RECONNUM
  SCALSTRA:LC,BLOCK,(12),(32),SQTM(16),SCTMOD
  LISTSTRA:LC,BLOCK,WL1
  WL2:,EQU,WL1+LQTRA
 TRABUS:LC,BLOCK,SCTATRA
 SCDICH:,SUBP,.
 SCDICH:I,BLOCK,(1),REGW,TYPWR,TYPD
 KOWNP:,EQU,SCDICH.CBOЙ ЛИCT (KYC)
C         ЭKBИBAЛEHTHOCTИ ЧИCЛAM
 BEGMT:,EQU,30B
 SM:,EQU,3
 M14:,EQU,8
 NMAT1:,EQU,30B
C      ЗHAЧEHИЯ CЛYЖEБHЫX CЛOB.
 NAMED1:,EQU,3.ПEPBOE ИMЯ.
 NAMED2:,EQU,NAMED1+4.BTOPOE ИMЯ.
  IDEN:,EQU,1.ABTOP ЗAПИCИ
C         OБAЗHOЧEHИE ИHДEKC-PEГИCTOB.
 K:,EQU,1.HOMEP MOДYЛЯ
 KI:,EQU,2.K.EQ.7
 J8:,EQU,3.HOMEP KAHAЛA*8
 C:,EQU,4.
 R5:,EQU,5.
 W:,EQU,7.
 P:,EQU,8.TИП OБMEHA
 R9:,EQU,9.
 A:,EQU,6.N MOД.AБCOЛЮTH.
 N:,EQU,11.
 M:,EQU,12.MECTO B ГЛAB.OЧ.
 R:,EQU,13.PEГ. BOЗBPATOB
 RL:,EQU,15.ДOП. BOЗBPAT
 J:,EQU,14.HOMEP KAHAЛA
C         TИПЫ OБMEHA.
 WRITE:,EQU,0.ЗAПИCЬ
 READ:,EQU,2.ЧTEHИE
 RAZMT:,EQU,1.PAЗMETKA
 CONTR:,EQU,3.CPABHEHИE
 COWRI:,EQU,4.ЗAП.C CPABHEHИEM
 RHEA:,EQU,6.ЧTEH. ЗAГOЛOBKA
 QUREA:,EQU,7.OПPOC ГOTOBHOCTИ
 *677:B,BLOCK,BITS
 ,CONT,BIT48,BIT47,BIT46,BIT45
 ,CONT,BIT44,BIT43,BIT42,BIT41
 ,CONT,BIT40,BIT39,BIT38,BIT37
 ,CONT,BIT36,BIT35,BIT34,BIT33
 ,CONT,BIT32,BIT31,BIT30,BIT29
 ,CONT,BIT28,BIT27,BIT26,BIT25
 ,CONT,BIT24,BIT23,BIT22,BIT21
 ,CONT,BIT20,BIT19,BIT18,BIT17
 ,CONT,BIT16,BIT15,BIT14,BIT13
 ,CONT,BIT12,BIT11,BIT10,BIT 9
 ,CONT,BIT 8,BIT 7,BIT 6,BIT 5
 ,CONT,BIT 4,BIT 3,BIT 2,BIT 1
C         HAЗBAHHЫE БИTЫ
 MABT:,EQU,BIT4
 B1PCK:,EQU,BIT3
 BNEWM:,EQU,BIT11.HECOBП.AДP.
 BITDISK:,EQU,BIT46
 BERCPU:,EQU,BIT25
 BITCO:,EQU,BIT44..CЧET.OШИБOK
 BITDIAG:,EQU,BITCO-3.
 BSKAL:,EQU,BIT46.CЧET. YCT 0
 BINTR:,EQU,BIT12.БИT AB. B WL1
 BBSTOP:,EQU,BIT6.ДЛЯ MYЛЬTИTAЙПA
  MBIDEN:,EQU,BIT12.HECOBП.ИД.
 XRAZMT:,EQU,BIT1.RAZMT B MOЗY
 XREAD:,EQU,BIT2.READ B MOЗY
 BSECT:,EQU,BIT7.CEKTOPHЫЙ OБMEH
  BMONCH:,EQU,BIT39.ПP.ЗAK. C MOHOП.
C         БИTЫ CTATYCA B CUORD
 BBLTT:,EQU,BIT4.БЛOKИPOBKA TT
 BTMOD:,EQU,BIT5.HAПPABЛEH HA MOД
 B1O:,EQU,BIT6.OДHOKPATHOCTЬ
 BNOTST:,EQU,BIT38.ПEPEXBAT OTKAЗA
C         БИTЫ CTATYCA B WL1
 BCLOSE:,EQU,BIT38.БЛOK.ЗAKAЗЧИKA
 BTMODE:,EQU,BIT5.HAПPABЛEH HA MOД
C         KOHCTAHTЫ B KOMMOHAX
 C3:,LC,1
 C7:,LC,1
 C377:,LC,1
 C7777:,LC,1
 B24/1:,LC,1
 FULWOR:,LC,1
 C13:,LC,1
  C37:,LC,1
 C2003:,LC,1
 DISREG:,LC,1
 B48/31:,LC,1
  B48/47:,LC,1
 C1400:,LC,1
 C14:,LC,1
 *CB:LC,BLOCK,
 ,CONT,CDIAG(0),B48/44
 ,CONT,B4/1,ZPAG(0),Z25/7
 ,CONT,(1),B48/13,B13/2
C         CПEЦ.HAЗBAHИЯ KOHCTAHT B KOMMOHAX
 XRAEQRE:,EQU,C3.XRAZMT.EQ.XREAD
 XQREA:,EQU,C7
C         CEMAФOPHЫE OПEPAЦИИ БЫCTPЫX KПДП
 CHPOP:,SUBP,
 CHVOP:,SUBP,
C         CEMAФOPHЫE OПEPAЦИИ ЛИCTA
  PS*POP:,SUBP,
  PS*VOP:,SUBP,
C         T A Й M E P Ы
  TIMERS:LC,BLOCK,(2),TIMEX(2)
 MAX TIME:,EQU,BIT9.ПPИMEPHO 1.8 C.
C         BXOДЫ B TRAM70
 KOHOБMEH:,SUBP,
 ENDMAC70:,SUBP,
 PRIPTRA:,SUBP,
 SUMMING:,SUBP,
 TASKOFF:,SUBP,
 S48TO12:,SUBP,
 TRAINT :,SUBP,
  GIVTRA:,SUBP,
  AFGVTR:,SUBP,
  BC1700:,SUBP,
C         БЛOKИ CBЯЗИ C KAHAЛOM OПOЗHABAHИЯ
 ENSPTR:,SUBP,
 CMDREC:LC,BLOCK,DREADY(0),SCKILD
C         ПPOЧИE ДИCПETЧEPCKИE БЛOKИ
  *SWCMN:LC,BLOCK,(3),EXCHSC
  DISPBASE:LC,BLOCK,(6),NEVM.B 48-47 P.
 ABCHT:,SUBP,.П/П AB.CHЯTИЯ
 RETURN:,SUBP,
 STATIST:,SUBP,
 CLOMIR:,SUBP,
 PERMIR:,SUBP,
 TTPRINT:,SUBP,
 ERRMACRO:,SUBP,
  DECLET:,SUBP,
  *ПДИCK:LC,BLOCK,PRDK
C---- TEKCTЫ ДИAГHOCTИK HA AЦПY :
  *24:,BLOCK,DERT,TASD,TWBP
 *YCЫ:LC,BLOCK,ГYC,RDSCAL
  SMASAV:LC,BLOCK,SAVAC
 *DISCS:LC,BLOCK,DNAMIN(16)
 *STATBUF:LC,BLOCK,(14),COUNTTR
C         OПИCAHИE ПPИЗHAKA ПP.AND..NOT.ПЗ
 REGSCAL:,EQU,100B
 BLMUL:,EQU,BIT6
C......   COБCTBEHHЫE БЛOKИ ДИCKOB
 *DSCRFI:LC,BLOCK,YINT,YINT1,Y1,Y,Y5
 ,CONT,QRTR(2) .OЧ.ГOT.OБMEHOB
  ,CONT,FLMNCH(2)
  CUORD:,EQU,*DISCS+NMODG
C
C----------------------------------
C
C   +++   OПИCAHИE CTPYKTKP ЯЧEEK:
C
C......   01   WL1 ИЗ COMMON LISTSTRA
C         ПPEДCTABЛЯET ЗAKAЗ(KYC) HA OБMEH
C         B ГЛABHOЙ OЧEPEДИ ЗAДAЧИ OБMEHOB.
C         48-43P - ДHЗ ЗAДAЧИ, ДABШEЙ ЗAKAЗ
C         42-40P - HOMEP HAПPABЛEHИЯ.
C       39 PAЗP - ПPИЗH.CBЯЗИ C MOHOПOЛИEЙ
C         38P    - ПPИЗHAK ЗAKAЗA OT TRAPHY.
C         34-26P - HOMEP ДOPOЖKИ + 8
C         25-24P - HOMEP CEГMEHTA MOЗY.
C         19P   -ПPИЗHAK ЛИCTOBOГO OБMEHA.
C         18P И 3-1P - KOД TИПA OБMEHA.
C         17-13P - HOMEP ЛИCTA ФИЗИЧECKИЙ.
C         10- 8P - HOMEP MOДYЛЯ.
C         6P - ПPИЗHAK ПEPEXBATA PEAKЦИИ
C                  HA OШИБKИ.
C
C......   02 CUORD
C         ПPEДCTABЛЯET TEKYЩEE COCTOЯHИE
C                  OБMEHA HA MOДYЛE.
C
C         48-44P - CЧETЧИK OШ. OБMEHOB.
C              1KAЛИБP.=4OШ.OБM.
C         38P   - ФЛAГ ПEPEXBATA PEAKЦИИ.
C         37-26P - TEKYЩИЙ HOMEP ДOPOЖKИ.
C         25-24P - HOMEP CEГMEHTA MOЗY.
C         19P - ПPИЗHAK ЛИCTOBOГO OБMEHA.
C         18P - ПPИЗHAK CЧИTЫBAHИЯ YBY.
C         17-13P - HOMEP ЛИCTA ФИЗИЧECKИЙ.
C         6P - ПPИЗHAK ПEPEXBATA PEAKЦИИ.
C         10-8P - TEKYЩИЙ ИДEHTИФИKATOP.
C         3-1P - TИП OБMEHA(ЧTEHИE,ЗAП....)
C
C----------------------------------
C
C++++++++++++++++++++++++++++++++++
C    OБPAБOTKA ДИCKOBЫX ПPEPЫBAHИЙ
C    BEPCИЯ OT 30'06'73
C++++++++++++++++++++++++++++++++++
C         ПOЛYЧEHИE HOMEPA KAHAЛA * 8
 ,ITA,J
 ,ASN,64-3
 ,ATI,J8
 ,NTR,7
   :   ,24,3
C         ПPOБA, CBOЙ ЛИ KMД
 J,XTA,KMD OWN-SM.
 ,UZA,GET KMD.БЫЛ ЧYЖOЙ
C         ПPEPЫBAHИE HE ПO ПPИBЯЗKE
C          HE БЫЛO ЛИ ACД:
 J,XTA,FLASD-SM
 ,U1A,MINT.HE БЫЛO
C          HET KOHЦA OБMEHA ИЛИ
C          ПOДBOДA, CЛEД. ИMEEM ACД.
 J,XTA,CNMOD-SM.N TEKYЩEГO
 ,ATI,K.MOДYЛЯ B ПPЯMOM
 ,AEX,C7.И OБPATHOM
 ,ATI,KI.KOДAX
C         YCTAHOBKA A(AБCOЛЮTHЫЙ HOMEP)
 RL,VJM,YCTA
C         CБPOC ФЛAГA ASD(FLASD.NE.0)
 ,XTA,BIT40
 J,ATX,FLASD-SM
 KI,XTA,BIT8
   ,AEX,FULWOR
  J,AAX,CODM-SM
  J,ATX,CODM-SM
C          BЫБPOC И OTKPЫTИE ЗAДAЧИ -
C          - XOЗЯЙKA ЗAKAЗA C ACД.
 W,VTM,T ASD+1
C       HA БЛOK ПPOBEPKИ CTATYCA.
C       ЗAKAЗ ЛИБO БYДET CHЯT KAK
C       ABAPИЙHЫЙ, ЛИБO ПEPEBEДEH
C       B COCTOЯHИE HEГOTOBHOCTИ.
 ,UJ,ISTHISAC.HE KAЮK ЛИ
 MINT:,BSS,.(4)
C......   OЬPAБOTKA ПPEPЫBAHИЙ ПOДBOДA
 J,XTA,DINT-SM
 ,UZA,TINT.HA OБP.OБMEHA
C         YCTAHOBK.ПAPAMETPOB MOДYЛЯ(K,KI,A)
 RL,VJM,YCTAPE
C         BЫЧEPKИBAHИE БИTA ИЗ DINT.
 KI,XTA,BIT8
 J,AEX,DINT-SM
 J,ATX,DINT-SM
 RL,VTM,MINT.HA CЛEД.MOДYЛЬ
 SETRT:,BSS,
C......   ПOДПPOГPAMMA. BOЗBPAT - RL.
C         ЗAHECEHИE B OЧEPEДЬ
C         ГOTOBЫX OБMEHOB
 ,ITA,K
 J,ASX,QRTR-SM.CДBИГ HA KOHEЦ
 J,AOX,QRTR-SM.ЗAHECEHИE
 ,E+N,64-3.ИЗMEHEHИE KOHЦA
 J,ATX,QRTR-SM.
 RL,UJ,
 TINT:,BSS,.(6)
C         BCE ПOДBOДЫ OБPAБOTAHЫ
 J,XTA,DBUC-SM.БЫЛ ЛИ OБMEH
  ,UZA,IFLTWSC
C......   OБPAБOTKA OБMEHA
C         OПPEДEЛEHИE HOMEPA MOДYЛЯ
 J,XTA,QRTR-SM.OЧ.ГOT.OБMEHOB
 ,AAX,C7
 ,ATI,K.N MOДYЛЯ
 ,AEX,C7
 ,ATI,KI.B OБPATHOM KOДE
C         YCTAHOBKA A (A=J*8+K-30B)
 RL,VJM,YCTA
  R5,VTM,8.ПPABKA "KЧ"
  R,VJM,YCTBEPCB.B CЛ.CЛOBAX
C         YCTAHOBKA TИПA OБMEHA B P.
 J,XTA,DBUC-SM
 ,AAX,C7.
 ,ATI,P.
C         A HE KOHEЦ ЛИ ЭTO KAЛИБPOBKИ:
 J,XTA,SKAL-SM
 ,U1A,AFTKAL.ДA
C         ДЛЯ БOЛЬШИX ДИCKOB HYЖHO OCBOБO-
C         ДИTЬ PECYPC БЫCTPЫX KПДП.
 J,ARX,TYPD-SM
 ,U1A,YCTW0.MAЛЫE ДИCKИ
 R,VJM,CHVOP.V-OПEPAЦИЯ
 YCTW0:,BSS,
C         YCT.ПPИЗH.ЗAKAЗ ПPOШEЛ(W=0)
 W,VTM,
C......   AHAЛИЗ ПPOШEДШEГO OБMEHA
 J,XTA,COPC1-SM.KOПИЯ PC 1.
 ,ATX,Y1
 P,MTJ,R
C....HE ЧTEHИE ЛИ ЗAГOЛOBKA
 R,UTM,-RHEA
 R,VZM,TRHEA
C         ПPOBEPKA HE CPABHEHИE ЛИ.
 R,UTM,RHEA-CONTR
 R,VZM,CONTROL.БЫЛO CPABHEHИE
C         ПPOБA HA 'OБMEH HE ИДET B KMД'.
 P,UTM,-READ
 ,XTA,MABT.MACKA ABAPИИ
 P,V1M,*3.HE ЧTEHИE
 ,AOX,B1PCK.ДЛЯ ЧTEHИЯ
 *3:,AAX,Y1
 ,U1A,ERRT.ABAPИЯ
C         ПPOBEPKA HE PAЗMETKA ЛИ.
 R,UTM,CONTR-RAZMT.
 R,VZM,OPENT.PAЗMETKA
C         ПPOБA OШM
 ,EXT,4035B
 J,AAX,BIT8
 ,U1A,ERR PROG.ECTЬ OШM
C         ПPOГPAMMHЫЙ KOHTPOЛЬ
C
 R9,VTM,-8.ЦИKЛ HA 2 ШAГ 4
C      ПOЛYЧEHИE AДPECA.
 R,VTM,YPY.YCT.PEAKЦ. YПP
 CRADR:,BSS,.
C......   ПOДПPOГPAMMA ПOЛYЧEHИЯ
C      ИHДEKCA ЗAKAЗA B MACCИBE
C      ГЛABHOЙ OЧEPEДИ B M И
C      HAЧAЛЬHOГO AДPECA B Y1.
C         ПOPTИT RL.
 RL,VJM,PRIRIND
 ,ATI,M.OЧEPEДИ+1
 M,XTA,WL1-1
 ,ASN,64+24
 ,AAX,B13/2
 ,ATX,Y1
 R,UJ,
 YPY:,BSS,.
C         YCT.CTPEЛKИ KC HA CBOЙ ЛИCT(MAT.)
 N,VTM,66000B-70000B
C      YCT.PEAKЦИИ HA YПP ПPИ K.C.
 R,VTM,CONTNUM
 ,ITA,R
 ,ATX,RECONNUM
C         YCTAHOBKA ПPИПИCKИ
 A,XTA,CUORD
 R5,VJM,PRIPTRA
C         ПPOБA: HE CEKTOPHЫЙ ЛИ OБMEH.
C         ПPИ HEM ЧTEHИE ЦЫЛO HA CBOЙ ЛИCT
 J,XTA,DBUC-SM
 ,AAX,BSECT
 ,U1A,LTKC.CEKTOPHЫЙ
C         HE CEKTOPHЫЙ, CTPEЛKY KC HA
C         70000B - MAT.AДP., ДABAEMЫЙ
C         ЛИCTY, HA KOTOPЫЙ БЫЛ OБMEH.
 N,VTM,
 LTKC:,BSS,
C......   ЦИKЛ ПPOBEPKИ KC И AДPECOB
 W,VTM,KEERA-KEERYBY
C         ПEPEHOC CЛYЖ.CЛOBA B PAБ.ЯЧ. Y3
 J8,UTC,
 R9,XTA,8.CЛYЖ.CЛOBO 0
 ,ATX,Y3
C         ПPOBEPKA AДPECA ДOPOЖKИ
 ,ASN,64+24
 ,AEX,Y1
 ,U1A,ERR PROG1.AДPEC HE TOT
 ,XTA,Y1.AДPEC
 ,ARX,BIT1.2-OЙ ДOPOЖKИ
 ,ATX,Y1.ПAPЫ
C         ПPOBEPKA KC
 W,VTM,KEERC-KEERYBY
 C,VTM,-7.CYMMA ПO AБЗAЦAM
  M,XTA,WL2-1
  R9,UTM,4
  :R9,VZM,*+1
  ,ASN,64+24
  :P,VIM,KS/WR.ПPИ ЗAПИCИ
 R5,VJM,SUMMING.48PKC
 R,VJM,S48TO12.12PKC
 ,ASN,64-12
 ,ATX,Y
 C,VTM,-7
 R5,VJM,SUMMING.
 R,VJM,S48TO12
 ,AOX,Y
  KS/WR:,BSS,
 ,AEX,Y3.CЛYЖ CЛOBA
 ,AAX,B24/1
  ,U1A,ERR PROG1.CYMMA HE TA
 R9,V1M,LTKC
  P,VIM,ENDWR.ПPИ ЗAПИCИ
C         YCT.ПPИЗH.ЗAKAЗ ПPOШEЛ
 W,VTM,
C      ПPOБA: HE HAДO ЛИ ИMЯ ПAKETA.
 A,XTA,CUORD
 ,AAX,BTMOD
 ,UZA,ENREAD.HE HAДO
C      YCTAHOBKA CИГHAЛA 'ИMЯ' (W=1).
 W,VTM,1.
C      ЗAПИCЬ ПOKA 0 KAK ИMEHИ.
 ,XTA,
 ,ATX,Y.ИMЯ.
C      ПPOБA HA TOЖДECTBEHHOCTЬ ИMEH.
 J8,XTA,NAMED1
 J8,AEX,NAMED2
 ,U1A,OPENT.HET, ИMЯ=0.
C      ЗAHECEHИE ИMEHИ B Y.
 J8,XTA,NAMED1
 ,ATX,Y
 ENREAD:,BSS,
C......   ЧTEHИE ПPOШЛO XOPOШO. ECЛИ И
C         TOЛЬKO ECЛИ OHO БЫЛO ДЛЯ CEKTOP-
C         HOГO OБMEHA, TO (N.EQ.0)
 N,V1M,OPENT.HE CEKTOPHЫЙ
C         ПPOБA: HE ЗAKAЗ ЛИ ЭTO ЧTEHИЯ
C         ИMEHИ KAHAЛOM OПOЗHABAHИЯ
 M,XTA,WL1-1
 ,ASN,64-6
 ,YTA,
 ,UZA,OPENT.KAHAЛ OП.
C         БЫЛ CEKTOPHЫЙ. ПOДГOTOBKA
C         ПEPEПИCИ ДЛЯ CEKTOPH. ЧTEHИЯ.
C         (N.EQ.0) - ПPИЗH. CEKTOP.ЧTEHИЯ
 A,XTA,CUORD
 ,ASN,64+11
 ,ATX,Y3
 ,AAX,C1400.OTH.AДP.CEKTOPA
 ,ATI,P
 P,UTM,66000B.AДPEC CEKTOPA
 ,XTA,Y3
 ,ASN,64+2
 ,AAX,C1400.OTN.AДP.AБЗAЦA
 ,ATI,RL
 RL,UTM,70000B.AДPEC AБЗAЦA
C         A HE CEKTOPHAЯ ЛИ ЗAПИCЬ:
 A,XTA,CUORD
 ,AAX,BIT18
   :   ,24,2.HA ПPИПИCKY
  R9,VTM,1-400B.CЧETЧИK ЦИKЛA
 ,U1A,LMSEC.ЧTEHИE
C         ЗAMEHA YKAЗATEOEЙ ПEPEПИCИ,ИБO ЗAП
 RL,MTJ,N.ПPИ ЭTOM ПPИЗH.N
 P,MTJ,RL.MEHЯET ЗHAЧEHИE
 N,MTJ,P.HA HE 0 - ЗAПИCЬ
 LMSEC:,BSS,
C         ЦИKЛ ПEPEПИCИ CEKTOPA
 P,UTC,
 R9,XTA,377B
 RL,ATX,.RL:,EQU,15
 R9,VLM,LMSEC
   :   ,24,3
C         ПPИ CEK.ЧTEHИИ - KOHEЦ ЗAKAЗA
 N,VZM,OPENT.ЧTEHИE
C......   OPГAHИZAЦИЯ ZAПИCИ ЗOHЫ C
C         HOBЫM ЗHAЧEHИEM OДHOГO CEKTOPA.
C
C   ...   ФOPMИPOBKA B WL2 KC CEKTOPOB C
C         YЧETOM HOBOГO CEKTOPA.
  A,XTA,CUORD
 ,ASN,64+17.ПOЛYЧEHИE
  ,AAX,C14.N CEKTOPA*12
 ,ATX,Y3.ДЛЯ CДBИГA KC
 ,ASN,64-1.HA CBOE
  ,ARX,Y3.MECTO B WL2
 ,ATI,R9
 M,XTA,WL2-1.ПOЛYЧEHИE ИHBEP-
 ,AEX,C7777.TИPOBAHHOЙ KC
 R9,ASN,64-36.HOBOГO CEKTOPA
     M,ATX,WL2-1.HA CBOEM MECTE
C         ПOЛYЧEHИE CTAPOГO ЗHAЧEHИЯ WL2.
 J8,XTA,4.KC2 И KC3
 ,AAX,B24/1
 J8,ATX,4
 J8,XTA,.KC0 ИKC1
 ,ASN,64-24
 J8,AOX,4
 J8,ATX,4.ЗHAЧEHИE WL2
C         ПOЛYЧEH8E HOBOГO ЗHAЧEHИЯ WL2
 ,XTA,C7777
 R9,ASN,64-36
 J8,AOX,4
 M,AEX,WL2-1
 M,ATX,WL2-1
C         ФOPMИPOBKA B CUORD ЗAKAЗA HA
C         ЗAПИCЬ (ЗAДAHHOГO TИПA) ЗOHЫ.
 A,XTA,CUORD.N ДOPOЖKИ, KOП
 ,AAX,ZPAG.И CПEЦ.БИTЫ
 ,AOX,KOWNP.CBOЙ ЛИCT И Б19
 A,ATX,CUORD
  ,UJ,IFLTWSC.HA ЗAПYCK ЗAП.
 AFTKAL:,BSS,
C   ...   ЗAKOHЧИЛACЬ YCTAHOBKA HA 0.
 ,ATX,Y1.KOПИЯ PC
 ,XTA,.ЧИCTKA
 J,ATX,SKAL-SM.ФЛAГA YCT.0
 ,UJ,TESCOBT
 CONTNUM:,BSS,
C   ...   PEAKЦИЯ HA YПP ПPИ KOHT.CYMM.
C
C         CHЯTИE БЛOKИPOBKИ OCTAHOBA ПO YПP.
  R,VTM,ERR PROG
  ,UJ,CHCTY
C---
  ERR PROG1:P,VZM,ERR PROG.ЧTEHИE
  W,VTM,KERSS-KEERYBY
 ERR PROG:,BSS,
C   ...   OШИБKA, OБHAPYЖEHHAЯ CPU(ЦП),
C         T.E. OШM ИЛИ ПPOГPAMMHЫЙ KOHTPOЛЬ
 W,XTA,BERCPU.YCTAHOBKA
 ,ATX,Y1.PACШИPEHHOГO PC
C       B CЛYЧAE HE OШM(W.NE.0) ДAДИM
C       HA BЫXOД AДPEC ИЗ CЛYЖ.CЛOBA
  W,VZM,TOTTPRG.OШM
  J8,XTA,
  ,ASN,64+24.BЫДEЛИЛИ
  ,ASN,64-30.AДPEC
  ,AOX,Y1
  ,ATX,Y1
 TOTTPRG:W,UTM,KEERYBY
 R,VJM,TTPRCO
 TESCOBT:,BSS,
C   ...   ПPOBEPKA YCЛOBИЙ CHЯTИЯ
C         ЗAKAЗA ПO ПPИЧИHE OШИБOK
 W,VTM,DERT+1.AЦПY ДИAГH.
 A,XTA,CUORD.
 ,ARX,.KAK CЧETЧИK OШ.
 ,U1A,NOTENDCO.EЩE HE CДOX
 ISTHISAC:,BSS,
C         ECTЬ ЛИ ПEPEXBAT PEAKЦИИ:
C         (ECЛИ ДA, TO ЗAKAЗ CHИMAETCЯ)
 A,XTA,CUORD
 ,AAX,BNOTST
 ,U1A,OPENT.ECTЬ ПEPEXBAT
C         OM-HMД ДOЛЖEH БЫTЬ ПEPEBEДEH
C         B COCTOЯHИE 'HE ГOTOB'.
 RL,VJM,MOQTR.ДOЛOЙ ИЗ OЧ.
 R,VTM,ST1.ПOCЛE ДИAГH
 W,VTM,KERCMO.TT - TEKCT
 ,UJ,TTPRWBL.HA ДИAГH.
 NOTENDCO:,BSS,
C         HET ЛИ ПPИЗHAKA OДHOKPATHOCTИ:
 ,AAX,B1O
 ,UZA,IFLTWSC.ПOBTOPИM OБMEH
C         CHЯTИE ЗAKAЗA BBИДY OШИБOK
 OPENT:,BSS,.
C......   KOHEЦ OБPAБOTKИ OБMEHA,
C         KOHEЦ BCEГO ЗAKAЗA.
C
C       YДAЛEHИE ИЗ OЧEPEДИ HA OБMEH
  RL,VJM,MOQTR
C       YДAЛEHИE ИЗ OЧEPEДИ HA HMД
C       T.E. ИЗ CИCTEMЫ B ЦEЛOM
  R,VTM,IFLTWSC
  ,UJ,MOVEQUE
 MOQTR:,BSS,.
C......   ПOДПPOГPAMMA. BOЗBPAT - RL.
C         ПPOДBИЖKA QRTR(J) -
C         OЧEPEДИ ГOTOBЫX OБMEHOB.
C           ПOPTИT PEГИCP R.
C
C         CHЯTИE ФЛAГA OБMEHA
  J,XTA,DBUC-SM
 RL,UZA,
 ,XTA,.
 J,ATX,DBUC-SM.
 J,XTA,QRTR-SM.
 ,AAX,B48/31.ПOЛYЧEHИE
 ,E+N,64+3.HOBOГO KOHЦA OЧ
 J,A+X,QRTR-SM.ПPOДBИЖKA
 J,ATX,QRTR-SM.
C   ...   V-OПEPAЦИЯ ДOCTYПA K CBOEMY ЛИCTY
  J,XTA,BITDISK-SM
  RL,MTJ,R5
  ,UJ,PS*VOP
 ENDWR:,BSS,.
C         KOHEЦ KOHTPOЛЯ ЗAПИCИ.
C         ECЛИ TPEБYETCЯ CPABHEHИE,
C         TO ЗAKAЗЫBAETCЯ HOBЫЙ OБMEH.
  W,VTM,.ЗAKAЗ ПPOШEЛ
  J8,XTA,NAMED1
  J8,AEX,NAMED2
  ,U1A,ERR PROG1
 P,UTM,READ
 P,VZM,OPENT.ПPOCTAЯ ЗAПИCЬ
C         YCTAHOBKA ЗAKAЗA HA CPABHEHИE.
 A,XTA,CUORD.ЗAMEHA
 ,AEX,C7.ЗAПИCИ
 A,ATX,CUORD.HA CPABHEHИE
  ,UJ,IFLTWSC
 TRHEA:,BSS,
C......   OБPAБOTKA ПPOЧИTAHHOГO ЗAГOЛOBKA
C---------
C   ...   YЧET ГPEБEHKИ BO 2-OM CЛOBE,
C         PEЗYЛЬTAT B Y4.
 R5,VTM,-45
 ,XTA,
 ,ATX,Y4.PEЗYЛЬTAT
 J8,XTA,2.CЛYЖ.CЛOBA
 LUHE:,BSS,
C         ЦИKЛ BЫБOPKИ CЛOГOB.
 ,APX,MCAM.MACKA ГPEБEHKИ
 R5,UTM,9
 R5,ASN,64+36
 ,AOX,Y4.HOBЫЙ CЛOГ
 ,ATX,Y4.B PEЗYЛЬTAT
C         ПPOДBИЖKA ЗA OЧEPEДHЫM CЛOГOM.
 J8,XTA,2
 ,ASN,64-1
 J8,ATX,2
 R5,V1M,LUHE
C   ...   ЗAHECEHИE AДPECA PAБOTЫ ПOCЛE
C         ИЗЬЯTИЯ ЗAKAЗA ИЗ OЧ.ГOT.OБM.
 RL,VTM,IFLTWSC.BOЗBPAT ИЗ MQTR
C   ...   AHAЛИЗ ПEPEПAKOBAHHOГO ЗAГOЛOBKA.
C         ИЗYЧEHИE ИДEHTИHИKATOPA.
 ,XTA,Y4
 ,ASN,64-3
 ,ATX,Y4
 ,YTA,.ИД.+1 БИT AM
 ,AEX,BIT3.ПPOБA HA 0
 ,UZA,NEWARH.0,HOBЫЙ OБM.
 ,AEX,BIT1.ПPOБA HA 1
 ,U1A,NOT1.ИДEHT.HE 1
C   ...   HOPMИPOBKA HOBOГO  AДPECA.
 ,XTA,Y4
 ,ASN,64-8
 ,ATX,Y4
 ,YTA,.ЦИЛИHДP
C         YMHOЖEHИE ЦИЛИHДPA HA 10.
 ,ATX,Y5
 ,ASN,64-2
 ,ARX,Y5
 ,ASN,64-1
 ,ATX,Y5.N ЦИЛ.*10
C         ДOHOPMИPOBAHИE N ДOPOЖKИ + 8.
 ,XTA,Y4
 ,ASN,64-4
 ,YTA,.N ДOPOЖKИ
 ,ARX,Y5.ПOЛHЫЙ AДPEC
 SNEWAD: ,ATX,Y5
C         YCTAHOBKA HOBOГO AДPECA
C         HA MECTO CTAPOГO B CUORD.
 A,XTA,CUORD
 ,ASN,64+25
 ,AAX,C7777.CTAPЫJ AДPEC
 ,AEX,Y5
 ,ASN,64-25
 A,AEX,CUORD
 A,ATX,CUORD
 NEWARH:,BSS,
C         ЗAHECEHИE B MWSC HOBOГO ПOДBOДA
 KI,XTA,BIT8
 J,AOX,MWSC-SM
 J,ATX,MWSC-SM
C         CHЯTИE OБMEHA И HA ПOДBOД.
 ,UJ,MOQTR
 NOT1:,BSS,
C      ECЛИ ИД = 3, TO CДEЛAEM PAЦИOHAЛЬHYЮ
C      ЗAMEHY, ИHAЧE ДOPOЖKA ДPЯHЬ.
 W,VTM,TWBP+1
 ,AEX,BIT2.
 ,U1A,ISTHISAC.CTOП ЗAДAЧИ
C         ЗAMEHИM ДOPOЖKY ПO HOBOMY
 ,XTA,Y4
 ,ASN,64+36
 ,UJ,SNEWAD
 CONTROL:,BSS,.
C         OKOHЧИЛOCЬ CPABHEHИE.
 J,XTA,COPC1-SM
 ,AAX,MCOMP.MACKA CPABH.
 ,UZA,OPENT.XOPOШO ПPOШЛO
C         BOCCTAHOBЛEHИE ЗAKAЗA HA ЗAПИCЬ
C         ПPИ ПЛOXOM CPABHEHИИ.
 A,XTA,CUORD
 ,AEX,C7.
 A,ATX,CUORD
 ERRT:,BSS,.
C         OШИБKA OБHAPYЖEHA KMД
 J,XTA,COPC1-SM
C         ECTЬ ЛИ ГOTOBHOCTЬ, HET - CTOП
  ,AEX,CREADY
 ,AAX,CREADY
 R,VTM,TESCOBT.ПOCЛE TTPRCO
 W,VTM,KER  KMD.TEKCT HA TT
 RL,VTM,STOP
 ,U1A,MOQTR.HET ГOTOBH.
C         ПPOBEPKA HECOBПAДEHИЯ AДPECOB.
C         ECЛИ HET - ПOBTOP OБMEHA.
 J,XTA,COPC1-SM
 ,AAX,MNEWM.CПA + POФ
 ,AEX,BNEWM.CПA
 ,U1A,TTPRCO
C         OPГAHИЗAЦИЯ KAЛИБPOBKИ
C         ПOCЛE ПЛOXOГO OБMEHA
C       BЫДAЧA CTATИCTИKИ
  W,VTM,KERBM
  RL,VJM,GOSTA
C       ПPOДBИЖKA CЧETЧИKA KAЛИБPOBOK
  A,XTA,CUORD
  ,ARX,BSKAL
  A,ATX,CUORD
C       BЫДAЧA ДИAГHOCTИKИ HA TT
  R,VJM,TTPR
C       YCTAHOBKA ФЛAГA KAЛИБPOBKИ
  ,XTA,Y1.ЗAПOMИHAHИE PC
  J,ATX,SKAL-SM.B ФЛAГE YCT.0
 LTWSC:,BSS,.
C......   ЦИKЛ BKЛЮЧEHИЯ ЖДYЩИX
C         ЗAKAЗOB HA ПOДBOД,
C         ПPOCTABЛEHHЫX B TWSC
 J,XTA,MWSC-SM
 ,UZA,NOMOVE.БOЛЬШE HET
C         YCTAHOBKA HE 0 B Y, ЧTO CYЩECT-
C         BEHHO ПPИ OПPOCE ГOTOBHOCTИ.
 ,ATX,Y
C         YCT.ПAPAMETPOB MOДYЛЯ(K,KI,A)
 RL,VJM,YCTAPE
C         YCT.B PEГИCTPE P TИПA ЗAKAЗA.
 A,XTA,CUORD
 ,AAX,C7
 ,ATI,P
C         BЫЧEPKИBAHИE ИЗ TWSC
  KI,XTA,BIT8
 ,AEX,FULWOR
 J,AAX,MWSC-SM.
 J,ATX,MWSC-SM.
C         ПPOBEPKA ГOTOBHOCTИ MOДYЛЯ.
 R,VJM,READPC2
 ,AEX,CREADY.
 ,AAX,CREADY.
C         ПPИ ГOTOBHOCTИ CYMMATOP - 0.
 R,VTM,LTWSC.ПOCЛE ДEЙCTBИЯ
 ,U1A,STOP.MOД.HE ГOTOB
C         MOДYЛЬ ГOTOB.
C         ПPИ OTCYTCTBИИ COBMEЩEHИЯ
C         ЗAKAЗ ИДET B OЧ.ГOT.OБMEHOB
C         ПPИ ЗAKAЗE HA OПPOC ГOTOBHOCTИ
C         ЗAДAЧA-XOЗЯЙKA OTKPЫBAETCЯ.
C
C         YCT.ПPИЗH.ЗAKAЗ ПPOШEЛ.
 W,VTM,1
C         ПPOБA: HE OПPOC ЛИ ГOTOBHOCTИ
 P,UTM,-QUREA
 P,VZM,MOVEQUE.ДA
C         ЗAKAЗ - HE OПPOC ГOTOBHOCTИ
 RL,VTM,LTWSC
C         ECTЬ ЛИ COBMEЩEHИЯ:
 ,XTA,REGW
 ,U1A,SETRT.HET COBMEЩEHИЙ
C         ЗAHECEHИE БИTA B KOПИЮ MACKИ.
 KI,XTA,BIT8
 J,AOX,CODM-SM.KOПИЯ MACKИ
 J,ATX,CODM-SM
C         BЫДAЧA ПOДBOДA И HA CЛEД.MOДYЛЬ.
 ,UJ,MOVE
C
C.....   PAЗЛИЧHЫE BAPИAHTЫ ПOBEДEHИЯ
C        B CЛYЧAЯX  OДHO-  И  MHOГO-
C        MAШИHHOГO KMД.
  IFLTWSC:,XTA,NEVM.HOMEP ЭBM
  ,AAX,B48/47.ПOДKЛ.K KMД
  ,UZA,LTWSC.- OДHA MAШИHA
 NOMOVE:,BSS,.(10)
C         OKOHЧATEЛЬHAЯ PAБOTA
C
C         ECTЬ ЛИ ГOTOBЫЙ OБMEH
 J,XTA,QRTR-SM
 ,ARX,
 ,UZA,SEXIT.HET OБMEHA
C         OБMEH ECTЬ,OПPEДEЛEHИE
C         ПAPAMETPOB MOДYЛЯ(K,KI,A)
 ,AAX,C7.
 ,ATI,K.HOMEP MOДYЛЯ
 J,ATX,CNMOD-SM.
 ,AEX,C7
 ,ATI,KI
 RL,VJM,YCTA
C         A HET ЛИ ПO ЭTOMY ЛБMEHY ЗAЯBKИ
C         HA YCTAHOBKY 0-ГO ЦИЛИHДPA.
 J,XTA,SKAL-SM
 R,VTM,ENDDSDM.ПOCЛE MOVE0
 ,U1A,MOVE0.ECTЬ
C         ДЛЯ БOЛЬШИX ДИCKOB HYЖHO ЗAXBATИTЬ
C         PECYPC БЫCTPЫX KПДП.
 J,ARX,TYPD-SM
 ,U1A,IFSECTR.MAЛЫE ДИCKИ
 R,VJM,CHPOP.P-OПEPAЦИЯ
 15,V1M,END DISC.CEMAФOP ЗAKPЫT
 IFSECTR:,BSS,
C         HE ECTЬ ЛИ OБMEH CEKTOPHЫЙ.
C         TOГДA HYЖEH CBOЙ ЛИCT.
 A,XTA,CUORD
 ,AAX,BSECT
 ,UZA,COMTRA.HE CEKTOPHЫЙ
C   ...   P-OПEPAЦИЯ ДOCTYПA K CBOEMY ЛИCTY
  J,XTA,BITDISK-SM
  R5,VJM,PS*POP
  N,VIM,END DISC.ЛИCT ЗAHЯT
C         ЗAHECEHИE B YKAЗATEЛЬ TEKYЩEГO
C         OБMEHA ЧTEHИЯ ЗOHЫ HA CBOЙ ЛИCT
 ,XTA,MADORSPB.ЧИCTKA ЛИCTA
 A,AAX,CUORD.И KOП
 ,AOX,KOWNP
 ,AOX,GKYCREAD.OБЩ.KYC ЧTEHИЯ
 J,ATX,DBUC-SM
 ,UJ,TRM2
 COMTRA:,BSS,
C         OБЫЧHЫЙ OБMEH (HE CEKTOPHЫЙ)
C
C         OБHYЛEHИE CЛYЖEБHЫX CЛOB
 R,VTM,1-8.ДЛЯ OБHYЛEHИЯ
 W,VTM,1-8.ДЛЯ BЫTAЛKИBAHИЯ
 *4:J8,UTC,
 R,ATX,8-1
 R,VLM,*4
C         YCTAHOBKA TEKYЩEГO OБMEHA.
 A,XTA,CUORD
 J,ATX,DBUC-SM
C         ПPOBEPKA HA ЧTEHИE И PAЗMETKY.
C         ПPИ HИX CЛYЖEБHЫE CЛOBA HE HYЖHЫ.
 ,AAX,C7
 ,AEX,XRAZMT
 ,UZA, TRM1.PAЗMETKA
 ,AEX,XRAEQRE
 ,UZA,TRM2.ЧTEHИE
C......   ФOPMИPOBKA CЛYЖEБHЫX CЛOB
C
C      ЗA AДPECOM И ИHДEKCOM ЗAKAЗA
 R,VJM,CRADR
  M,XTA,WL1-1
  R5,CALL,AUTOR
  J8,ATX,IDEN
 ,XTA,Y1.ПOЛHЫЙ AДPEC
 ,ASN,64-24
 ,ATX,Y1
 M,XTA,WL2-1.KC
 ,ASN,64+24
 ,AOX,Y1.KC И AДPEC
 J8,ATX,.1-OЙ ДOPOЖKИ
 M,XTA,WL2-1
 ,AAX,B24/1
 ,AOX,Y1.
 ,ARX,BIT25.KC И AДPEC
 J8,ATX,4.2-OЙ ДOPOЖKИ
C         ЗAHECEHИE ИMEHИ ПAKETA.
 A,XTA,DNAMIN
 J8,ATX,NAMED1
 J8,ATX,NAMED2
 ,U1A,TRM1
  ,33,700B.HET ИMEHИ MД
C         BЫTAЛKИBAHИE
 TRM1:,ATX,1
 W,VLM,TRM1
 TRM2:,BSS,.
   :   ,24,2003B
C         COБCTBEHHO BЫДAЧA OБMEHA.
 R,VJM,TRANSF
 ENDDSDM:,BSS,
C         YCTAHOBKA ФЛAГA ИДYЩEГO OБMEHA:
C         ( COPC1(J) .EQ. 0B ).
 ,XTA,
 J,ATX,COPC1-SM
C         YCTAHOBKA MACKИ ГPП И KOHEЦ PAБOTЫ
  R,VJM,PERMIR/T
 END DISC:,BSS,.
C         ГAШEHИE ПPИЗHAKA ЗAПYCKA
C         OБPAБOTKИ ДИCKOBЫX ПPEPЫBAHИЙ.
C         ГAШEHИE БИTA B ШKAЛE
C         PAБOT ЗAДAЧИ OБMEHA
   :   ,24,2003B
 ,XTA,SCTATRA
 J,AOX,BITDISK-SM
 J,AEX,BITDISK-SM
 ,ATX,SCTATRA
 ,UJ,TRAINT
 GET KMD:,BSS,.
C......   ПPИBЯЗKA KMД K MAШИHE
  ,XTA,
  J,ATX,WAITKMD-SM.HE ЖДEM
C         YCTAHOBKA ФЛAГA 'KMД ПPИBЯЗAH'.
 ,XTA,BIT48
 J,ATX,KMD OWN-SM
C         CБPOC ФЛAГA ACД (FLASD(J).NE.0)
 J,ATX,FLASD-SM
 ,UJ,LTWSC
C
C*****
C
  YCTBEPCB:,ENTRY,
C
 YCTBEPCB:,BSS,
C......   ПOДПPOГPAMMA YCTAHOBKИ BEPHOЙ
C      CBEPTKИ B CЛYЖEБHЫX CЛOBAX.
C      R5 - ЧИCЛO CЛYЖEБHЫX CЛOB.
C      ПOPTИT R5.
C
C      YCTAHOBKA PEAKЦИИ HA YПP.
  ,XTA,R/INTCN
 ,ATX,RECONNUM
C      ЦИKЛ YCT.BEPH.CBEPTKИ
 YCB1:,XTA,C2003.БЛOKИPOBKA
 ,ATI,21B.OCTAHOBA
 ,ATI,.ЛO YПP
 J8,UTC,
 R5,XTA,-1
 ,ATI,
 CONTL:,BSS,.ЗAПИCЬ
 J8,UTC,
 R5,ATX,-1
 R5,UTM,-1
 R5,V1M,YCB1.KOHEЦ ЦИKЛA
 CHCTY:,BSS,
C......   ПOДПPOГPAMMA CHЯTИЯ БЛO-
C      KИPOBKИ OCTAHOBA ПO YПP.
 ,XTA,C13
 ,ATI,21B
 ,ATI,
 R,UJ,
  R/INTCN:,,
  ,Z00,AFINTCN
 AFINTCN:,BSS,.
C  PEAKЦИЯ HA YПP
C  B SAVAC 48-1 ЧИCЛA
 ,XTA,SAVAC
 ,UJ,CONTL
 STOP:,BSS,
C......   БЛOK PEAKЦИИ HA HEГOTOBHOCTЬ MOД.
C         ПPИ HAПPABЛEHHOCTИ ЗAKAЗA HA
C         MOДYЛЬ OH CHИMAETCЯ. ИHAЧE ЗAKAЗ
C         OTKЛAДЫBAETCЯ ДO ПOЯBЛEHИЯ ГT.
C
C         MOЖHO ЛИ OCBOБOДИTЬ MOДYЛЬ:
  ,XTA,MONOS
  A,AAX,BIT48
 W,VTM,KERNOR.TT TEKCT 'HEГT'
 R,VTM,ST1.ПOCЛE TTPR
 ,U1A,TTPRWBL.ПAKET ЗAHЯT
C         HE БЫЛ ЛИ MOДYЛЬ YЖE CBOБOДEH:
 A,XTA,DNAMIN
 ,UZA,ST1.ДA
C         OCBOБOЖДEHИE MOДYЛЯ OT ПAKETA И
C         OPГAHИЗAЦИЯ COOБЩEHИЯ OБ ЭTOM B
C         CTATИCTИKЫ. (BPEMEHHO ПOPTИM A).
C         ЧИCTKA ГPЯЗИ B SCKILD.
  A,UTM,30B
  :,24,2003B
  ,ATX,YINT1.ИMЯ ПAKETA
 A,XTA,BIT16-30B
 ,AEX,FULWOR
 ,AAX,SCKILD
 ,ATX,SCKILD
 ,XTA,
 A,ATX,DNAMIN-30B
 ,ITA,A.HOMEP MOДYЛЯ
 ,ATX,YINT
 ,XTA,CODSTNR
 ,UJ,STATIST
 CODSTNR:2,Z03,YINT
 ,Z01,ST0
 ST0:,24,3
 A,UTM,-30B.ИCПPABИM A
 ST1:,BSS,
C         ПEPEBOД OM-HMД B COCTOЯHИE 'HEГT'
 A,XTA,BIT48
 ,AEX,FULWOR
 ,AAX,DREADY
 ,ATX,DREADY
C         A KYДA CEЙ ЗAKAЗ HAПPABЛEH:
 A,XTA,CUORD
 ,AAX,BTMOD
  R,VTM,IFLTWSC
 ,U1A,MOVEQUE.ЗAKAЗ HA MOДYЛЬ
C         YCTAHOBKA ПPИЗHAKA ABAPИИ B
C         ЗAKAЗ (HA ПAKET) B WL1.
 A,XTA,SQTM
 ,ANX,
 ,ATI,M.ИHДEKC ЗAKAЗA
 M,XTA,WL1-1.KYC
 ,AOX,BINTR.ПPИЗHAK AB.
  M,ATX,WL1-1
  ,ASN,64+42
  ,ATI,RL
  RL,VZM,IFRDTA
  ,XTA,FULWOR.BЫЧИCTKA ИЗ
  RL,AEX,BITS.ШKAЛЫ ЗAДAЧ,
  ,AAX,EXCHSC.ЗAKPЫTЫX ПO OБMEHY
  ,ATX,EXCHSC
 ,UJ,IFRDTA
 MOVEQUE:,BSS,
C......   ПOДПPOГPAMMA ПPOДBИЖKИ OЧEPEДИ
C         ПO K-TOMY MOДYЛЮ.
C         ЗAДAЧA-XOЗЯЙKA ЗAKAЗA OTKPЫBAETCЯ.
C         ECЛИ B OЧEPEДИ ПO K-MY MOДYЛЮ
C         ECTЬ EЩE ЗAKAЗЫ, TO K-ЫЙ БИT
C         ЗAHOCИTCЯ B ШKAЛY
C         ЖДYЩИX ЗAKAЗOB TWSC.
C         ЧИCTЯTCЯ CЧETЧИKИ OШИБOK:
C         COBT И COKAL.
C         ПOPTИTCЯ R9,W,P,N,RL,Y3,Y4,Y5,R5
C         ECЛИ W.NE.0, TO ЗAДAЧE
C         ГOTOBИTCЯ BЫXOД B ERRMACRO.
C         W-AДPEC TEKCTA AЦПY.
C   ...   OTKPЫTИE ЗAДAЧИ-XOЗЯЙKИ.
C         OПPEДEЛEHИE MECTA B ГЛAB.OЧ.
 RL,VJM,PRIRIND
  R,UZA,
 ,ATI,M
C         HE HAДO ЛИ ДABИTЬ ЗAДAЧY
 W,VZM,OPT.HE HAДO
C         HAДO, БYДET ПPABKA ИПЗ ЗAДAЧИ.
C         OПPEДEЛEHИE ДHЗ И AДPECA ИПЗ.
  KOKHEM:,BSS,
 M,XTA,WL1-1.KYC ЗAKAЗA
 ,ASN,64+42
 ,ATI,R9.ДHЗ ЗAДAЧИ
 R5,VTM,OPT.BOЗB.CПEЦ.KAH.
C         HE ИMЯ ЛИ ЧИTAЛOCЬ:
 W,UTM,-1
 W,VZM,*2.O ДA
 ,XTA,
 ,ATX,Y.0 ДЛЯ CYMMATOPA
 *2:,XTA,Y.ИMЯ ПAKETA
 R9,VZM,ENSPTR.KAKHAЛ OПOЗH.
  KILLOPER:,BSS,
C         C ЗAKPЫTИEM ЛИ ЗAДAЧИ CEЙ ЗAKAЗ:
 M,XTA,WL1-1
 ,AAX,BCLOSE
 ,UZA,NONOWN.CTAHД.CЛYЧAЙ
C         ECTЬ ЗAKPЫTИE ЗAДAЧИ.
 N,VTM,Y.ДЛЯ CYMMATOPA
 R9,VTM,Y1.ДЛЯ PMP
 ,UJ,TOABCHT.HA KOKAHЬE
 NONOWN:,BSS,
C         HEYДAЧA HA ЗAKAЗE БEЗ БЛOKИPOBKИ
 M,MTJ,R9.ФOPMИPOBKA
 R9,UTM,WL1-1.ДЛЯ CYMMATOPA
C         ПOДЛEЖИT ЛИ ЗAДAЧA BЫБPOCY:
 M,XTA,WL1-1
 ,AAX,BBSTOP
 ,UZA,TOABCHT.ПOДЛEЖИT
 W,VTM,
 TOABCHT:,BSS,
C   ...   OKOHЧATEЛЬHAЯ ПOДГOTOBKA BЫЗO-
C         BA П/П ABAPИЙHOГO CHЯTИЯ.
  M,XTA,WL1-1
 A,VJM,ABCHT
  RL,VJM,YCTA
 OPT:,BSS,.
C         COБCTBEHHO OTKPЫTИE ЗAДAЧИ.
C+
C++++   ИДEЯ M.ГYPEBИЧA O MOHOПOЛИЗAЦИИ
C++++   ПOKA HE ПPOXOДИT ИЗ-ЗA R-TPAKTA
C+      HE ECTЬ ЛИ ЭTO ЗAKAЗ, CBЯЗAHHЫЙ
C+      C MOHOПOЛИЗAЦИEЙ HAПPABЛEHИЯ
C+M,XTA,WL1-1
C+,AAX,BMONCH
C+,UZA,CLOSQTM.HET
C+      CHЯT CПEЦ.ЗAKAЗ.  ECЛИ БЫЛO
C+      ЧTEHИE, FLMNCH(J) YBEЛИЧИBAETCЯ
C+      HA 1 (MOHOПOЛИЗAЦИЯ),  B
C+      ПPOTИBHOM CЛYЧAE YMEHЬШAETCЯ HA 1
C+A,XTA,CUORD
C+,AAX,C7.KOП
C+,AEX,XREAD
C+,UZA,/1.ЧTEHИE
C+,XTA,BIT2
C+/1:,X-A,BIT1
C+J,A+X,FLMNCH-SM
C+,UZA,/2.BCE B ПOPЯДKE
C+       ЛИШHЯЯ  V-OПEPAЦИЯ
C+,XTA,
C+ /2:J,ATX,FLMNCH-SM
C+CLOSQTM:,BSS,
C   ...   ПPOДBИЖKA OЧEPEДИ ЗAKAЗOB.
C         XOЗЯЙKA YЖE OTKPЫTA.
  J8,MTJ,11.AДPEC CЛ.CЛOB
  R9,VJM,KOHOБMEH
C         HE БЫЛ ЛИ CЛEДYЮЩИЙ ЗAKAЗ
C         BЫKИHYT OПEPATOPOM.
 A,XTA,SQTM
 RL,VJM,*6
 R,UZA,.HET ЗAKAЗOB
 ,ATI,M.ИHДEKC ЗAKAЗA
C         A БЫЛA ЛИ HA HEM ABAPИЯ:
 M,XTA,WL1-1
 ,AAX,BINTR
 ,UZA,IFRDTA.HET
C         HET ЛИ ПPИKAЗA CHЯTИЯ 'ДKO'.
 ,XTA,SCKILD
 A,AAX,BIT16
  ,UZA,HET ДKO
  ,AEX,SCKILD
  ,ATX,SCKILD
  W,VTM,DERT
  ,UJ,KILLOPER
  HET ДKO:,BSS,
 M,XTA,WL1-1
 ,ASN,64+42.ДHЗ ЗAДAЧИ-
 ,ATI,RL.-XOЗЯЙKИ
 RL,XTA,BITS
 ,AAX,OUTJOBSC
  ,UZA,IFRDTA
  W,VTM,1.БEЗ
  ,UJ,KOKHEM.ERRMACRO
 IFRDTA:,BSS,
C         A HET ЛИ EЩE ЗAKAЗOB
 RL,VJM,PRIRIND
 R,UZA,.HET
 ,ATI,M
C         ПPИEM HOBOГO ЗAKAЗA B OБCЛYГY.
 INTOSYS:,BSS,
C......   ПOДПPOГPAMMA ПPИEMA B OБCЛYГY.
C      MECTO HOBOГO ЗAKAЗA - WL1(M)
C      YCTAHAB.HOBЫЙ TEKYЩИЙ ЗAKAЗ(CUORD)
C      ПPИ YCTAHOBKE ЧИCTЯTCЯ CЧETЧИKИ.
C      CTABИTCЯ БИT B OЧEPEДЬ ЖДYЩИX
C      ПOДBOДOB(MWSC(J). CTAPOE ЗHAЧEHИE
C      MWSC ПOMHЩAETCЯ B YЗ.
C      ПOPTЯTCЯ: R9,Y3,Y4,Y5,RL=15
C
C01      ПEPEKOДИPOBKA ПOЛЯ KOMAHДЫ
C      (18 И 3-1) C YЧETOM REGW.
C
C  O2     YCT.CTPOKИ TAБЛИЦЫ KOДOB.
 R9,VTM,TABKYC.TAБЛ.ПEPEKOД.
 ,XTA,TYPWR
 ,UZA,IS1.PEЖИM ПPOCTOЙ
 R9,UTM,2.ЗAПИCЬ C CPABH.
 IS1:,BSS,
 M,XTA,WL1-1
 ,AAX,BIT18.CTAPШ.БИT KOM.
 ,UZA,IS2
 R9,UTM,1.
C  02
 IS2:,BSS,
C  02     YCT.HOBOГO KOДA ПO
C         CTPOKE И PAЗPЯДAM 3-1 CTAP.
 M,XTA,WL1-1
 ,AAX,C7.3-1 CTAPOЙ
 ,ASN,64-2.*4
 ,ATI,RL
 R9,XTA,.CЛOBO TAБЛИЦЫ
 RL,ASN,64-28
 ,AUX,MAKOM.HOBAЯ KOM.
 A,ATX,CUORD
C  02
C01
CO1       YCTAHOBKA KYCA YBY И TEKYЩEГO
C         AДPECA, PABHOГO ПOKA HAЧAЛЬHOMY
 ,XTA,MASK WL1.ЧTO BЗЯTЬ ИЗ WL1
 M,AAX,WL1-1
 ,A-X,BIT28
 A,AOX,CUORD
 A,ATX,CUORD
C01        KOPPEKЦИЯ AДPECA ДOPOЖKИ B
C         COOTBETCTBИИ C TИПOM ДИCKOB.
 J,ARX,TYPD-SM
  ,UZA,BIGDI.ДИCKИ-29
C  02     KOPPEKЦИЯ ДЛЯ MAЛЫX ДИCKOB:
C         ПEPEXOД OT ЗOH K ДOPOЖKAM.
 ,ASN,64+25
 ,AAX,C7777
 ,ATX,Y5.ЗOHA
 ,ASN,64-1.ПEPEHECEHИE 1PЦГ
 ,ARX,B48/13.B MЛAДШИЙ PAЗPЯД
 ,AAX,C7777.ПOЛЯ AДPECA
 ,UJ,ECORAD
C  02
  CORCAM:,BSS,..........
C   02        KOPPEKЦИЯ ДЛЯ ЗABOДCKOГO KMД
  A,XTA,CUORD
  ,ASN,64+25
  ,AAX,C7777
  ,ATX,Y5
C   03       ЦИKЛИЧ.CДBИГ 12P BПPABO
  ,ASN,64+1
  ,ATX,Y4
  ,YTA,
  ,ASN,64+36
  ,AOX,Y4
  ,UJ,ECORAD
 BIGDI:,BSS,
C  02     KOPPEKЦИЯ ДЛЯ БOЛЬШИX ДИCKOB:
C         ЗABOДCKOЙ ЛИ KMД :
  ,XTA,PRDK
  J,AAX,BIT24-1
  ,UZA,CORCAM.-ДA
C   02        ДYБHEHCKИЙ KMД-29
  A,XTA,CUORD
  RL,VJM,DIV10
C         BЫДEЛEHИE HOMEPA ГPYППЫ ГOЛOBOK.
 15,VTM,Y4
C         ЦИЛИHДPA И ГPYППЫ ГOЛOBOK.
C    03   ПOЛYЧEHИE HOMEPOB
 ,XTS,Y3.AДPEC/10
 ,ASN,64+1.HOMEP ЦИЛИHДPA
 ,ATX,Y3
 ,YTA,.HOMEP ГPYППЫ
 ,ASN,64+36.ГOЛOBOK
 15,AOX,.HOMEP ГOЛOBKИ
C    03   OKOHЧATEЛЬHAЯ ФOPMИPOBKA AДPECA
 ,XTS,Y3
 ,ASN,64-2
 ,ARX,Y3
 ,ASN,64-1.(N ЦИЛИHДPA)*10
 15,ARX,
 ECORAD:,BSS,
C  02     BПИCЫBAHИE AДPECA B CUORD
 ,AEX,Y5
 ,ASN,64-25
 A,AEX,CUORD
 A,ATX,CUORD
C  02
C01       YCT.БИTA B OЧ. ЖДYЩ.ПOДBOДOB
 J,XTA,MWSC-SM.OЧ.ЖДYЩ.ПOДB.
 ,ATX,Y3.CTAPOE ЗHAЧEHИE
 KI,AOX,BIT8
 J,ATX,MWSC-SM.HOBOE ЗHAЧEHИE
C01
C
C  02     OПPEДEЛEHИE ДHЗ ЗAДAЧИ.
 M,XTA,WL1-1
 ,ASN,64+42
 ,ATI,R9
C  02
C         C ЗAKPЫTИEM ЛИ ЗAДAЧИ CEЙ ЗAKAЗ:
 M,XTA,WL1-1
 ,AAX,BCLOSE
 ,U1A,WITHCLOS.C ЗAKPЫTИEM
C01       ЗAKAЗ БEЗ ЗAKPЫTИЯ. ПPOCTAHOBKA
C         БИTA ПEPEXBATA PEAKЦИИ, ECЛИ
 M,XTA,WL1-1
 ,ASN,64-2
 M,AOX,WL1-1
 ,AAX,BIT6.B6.OR.B4. ЗAKAЗA
 SH38:,EQU,BNOTST-BIT6
 ,ASN,64+SH38
 A,AOX,CUORD
 A,ATX,CUORD
 R,UJ,
 WITHCLOS:,BSS,
C01       ДEЙCTBИЯ ПO ЗAKAЗY C ЗAKPЫTИEM
C  02     ФOPMИPOBKA B CUORD БИTOB CTATYCA
C         COГЛACHO HOMEPY CTATYCA ЗAKAЗA.
 M,XTA,WL1-1
 ,ASN,64+2
 ,AAX,C14.
 ,ATI,RL.N CTATYCA*4
 ,XTA,TBCTATYC
 RL,ASN,64.БИTЫ CTATYCA
 ,AAX,C7.CПPABA
 ,ASN,64-3
 A,AOX,CUORD
 A,ATX,CUORD
C  02     ПPOЧИCTKA 38P ДЛЯ MOHOДEЙCTBИЙ
  ,AAX,BMONCH
  ,ASN,64+1.BNOTST-BMONCH=1
  A,AEX,CUORD
  A,ATX,CUORD
C  02     ECЛИ ЗAKAЗ HE OT KAHAЛA OПOЗHA-
C         BAHИЯ, TO B CYMMATOP ЗAKAЗЧИKA
C         CTABИTCЯ HE HOЛЬ.
  R9,VZM,*5.OПOЗHABAHИE
 R9,WTC,*YCЫ.HE 0 B
 *5:,ATX,.CYMMATOP
C  02
C01
 R,UJ,
C......   KOHEЦ 'INTOSYS'.
 PRIRIND:,BSS,
C......   П/П OПPEДEЛEHИЯ ИHДEKCA ПO WL1
C         HAИБOЛEE ПPИOPИTETHOГO ЗAKAЗA
C         HA MOДYЛЬ. PEЗYЛЬTAT HA CYMMATOPE
C         И B ЯЧEЙKE Y3.
C         ПPИ OTCYTCTBИИ ЗAKAЗOB CYMMATOP=0.
C          OБPAЩEHИE ПO RL.
 ,XTA,DREADY
 A,AAX,BIT48
 ,UZA,*6.MOДYЛЬ HE ГOTOB
 A,XTA,SQTM
 *6:,AOX,SCTMOD
 A,AAX,SQTM
 RL,UZA,.HET ЗAKAЗOB
 ,ANX,
 ,ATX,Y3
 RL,UJ,
 TTPRCO:,BSS,.
C......   ПOДПPOГPAMMA ПPOДBИЖKИ
C         CЧETЧИKA OШИБOK (COBT)
C         ЧEPEЗ 8 PAЗ ПEЧATЬ HA TT.
C         ПOPTИT W,RL,YINT,YINT1.
C
C         ПOXOД HA CTATИCTИKY.
 RL,VJM,GOSTA
 A,XTA,CUORD.ЗДECЬ CЧETЧИK
 ,ARX,BITCO.+1
 A,ATX,CUORD
 ,AAX,CDIAG
 ,AEX,BITDIAG
 R,U1A,.HE KPATHO 8
 TTPR:,BSS,
C......   ДИAГHOCTИKA HA TEЛETAЙПE
C         AДPEC ПEPBOГO CЛOBA B W
C
C         HET ЛИ ПEPEXBATA PEAKЦИИ:
C         ECЛИ ECTЬ, TT БЛOKИPYETCЯ.
 A,XTA,CUORD.
 ,AAX,BBLTT
 R,U1A,.TT БЛOKИPOBAH
 TTPRWBL:,BSS,
C......   П/П ПEЧATИ HA TT БEЗ KOHTPOЛЯ
C         HAЛИЧИЯ БИTA БЛOKИPOBKИ ДИAГHOCTИK
C
C         ФOPMИPOBKA AДPECA B KOДE ISO
C                ФOPMAT COOБЩEHИЯ :
C             NN CCCГГ ШTT ZZZZ PPPPPP
C       NN     : HOMEP MOДYЛЯ
C       CCC    : HOMEP ЦИЛИHДPA
C       ГГ     : HOMEP ГOЛOBKИ
C       TT     : ШИФP ЗAДAЧИ
C       ZZZZ   : HOMEP ЗOHЫ ИЗ WL1
C       PPPPPP : PEГИCTP COCTOЯHИЯ(9-24 PAЗP.)
C
 A,XTA,CUORD.TEKYЩИЙ ЗAKAЗ
 ,AAX,BIT37.ДГ*2048
  ,ATX,Y41
  A,AEX,CUORD
  ,ASN,64+25
  ,AAX,C7777
  RL,VJM,DECLET
C      HA CYMMATOPE AДPEC БEЗ ДГ
C      B ДECЯTИЧHOM БAЙTOBOM BИДE
  ,ASN,64+8
  ,ATX,Y43.N ЦИЛИHДPA
  ,YTA,
  ,ATX,Y4.N ГOЛOBKИ БEЗ ДГ
C      ПPOБA TИПA ДИCKOB И KMД
  J,ARX,TYPD-SM
  ,U1A,LITDUB.ДИCKИ-7
  ,XTA,PRDK
  J,AAX,BIT24-1
  ,U1A,LITDUB.ДYБH.KMД-29
C      ЗABOДCKOЙ KMД-29
C      ФOPMИPOBKA HOMEPA ГOЛOBKИ
  ,XTA,Y41
  ,ASN,64-3
  ,AOX,Y4
  ,ASN,64+39
  ,AAX,C37
  RL,VJM,DECLET
  ,ASN,64-32
  ,UJ,TOY41
C      MAЛЫE ИЛИ ДYБHEHCKИE ДИCKИ
C      ФOPMИPOBKA HOMEPA ГOЛOBKИ
  LITDUB:,XTA,Y41
  ,ASN,64-11
  ,AOX,Y4
  ,AUX,MU1/177
  TOY41:,ATX,Y41
C      ФOPMИPOBKA HOMEPOB MOДYЛЯ И ЦИЛИHДPA
  ,ITA,A
  ,ASN,64-42
  ,AUX,MUNLET
  ,ARX,CT30
  ,AOX,Y43
  ,ATX,Y4
C         ПOДГOTOBKA ПEЧATИ N ШИФPA
C         ЗAДAЧИ-XOЗЯЙKИ ЗAKAЗA
 RL,VJM,PRIRIND
 ,ATI,RL.ИHДEKC ЗAKAЗA
 RL,XTA,WL1-1
 ,ASN,64+42.ДHЗ ЗAДAЧИ
 ,X-A,XNW.EE ШИФP
  ,ASN,64-30
  ,AUX,MUNLET
  ,AOX,Y41
 ,AOX,CTSH.6H00 Ш00
 ,ATX,Y4+1
C      ФOPMИPOBKA  N ЗOHЫ
  RL,XTA,WL1-1
  ,ASN,64+25
  ,A-X,BIT4
  ,AAX,C7777
  ,ASN,64-33
  ,AUX,MUNLET
  ,ARX,CT0000
  ,ATX,Y42
C      ФOPMИPOBKA  PC
  ,XTA,Y1
  ,APX,MPPC
  ,AUX,MUNLET
  ,AOX,CT000000
  ,ATX,Y43
 W,XTA,
 P,UTM,-CONTR
 P,V1M,*11
 W,UTM,-KERKMD
 W,V1M,*11
 ,XTA,KERWR
 *11:,BSS,
 ,ATX,TTBUF
 J,MTJ,W
 J,VTM,TTBUF
 ,ITA,J
 J,VJM,TTPRINT
   :   ,24,3
 W,MTJ,J
 R,UJ,
 DIV10:,BSS,
C......   П/П ДEЛEHИЯ HA 10 C OCTATKOM.
C         ДEЛИMOE - CYMMATOP P36-25,
C         HA BЫXOДE: ДEЛИMOИ, ЧACTHOE,
C         OCTATOK - Y5,Y3,CYMMATOP.
C         OБPAЩEHИE ПO RL.
 ,ASN,64+25
 ,AAX,C7777
 ,ATX,Y5.ДEЛИMOE
 ,A*X,C1/10.
 ,ATX,Y3.ЧACTHOE
 ,ASN,64-2
 ,ARX,Y3
 ,ASN,64-1
 ,X-A,Y5
 RL,UJ,
 GOSTA:,BSS,
C......   ПOДПPOГPAMMA ЗAПИCИ B CTATИCTИKY
C         OБPAЩEHИE ПO PEГИCTPY RL.
C         ПOPTИT YINT,YINT1,M.
C         B W AДPEC TT TEKCTA PYГAHИ.
 RL,MTJ,M.BOЗBPAT
 RL,VJM,PRIRIND
 M,MTJ,RL.BOCCT BOЗBPAT
 ,ATI,M.HOMEP B ГЛ.OЧ.
   :   ,24,2003B
 M,XTA,WL1-1.KYC ГЛ.OЧ.
 ,ATX,YINT
 A,XTA,DNAMIN.ИMЯ ПAKETA
 ,ATX,YINT1
C         ФOPMИPOBKA 0+ГO CЛOBA CTATИCTИKИ
 ,ITA,W.AДPEC TT TEK.
 ,ARX,CONSD1.N OШИБKИ =
 ,ASN,64-15.= OTH.AДP.TT TEK
 ,ARX,CONSD2.CTAHД.БИTЫ
 ,UJ,STATIST
 RETSTA:,24,3.BOЗBPAT ИЗ
 RL,UJ,.CTATИCTИKИ
 CONSD1:7,37,77777B
 15,37,-TT/TEK
 CONSD2:3,Z03,YINT
 ,Z04,RETSTA
 YCTAPE:,BSS,.
C......   ПOДПPOГPAMMA YCTAHOBKИ
C         K,KI,A:K - HOMEP MOДYЛЯ,
C         KI=K.EQ.7.A=J*8+K.
C         HA BXOДE ACC-ШKAЛA ПO MOД
C         OБPAЩEHИE ПO RL
 ,ANX,M41
 ,ATI,KI
 ,AEX,C7
 ,ATI,K
 YCTA:K,MTJ,A
 J8,J+M,A
 A,UTM,-BEGMT
 RL,UJ,
 SEXIT:,BSS,
C......   БЛOK BЫXOДA ИЗ
C         YЧACTKA CПEЦИAЛЬHЫX ДEЙCTBИЙ.
 J,XTA,CODM-SM.ECTЬ ЛИ ПOДBOДЫ
  ,U1A,CORCM.ДA,ECTЬ
C       KMД CBOБOДEH, HO MOЖET ECTЬ
C       MOHOПOЛИЗAЦИЯ HAПPABЛEHИЯ
  J,XTA,FLMNCH-SM
  RL,VTM,AFTREFUS.ПOCЛE OTBЯЗKИ
  ,UZA,REFUSE.HET MONO
C       YCTAHOBЛEHA MOHOПOЛИЗAЦИЯ.
C       ECЛИ ECTЬ ЗAK.ПOДBOДOB,TOЛKHEM ИX
  J,XTA,MWSC-SM
  ,U1A,LTWSC
  ,UJ,END DISC
  AFTREFUS:,BSS,
C       BOЗMOЖHO OTBЯЗKA БЫЛA CДEЛAHA
C       ДЛЯ ПPOПYCKA ЗAKAЗOB ДPYГИX ЭBM.
C       ECЛИ ECTЬ EЩE ЗAДAHИЯ HA BЫДAЧY
C       ПOДBOДOB,ПOПPOБYEM CHOBA ЗAXBATИTЬ KMД
  J,XTA,MWSC-SM
  ,UZA,SETMRM.HET ЗAДAHИЙ
C       ЗAПPOC KMД
  J,ATX,WAITKMD-SM.ЖДEM
  RL,VJM,REQUEST
C       MOЖET БЫTЬ OH CPAЗY ЗAXBAЧEH
  ,MOD,237B
  J,AAX,BIT29-SM
  ,UZA,END DISC.HE ЗAXBAЧEH
C        ГAШEHИE MACKИ ГPП И AB
  R,VJM,CLOMIR
  R,VJM,ZEROPC
  ,XTA,
  J,ATX,TIMEX-SM
  :,24,3
  ,UJ,GETKMD
  CORCM:,BSS,
C         KOPPEKЦИЯ ЦИKЛИЧECKOЙ MACKИ
C         ПPИOPИTETOB ДЛЯ BЫБOPA MOДYЛЯ.
 J,XTA,MACI-SM.ЦИKЛ. MACKA
 ,ASN,64+1
 ,U1A,SCI1
 ,XTA,C377
 SCI1:J,ATX,MACI-SM.HOBAЯ MACKA
C         OПPEДEЛEHИE ПPИOPИTETHOГO MOДYЛЯ
 J,AAX,CODM-SM
 ,U1A,SCI2
 J,XTA,CODM-SM
 SCI2:,ANX,M41.HOMEP MOДYЛЯ
 ,ATI,KI.B OБPATHOM
 ,AEX,C7.И
 ,ATI,K.ПPЯMOM KOДAX
 J,ATX,CNMOD-SM
C         YCTAHOBKA MACKИ ГPП.
  R,VJM,PERMIR/T
 R,VTM,END DISC
 RL,VJM,ELECT
C         YCTAHOBKA MACKИ ДИCKOB.
 J,XTA,CODM-SM
 ,UJ,SETDM
 DAFSET:,ENTRY,
C++++++++++++++++++++++++++++++++++
C    BXOД ИЗ ЗAДAЧИ OБMEHA ПOCЛE
C    ПOCTAHOBKИ B ГЛABHYЮ OЧEPEДЬ
C++++++++++++++++++++++++++++++++++
C
C         MECTO B ГЛABHOЙ O4. B N.
 N,XTA,WL1.KYC
 ,ASN,64+7
 ,AAX,C7
 ,ATI,K.N MOДYЛЯ
 ,AEX,C7.OH ЖE B
 ,ATI,KI.OБPATHOM KOДE
 ,ITA,J.ПOЛYЧEHИE
 ,ASN,64-3.N HAПPABЛEHИЯ
 ,ATI,J8.* HA 8.
 RL,VJM,YCTA.
C         YCTAHOBKA БИTA B ШKAЛY-OЧEPEДЬ
C         COOTBETCTBYЮЩEГO MOДYЛЯ
 ,NTR,7
 N,XTA,BIT48
 A,AOX,SQTM
 A,ATX,SQTM
C         HE ECTЬ ЛИ ЭTO ЗAKAЗ,
C         HAПPABЛEHHЫЙ HA ДИCKOBOД.
 N,XTA,WL1
 ,AAX,BTMODE
 ,UZA,IFINIT.OБЫЧHЫЙ ЗAKAЗ
C         YCTAHOBKA БИTA B ШKAЛY ЗAKAЗOB,
C         HAПPABЛEHHЫX HA MOДYЛЬ
  N,XTA,BIT48
 ,AOX,SCTMOD
 ,ATX,SCTMOD
 IFINIT:,BSS,
C   ...   HAДO ЛИ OCYЩECTBЛЯTЬ ИHИЦИAЦИЮ:
 N,MTJ,M
 RL,VJM,PRIRIND
 ,UZA,ENDMAC70.ЗAKAЗ HE ПYCTИTЬ
C         A CAMЫЙ ЛИ ПPИOPИTETHЫЙ
C         TOЛЬKO ЧTO ПPИHЯTЫЙ ЗAKAЗ.
 M,UTM,1
 ,ITA,M
 ,AEX,Y3
 ,U1A,ENDMAC70.HE CAMЫЙ
C         ПPИEM ЗAKAЗA B OБCЛYГY.
 R,VJM,INTOSYS.
C         B YЗ ПOMEЩEHO CTAPOE ЗHAЧEHИE
C         OЧEPEДИ ЖДYЩИX ПOДBOДOB (MWSC)
C
C         ПPOБA HA ПPИBЯЗKY.
 J,XTA,KMDOWN-SM
 ,U1A,OWN.KMД ПPИKPEПЛEH
C         ПPOБA: HYЖEH ЛИ ЗAПPOC.
 ,XTA,Y3.CTAPOE MWSC.
  ,U1A,ENDMAC70.ЗAПPOC BЫДAH
C         CПYCK ФЛAГA ИДYЩEГO OБMEHA:
C         COPC1(J).NE.0
 ,XTA,BIT48
 J,ATX,COPC1-SM
C      BЫДAЧA ЗAПPOCA И BЫXOД.0
  J,ATX,WAITKMD-SM.ЖДEM
  RL,VJM,REQUEST.ЗAПPOC KMД
C         ПPOBEPKA: HE ПPИШЛA ЛИ ПPИBЯЗKA
 R,VTM,PROGIM
 ,MOD,237B
 J,AAX,BIT29-SM
  ,UZA,ENDMAC70.-HET
  ,XTA,.CБPOC
  J,ATX,TIMEX-SM.TAЙMEPA
  ,UJ,ZEROPC
 OWN:,BSS,
C         KMД CBOЙ
 J,XTA,DBUC-SM.ECTЬ ЛИ OБMEH
  ,U1A,ENDMAC70.ECTЬ
 PROGIM:,BSS,
C         ИMИTAЦИЯ ЗAKAЗA OБPAБOTKИ
C         ПPEPЫBAHИЙ ДЛЯ BЫДAЧИ ПOДBOДA
   :   ,24,2003B
  RL,VTM,ENDMAC70
  SENTRY:,BSS,
C......   ПOДПPOГPAMMA BXOДA B YЧACTOK
C         CПEЦ.ДEЙCTBИЙ, T.E. ЗAПYCKA
C         KAHAЛA ЗAДAЧИ OБMEHA.
C         ПOPTИT R.  OБPAЩEHИE ПO RL.
  J,XTA,BIT29-SM
  R,VJM,CLOMIR
  J,XTA,BITDISK-SM
  ,UJ,GIVTRA
C
 DISINT:,ENTRY,
C++++++++++++++++++++++++++++++++++
C    PEAKЦИЯ HA ДИCKOBЫE ПPEPЫBAHИЯ
C++++++++++++++++++++++++++++++++++
C
  ,XTA,.CБPOC
  J,ATX,TIMEX-SM.TAЙMEPA
C      ПPOБA:HE ПPИBЯЗKA ЛИ.
 J,XTA,KMDOWN-SM
 R,VTM,RETDNT.BЫXOД ИЗ DISINT
  ,UZA,LINK.A ЖДEM ЛИ ПPEP
C         YCTAHOBKA ФЛAГA ASD(FLASD.EQ.0)
  ,XTA,
 J,ATX,FLASD-SM
C         OБPAЗOBAHИE DINT -
C         ШKAЛЫ ЗAKAЗAOB HA OБPAБOTKY
C         ДИCKOBЫX ПPEPЫBAHИЙ
 R,VJM,READ PC1
 ,ATX,YINT
 ,ASN,64+8
 ,ATX,YINT1
C         ПPOБA, HE БЫЛ ЛИ OБMEH.
 J,XTA,COPC1-SM
 ,U1A,NOTRI.HE БЫЛO OБMEHA
C         ЗAПИCЬ PC1 И CПYCK ФЛAГA.
 R,VJM,READR2
 ,ASN,64-8
 ,AOX,YINT1
 J,ATX,COPC1-SM
 R,VJM,ZEROPC
 J,XTA,COPC1-SM
C         COBПAЛ ЛИ ИДEHTИФИKATOP:
 ,AAX,MBIDEN.БИT HECOBПAДEHИЯ
 ,AEX,MBIDEN
 ,UZA,BADID.HE COBПAЛ
C        CБPOC ФЛAГA ACД (FLASD(J).NE.0)
 J,ATX,FLASD-SM
 NOTRI:,BSS,.
 ,XTA,YINT
 J,AAX,CODM-SM
 ,ATX,YINT
 J,ATX,DINT-SM
C       YCTAHOBKA ФЛAГA ACД (FLASD(J).EQ.0)
C       ПPИ OTCYTCTBИИ KOHЦA OБMEHA
C       И OTCYTCTBИИ KOHЦA ПOДBOДA
 J,AOX,FLASD-SM
 J,ATX,FLASD-SM
C      ЧИCTKA KOПИИ ДИCKOBOЙ MACKИ.
 ,XTA,Y INT.
 ,AEX,FULWOR
 J,AAX,CODM-SM.KOПИЯ MACKИ
 J,ATX,CODM-SM
 RETDNT:,BSS,
C         ЗAKPЫTИE ДИCKOBЫX ПPEPЫBAHИЙ,
C         MACKИ ДИCKOB И BЫXOД.
  RL,VTM,AFGVTR
  ,UJ,SENTRY
 BADID:,BSS,
C   ---   ИДEHTИФИKATOP HE COBПAЛ -
C         - HAДO ЧИTATЬ ЗAГOЛOBOK.
C
C          YCT.HЛAГA ИДYЩEГO OБMEHA:
C         COPC(J)=0
 J,ATX,COPC1-SM
C         ПOCTAHOBKA B DBUC ПPИЗHAKA
C         ЧTEHИЯ ЗAГOЛOBKA.
 R,VTM,RHEA
 ,ITA,R
 J,AEX,DBUC-SM
 ,AAX,C7
 J,AEX,DBUC-SM
 J,ATX,DBUC-SM
C         BЫДAЧA ЧTEHИЯ ЗAГOЛOBKA.
 R,VJM,READHEAD
C         YCTAHOBKA MACKИ И BЫXOД.
 R,VTM,RETURN
  ,UJ,PERMIR/T
C
 LINK:J,XTA,WAITKMD-SM
 ,U1A,ZEROPC.ЖДEM ПPEP
 ,XTA,KREF
 J,EXT,20B.OTBЯЗKA
 ,ATI,
  ,UTC,RETURN-END DISC
  SETMRM:R,VTM,END DISC
C
C   ***********************************
C   * TOT,KTO HAБЛЮДAЛ Y CEБЯ ЯBЛEHИE *
C   * ЛOЖHOЙ ПPИBЯЗKИ KMД, HAПPИMEP,  *
C   * И.P.PЫБAKOB, ПYCTЬ BMECTO CЛEДY-*
C   * ЮЩEЙ KOMAHДЫ BCTABИT TY, ЧTO B  *
C   * KOMMEHTAPИИ ПOCЛE HEE.          *
C   ***********************************
C
  R,UJ,.OБЫЧHЫЙ CЛYЧAЙ
C      ,UJ,SETMASK.OTKPЫTЬ MACKY (ДЛЯ ЛOBЛИ ЛOЖHЯKA)
C
C
C----------------------------------
C
C......   БЛOKИ ЭЛEMEHTAPHЫX ДEЙCTBИЙ
C         BCE БЛOKИ ЛИБO ПOCЛE ИCПOЛHEHИЯ
C         ПEPEДAЮT YПPABЛEHИE HA END DISC,
C         ЛИБO ЯBЛЯЮTCЯ ПOДПPOГPAMMAMИ C
C         BOЗBPATOM ПO PEГИCTPY R ИЛИ RL.
C         (ПO YMOЛЧAHИЮ - П/П C R).
 REQUEST:,BSS,.
C......   ЗAПPOC KOHTPOЛЛEPA
C       BOЗBPAT ПO RL
  R,VTM,REQ1
C
C......   OTKPЫTИE MACKИ ГPП И
C         YCTAHOBKA TAЙMEPA
  PERMIR/T:,XTA,MAX TIME
  J,ATX,TIMEX-SM
 SETMASK:,BSS,
  J,XTA,BIT29-SM
  ,UJ,PERMIR
C
  REQ1:,BSS,
 ,XTA,BIT9
 J,033,20B
 ,ATI,
 RL,UJ,
 REFUSE:,BSS,.
C......   OTKAЗ OT KOHTPOЛЛEPA.
C         ПPИ BXOДE ДOЛЖHO БЫTЬ  ACC=0.
C   BOЗBPAT ПO  RL
 J,ATX,KMD OWN-SM
 R,VJM,CLODM
 ,XTA,KREF.
 J,033,20B
 ,ATI,.
 RL,UJ,
 KREF:,LOG,50
 ZERO PC:,BSS,.
 KRER:,EQU,BIT4.
 ,XTA,KRER.
 J,033,20B.
 ,ATI,.
 R,UJ,.
  CLODM:,24,2003B
C......   ЧИCTKA MACKИ ДИCKOB.
 ,XTA,
 SETDM:,BSS,.
C......   YCTAHOBKA MACKИ PC 1.
 KSETDM:,EQU,BIT11
 ,AOX,KSETDM.ФOPMИPOBKA KYCA
 J,EXT,20B
 ,ATI,
 R,UJ,
 ELECT:,BSS,
C......   BЫБOP MOДYЛЯ. BOЗBPAT - RL.
 KI,XTA,BIT8
 ,AOX,KELECT
 J,EXT,20B
 ,ATI,
 RL,UJ,
 KELECT:,LOG,2400
 READ PC2:,BSS,.
C......   ЧTEHИE PC 2 И 9-16 PAЗPЯДOB PC 1
C         OБOЩEHHЫЙ PC2 ПOMEЩAETCЯ B Y1.
C         ПOPTИT RL, YINT1.
   :   ,24,2003B
 RL,VJM,ELECT
 R,MTJ,RL
 R,VJM,READPC1
 ,ATX,YINT1
 R,VJM,READR2
 ,ASN,64-16
 ,AOX,YINT1
  :,24,3
 ,ASN,64+8
 ,ATX,Y1.OБOБЩEHHЫЙ PC2
 RL,UJ,
 READR2:,BSS,
C......   ЧTEHИE PC2.
 ,XTA,KRPC2
 J,033,20B
 ,ATI,
 J,033,4000B
 ,AOX,BIT40
 R,UJ,
 KRPC2:,LOG,31
 READ PC1:,BSS,
C......   ЧTEHИE PC 1
 ,XTA,KRPC1
 J,EXT,20B.
 ,ATI,.
 J,EXT ,4000B
 R,UJ,
 KRPC1:,LOG,11
 MOVE0:,BSS,.
C......   YCTAHOBKA HA 0-OЙ ЦИЛИHДP.
C         ПOPTИT RL.
 KMOVEO:,EQU,BIT1
   :   ,24,2003B
 RL,VJM,ELECT
 ,XTA,KMOVEO
 J,EXT,20B.
 ,ATI,
C         OPГAHИЗAЦИЯ BЫДEPЖKИ BPEMEHИ.
C         T = 50 MИKPOCEKYHД.
 RL,VTM,1-15
  :,24,3
 ,UJ,WAITR
 MOVE:,BSS,
C......   BЫДAЧA ДBИЖEHИЯ ПO ИHФOPMAЦИИ ИЗ
C         CUORD(A). ПOPTЯTCЯ RL,YINT.
 KMOVE:,EQU,BIT2
   :   ,24,2003B
 RL,VJM,ELECT
 ,XTA,KMOVE
    J,EXT,20B
 ,ATI,
 A,XTA,CUORD
 RL,VJM,SETPATH
   :   ,24,3
C         OPГAHИЗAЦИЯ BЫДEPЖKИ BPEMEHИ
C         T = 17 MИKPOCEKYHД.
 RL,VTM,1-5.1-T/3.4MKCEK
 WAITR:,BSS,.
C         OЖИДAHИE OCBOБOЖДEHИЯ KMД
C         RL=1-T/3.4MKCEK. T-HYЖHOE BPEMЯ.
 ,ATI,
 ,ATI,
 RL,VLM,WAITR
 R,UJ,
 TRANSF:,BSS,
C......   ЗAПИCЬ, ЧTEHИE И PAЗMETKA.
C
C         BEДEHИE CЧETЧИKA OБMEHOB
 ,XTA,BIT37.EДИHИЦA CЧETЧИKA
 ,ARX,COUNTTR
 ,ATX,COUNTTR
 J,XTA,DBUC-SM.KYC ГЛAB. OЧ.
C         ЗAHECEHИE ИДEHTИФИKATOPA B Y3
 ,ASN,64+7.
 ,AAX,C3.
 ,ASN,64-4.
 ,ATX,Y3.
  ,ASN,64-3
  J,AEX,DBUC-SM
  ,ATX,YINT1
C         OПPEДEЛEHИE TИПA OБMEHA
 ,AAX,C3.
 ,ATI,P.TИП
C         ЗAПYCK YBY
  ,ITA,K.HOMEP
  ,ASN,64-7.MOДYЛЯ B
  ,AOX,YINT1.8-10 P.БYC
 ,AAX,MYBY.
 J,033,.
  ,ATI,
  RL,VTM,PUTCOM
  J,XTA,TYPD-SM
  ,UZA,ELECT.7MБ
  J,XTA,BIT24-1
  ,AAX,PRDK
  ,U1A,ELECT.ДYБHA-29
C         BЫДAЧA KOMAHДЫ B KMД
  PUTCOM:P,XTA,KYCS.KOMAHДA
 ,AOX,Y3.ИДEHTИФИKATOP
 J,033,20B.
 ,ATI,.
C         BЫДAЧA HOMEPA ДOPOЖKИ
 J,XTA,DBUC-SM
 RL,VJM,SETPATH
 ,XTA,.
 J,ATX,COPC1-SM.ФЛAГ OБMEHA.
 ,033,
 RL,VTM,8.
 CBS:,ATX,1.
 RL,UTM,-1.
 RL,VIM,CBS.
 R,UJ,.
 KYCS:,BSS,
C         KOMAHДY OБMEHA.
 ,LOG,4.ЗAПИCЬ
 ,LOG,5.PAЗMETKA
 ,LOG,3.ЧTEHИE
 ,LOG,6.CPABHEHИE
 READHEAD:,BSS,
C......   ЧTEHИE ЗAГOЛOBKA
 KRHEAD:,EQU,C7
 ,XTA,YBYRH
 J,EXT,
 ,XTA,KRHEAD
 J,EXT,20B
 ,ATI,
 R,UJ,
 YBYRH:,LOG,4440 0000
 SETPATH:,BSS,
C......   BЫДAЧA B KMД HOMEPA ДOPOЖKИ.
C         BOЗBPAT - RL. KYC ГЛ.OЧ. - YINT.
 KSET12:,EQU,BIT8
 ,ASN,64+25
 ,AAX,C7777
 ,ATX,YINT.N ДOPOЖKИ
 J,ARX,TYPD-SM
 ,U1A,SET11/1.ДИCK HA 7MГБAЙT
C       HE ЗABOДCKOЙ ЛИ KMД
  ,XTA,PRDK
  J,AAX,BIT24-1
  ,UZA,CAMKMD.-ДA
  ,XTA,YINT
C         BЫДAЧA CTAPШEГO PAЗPЯДA
 ,AAX,BIT12
 ,ASN,64+7
 ,AOX,KSET12
  SET12:,BSS,
 J,033,20B
 ,ATI,
 SET11/1:,XTA,YINT.BЫДAЧA
 ,AOX,BIT12.MЛAДШИX PAЗPЯ-
 J,033,20B.ДOB ДOPOЖKИ
 ,ATI,
 RL,UJ,
  CAMKMD:,BSS,
C       BCTABKA ДГ B KYC BЫБOPKИ HMД
  ,XTA,YINT
  ,AAX,BIT12
  ,ASN,64+2
  KI,AOX,BIT8
  ,AOX,KELECT
  ,UJ,SET12
C......   KOHEЦ ЭЛEMEHTAPHЫX ДEЙCTBИЙ
C......   PAЗHЫE KOHCTAHTЫ
 M41:,000,
 ,Z00,-41.
 C1/10:,LOG,4001 4631 4631 4632
 GKYCREAD:,LOG,400002
  MYBY:,LOG,1 4177 1600
 MASKWL1:,LOG,3 7777 7737 0120
 MADORSPB:,LOG,7777 7776 0000 0170
 MAKOM:,LOG,400 007
 MCAM:,LOG,04102 04102 04102 0
C         TAБЛИЦA ПEPEKOДИPOBKИ KOMAHД.
 TABKYC:,BSS,
 ,OCT,35402072040.7604 3A10
 ,OCT,77402072064.FE04 3A1A
 ,OCT,35402072050.7604 3A14
 ,OCT,77402072064.FE04 3A1A
C         TAБЛИЦA БИTOB CTATYCA
 TBCTATYC:,GOST,6H0000'121''20'.3,1,1,0
 ,BSS,
C......   MACKИ ABAPИЙ
C MABT   :  , EQU ,BIT4
 MCOMP:,LOG,2010
 CREADY:,LOG,60 0001
C BNEWM  :  , EQU ,BIT11   .CПA
  MNEWM  :  , LOG ,2 2000  .CПA + POФ
C B1PCK  :  , EQU ,BIT3
 TT/TEK:,BSS,
C         TEKCTЫ ДИAГHOCTИK TT
 KERNOR:,ISO,6HMДHEГT
 KEERA:,ISO,6HMD AД.
 KEERC:,ISO,6HMD KC.
 KEERYBY:,ISO,6HMD OШM
 KERBM:,ISO,6HKAЛИБP
 KERKMD:,ISO,6HMD OБ.
 KERCMO:,ISO,6HMДCTOП
 KERWR:,ISO,6HMД ЗAП
  KERSS:,ISO,6HMD SSW
 :,BSS,
C         KOHCTAHTЫ TEЛETAЙПA
  MU1/177 :,GOST,6H1'177'0000
  MUNLET  :,GOST,6H777777
  CT30    :,ISO,6H30 000
  CT0000  :,ISO,6H 0000
  CTSH    :,ISO,6H00 Ш00
  CT000000:,ISO,6H000000
  MPPC:,LOG,377 7417
C         PAЗДYБЛИPOBAHHЫE ЯЧEЙKИ.
 CNMOD:,BSS,NCHD
 KMD OWN:,BSS,NCHD
 CODM:,BSS,NCHD
 COPC1:,BSS,NCHD
 MACI:,BSS,NCHD
 FLASD:,BSS,NCHD
 DBUC:,BSS,NCHD.
 DINT:,BSS,NCHD.
 SKAL:,BSS,NCHD
 MWSC:,BSS,NCHD
 WAITKMD:,BSS,NCHD
C         PAБOЧИE ЯЧEЙKИ
 TTBUF:,BSS,
 Y3:,BSS,1
 Y4:,BSS,1
  Y41:,LOG,
  Y42:,LOG,
  Y43:,LOG,
 ,LOG,
 ,END,.
 CHVOP:,NAME,
 BITS:,EQU,677B
  BIT29:,EQU,723B
 TRABUS:,LC,1
C         V-OПEPAЦИЯ ДOCTYПA K БЫCTPЫM KПДП
  ,XTA,S.ПPOЧИCTKA
  14,AOX,BITS.CBOEГO
  14,AEX,BITS.БИTA
 ,AOX,W.ИЗBЛEЧEHИE ИЗ
 ,ATX,S.OЧEPEДИ ЖДYЩИX
   :   ,24,2003B
 ,XTA,W.OTKPЫTИE
 ,AOX,TRABUS.ЖДYЩEГO
 ,ATX,TRABUS.KAHAЛA
   :   ,24,3
  ,XTA,W+1
  ,ATX,W
 ,XTA,.ГAШEHИE OЧEPEДИ
  ,ATX,W+1.B XBOCTE
 13,UJ,
 CHPOP:,ENTRY,
C         P-OПEPAЦИЯ ДOCTYПA K БЫCTPЫM KПДП
C         ECЛИ ПOЛYЧEH ДOCTYП, И15=0.
 ,XTA,S
 14,AOX,BITS.ПPOBEPKA
 14,AEX,BITS.HAЛИЧИЯ PECYPCA
 ,ACX,.
 ,ASN,64+1.ECЛИ OH ECTЬ,
 ,ATI,15.B И15 0,ИHAЧE 1
  ,UZA,*1
  ,XTA,W.KAK OЧEPEДЬ
  ,UZA,*1.ПYCTA
  14,AEX,BITS.KEM ЗAHЯTA:
  13,UZA,.HAMИ
  15,UTM,1
  *1:,BSS,
 14,XTA,BITS.ЗAHECEHИE БИTA
 15,AOX,S.B CEMAФOP
 15,ATX,S.ИЛИ OЧEPEДЬ
 13,UJ,
C
  PS*VOP:,ENTRY,
C         V-OПEPAЦИЯ ДOCTYПA K ЛИCTY
C         CYMMATOP = БИT ДЛЯ TRABUS
C         BHEШHИE ПPEPЫBAHИЯ PAЗPEШAЮTCЯ !
  ,AAX,QTOP
  ,UZA,V/EXIT.H2 БЫЛO P
  ,XTA,
  ,ATX,QTOP
  ,XTA,WQTOP
  ,UZA,V/EXIT.OЧEPEДЬ ПYCTA
  ,ANX,
  ,ATI,11
  :11,XTA,BITS
  ,AEX,WQTOP
  ,ATX,WQTOP
  11,XTA,BITS
  :,24,2003B
  ,AAX,=:14
  ,UZA,TAPE
  ,AOX,TRABUS
  ,ATX,TRABUS
  13,MTJ,10
  11,XTA,BIT29-3
  ,CALL,CLOMIR
  10,MTJ,13
  ,UJ,V/EXIT
  TAPE:14,MTJ,10
  11,MTJ,14
  14,UTM,-2
  15,MTJ,11
  15,CALL,TRA TAPE
  11,MTJ,15
  10,MTJ,14
  V/EXIT:,24,3
  5,UJ,
  PS*POP:,ENTRY,
C         P-OПEPAЦИЯ ДOCTYПA K ЛИCTY
C         CYMMATOP = БИT ДЛЯ TRABUS
C         ECЛИ ДOCTYП ПOЛYЧEH, И11=0
  11,VTM,
  ,ATX,WS
  ,AOX,WQTOP.BЫЧИCTKA
  ,AEX,WS.  ИЗ
  ,ATX,WQTOP.OЧEPEДИ
  ,XTA,QTOP.CEMAФOP
  ,UZA,SET.CBOБOДEH
  ,AEX,WS
  5,UZA,.YЖE HAШ
  11,VTM,1
  SET:,XTA,WS.ЗAHECEHИE
  11,AOX,QTOP.B CEMAФOP
  11,ATX,QTOP.ИЛИ B OЧEPEДЬ
  5,UJ,
   QTOP:,LOG,.CEMAФOP
  WQTOP:,LOG,.OЧEPEДЬ
  WS   :,LOG,.
 S:,LOG,
 W:,LOG,
  :,LOG,
 ,END,
 *DSCRFI:,NAME,
 ,BSS,5
 ,OCT,4
 ,OCT,4
 ,OCT,.CEMAФOPЫ MOHOПO-
 ,OCT,.ЛИЗAЦИИ KAHAЛOB
 ,END,
 RECMDT:,NAME,
C......   KAHAЛ OПOЗHABAHИЯ ПAKETOB.
C         PAБOTAET HA 38P. TRABUS.
 TASKON:,SUBP,
 ENDMAC70:,SUBP,
 DRIDENT:LC,BLOCK,(1),KYC
  DAFSET:,SUBP,
 *DISCS:LC,BLOCK,DNAM(16),(16)
 SCALSTRA:LC,BLOCK,(44),SQTM(16)
 *DSCRFI:,SUBP,
 *DSCRFI:I,BLOCK,(3),Y,Y5
 *ИПД:    LC,BLOCK,(5),XNC,(10),LFATA
            ,CONT, (10),MONOS
 LF:,WEQ,LFATA
 FATA:,LC,LF
 NCH:,WEQ,XNC
 *ИПK1:,LC,1
 MONO:,EQU,*ИПK1+NCH
 C77777:,LC,1
 C7    :,LC,1
 C5    :,LC,1
 *CB:LC,BLOCK,(1),C17,(1),B36/31
 *700:B,BLOCK,BIT48(2),BIT46(6),BIT40
 ,CONT,(7),BIT32(16),BIT16(15)
 ,CONT,BIT1
 CMDREC:LC,BLOCK,SCMDR,SCREC,SMWR,WACNTS
 ,CONT,(1),BUSY
 *5:,BLOCK,R,A,W,P,U
 ,XTA,BUSY
 ,U1A,ENDMAC70.KAHAЛ ЗAHЯT
C         YCTAHOBKA HOMEPA TEKYЩEГO MOДYЛЯ,
C         COOTBETCTBYЮЩEГO HOMEPA HAПPABЛE-
C         HИЯ И MACKИ ДЛЯ CЧETA ЗAДEPЖKИ.
 ,XTA,CMOD
 ,ATI,A.N MOДYЛЯ
 ,ARX,BIT1
 ,AAX,C17
 ,ATX,CMOD
 ,ITA,A
 ,ASN,64+3
 ,ATI,U.N HAПPABЛEHИЯ-3
 ,XTA,MASK
 ,ASN,64-3
 ,U1A,*1
 ,XTA,C7
 *1:,ATX,MASK.TEKYЩAЯ MACKA
C         HA БЛOKИPOBAHO ЛИ OПOЗHABAHИE ПO
C         ДAHHOMY HAПPABЛEHИЮ ИЛИ MOДYЛЮ.
 ,XTA,1
 U,AAX,BIT46
 ,U1A,ENDMAC70.БЛOK.ПO HAПPABЛ.
 ,XTA,SCREC
 A,AAX,BIT48
 ,U1A,ENDMAC70.БЛOK.ПO MOДYЛЮ
C         ПPOBEPKA ЗAДEPЖKИ ПO MOДYЛЮ
 ,XTA,WACNTS
 ,AAX,MASK
 ,UZA,TO REC.HET ЗAДEPЖKИ
C         CЧET ЗAДEPЖKИ
 ,ARX,MASK
 ,AEX,WACNTS
 ,AAX,MASK
 ,AEX,WACNTS
 ,ATX,WACNTS
 ,UJ,ENDMAC70
 TO REC:,BSS,
C         BЫДAЧA ЗAKAЗA KAHAЛA OПOЗHABAHИЯ
 ,ITA,A
 ,AAX,C7.N MOДYЛЯ
 ,ASN,64-7.B HAПPABЛEHИИ
 ,ARX,CW
 U,VZM,*2.ЫЧET HOMEPA
 ,ARX,BIT40
 *2:,ATX,KYC
  9,VTM,DAFSET
 ,ATX,BUSY.ФЛAГ ЗAHЯT.
C         ФOPMИPOBKA KOП ПO COCTOЯHИЮ OM-HMД
 ,XTA,SCMDR
 A,AAX,BIT48
 ,U1A,TASKON.COCT.='ГOTOB'
 ,XTA,C5.ЗAMEHA ЗAKAЗA HA
 ,AEX,KYC.OПPOC ГOTOBHOCTИ
 ,ATX,KYC.ЧTEHИEM ИMEHИ
 ,ATX,BUSY
 ,UJ,TASKON
 ENSPTR:,ENTRY,
C......   П/П KOHЦA ИCПOЛHEHИЯ ЗAKAЗA KAHAЛA
C         OПOЗHABAHИЯ. OБPAЩEHИE ПO 5(R).
C         HA BXOДE B A N MOДYЛЯ-30B.
     ,ATX,BUSY.ИMЯ ПAKETA
 R,UZA,.MOД.HE ГOTOB
 ,XTA,SCMDR
 A,AAX,BIT48
  A,UTM,30B
 ,U1A,RET.OH И БЫЛ ГOTOB
  W,VTM,SMWR
C         ПOИCK ПAKETA C TEM ЖE ИMEHEM.
 U,VTM,1-16
 LSP:U,XTA,DNAM+15
 ,AEX,BUSY
 ,UZA,OLD.HAШЛИ
 U,VLM,LSP
C         ПAKET HOBЫЙ, HO CBOБOДEH ЛИ
C         ДAHHЫЙ MOДYЛЬ:
 A,XTA,DNAM-30B
 ,U1A,M***K.NET
C...   ЗAHECEHИE БИTA MOДYЛЯ
C      B ШKAЛY ПO PEГИCTPY W:
C      SMWR  - MOДYЛЬ ЖДET OПOЗHAHИЯ
C      SCMDR - MOДYЛЬ ГOTOB
  TO SCAL:A,XTA,BIT48-30B
  W,AOX,
  W,ATX,
  RET:A,UTM,-30B
  ,XTA,
 ,ATX,BUSY
 R,UJ,
 OLD:,BSS,
C         ПOЯBИЛCЯ CTAPЫЙ ПAKET
 A,XTA,DNAM-30B
 ,UZA,MOVE.MOДYЛЬ CBOБOДEH
C         TAM ЛИ ПAKET,ГДE OH БЫЛ PAHЬШE:
 U,AEX,DNAM+15
 ,U1A,M***K.NET
 DEBLOCK:,BSS,
C         ПEPEBOД HMД B COCTOЯHИE 'ГOTOB'
  W,VTM,SCMDR
  ,UJ,TO SCAL
 MOVE:,BSS,
 ,XTA,SCMDR.ПOЯBИЛCЯ
 U,AAX,BIT48+15.ДYБЛЬ
 ,U1A,DEBLOCK.ПAKETA
C         CTAPЫЙ ПAKET HA HOBOM CBOБOДHOM
C         MOДYЛE. OПEPAЦИЯ ПEPECTAHOBKИ
 U,UTM,30B+15
 ,ITA,U.CTAPЫЙ HOMEP
 ,ASN,64-30.MOДYЛЯ,
 ,ATX,Y.ГДE БЫЛ ПAKET
 ,ITA,A.HOBЫЙ HOMEP
 ,ASN,64-30
 ,AEX,Y
 ,ATX,Y5
 ,ITA,U
 ,AEX,C77777
 ,ATI,W
 A,J+M,W
C         ЗAПИCЬ ИMEHИ ПAKETA B TAБЛИЦY
  ,XTA,BUSY
 A,ATX,DNAM-30B
C         ПEPECTAHOBKA ШKAЛ-OЧEPEДEЙ
 U,XTA,SQTM-30B
 A,ATX,SQTM-30B
 ,XTA,
 U,ATX,SQTM-30B
C         ПEPECTAHOBKИ B ШKAЛAX-CEMAФOPAX
 U,XTA,BIT48-30B
 U,AOX,BIT32-30B
 U,AOX,BIT16-30B
 ,AAX,MONOS
 ,ATX,BUSY
 W,ASN,64+1
 ,AOX,BUSY
 ,AEX,MONOS
 ,ATX,MONOS
 P,VTM,NCH
 LSCC:P,UTM,-1
 P,XTA,MONO
 U,AAX,BIT48-30B
 ,ATX,BUSY
 W,ASN,64+1
 ,AOX,BUSY
 P,AEX,MONO
 P,ATX,MONO
 P,V1M,LSCC
C         KOPPEKЦИЯ TAБЛИЦЫ ФAЙЛOB(FATA).
 P,VTM,LF
 LCORF:P,UTM,-1
 P,XTA,FATA
 ,AEX,Y
 ,AAX,B36/31
 ,U1A,EN
 ,XTA,Y5
 P,AEX,FATA
 P,ATX,FATA
 EN:P,V1M,LCORF
 ,UJ,DEBLOCK
 M***K:,BSS,
C         ПAKET ПOПAЛ HA ЗAHЯTЫЙ MOДYЛЬ
 TTPRINT:,SUBP,
C         ПOДГOTOBKA TT TEKCTA OПEPATOPY
 ,ITA,A
 ,ASN,64-42
 ,AUX,CU1
 ,AOX,CT1
 ,ATX,TTEK
 14,MTJ,U
   :   ,24,2003B
C         COБCTBEHHO ДИAГHOCTИKA
 14,VTM,TTEK
 ,ITA,14
 14,VJM,TTPRINT
 U,MTJ,14
 ,UJ,RET
 CU1:,GOST,6H000770
 CT1:,ISO,6HMOД00
 TTEK:,BSS,1
 ,ISO,6HЗAHЯT''
 CW:,LOG,32 0010 4177 0127
 MASK:,LOG,
 CMOD:,LOG,
 ,END,
 *CB:,NAME,.
 ,OCT,76
 ,LOG,17
 ,LOG,7777 7776 0000 0077
 ,OCT,0000 77
 ,OCT,7777 7777 7777
 ,LOG,17776
C.....   K-TЫ ПEPEBOДA BPEMEHИ
 ,REAL,36000.
 ,REAL,3600.
 ,REAL,600.
 ,REAL,60.
 ,REAL,10.
 ,REAL,1.
 ,REAL,50.
 ,INT,0
 ,END,
 MDRECOGN:,NAME,.26.06.74
C
C======   STATISTICS FOR INGENEERS
C======   RESIDENT OF MD-RECOGNIZING
C
 NR/MD:,SUBP,.
C******   OПPOC ГOTOBHOCTИ MOДYЛEЙ MД,
C
C......   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ:
 T:,EQU,4.
 RJ:,EQU,6.
 R:,EQU,7.
C
  * И П Д :LC,BLOCK,(1),XNFM(5),XNCM
  NFM:,WEQ,XNFM
  NCM:,WEQ,XNCM
 Ш/FULL:,EQU,*ИПД+11B
 Ш/ПOTOK:,EQU,*ИПД+12B
 SMASAV:LC,BLOCK,SAVAC
 C MDREC:LC,BLOCK,SC MDR,SC REC,NMOD
 ,CONT,WA CNTS,CEKMET
 *YCЫ:LC,BLOCK,(1),RDSCAL
 *SWCMN:LC,BLOCK,SBUSYFLG,SWSCAL
 BPEMEHA:LC,BLOCK,T1(4)
 C37:,LC,1
  B30/16:LC,BLOCK,MSHI
  B16/1:,LC,1
 C7:,LC,1.
 C177:LC,BLOCK,MASTA
 *STATBUF:LC,BLOCK,MBLO,MOUT
 STATIST:,SUBP,.
 NRESCALL:,SUBP,.
  NR/STAT:,SUBP,
  ABTIME:,LC,
  *530:B,BLOCK,STAT IS,NEWTIME
  *TLWORK:LC,BLOCK,OLDTIME
  *CB:LC,BLOCK,(13),INT0
  BLSTOUT:LC,BLOCK,TSEC
  STATUSMT:LC,BLOCK,MBUS,OLD(4),NEW(4)
  ,CONT,W05741(4)
  SCALES:LC,BLOCK,(4),SCALCLTA
  TRA TAPE:,SUBP,
  CLANEWTA:,SUBP,
  *677:B,BLOCK,BITS
  ,CONT,B48,B47,B46,B45,B44,B43,B42,B41
  ,CONT,B40,B39,B38,B37,B36,B35,B34,B33
  ,CONT,B32,B31,B30,B29,B28,B27,B26,B25
  ,CONT,B24,B23,B22,B21,B20,B19,B18,B17
  ,CONT,B16,B15,B14,B13,B12,B11,B10,B9
  ,CONT,B8,B7,B6,B5,B4,B3,B2,B1
C-------------
 ,XTA,MBLO.
 ,UZA,NO STA.CTAT.БЛOKИP.
 ,XTA,MOUT.
 ,AOX,TSEC.
 ,UZA,NO STAT.
 T,CALL,STATOUT.
 NO STAT:,XTA,CEKMET
 ,UZA,NO STA
 ,XTA,WCNT
 ,ARX,B1.
 ,AAX,MA STA
 ,ATX,WCNT.
 ,UIA,NO STA.
 R,VTM,-3
 *L1:R,XTA,T1+3
 R,ATX,*T1+3
 R,VLM,*L1
  13,VTM,1-NCM
  14,VTM,NFM
 T,VTM,
 Ф MM:14,XTA,*YCЫ.
 ,ATI,12
 ,AAX,M SHI
 ,UZA,ФMM1
 ,XTA,Ш/ПOTOK
 14,AAX,BITS
 ,UZA,HEП 1
 ,UTC,2
 HEП 1:R,VTM,
 ,NTR,6
 R,VZM,HEП 2
 ,UTC,37B
 HEП 2:T,UTM,1
 12,VZM,ФMM1.ИПЗ OTKAЧAHO.
 12,XTA,-1
 R,A+X,*T1
 R,ATX,*T1
 12,XTA,110B
 R,A+X,*T2
 R,ATX,*T2
 ФMM1:14,UTM,1
 13,VLM,ФMM
 R,VTM,-1
 10,VTM,
 *L2:10,XTA,*T1
 ,NTR,3
 ,A+X,INT0
 ,ASN,64-20
 R,ATX,*T1+1
 10,XTA,*T2
 ,A+X,INT0
 R,AOX,*T1+1
 ,ASN,64-8
 R,ATX,*T1+1
 10,UTM,2
 R,VLM,*L2
 ,XTA,RDSCAL
 ,AOX,SWSCAL
 ,WTC,SBUSYFLG
 ,AOX,BITS
 ,ATX,*T3
 ,ITA,T
 ,AAX,C37
  ,UZA,*1
 ,AOX,*T1
  *1:,BSS,
 ,ATX,*T1
 ,ITA,T
 ,ASN,64+5
  ,UZA,*2
 ,AOX,*T2
  *2:,BSS,
 ,ATX,*T2
 ,XTA,MИHMET
   :   ,24,2003B
 ,UJ,STATIST
 MИHMET:3,Z00,*T1
 1,Z03,NO STA.
 NO STA:,BSS,.
  15,VTM,*T1
  14,VTM,-3
  :,24,2003B
  ,XTA,
  :14,XTS,NEW+3
  14,AEX,OLD+3
  15,AOX,
  14,VLM,*-1
  ,ASN,64+8
  ,AAX,B16/1
  ,AOX,NMOD
  ,U1A,CALL
  ,XTA,2.HA TP-2
  ,AAX,STAT IS.БИT BEДEHИЯ CTAT
  ,AOX,OLDTIME. ECTЬ KAHAЛЫ?
  ,UZA,RET.- HE BEДEM
  ,NTR,2
  ,XTA,ABTIME
  ,A-X,NEWTIME
  ,U1A,RET
  ,XTA,I/STAT
  ,UJ,NRESCALL
  I/STAT:,Z00,NR/STAT
  ,Z00,RJ
C
  CALL:,BSS,
 ,XTA,IW CALL.
 ,UJ,NRESCALL.
 IW CALL:,Z00,NR/MD.
  ,Z00,RJ
 MD/RET:,ENTRY,.
  RET:,BSS,
  :,24,2003B
  ,XTA,
  ,ATX,MBUS
  ,ATX,CEKMET
  ,UJ,CLANEWTA
C
C****  OTKPЫTИE ЗAДAЧ, ЖДYЩИX MЛ/MД
C
  OPENWAIT:,ENTRY,
  ,XTA,B18
  ,CALL,K COCEДY
  ,XTA,SCALCLTA
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  ,XTA,
  ,ATX,SCALCLTA
  :,24,3
  5,UJ,
C
C****  AKTИBИЗAЦИЯ ЗAKAЗOB HA OБMEH C MЛ,
C      ЗAДEPЖAHHЫX ПO HEГOTOBHOCTИ MФ.
C
  TOЛЧOK:,ENTRY,
  :,24,2003B
  2,XTA,B8
  1,AOX,W05741-3
  1,ATX,W05741-3
  1,MTJ,14
  5,MTJ,15
  ,UJ,TRA TAPE
C--------
 WCNT:,LOG,7.
C--------
 *T1:,BSS,1
 *T2:,BSS,1
 *T3:,BSS,2
 ,END,.
 NRSMDREC:,NAME,.
C
C======   NONRESIDENT OF MD-RECOGNIZING
C         (BASE-REGISTER : RJ)
C
C         BOCCTAHOBЛEHИE KATAЛOГA APXИBA,
C         ПOДKЛЮЧEHИE CПEЦ-ФAЙЛOB И
C         SCRATCH-OБЛACTEЙ B PAБOTY.
C
C......   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ:
 NM:,EQU,3.
 T:,EQU,4.
 MT:,EQU,T.
 RR:,EQU,5.
 RJ:,EQU,6.
 R:,EQU,7.
 L:,EQU,R.
 L1:,EQU,8.
 C:,EQU,L1.
 E:,EQU,9.
 EC:,EQU,10.
 A:,EQU,11.
 A1:,EQU,A.
 A2:,EQU,12.
C
 SMASAV:LC,BLOCK,SAVAC
 TPHYS:,LC,1.
  * И П Д :LC,BLOCK,XNF,XNFM(7)
  ,CONT,Ш/CЛYЖ,Ш/FULL
  ,CONT,(6)
  ,CONT,LFATA,LENTDIS
 ,CONT,(9),MONOS
  ,CONT,NЭKCT
  ,CONT,(8)
 ,CONT,(10)
  ,CONT,SCMAMБ
  *DISCS:LC,BLOCK,DNAM(32),ШMOД,ШФЛД
  TSA:,EQU,425B.9 CЛOB
  FATA:,LC,1
  DISPBASE:LC,BLOCK,(4),DISPFIL,DISPNAM
  ,CONT,NEVM.B 48-47 P.
  NFRITR:,LC,1
 FLMAMБ:,LC,1
  TABDRU:LC,BLOCK,(16),DRUMOD
  *ПДИCK:LC,BLOCK,*KOMOД
  NUMFILES:,EQU,LFATA
 LTF1:,WEQ,NUMFILES.
 LTF:,EQU,LTF1-1.
  *TDIS:,LC,.TAБЛ.ЭKCTEHTOB
 LNTDIS:,WEQ,LENTDIS
  TABLEMT:LC,BLOCK,(48),T2MT(48),TANAME(48)
 N FIL:,EQU,T2MT.
 STATUSMT:LC,BLOCK,(1),OLD(4),NEW(4),W05741(19),ШHГ(4),MISTERX
 C MDREC:LC,BLOCK,SC MDR,SC REC,SMWR
 ,CONT,WA CNTS,CEKMET
  REWINDSC:LC,BLOCK,(3),ПEPEXBAT(4)
  SCALSTRA:LC,BLOCK,(12),SJMT
C---
  *677:B,BLOCK,BITS
  ,CONT,B48,B47,B46,B45,B44,B43,B42,B41
  ,CONT,B40,B39,B38,B37,B36,B35,B34,B33
  ,CONT,B32,B31,B30,B29,B28,B27,B26,B25
  ,CONT,B24,B23,B22,B21,B20,B19,B18,B17
  ,CONT,B16,B15,B14,B13,B12,B11,B10,B9
  ,CONT,B8,B7,B6,B5,B4,B3,B2,B1
C---
 B SFI:,EQU,B40.
 B WRIT:,EQU,B30.BIT30
 B NRD:,EQU,B29.
 C20:,EQU,B5
 *CB:LC,BLOCK,(1),C17
 C7777:,LC,1
 C76000:,LC,1
 C7:,LC,1.
 C77777:,LC,1.
 B24/1:,LC,1
  B16/1:,LC,1
  C3:,LC,1
 FULWOR:,LC,1.
 *0:,BLOCK,NZON,BOS,DAT,VER
C
C......   SUPERVISOR - SUBPROGRAMMS
C
 STATIST:,SUBP,.
 NRESCALL:,SUBP,.
 NRES OFF:,SUBP,.
  BC1700:,SUBP,
  OPENWAIT:,SUBP,
  TOЛЧOK:,SUBP,
 TYPEMT:,SUBP,
 BLK*MT:,EQU,TYPEMT+7
 B24/9:,EQU,=7777 7400
C
C......   CONNECTION WITH 'MDRECOGN'
C
 NR/MD:,SUBP,.
 MD/RET:,SUBP,.
 WKFI:I,BLOCK,NM/KYC,P/KYC,KYC
 SCDICH:,SUBP,
 TYPD:,EQU,SCDICH+3
C
C         PACПPEДEЛEHИE PAБOЧEГO ЛИCTA
C         ДЛЯ ЗAXBATA ЭKCTEHTOB ДЛЯ ROLLIN
C
 *0:,BLOCK,(8),KTRSPT,MMTA,CFWORK
 ,CONT,FWORK,CURRF,NSCRCF
 ,CONT,CTNE,OLDCTNE,NSTRING,
 ,CONT,MASK,JCTNE,DSTN
C         OПИCAHИE CEKTOPA ROLLOUT/ROLLIN
 *1400:B,BLOCK,(1)
 ,CONT,NTASK,CRT,(2),INABEG(7)
 ,CONT,OLDSTN,COTEX
 ////:,EQU,COTEX+LNTDIS
 ////:I,BLOCK,(2),COTSAR
 ,CONT,REFOLD,NAMEDSA
 SCALES:LC,BLOCK,(1),MRDSCALE
 ДOПYПP:LC,BLOCK,(10),NTRFRO
 TRAPHY:,SUBP,
C
 BASE:,BSS,.
 RJ,REL,*.
 ,XTA,0
 ,ATX,NPAG.
C         YCTAHOBKA N MOДYЛЯ B PAЗHЫX BИДAX
C         И ЯЧEЙKИ TИПA ДИCKOB(29 ИЛИ 7)
 ,XTA,SMWR.ПOЛYЧEHИE HOMEPA
  ,UZA,CHTAPES
 ,ANX,B24/1.OЧEPEДHOГO HMД
 ,ATI,NM
 ,ARX,C30
 ,ASN,64-30
 ,ATX,NM/FATA
 NM,XTA,B48.ЧИCTKA OЧEPEДИ-
 ,AEX,SMWR.-ШKAЛЫ HMД, ЖДY-
 ,ATX,SMWR.ЩИX OПOЗHABAHИЯ
 ,ITA,NM
   :   ,24,3
 ,ASN,64-7
 ,ATX,NM/KYC.ДЛЯ 3-ГO ГOTOBO
 ,AAX,B11
 ,UZA,*1.3-E HAПPABЛEHИE
 ,ARX,NM/KYC.KOPPEKTИPOBKA
 ,ATX,NM/KYC.ДЛЯ 4-ГO
 ,UTC,1
 *1:,XTA,TYPD.TИП ДИCKOB
 ,AEX,B48.ДЛЯ 29 ПOCTABИM
 ,ASN,64+5.CДBИГ HA 0 PAЗ-
 ,AOX,B48.PЯДOB, ИHAЧE HA
 ,ATX,TYPDIN.2 PAЗPЯДA BПPABO
 ,NTR,3
 R,VJM,GIV PAG.ЗA ЛИCTOM
C.........   ЧTEHИE, AHAЛИЗ KATAЛOГA И ДYБЛЯ
C            BOCCTAHOBЛEHИE TOГO ИЛИ ДPYГOГO
 T,VTM,X C1.AHAЛИЗ 1-ГO
 RR,VJM,RE AN.ЛИCTA KATAЛOГA
 E,MTJ,EC.
 EC,VZM,RE CAT0.OH-XOPOШИЙ
 E,UTM,-1.
 E,VZM,RE COPY.OH-ПЛOXOЙ
 RE CAT0:T,VTM,X C0.AHAЛИЗ 0-ГO
 RR,VJM,RE AN.ЛИCTA KATAЛOГA
 EC,VIM,AN ERC.1-ЫЙ HEXOP.
 E,VIM,AN ERC.0-OЙ HEXOP.
 L,VTM,1-4.CPABHEHИE
 CH EQC:L,XTA,XAP0+3.XAPAKTEPИCTИK
 L,AEX,XAP1+3.
 ,UIA,ПЛOX ПAK.OHИ-HE COBП.
 L,VLM,CH EQC.
 ,UJ,CATAL.KATAЛOГ-XOP.
 AN ERC:E,VZM,RE COPY.YCИЛEHИE
 E,MTJ,EC.OШИБKИ
 RE COPY:,BSS,.
C.........   HEOБXOДИMA ПEPEПИCЬ.
C            ПPOBEPKA ДYБЛЯ KATAЛOГA
 T,VTM,X D1.AHAЛИЗ 1-ГO
 RR,VJM,RE AN.ЛИCTA ДYБЛЯ
 E,VIM,AN ERD.OH-ПЛOXOЙ
 T,VTM,X D0.AHAЛИЗ 0-ГO
 RR,VJM,RE AN.ЛИCTA ДYБЛЯ
 E,VIM,AN ERD.OH-ПЛOXOЙ
 L,VTM,1-4.CPABHEHИE
 CH EQD:L,XTA,XAP1+3.XAPAKTEPИCTИK
 L,AEX,XAP2+3.ДYБЛЯ
 E,VTM,1.
 ,UIA,AN ERD.OHИ-HE COBП.
 L,VLM,CH EQD.
 E,VTM,0.
 AN ERD:,BSS,.
C.........   AHAЛИЗ: OTKYДA-KYДA ПИCATЬ
 T,VTM,X CD.
 EC,UTM,-1.
 EC,VIM,AE 1.
 E,VIM,ПЛOX ПAK.BCE-ПЛOXИE
 TRA DC:T,VTM,X DC.HA ПEPEПИCЬ
 ,UJ,TRANS.ДYБЛЬ-KATAЛOГ
 AE 1:E,VIM,TRANS.KATAЛOГ-ДYБЛЬ
C            ЧTO ПOЗЖE ЗAПИCAHO
 ,XTA,DATD.
 ,A-X,DATC.
 ,UIA,TRANS.KATAЛOГ-ДYБЛЬ
 ,ASN,64-7.
 ,UIA,TRA DC.ДYБЛЬ-KATAЛOГ
C            ДATЫ COBПAЛИ , ПPOBEPИM BEPCИИ
 ,XTA,VERD.
 ,A-X,VERC.
 ,UIA,TRANS.KATAЛOГ-ДYБЛЬ
 ,ASN,64-7.
 ,UIA,TRA DC.ДYБЛЬ-KATAЛOГ
 ,UJ,CTPA ПAK.OЧEHЬ CTPAHHO
 RE AN:,BSS,.
C---------   ЧTEHИE ,AHAЛИЗ, CPABHEHИE(ЗAПИCЬ)
 T,XTA,.
 ,ARX,ADR P.AДPEC XAP-KИ
 ,ATI,A1. HA ЛИCTE
 ,ASN,64+24.
 ,ATI,A2. B БYФEPE
 RJ,UTC,-BASE.
 A2,UTM,.
 ,ASN,64-24.
 ,AUX,MA AT.
 ,ARX,KYC ЧT.***
 R,VJM,EXCH.ЧTEHИE ЛИCTA
 E,VTM,1
 RR,UZA,.HE ЧИTAETCЯ
 ,ATX,NAMEDI
C         ПEPEПИCЬ XAPAKTEPИCTИKИ
 L,VTM,1-4.
 RA 1:L,UTC,3.
 A1,XTA,.
 L,UTC,3.
 A2,ATX,.
 L,ATX,SAV+3.
 L,VLM,RA 1....
C         AHAЛИЗ XAPAKTEPИCTИKИ
 A2,XTA,NZON.
 RR,UZA,.HET TPEKOB
 ,ASN,64+10.
 RR,UIA,.MHOГO TPEKOB
 A2,XTA,NZON.
 ,ARX,CHE Z.
 RR,UZA,.MHOГO TPEKOB
 A2,XTA,BOS.
 ,AAX,CHE ISO.ИMЯ БOCCA
 RR,UIA,.HE B ISO
C         ПEPEBOД ДATЫ C KOHTPOЛEM
 A2,XTA,DAT
   ,AEX,=6H000000
   ,ATX,RDAT
   ,ARX,=6H'6''6''6''6''6''6'
   ,AOX,RDAT
   ,AAX,=6H'360''360''360''360''360''360'
 RR,U1A,.HE BCE ЦИФPЫ
   ,XTA,RDAT
   ,ASN,64-32
   ,ATX,RDAT.YY
   ,YTA,.  DDMM
   ,ASN,64+16
 A2,ATX,DAT.    DD
   ,YTA,.MM
   ,ASN,64+16.  MM
 A2,AEX,DAT  .  MMDD
   ,AEX,RDAT .YYMMDD
   ,APX,=6H'17''17''17''17''17''17'
   ,ASN,64+24
 A2,ATX,DAT.ДATA-ГOTOBA
C         CPABHEHИE (ЗAПИCЬ)
 E,VTM,0.
 T,XTA,.
 ,ASN,64-24.
 ,AUX,MA AT.
 RR,UZA,.HE ЗAKAЗAHO
 E,VTM,2
 ,ARX,KYC ЗП.
 ,ATX,KYC.
 T,XTA,.
 ,ASN,64-1.
 ,AAX,B18.
 ,AOX,KYC.
 R,VJM,EXCH.
 RR,UZA,.ПЛOXO
 E,VTM,0.
 T,XTA,.
 ,AAX,=300000.
 RR,UZA,.HE CPABHEHИE
 L,VTM,1-4.
 RA3:L,UTC,3.
 A1,XTA,.
 L,AEX,SAV+3.
 E,VTM,2
 RR,U1A,.ПЛOXO
 L,VLM,RA3.
 E,VTM,0.
 RR,UJ,. - BOЗBPAT
 TRANS:,BSS,.
C---------   BOCCTAHOBЛ.  2-X ЭKЗ. KATAЛOГA
 L1,VTM,1-2
 T,UTM,-1.
 TR 1:T,UTM,1.
 NM,XTA,DNAM
 ,U1A,RET
 ,XTA,NAMEDI
 NM,ATX,DNAM
 RR,VJM,RE AN.
 ,XTA,
 NM,ATX,DNAM
 E,VIM,HET ЗП.
 L1,VLM,TR 1.
 CATAL:,BSS,.
C
C---------   OБPAБOTKA KATAЛOГA ПAKETA
C            ЗABEДEHИE CПEЦ-ФAЙЛOB И
C            PAБOЧИX OБЛACTEЙ.
 ,WTC,ADR P.HAЧAЛO
 A,VTM,4.KATAЛOГA
 E,VTM,0.HET CПEЦ.ФAЙЛA
 EC,VTM,0.HET PAБ.OБЛACTИ
 L CAT:A,XTA,.ИMЯ ФAЙЛA
 ,UZA,FINISH.KOHEЦ KATAЛOГA
 A,XTA,1.XAP-KA ФAЙЛA
 ,AAX,B SFI.
 L,VTM,-LTF.
 ,UIA,SP FILE.CПEЦ.ФAЙЛ
 NEX FILE:A,XTA,1. - HET
 ,ASN,64+42
 ,ATI,14.ПEPEAДPECAЦИЯ
 14,J+M,A.HA CЛEД.ФAЙЛ
 A,UTM,2.
 ,ITA,A.ПPOБA:
 ,AEX,ADR P.HE BЫXOДИM ЛИ
 ,ASN,64+10.HA CЛEД.ЛИCT
 ,UZA,L CAT. - HET
 A,UTM,-1024.
 R,VTM,L CAT
 ,XTA,B26
 ,ARX,KYC ЧT.2-ГO ЛИCTA
 ,UJ,EXCH.KATAЛOГA
 SP FILE:,BSS,.
  ,XTA,NEVM
  ,ASN,64+46
  ,ATX,T NБ.HOMEP ЭBM
  ,UZA,SEARPLAC.MONO-KMD
C...   ПPOБA - CBOЙ ЛИ ФAЙЛ :
C      HEOБXOДИMO COBПAДEHИE HOMEPA
C      MAШИHЫ C TPEMЯ ПOCЛEДHИMИ БИTAMИ
C      ИMEHИ XOЗЯИHA ФAЙЛA (MASTER)
  A,XTA,
  ,ASN,64+12
  ,UZA,CHOWN.SCRATCH
  MT,VTM,FNAMES
  SNF:MT,XTA,
  ,UZA,SEARPLAC.OБЩAЯ
  A,AEX,
  ,UZA,CHOWN.HE OБЩAЯ
  MT,VLM,SNF
  CHOWN:,XTA,TNБ.N ЭBM
 A,AEX,2.MASTER
  ,AAX,C7
  ,U1A,NEX FILE.ЧYЖOЙ ФAЙЛ
  SEARPLAC:,BSS,
 L,XTA,FATA+LTF.ПOИCK MECTA
 ,UZA,IS FATA. - ECTЬ
  L,VLM,SEARPLAC
 ,UJ,NO PHYS. - HET
 IS FATA:L,UTM,LTF+1.HOMHP ФAЙЛA
 A,XTA,.ПPOБA:
 ,ASN,64+12.SCRATCH/MOДEЛЬ
 ,UZA,SCRATCH. - SCRATCH
C.........   OTOБPAЖEHИE CПEЦ-ФAЙЛA
C            B TAБЛИЦЫ И ШKAЛЫ
 ,XTA,ШMOД.BOЗM.MOДEЛИ
 ,UZA,NO PHYS. - ИX HET
 ,ANX,C77777.HOMEP MЛ
 ,ATI,MT.MOДEЛИ
C... M.Б. ЭTA MOДEЛЬ YЖE ECTЬ
 MT,MTJ,C
 CH/NAME:C,VZM,OПPИXOД
 C,UTM,-1
 C,XTA,TANAME
 A,AEX,
 ,UIA,CH/NAME
 C,MTJ,MT
C,,, OПPИXOДYEM MOДEЛЬ
 C,WTC,NFIL
 L,VTM,
 L,XTA,FATA-1
 ,AAX,BNRD
 ,UZA,NO PHYS
 OПPИXOД:,BSS,
 MT,XTA,B48.
 ,AEX,FULWOR.ИCKЛЮЧEHИE
 ,AAX,ШMOД.ИЗ BOЗM.MOДEЛEЙ
 ,ATX,ШMOД.
 ,ITA,L.HOMEP ФAЙЛA
 MT,ATX,N FIL. B T2MT
   :   ,24,2003B.
 MT,XTA,B48.ФИЗ.ЛEHTA
 ,AOX,ШФЛД.MOД. HA MД
 ,ATX,ШФЛД.
 A,XTA,.ИMЯ ФAЙЛA
 MT,ATX,TANAME.B ИMЯ ЛEHTЫ
C......   ПEЧATЬ O ФAЙЛE HA OПEP. TL
 ,AUX,UPM 1.
 ,ARX,B46*.COБCTBEHHO
 ,ATX,NA FIL.  ИMЯ
 ,XTA,1.
 ,AAX,B24.БЛOKИP.TT-ПEЧ.
 ,UZA,AFT PR. - ДA
 C,VTM,T WR.
 A,XTA,1.PEЖИM
 ,AAX,B WRIT.PAБOTЫ
 :,UIA,*+1.
 C,UTM,1.
 :A,XTA,.
 ,AAX,C17.
 ,ASN,64-32.'HOMEP
 C,AOX,. БOБИHЫ'
 ,ATX,T NБ.
 ,ITA,MT.
 ,ARX,B4.
 ,ASN,64-42.
 ,AUX,UPM 2.HOMEP
 ,AOX,T NБ.MЛ-MOДEЛИ
 ,ATX,T NБ.
 14,VTM,NA FIL.
 ,ITA,14.
 14,CALL,TELOUT.
C......
 AFT PR: ,ITA,MT.YCTAHOBKA
 ,ASN,64+3.ПPИЗHAKOB:
 ,ATI,C.MФ-ГOT,
 ,ITA,MT.ЗAП.-BKЛ.
 ,AAX,C7.
 ,AEX,C7.
 ,ATI,MT.N ЛПM(OБP.KOД)
  MT,XTA,B48
  MT,AOX,B40
 ,AEX,FULWOR.
 ,ATX,WS.
 C,AAX,NEW.
 C,ATX,NEW.
 ,XTA,WS.
 C,AAX,OLD.
 C,ATX,OLD.
 WRI FA:A,XTA,1.
 ,ASN,64+4
 ,AAX,B24/1
 ,ARX,B3.[B,E] B [B,E+1)
 ,ASX,TYPDIN
 ,AOX,NM/FATA. B FATA
 L,ATX,FATA-1.
 A,XTA,1.ПEPEHECEHИE
 ,AAX,B30.БИTA PAЗPEШEHИЯ
 L,AOX,FATA-1.ЗAПИCИ
 ,ARX,CMIN1
 L,ATX,FATA-1.
C         ЗAHЯTИE ПAKETA CИCTEMOЙ.
 NM,XTA,B48
 NM,AOX,B32
 ,AOX,MONOS
 ,ATX,MONOS
C...  ECЛИ ЭTO  7/M  TO
C     YCTAHOBИM CПEЦCTATYC
  A,XTA,
  ,AEX,T7/M
  ,U1A,NO7M
  ,XTA,B29+1.CTATYC 2
  L,AOX,FATA-1
  L,ATX,FATA-1
  NO7M:,BSS,
  A,XTA,
  ,AEX,DISPNAM
  ,U1A,TO NEXT
  ,ITA,L
  ,ASN,64-12
  ,AOX,DISPFIL
  ,ATX,DISPFIL
 TO NEXT:,24,3
 ,UJ,NEX FILE.
 SCRATCH:,BSS,.
C.........   OTOБPAЖEHИE PAБ.OБЛACTИ B TSA
 L1,VTM,1-8.ПOИCK MECTA
 SCR 1:L1,XTA,TSA+7. B TSA
 ,NTR,7
 ,UZA, IS SCRA. - ECTЬ
 L1,VLM,SCR 1.
 ,UJ,NO SCRA. - HET
 IS SCRA:A,XTA,1.XAP-KA ФAЙЛA
 ,ASN,64+12.
 ,AAX,B16/7. AДPEC
 ,ATX,BEG. HAЧAЛA(AH)
 A,XTA,1.
 ,AAX,B16/7.AДPEC KOHЦA
 ,A-X,BEG.
 ,ARX,B7.
 ,ASN,64+9
 ,ASX,TYPDIN
 ,ATX,N EXT.
 ,AEX,C77777.
 L1,ATX,TSA+7.(OБP.KOД)
 ,ITA,L.HOMEP ФAЙЛA
 ,ASN,64-15.   B TSA
 L1,AOX,TSA+7.
 L1,ATX,TSA+7.
 ,XTA,N EXT.KOPPEKTИP.
 ,ARX,N ЭKCT.ЧИCЛA PACПPEД.
 ,AAX,C77777.ЭKCTEHTOB
 ,ATX,N ЭKCT....
C         BEДEHИE CПИCKA SA HA ДИCKE.
 L1,UTM,8.HOMEP B TSA
 ,ITA,L1.C EДИHИЦЫ
 ,AOX,LISTSAC.CПИCOK
 ,ASN,64-4
 ,ATX,LISTSAC
 ,UJ,WRI FA.
 FINISH:,BSS,.
 EC,J+M,E
C.........   ЗABEPШ.PAБOTЫ ПO OTKPЫTИЮ ФAЙЛOB
C
C......   БЛOK ЗAXBATA ЭKCTEHTOB ДЛЯ ЗAДAЧ
C         CБPOШEHHЫX, HE BOCCTAHOBЛEHHЫX
C
 ,XTA,LISTSAC.CПИCOK ЭKCTEHTOB
 ,UZA,FINISH1.HA ДИCKE HE БЫЛO
   ,WTC,ADR P.AДP. БYФ.
 RR,VTM,.ЛИCTA
 ,XTA,NTRFRO.ECTЬ ЛИ R-TPAKT
 ,UZA,SETCF. - HET
  ,XTA,2
  ,AAX,B48+3.ECTЬ,HO
  ,AEX,B48+3.БYДET
  ,UZA,SETCF.OБHYЛEH
C         БЛOKИPOBKA MAT.ЗAДAЧ HA
C         BPEMЯ PAБOTЫ TRAPHY.
 ,XTA,FULWOR
  ,AEX,Ш/FULL
  ,AEX,Ш/CЛYЖ
   :   ,24,2003B
 ,ATX,MRDSCALE.ШK.БЛOK.BЫБOPA
 ,XTA,P/KYC.ЛИCT ДЛЯ TRAPHY
 ,AOX,B18.ЧTEHИE
 ,AOX,NTRFRO.ФИЗ.AД.И 3 AБЗ.
 RR,ATX,KTRSPT
 13,VTM,KTRSPT
 RR,J+M,13.ЧTEHИE ROLLOUT
 14,VJM,TRAPHY.CEKTOPA
C         PAЗБЛOKИPOBKA MAT. ЗAДAЧ.
 ,XTA,FULWOR
 ,ATX,MRDSCALE
   :   ,24,3
C         ПOДГOTOBKA PAБOTЫ C CEKTOPOM.
C         ПOЛYЧEHИE ШK.HEBOCCT. ЗAДAЧ.
 ,XTA,FULWOR
 RR,WTC,NTASK.KOЛ.CБOШ.
 ,ASN,64.
 ,AEX,FULWOR.ШK.CБPOШ.
 RR,AEX,CRT.CRT=ШK.BOCCTA-
 SETCF:RR,ATX,CFWORK.HOBЛEHHЫX ЗAДAЧ
 EC,VTM,.KOЛ.BЗЯTЫX ЭKC.
 LCESA:,BSS,
C         ЦИKЛ ПO SCRATCH OБЛACTЯM ДИCKA.
 ,XTA,LISTSAC
 ,ASN,64+4
 ,ATX,LISTSAC
 ,UZA,FINISH0.BCE OБPAБOTAHЫ
 ,AAX,C17
 ,ATI,L1.HOMEP SCR.OБЛ.
 L1,XTA,TSA-1
 RR,ATX,NSCRCF.-1-ЧИCЛO ЭKC.
 ,ASN,64+15.HOMEP CЛOBA FATA
 ,ATI,14.COOTBETCB.OБЛ.
 14,XTA,FATA-1.CCЫЛKA ФAЙЛA
 RR,ATX,CURRF.ЭTOЙ OБЛACTИ
 ,XTA,
 RR,ATX,CTNE
 OBTAIN:,BSS,
C         ПOЛYЧEHИE TAБЛИЧHOГO HOMEPA
C         ПEPBOГO ЭKCTEHTA OБЛACTИ.
 L1,UTM,-1
 L1,VZM,EOBTAIN.HET ПPEДЫДYЩИX
 L1,XTA,TSA-1
 ,AAX,C77777
 ,AEX,C77777
 RR,ARX,CTNE
 RR,ATX,CTNE
 ,UJ,OBTAIN
  EOBTAIN:,BSS,
C         OPГAHИЗAЦИЯ ЦИKЛA ПO CБPOШEH-
C         HЫM ЗAДAЧAM.
 RR,XTA,CFWORK.ШK.CБPOШ.
 RR,ATX,FWORK.HEBOCCT.ЗAДAЧA
 CTAKEEX:,BSS,
C         ЦИKЛ ПO ЗAДAЧAM.
 RR,XTA,FWORK
  ,U1A,NEXTASK.HE KOHЧИЛИCЬ
  RR,WTC,NSCRCF
  A,VTM,2.CЧ.ЦИKЛA
C
C..  ЗAXBAT ЭKCTEHTOB ДЛЯ MOДEЛEЙ MБ
C
  XOMYT1:,XTA,*KOMOД
  ,AAX,C77777
  ,UZA,LCESA.HACЫTИЛИCЬ
  ,XTA,1
  ,AAX,B48+1
  ,U1A,LCESA.БЛOKИPOBKA
  RR,XTA,CTNE.HOMEP ЭKCT.
  13,VJM,ADAM
  RR,WTC,NSTRING
  ,XTA,*TDIS
  RR,AAX,MASK
  ,U1A,XOMYT2.YЖE BЗЯT ГYPEBИЧEM
C--  CHИMEM 'MAЛOMБ'
   :   ,24,2003B
 ,ATX,SCMAMБ
 ,XTA,FLMAMБ.COXPAHЯEM БИT
 ,AAX,B48.DISPINIT'A
 ,ATX,FLMAMБ
  RR,XTA,CTNE
C--  ПИШEM ГЛOБ.HOMEP ЭKCTEHTA
C--  И ПPИЗHAK  SCRATCH
C--  / ДЛЯ GIVTRACK /.
  ,AOX,B7
  ,WTC,*KOMOД
  ,UTC,DRUMOD-1
  ,ATX,
  15,XTA,B1-32
  RR,WTC,NSTRING
  ,AOX,*TDIS
  RR,WTC,NSTRING
  ,ATX,*TDIS
  ,XTA,*KOMOД
  ,ARX,CMIN1
  ,ATX,*KOMOД
  ,XTA,NFRITR
  ,ARX,B6
  ,ATX,NFRITR
   :    ,24,3
  EC,UTM,-1
 XOMYT2:RR,XTA,CTNE
  ,ARX,B1
   RR,ATX,CTNE
  A,VLM,XOMYT1
  ,UJ,LCESA
  NEXTASK:,BSS,
 ,ANX,.HOMEP B KATA-
 ,ATI,L.ЛOГE CБPOШEHHЫX
 ,YTA,
 L,ASN,64
 RR,ATX,FWORK
 L,UTC,.CЛOBO B KATA-
 RR,XTA,INABEG-1.ЛOГE CБPOШEHHЫX
 ,ASN,64+24
 ,AAX,C7777.AДPEC ПOЛЯ
 ,ATI,A2.ЭTOЙ ЗAДAЧИ HA
 RR,J+M,A2.CEKTOPE CБPOCA
 A2,MTJ,14
 A2,XTA,OLDSTN
   ,A-X,C20
 RR,ATX,DSTN
 ,XTA,
 RR,ATX,OLDCTNE
 LOWSA:,BSS,
C         ИЗYЧEHИE PAБOЧИX OБЛACTEЙ ЗAДAЧ
 14,XTA,COTSAR.KOПИЯ TSA
 ,UZA,CTAKEEX.HA CЛEД.ЗAДAЧY
 14,XTA,NAMEDSA.CPABHEHИE
 ,AEX,NAMEDI.ИMEH ДИCKOB
 ,U1A,DEFF.PAЗHЫE
 14,XTA,REFOLD.CPABHEHИE
 RR,AEX,CURRF.CCЫЛOK ФAЙЛOB
 ,ASN,64-18
 ,UZA,HEREITIS.TA ЖE OБЛACTЬ
 DEFF:,BSS,
C         PAБOЧAЯ OБЛACTЬ HE TA.
 14,XTA,COTSAR.KOPPEKTИPOBKA
 ,AEX,C77777.TEKYЩEГO
 ,AAX,C77777.HOMEPA ЭKCTEHTA
 RR,ARX,OLDCTNE.ПO CTAPOЙ
 RR,ATX,OLDCTNE.TAБЛИЦE
 14,UTM,3
 ,UJ,LOWSA.HA CЛEД.OБO.
 HEREITIS:,BSS,
C         OБЛACTИ COBПAДAЮT -
C         ПOИCK CBOИX ЭKCTEHTOB
 RR,WTC,NSCRCF.KOЛИЧ.ЭKC.
 A,VTM,2.B OБЛ. ДЛЯ VLM
 RR,XTA,CTNE
 RR,ATX,JCTNE.TEKYЩ.N ЭKCT.
 CHECKOWN:,BSS,
C         ЦИKЛ БЛOKИPOBKИ ЭKCTEHTOB ЗAДAЧИ
 RR,XTA,OLDCTNE.CTAPЫЙ N
 13,VJM,ADAM
  RR,WTC,NSTRING.N CTPOKИ
 A2,XTA,COTEX.
 RR,APX,MASK.MACKA CTOЛБЦA
 ,ASN,64-5
 ,YTA,.ДHЗ ЭKCTEHTA
 RR,AEX,DSTN.CTAPЫЙ ДHЗ
 ,U1A,NOTOWN.ЧYЖOЙ
 RR,XTA,JCTNE.HOBЫЙ N
 13,VJM,ADAM
 ,ASN,64+5
 RR,AAX,MASK.11-БИTHAЯ MACKA
C         BCE MAT. ЗAДAЧИ ЗAKPJTЫ, CЛEД.
C         TAБЛИЦY ЭKCTEHTOB MOЖHO
C         MEHЯTЬ ПPИ OTKPЫTЫX ПPEPЫBAHИЯX
 RR,WTC,NSTRING.N CTPOKИ
 ,AOX,*TDIS.HA CYMMATOPE
 RR,WTC,NSTRING.MACKA
 ,ATX,*TDIS.CTOЛБЦA
 EC,UTM,-1.CЧET BЗЯTЫX
 NOTOWN:,BSS,
C         ПEPEXOД K COEДYЮЩEMY ЭKCTEHTY
 RR,XTA,JCTNE.HOBЫЙ
 ,ARX,B1.TEKYЩИЙ
 RR,ATX,JCTNE.HOMEP
 RR,XTA,OLDCTNE.CTAPЫЙ
  ,ARX,B1.  ''
 RR,ATX,OLDCTNE.  ''
 A,VLM,CHECKOWN
 ,UJ,CTAKEEX
 ADAM:,BSS,
C         ПOДПPOГPAMMA
C         ПO HOMEPY ЭKCTEHTA HA CYMMATOPE
C         ПOЛYЧAET HOMEP CTPOKИ И MACKY
C         CTOЛБЦA..I15 = N CTOЛБЦA * 16
 RR,ATX,MASK
 ,A*X,C1/3
 RR,ATX,NSTRING.N CTPOKИ
 ,ASN,64-1
 RR,ARX,NSTRING.(N CTPOKИ)*3
 RR,X-A,MASK.N CTOЛБЦA
 ,ASN,64-4
 ,ATI,15
 ,XTA,B16/1
 15,ASN,64-32
 RR,ATX,MASK.MACKA CTOOБЦA
 13,UJ,
 FINISH0:,BSS,
C         BCE OБЛACTИ ДИCKA OБPAБOTAHЫ.
C         KOPPEKT.ЧИCЛA CBOБOДHЫX ЭKCTE.
 ,ITA,EC
 ,ARX,NЭKCT
 ,AAX,C77777
 ,ATX,NЭKCT
 FINISH1:,BSS,
C*********   HEOБXOДИM OTKAЗ OT PEЗEPBHOГO ЛИCTA
C         COOБЩEHИE B CTATИCTИKY O ПAKETE
 ,ITA,NM
 ,ARX,C30
 ,ATX,STB.N MOДYЛЯ
 RR,CALL,OPENWAIT.OTKP. ЖД. ЗAДAЧ
 ,XTA,NAMEDI.HOBOE ИMЯ
 ,ATX,STB+1.ИMЯ ПAKETA
 ,ITA,RJ
 ,ASN,64-24
 ,ARX,NORCOD.AДPEC COOБЩEHИЯ
 ,ATX,STB+2
 ,ITA,RJ
 ,ARX,STB+2.AДPEC BOЗBPATA
   :   ,24,2003B
 ,UJ,STATIST
 NORCOD:2,Z03,STB-BASE.
 ,Z00,AST2-BASE.
  AST2:,24,3
  L,VTM,
 FIN 1:E,VZM,E DEC.HE БЫЛO OШИБOK
C         YCTAHOBKA ЗAДEPЖKИ HA MOДYЛЬ
 ,ITA,NM
 ,AEX,C77777
 ,ATI,T
 ,XTA,C7
 T,ASN,64+1
 T,ASN,64+1
   :   ,24,2003B
 T,ASN,64+1
 ,AOX,WACNTS
 ,ATX,WACNTS
 ,UJ,RET. - BЫXOД
 GIV PAG:,BSS,.
C.........   ЗAПPOC ЛИCTA Y ПOДKAЧKИ(HA BPEMЯ)
   :   ,24,2003B.
 ,ITA,RJ.
 ,ARX,PCI.
 ,UJ,NRESCALL.ЗAXBAT ЛИCTA
 PCI:,Z00,.
 ,Z00,CONT-BASE.
 CONT:,BSS,.
 ,ATX,ADR P.AДPEC ЛИCTA
 ,ASN,64-2.N ЛИCTA
 ,ATX,P/KYC.ДЛЯ TRAPHY
 ,ASN,64+12.
 ,ATX,N PAG.
   :   ,24,3.
 R,UJ,.
 E DEC:,BSS,
C         ПEPEBOД OM-HMД B CTATYC ГOTOBЫX
   :   ,24,2003B
 NM,XTA,DNAM
 ,U1A,RET.HMД ЗAHЯT
 ,XTA,NAMEDI.ЗAHECEHИE ИMEHИ
 NM,ATX,DNAM.B TAБЛИЦY
 NM,XTA,B48
 ,AOX,SCMDR
 ,ATX,SCMDR
C
C****  KOHEЦ OПOЗHABAHИЯ ДИCKOB
C      HAЧAЛO OПOЗHABAHИЯ ЛEHT
C
 RET:,BSS,.
 ,XTA,.
 ,WTC,NPAG.
 ,ATX,TPHYS.
 ,ATX,P/KYC.
  CHTAPES:,BSS,
  1,VTM,7.HAПPABЛEHИE
  L,VTM,-3.CЧ-K ЦИKЛA
C---
  CHC1:,24,2003B
  1,UTM,-1.CЛEД.HAПP.
 ,XTA,*ПДИCK
 1,AAX,B43-6
 ,UZA,ECHC.-> ЛEHT HET
  1,XTA,NEW-3
  1,AEX,OLD-3
 ,AAX,B24/9
  :,24,3
  ,UZA,ECHC
  ,ATX,BEG.ИЗMEHEHИЯ
  2,VTM,8.MФ(OБP.KOД)
  1,WTC,BC1700
  3,VTM,-1.ПOЛHЫЙ HOMEP MФ
C---
  CHT1:,BSS,
  2,UTM,-1.CЛEДYЮЩИЙ
  3,UTM,1.MФ
  4,VTM,-16.ЗП, ПOTOM ГT
C---
  CHRW:,BSS,
  4,UTM,8
  15,VTM,XAP0.CTEK
 ,XTA,BLK*MT
 3,AAX,B48-30B
 ,U1A,ECHT
  ,ITA,3.N MФ И ИMЯ
  3,XTS,TANAME-10B.ДЛЯ CTAT-KИ
  ,XTS,BEG
  4,UTC,
  2,AAX,B16
  ,UZA,ECHT.HE ИЗM.
  15,ATX,
  :,24,2003B
 1,AEX,OLD-3.OCOBPEMEHИM
  1,STX,OLD-3. OLD
  1,AAX,OLD-3
  5,VTM,ECHT
  4,VZM,ST/RD
C---   ИЗMEHИЛOCЬ COCTOЯHИE ЗAПИCИ
  ,U1A,OPENWAIT.ПPOПAЛA
  2,XTA,B16.ПOЯBИЛACЬ
  1,AAX,ШHГ-3
  ,UZA,OPENWAIT.EE HE ЖДYT
  1,AEX,ШHГ-3
  1,ATX,ШHГ-3
  5,MTJ,8
  5,CALL,TOЛЧOK
  8,MTJ,5
  ,UJ,OPENWAIT
C---   ИЗMEHИЛOCЬ COCTOЯHИE ГOTOBHOCTИ
  ST/RD:,UZA,T/RECOGN.ПOЯBИЛACЬ
  9,VTM,1.ПPOПAЛA
  3,XTA,TABLEMT-10B.HE ЗAHЯTA ЛИ
  ,ASN,64+42.ЛEHTA
  :,U1A,TOSTAT
  3,ATX,TANAME-10B.ГACИM ИMЯ
C---   ЗAПИCЬ COБЫTИЯ B CTATИCTИKY
  TOSTAT:,ITA,RJ
  ,ASN,64-24
  ,ITS,RJ
  15,AOX,
  9,ARX,STA/COD
  :,24,2003B
  ,UJ,STATIST
  STA/COD:2,Z02,XAP0-BASE.ПOЯBИЛACЬ MЛ
  ,Z00,ECHT-BASE
  :1,Z02,XAP0-BASE.ПPOПAЛA MЛ
  ,Z01,ECHT-BASE
C---   ПOЯBИЛACЬ ГOTOBHOCTЬ
  T/RECOGN:1,XTA,ШHГ-3
  2,AAX,B8
  ,ATI,8.ЖДYT ЛИ EE
  1,AEX,ШHГ-3
  1,ATX,ШHГ-3
  9,VTM,287.БEЗ CTAT-KИ
  ,XTA,MISTERX
  3,AAX,B48-30B.HE ИMEHOBAHA
  3,AOX,SJMT-30B.B PAБOTE
  1,AOX,ПEPEXBAT-3.MOHOПOЛИЯ
  ,U1A,PUSH.- HE OПOЗHABATЬ
C---   ФOPMИPOBKA KYC-A
  ,ITA,3
  ,ASN,64-42
  ,AUX,=0070 0000 0000 1600
  ,AOX,=0000 0010 0440 0020
  ,ATX,RDAT
C---   ЗA ЧTEHИEM ИMEHИ
  RENAM:13,VTM,SAVAC
  ,XTA,RDAT
  13,ATX,.ЧTOБ HE 0
  14,CALL,TRAPHY
  :,24,2003B
  ,U1A,OKNAMT.- ECTЬ
  1,XTA,NEW-3.HE BЫPYБИЛCЯ
  2,AAX,B16. ЛИ MAГHИTOФOH
  ,UZA,CHMX.- HET
  5,VTM,
  ,ITA,3
  14,CALL,MФ ПЛOX
  8,VTM,.БEЗ TOЛЧKA
  ,UJ,PUSH
  CHMX:,XTA,MISTERX
  3,AAX,B48-30B
  ,UZA,RENAM.ПOBTOPИM
  ,UJ,PUSH
C---   ИMЯ ПPOЧЛOCЬ HOPMAЛЬHO
  OKNAMT:,ATX,XAP0+1.HOBOE ИMЯ
  9,VTM,."CO CTAT-KOЙ"
  3,AEX,TANAME-10B.CTAPOE ИMЯ
  ,UZA,SAMNAM
  3,XTA,TABLEMT-10B
  ,ASN,64+42
  ,UZA,SAMNAM
C---   HA ЗAHЯTOM MФ CMEHИЛИ БOБИHY
  3,XTA,TANAME-10B
  ,ATX,XAP0+1
  9,VTM,287.БEЗ CTAT-KИ
  8,VTM,.БEЗ TOЛЧKA
  15,MTJ,14
  ,ITA,3
  ,ASN,64-42
  ,AUX,MNMД
  ,AOX,=6HMФ-00
  ,XTS,=6HЗAHЯT
  ,XTS,ДИAГH+2
  ,ITS,14
  14,CALL,TELOUT
C---
  SAMNAM:,XTA,XAP0+1.HOBOE ИMЯ
  3,ATX,TANAME-10B.B TAБЛИЦY
C
C---   TOЛЧOK ЖДYЩИX ЗAKAЗOB,
C      YCTAHOBKA ПPИЗH. 1 OБPAЩEHИЯ,
C      ЗAПИCЬ B CTAT-KY
C
  PUSH:,24,2003B
  8,VZM,PUTF
  5,CALL,TOЛЧOK
  15,VTM,XAP0.ПOPTИЛCЯ !
  PUTF:3,XTA,SJMT-30B
  ,U1A,ECHT
  ,XTA,B1
  3,AOX,TABLEMT-10B
  3,ATX,TABLEMT-10B
  9,V1M,ECHT
  5,VTM,TOSTAT
  ,UJ,OPENWAIT
C
C---   KOHEЦ ЦИKЛA
C
 ECHT:,BSS,
  4,VIM,CHRW.ПO COCT.
  2,VIM,CHT1.ПO MФ.
  ECHC:,BSS,
  L,VLM,CHC1.ПO HAПP.
C
C---   KOHEЦ OПOЗHABAHИЯ ЛEHT
C
 ,XTA,REF NRS.
 ,UJ,NRES OFF.
 REF NRS:,Z00,NR/MD.
 ,Z00,MD/RET
 EXCH:,BSS,
C   ...   П/П ЗAПYCKA OБMEHA C MД.
   :   ,24,2003B
 ,AOX,NM/KYC.N MOДYЛЯ
 ,AOX,P/KYC.N CTPAHИЦЫ
 13,VTM,KYC
 13,ATX,
 14,VJM,TRAPHY
   :   ,24,3
 R,UJ,
 ПЛOX ПAK:T,VTM,T KATAЛ.
 ,UJ,ERR 1.
 CTPA ПAK:T,VTM,T OШCИC.
 ,UJ,ERR 1.
 NO PHYS:T,VTM,T MODEL.
 E,VIM,NEX FILE.
 E,VTM,1.
 ,UJ,ERR 2
 NO SCRA:T,VTM,T SCRAT.
 EC,VIM,NEX FILE.
 EC,VTM,1.
 ,UJ,ERR 2
 HET ЗП:T,VTM,T ЗAП
 ERR 1:,BSS,.
 R,VJM,ERROR.
 E,VTM,1.
 ,UJ,FIN 1.
 ERR 2:R,VTM,NEX FILE.
 ERROR:,BSS,.
 ,ITA,NM.
 ,ARX,C30.
 ,ASN,64-42.
 ,AUX,M NMД.
 ,AOX,T NMД.
 ,ATX,ДИAГH.
 T,XTA,.
 ,ATX,ДИAГH+1.
 T,VTM,ДИAГH.
 ,ITA,T.
 14,CALL,TEL OUT.
   :   ,24,3.
 R,UJ,.
C--------
  T7/M:,TEXT,8HM      '7'
 TKATAЛ:,ISO,6HKATAЛ.
 TOШCИC:,ISO,6HOШCИC.
 TЗAП  :,ISO,6HЗAПИCЬ
 TMODEL:,ISO,6HMODEL
 TSCRAT:,ISO,6HSCRAT..
 T WR:,ISO,6H/0 W00
 ,ISO,6H/0 R00
 UPM 1:,ISO,6H'77''77''77''77''77''77'
 UPM 2:,GOST,6H000077
 B46*:,ISO,6H
 M NMД:,GOST,6H000770
 T NMД:,ISO,6HMД-00:
 ДИAГH:,BSS,2.
 ,ISO,6H !!!''''
 KYC ЗП:,LOG,10 0100 0020
 KYC ЧT:,LOG,10 0140 0020
 X C0:,Z00,XAP0.
 1,Z03,0.
 X C1:,Z20,XAP1.
 1,Z23,1020.
 X D0:1,Z00,XAP1.
 ,Z00,.
 X D1:1,Z20,XAP2.
 ,Z00,1020.
 X CD:,Z20,XAP1.
 1,Z24,1020.
 :,Z00,XAP0.
 1,Z04,0.
 X DC:1,Z20,XAP1.
 ,Z24,1020.
 :1,Z00,XAP0.
 ,Z04,0.
 MA AT:,LOG,77 0000 0004
 CMIN1:,LOG,7777 7777 7777 7776
 B16/7:,LOG,17 7700.
 CHE Z:,LOG,3777 7777 7777 6015.
 CHE ISO:,ISO,6H'200''200''200''200''200''200'
 C30:,LOG,30.
 C1/3:,LOG,4005 2525 2525 2526
 LISTSAC:,LOG,
C
C...   ИMEHA HECOBMECTИMЫX MOДEЛEЙ :
C
  FNAMES:,BSS,
  ,TEXT,8HD73STA '6'
  ,TEXT,8HUSESTA '20'
  ,TEXT,8HROLLIB '1'
 ,TEXT,8HLINBUF '21'
  ,LOG,.ПPИЗH.KOHЦA CПИCKA
 XAP0:,BSS,2.
 DATC:,BSS,1.
 VERC:,BSS,1.
 XAP1:,BSS,2.
 DATD:,BSS,1.
 VERD:,BSS,1.
 XAP2:,BSS,4.
 TYPDIN:,BSS,1
 NM/FATA:,BSS,1.
 ADR P:,BSS,1.
 N PAG:,BSS,1.
 WS:,BSS,.
 BEG:,BSS,1.
 RDAT:,BSS,.
 N EXT:,BSS,1.
 NA FIL:,BSS,1.
 T NБ:,BSS,2.
 STB:,BSS,.
 SAV:,BSS,4.
 NAMEDI:,BSS,1
 WKFI:,BSS,3
 ,END,.
 STATIST:,NAME,.
C
C*********   БYФEPИЗAЦИЯ ИHЖEHEPHOЙ CTATИCTИKИ
C
 *STATBUF:LC,BLOCK,MBLO,MOUT,STNAME,NZON
 ,CONT,LBUF,PDB,DCALL
 ,CONT,DEV(9)
 ,CONT,DINBUF
 ND:,EQU,9.
 ND1:,EQU,ND-1.
 BLSTOUT:LC,BLOCK,TSEC,SAVNZ,BLSTAOUT
 ABTIME:,LC,1.
 *YCЫ:LC,BLOCK,(31),.
 *ИПД:LC,BLOCK,(4),XNW
 NW:,WEQ,XNW
 YCЖДY:,EQU,*YCЫ+NW
 TODAY:,LC,1
 TPHYS:,LC,1.
  SMASAV:LC,BLOCK,SAVAC
  TABLEMT:LC,BLOCK,(96),MTNAMES
 NRESCALL:,SUBP,.
 TELOUT:,SUBP,.
 *700:B,BLOCK,(6),B42(2),B40(12),B28(2),B26(4),B22
 ,CONT,B21(3),B18(9),B9(8),B1
  FULWOR:,LC,1
 B24/1:,LC,1.
 C7777:,LC,1.
 C1777:,LC,1
 C3:,LC,1
 BEGSB:,EQU,8.
 BEGDB:,EQU,40.
  BEGNZON:,EQU,B28
 *4:,BLOCK,RR(4),P,L,RW,E,R,J,M,S
C
C*********   БYФEPИЗAЦИЯ ДИHAM.ИHФOPMAЦИИ
C
 ''''''''''''''''''''''''''''''''''''''
 'CYMMATOP BXOДA-ГOЛOBA COOБЩEHИЯ
 'PAЗPЯДЫ
 ' 48-45 ДЛИHA ДOП. ИHФOPMAЦИИ
 ' 44-40 TИП 1
 ' 39-25 AДPEC ДOП. ИHФOPMAЦИИ,
 '       ECЛИ OHA ECTЬ
 ' 22    1-ПPИЗHAK OБHYЛEHИЯ
 ' 21    1-HYЖEH CБPOC
 ' 20-16 TИП 2
 ' 15-1  AДPEC BOЗBPATA
 '-------------------------------------
 'ЗAПИCЫBAET B DINBUF
 '(ПPИ HAЛИЧИИ MECTA)
 ' 1. CYMMATOP BXOДA
 ' 2. AБCOЛЮTHOE BPEMЯ ИЗ ABTIME
 ' 3. ДOПOЛHHTEЛЬHYЮ ИHФOPMAЦИЮ
 '    (ECЛИ OHA ECTЬ)
 ''''''''''''''''''''''''''''''''''''''
  :,24,2003B.OT ГPEXA
 ,ATX,COD.
 ,XTA,MBLO.CTATИCTИKA
 ,UZA,RET1. - БЛOKИPOBAHA
 ,ITA,S
 S,VTM,I15
 ,ITS,M  .CПACEHИE
 ,ITS,J .PEГИCTPOB
 ,XTS,COD
 ,ASN,64+24.
 ,ATI,J .AДPEC ДOП.ИHФ.
 ,ASN,64+20.
 ,ATI,M .ДЛИHA ДOП.ИHФ.
 ,ARX,PDB.ПPOБA:
 ,AEX,C7777 .ECTЬ ЛИ MECTO
 ,ARX,LBUF.
 ,ASN,64+12
 ,UIA,PLACE.
 ,XTA,CNTR.CЧETЧИK
 ,ARX,B1.HEПPИHЯTЫX
 ,ATX,CNTR.COOБЩEHИЙ
 ,ATX,TSEC.
 ,UJ,RET.
 PLACE:,WTC,PDB.
  S,VTM,DINBUF.AДPEC ДИH.БYФ.
 ,XTA,COD.
 ,XTS,ABTIME
 TRAN:,BSS,
 M,VZM,RET0
 J,XTS,
 M,UTM,-1
 J,VLM,TRAN
 RET0:,BSS,
 S,ATX,
 S,UTM,-DINBUF
 ,ITA,S
 ,ATX,PDB.
 ,XTA,COD.
 ,AAX,B21.
 ,AOX,PDB
 ,ASN,64+5
 ,ATX,MOUT.
 ,XTA,COD.ПPИЗHAK
 ,AAX,B22.OБHYЛEHИЯ
 ,AOX,MCLE.
 ,ATX,MCLE.CTATИCTИKИ
 S,VTM,I15+3
 RET:,BSS,
 S,XTA,
 ,STI,J
 ,STI,M
 ,ATI,S
 RET1:,WTC,COD.
 ,UJ,.
C
C*********   CБPOC HAKOПЛEHHOЙ ИHФOPMAЦИИ
C
 ''''''''''''''''''''''''''''''''''''''
 'OБPAЩEHИE ИЗ MDRECOGN
 'ECЛИ MBLO.NE.0
 'И (MOUT.OR.TSEC).NE.0
 'HEЛЬЗЯ ПOPTИTЬ ИP 1,2,6
 'BOЗBPAT ПO ИP 4
 '-------------------------------------
 'CTPYKTYPA ЗOHЫ CTATИCTИKИ
 'CЛOBA
 ' 0       KOД 'CTAИHЖ'
 ' 1       KOЛИЧECTBO CЛOB B ЗOHE
 '         ЗAHЯTЫX ДИHAMИЧECKOЙ
 '         ИHФOPMAЦИEЙ, ИЛИ 983, ECЛИ
 '         ЗOHA ПOЛHA ( B ЭTOM CЛYЧAE
 '         ПPИЗHAK KOHЦA ИHФOPMAЦИИ-
 '         CЛOBO COДEPЖAЩEE BCE '1')
 ' 2       AБCOЛЮTHOE BPEMЯ ПOCЛEДHEГO
 '         CБPOCA
 ' 3       BPEMЯ ЖДYЩEГO TECTA
 ' 4       ДATA ИЗ TODAY
 ' 5       PEЗEPB
 ' 6       MAKC. ЧИCЛO CЛOB B DINBUF
 ' 7       ЧИCЛO HEПPИHЯTЫX COOБЩEHИЙ
 ' 8-34    CTATИЧECKAЯ ИHФOPMAЦИЯ
 '         ИЗ DEV, ПPИЧEM KAЖДOE CЛOBO
 '         DEV PACПAKOBЫBAETCЯ B 3
 '         ПOCЛEДOBATEЛЬHЫE ЯЧEЙKИ
 '         0  24-1  PAЗPЯДЫ ИЗ DEV
 '         1  48-37 PAЗPЯДЫ ИЗ DEV
 '         2  36-25 PAЗPЯДЫ ИЗ DEV
 ' 35-39   PEЗEPB
 ' 40-1022 ДИHAMИЧECKAЯ ИHФOPMAЦИЯ
 '         ИЗ DINBUF
 ' 1023    KOД 'CTAИHЖ'
 ''''''''''''''''''''''''''''''''''''''
C
  NZMAX:,OCT,0000 001
C   (YCTAHABЛИBAETCЯ B STARTDD)
C
 STATOUT:,ENTRY,.
 ,XTA,BLSTAOUT.CБPOC БЛOKИPOBAH
 RR,U1A,
  :,24,2003B
 ,ATX,NP
 L ,VTM,1-ND.
 ,XTA,PDB.
 SU:L ,AOX,DEV+ND1.
 L ,VLM,SU.
 ,UZA,Z MOUT.
C.........   ПOИCK MЛ ПO ИMEHИ
   M,VTM,THETMЛ
  :,24,3
  P,VTM,-47
  STAPE:P,XTA,MTNAMES+47
  ,AEX,STNAME
  ,UZA,ISTAPE
  P,VLM,STAPE
  ,XTA,MPRI
  ,U1A,ZMOUT
  ,XTA,B9
  ,UJ,TTPR
  ISTAPE:,ATX,PDBD
  P,UTM,47+10B
  ,ITA,P
  ,ASN,64+6
  ,YTA,
  ,AUX,UPM2
  ,ATX,KYC
  ,ARX,B40
  ,AAX,B42
  ,AEX,B42
  ,ASN,64+3
  ,AOX,KYC
  ,ATX,KYC
 M,VTM,SAVP
 ,ITA,M
  ,UJ,NRESCALL
  SAVP:,24,3
 ,ATI,P.
 ,ASN,64-2.
 ,AOX,KYC.N ЛИCTA
 ,ATX,KYC. B KYC
 ,ASN,64+12.
 ,ATX,NP.
  ,NTR,3
 RW,VTM,B18
 ,XTA,MCLE.ЗAHYЛЯTЬ CTAT.
 ,U1A,CLEAR
 E,VJM,EXCH
 P,XTA,.
 ,AEX,STACOD.CTATИCTИKA
 ,UIA,NEW STAT.HE ЗABEДEHA
 P,XTA,1023.
 ,AEX,STACOD.
 ,U1A,NEWSTAT
C       CПACEHИE BPEMEH ИЗ TEK. ЗOHЫ
 P,XTA,2
 ,ATX,Д LAS
 P,XTA,3
 ,ATX,Ж LAS
 P,XTA,1
 ,AEX,MAX C.
 R,VTM,EXCH.ЗOHA
 ,UZA,CHA NZON. - ЗAПOЛHEHA
 OLDSTAT:,BSS,
 ,XTA,DCALL
 ,ARX,FULWOR
 ,AEX,DCALL
 ,AAX,C3
  :,24,2003B
 ,ARX,PDB
 ,A-X,PDBD
 P,ARX,1
  ,A-X,MAX C
 ,U1A,TRANSDB
C......   ЗOHA ЗAПOЛHEHA
 ,XTA,FULWOR
 P,WTC,1
 P,ATX,BEGDB
 ,XTA,MAX C
 P,ATX,1
 E,VTM,CHANZON
 R,VTM,NEWSTAT
 ,UJ,WRITE
  CHECLE:,24,3
 ,XTA,MCLE.ЗAHYЛЯTЬ CTAT.
 ,UZA,OLD STAT. - HET
 L,VTM,.ЗAПИCЬ BCEГO
 CLEAR:,BSS,
 ,XTA,.ГAШEHИE
 ,ATX,MCLE.ПPИЗHAKA 'ЗAHYЛИ'
 ,XTA,BEGNZON.YCTAH.
 ,ATX,NZON.HAЧ.ЗOHЫ
 NEW STAT:,XTA,.
  M,VTM,1-1022.ПPИBEДEHИE
 ZP: M,UTC,1022.ЛИCTA CTATИC.
 P,ATX,.B ИCXOДHOE
  M,VLM,ZP.COCTOЯHИE
 ,XTA,STACOD.
 P,ATX,.
 P,ATX,1023....
 TRANSDB:,BSS,
 ,XTA,PDB
 ,ATX,PDBD
  :,24,3
 P,MTJ,S
 P,WTC,1
 S,UTM,BEGDB
      :,XTA,DCALL.ПEPBOE OБPAЩ.
 ,U1A,TRA1
C......   ЗAHECEHИE 'KOHEЦ ДИCП'.
 ,XTA,KOH
 ,XTS,Д LAS
 ,XTS,Ж LAS
 S,ATX,
 TRA1:,BSS,
 ,ITA,L.
 ,A-X,PDBD
 ,UZA,ENB
 ,ATI,M
 M,UTM,1
 L,XTA,DINBUF
 TRA2:,BSS,
 L,UTM,1.
 L,XTS,DINBUF
 M,VLM,TRA2
 ENB:,BSS,
 S,UTM,-BEGDB
 ,ITA,S
 ,ATX,DCALL
 ,AAX,C1777
 P,ATX,1.
 E,VJM,WRITE
  :,24,2003B
 ,ITA,L.ПOCTYПИЛA EЩE
 ,AEX,PDB.ИHФOPMAЦИЯ
 ,U1A,CHECLE
 ,ATX,PDB.
 ,ATX,TSEC.
 Z MOUT:,XTA,.
 ,ATX,MOUT.
 ,WTC,NP
 ,ATX,TPHYS
  :,24,3
 RR,UJ,.
C---------
 WRITE:,BSS,
 P,MTJ,M
 RW,VTM,1-ND
 PLUS DEV:,24,2003B.
 RW,XTA,DEV+ND1
 ,AAX,B24/1.
 M,ARX,BEGSB
 M,ATX,BEGSB
 RW,XTA,DEV+ND1
 ,ASN,64+24.
 ,AAX,C7777.
 M,ARX,BEGSB+2
 M,ATX,BEGSB+2
 RW,XTA,DEV+ND1
 ,ASN,64+36.
 M,ARX,BEGSB+1
 M,ATX,BEGSB+1
 ,XTA,.
 RW,ATX,DEV+ND1
  :,24,3
 M,UTM,3
 RW,VLM,PLUSDEV
 ,XTA,ABTIME.BPEMЯ ЗAПИCИ
 P,ATX,2.
 ,WTC,YCЖДY.
 ,XTA,-1.BPEMЯ 'ЖДY'
 P,ATX,3.
 ,XTA,TODAY
 P,ATX,4.ДATA ЗAПИCИ
 ,XTA,CNTR.CЧETЧИK
 P,ATX,7.
 ,XTA,MAX PDB.
 P,ATX,6.
 ,A-X,PDB
 ,UZA,EXCH
 ,XTA,PDB.
 ,ATX,MAXPDB.
C.........   ПPOЦEДYPA : ЧTEHИE/ЗAПИCЬ
 EXCH:,XTA,KYC.
 RW,AOX,
     :,AOX,NZON.HOMEP ЗOHЫ
 J,VTM,KYC1
  :,24,2003B.***   OБMEH
 J,ATX,
  ,ATX,SAVAC.HEHYЛEBOЙ
   M,CALL,TRAPHY
  :,24,3
 E,U1A,
         M,VTM,T OБMEH.
 ,XTA,NZON.
 ФИH:,ATX,SAVNZ.
 M,XTA,
 M,VTM,TKOH
 M,ATX,3
 ,XTA,NZON.
 ,A-X,B28
 ,AUX,UPM3.
 ,AOX,CNZ.
 M,ATX,4
  ,XTA,
  :,24,2003B
  ,ATX,MBLO
  TTPR:,BSS,
  ,ATX,MPRI
 ,ITA,M
 M,VTM,ZMOUT
  ,UJ,TELOUT
 CHA NZON:,XTA,NZON.
 ,ARX,B26.
 ,AEX,NZMAX.
        M,VTM,T ПOЛHA.
 ,UZA,ФИH
 ,AEX,NZMAX.
 ,ATX,NZON.
 R,UJ,.
 STACOD:,ISO,6HCTAИHЖ
 MAX C:,,.
 ,,983.
 UPM2:,LOG,70 0000 0000 1600.
 T HETMЛ:,ISO,18HMЛ CTATИCTИKИ'41'''
 T KOH:,ISO,30HCTATИCTИKA ЗAKPЫTA(OБMEH-0000)
 ,LOG,.
 T OБMEH:,ISO,6H(OБMEH
 T ПOЛHA:,ISO,6H(ПOЛHA
 UPM3:,GOST,6H'377''77'7770
 CNZ:,ISO,6H-0000)
 KOH:1,Z00,.
 ,Z01,.
 Д LAS:,BSS,1.
 Ж LAS:,BSS,1.
 CNTR:,LOG,.
 MCLE:,BSS,1.
 MAXPDB:,BSS,1.
 MPRI:,BSS,1.
 NP:,BSS,1.
 KYC:,BSS,1.
 KYC1:,BSS,1
 PDBD:,BSS,1
 COD:,BSS,1.
 I15:,BSS,3
 ,END,.
  STAT TT:,NAME,
C
C   ПOДПPOГPAMMA CБOPA ИHФOPMAЦИИ O PAБOTE
C   ПOЛЬЗOBATEЛEЙ B TEPMИHAЛЬHЫX ПOДCИCTEMAX
C
C   YЧET PAБOTЫ ПOЛЬЗOBATEЛEЙ OCYЩECTBЛЯETCЯ
C   ПPИ HAЖATOM 30-M PAЗPЯДE HA 2-M TYMБЛ.P.
C   HOMEP PAЗPЯДA OПPEДEЛЯETCЯ БИTOM B 530-Й
C   ЯЧEЙKE (MAINSW).
C
C   ИHФOPMAЦИЯ HAKAПЛИBAETCЯ HA MOДEЛИ
C   9/MONSYS B ЗOHE, HOMEP KOTOPOЙ ЗAДAH
C   B П/П *USESTA (CM.KOMMEHTAPИЙ K HEЙ).
C
C   CTPYKTYPA ЗOHЫ CTATИCTИKИ:
C   0-E CЛOBO COДEPЖИT CПEЦKOД,
C   1 - 1019 - BPEMЯ PAБOTЫ (B CEKYHДAX) B
C     TEPMИHAЛЬHЫX ПOДCИCTEMAX ПOЛЬЗOBATEЛEЙ
C     COOTBETCTBEHHO TAБЛИЦE PASS;
C   1020 -  ДATA HAЧAЛA CБOPA CTATИCTИKИ,
C   1021 - BPEMЯ HAЧAЛA CБOPA CTATИCTИKИ;
C   1022 -  ДATA ПOCЛEДHEЙ KOPPEKTИPOBKИ,
C   1023 - BPEMЯ ПOCЛEДHEЙ KOPPEKTИPOBKИ.
C
C   ЗOHA OФOPMЛЯETCЯ ABTOMATИЧECKИ ПPИ ПOPЧE
C   CПEЦKOДA.
C
C   ИHФOPMAЦИЯ KOPPEKTИPYETCЯ:
C   - ПPИ BXOДE KOГO-ЛИБO B MYЛЬTИTAЙП;
C   - ПPИ OTBЯЗKE KAHAЛA OT MYЛЬTИTAЙПA;
C   - ПPИ ЗAXBATE KAHAЛA ЭKCTP. NRESLINE;
C   - ПPИ OTBЯЗKE KAHAЛA OT NRESLINE;
C   - 1 PAЗ B MИHYTY, ECЛИ ECTЬ ПPИBЯЗAHHЫE
C     KAHAЛЫ.
C
C   B KAЧECTBE METKИ OДHOГO ИЗ YKAЗAHHЫX CO-
C   БЫTИЙ ИCПOЛЬЗYETCЯ ЯЧEЙKA 531 (MAINSW).
C   ПPИ ПPИBЯЗKE/OTBЯЗKE ПOЛЬЗOBATEЛЯ OHA
C   OБHYЛЯETCЯ, A ПOCЛE KOPPEKTИPOBKИ B HEE
C   ЗAHOCИTCЯ ЛИБO HOBAЯ METKA BPEMEHИ (AБ-
C   COЛЮTHOE BPEMЯ PAБOTЫ CИCTEMЫ), ЛИБO
C   "БECKOHEЧHOE" BPEMЯ, ECЛИ ПPИBЯЗAHHЫX
C   KAHAЛOB HET ИЛИ CБOP CTATИCTИKИ ЗAKPЫT.
C
C
  NR/STAT:,SUBP,
  NRESCALL:,SUBP,
  NRESOFF:,SUBP,
  MD/RET:,SUBP,
C
  TPHYS:,LC,
  *TLSIZE:LC,BLOCK,(1),XPCH
  NPCH1:,WEQ,XPCH
  NPCH:,EQU,NPCH1-1.ЧИCЛO TEPMИHAЛOB
  *TLBUFI:LC,BLOCK,CIN
  OWNER:,EQU,3
C
  *TLWORK:,LC,NPCH1
  COWNER:,EQU,*TLWORK.BЛAДEЛЬЦЫ
  OLDTIME:,EQU,COWNER.BPEMЯ CБPOCA
  NEWTIME:,EQU,531B.KOHTP.TOЧKA
  STAT IS:,EQU,530B.БИT CTAT. HA TP2
  *USESTA:LC,BLOCK,(3),STPOINT. ЗOHA CБPOCA
C
  ABTIME:,LC,
  ASTIME:,EQU,542B
  TODAY:,LC,
C
  *677:B,BLOCK,BITS
  ,CONT,(30)
  ,CONT,B18
  C1777:,LC,1
  *6:,BLOCK,B(4),NP,P,E(0),L,J,R,S
C
  SMASAV:LC,BLOCK,SAVAC
C
C
  B,REL,*
C
  ,XTA,ABTIME
  ,ATX,TIME
C---  HYЖHO ЛИ ДOБABЛEHИE BPEMEH
  ,XTA,OLDTIME
  ,UZA,NEWDELTA.HET HИKOГO
  :,24,3
  ,A+X,PAUSE
  ,A-X,TIME
  ,UZA,OLDDELTA.MAЛA ПAYЗA
C---  ФOPMИPOBAHИE KYC'A ЧTEHИЯ ЗOHЫ CTAT.
  ,XTA,STPOINT
  ,ASN,64-25
  ,ARX,EXPOINT
  ,ATX,KYC
C---  ЗAKAЗ ЛИCTA ДЛЯ OБMEHA
  R,VTM,OLDCHAN
  ,ITA,R
  ,UJ,NRESCALL
  OLDDELTA:,XTA,OLDTIME
  ,ATX,TIME
  ,XTA,
  ,UJ,NEWDELTA
  OLDCHAN:,24,3
  ,ATI,P.AДPEC ЛИCTA
  ,ASN,64+10
  ,ATI,NP.HOMEP ЛИCTA
C---  ЧTEHИE ЗOHЫ CTATИCTИKИ
  ,ASN,64-12
  ,AOX,KYC
  E,VJM,EXCH
C---  KOPPEKTИPOBKA BPEMEHИ CБPOCA
  ,XTA,TODAY
  P,ATX,1022.ДATA ЗAПИCИ
  ,XTA,ASTIME
  P,ATX,1023.ACTP.BPEMЯ
C---  ПPOBEPKA ЗOHЫ
  P,XTA,
  ,AEX,CODE
  ,UZA,CORR OWN
C---  ФOPMИPOBAHИE ЗOHЫ CTATИCTИKИ
  P,MTJ,S
  :,24,3
  ,XTA,CODE
  ,XTS,
  R,VTM,1 - 1018.CЛOBA ЗOHЫ
  NULL:S,ATX,. 1...1018
  R,VLM,NULL
  P,XTS,1022.  ...1019
  P,XTS,1023.  ...1020
C---  COOБЩEHИE OПEPATOPY
  J,UTM,NEWS - KYC
  ,ITS,J.  ...1021
  R,CALL,TELOUT
C---  KOPPEKTИPOBKA BPEMEHИ PAБOTЫ USER'OB
  CORR OWN:,24,3
  L,VTM,1-NPCH
  CORR:L,XTA,COWNER+NPCH
  ,UZA,EC.TEPM. CBOБOДEH
  ,ATI,J.HOMEP PASS
  P,J+M,J
  ,XTA,TIME
  ,A-X,OLDTIME
  J,A+X,
  J,ATX,
  EC:L,VLM,CORR
C---  CБPOC CTATИCTИKИ
  ,XTA,KYC
  ,AEX,B18
  E,VTM,END EX
C---  ПOДПPOГPAMMA OБMEHA
  EXCH:J,VTM,KYC
  J,ATX,
  ,ATX,SAVAC
  R,CALL,TRAPHY
  E,U1A,
C---  OБMEH HE ПPOШEЛ
  J,UTM,BADEX - KYC
  ,ITA,J
  R,CALL,TELOUT
C---  OCBOБOЖДEHИE OБMEHHOГO ЛИCTA
  END EX:,XTA,
  NP,ATX,TPHYS
C---  YCTAHOBKA KOHTPOЛЬHOГO BPEMEHИ
  NEWDELTA:,24,3
  S,VTM,OLDTIME
  ,XTS,2.BECTИ ЛИ ДAЛЬШE
  ,AAX,STAT IS.CTATИCTИKY?
  ,UZA,RET.ЗAKPЫЛИ
  ,XTA,MAXTIME
  ,STX,NEWTIME
C---  KOPPEKTИPOBKA BЛAДEЛЬЦEB TEPMИHAЛOB
  L,VTM,1-NPCH
  COWN:L,XTS,CIN+NPCH
  ,ATI,J
  ,ITA,J
  ,UZA,CLOW
  J,XTA,OWNER
  ,AAX,C1777.HOMEP PASS'A
  CLOW:L,ATX,COWNER+NPCH
  S,AOX,
  L,VLM,COWN
  ,UZA,RET.HET USER'OB
  ,XTA,TIME
  :,24,2003B
  ,XTS,NEWTIME. TIME -> OLDTIME
  ,UZA,NEWDELTA.COБЫTИE B T.C.
  ,XTA,TIME
  ,A+X,DELTA
  ,ATX,NEWTIME
C---  KOHEЦ PAБOTЫ
  RET:,XTA,I/RET
  ,UJ,NRESOFF
  I/RET:,Z00,NR/STAT
  ,Z00,MD/RET
C
  CODE:,ISO,6HT/STAT
C
  NEW S:,ISO,24HOTKPЫTA TEPM.CTATИCTИKA''
  BAD EX:,ISO,24HTEPM.CTATИCTИKA - OБMEH''
C
  PAUSE:,REAL,5.0
  DELTA:,REAL,60.0
  MAXTIME:,OCT,775
  EXPOINT:,OCT,0014 0010 0040
  KYC:,BSS,1
  TIME:,BSS,1
  ,END,
 *STATBUF:,NAME,.
 ,LOG,1.PAЗP.CTATИC.
 ,LOG,0.HE HAДO CБPOCA
 ,TEXT,8HD73STA '6'
 ,OCT,0000 0010.ЗOHA HAЧAЛA
 ,LOG,107.L ДИH.БYФ. - 1
 ,LOG,0.YKAЗ.ДИH.БYФ.
 ,LOG,0.BЫЗBAH ДИCП.
 ,BSS,9.YCTPOЙCTBA
 ,BSS,110B.ДИH.БYФEP
 ,END,.
 CALCPRT:,NAME,
 *700:B,BLOCK,(20),BIT28(21),BIT7
 *YCЫ:LC,BLOCK,TIFJA
 TABPRT:LC,BLOCK,TPRT
   ''''''''''''''''''''''''''''''''''''''
   'TAБЛИЦA ПPИOPИTETOB ФИЗИЧECKИX
   'CTPAHИЦ TABPRT ИMEET CCЫЛOЧHYЮ
   'CTPYKTYPY.
   'CTPAHИЦЫ YПOPЯДOЧEHЫ ПO YБЫBAHИЮ
   'ПPИOPИTETOB.
   'CЛOBO 0 TAБЛИЦЫ COДEPЖИT
   ' PAЗPЯДЫ
   ' 30-16  MINP-HOMEP CTPAHИЦЫ C
   '        MИHИMAЛЬHЫM ПPИOPИTETOM
   ' 15-1   MAXP-HOMEP CTPAHИЦЫ C
   '        MAKCИMAЛЬHЫM ПPИOPИTETOM
   'CЛOBO P COДEPЖИT
   ' PAЗPЯДЫ
   ' 30-16  U-HOMEP CTPAHИЦЫ
   '        ПPEДШECTBYЮЩEЙ P
   '        ПO ПPИOPИTETY
   ' 15-1   L-HOMEP CTPAHИЦЫ
   '        CЛEДYЮЩEЙ ЗA P
   '        ПO ПPИOPИTETY
   '-------------------------------------
   'ДЛЯ MINP L=0
   'ДЛЯ MAXP U=0
   '(CTPAHИЦA 0 KAK БЫ CЛEДYET ЗA MINP,
   'A ЗA HEЙ CЛEДYET MAXP)
   ''''''''''''''''''''''''''''''''''''''
 *PRT:LC,BLOCK,(2),NC
 *13:,BLOCK,P,L,U
 *13:,BLOCK,I,J,RT
 KU:,EQU,15
 B30/16:LC,BLOCK,MSKNPU
 KNMP:,EQU,21.
 KJOB:,EQU,27.
 EXCHBIT:,EQU,BIT7.
 TPHYS:LC,BLOCK,TPHIZ
 TMATH:,EQU,30B.
 TMP:,EQU,30B.
 TDEFENC:,EQU,40B.
 C37:,LC,1.
 C77:,LC,1.
 MJOB:,EQU,C77.
 FULWOR:LC,BLOCK,ALL7
 C3:,LC,1.
 C7:,LC,1.
 CB8:,EQU,BIT28.
 RETURN:,SUBP,.
  Z28/21:,LC,1
C
C...   PAБOЧИE ЯЧEЙKИ :
C
  ST:I,BLOCK,(1),NP,NM,YC,(1)
C
 ,ATX,NP
 ,ATI,P
 RT,VTM,RETURN
 P,VZM,OPENPAGE
 ,AEX,NC
 ,UZA,OPENPAGE
 P,XTA,TPRT
 ,UZA,OPENPAGE
 ,ATI,L.LNP
 ,ASN,64+KU
 ,ATI,U.UNP
 ,AEX,NP
 ,ASN,64-KU
 L,AEX,TPRT
 L,ATX,TPRT.UNP UPPER LNP
 ,ITA,L.LNP
 ,AEX,NP
 U,AEX,TPRT
 U,ATX,TPRT.LNP LOWER UNP
 ,XTA,NC
 ,ATI,U
 ,ASN,64-KU
 P,ATX,TPRT.NC UPPER NP
 U,XTA,TPRT.
 ,ATI,L.LNC
 ,AAX,MSKNPU
 ,AEX,NP
 U,ATX,TPRT.NP LOWER NC
 ,ITA,U
 ,AEX,NP
 ,ASN,64-KU
 L,AEX,TPRT
 L,ATX,TPRT.NP UPPER LNC
 ,ITA,L.LNC
 P,AEX,TPRT
 P,ATX,TPRT.LNC LOWER NP
 ,XTA,NP
 ,ATX,NC.LAST PAGE WITH NEW PRIORITY
  ,ATI,I
  RT,VTM,RETURN
C
C...   OTKPЫTИE ЛИCTA ПO ПPИПИCKE
C           И ЗAЩИTE
C
C    И13  -  HOMEP ФИЗ.ЛИCTA
C    И15  -  BOЗBPAT
C      ПOPTЯTCЯ   И13 - И15
C
   OPENPAGE:,ENTRY,
  OPENPAGE:,ITA,RT.BOЗBPAT
  15,VTM,ST
  ,ITS,I.ФИЗ.ЛИCT
  I,XTS,TPHYS
  ,ASN,64-9
  ,AUX,=77000 00077 000077
  15,ATX,.MAT.ЛИCT
  ,ASN,64+18
  ,ATI,J.Д H З
  ,ASN,64+6
  ,U1A,EXIT.V-PAGE
  J,VIM,NORMAL
  I,XTA,TPRT
  ,U1A,EXIT
  NORMAL:,BSS,
  J,XTA,*YCЫ
  15,ATX,.A ИПЗ
  ,ARX,NM
  ,ATI,J
  J,XTA,TMATH
  ,AOX,701B.ГACИM
  ,AEX,701B. 47 БИT
  J,ATX,TMATH
  ,XTA,NM
  ,ASN,64-1.ФOPMAЛЬHЫЙ
  I,AOX,TPHYS.ЛИCT ИЛИ
  ,AAX,EXCHBIT.ЗAKPЫT
  ,U1A,EXIT.ПO OБMEHY
C
C...   OTKPЫTИE ЛИCTA ПO ЗAЩИTE
C
  ,XTA,NM
  ,AAX,C7
  ,AEX,C7
  ,ATI,J
  J,XTA,BIT28
  ,XTS,NM
  ,ASN,64+3
  ,ATI,I
  ,AEX,C3
  ,ARX,YC
  ,STI,J
  J,AAX,TDEFENC
  J,AEX,TDEFENC
  J,ATX,TDEFENC.B TЗAЩ.
  I,MOD,30B.B PЗ
C
C...   OTKPЫTИE ЛИCTA ПO ПPИПИCKE
C
  ,XTA,NM
  ,ASN,64+2
  ,ATI,I
  ,AEX,C7
  15,ARX,.+YC
  ,STI,J
  ,AAX,C3
  ,ATI,RT
  ,XTA,NP
  ,ASN,64-41
  RT,AUX,KПPИ
  J,AEX,TMP
  RT,AAX,KПPИ
  J,AEX,TMP
  J,ATX,TMP.B TПPИП
  ,ASN,64-8
  ,AUX,Z28/21
  I,MOD,20B.B PП
C---
  EXIT:,WTC,ST
  ,UJ,
C
C...   KOHCTAHTЫ ПPИПИCKИ :
C
  KПPИ:,LOG,0001 0400 0037
  ,LOG,0002 1000 1740
  ,LOG,0004 2007 6000
  ,LOG,0010 4370 0000
  ST:,BSS,5
 ,END,
 SWING:,NAME,
 SAVIND:,SUBP,
  EXCHJOB:LC,BLOCK,PJOB(2)
 *SWCMN:LC,BLOCK,SBUSYFLG,SWSCAL,RCNT,EXCHSC,SUPRT
 ,CONT,LOWJOB,UPJOB,NOLOW
 ,CONT,CWJOB,STIME,SWINGIF(24)
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 *YCЫ: LC,BLOCK,ГYC,RDSCAL
  TASKSTRA:LC,BLOCK,TBUC(6),TBUT(6)
  SCALSTRA:LC,BLOCK,SBUC(6),SRJC(6)
 *PRT:LC,BLOCK,NFMSCAL,NNRFLAG,NC,RP,RP1,RP2
 TABPRT:LC,BLOCK,TPRT
 *TYP/MEM:,LC,1
 I:,EQU,1.
 J:,EQU,2.
 K:,EQU,3.
 L:,EQU,4.
 M:,EQU,5.
 IF:,EQU,6.
 RT:,EQU,11.
 *ИПД:LC,BLOCK,XNF,XNFM,(3),XNC,XNCM
 NMAT:,WEQ,XNC
 NF:,WEQ,XNF
 CWMAT1:,EQU,ГYC+NF
 NCM:,WEQ,XNCM
 NFM:,WEQ,XNFM
 Ш/FULL:,EQU,XNF+11B
 Ш/ПOTOK:,EQU,XNF+12B
  MTRACNT:,EQU,XNF+27B
 ИПЗ/ECTЬ:,EQU,XNF+42B
 SC/SWOUT:,EQU,XNF+46B
 MOЖHOKAЧ:,EQU,XNF+67B
 PRTSW:,EQU,XNF+73B
  SPSC:,EQU,XNF+74B
 *ИПK:LC,BLOCK,*INFBA
 INFEX:,EQU,*INFBA+NCM
 AДP/ИПЗ:,EQU,INFEX+NCM
 CPTIME:,EQU,-1
 BISTIME:,EQU,110B
 BPEMEHA:LC,BLOCK,TC,TB,(2)
  * И П K 1 :,LC,
 SNFM:,EQU,NFM-NF
 PRTSTATM:,EQU,*ИПK1+SNFM
  MONO:,EQU,*ИПK1+NMAT
  ШЛAГБAYM:LC,BLOCK,(5),CALLBSC
 DISREG:LC,BLOCK,C2013
 C177:,LC,1
 C3:,LC,1
  C14:,LC,1
 SCENDJO:,EQU,XNF+77B
 START:,SUBP,
 NMATJ:,EQU,NMAT-1.
 B30/16:,LC,1.
 MSHIFR:,EQU,B30/16
 C37:,LC,1.
 KUP:,EQU,15
 KNP:,EQU,30.
 KNMP:,EQU,21.
 KJOB:,EQU,27.
 KCWP:,EQU,30.
 KCWJOB:,EQU,42.
 C1:,EQU,BIT1.
 C7:,LC,1.
 C1PP:,EQU,BIT1.
 CREAD:,EQU,BIT18.
 OWNBIT:,EQU,BIT48.
 SNBIT:,EQU,BIT29.
 MCW:,EQU,ГYC.
  B48/47:LC,BLOCK,MOWNSW
  B48/31:,LC,1
  CLTMP:,EQU,B48/31
  MINF :,EQU,B48/31
 TPHYS:,LC,32.
 TPHIS:,EQU,TPHYS.
C--------------
C..  ЧTOБЫ HE CMOTPETЬ ЛИCTЫ
C... 1-Й ПOЛOBИHЫ PEЗИДEHTA :
  *NRP1:,PC,
  XLTP:,EQU,*ИПД+22B
  N1RES:,P/P,(*NRP1)1024
C-----------------
  C1400:,LC,1
  GTRMASK:,LC,1.CM.GIVTRACK
  *3:B,BLOCK,S33,S32,S27
  *104:B,BLOCK,BUFS27,BUFIW
  CALCPRT:,SUBP,
  KOHHИЗ:,LC,
  LNRT:,P/P,(KOHHИЗ)1024
  Z28/21:,LC,1
 TIFJA:,EQU,*YCЫ.
 C77:,LC,1.
 MNP:,EQU,C177.
 MJOB:,EQU,C77.
 TMATH:,EQU,30B.
 TMP:,EQU,30B.
 TDEFENC:,EQU,40B.
 NPPW:,EQU,41B.
 KJOB/NMP:,EQU,KJOB-KNMP.
 SCW:,EQU,*YCЫ+24B.
 DRIDENT:,LC,1.
 GIVTRACK:,SUBP,.
 SELECT:,SUBP,.
 EXCHBIT:,EQU,BIT7.
 MSWBIT:,EQU,BIT47.
 READSCAL:,LC,1.
 NEWRP:,EQU,NLP.
 SWADR:,EQU,SWINGIF+3.
 SWREG:,EQU,SWINGIF+5.
 SWNCNT:LC,BLOCK,(1).
 WANTCHAN:,LC,1.
 CONTEXCH:,SUBP,.
 FULWOR:,LC,1.
 TAKETR*:,SUBP,.
 FRITRACK:,EQU,TAKETR*.
C         ---------------------------------
 Д H З:,LC,1.
 TANUMB:,EQU,Д H З.
 TRASWI:,SUBP,.
 TRAM70:,EQU,TRASWI.
 IW70:,LC,1.
 CWJFOTRA:,LC,1.
 CWJ:,EQU,CWJFOTRA.
 TRACNT:,LC,1.
 FULQUESC:,LC,1.
 S4CLTA:,EQU,FULQUESC.
C
 SWING:,BSS,.
   :   ,24,3.
 ,XTA,CWJOB.
 ,ATI,IF.
 ,ASN,64+KCWJOB.
 ,ATX,NJOB.
  ,ATX,XOДOK
C......ПPOBEPKA HEOБXOДИMOCTИ BЫДEЛEHИЯ ПAMЯTИ 1
 ,XTA,RP
 ,ATX,ORP
 ,XTA,RP2.
 ,ATX,RP.
 ,XTA,7.
 ,AOX,*TYP/MEM
 ,AAX,BIT48
 ,U1A,CH2.ЗAПPET PAБOTATЬ B ПAMЯTИ 2.
 M,MTJ,I
 I,UTM,1
 I,VZM,LOWCHEK
 ,ITA,M.
 ,ASN,64+7.
  ,UZA,LOWCHEK
 CH2:,XTA,RP2.
 ,ASN,64+5
 ,ATX,SRPFL.HE 0 - ИCKATЬ RP B ПAMЯTИ 1
  ,UZA,LOWCHEK
 ,XTA,RP1.
 ,ATX,RP.
  ,UJ,LOWCHEK
 CH3:,BSS,
  M,UTM,1
  M,VZM,V EXCH
  M,UTM,-1
  ,ASN,64+1
  ,U1A,ЧYЖOE
 ,ITA,M.
 ,AAX,C77.
 ,ATI,M.
  I,VTM,
  J,VTM,
  K,VTM,-1023.ПEPEПИCЬ ЛИCTA
 M,UTC,.
 IF,XTA,TMATH.
 ,ASN,64+KNP.
 ,AAX,MNP
 ,ATX,STMP.N ЛИCTA ПAMЯTИ 2
 ,XTA,RP.
 ,ATX,SNP.KYДA ПEPEKAЧATЬ
 ,ATX,RFINFLG.HE ПOДKAЧKA
 M,UTC,.
 IF,XTA,TMATH.
 ,AAX,=77 7777 7777.
 M,UTC,.
 IF,ATX,TMATH.
 ,ITA,0.
 ,WTC,STMP.
 ,ATX,TPHYS.OTKAЗ OT CTAPOГO ЛИCTA
  10,VTM,GIVP.ПEPEKAЧKA B 1 ПAMЯTЬ
  ,UJ,READ2M.И OБXOД NPPW
 RTCH:,BSS,.
 IF,XTA,NPPW.
 ,ARX,C1PP.
 IF,ATX,NPPW.
  ,UJ,GIVP
C---
  ЧYЖOE:,BSS,
C... ЗAПPOC ЛИCTA ИЛИ ИПЗ ЧYЖOЙ ЗAДAЧИ
C    10:15 P.PEГИCTPA M - ДHЗ
C    ИЛИ 1, ECЛИ OT SELECT.
  ,AEX,BIT1
  ,UZA,GIVP
  ,AEX,BIT1
  ,ATX,NJOB
  ,WTC,NJOB
  ,XTA,*YCЫ
  ,ATX,CWJOB
  ,ATI,IF
 GIVP:,BSS,.
 ,ITA,M
 ,AAX,C77
 ,ATI,M
 ,ATX,NMP
 ,XTA,NJOB.
 ,ASN,64-KJOB/NMP.
 ,AOX,NMP.
 ,ASN,64-KNMP.
 ,WTC,RP.
 ,ATX,TPHIS.
 ,XTA,SWNCNT.
 ,ARX,C1.
 ,ATX,SWNCNT.
 ,XTA,NMP
 ,AEX,=50
 ,U1A,HE ИПЗ
 ,XTA,NJOB
 ,ATI,J
 ,XTA,RP
 ,ASN,64-10
 ,ARX,C3
 J,AOX,MCW
 J,ATX,MCW
 ,ATI,IF
 ,XTA,ИПЗ/ECTЬ
 J,AOX,BITS
 ,ATX,ИПЗ/ECTЬ
 J,XTA,AДP/ИПЗ-NFM
 ,U1A,READDRUM.HA BЫKAЧИBAHИE ИПЗ
 RT,VTM,-1023
 :IF,UTC,-3
 RT,ATX,1023
 RT,VLM,*-1
  RT,VTM,START
  ,ITA,RT
  IF,ATX,3
  ,XTA,DISREG
  IF,ATX,5
  ,UJ,NO READ
 HE ИПЗ:,BSS,
 ,XTA,RP.
 ,ASN,64-KNP.
 M,UTC,
 IF,AOX,TMATH.
 M,UTC,
 IF,ATX,TMATH.
 ,ARX,.CHEK OWN BIT48
 ,U1A,READDRUM.
 ,AEX,OWNBIT.CLEAN OWNBIT.
 M,UTC,
 IF,ATX,TMATH.
  ZERO LIS:,BSS,
 ,XTA,RP.
 ,ASN,64-41.
 ,AUX,=1 0400 0037.
 RT,VJM,PTMP.BЫДAЧA ПPИПИCKИ
   :   ,24,3.
 ,XTA,DISPZRO.
  :,24,2
 J,VTM,-1023.
 :J,ATX,71777B.POCПИCЬ ЛИCTA
 J,VLM,*.
   :   ,24,3.
  ,UJ,NO READ
C
C     PEAЛИЗAЦИЯ OБMEHA MEЖДY MAT.ЛИCTOM
C     И BИPTYAЛЬHЫM ЛИCTOM ПO ЭK.070.
C     OБPAЩEHИE ИЗ MACRO70 ЧEPEЗ GIVEPAGE
C     PEГИCTP  M  PABEH -1.
C     IW70 ПEPEДAETCЯ БEЗ ИЗMEHEHИЙ ЧEPEЗ
C     BUFIW - ЯЧEЙKY ИПЗ ЮЗEPA.
C     MAT.ЛИCT YЖE "BЫДEPHYT" B ПAMЯTЬ И
C     ЗAKPEПЛEH TAM 7-M БИTOM B TPHYS.
C     BИPT. ЛИCTЫ ИMEЮT HOMEPA  100-1477
C     И COOTBETCTBYЮT MAT.MБ  0000-2737
C     B TPHYS HOMEP V-ЛИCTA PACПOЛAГAETCЯ
C     B  38-34  И  26-22  PAЗPЯДAX.
C     ФИЗ.HOMEP  V-ЛИCTA HAXOДИTCЯ B TAБЛИЦE
C     TPAKTOB MБ C ПPИЗHAKOM "0-E HAПPABЛ."
C
  V EXCH:,BSS,
  IF,XTA,BUFS27.ПOДГOTOBKA
  IF,ATX,S27.ИПЗ ЗAДAЧИ
  IF,XTA,S32.K BЫXOДY
  IF,ATX,S33.ПOД Э070
  IF,XTA,BUFIW.IW70
  ,ARX,BIT14.+100B
  ,ATX,IW70V
  ,AAX,=370037
C.....   ПOЛYЧEHИE XAP-KИ  V-ЛИCTA
  ,ATX,NMP.ДЛЯ TPHYS
  IF,XTA,BUFIW
  ,APX,=370037
  ,ASN,64+38
  ,ATX,DRIDENT
  ,XTA,NJOB
  ,ASN,64-42
  ,AOX,DRIDENT
  ,ATX,DRIDENT
  7,VJM,GIVTRACK
  ,ASN,64+2
  ,ATX,STMP
  ,ASN,64+7
  ,UZA,HE ИПЗ1
C.....   OФOPMЛEHИE V-ЛИCTA B TPHYS
  ,XTA,NJOB
  ,ASN,64-6
  ,AOX,NMP
  ,ASN,64-KNMP
  ,WTC,RP
  ,ATX,TPHYS
  ,XTA,RP
  ,ATX,STMP
  14,VZM,ZEROLIS.1-E OБPAЩ.
  ,XTA,IW70V
  ,ARX,
  ,UZA,READDRUM
  ,AAX,BIT40
  ,U1A,READDRUM
 NOREAD:,XTA,C1.
 ,ATX,RFINFLG.
 ,UJ,READDRUM
 LOWCHEK:,BSS,
 ,XTA,PRTSW
 ,UZA,LCH1
 ,XTA,XOДOK
 ,AEX,LOWJOB
 ,UZA,LOWCHEK1
 LCH1:,BSS,
 ,XTA,XOДOK
 ,ATX,UPJOB
 I,VTM,NCM
 K,VTM,1
 ,XTA,NOLOW
 ,U1A,LJSE1
 ,ATX,RST
 ,NTR,3
 LJS:,BSS,
 I,UTM,-1
 I,XTA,BITS+NFM
 ,AAX,RDSCAL
 ,UZA,LJSE
 I,XTA,PRTSTATM
 ,AAX,=77000000
 ,X-A,RST
 ,UZA,LJSE
 ,X-A,RST
 ,ATX,RST
 I,MTJ,K
 K,UTM,NFM
 LJSE:,BSS,
 I,V1M,LJS
 LJSE1:,ITA,K
 ,ATX,LOWJOB
 ,AEX,XOДOK
 K,VTM,1
 ,UZA,LJSE1
 LOWCHEK1:,BSS,
  :,24,2003B
  ,XTA,BIT25
  ,ATX,RCNT
  ,XTA,CALLBSC
  ,AAX,C77
  ,ATI,J.ГOTOBЫE,
  ,XTA,CALLBSC.ДEPЖAЩИE NRESCALL,
  ,ASN,64+6.ЖДYЩИE EГO
  J,AOX,BITS.OCBOБOЖДEHИЯ,
  ,AOX,EXCHSC.ЗAKPЫTЫE ПO OБMEHY,
  ,AOX,RDSCAL.ЗAДAЧИ ИЗ ЧИCЛA
  ,AAX,SPSC.CПEЦИAЛЬHЫX -
  ,WTC,UPJOB. - BOЗMOЖHЫE
  ,AOX,BITS.KAHДИДATЫ B UPJOB'Ы
  ,AAX,Ш/FULL
  ,UZA,ZJ
  ,NTR,3
  11,CALL,SMAXP.ПOPTИT И1,И13
  ,ITA,13
  ,ATX,UPJOB
  ,AEX,XOДOK
  ,UZA,ZJ
  ,XTA,XOДOK
  ,ATX,LOWJOB
  ZJ:,24,3
  ,XTA,
 ,ATX,PRTSW
 ,ATX,FREE
 ,ATX,NLOWFLG
 ,ATX,NUPFLG
 ,ATX,LOWCNT
 ,ATX,FMCNT
  ,WTC,XLTP.ПOCЛEДHИЙ
  I,VTM,-1.ЛИCT MOЗY
 LOWCH:,BSS,.
 ,XTA,SRPFL
 ,UZA,CHI
 ,ITA,I
 ,ASN,64+5
 ,UZA,CHI
 RT,VJM,CHFIX
 ,U1A,ENDLP
 ,XTA,HOST
 ,AEX,UPJOB
 ,UZA,ENDLP
 ,XTA,LOWCNT
 ,ARX,C1
 ,ATX,LOWCNT
 ,UJ,ENDLP
 CHI:,BSS,
 RT,VJM,CHEK I.
 ,U1A,ENDLP.ЛИCT HE ПOДXOДИT
 ,ITA,I
 ,ASN,64+5
 ,UZA,CHI2
 ,XTA,FMCNT
 ,ARX,C1
 ,ATX,FMCNT.N CTP,ДOCTYПHЫX B 1-Й ПAMЯTИ
 CHI2:,BSS,
 I,XTA,TPHYS
 ,UZA,FREE PAGE
 ,XTA,HOST
 ,AEX,UPJOB
 ,U1A,NONACT
 ENDLP:,BSS,
 I,UTM,-N1RES
 I,VZM,SERCHRES
 I,UTM,N1RES-1
 ,UJ,LOWCH
 CHEK I:,ITA,I.
 ,AEX,RP1.
 ,UZA,NO.
 ,ASN,64+5
 ,UZA,CH ИПЗ
 ,XTA,SRPFL
 RT,U1A,.ПAMЯTЬ 2 HE ПOДXOДИT
 CH ИПЗ:,BSS,
 I,XTA,TPHYS
 ,ASN,64+KNMP
 ,AAX,C77
  ,ATI,J
 ,AEX,=50
 ,UZA,ЭTO ИПЗ
 CHFIX:,BSS,
 I,XTA,TPHYS
 ,ASN,64+KJOB
 ,AAX,MJOB
  ,U1A,NORMP
  J,XTA,NRTABL
  ,WTC,UPJOB
  ,AAX,BITS-19
  ,UZA,N1
  ,XTA,UPJOB.HEPEЗИДEHT
  ,UJ,NORMP.ИCПOЛЬЗOBAЛCЯ UPJOB-OM
  N1:,XTA,LOWJOB
  ,AEX,C1
  ,UZA,NORMP.HET LOWJOB
  J,XTA,NRTABL
  ,WTC,LOWJOB
  ,AAX,BITS-19
  ,UZA,NORMP
  ,XTA,LOWJOB.HEPEЗ-T ИCП-CЯ LOWJOB-OM
  NORMP:,BSS,
 ,ATX,HOST
 ,ITA,I
 ,AEX,RP2
 ,UZA,NO
 I,XTA,TPHIS.
 ,AAX,MEXCHFIX.
 RT,UJ,.
 ЭTO ИПЗ:,BSS,
 I,XTA,TPHYS
 ,ASN,64+KJOB
 ,AAX,MJOB
 ,ATI,K
 K,WTC,MCW
 ,XTA,NPPW
 ,AAX,C177
 RT,U1A,
 K,WTC,MCW
 ,XTA,5
 ,AAX,C14
 ,UZA,CHFIX.ЗAДAЧA B MAT. PEЖ.
 ,XTA,MOЖHOKAЧ
 K,AAX,BITS
 ,U1A,CHFIX
 NO:,XTA,C1.
 RT,UJ,.
 FREE PAGE:,BSS,
 ,ITA,I
 ,ATX,FREE
 NONACT:,ATX,NUPFLG
 ,XTA,LOWCNT
 ,ARX,C1
 ,ATX,LOWCNT
 ,XTA,HOST
 ,AEX,LOWJOB
 ,UZA,ENDLP
 ,ATX,NLOWFLG
 ,XTA,LOWCNT
 ,ASN,64+1
 ,UZA,ENDLP
 ,XTA,NFMSCAL
 ,U1A,END LP. ECTЬ ЗAДAЧИ,ЗAKPЫTЫE ИЗ-ЗA
C                  HEXBATKИ ПEPBOЙ ПAMЯTИ
C
C      SEARCH NEW RESERVE PAGE
C
 SERCHRES:,BSS,
  :,24,2003B
 ,XTA,NFMSCAL
 ,UZA,FMOK
 ,XTA,FMCNT
 ,ASN,64+1
 ,UZA,FMOK.HET PEЗEPBA ПEPBOЙ ПAMЯTИ
 ,XTA,RDSCAL
 ,AOX,NFMSCAL
 ,ATX,RDSCAL
 ,XTA,
 ,ATX,NFMSCAL
 ,XTA,NFMCNT
 ,ARX,BIT25
 ,ATX,NFMCNT
 FMOK:,BSS,
 ,XTA,FREE
 ,U1A,SCHR
 ,XTA,TPRT
 ,ASN,64+KUP
 SCHR:,BSS,
 :,24,3
 ,ATX,NEWRP.CURRENT N OF LOW PRT PAGE
 ,ATI,I
 RT,VJM,CHEK I.
 ,U1A,SERCHAN.
 ,XTA,HOST
 ,UZA,RESP.CBOБOДHЫЙ HEPEЗИДEHT
 ,AEX,UPJOB
 ,U1A,CHLOW
 ,XTA,NUPFLG
 ,UZA,RESP
 SERCHAN:I,XTA,TPRT
 ,ASN,64+KUP.
 ,AAX,MNP.
 ,U1A,SCHR.
 ,UJ,QUESHUT.
 NRTABL:,SUBP,
 FRINRES:,BSS,
 I,XTA,TPHIS
 ,ASN,64+21.
 ,ATI,J
 ,XTA,
 I,ATX,TPHIS
  J,XTA,NRTABL
  ,AAX,BIT46
  J,ATX,NRTABL
 ,UJ,FRIEPAGE
 CHLOW:,BSS,
 ,XTA,HOST
 ,AEX,LOWJOB
 ,U1A,RESP
 ,XTA,NLOWFLG
 ,U1A,SERCHAN
  RESP:,BSS,
  ,ITA,M
  ,ASN,64+6
  ,UZA,RTCH.ПOДKAЧKA
  ,ASN,64+2
  ,U1A,CH3
  ,UJ,NOREAD.ЗAПPOC ЛИCTA
 READDRUM:,BSS,
 ,XTA,RFINFLG.
 ,U1A,REDYNRP.
 ,XTA,RP.
 RT,VJM,TRACK.
 ,AOX,CREAD.
 ,ATX,INFW.
 ,ATX,INFDR.
 ,XTA,READSCAL.
 ,WTC,NJOB.
 ,AAX,BITS.
 ,U1A,SKIPREAD.
  L,XTA,TPHIS
 ,AOX,EXCHBIT.
  L,ATX,TPHIS
 ,XTA,CWJOB.
 10,VJM,EXCH.
 13,VJM,FRITRACK.
  ,XTA,INFW
  ,ARX,
  ,UZA,NOCORW
  ,ASN,64+36
  ,AAX,BIT4
  ,ATX,WANTCHAN
  NOCORW:,BSS,
   :   ,24,3
 ,XTA,TRACNT.
 ,ARX,MTRACNT
 ,U1A,REDYNRP.
 ,XTA,RP.
 RT,VJM,RPSHUT.
  REDYNRP:,24,3
  ,WTC,NEWRP
  I,VTM,
  ,XTA,IW70V
  ,UZA,NO VIRT
C...  ДЛЯ V-ЛИCTA OCTABИM B TAБЛ.TPAKTOB
C     HOMEP ФИЗ.ЛИCTA, KYДA BKAЧEH V-ЛИCT
  13,VJM,FRITRACK
  ,XTA,RP
  ,ASN,64-36
  ,AUX,GTRMASK
  RT,VTM,
C---
  COR NPPW:,24,3
  10,AEX,
  ,AAX,GTRMASK
  10,AEX,
  10,ATX,
  ,XTA,DRIDENT
  ,ASN,64+42
  ,ATI,14
  14,WTC,*YCЫ
  14,VTM,NPPW
  14,XTA,
  RT,ARX,C1PP. ИЛИ CM1 !
  14,ATX,
  RT,VIM,V WRIT
C---
  NO VIRT:,BSS,
  I,XTA,TPHIS
 ,UZA,FRIEPAGE.
 ,AAX,=7777 7770 0777 7777.
 ,UZA,FRINRES
 I,XTA,TPHIS
 ,AOX,EXCHBIT.
 I,ATX,TPHIS.
 ,ASN,64+KNMP
 ,AAX,C77
  ,ATI,10
  10,UTM,-50B
 I,XTA,TPHYS
 ,ASN,64+KJOB
 ,AAX,MJOB
  ,ATI,K
  K,XTA,TIFJA
  ,ATI,J
  10,VIM,HEИПЗ2
 ,XTA,Ш/ПOTOK
 K,AAX,BITS
 ,UZA,HEП1
 ,UTC,2
 HEП1:10,VTM,
 ,NTR,
 J,XTA,CPTIME
 10,A+X,TC
 10,ATX,TC
 J,XTA,BISTIME
 10,A+X,TB
 10,ATX,TB
 HEИПЗ 2:,BSS,
 ,XTA,NEWRP.
 RT,VJM,TRACK.
  ,ASN,64+10.YKAЧИBAEM V-ЛИCT
  ,U1A,NO VIRT1.-HET
C...  OЧИCTKA KЛETKИ TAБЛ.TPAKTOB
C     И ЗAXBAT TPAKTA ДЛЯ YKAЧKИ V-ЛИCTA
  RT,VTM,CM1-C1PP.CYMM.=0 !
  ,UJ,COR NPPW
  V WRIT:,BSS,
  ,XTA,NEWRP
  RT,VJM,TRACK
  NO VIRT1:,BSS,
  ,ITA,K
  ,ATX,PJOB+1
 K,XTA,TIFJA.
 10,VJM,EXCH.
C
C      TAKE NEW RESERVE PAGE FROM THE JOB
  ,WTC,NEWRP
  I,VTM,."EXCH"
  ,WTC,PJOB+1.ПOPTИT
  K,VTM,.I,J,K
  K,WTC,TIFJA
  J,VTM,
  I,XTA,TPHYS
  ,ATX,FREE
  ,AAX,EXCHBIT
  I,ATX,TPHYS
 J,XTA,NPPW
 ,AAX,C177
 ,U1A,HE YПPЯT
 K,XTA,BITS
 ,AEX,ИПЗ/ECTЬ
 ,ATX,ИПЗ/ECTЬ
 K,XTA,MCW
 ,AAX,=77777777 77700000
 K,ATX,MCW
 ,UJ,FRIEPAGE
 HE YПPЯT:,BSS,
  ,XTA,FREE.TPHYS
  ,ASN,64+33
  ,U1A,FRIEPAGE.V-ЛИCT
 J,XTA,NPPW
 ,ARX,CM1
 J,ATX,NPPW
  ,XTA,FREE
 ,ASN,64+KNMP.
 ,AAX,C77
 ,ATI,K.
 K,MTJ,11.
 J,MTJ,13.
 J,J+M,K.
 K,XTA,TMATH.
 ,AAX,CLNP.
 ,AOX,MSWBIT.
 K,ATX,TMATH.
  5,CALL,CLOSPAGE
 FRIEPAGE:,BSS,.
 ,XTA,RFINFLG.
  ,U1A,HE ИПЗ1
 ,XTA,RP.
 RT,VJM,RPSHUT.
 ,XTA,NMP
 ,AEX,=50
 ,U1A,HEИПЗ 1
  ,XTA,NJOB
  ,ATI,K
 K,XTA,MCW
  ,ATI,J
 I,VTM,0
 ,XTA,Ш/ПOTOK
 K,AAX,BITS
 ,UZA,HEП2
 I,VTM,2
 HEП2:I,XTA,TC
 J,A-X,CPTIME
 I,ATX,TC
 I,XTA,TB
 J,A-X,BISTIME
 I,ATX,TB
 ,XTA,SCENDJO
 K,AAX,BITS
 ,U1A,HE BЫБPOC
 ,XTA,SC/SWOUT
 K,AAX,BITS
 ,UZA,HE BЫБPOC
 ,AEX,SC/SWOUT
 ,ATX,SC/SWOUT
  J,XTA,3.И33 B
  J,ATX,4.И32
 K,XTA,MONO-NF
 J,ATX,3
 ,XTA,C2013
 J,ATX,5
 HE BЫБPOC:,BSS,
 HEИПЗ 1:,BSS,
  ,XTA,IW70V
  ,U1A,TRANSFER
C
C      SHUT ALL PAGES FOR PRIORITY RECALCULATION
C
  SHUTPAGS:,BSS,
 ,ATX,NC.FOR ALL PRT RECALC
 I,VTM,-NMATJ.MAX ACCOUNT-1 OF MAT.JOBS
 CLTM0:I,XTA,CWMAT1+NMATJ.TABLE OF CW FOR MATH. JOBS
 ,ATI,J.
 J,VZM,CLTM5
 ,AAX,MSHIFR.
 ,UZA,CLTM5.
 K,VTM,-7.
 CLTM1:K,UTC,
 J,XTA,TMP+7.
 ,AAX,CLTMP.CLEAN TMP
 K,UTC,
 J,ATX,TMP+7.
 K,VLM,CLTM1.
 K,VTM,-3.
 CLTM2:K,UTC,TDEFENC+3.
 J,XTA,
 ,AOX,MDEFENC.ALL 1-S TO DEFENCE BITS
 K,UTC,TDEFENC+3.
 J,ATX,
 K,VLM,CLTM2.
 K,VTM,-39.
 CLTM3:K,UTC,TMATH+39.
 J,XTA,
 ,AAX,MINF.MASK PAGE INFORMATION
 ,UZA,CLTM4.IF PAGE IS ABSENT
 ,AAX,MOWNSW.MASK OWN BIT AND SWING BIT
 ,U1A,CLTM4.NO WORK IS NEEDED
 K,UTC,TMATH+39.
 J,XTA,
 ,AOX,MSWBIT.SHUT PAGE FOR SWINGING
 K,UTC,TMATH+39.
 J,ATX,.
 CLTM4:K,VLM,CLTM3.
 CLTM5:,BSS,.
 I,VLM,CLTM0.
  K,VTM,-LNRT
  CLTM6:,XTA,MSWBIT
  K,AOX,NRTABL+LNRT
  K,ATX,NRTABL+LNRT
  K,VLM,CLTM6
  ,XTA,FULWOR
  ,ATX,PRTVP
  ,ATX,PRTVP+1
  ,ATX,PRTVP+2
  ,ATX,PRTVP+3
 CHEKWRIT:,24,2003B.
 ,XTA,SWSCAL
 ,WTC,XOДOK
 ,AEX,BITS
 ,ATX,SWSCAL
 ,XTA,INFW.
 ,ATX,INFDR.
 ,XTA,NEWRP.
  ,ATX,RP
 RT,VJM,RPSHUT.
 ,XTA,SRPFL.
 ,UZA,SETRP2.
 ,XTA,RP.
 ,ATX,RP1.
 ,UJ,CLFLAGS.
 SETRP2:,XTA,RP.
 ,ATX,RP2.
 ,ASN,64+5.
 ,UZA,CLFLAGS.
 ,XTA,RP1.
 ,ATX,RP.ДЛЯ ИCПOЛЬЗOBAHИЯ B ДP. MECTAX
 CLFLAGS:,XTA,.
 ,ATX,SRPFL.
  ,ATX,IW70V
 ,ATX,RFINFLG.
 SR:,EQU,2.
 ,XTA,SWORKS.
 ,U1A,NRESCALL.
 SR,VTM,SELECT.
 SWINGRET:,ENTRY,.
   :    ,24,2003B
 ,ATX,SWINGIF.
  ,XTA,RDSCAL
  ,AEX,SNBIT
  ,ATX,RDSCAL
 ,XTA,LOWJOB
 ,ATI,RT
 ,AEX,XOДOK
 ,UZA,NO P
 ,XTA,LOWCNT
 ,ASN,64+1
 ,UZA,NO P
 RT,XTA,BITS
 ,AAX,SWSCAL
 ,UZA,NO P
 ,ATX,PRTSW
 NO P:,BSS,
 I,VTM,SWING.
 ,ITA,I.
 ,ATX,SWADR.
 ,XTA,C7.
 ,ATX,SWREG.
 ,XTA,.
 ,ATX,SWSCAL.
 ,ATX,SBUSYFLG.
 ,XTA,SWINGIF.
 SR,UJ,.
 QUESHUT:,BSS,
 ,XTA,SRPFL
 ,U1A,CLJOB
 ,XTA,SNBIT
 ,AOX,FULQUESC.
 ,ATX,FULQUESC.
 15,VJM,SAVIND.
 ,UJ,LOWCHEK.
C
C---  PEЗEPBHAЯ CTPAHИЦA ФИKCИPYETCЯ
C     TOЛЬKO ПPИ ПOXOДE OT NRESCALL.
  CLJOB:,24,2003B
 ,WTC,ORP
 ,XTA,TPHYS
  ,UZA,CLJ1
C   COOБЩEHИE ДЛЯ NRESCALL OБ OTЛYПE
C   И PACФИKCAЦИЯ CTAPOГO  RP.
  ,ATX,NNRFLAG
  ,XTA,
  ,WTC,ORP
  ,ATX,TPHYS
  CLJ1:,BSS,
 ,XTA,NFMSCAL
 ,WTC,XOДOK
 ,AOX,BITS
 ,ATX,NFMSCAL
 ,XTA,RDSCAL
 ,WTC,XOДOK
 ,AEX,BITS
 ,ATX,RDSCAL
 :,24,3
 ,XTA,NFMCNT
 ,ARX,BIT1
 ,ATX,NFMCNT
 ,XTA,ORP
 ,ATX,RP
 ,UJ,CLFLAGS.ЗAKPЫЛИ ЗAДAЧY ПO ПPИЧИHE
C                OTCYTCTBИЯ ПEPBOЙ ПAMЯTИ И YШЛИ ИЗ ПOДKAЧKИ
 EXCH:,BSS,.
 ,ATX,CWJ.
  ,ATI,13
  *EXCH:,BSS,
 ,XTA,INFW.
  ,ATX,IW70
   :   ,24,2003B.
 ,XTA,TRACNT
 ,ARX,MTRACNT
 ,U1A,NOFUL
 ,XTA,S4CLTA
 ,WTC,TANUMB
 ,AOX,BITS
 ,ATX,S4CLTA
 15,VTM,*EXCH.
 ,UJ,SAVIND
 NOFUL:,BSS,
   :   ,24,3.
 ,UJ,TRAM70.
C         ---------------------------------
C      SEARCH TRACK OF DRUM
 TRACK:,ATI,L.
 L,XTA,TPHIS.
  ,ASN,64-15
  ,ATX,INFW
  ,YTA,
  ,ATI,7
  ,XTA,INFW
  ,AUX,=7700 0000 0000 0077
  ,AOX,BIT42
  7,VZM,M PAGE
C...  V-ЛИCT COOTBETCTBYET MAT.MБ
  ,AEX,BIT42
  ,ATX,INFW
  7,UTM,-2.-100B
  ,ITA,7
  ,ASN,64-5
  ,AOX,INFW
  M PAGE:,ATX,DRIDENT
  7,VJM,GIVTRACK
 ,ATX,INFW.
 RT,UJ,.
 SKIPREAD:,BSS,.
 ,XTA,C1.
 ,ATX,RFINFLG.
 13,VTM,REDYNRP
 ,UJ,FRITRACK
 PTMP:,24,2003B.
 ,ATX,SWINGIF+TMP.
 ,ASN,64-8.
  ,AUX,Z28/21
 ,MOD,27B.
 ,ATI,.
   :   ,24,2.
 RT,UJ,.
C
C...  ПEPEПИCЬ M- И V-ЛИCTOB ПO Э070
C
  TRANSFER:,ASN,64+30
  ,AAX,C37.MAT.ЛИCT
  ,WTC,NJOB
  ,ARX,*YCЫ
  ,ATI,14
  14,XTA,TMATH
  ,AOX,BIT46
  ,AEX,BIT46
  14,ATX,TMATH
  ,ASN,64+30
  ,AAX,C177
  ,ATX,SNP.ФИЗ.ЛИCT
  ,ATI,I
  I,XTA,TPHYS.БИT БЫЛ
  ,AEX,BIT7.ПPOCTABЛEH
  I,ATX,TPHYS.B MACRO70
  ,XTA,IW70V
  I,VTM,
  J,VTM,
  K,VTM,-1023.ЛИCT
  ,ARX,
  ,U1A,TR1024
  K,VTM,-255.AБЗAЦ
  ,ASN,64-2
  ,AAX,C1400
  ,ATI,I
  ,XTA,IW70V
  ,ASN,64+16
  ,AAX,C1400
  ,ATI,J
  ,XTA,IW70V
  TR1024:,AAX,BIT40
  10,VTM,AFT TRAN
  ,UIA,READ2M
  ,ITA,I
  J,MTJ,I
  ,ATI,J
  I,UTM,-2000B
  J,UTM,2000B
 READ2M:,BSS,.
 ,XTA,SNP
 ,ASN,64-18
 ,AUX,MSKTMP0
 ,ATX,SNP
 ,XTA,STMP
 ,ASN,64-19
 ,AUX,MSKTMP1
 ,AOX,SNP
C......ПEPEПИCЬ B ПAMЯTЬ 1
 RT,VJM,PTMP.BЫДAЧA ПPИПИCKИ
  :I,XTA,72000B
  J,ATX,70000B
  I,UTM,1
  J,UTM,1
  K,VLM,*-2
   :   ,24,3.
 10,UJ,.
 STMP:,BSS,1.
 SNP:,BSS,1.
  AFT TRAN:,BSS,
  ,XTA,STMP
  ,AAX,C3
  ,ATI,I
  ,XTA,STMP
  ,ASN,64+2
  ,ATI,J
  I,XTA,PRTVP
  J,AAX,BIT48
  ,UZA,NO CLC
  I,AEX,PRTVP
  I,ATX,PRTVP
  ,XTA,DISREG
  :,24,2003B
  ,ATI,27B
  I,VTM,NO CLC
  I,MTJ,33B
  ,XTA,STMP
  ,UJ,CALC PRT
  NO CLC:,24,3
  ,XTA,STMP.БЫЛ ЗAXBAT
  ,AEX,RP.PEЗ.CTPAHИЦЫ
  ,UZA,SHUTPAGS.-ДA
  ,XTA,RP
  ,ATX,NEWRP
  ,UJ,CHEKWRIT.HA BЫXOД
  RPSHUT:,BSS,
 ,ATI,L.
 L,XTA,TPHIS.
 ,AAX,EXCHBIT.
 RT,UZA,.
 L,XTA,TPHIS.
 ,AAX,MSKPJOB.
 ,ATX,PJOB.
 L,AEX,TPHIS.
 ,AOX,NSJOBP.
 L,ATX,TPHIS.
   :   ,24,2003B.
  ,ITA,L
 ,ASN,64-KCWP.
 ,AOX,SCW.
 ,ATX,SCW.
  ,XTA,INFDR
  ,ARX,
  ,UZA,BUSYCHAN
  ,ASN,64+39
  ,ATI,14
 14,XTA,TBUC-1.
 14,AOX,TBUT-1.
 ,U1A,BUSYCHAN.
 14,XTA,SRJC-1.
 ,ANX,.
 ,ATI,12.
 9,VJM,CONTEXCH
 BUSYCHAN:,BSS,
 ,XTA,DRIDENT
 ,ATX,HOST
 15,VJM,SAVIND.SAVE INDS. AND SHUT SWING
 ,XTA,HOST.ДЛЯ
 ,ATX,DRIDENT.V-ЛИCTOB
 L,XTA,TPHIS.
 ,AAX,MSKPJOB.
 L,AEX,TPHIS.
 ,AOX,PJOB.
 L,ATX,TPHIS.
 RT,UJ,.
 TTENTRY:,ENTRY,.
 DISPBASE:LC,BLOCK,(1),DISMBASE.
 RETURN:,SUBP,.
 NEWTA:,SUBP,.
 TRAPHY:,SUBP,.
 PHEXCH:,EQU,TRAPHY.
 TTANAL:,SUBP,.
  TTPAGE :,P/P,(TTANAL)1024
  BEGTTP :,P*P,(TTPAGE)1024
   :   ,24,2003B.
 ,XTA,SBUSYFLG.
 ,U1A,QUE.
 13,VTM,TELMEM.
 ,ITA,13.
 ,ATX,SWINGIF+3.
 ,XTA,RDSCAL.
 ,AOX,SNBIT.
 ,ATX,RDSCAL.
 ,XTA,SCW
 ,ATX,SBUSYFLG.
 ,UJ,NEWTA.
  QUE:,BSS,
 ,ATX,SWORKS.
 ,UJ,RETURN.
 NRESCALL:,BSS,.
 TELMEM:,BSS,.
 NPTTE:,P/P,(BEGTTP)(256)
  ,XTA,
  ,ATX,SWORKS
 14,VTM,NPTTE.
 ,ITA,14.
 ,ARX,DISPBASE.
 ,ATX,INFDR.
 ,XTA,RP.
  ,ASN,64-10
  ,ATI,15
  15,UTM,TTANAL-BEGTTP
  ,ASN,64-2
 ,AOX,INFDR.
 ,AOX,TELINF.
 ,ATX,INFDR.
 13,VTM,INFDR.
 14,VJM,PHEXCH.
   :   ,24,3.
 15,UJ,.
  SWORKS:,BSS,1.ECTЬ BЫЗOB TTANAL
 SRPFL:,BSS,1.
  IW70V:,BSS,1
 TELINF:,LOG,140 0000.
 MDEFENC:,LOG,17 74000000.
 CM1:,OCT,77777777 77777776.
 DISPZRO:,OCT,77270707 00000172
 MEXCHFIX:,LOG,101.
 CLNP:,OCT,77760077 77777777.
 MSKPJOB:,OCT,0000077.
 NSJOBP:,OCT,0000024.
 MSKTMP0:,LOG,7777 7777 0400 0037
 MSKTMP1:,LOG,7777 7776 1000 1740
  :,BSS,
C
C
  PRT VP:,ENTRY,
  PRTVP:,BSS,4
 NJOB:,BSS,1.
 NLOWFLG:,BSS,1.
 NUPFLG:,BSS,1.
 NLP:,BSS,1.
 HOST:,BSS,1
 RST:,BSS,1
 FREE:,BSS,1
 LOWCNT:,BSS,1
 FMCNT:,BSS,1
 NFMCNT:,BSS,1
 ORP:,BSS,1
 INFW:,BSS,1.
 RFINFLG:,BSS,1.
 INFDR:,BSS,1.
  XOДOK:,BSS,1
 NMP:,BSS,1
 ,END,
 *PRT:,NAME,
 ,BSS,4
 RP1:,LOG,10
 RP2:,LOG,41
 ,END,
 *SWCMN:,NAME,.
 SWING:,SUBP,.
 *ИПД:LC,BLOCK,(1),XNFM(3),XNW
 NFM:,WEQ,XNFM
 NW :,WEQ,XNW
 SBUSYFLG:,OCT,.
 SWSCAL:,OCT,.
  :,LOG,.PAБ.ЯЧ. MAINBLCS И SWING
  :,LOG,.ШK.ЗAДAЧ, ЗAKPЫTЫX ПO OБMEHY
  :,LOG, 00054 00055 00056.SUP/UP/LOWPRT
 ,OCT,.
 ,OCT,.
 ,OCT,.
 CWJOB:,OCT,.
 STIME:,BSS,1.
 SWINGIF:,BSS,3.
 :,Z00,.
 ,Z00,SWING.
 ,OCT,.
 ,LOG,7.
  ,BSS,36B
 ,END,
 STOP:,NAME,.
C
C     BЫБPOC ЗAДAЧИ ПO ШИФPY
C
 *ИПД:LC,BLOCK,XNF(4),XNW
 ,CONT,XNC(2),XNSEM
 ,CONT,(34),OUTJOBSC(4),SCOUT
 ,CONT,(1),ROLOUTSC
  STARTCW:,EQU,XNF+45B
 SC/SWOUT:,EQU,XNF+46B
  SCEM*64:,EQU,XNF+61B
 SCENDJO:,EQU,XNF+77B
 NF:,WEQ,XNF
 NC:,WEQ,XNC
 NSEM:,WEQ,XNSEM
 NS1:,EQU,NSEM-1
 *ИПK1:,LC,1
 MONO:,EQU,*ИПK1+NC
 *YCЫ:LC,BLOCK,(1),RDSCAL
 SCALES:LC,BLOCK,(2),S1CLTA,STCLTA
 ,CONT,(5),SCSTOP
 ,CONT,SC/CLJ
 OUTCW:,LC,2
  STATUSMT:LC,BLOCK,(9),W05741(19),ШHГ(4)
 SMASAV:LC,BLOCK,SAVAC
C-----
 RETURN:,SUBP,
 FULSAV:,SUBP,
 SELECT:,SUBP,
 CLOMIR:,SUBP,
 GIVTRA:,SUBP,
 TELOUT:,SUBP,
C-----
 B30/16:,LC,1
 B16/1 :,LC,1
 C77777:,LC,1
 DISREG:,LC,1
 C377  :,LC,1
 C37   :,LC,1
C-----
 *677:B,BLOCK,BITS,BIT48,BIT47
 ,CONT,(7),BIT39
 ,CONT,(37),BIT1
C-----
 13,VTM,1
 STOP/NP:,ENTRY,
 ,AAX,C37
 ,UZA,HET
 ,NTR,3
 ,X-A,XNW
 ,ATI,14
 14,XTA,*YCЫ
 ,ATX,OUTCW
 ,AAX,B30/16
 ,UZA,HET
 15,VZM,SAVE
  ,XTA,S1CLTA
  14,AOX,BITS
  14,AEX,BITS
  ,ATX,S1CLTA
 14,XTA,BITS
  ,AEX,STARTCW
  14,AAX,BITS
 ,AOX,OUTJOBSC
 ,ATX,OUTJOBSC.
 13,VJM,FUL SAV
 13,VTM,SELECT
 ,XTA,=574
 OUTJOB:,ENTRY,
  15,VTM,R
 ,ITS,13
  ,XTS,OUTCW
  ,ASN,64+42
 ,ATI,13
 ,XTA,SCENDJO
 ,AOX,SC/SWOUT
  ,AOX,STARTCW
  ,AOX,SCEM*64
 13,AAX,BITS
 ,U1A,L RET
 ,XTA,OUTJOBSC
 15,ATX,
 ,ASN,64-6
  ,ITS,14
 ,XTS,BIT
 ,AAX,SCOUT
 ,AOX,RDSCAL
 ,ATX,RDSCAL
  15,VTM,STCLTA-SC/CLJ
  ,ITA,13
  ,ASN,64-15
  ,CALL,DEL TIMER
 CLE SC:,BSS,
 ,XTA,BIT
  15,AAX,SC/CLJ
  15,AEX,SC/CLJ
  15,ATX,SC/CLJ
 ,YTA,.
 ,AOX,RDSCAL.
 ,ATX,RDSCAL.
 15,VLM,CLE SC
  13,VTM,AFTINTAP
 14,VTM,3
 15,VTM,-3
  INITTAPE:,ENTRY,
  ,ITA,13
  ,ATX,ITRET
 SENORD:14,XTA,ШHГ-3
  ,ASN,64+8
  14,AOX,ШHГ-3
  ,AAX,C377
  ,UZA,NL1
 14,AOX,W05741-3
 14,ATX,W05741-3
 ,XTA,
 14,AT X,ШHГ-3
  15,CALL,TRA TAPE
  14,MTJ,15
  15,UTM,-6
 NL1:,BSS,
 14,UTM,1
 15,VLM,SENORD
  ,WTC,ITRET
  ,UJ,
  AFTINTAP:,BSS,
 ,XTA,OUTCW.
 ,ATI,15.
 ,ASN,64+42
 ,ATI,14
 15,VIM,ECTЬ ИПЗ
 14,XTA,BITS
 ,AOX,SC/SWOUT
 ,ATX,SC/SWOUT
 ,XTA,R
 14,AEX,MONO-NF
 ,AAX,C77777
 14,AEX,MONO-NF
 14,ATX,MONO-NF
 ,UJ,S RET
 ECTЬ ИПЗ:,BSS,
 15,XTA,3.
  15,ATX,4.И32
 ,XTA,R.
 15,ATX,3.
 ,XTA,DISREG.
 15,ATX,5.
 SRET:,BSS,
 ,XTA,I14
 ,ATI,14
 L RET:,BSS,
 ,WTC,RET
 ,UJ,
 HET:13,VIM,TT
 ,XTA,BIT1
 ,ATX,SAVAC
 ,UJ,RETURN
 TT:,BSS,
 14,VTM,TEKCT
 ,ITA,14.
 14,VTM,RETURN.
 ,UJ,TELOUT.
  TEKCT:,ISO,6HHET''''''
 SAVE:,BSS,
 ,XTA,ROLOUTSC. ПOCTABИTЬ
 ,U1A,HET
 14,AOX,BITS . BIT
 ,ATX,ROLOUTSC. ЗAДAЧИ
 ,UJ,RETURN.BЫXOД HA SELECT ПO BPEMEHИ
 R:,BSS,1.
 RET:,BSS,1
 BIT  :,BSS,1
 BIT/6:,BSS,1
 I14:,BSS,1
  ITRET:,BSS,1
    ,END,
          MACRO50:,NAME,
COCTABЛEHA A.И.CAЛTЫKOBЫM (OИЯИ)
C YЧACTИEM Л.Г.KAMИHCKOГO (ИФBЭ)
C BEPCИЯ 15.01.1975
C  KOЭФФИЦИEHTЫ ПOЛИHOMOB BЗЯTЫ
C  KHИГИ 'COMPUTER APPROXIMATIONS'
C  (ABTOPЫ J.F.HART И ДP., ИЗД-BO
C  JOHN WILEY AND SONS,NEW YORK,1968)
 EMULAT:,SUBP,.
 ERREXT:,SUBP,
 *ERRMAC:,EQU,ERREXT
 NRESCALL:,SUBP,
 NR/CODE:,SUBP,
 *27:,BLOCK,INFSQRT,INFASIN,INFALOG,INFEXP,INFERR
          *YCЫ:LC,BLOCK,Г Y C
          SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR
          ,CONT,SAVI15,SAVI14,SAVI13
          ,CONT,SAVMIR,SAVS16
          BIT48:,EQU,700B
          REAL1:,EQU,EXP0
          X:,EQU,SAVAC
          ARCSIN:,EQU,SAVAC
          NTR:,EQU,SAVSR
  *CB:LC,BLOCK,(13),INT0
  BIT5:,EQU,753B
  K COCEДY:,SUBP,
C
C---
C
          ,ATX,SAVAC
          ,ITA,14
          ,ASN,64+3
          ,U1A,*ERROR
          ,XTA,SAVAC
          14,UJ,*BEGIN
          MACRO51:,ENTRY,
          14,VZM,SIN*
          ,UJ,COS*
          *BEGIN:,BSS,
          14,VTM,*SQRT
          ,UJ,*SAV
          SIN*:,BSS,
          14,VTM,*SIN
          ,UJ,*SAV
          MACRO52:,ENTRY,
          COS*:,BSS,
          14,VTM,*COS
          ,UJ,*SAV
          MACRO53:,ENTRY,
          14,VTM,*ATAN
          ,UJ,*SAV
          MACRO54:,ENTRY,
          14,VTM,*ASIN
          ,UJ,*SAV
          MACRO55:,ENTRY,
          14,VTM,*ALOG
          ,UJ,*SAV
          MACRO56:,ENTRY,
          14,VTM,*EXP
          ,UJ,*SAV
          MACRO57:,ENTRY,
          14,VTM,*ENTIER
          ,UJ,*SAV
          *SAV:,BSS,
          ,ATX,X
          ,RTE,77B
          ,ATX,NTR
          ,NTR,
          ,ITA,13
          ,ATX,SAVI13
          ,ITA,15
          ,ATX,SAVI15
          ,XTA,X
          14,UJ,
C BЫЧИCЛEHИE SQRT(X)
C CPEДHEE BPEMЯ CЧETA = 60 MKCEK.
C MAKC. OTH. ПOГP. =1.5E-12
C KOPEHЬ ИЗBЛEKAETCЯ TOЧHO ИЗ BCEX
C X=N**2,ГДE 1.GE.N.LE.2**20
          *SQRT:,BSS,
          14,VTM,*END
          ,E+N,64
          *SQR:,BSS,
          ,ATX,X
          ,NTR,4
          14,UZA,
          ,NTR,16
          ,U1A,*ERRSQRT
          ,XTA,X
          ,E-X,X
          ,ATX,Y
          ,A*X,SQ2
          ,A+X,SQ1
          ,A*X,Y
          ,A+X,SQ0
          ,E+N,64+32
          ,ATX,R
          ,XTA,X
          ,ASN,64+1
          ,ATX,Z
          ,XTA,R
          ,E+X,Z
          ,ATX,Y
          ,XTA,Z
          ,NTR,18
          ,UZA,*SQ1
          ,XTA,Y
          ,A*X,SQRT2
          ,ATX,Y
          *SQ1:,XTA,X
          ,A/X,Y
          ,A+X,Y
          ,E+N,64-1
          ,ATX,Y
          ,XTA,X
          ,A/X,Y
          ,A+X,Y
          ,E+N,64-1
          14,UJ,
          *ERRSQRT:,BSS,
          14,VTM,INFSQRT
          ,UJ,*ERRMAC
C BЫЧИCЛEHИE  SIN(X)
C CPEДHEE BPEMЯ CЧETA = 55 MKCEK.
C MAKC. OTH. ПOГP. = 4.E-12
C BCEГДA ABS(SIN(X)).LE.1
C BCEГДA SIN(X)**2+COS(X)**2.LE.1.
          *SIN:,BSS,
          ,AVX,X
          ,A*X,*1/PI
          ,NTR,10
          ,U1A,*S3
          *S1:,BSS,
          ,NTR,3
          ,A+X,INT0
 ,NTR,18
          ,ATX,Y
          ,YTA,64-40
          ,ATX,Z
          ,XTA,Y
          ,ASN,64+8
          ,YTA,
          ,ATX,Y
          ,XTA,Z
          ,NTR,10
          14,V1M,*S4
          ,X-A,=R.5
          ,UJ,*S2
          *S4:,BSS,
          ,U1A,*S2
          ,X-A,REAL1
          *S2:,BSS,
          ,AVX,Y
          *S3:,BSS,
          ,E+N,64+1
          ,ATX,Z
          ,A*X,Z
          ,ATX,Z**2
          14,VTM,-5
          ,XTA,SIN6
          *SINL:,A*X,Z**2
          14,A+X,SIN0
          14,VLM,*SINL
          ,A*X,Z
          ,AVX,X
          ,UJ,*END
C BЫЧИCЛEHИE  COS(X)
C CPEДHEE BPEMЯ CЧETA = 55 MKCEK.
C MAKC. OTH. ПOГP. = 4.E-12
C BCEГДA ABS(COS(X)).LE.1
          *COS:,BSS,
          ,AVX,X
          ,ATX,X
          ,A*X,*1/PI
          14,VTM,
          ,UJ,*S1
C BЫЧИCЛEHИE ATAN(X)
C CPEДHEE BPEMЯ CЧETA = 90 MKCEK.
C MAKC. OTH. ПOГP. = 7.E-12
          *ATAN:,BSS,
          ,AVX,X
          ,ATX,Z
          ,XTA,
          ,ATX,Y
          ,XTA,Z
          ,E+N,64-1
          ,U1A,*AT1
          ,XTA,REAL1
          ,A/X,Z
          ,ATX,Z
          ,XTA,PI/2
          ,ATX,Y
          *AT1:,XTA,Z
          ,A*X,Z
          ,ATX,Z**2
      14,VTM,-2
      *QAT:,BSS,
      14,A+X,QATAN1
      ,A*X,Z**2
      14,VLM,*QAT
      ,A+X,QATAN0
          ,ATX,R
      14,VTM,-3
          ,XTA,PATAN4
      *PAT:,BSS,
      ,A*X,Z**2
      14,A+X,PATAN0
      14,VLM,*PAT
          ,A/X,R
          ,A*X,Z
          ,A-X,Y
          ,AMX,
          ,AVX,X
          ,UJ,*END
C BЫЧИCЛEHИE ASIN(X)
C CPEДHEE BPEMЯ CЧETA = 80 MKCEK.
C MAKC. OTH. ПOГP. = 7.E-12
          *ASIN:,BSS,
          ,ATX,ARG
          ,AVX,X
          ,ATX,Z
          14,VTM,BIT48
          ,NTR,8
          ,U1A,*AS1
          ,X-A,REAL1
          ,U1A,*ERRASIN
          ,E+N,64-1
          14,VJM,*SQR
          ,ATX,Z
          14,VTM,PI/2
          *AS1:,BSS,
          14,XTA,
          ,ATX,ARCSIN
          ,XTA,Z
          ,A*X,Z
          ,ATX,Z**2
      14,VTM,-2
      *QAS:,BSS,
      14,A+X,QASIN1
          ,A*X,Z**2
      14,VLM,*QAS
          ,A+X,QASIN0
          ,ATX,R
      14,VTM,-2
          ,XTA,PASIN3
      *PAS:,BSS,
          ,A*X,Z**2
      14,A+X,PASIN0
      14,VLM,*PAS
          ,A/X,R
          ,A*X,Z
          ,E+X,ARCSIN
          ,A-X,ARCSIN
          ,AMX,
          ,AVX,ARG
          ,UJ,*END
          *ERRASIN:,BSS,
          14,VTM,INFASIN
          ,UJ,*ERRMAC
C BЫЧИCЛEHИE ALOG(X)
C CPEДHEE BPEMЯ CЧETA = 60 MKCEK.
C MAKC. OTH. ПOГP. = 3.E-12
C ALOG(1.) B TOЧHOCTИ PABEH 0.
          *ALOG:,BSS,
          ,AVX,SIN1
          ,UZA,*ERRLOG
          ,ATX,X
          ,E-X,X
          ,ATX,Y
          ,A-X,SQRT2/2
          ,ATX,Z
          ,A+X,SQRT2
          ,A/X,Z
          ,ATX,Z
          ,A*X,Z
          ,ATX,Z**2
          14,VTM,-4
          ,XTA,ALOG5
          ,NTR,2
          *ALOGL:,BSS,
          ,A*X,Z**2
          14,A+X,ALOG0
          14,VLM,*ALOGL
          ,A*X,Z
          ,A-X,LN2/2
          ,ATX,R
          ,XTA,X
          ,AAX,=7740 0000 0000 0000
          ,ASN,64+7
          ,AEX,=4320 0000 0000 0000
          ,A*X,LN2
          ,A+X,R
          ,UJ,*END
          *ERRLOG:,BSS,
          14,VTM,INFALOG
          ,UJ,*ERRMAC
C BЫЧИCЛEHИE  EXP(X)
C CPEДHEE BPEMЯ CЧETA = 65 MKCEK.
C MAKC. OTH. ПOГP. = 5.E-12
          *EXP:,BSS,
          ,A*X,*1/LN2
          ,ATX,X
          ,A-X,=R63.
          ,UZA,*ERREXP
          ,A+X,=R127.
          ,U1A,*CZERO
          ,XTA,X
          ,NTR,3
          ,A+X,INT0
          ,ATX,Z
          ,NTR,
          ,YTA,64-41
          ,E+N,64
          ,ATX,Y
          ,XTA,Z
          ,ASN,64+7
          ,YTA,
          ,AEX,BIT48
          ,ATX,Z
          14,VTM,-6
          ,XTA,EXP7
          *EXPL:,A*X,Y
          14,A+X,EXP0
          14,VLM,*EXPL
          ,ATX,R
          ,A*X,R
          ,E+X,Z
          ,UJ,*END
          *CZERO:,XTA,
          ,UJ,*END
          *ERREXP:,BSS,
          14,VTM,INFEXP
          ,UJ,*ERRMAC
C BЫЧИCЛEHИE ЦEЛOЙ ЧACTИ X
C CPEДHEE BPEMЯ CЧETA = 25 MKCEK.
          *ENTIER:,BSS,
          ,NTR,3
          ,A+X,INT0
          ,NTR,
          ,E+N,64
 *END:,XTR,NTR
 ,UJ,END*
C
C   ,*50,8 - ЮЗEPY BЫДAETCЯ ПEPECEЧEHИE
C            ПYЛЬTOBOГO CЛOBA C MACKOЙ,
C   ЗAДAHHOЙ HA CYMMATOPE. MЛAДШИE БИTЫ
C   PEЗYЛЬTATA KOПИPYЮTCЯ HA 14 PEГИCTP.
C   PAЗPЯДЫ ПYЛЬTOBOГO CЛOBA,COOTBETC-
C   TBYЮЩИE MACKE,ГACЯTCЯ.
C
 *ERROR:,ASN,64+1
 ,U1A,*ERROR1
 ,XTA,SAVAC
 14,UTM,-8
 14,V1M,NRCODE
 ,WTC,Г Y C
 14,VTM,113B
 14,AAX,
 14,AEX,
 14,ATX,
 ,YTA,
 ,ATI,14
 END*:,MTJ,27B
 2,IJ,
 NRCODE:,XTA,INFCODE
 ,UJ,NRESCALL
 INFCODE:,Z00,NR/CODE
 ,,13
 *ERROR1:,BSS,
  ,ITA,14
  ,AEX,BIT5
  ,U1A,*ERROR2
C
C...   ,*50,16  - OБPAЩEHИE K COCEДHEЙ
C      MAШИHE.  COOБЩEHИE - HA CYMMATOPE.
C      OTBET COCEДA - TAM ЖE.
C
  13,MTJ,14
  ,XTA,SAVAC
  ,CALL,K COCEДY
  14,MTJ,13
  ,UJ,END*
C----
  *ERROR2:,BSS,
 :,XTA,*+1. ПPOБЫ HA
 ,UJ,EMULAT.ИHTEPПPET.
 :8,,.БИT ЭK50
 ,Z00,*+1.BOЗBPAT
 13,MTJ,16
 ,CALL,SAVEMOD
          14,VTM,INFERR
 ,UJ,*ERRMAC
          SQRT2:,LOG,4053 2404 7463 1772
          SQRT2/2:,LOG,4013 2404 7463 1772
          LN2:,LOG,4013 0562 0577 3722
C  LN2/2 ПOДПPABЛEHA,ЧTOБЫ ALOG(1.)=0.
      LN2/2:,LOG,3753 0562 0577 3721
          *1/LN2:,LOG,4053 4252 1662 4534
          *1/PI:,LOG,3752 1371 4066 7117
C  KOЭФФ. ДЛЯ SQRT(C.APPROX.,TAБЛ. 130)
  SQ2:,LOG,3722 7260 1675 0030
  SQ1:,LOG,4016 1743 6052 7114
  SQ0:,LOG,3752 0213 6707 6726
C  KOЭФФ. ДЛЯ  SIN(C.APPROX.,TAБЛ.3343)
  SIN6:,LOG,2416 5166 1513 5220
  SIN5:,LOG,2720 7264 0601 3034
  SIN4:,LOG,3212 4073 3764 7661
  SIN3:,LOG,3466 3226 4664 4717
  SIN2:,LOG,3652 1465 7063 3344
  SIN1:,LOG,4025 5242 0614 7334
          SIN0:,BSS,
          PI/2:,LOG,4054 4417 6652 1041
C  KOЭФФ. ДЛЯ ATAN(C.APPROX.,TAБЛ.5096)
  PATAN4:,LOG,3710 7122 3773 3234
  PATAN3:,LOG,4157 0706 2006 5256
  PATAN2:,LOG,4315 6767 6144 3655
  PATAN1:,LOG,4356 6662 3433 5452
  PATAN0:,LOG,4351 2633 7131 4703
  QATAN3:,LOG,4251 3705 3401 4651
  QATAN2:,LOG,4353 0352 7361 3334
  QATAN1:,LOG,4410 7710 4234 6022
  QATAN0:,LOG,4351 2633 7131 4705
C  KOЭФФ. ДЛЯ ASIN(C.APPROX.,TAБЛ.4696)
  PASIN3:,LOG,4262 0677 6731 1156
  PASIN2:,LOG,4417 1167 0356 4207
  PASIN1:,LOG,4527 5105 1307 5667
  PASIN0:,LOG,4452 4054 0673 1770
  QASIN3:,LOG,4323 1635 5347 6645
  QASIN2:,LOG,4451 6736 0762 2544
  QASIN1:,LOG,4526 6101 3770 1013
  QASIN0:,LOG,4452 4054 0673 1770
C  KOЭФФ. ДЛЯ ALOG(C.APPROX.,TAБЛ.2664)
  ALOG5:,LOG,3714 5022 4042 0440
  ALOG4:,LOG,3716 1365 6574 3216
  ALOG3:,LOG,3751 1112 4004 6421
  ALOG2:,LOG,3754 6314 6234 5725
  ALOG1:,LOG,4012 5252 5252 6026
  ALOG0:,LOG,4110 0000 0000 0000
C  KOЭФФ. ДЛЯ EXP (C.APPROX.,TAБЛ.1024)
  EXP7:,LOG,3051 4007 7760 5675
  EXP6:,LOG,3211 7406 7125 7531
  EXP5:,LOG,3352 7345 6034 3024
  EXP4:,LOG,3511 6624 3002 3033
  EXP3:,LOG,3616 1530 2351 5710
  EXP2:,LOG,3717 2775 7375 6445
  EXP1:,LOG,4013 0562 0577 4000
  EXP0:,LOG,4050 0000 0000 0000
          Y:,BSS,1
          Z:,BSS,1
          Z**2:,BSS,1
          R:,BSS,1
 ARG:,BSS,1
          ,END,
 NRESCODE:,NAME,
C
C***************** E.Д.ФEДЮHЬKИH 3/08/80
C*
C*   ,*50,9 - KOMAHДA, ЗAДAHHAЯ B MЛAД-
C*            ШИX БИTAX CYMMATOPA, ПPE-
C*   OБPAЗYETCЯ B ФOPMAT ABTOKOДA MADLEN.
C*   PEЗYЛЬTAT (B KOДE ISO) ЗAHИMAET 12
C*   БAЙTOB И PACПOЛOЖEH HA CYMMATOPE
C*   (HAЧAЛO) И B PEГИCTPE MЛAДШИX PAЗ-
C*   PЯДOB (ПPOДOЛЖEHИE). PEЗYЛЬTAT ИMEET
C*   BИД:
C*           MM,KKK AAAAA
C*
C*   MM -    MOДИФИKATOP (ДECЯTИЧHЫЙ)
C*   KKK -   KOП (MHEMOHИKA)
C*   AAAAA - AДPEC, MOЖET БЫTЬ ДECЯTИЧ-
C*           HЫЙ ИЛИ BOCЬMEPИЧHЫЙ (OKAH-
C*           ЧИBAETCЯ БYKBOЙ B), MOЖET
C*           COДEPЖATЬ ЗHAK MИHYC.
C*   ECЛИ AДPEC OKAЗAЛCЯ ДЛИHHЫЙ И CYФ-
C*   ФИKC 'B' HE YMECTИЛCЯ B 12 БAЙTOB,
C*   TO ПPИ BЫXOДE ИЗ ЭKCTPAKOДA 14 PEГ
C*   PABEH 1, B OCTAЛЬHЫX CЛYЧAЯX OH
C*   PABEH 0.
C*
C*************** A.П.CAПOЖHИKOB 22/12/80
C*
C*   ,*50,12 - PACПOЗHABATEЛЬ TEKCTOBOЙ
C*              CTPOKИ ( DECODER ).
C*   CTPOKA ПOДAETCЯ B ISO ИЛИ B COSY .
C*   ПPИЗHAK KOHЦA - БAЙT '000' ИЛИ '012'.
C*   ИHФOPMAЦИЯ ДЛЯ ЭKCTPAKOДA HA CYMMA-
C*   TOPE :
C*   1-15,21-24 P. - ИHДEKCИPOBAHHЫЙ AДPEC
C*   HAЧAЛA CTPOKИ ИЛИ  0,  ECЛИ PAБOTA C
C*   TEKYЩEГO MECTA CTPOKИ.
C*   16 - ПPИЗHAK ПOГЛOЩEHИЯ ПPOБEЛOB
C*   17 - CИMBOЛЫ '*' И '/' CYTЬ БYKBЫ.
C*   18 - BOCЬMEPИЧHЫE ЧИCЛA ЗAДAЮTCЯ
C*        БEЗ CYФФИKCA "B"
C*   19 - ПOCИMBOЛЬHOE CKAHИPOBAHИE
C*   PEЗYЛЬTATOM PAБOTЫ ЯBЛЯETCЯ TИП ФPAГ-
C*   MEHTA B И.P.14  И CAM ФPAГMEHT. ПPO-
C*   БEЛЫ B HAЧAЛE ФPAГMEHTA TИПA "ЧИCЛO"
C*   BCEГДA CГЛATЫBAЮTCЯ. ECЛИ ФPAГMEHT -
C*   ЧИCЛO, TO ЭTO ЧИCЛO BЫДAETCЯ HA CYM-
C*   MATOPE, A B  PMP  BЫДAETCЯ (1-8P.)
C*   KOД OГPAHИЧИTEЛЯ И (25-33P.) ПOЗИЦИЯ
C*   ЭTOГO OГPAHИЧИTEЛЯ BO BXOДHOЙ CTPOKE.
C*   ECЛИ ФPAГMEHT - ИДEHTИФИKATOP ИЛИ
C*   TEKCT, ЗAKЛЮЧEHHЫЙ B AПOCTPOФЫ, TO
C*   OH BЫДAETCЯ HA CYMMATOPE (HAЧAЛO) И
C*   B  PMP (ПPOДOЛЖEHИE). XBOCT TEKCTA
C*   ЗAПOЛHЯETCЯ ПPOБEЛAMИ. ECЛИ TEKCT
C*   БOЛEE 12 CИMBOЛOB, TO ЭTOT ФAKT ЗAПO-
C*   MИHAETCЯ, И OCTATOK TEKCTA БYДET
C*   BЫДAH ПPИ CЛEДYЮЩEM OБPAЩEHИИ.
C*   BOЗMOЖHЫE ЗHAЧEHИЯ И.P.14 :
C*    0 - OШИБKA, ФPAГMEHT HE PACПOЗHAH
C*    1 - BOCЬMEPИЧHOE (123B, 99D, -10B)
C*    2 - ЦEЛOE ( 8000, -999 )
C*    3 - BEЩECTBEHHOE (3.62, -3.141E-3)
C*    4 - ИДEHT. ИЛИ TEKCT B AПOCTPOФAX
C*    5 - TO ЖE, HO ДЛИHOЙ > 12 CИMBOЛOB
C*    6 - ПYCTOЙ ФPAГMEHT
C*   B PEЖИME ПOCИMBOЛЬHOГO CKAHИPOBAHИЯ
C*   TEKYЩИЙ CИMBOЛ CTPOKИ BЫДAETCЯ HA
C*   CYMMATOPE (ПPИЖAT BЛEBO И ДOПOЛHEH
C*   ПPOБEЛAMИ) И B 1-8 PP. PMP.
C*   B 25-33 PP. PMP BЫДAETCЯ HOMEP ПOЗИЦИИ
C*   CИMBOЛA B CTPOKE. ПPOБEЛЫ ПPИ HEOБXO-
C*   ДИMOCTИ ПOГЛOЩAЮTCЯ.
C*   TИП CИMBOЛA BЫДAETCЯ B И.P.14:
C*    0 - KOHEЦ CTPOKИ ('000','012')
C*    1 - ЦИФPA ( 0 - 9 )
C*    2 - БYKBA ( A-Z-Я, ПO ЗAKAЗY: / , * )
C*    3 - PAЗДEЛИTEЛЬ (HE ЦИФPA И HE БYKBA)
C*
C*
C*
C*   ,*50,K , ГДE K = 13,14,15 - ENCODER
C*            ФOPMATHЫE ПPEOБPAЗOBAHИЯ
C*            ИЗ ДBOИЧHOГO KOДA B ISO.
C*   ИHФOPMAЦИЯ HA CYMMATOPE :
C*   25-39,45-48 - ИHДEKCИP.AДPEC BINARY
C*    1-15,21-24 - ИHДEKCИP.AДPEC BЫXOД-
C*    HOЙ CTPOKИ ИЛИ  0, ECЛИ PEЗYЛЬTAT
C*    ПИШETCЯ C TEKYЩEЙ ПOЗИЦИИ BЫXOДHOЙ
C*    CTPOKИ.
C*   40-44 - N : ЧИCЛO ПOЗИЦИЙ ДЛЯ PAЗ-
C*    MEЩEHИЯ ПOЛYЧEHHOГO TEKCTOBOГO
C*    ФPAГMEHTA.
C*   16-19 - M : ЧИCЛO ЦИФP MAHTИCCЫ.
C*   20 - T : TИП HOPMAЛИЗAЦИИ TEKCTA
C*    ЧИCЛA BHYTPИ CBOEГO  N-ПOЛЯ :
C*    ( 1 - BПPABO, 0 - BЛEBO ).
C*
C*   K=13 - CПEЦИФИKAЦИЯ H : ПEPEHOC B
C*   BЫXOДHYЮ CTPOKY N CИMBOЛOB BXOДHOЙ
C*   CTPOKИ BINARY. T HECYЩECTBEHHO.
C*   ПPИ M=0 CИMBOЛЫ C KOДAMИ <40B
C*   ЗAMEHЯЮTCЯ HA ПPOБEЛЫ.
C*
C*   K=14 - CПEЦИФИKAЦИЯ O : ПPEOБPA-
C*   ЗOBAHИE BINARY ПO ФOPMATY  O<N>
C*   CO BCTABKOЙ OДHOГO ПPOБEЛA ПOCЛE
C*   KAЖДЫX M BOCЬMEPИЧHЫX ЦИФP.
C*
C*   K=15 - CПEЦИФИKAЦИЯ G : ПPEOБPA-
C*   ЗOBAHИE ПO ФOPMATY  I<N> ECЛИ M=0,
C*   ИHAЧE ПO ФOPMATY  F<N>.<M> , A
C*   ECЛИ HE BЛEЗAEM B PAЗMEP ПOЛЯ, TO
C*   ПO ФOPMATY  E<N>.<M> .
C*   ECЛИ ЗAДAHO M>12, ЧИCЛO БEЗYCЛOBHO
C*   BЫДAETCЯ ПO E-ФOPMATY.
C*
C*   PEЗYЛЬTAT PAБOTЫ ДЛЯ BCEX TPEX
C*   ЭKCTPAKOДOB: CYMMATOP - ДЛИHA
C*   BЫXOДHOЙ CTPOKИ B CИMBOЛAX, И.P.14
C*   = 1, ECЛИ ПPEBЫШEH PAЗMEP ПOЛЯ,
C*   ИHAЧE И.P.14 = 0 .
C*   B KAЖДЫЙ MOMEHT BPEMEHИ ПOCЛEДHEE
C*   CЛOBO BЫXOДHOЙ CTPOKИ ДOПOЛHEHO ДO
C*   KOHЦA ПPOБEЛAMИ.
C*
C***************************************
C*
 *YCЫ:LC,BLOCK,ГYC
 SMASAV:LC,BLOCK,SAVAC,SAVSR(2),SAVI15,SAVI14,SAVI13
  C3:,LC,1
  C5:,LC,1
 C7:,LC,1
 C14:,LC,1
  C37:,LC,1
  C77:,LC,1
 C377:,LC,1
  C777:,LC,1
 C7777:,LC,1
 C77777:,LC,1
 B24/1:,LC,1
 FULWOR:,LC,1
  BC1700:,SUBP,
  C50:,EQU,BC1700+5
  C60:,EQU,BC1700+6
  *C:LC,BLOCK,C6
  *CB:LC,BLOCK,(1),C17
 NR/CODE:,SUBP,
 NRESOFF:,SUBP,
 ERRNRES:,SUBP,
  *677:B,BLOCK,BITS
  ,CONT,BIT48,BIT47,BIT46,BIT45
  ,CONT,BIT44,BIT43,BIT42,BIT41
  ,CONT,BIT40,BIT39,BIT38,BIT37
  ,CONT,BIT36,BIT35,BIT34,BIT33
  ,CONT,BIT32,BIT31,BIT30,BIT29
  ,CONT,BIT28,BIT27,BIT26,BIT25
  ,CONT,BIT24,BIT23,BIT22,BIT21
  ,CONT,BIT20,BIT19,BIT18,BIT17
  ,CONT,BIT16,BIT15,BIT14,BIT13
  ,CONT,BIT12,BIT11,BIT10,BIT9
  ,CONT,BIT8, BIT7, BIT6, BIT5
  ,CONT,BIT4, BIT3, BIT2, BIT1
  *135:B,BLOCK,S*COUNT,SYM,CONTI
  ,CONT,SAVE(0),REZAC,R15,FILD
  ,CONT,R14,R13,R27,R11
  ,CONT,ACC,BIN
  ,CONT,W1,W2,W3,W4,W5,W6,W7,W8
  ,CONT,COSY
  COUNT:,EQU,W8
  STAT:,EQU,R14
  CHAR:,EQU,W4
  CMAN:,EQU,W5
  OCT:,EQU,W6
  STAR:,EQU,52B
  MINUS:,EQU,55B
  PLAS :,EQU,53B
  POIN :,EQU,56B
  APOS :,EQU,47B
  LF   :,EQU,12B
  KILBL :,EQU,BIT40
  LET*/ :,EQU,BIT41
  SBABS:,EQU,BIT42
  WORS:,EQU,BIT43
C
C---
C
  START:13,REL,START
 ,WTC,Г Y C
 15,VTM,SAVE+1
 ,XTA,SAVI15
 ,AEX,SAVSR
 ,ITS,
 15,ATX,
 ,ITS,32B
 ,ASN,64-15
 ,AEX,SAVI13
 ,ITS,12
 ,ASN,64-15
 ,ITS,27B
 15,AEX,
 ,ITS,11
  ,XTS,SAVAC
  ,WTC,SAVI14
  14,VTM,
  ,NTR,3
  :,24,3
  11,VTM,
  14,UJ,*
 :,AAX,B24/1
 ,UJ,KOPISO
 :15,XTA,
  ,UJ,RET
  :15,XTA,
  ,UJ,RET
  :,ASN,64-24
  ,UJ,MAKADR
  :11,VTM,H/ENCOD-DECOD
  ,UJ,MAKADR
  :11,VTM,B/ENCOD-DECOD
  ,UJ,MAKADR
  :11,VTM,G/ENCOD-DECOD
  ,UJ,MAKADR
 KOPISO:15,ATX,
 ,AAX,BIT20
 12,VTM,
 ,U1A,LONG
 ,XTA,AMASK
 15,AAX,-1
 15,ATX,-6
 15,AEX,
 ,ASN,64+12
 15,ATX,
 ,AAX,C377
 15,ATX,
 ,A-X,C50
 ,UZA,EX
 RLON:,ASN,64+1
 ,ATI,14
 ,YTA,
 ,UTC,S
 14,ARX,24B
 14,UTM,2
 ,UZA,RC
 ,ASN,64+24
 RC:,AAX,B24/1
 ,AEX,BLL
 :,UTC,*+1
 14,VLM,
 :,UTC,*+1
 14,VLM,
 REX:15,STX,-9
 15,AEX,
 ,UZA,REG
 ,A-X,C5000
 ,U1A,LM
 ,UTC,F2-F1
 LM:,ARX,F1
 ,ASN,64-24
 15,AEX,-7
 15,ATX,-7
 REG:15,XTA,-5
 ,UZA,ZA
 ,AAX,BIT19
 ,UTC,NOMI
 12,V1M,
 ,UTC,ADR
 14,V1M,
 ,U1A,NOMIS
 15,XTA,-5
 ,ASN,64+4
 ,U1A,ADRPL
 15,XTA,-5
 ,ASN,64-8
 ,A-X,C5000
 ,UZA,HJ
 ,ARX,F1
 ,AEX,C14
 ,ASN,64-24
 ZA:,AEX,BL
 15,STX,-5
 RET:11,UTC,
 11,V1M,
  RETNR:,ATI,11
 ,ITA,13
 ,ARX,OFF
 ,UJ,NRESOFF
 OFF:,Z00,NR/CODE
 ,Z00,OUT-START
 OUT:15,XTA,
 ,ATI,27B
 ,ASN,64+15
 ,STI,12
 ,ATI,13
 ,ASN,64+15
 ,STI,32B
 ,STI,14
 ,AEX,
 15,XTA,-2
 15,XTR,-1
 15,WTC,
 15,VTM,
 2,IJ,
 HJ:,AEX,F2
 ,AEX,C14
 ,ASN,64-16
 ,UJ,ZA
 SJ:,XTA,CSJ
 ,UJ,REX
 EX:,ASN,64-1
 ,AEX,C50
 14,VTM,1
 ,UZA,SJ
 ,XTA,C7
 15,AAX,-1
 15,ATX,-9
 15,AEX,-1
 ,ASN,64-5
 15,AEX,-9
 ,AEX,C*
 ,UJ,REX
 ADRPL:15,XTA,-5
 ,UJ,ADR1
 ADR:,U1A,NGA
 15,XTA,-5
 ADR1:,XTS,ZMASK
 15,STX,-6
 14,VTM,16
 12,VTM,3
 ADRN:,ASN,64+3
 ,UZA,L7
 CY:,ASN,64+3
 14,UTM,8
 12,UTM,3
 ,U1A,CY
 ,E+N,171B
 14,ASN,64
 15,AEX,-5
 15,UTM,1
 15,STX,-6
 12,ASN,64
 ,YTA,
 ,AUX,PMASK
 RL7:15,AEX,-5
 ,AEX,BL
 ,XTS,FULWOR
 14,ASN,64-40
 15,AAX,
 ,UJ,ZA
 L7:15,UTM,1
 15,XTA,
 14,ASN,64
 ,YTA,
 14,UTM,-8
 ,UJ,RL7
 TOADRN:15,XTA,
 ,UJ,ADRN
 NGA:15,AEX,-5
 ,UZA,NOMIS
 ,AEX,C7777
 ,ARX,BIT1
 ,XTS,MMASK
 15,STX,-6
 ,ASN,64+9
 14,VTM,24
 12,VTM,6
 15,UTM,1
 ,UZA,TOADRN
 15,XTA,
 NB:,ASN,64+15
 ,YTA,
 ,AUX,PMASK
 15,AEX,-5
 15,ATX,-5
 ,XTA,BIT1
 15,STX,-4
 ,UJ,RET
 NOMIS:14,VTM,70000B
 ,ITA,14
 NOMI:15,AEX,-5
 ,XTS,ZMASK
 15,STX,-6
 ,UJ,NB
 LONG:,XTA,C77777
 15,AAX,-1
 15,ATX,-6
 15,AEX,
 ,AEX,BIT20
 ,ASN,64+12
 15,ATX,
 ,AAX,C377
 15,ATX,
 ,ASN,64+3
 15,XTS,-8
 ,ASN,64+12
 ,UZA,LONG1
 ,AEX,C7
 ,U1A,LONG2
 ,XTA,BMASK
 15,ARX,-8
 15,ATX,-8
 LONG1:15,XTA,
 ,UJ,RLON
 LONG2:12,VTM,1
 ,UJ,LONG1
C
C---   PAЗБOPKA ИHФ. CЛOBA:
C
  MAKADR:,BSS,
  15,UTM,-ACC
  15,ATX,ACC
  15,XTA,S*COUNT
  14,VTM,-1
  MADR:,BSS,
  ,ASN,64-24
  15,ATX,COUNT
  ,YTA,
  15,AEX,COUNT
  15,ATX,COUNT
  15,XTA,ACC
  ,ASN,64-24
  15,ATX,ACC
  ,YTA,
  15,AEX,ACC
  15,ATX,ACC
  ,ASN,64+15
  ,AAX,C37
  14,UTC,1
  15,ATX,FILD
  15,XTA,ACC
  ,ASN,64+20
  ,AAX,C17
  15,ATX,REZAC
  ,UZA,MODIF
  ,AEX,C17
  ,UZA,M15
  ,AEX,BIT1
  ,UZA,ERROR
  ,AEX,C3
  ,UZA,M13
  ,AEX,C6
  ,UZA,M11
  15,WTC,REZAC
  ,ITA,
  MODIF:15,ARX,ACC
  ,AAX,C77777
  ,UZA,CONT
  15,AEX,COUNT
  15,ATX,W1
  ,ITA,11
  :,U1A,*+1
  15,ATX,CONTI
  :15,XTA,W1
  ,AAX,B24/1
  CONT:,BSS,
  15,AEX,COUNT
  14,VLM,MADR
  15,ATX,COUNT
  11,VZM,DECOD
  ,ASN,64+24
  ,ATI,14
  15,XTA,FILD+1
  ,AAX,C17
  15,ATX,FILD+1
  15,WTC,R27
  :,24,
  14,XTA,
  :,24,3
  15,ATX,BIN
  ,XTA,
  15,ATX,COSY
  15,ATX,W4
  11,UJ,DECOD
  M15:15,XTA,R15
  ,UJ,MODIF
  M13:15,XTA,R13
  ,UJ,MODIF
  M11:15,XTA,R11
  ,UJ,MODIF
C
C  PUTS: ЗACЫЛKA CИMBOЛA B BЫX.CTPOKY
C        OБPAЩEHИE ПO 11 PEГ. CИMBOЛ
C        ПOДAETCЯ B MЛ.PAЗP.CYMMATOPA
C        ПOPTЯTCЯ SYM,W1,W2,W3,12,14 PEГ.
C  GETS: BЫБOPKA CИMBOЛA ИЗ BXOДHOЙ CTPOKИ
C        ПOPTЯTCЯ COSY,W1,W2,W3,12,14 PEГ.
C        CИMBOЛ - B SYM И HA CYMMATOPE.
C        TEKYЩEE CЛOBO BX.CTPOKИ - B BIN.
C
  GETS:15,XTA,COSY
  ,UZA,GETS1
  ,NTR,3
  ,A-X,BIT1
  GBL1:15,ATX,COSY
  ,XTA,BIT6
  15,ATX,SYM
  11,UJ,
  SPUT:,ITA,14
  ,UJ,PUTS
  PUTDIG:11,VTM,DIGIT
  PUTS:15,ATX,SYM
  ,UTC,1
  GETS1:,XTA,GWOR
  15,ATX,W1
  15,XTA,COUNT
  15,ASX,W1
  15,ATX,W2
  ,ASN,64+15
  ,AAX,C777
  15,ATX,W3
  ,NTR,3
  ,A*X,C1/6
  ,ATI,14
  15,WTC,W2
  14,UTM,.AДPEC
  ,ASN,64-1
  15,ATX,W2
  ,ASN,64-1
  15,ARX,W2
  15,A-X,W3
  ,ASN,64-3
  15,ATX,W3.CДBИГ=0,8,16...
  15,WTC,W1
  12,VTM,-BIT40
  12,XTA, BIT40
  15,ARX,COUNT
  15,ATX,COUNT
  15,WTC,R27
  :,24,
  14,XTA,
  :,24,3
  12,VIM,PUT
  :15,WTC,W3
  ,ASN,64+40
  ,AAX,C377
  15,ATX,SYM
  ,AAX,BIT8
  ,UZA,GETS2
  15,AEX,SYM
  ,UJ,GBL1
  GETS2:15,XTA,SYM
  11,UJ,
  PUT:15,ATX,W1
  15,XTA,W3
  ,AVX,BIT41
  15,ATX,W3
  ,AEX,
  ,U1A,PUT1
  ,XTA,BL
  15,ATX,W1
  PUT1:15,XTA,SYM
  ,AEX,BIT6
  15,WTC,W3
  ,ASN,64-40
  15,AEX,W1
  15,WTC,R27
  :,24,
  14,ATX,
  :,24,3
  11,UJ,
  GWOR:11,Z00,
  ,Z00,BIT40
  :8,Z00,
  ,Z00,BIT16
  DECOD:,BSS,
  15,XTA,CONTI
  ,AAX,BIT46
  15,ATX,CHAR
  ,U1A,TEXTID
  15,ATX,REZAC
  15,ATX,SYM
  15,ATX,COSY
  15,XTA,CONTI
  ,AAX,C6
  15,ATX,STAT
  ,U1A,EXIT
  15,ATX,OCT
  15,ATX,CMAN
  15,ATX,CONTI
  15,XTA,ACC
  ,AAX,WORS
  ,U1A,ALONE
  15,ATX,W7
  11,VJM,GETS
  CH BL:,BSS,
  ,AEX,BIT6.ЛEBЫE
  ,UZA,GETS.ПPOБEЛЫ
  11,UTM,ANAL-CHBL
  ,UJ,AN1
  TEXTID:,BSS,
  15,AEX,CONTI
  15,ATX,CONTI
  ,AOX,BIT3.IDENT
  15,ATX,STAT
  ,XTA,BL
  15,ATX,REZAC
  15,ATX,FILD
  ALONE:11,VJM,GETS
  ANAL:,BSS,
  15,AOX,CONTI
  ,AEX,BIT6
  ,U1A,AN1
  15,XTA,ACC
  ,AAX,KILBL
  ,U1A,GETS
  AN 1:,BSS,
  14,VTM,TABS-1
  15,XTA,SYM
  ,UZA,IS LF
  ,AEX,=12
  ,U1A,AN/*
  IS LF:14,UTM,KLF-TABS+1
  ,XTA,C6.ПPИЗHAK:
  15,ATX,CONTI.KOHEЦ CTPOKИ
  ,UJ,ANAL W
  AN/*:,BSS,
  15,XTA,ACC
  ,AAX,LET*/
  ,U1A,AN2
  14,UTM,2
  AN 2:,BSS,
  AN 3:14,UTM,1
  14,XTA,
  ,AAX,C377
  15,A-X,SYM
  ,U1A,AN3
  14,XTA,
  ,ASN,64+8
  ,AAX,C377
  15,X-A,SYM
  ,U1A,AN3
  ANAL W:15,XTA,ACC
  ,AAX,WORS
  ,UZA,ENTAB
  14,XTA,
  ,ASN,64+16
  ,AAX,C3
  15,ATX,STAT
  15,XTA,SYM
  ,ASN,64-40
  ,AEX,BL
  ,AEX,BIT46
  ,UJ,EX/REZ
  ENTAB:15,WTC,STAT
  ,XTA,TSS
  14,ASX,
  ,AAX,C77
  ,UZA,ERRN
  ,AEX,C77
  ,U1A,ENT1
  15,XTA,W7
  ,UZA,SET O.OCTAL
  ,UJ,ETEX2.KOHEЦ TEXT
  ENT1:,AEX,C77.HOPMAЛЬHO
  ,ASN,64+3
  15,ATX,STAT
  ,YTA,
  ,ASN,64+45
  ,ATI,12
  15,XTA,SYM
  ,ATI,14
  12,UJ,SWIST
  TABS:,BSS,
  ,ISO,6H'200'**'2'**
  ,ISO,6H'200'//'2'//
  ,ISO,6H'244'EE'2'EE
  ,ISO,6H'200'БY'2'AZ
  ,ISO,6H'200'БY'2''140''176'
  ,ISO,6H'214'ЦИ'1'09
  ,ISO,6H'260'TЧ'3'..
  ,ISO,6H'274'++'3'++
  ,ISO,6H'274'--'3'--
  ,ISO,6H'310'AP'3''47''47'
  ,ISO,6H'230'OГ'3''''377'
  KLF:,ISO,6H'324'LF''''''
  TSS:,BSS,
C
C    ПO BEPTИKAЛИ - COCTOЯHИЯ
C    ПO ГOPИЗOHTAЛИ - CИMBOЛЫ
C
C                  LF '  +- .  E  OГ ЦИ БY
C            -----:--:--:--:--:--:--:--:--:
  0,LOG,67 54 60 67 44 67 11 44 .ПYCTO
L  1,LOG, 37 00 37 20 73 37 11 17 .ЦEЛOE
L  2,LOG, 27 00 27 00 73 27 21 00 .F-ФOPMAT
L  3,LOG, 57 00 57 00 00 57 36 00 .E-ФOPMAT
L  4,LOG, 47 00 47 47 45 47 45 45 .IDENT
L  5,LOG, 00 47 55 55 55 55 55 55 .TEXT
L  6,LOG, 07 07 07 00 07 07 11 07 .ЗHAK ЧИCЛA
L  7,LOG, 00 00 30 00 00 00 36 00 .ЗHAK EXP
L  10,LOG,77 00 77 77 00 77 00 00. ФИHИШ
C
C    HA ПEPECEЧEHИИ:
C    STN (6-4) - HOBOE COCTOЯHИE
C    SW  (3-1) - ПEPEKЛЮЧATEЛЬ
C                ИЛИ 00, ECЛИ OШИБKA
C
  SWIST:,BSS,
  :,UJ,*0
  ,Z06,BACK-START
  :,UJ,*1
  ,Z10,CHBD-START
  :,UJ,*2
  ,Z03,SETSR-START
  :,UJ,*3
  ,Z02,SETSI-START
  :,UJ,*4
  ,Z10,ETEX-START
  :,UJ,*5
  ,Z03,SETE-START
  :,UJ,*6
  ,Z06,EXIT-START
  :,ITA,13
  15,WTC,STAT
  ,ARX,SWIST
  ,ATI,12
  ,ASN,64+15
  ,AAX,C17
  15,ATX,STAT
  12,UJ,
C---  KOHEЦ TEKCTA
  ETEX:14,UTM,-APOS
  ,XTA,BIT3
  14,V1M,ETEX2.IDENT
  15,ATX,W7.'TEXT'
  ,XTA,."ANLAST"
  TO CON:15,ATX,CONTI
  ,UJ,GETS
C---  O Ш И Б K A :
  ERRN:,XTA,
  15,ATX,STAT
  EX/REZ:15,ATX,REZAC
  ,UJ,EXIT
  BACK:15,XTA,COUNT.ДBA
  ,AAX,=:7777 7777.CИMBOЛA
  ,ARX,=:776.HAЗAД
  15,ATX,COUNT.И OДИH
  11,VJM,GETS.BПEPEД
  ,AEX,BIT6.ПOKA
  ,UZA,BACK.ПPOБEЛЫ
C---  ФOPMИPOBAHИE BЫXOДHOГO PMP
  EXIT:15,XTA,COUNT
  ,ASN,64+39
  ,ASN,64-24
  15,AEX,SYM
  15,ATX,FILD
  EXITD:14,VTM,=:7777 7777
  EXITS:15,XTA,COUNT
  15,AEX,S*COUNT
  14,AAX,
  15,AEX,S*COUNT
  15,UTM,ACC
  15,STX,S*COUNT-ACC
  ,UJ,RETNR
C---  YЧET ЗHAKA ЧИCЛA
  SETSI:,BSS,
  15,XTA,ACC
  ,AAX,SBABS
  ,UZA,SETSR
  ,XTA,
  SET O:,BSS,
  15,ARX,CHAR
  ,UZA,DEC
  ,AAX,BIT4
  ,U1A,ERRN
  15,XTA,OCT
  15,ATX,REZAC
  DEC:,BSS,
  ,XTA,BIT1
  15,ATX,STAT
  15,XTA,CHAR
  ,AAX,BIT41
  ,UZA,EXIT
  15,XTA,REZAC
  ,UZA,EXIT
  ,AEX,FULWOR
  ,ARX,BIT1
  ,UJ,EX/REZ
  SETSR:15,XTA,REZAC
  ,AOX,=I0
  15,AVX,CHAR
  15,ATX,REZAC
  15,ATX,FILD
  15,XTA,CHAR
  ,AAX,BIT40
  ,UZA,EXIT
  ,XTA,
  15,ATX,REZAC
C---  YЧET ЭKCПOHEHTЫ
  SET E:,BSS,
  15,XTA,REZAC
  ,NTR,13B. ,ARX,
  ,UZA,ERRN
  15,AVX,CHAR
  15,ATX,REZAC
  15,XTA,CMAN
  ,AAX,C377
  15,A+X,REZAC
  ,AMX,=22
  ,UZA,ERRN.ПEPEП.AY
  15,XTA,CMAN
  ,ASN,64+39
  15,X-A,REZAC
 14,VJM,C10**N
  15,A*X,FILD
  ,UJ,EX/REZ
C---  ЦEЛOE KOHЧИЛOCЬ БYKBOЙ
  CHBD:,BSS,
  14,UTM,-102B
  ,ITA,14
  ,UZA,GETS
  ,AEX,BIT2
  ,U1A,ERRN
  ,UTC,44B
C---  PEГИCTPAЦИЯ ЗHAKA ЧИCЛA И TOЧKИ
  *2:,BSS,
  *0:14,XTA,BIT48-46B
  15,AOX,CHAR
  15,ATX,CHAR
  ,UJ,GETS
C---  CБOPKA ЦEЛOГO И BOCЬMEP.
  *1:15,AOX,CHAR
     15,ATX,CHAR
  15,XTA,OCT
  ,ASN,64-3
  15,AEX,SYM
  ,AEX,C60
  15,ATX,OCT
  15,XTA,REZAC
  ,ASN,64+36.БOЛЬШE
  ,U1A,GETS.12 ЦИФP
  15,XTA,CHAR
  ,AAX,BIT40.TЧK
  ,U1A,INT
  ,XTA,BIT1
  INT:,BSS,
  15,ARX,CMAN
  15,ATX,CMAN
C---  CБOPKA ЭKCПOHEHTЫ
  *6:,BSS,
  15,XTA,ACC
  ,AOX,LET*/
  ,AEX,LET*/
  15,ATX,ACC
  15,XTA,REZAC
  ,ASN,64-1
  15,ATX,W1
  ,ASN,64-2
  15,ARX,W1.*10
  15,ARX,SYM
  ,A-X,C60
  ,UJ,G*REZ
C---  ПOЛYЧEH CИMBOЛ "E"
  *3:,BSS,
  15,XTA,REZAC
  ,AOX,=I0
  15,AVX,CHAR
  15,ATX,FILD
  ,XTA,BIT48
  15,ATX,CHAR
  G*REZ:,BSS,
  15,ATX,REZAC
  ,UJ,GETS
C---  ПEPBЫЙ CИMBOЛ - БYKBA ИЛИ AПOCTPOФ
  *4:,XTA,BL
  15,ATX,REZAC
  15,ATX,FILD
  ,XTA,BIT46
  15,ATX,CHAR.-48
  ,XTA,BIT1
  14,UTM,-APOS
  14,VZM,TO CON
  15,XTA,SYM
C---  CБOPKA TEKCTA
  *5:,AEX,BIT6
  15,ATX,W1
  15,XTA,CHAR
  ,ATI,14
  15,J+M,14
  ,ASN,64+41
  ,ATI,12
  15,XTA,W1
  12,ASN,8
  14,AEX,REZAC
  14,ATX,REZAC
  15,XTA,CHAR
  TEX1:,BSS,
  ,ARX,BIT45
  15,ATX,CHAR
  ,U1A,GETS
  ,AAX,C77
  ,U1A,ETEX1
  ,XTA,BIT45
  ,AOX,BIT2
  ,UJ,TEX1
  ETEX1:,BSS,
  15,XTA,CONTI
  ,AOX,BIT46
  15,ATX,CONTI
  ,XTA,C5
  ETEX2:15,ATX,STAT
  ,UJ,EXITD
  G/ENCOD:,BSS,
  15,ATX,W5.XBOCT.ПPOБ.
  15,ATX,W7.ЛEBЫE HYЛИ
  11,VTM,.БEЗ TOЧKИ
  15,XTA,FILD+1
  ,UZA,CHSIG
  11,VTM,20000B.TOЧKA
  ,X-A,C14
  ,UZA,CHSIG
  ,XTA,COEF+1.ПPИЗHAK:
  15,ATX,W4. E-ФOPMAT
  ,XTA,BIT1
  15,ATX,FILD+1
  CHSIG:15,XTA,BIN
  ,AAX,=:774
  ,U1A,ISEXP
  ,XTA,=I0
  ISEXP:15,AOX,BIN
  ,NTR,6
  ,A+X,
  ,UZA,POZ
  11,UTM,40000B.MИHYC
  15,AVX,BIN
  POZ:15,ATX,BIN
  ,ITA,11
  15,ATX,REZAC
  15,ACX,FILD+1
  ,NTR,3
  15,A-X,FILD
  ,UZA,OVFL
  ,AVX,BIT41.ПOЛE ЦEЛOГO
  14,VJM,C10**N
  15,ATX,W6.10**I
  15,X-A,BIN
  ,UZA,EPOZ
  15,XTA,BIN.ЧИCTЫЙ
  ,UZA,ZERO.HOЛЬ
  15,XTA,W4
  ,U1A,EPOZ0.E-ФOPMAT
  15,XTA,FILD+1
  ,UZA,TO DIG.I-ФOPMAT
  14,VJM,C1/10**N
  15,X-A,BIN
  ,U1A,EPOZ1
  15,X-A,BIN
  ,UJ,ROUND
  EPOZ:15,XTA,BIN
  ,A-X,COEF+1
  ,U1A,MCALC
  15,XTA,BIN
  ,A/X,COEF+1
  15,ATX,BIN
  15,XTA,W4
  ,ARX,BIT1
  15,ATX,W4
  ,UJ,EPOZ
  EPOZ0:15,X-A,BIN
  ,UZA,EPOZ
  EPOZ1:15,XTA,BIN
  ,A-X,ONE
  ,UZA,MCALC
  15,XTA,BIN
  ,A*X,COEF+1
  15,ATX,BIN
  15,XTA,W4
  ,ARX,C377
  15,ATX,W4
  ,UJ,EPOZ1
  ZERO:15,ATX,W4.F-ФOPMAT
  ,UJ,DIGIT
C
C---   BЫЧИCЛEHИE ДЛИHЫ MAHTИCCЫ
C
  MCALC:,NTR,3
  ,XTA,COEF+1
  15,ATX,W6
  15,XTA,REZAC
  ,ASN,64+14.ЗHAK
  ,ARX,C5.IE-NN
  15,X-A,FILD
  ,U1A,OVFL.KPAHTЫ
  ,ATI,14
  14,VZM,MCALC1
  14,UTM,-1
  14,V1M,MCALC1
  ,XTA,=R100.0
  15,ATX,W6
  MCALC1:,ITA,14
  15,ATX,FILD+1
C
C---   ПOЛYЧEHИE ЦИФP ЧИCЛA
C
  TO DIG:,BSS,
 14,VJM,C1/10**N
  ROUND:,BSS,
 ,E-N,64+1./2
 15,A+X,BIN.OKPYГЛEHИE
 15,ATX,BIN
  15,A-X,W6
  ,UZA,EPOZ.HE ЛEЗEM B ПOЛE
  15,XTA,W4
  ,UZA,DIGIT.HE E-FORM.
  ,NTR,3
  ,AAX,BIT8
  ,ASN,64-33
  NEXP1:15,ATX,W1
  15,XTA,W4
  15,AVX,W1
  ,AAX,C377
  ,UZA,NEXP3.ПOPЯДOK:0
  15,ATX,W4
  ,A-X,=12
  ,U1A,NEXP2
  ,AEX,BIT9
  15,ATX,W4
  NEXP2:15,XTA,W1
  ,ASN,64+23
  15,AEX,W4
  ,ASN,64-16
  NEXP3:,ARX,TEXP
  15,ATX,W4
  DIGIT:,NTR,6
  15,XTA,W6
  ,A*X,COEF
  15,ATX,W6
  ,U1A,ENUM
  15,XTA,BIN
  15,A/X,W6
  ,NTR,3
  ,A+X,=I0
  ,ATI,14.ЦИФPA
  ,NTR,6
  15,A*X,W6
  15,X-A,BIN
  15,ATX,BIN.OCTATOK
  ,ITA,14
  15,AEX,W7
  ,U1A,NOTZER
  15,XTA,W6
  ,A-X,COEF+1
  ,U1A,NOTZER
  15,XTA,ACC
  ,AAX,BIT20
  ,ASN,64+14.ЗAMEHA
  ,U1A,PUTDIG.ЛEBЫX
  15,XTA,W5.HYЛEЙ
  ,ARX,BIT1.ПPOБEЛAMИ
  15,ATX,W5
  ,UJ,DIGIT
  NOTZER:14,UTM,60B
  15,XTA,REZAC
  ,AAX,BIT15
  ,UZA,NOTSIG
  ,ITA,14
  15,ATX,REZAC
  14,VTM,MINUS
  ,ITA,14
  11,VJM,PUTS
  15,XTA,REZAC
  ,ATI,14
  NOTSIG:,XTA,ONE
  15,ATX,W7
  ,ITA,14
  ,UJ,PUTDIG
  ENUM:15,XTA,FILD+1
  ,UZA,PUTEX
  14,VJM,C10**N
  15,ATX,W6.ПEPEXOД
  15,A*X,BIN.K
  15,ATX,BIN.MAHTИCCE
  14,VTM,POIN
  ,XTA,
  15,ATX,FILD+1
  ,UJ,NOTSIG
  PUTEX:11,VTM,*+1
  :15,XTA,W4
  ,ASN,64-8
  15,ATX,W4
  ,YTA,
  ,U1A,PUTS
  ,NTR,3
  11,VTM,*+1
  :15,XTA,W5
  ,UZA,GRENC
  ,A-X,BIT1
  15,ATX,W5
  PUT BL:,BSS,
  ,XTA,BIT6
  ,UJ,PUTS
  OVFL:,BSS,
  ,XTA,BIT1
  15,ATX,R14
  11,VTM,*+1
  :15,XTA,FILD
  ,UZA,BRENC
  ,A-X,BIT1
  15,ATX,FILD
  14,VTM,STAR
  ,UJ,SPUT
  H/ENCOD:,BSS,
  15,XTA,FILD
  ,UZA,GRENC
  ,A-X,BIT1
  15,ATX,FILD
  11,VJM,GETS
  11,UTM,H/ENCOD-*
  ,ASN,64+5
  15,AOX,FILD+1
  ,UZA,PUT BL.БPEД ЗAMEHЯETCЯ
  15,XTA,SYM
  ,UJ,PUTS
  B/ENCOD:,BSS,
  15,XTA,FILD
  ,UZA,GRENC
  ,AAX,BIT5
  ,UZA,BENC1
  15,ATX,FILD
  BENC1:15,XTA,FILD
  ,A-X,BIT1
  15,ATX,FILD
  ,ATI,14
  15,XTA,BIN
  14,ASN,64
  14,ASN,64
  14,ASN,64
  ,AAX,C7
  ,AEX,C60
  11,VJM,PUTS
  BENC2:,BSS,
  15,XTA,FILD
  ,UZA,GRENC
  15,XTA,W4
  ,ARX,BIT1
  15,ATX,W4
  15,AEX,FILD+1
  ,U1A,BENC1
  15,ATX,W4
  11,UTM,BENC1-BENC2
  ,UJ,PUT BL
  GRENC:,XTA,
  15,ATX,R14
  BRENC:,BSS,
  15,XTA,COUNT
  ,ASN,64+15
  ,AAX,C777
  15,ATX,REZAC
  14,VTM,B24/1
  ,UJ,EXITS
C
C...  BЫЧИCЛEHИE  10.**N
C     N - B MЛ.PAЗP.CYMMATOPA
C     PEЗYЛЬTAT HA CYMMATOPE
C     ПOPTЯTCЯ  W1  И 12 PEГ.
C     BЫXOД ПO 14 PEГ. C ,NTR,6
  C10**N:,BSS,
  11,VTM,0
  ,NTR,23B
  ,UZA,P/E
  ,AVX,BIT41
  C1/10**N:,BSS,
  ,ATI,11
  ,NTR,3
  P/E:,BSS,
  ,ATI,12
  ,A-X,=22
  ,U1A,S/E
  12,VTM,18
  S/E:,NTR,6
  ,XTA,ONE
  14,UTC,
  12,VZM,
  C/E:,A*X,COEF+1
  12,UTM,-1
  12,V1M,C/E
  15,ATX,W1
  14,UTC,
  11,VZM,
  ,XTA,ONE
  15,A/X,W1
  14,UJ,
 ERROR:,XTA,INFERR
 ,UJ,ERRNRES
 INFERR:,Z00,NR/CODE
 ,Z00,31
 S:,ISO,6HATXSTX
 1,ISO,6HMODXTS
 2,ISO,6HA+XA-X
 3,ISO,6HX-AAMX
 4,ISO,6HXTAAAX
 5,ISO,6HAEXARX
 6,ISO,6HAVXAOX
 7,ISO,6HA/XA*X
 8,ISO,6HAPXAUX
 9,ISO,6HACXANX
 10,ISO,6HE+XE-X
 11,ISO,6HASXXTR
 12,ISO,6HRTEYTA
 13,ISO,6H032EXT
 14,ISO,6HE+NE-N
 15,ISO,6HASNNTR
 16,ISO,6HATISTI
 17,ISO,6HITAITS
 18,ISO,6HMTJJ+M
 19,ISO,6H046047
 *20,ISO,6HZ20Z21
 *21,ISO,6HUTCWTC
 *22,ISO,6HVTMUTM
 *23,ISO,6HUZAU1A
 *24,ISO,6HUJ VJM
 *25,ISO,6HIJ Z33
 *26,ISO,6HVZMV1M
 *27,ISO,6HZ36VLM
 C5000:,LOG,5000
 F1:,LOG,15014
 F2:,LOG,4210014
 AMASK:,LOG,1007777
 BMASK:,LOG,710000
 PMASK:,GOST,6H077777
 ZMASK:,ISO,6H 00000
 MMASK:,ISO,6H -0000
 BL:,ISO,6H
 BLL:,ISO,6H   ''''''
 C*:,ISO,6H   *00
 CSJ:,ISO,6H   SJ
  TEXP:,ISO,6HE+00''''
  COEF:,REAL,0.1
  :,REAL,10.0
  ONE:,REAL,1.0
  C1/6:,LOG,4002 5252 5252 5253
  :,BSS,
 ,END,
 MACRO72:,NAME,.
C
  NR/72:,SUBP,
  NRESCALL:,SUBP,
  BIT30:,EQU,722B
 EMULAT:,SUBP,.
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13
 ,ATX,SAVAC.
 ,AAX,CODE1.
 ,AEX,CODE2.
 ,UIA,TO EMUL.
C
  VMCHANG:,ENTRY,
  ,XTA,INF
  ,UJ,NRESCALL
 TO EMUL:,BSS,.
C*****   HA ИHTEPПPETATOP
  ,XTA,BIT30.БИT Э072
  ,UJ,EMULAT
  INF:,Z00,NR/72
  ,Z00,13
 CODE1:,BSS,.
 CODE2:,BSS,.
 ,LOG,777 00000 776 00000.
 ,END,.
  NRES072:,NAME,
C
C...   HEPEЗИДEHT CYMMATOPHOГO Э072 :
C
C   48-40 И 24-17 PAЗPЯДЫ CYMMATOPA
C   COДEPЖAT "1", OCTAЛЬHЫE - ИHФOPMAЦИЮ
C   ДЛЯ ЭKCTPAKOДA.  AИCП.=KOД OПEPAЦИИ:
C   70707B - IFOVFL
C      0   - ЗAMEHA M- И V-ЛИCTOB
C      3   - ЗAПYCK ЗAДAЧИ
C      4   - ЗAПИCЬ CTPOKИ B DAYFILE
C   ПPOЧИE - CBOБOДHЫ.
C
C   YПPЯTЫBAЮTCЯ PEГИCTPЫ 9-15
C   PEЗYЛЬTAT OTPAБOTKИ MOЖHO ПOMEЩATЬ
C   B CYMMATOP, PMP, И14 BЫXOДA.
C
C=======  OБ'EKTЫ ИЗ ИПЗ : ========
  TMATN  :,EQU,30B
  REGSCAL:,EQU,100B
  OШBHYПP:,EQU,101B
  BUFIW70:,EQU,105B
  П T P  :,EQU,163B
  TPAKTЫ :,EQU,175B
  DRU/MEM:,EQU,777B
  *140:B,BLOCK,REZAC,R15,REZAR,R14
  ,CONT,R13,R27,R11
  ,CONT,S(2)
  ,CONT,M,V,MMASK,VMASK
  ,CONT,MXAP,VXAP
  *137:B,BLOCK,IDENT.ИMЯ ЗAДAЧИ
  *161:B,BLOCK,IFP.ИПЗ ПAPTHEPA
C======= БЛOKИ ДИCПETЧEPA : =======
  *677:B,BLOCK,BITS
  ,CONT,B48,B47,B46,B45,B44,B43
  ,CONT,B42,B41,B40,B39,B38,B37
  ,CONT,B36,B35,B34,B33,B32,B31
  ,CONT,B30,B29,B28,B27,B26,B25
  ,CONT,B24,B23,B22,B21,B20,B19
  ,CONT,B18,B17,B16,B15,B14,B13
  ,CONT,B12,B11,B10,B9,B8,B7,B6
  ,CONT,B5,B4,B3,B2,B1
  T I M E :,EQU,542B
  BITININ:,EQU,B43
 *ИПK:LC,BLOCK,*INFBA
 XNFM:,EQU,XNF+1
 NFM:,WEQ,XNFM
  B48/47:,LC,1
  B48/31 :,LC,1
  Z28/21:,LC,1
  B30/16:,LC,1
  C13   :,LC,1
  DISREG:,LC,1
  C77777 :,LC,1
  C377:,LC,1
  C177:,LC,1
  C77    :,LC,1
  C37:,LC,1
  C7:,LC,1
  C3   :,LC,1
  BC1700:,SUBP,
  C50:,EQU,BC1700+5
  FULWOR:,LC,1
  MASK12 :LC,BLOCK,M12B
  *YCЫ   :LC,BLOCK,ГYC
  SMASAV :LC,BLOCK,SAVAC,SAVSR,SAVAR
  ,CONT,SAVI15,SAVI14,SAVI13
  TPHYS:,LC,1
  YДABЛEHЫ:,LC,1
  FL MAMБ :,LC,1
  NSTAJOB :,LC,1
  M Ш     :,LC,1
  ШЛAГБAYM:LC,BLOCK,(9),SEM212
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
  SCALES  :LC,BLOCK,(1),MRDSCAL
  * И П Д :LC,BLOCK,XNF(5),XNC(3)
  ,CONT,Ш/CЛYЖ,Ш/FULL,Ш/ПOTOK,Ш/ПYCK
  NF :,WEQ,XNF
  NC :,WEQ,XNC
  * И П K 1 :,LC,
  MONO:,EQU,*ИПK1+NC
C
  SAVEMOD:,SUBP,
  STARTJOB:,SUBP,
  SEMDOWNS:,SUBP,
  SEMUP   :,SUBP,
  OUTMACRO:,SUBP,
  ERRNRES :,SUBP,
  NRESOFF :,SUBP,
 GIVEPAGE:,SUBP,
  STATIST:,SUBP,
  TYP/PL :,SUBP,
  COPYTR7:,EQU,TYP/PL+1
  STRING:,EQU,102B.AБC.AДPEC
 STRFUL:,EQU,535B.B ИПЗ
  *STATBUF:LC,BLOCK,MBLO
  SEM/BUF:,EQU,ШЛAГБAYM+7.БYФEP "TTPRINT"
  C14:,LC,1
  NR/72   :,SUBP,
  MACRO72:,SUBP,
  PRTVP  :,SUBP,
   T ПPИП :,EQU,30B
   T ЗAЩ  :,EQU,40B
  NUMBER:,EQU,17.ДИAГHOCTИKA
C
C====================================
C
  START:13,REL,START
  ,WTC,ГYC
  15,VTM,REZAC
  ,XTA,.AC=0
  ,XTS,SAVI15
  ,AEX,SAVSR
  ,ITS,.AR=0
  15,ATX,.I14=0
  ,ITS,32B
  ,ASN,64-15
  ,AEX,SAVI13
  ,ITS,12
  ,ASN,64-15
  ,ITS,27B
  15,AEX,
  ,ITS,9
  ,ASN,64-15
  ,ITS,10
  15,AEX,
  ,ASN,64-15
  ,ITS,11
  15,AEX,
  ,XTS,SAVAC
  :,24,3
  ,WTC,ГYC
  11,VTM,
  14,VZM,CHANG
  14,UTM,-3
  14,VZM,STARTER
  14,UTM,3-70707B
  14,VZM,ABOCT
  14,UTM,70707B-4
  14,VZM,DFWRIT
C...   ЧYЖOЙ AИCП. - YXOДИM K BEPETEHOBY
  14,UTM,4
  ,ITA,14.BOCCT.
  15,ATX,R14-S.И14
  14,VTM,MACRO72
  ,UJ,RET
C
C
C    ЗAПYCK ЗAДAЧ ЧEPEЗ STARTJOB
C
C         HA CYMMATOPE :
C   25-39 : T - TИП ЗAПYCKA
C     16  : F - БИT ФИKCAЦИИ
C    1-15 : D - ДOП.ИHФOPMAЦИЯ
C
C   T=0 : ЗAПYCK HA CBOБOДHЫЙ CЛYЖ.KAHAЛ
C         D  ЗAДAET HOMEP CЛYЖ.ЗAДAЧИ
C         И EE ПAPAMETPЫ ( И.P.1 )
C   T=1 : ЗAПYCK HA CBOБ. OПEPATOPCKИЙ KAHAЛ
C         D=0 ИЛИ AДPEC ИMEHИ ЗAДAЧИ
C         B ПOCЛ.CЛYЧAE HAДO F=0
C   T=2 : TO ЖE HA TEPMИHAЛЬHЫЙ KAHAЛ
C   T=3 : ЗAПYCK MAT.ЗAДAЧИ HA KAHAЛ
C         C ЗAДAHHЫM B  D  Д H З.
C
C   F=1 : ЗAПYCKAEMAЯ ЗAДAЧA ФИKCИPYETCЯ
C         ПPOЙДЯ ФOPMИPOBAHИE CBOEГO ИПЗ.
C         PACФИKCИPYET EE ПOPOДИBШAЯ ЗAДAЧA,
C         ПOДABAЯ ЭKCTPAKOД "HA ИПЗ".
C
C
C    OTBET ЭKCTPAKOДA - CYMMATOP И И14:
C   И14 = 0 : ЗAПYCK HE COCTOЯЛCЯ ПO ПPИЧИHE
C   MAЛOMБ (AC=1B) ИЛИ ЗAHЯTOCTИ KAHAЛA (AC=0)
C   И14 = ДHЗ : ЗAПYCK COCTOЯЛCЯ. ПPИ ЭTOM
C   AC = <ИHФ.CЛOBO ДЛЯ ЭK ,050,212B>
C
  STARTER:11,ATX,MXAP
  ,ATI,9.D
  ,ASN,64+24
  ,AAX,C77777
  ,ATI,10.T
  ,ASN,64+2
  ,U1A,ER72
  11,ATX,REZAC.ШИФP
  11,ATX,R14.ЗAHЯT
  11,ATX,IDENT
  11,XTA,REGSCAL
  ,ARX,
  10,UZA,SST
C...   OШ.OБPAЩEHИE K Э072 :
  ER72:14,VTM,NUMBER
  ,UJ,RET
C-------
  SST:,XTA,Ш/CЛYЖ
  ,UJ,SFC
  :,UJ,R/IDEN
  :,UJ,R/IDEN
  :9,XTA,BITS
  ,AAX,Ш/FULL
  SFC:,UZA,ER72
  11,ATX,MMASK
  11,XTA,MXAP
  ,AAX,B16
  ,UZA,SFC1
  ,ITA,13
  ,ARX,ISEM
  ,UJ,SEMDOWNS
  ISEM:,Z00,SEM212
  ,Z00,SFC1-START
  R/IDEN:,XTA,B16
  11,AOX,MXAP
  11,ATX,MXAP
  11,WTC,R27
  :,24,
  9,XTA,
  :,24,3
  11,ATX,IDENT
  10,XTA,Ш/ПOTOK-1
  ,UJ,SFC
  SFC1:,24,3
  11,XTA,MMASK.BCE
  ,UZA,EXITSEM.ЗAHЯTO
  ,ANX,
  ,ATI,14
  14,XTA,BITS
  11,AEX,MMASK
  11,ATX,MMASK
  :,24,2003B
  14,XTA,*YCЫ
  ,UZA,SFC1
  ,AAX,B30/16
  ,U1A,SFC1
  ,XTA,FLMAMБ
  11,ATX,REZAC
  ,U1A,EXITSEM.MAЛOMБ
C.....   ПOXOД HA STARTJOB
  ,ITA,14
  ,ATX,MШ
  ,XTA,B47
  10,VIM,PUTN
  ,ITA,9
  PUTN:,ATX,NSTAJOB
  ,XTA,ДHЗ
  ,ASN,64-16
  14,ATX,MONO-NF
  ,ITA,14
  11,ATX,R14
  ,ASN,64-9
  ,AOX,C50
  11,ATX,REZAC
  10,VTM,EXITSEM
  11,XTA,MXAP
  ,AAX,B16
  ,UZA,NOFIX
C...   ЗAMOPAЖИBAHИE CEБЯ ДO ПYCKA
C      ЗAДAЧИ, A EE - ПOCЛE STARTJOB'A
C...  ПPИ ПYCKE ПO ИMEHИ - TOЛЬKO
C     ПPИOCTAHOBKA HAC, ЧTOБЫ ПYCKAЧ
C     CYMEЛ BЫГPECTИ ИMЯ ЗAДAЧИ.
  ,XTA,ZBITJ
  ,AAX,MRDSCAL
  ,ATX,MRDSCAL
  11,XTA,IDENT
  ,U1A,NO FIX
  14,XTA,BITS
  ,ATX,YДABЛEHЫ
  10,UTM,EXIT-EXITSEM
  NOFIX:,XTA,C13
  ,ATI,27B
  10,MTJ,33B
  13,MTJ,16
  13,VTM,STARTJOB
  ,UJ,SAVEMOD
  NO DRUM:,BSS,
  ,XTA,B47
  11,ATX,REZAC
  11,XTA,IFP
  ,UZA,ER72
  OFFTASK:,BSS,
  ,ATI,14
  14,XTA,TPHYS
  ,AEX,B1
  14,ATX,TPHYS
  EXITSEM:,24,2003B
  ,ITA,13
  ,ARX,OSEM
  ,UJ,SEMUP
  OSEM:,Z00,SEM212
  ,Z00,EXIT-START
C
C         =====  AИCП=4  =====
C      ЗAПИCЬ CTPOKИ B  DAYFILE
C    AДPEC CTPOKИ - B 1:15 P.CYMMATOPA
C    ДЛИHA CTPOKИ - HE БOЛEE 12 CЛOB
C    ПPИЗHAK KOHЦA CTPOKИ - CЛOBO ИЗ 6
C    ПPOБEЛOB ИЛИ ПYCTOЙ MЛAДШИЙ БAЙT.
C
  DFWRIT:,ATI,10.A CTPOKИ
 ,XTA,ДHЗ
 ,ATI,9
 12,VTM,
 ,XTA,Ш/FULL
 ,AAX,BITJ
 ,UZA,IFBL.CЛYЖ
 11,UTC,
 12,VTM,STRFUL
 9,XTA,*INFBA-NFM
 ,ARX,
 ,UZA,BEGDFW.ПPT
 IFBL:,BSS,
 ,XTA,7
 ,AOX,COPYTR7
 ,AAX,B32
 ,U1A,EXIT.БЛOK. DF
 12,VIM,BEGDFW.ЧEPEЗ ИПЗ
 12,VTM,STRING
  ,ITA,13
  ,ARX,DSEMDF
  ,UJ,SEMDOWNS
  DSEMDF:,Z00,SEM/BUF
  ,Z00,BEGDFW-START
  USEMDF:,Z00,SEM/BUF
  ,Z00,EXIT-START
  BEGDFW:,BSS,
  ,XTA, T I M E
 12,ATX,
  ,XTA, Г Y C
  ,ASN,64-27
  ,AUX,=6H'''7''7'''''''
  ,AOX,=6HШ00>>
 12,ATX,1
  TRSTR:10,UTM,1
  11,WTC,R27
  :,24,
  10,XTA,-1
  :,24,3
 12,UTC,2
 14,ATX,
  ,AEX,=6H
  ,UZA,ETRSTR
  14,UTM,1
  ,AEX,=6H
  ,AAX,C377
  ,UZA,ETRSTR
  ,ITA,14
  ,AEX,C14
  ,U1A,TRSTR
  ETRSTR:,BSS,
 14,MTJ,10
 ,XTA,7
 ,AOX,COPYTR7
 ,AAX,B32
 ,U1A,IFPRT
  ,ITA,14
 ,ASN,64-20
 ,ITS,12
 15,AOX,
 ,ASN,64-24
  ,ITS,13
  15,AOX,
  ,ARX,CONSTA
  ,UJ,STATIST
 IFPRT:,XTA,Ш/FULL
  ,AAX,BITJ
  ,UZA,EXITDF.CЛYЖ
  9,XTA,*INFBA-NFM
  ,ARX,
 ,U1A,EXIT.БEЗ ПPT
 ,XTA,
 12,UTC,
 10,ATX,2
 14,VTM,17B
 14,MTJ,27B
 ,*71,IW/71
 ,UJ,EXIT
  EXITDF:,ITA,13
  ,ARX,USEMDF
  ,UJ,SEMUP
 CON STA:2,Z11,
 ,Z00,IFPRT-START
C
C...   YCTAHOBKA PEAKЦИИ HA ABOCT :
C
  ABOCT:,ASN,64+24
  ,AAX,C77777
  11,XTS,OШBHYПP
  ,AAX,B48/31
  15,AOX,
  11,ATX,OШBHYПP
  ,XTA,BITININ
  11,AOX,REGSCAL
  11,ATX,REGSCAL
  ,UJ,EXIT
C
C...  MEHЯЮTCЯ HOMEPAMИ :
C   MAT.ЛИCT (25-30 P. CYMMATOPA)
C   И TPAKT (1-5) БAPAБAHA (7-11) ,
C   ИMEЮЩEГO CTATYC BИPTYAЛЬHOЙ ПAMЯTИ.
C
C
C...   BOЗMOЖHA OБPAБOTKA ЗAKAЗA HA
C      ЗAMEHY CTPAHИЦ ПO ФOPMATY Э070
C      ("0" 48 PAЗPЯДA CYMMATOPA).
C
  CHANG:,BSS,
  ,ARX,
  ,UZA,CHANG1
  ,APX,=0010 3700 0037 0037
  ,AUX,=0010 0037 0000 3737
  CHANG1:,BSS,
  11,ATX,BUFIW70
 ,ASN,64+24
  ,AAX,C77
 11,ATX,M.MAT.ЛИCT
  ,NTR,3
  ,A-X,C50
  ,UZA,ER72
  11,WTC,M
  11,XTA,TMATN
  ,ASN,64+30
  ,UZA,ER72.ЧYЖ.ЛИCT
  11,XTA,BUFIW70
  ,ARX,B8.+100B
  ,APX,=3737
  ,ASN,64+38
  11,ATX,V.V-ЛИCT
  ,A-X,=1500
  ,UZA,ER72
C...   ПPOBEPKA ДOCTYПA K ЧYЖOMY MБ
  11,XTA,BUFIW70
  ,ASN,64+33
  ,AAX,C77
  ,ATI,10
  ,UZA,VAN
  ,XTA,B48
  10,ASN,64-1
  ,AAX,Ш/FULL
  ,UZA,ER72.ЗAПPEЩEHO
C...   ФИKCAЦИЯ ПAPTHEPA
  ,ITA,13
  ,ARX,VSEM
  ,UJ,SEMDOWNS
  VSEM:,Z00,SEM212
  ,Z00,VRET-START
  VRET:,BSS,
  10,XTA,ГYC
  ,AAX,B30/16
  ,U1A,ISTASK
  ,XTA,B48
  11,ATX,REZAC
  ,UJ,EXITSEM
  IS TASK:,BSS,
  10,XTA,BITS
  ,ATX,YДABЛEHЫ
  ,AEX,FULWOR
  ,AAX,MRDSCAL
  ,ATX,MRDSCAL
  ,UJ,CHECKIF
C...   ФИKCAЦИЯ ЧYЖOГO ИПЗ
  GIV IF:,BSS,
  ,ITA,10.ДHЗ
  ,ASN,64-9
  ,ATI,15
  15,UTM,50B.ИПЗ
  ,XTA,DISREG
  ,ATI,27B
  13,MTJ,9.БAЗA
  13,UTM,REST IR - START
  13,MTJ,33B
  ,UJ,GIVEPAGE
  REST IR:9,MTJ,13.BOCCT.БAЗЫ
  11,UTC,
  15,VTM,S
  ,NTR,3
  CHECKIF:,BSS,
  10,XTA,ГYC
  ,ASN,64+10
  ,AAX,C37
  ,UZA,GIVIF
  ,ATI,14
  14,XTA,TPHYS
  ,AOX,B1
  14,ATX,TPHYS
  :,24,3
  ,ITA,14
  VAN:11,ATX,IFP
  11,XTA,V
  ,ASN,64+5
  ,ATI,14.MБ+2
  10,WTC,*YCЫ
  ,XTA,DRU/MEM
 14,AAX,BITS-1
  ,UZA,NO DRUM
C...   KOOPДИHATЫ YKAЧKИ HA MБ :
  11,XTA,M
  ,AAX,C3
  ,ATI,14
  14,XTA,M12B
  11,ATX,MMASK
  11,XTA,V
  ,AAX,C3
  ,ATI,14
  14,XTA,M12B
  11,ATX,VMASK
  11,XTA,M
  ,ASN,64+2
  ,ARX,ГYC
  ,ATI,12
  11,XTA,V
  ,A-X,B7
  ,ASN,64+2
  10,ARX,*YCЫ
  :,24,2003B
  ,ATI,9
  MAT ANAL:,BSS,
  11,WTC,M
  11,XTA,TMATN
  ,ASN,64+30
  11,ATX,MXAP
  ,AEX,B18
  ,UZA,NVXT.HE ИCП.
  ,ATI,10
  10,V1M,VMEM.B ПAMЯTИ
C...  ЧИCTKA AДPECA YKAЧKИ MAT.ЛИCTA
  12,XTA,ПTP
  11,APX,MMASK
  12,XTS,ПTP
  11,AOX,MMASK
  11,AEX,MMASK
  12,STX,ПTP
  ,UJ,NVXT
C...   ЗAMEHA KOOPДИHAT YKAЧKИ MAT.ЛИCTA
  MSWIN:11,XTA,VXAP
  11,AUX,MMASK
  12,AOX,ПTP
  12,ATX,ПTP
  ,XTA,B47
  ,UJ,PUTTM
  NOUSM:,XTA,B48
  ,UJ,PUTTM
C...  OФOPMЛEHИE V-ЛИCTA B TPHYS :
  VMEM:,BSS,
  ,AAX,B16
  ,UZA,NO EXCH
C...  MAT.ЛИCT ЗAKPЫT ПO OБMEHY
C   (V-ЛИCT B ЭTO BPEMЯ CBOБOДEH)
  ,XTA,DISREG
  ,ATI,27B
  ,*57,3.ЖДEM KO
  ,UJ,MAT ANAL
  NO EXCH:,BSS,
  11,XTA,V
  ,ASN,64-38
  ,AUX,=0003 7003 7000 0000
  10,AEX,TPHYS
  ,AAX,=0007 7007 7000 0000
  10,AEX,TPHYS
  10,ATX,TPHYS
  ,ITA,10
  ,ASN,64-36
C...   CMEHA XAP-KИ V-ЛИCTA
C...   B TAБЛИЦE TPAKTOB
  NVXT:9,XTS,TPAKTЫ
  11,APX,VMASK
  11,ATX,VXAP
  15,AEX,
  11,AUX,VMASK
  9,AEX,TPAKTЫ
  9,ATX,TPAKTЫ
C...   PAЗБEPEMCЯ C V-ЛИCTOM :
  11,XTA,VXAP
  ,UZA,NOUSM.HE ИCП.
  ,ASN,64+36
  ,ATI,14
  ,ASN,64+7
  ,U1A,MSWIN.HE B MOЗY
C...   CMEHA B TPHYS HOMEPA V-ЛИCTA
C...   HA HOMEP MAT.ЛИCTA
  11,XTA,M
  ,ASN,64-21
  14,AEX,TPHYS
  ,AAX,=0007 7007 7000 0000
  14,AEX,TPHYS
  14,ATX,TPHYS
  ,ITA,14
C...   MEHЯEM MECTAMИ БИTЫ
C      ЗAKPЫTOCTИ ПO ПPИOPИTETY
  ,ASN,64+2
  ,ATI,10
  ,ITA,14
  ,AAX,C3
  ,ATI,9
  9,XTA,PRTVP
  10,APX,B48
  ,ASN,64+1
  ,ITS,14
  ,ASN,64-30
  15,AEX,.B TMATN
  9,XTS,PRTVP
  10,AOX,B48
  11,XTS,MXAP
  ,AAX,B17
  ,AEX,B17
  :,UZA,*+1
  10,XTA,B48
  :15,AEX,
  9,STX,PRTVP
C...   ЗAMEHA B TMATN :
  PUTTM:11,XTS,M
  ,ARX,ГYC
  ,ATI,14
  14,XTA,TMATN
  15,AEX,
  ,AAX,B48/31
  14,AEX,TMATN
  14,ATX,TMATN
  ,ASN,64+30
  ,AAX,C177
  ,ATI,9
  ,UZA,NO46
  9,XTA,TPHYS
  ,ASN,64-39.7-Й B 46-Й
  ,AAX,B46
  NO46:14,AOX,TMATN
       14,ATX,TMATN
C...  ЗAMEHA ПPИПИCKИ MAT.ЛИCTA
  11,XTS,M
  ,AAX,C7
  ,AEX,C7
  ,ATI,9
  9,XTA,B28.ЗAKPЫTЬ
  11,ATX,VXAP.ПO ЗAЩИTE
  11,XTA,M
  ,AAX,C3
  ,ATI,12
  ,XTA,=1 0400 0037
  MM:11,ATX,MMASK
  12,VZM,CHTM
  ,APX,=3777 7777 7417 7777
  12,UTM,-1
  ,UJ,MM
  CHTM:11,XTA,M
  ,ASN,64+2
  ,AEX,C7
  ,STI,12
  ,AAX,B48/47
  ,U1A,PRIOR
  11,ATX,VXAP.OTKP.ЗAЩ.
  14,XTA,TMATN
  PRIOR:,ASN,64-11
  11,AUX,MMASK
  11,ATX,MXAP
  11,XTA,M
  ,ASN,64+3
  ,ATI,14
  ,AEX,C3
  ,ATI,10
  ,ASN,64+2
  ,U1A,EXIT.ФOPM.ЛИCT
  11,UTC,
  12,XTA,TПPИП
  11,AOX,MMASK
  11,AEX,MMASK
  11,AEX,MXAP
  11,UTC,
  12,ATX,TПPИП
  ,ASN,64-8
  ,AUX,Z28/21
  ,ITS,12
  ,AEX,C7
  ,STI,12
  12,MOD,20B.B PП
  ,ATI,
  11,UTC,
  10,XTA,TЗAЩ
  9,AOX,B28
  9,AEX,B28
  11,AEX,VXAP
  11,UTC,
  10,ATX,TЗAЩ
  14,MOD,30B.B PЗ
  11,XTA,IFP
  ,U1A,OFFTASK
C....   BЫXOД ПOД ЭKCTPAKOД :
  EXIT:14,VTM,.HOPMA
  ,ITA,13
  ,ARX,OFF
  ,UJ,NRESOFF
  OFF:,Z00,NR/72
  ,Z00,RET-START
  RET:,24,2003B
  15,XTA,
  ,ATI,11
  ,ASN,64+15
  ,ATI,10
  ,ASN,64+15
  ,STI,9
  ,ATI,27B
  ,ASN,64+15
  ,STI,12
  ,ATX,SAVI13
  ,ASN,64+15
  ,STI,32B
  ,STX,SAVI14
  ,STX,SAVAR
  ,ATX,SAVI15
  ,STX,SAVSR
  ,ATX,SAVAC
  14,VZM,OUTMACRO
  ,ITA,14
  ,AEX,OFF
  ,AAX,C77777
  ,AEX,OFF
  ,ATX,SAVAR.SAVAC=0
  14,UTM,-MACRO72
  14,VZM,NRESOFF+2
  ,UJ,ERRNRES
C=========================
  :,BSS,
 IW/71:12,Z04,2
 ,004,
  ,END,
 NRESCALL:,NAME,.
C
C++++++++++++++++++ MOHИTOP HEPEЗИДEHTOB
C+
C+   NRESCALL - BЫЗOB HEPEЗИДEHTA. HA
C+              BXOДE CYMMATOP ДOЛЖEH
C+              COДEPЖATЬ CЛOBO:
C+    ,Z00,POINTER HEPEЗИДEHTA
C+    ,Z00,N
C+   ECЛИ N>17B - ЭTO AДPEC BOЗBPATA,
C+   ИHAЧE N ИHTEPПPETИPYETCЯ KAK БAЗOBЫЙ
C+   PEГИCTP HEPEЗИДEHTA - AДPEC HEPEЗИ-
C+   ДEHTA ЗACЫЛAETCЯ HA ЭTOT PEГИCTP И
C+   YПPABЛEHИE ПEPEДAETCЯ HEПOCPEДCTBEH-
C+   HO HEPEЗИДEHTY. HA BЫXOДE CYMMATOP
C+   COДEPЖИT AДPEC HEPEЗИДEHTA. COXPAHЯ-
C+   ЮTCЯ CПEЦ.PEГИCTPЫ 32B И 27B (БИTЫ
C+   1-4,6-8,10,11). ПOPTИTCЯ 33B.
C+
C+   NRESOFF - OTKAЗ OT HEPEЗИДEHTA. HA
C+             BXOДE CYMMATOP KAK Y
C+             NRESCALL, N BCEГДA ИHTEP-
C+   ПPETИPYETCЯ KAK AДPEC BOЗBPATA. PE-
C+   ГИCTPЫ HE ПOPTЯTCЯ.
C+
C
 I:,EQU,1.
 J:,EQU,2.
 K:,EQU,3.                               9
 RT:,EQU,4.
 BIT1:,EQU,757B.
 BIT7:,EQU,751B.
 EXCHBIT:,EQU,BIT7.
  BIT16:,EQU,740B
 BITS:,EQU,677B.
 M:,EQU,100B.
 KNMP:,EQU,21.
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR,
 ,CONT,SAVS16.
 *PRT: LC,BLOCK,NFMSCAL,NNRFLAG,NC,RP
 *SWCMN:LC,BLOCK,SBUSYFLG.
C*******
  SEMDOWNS:,SUBP,
  SEMUP  :,SUBP,
  ШЛAГБAYM:LC,BLOCK,(5),CALLBSC
C*******
 ДHЗ:,LC,1.
 DISREG:LC,BLOCK,C2013.
 C77777:,LC,1.
 C1777:,LC,1
C
C... BHИMAHИE! LNRT ДOЛЖHO БЫTЬ HE MEHEE,
C         ЧEM  KOHHИЗ/1024.
C
  LNRT:,EQU,26
  B48/47:,LC,1
 FULWOR:,LC,1.
 *YCЫ:LC,BLOCK,Г Y C,RDSCAL.
 TRAPHY:,SUBP,.
 CLANEWTA:,SUBP,.
 GIVEPAGE:,SUBP,.
 ENTFOLIC:,SUBP,
  T/ЧYЖЛИC:,EQU,6.HOMEP ДИAГHOCTИKИ
 TPHYS:,LC,32.
 DISPBASE:,LC,1.
 C37:,LC,1.
 MPHP:,EQU,C37.
 BIT6:,EQU,752B.
 TMATH:,EQU,30B.
 KNP:,EQU,30.
   :    ,24,2003B
 ,ATX,SAVAR.
 13,MTJ,16.
 ,CALL,SAVE MOD.
C
C*****  +2 : BXOД, KOГДA MAЛOE YПPЯTЫBAHИE
C*****             YЖE CДEЛAHO.
C
 ,ITA,27B
 ,APX,PMASK
 ,AEX,SAVAR
 ,ATX,SAVAR
 CHNRP:,XTA,SAVAR.
 ,ASN,64+24.
 ,AAX,C1777.
 ,ATX,RELADR.OTH.AДP.HEP.ЧACTИ
 ,XTA,W/S UP
 ,UJ,SEMUP
 W/S UP:,Z00,CALLBSC
 ,Z00,*+1
 ,XTA,SAVAR.
 ,ASN,64+34.N ЛИCTA HEP. ЧACTИ
 ,ATI,14.
 14,VZM,CALLNRP.TOЛЬKO ЗAXBAT ЛИCTA
 14,XTA,NRTABL.
 ,AAX,MPHP.
 ,UZA,CALLNRP.
 ,ATI,15
  ,WTC, Д H З
  ,XTA,BITS-19.ЭTA ЗAДAЧA
  14,AOX,NRTABL.OБPAЩAЛACЬ
  14,ATX,NRTABL.K HEPEЗИДEHTY
 15,XTA,TPHYS
 ,AOX,BIT1
 15,ATX,TPHYS
 ,ITA,15
 ,ASN,64-10.
 ,ATI,13.
 ,ATX,ANP.AДPEC HEP.ЛИCTA.
 ,WTC,RELADR.ПEPBOE CЛOBO HEP.ЧACTИ
 13,UTM,.
 13,XTA,.
 ,WTC,Д H З.
  ,AAX,BITS-15
 ,U1A,RESTORE.HEP.ЧACTЬ YЖE ЗAK. ДAHH. ZAД.
  ,XTA,BIT16
 14,ARX,NRTABL.
 14,ATX,NRTABL.
 ,WTC,Д H З.
  ,XTA,BITS-15
 13,AOX,.
 13,ATX,.ШKAЛA ЗAKAЗOB HEP.ЧACTИ
 RESTORE:,BSS,.
 13,XTA,.
 ,AAX,C1777.
 ,ARX,ANP.
 ,ATX,NRADR.AДPEC HAЧAЛA BЫЗB.HEPEЗИДEHTA
 13,VTM,CHNRP
 13,MTJ,33B
 13,VTM,RET
 ,ITA,15
 ,UJ,TOCPRT
 RET:,XTA,SAVAR
 ,AUX,PMASK
 ,ATI,27B
 ,XTA,SAVAR
 ,AAX,C77760
 ,U1A,BOЗBPAT
  ,XTA,SAVI13
  15,VTM,SAVI13
  ,STI,13
  ,STI,14
  ,ATI,15
 ,XTA,NRADR
 ,WTC,SAVAR
 ,ATI,
 ,ATX,SAVAR
  ,UJ,RRR
 BOЗBPAT:,BSS,.
 ,XTA,SAVI15.
 ,ATI,15.
 ,XTA,SAVI14.
 ,ATI,14.
 ,XTA,SAVI13.
 ,ATI,13.
  RRR:,XTR,SAVSR
 ,XTA,NRADR.
 ,WTC,SAVAR.
 ,UJ,.
 CALLNRP:,BSS,.
   15,VTM,CHSBFL
  ,XTA,CALLBSC
  :,UZA,*+1
  15,VTM,CHNRP
  :,ITA,15
  ,AOX,W/SEM
  ,ATX,SAVS16
  ,UJ,SEMDOWNS+2
  W/SEM:,Z00,CALLBSC
  ,Z00,
  CHSBFL:15,VTM,200B
 ,XTA,SBUSYFLG.
 ,UZA,REDYRP.ПOДKAЧKA CBOБOДHA
 13,VTM,CHSBFL.
 PREQ:13,MTJ,33B.
 ,UJ,GIVEPAGE.
 REDYRP:,XTA,BIT1.
 ,WTC,RP.
 ,ATX,TPHYS.ФИKC.PEZ.ЛИCTA
 ,XTA,RP.
 ,ATX,NP.
  13,VJM,PREQ.HA ПOДKAЧKY CO CПEЦ.ЗAKAЗOM
 ,XTA,NNRFLAG
 ,UZA,REDYPAGE
 ,XTA,
 ,ATX,NNRFLAG
 ,UJ,CHSBFL.PEAKЦИЯ HA COOБЩEHИE, ЧTO CTPAHИЦY HE ДAЛИ
 REDYPAGE:,BSS,.
 ,XTA,SAVAR
 ,ASN,64+34
 ,UZA,FIXP
  13,VTM,REDYPRT
 13,MTJ,33B
 ,ATI,14
 ,XTA,NP
 TOCPRT:,ATX,INFDR
 14,XTA,NRTABL
 ,AAX,BITS+2
 13,UZA,
 14,AEX,NRTABL
 14,ATX,NRTABL
 ,XTA,C2013
 ,ATI,27B
 ,XTA,INFDR
 CALCPRT:,SUBP,
 ,UJ,CALCPRT
 REDYPRT:,BSS,
 ,XTA,SAVAR.
  ,ATX,AR
 ,ASN,64+34.
 ,ASN,64-2.
 ,ARX,DISPBASE.
 ,ATX,INFDR.
 ,XTA,NP.
 ,ASN,64-12.
 ,AOX,INFDR.
 ,AOX,CINFRP.ЛИCTOBOE CЧИTЫBAHИE
 ,ATX,INFDR.
 ,XTA,SAVI13.
 ,ASN,64-15.
 ,AOX,SAVI14.
 ,ATX,M74.
C     ПPИ ПEPEXBATE MБ HA MД
C     SAVAC  ПOPTИT ГYPEBИЧ
  ,XTA,SAVAC
  ,ATX,S
 ,XTR,SAVSR.
 13,VTM,INFDR.
 14,VJM,TRAPHY.
  ,XTA,AR
  ,ATX,SAVAR
  ,XTA,S
  ,ATX,SAVAC
 ,XTA,M74.
 ,ASN,64+15.
 ,ATX,SAVI13.
 ,XTA,M74
 ,AAX,C77777.
 ,ATX,SAVI14.
 FIXP:,BSS,.
 ,XTA,SAVAR.
 ,ASN,64+34.
 ,ATI,14.
 ,ASN,64-KNMP.
 ,AOX,BIT1.
 ,WTC,NP.
 ,ATX,TPHYS.
 ,XTA,NP.
 14,AOX,NRTABL
 14,ATX,NRTABL.B TAБЛИЦY HEPEЗ.ЛИCTOB
  ,XTA,R/SEM
  ,UJ,SEMUP
  R/SEM:,Z00,CALLBSC
  ,Z00,*+1
 14,VZM,FNRADR
 ,UJ,CHNRP.HA HAЧAЛO BЫЗЫBATOPA
 FNRADR:,XTA,NP
 ,ASN,64-10.
 ,ATX,NRADR.
 ,UJ,RET
C
C     OTKAЗ OT HEPEЗ. ЧACTИ
 NRESOFF:,ENTRY,.
 NRESOFF:,BSS,.
   :    ,24,2003B
 ,ATX,SAVAR.
 13,MTJ,16.
 ,CALL,SAVEMOD.MAЛOE TПP.
C**** +2: BXOД,KOГДA MAЛOE YПP. CДEЛAHO
 ,XTA,SAVAR.
 ,ASN,64+34.
 ,ATI,14.
 14,XTA,NRTABL.
 ,AAX,MPHP
 ,UZA,BOЗBPAT.HEP.ЧACTЬ OTCYTCTBYET
 ,ASN,64-10.
 ,ATX,ANP.
 ,XTA,SAVAR.
 ,ASN,64+24.
 ,AAX,C1777.
 ,ATX,RELADR.
 ,ARX,ANP.
 ,ATI,13.
 ,WTC,Д H З.
  ,XTA,BITS-15
 13,AAX,.
 ,UZA,BOЗBPAT.
 13,AEX,.
 13,ATX,.
 14,XTA,NRTABL.
  ,ARX,CZ16
 14,ATX,NRTABL.
  ,AAX,M46*2016
 ,U1A,BOЗBPAT.
 14,WTC,NRTABL
 ,XTA,TPHYS
 ,AOX,BIT1
 ,AEX,BIT1
 14,WTC,NRTABL.
 ,ATX,TPHYS.
 ,UJ,BOЗBPAT.
 CALL1MEM:,ENTRY,.
 BIT47:,EQU,701B.
 B24/1:,LC,1.
 C76000:,LC,1.
 ,AAX,B24/1.
 ,ATX,SAVAR.
 ,ITA,14.
  ,AAX,C76000.
 ,ASN,64-14.
 ,AOX,SAVAR.
 CALL1FMEM:,ENTRY,.
   :    ,24,2003B
 ,ATX,SAVAR.
 13,MTJ,16.
 ,CALL,SAVEMOD.
 SETI15:,BSS,.
 ,XTA,SAVAR.
 ,ASN,64+24.
 ,ATI,15.
 TO PRT:13,VTM,CHEK1M.
 13,MTJ,33B.
 13,VTM,2013B.
 13,MTJ,27B.
 14,VTM,T/ЧYЖЛИC
 ,UJ,ENTFOLIC.
 CHEK1M:,XTA,SAVAR.
 ,ASN,64+24.
 ,ATI,15.
 ,WTC,Г Y C.
 15,XTA,TMATH.
 ,AAX,B48/47.
 ,U1A,TOPRT.
 ,WTC,Г Y C.
 15,XTA,TMATH.
 ,ASN,64+KNP.
 ,ATX,NRADR.
 ,WTC,NRADR.
 ,XTA,TPHYS.
 ,AAX,EXCHBIT.
 ,U1A,TO PRT.
 ,XTA,NRADR.
 ,ASN,64+5
 ,UZA,REDYFP.ЛИCT B ПAMЯTИ 1
 15,UTM,400B.
 13,VTM,SETI15.
 13,MTJ,33B.
 13,VTM,2013B.
 13,MTJ,27B.
 ,UJ,GIVEPAGE.K ПOДKAЧKE ЗA ПEPEKAЧKOЙ
 REDYFP:,XTA,SAVI15.
 ,ATI,15.
 ,XTA,NRADR.
 ,ASN,64-10.
 ,WTC,SAVAR.
 ,UJ,.
  M46*2016:,OCT,1000 0000 0370 0000
 CINFRP:,LOG,140 0000.
 C77760:,LOG,77760
 PMASK:,OCT,7777777700003357
 NRADR:,BSS,1.
 INFDR:,BSS,1.
 NP:,BSS,1.
 RELADR:,BSS,1.
 S:,BSS,1.
  AR:,BSS,1
 ANP:,BSS,1.
 M74:,BSS,1.
 NRTABL:,ENTRY,.
 NRTABL:,BSS,LNRT.
  CZ16:,OCT,7777 7777 7767 7777
 ,END,
 *C:,NAME,.
 C6:,LOG,6.
 MACRO71*:,SUBP,
 C571:,Z00,
 ,Z00,MACRO71*.AДPEC ПOBTOPHOЙ AKTИBИЗAЦИИ Э71
 C574:,LOG,574.
 C176000:,LOG,176000.
 ,END,.
  NRSMT*SE:,NAME,
C
C
C=======================================
C
C     HEPEЗИДEHT  Э57 (10-4000B)
C     OПPOC COCTOЯHИЯ MAГHИTOФOHOB
C     ПOИCK MЛ ПO ИMEHИ
C     ЗAXBAT MЛ ЗAДAЧEЙ
C     OTKAЗ OT MЛ
C     ПEPEДAЧA PECYPCOB TИПA MЛ
C     ЗAKAЗ/OTKAЗ OПPOCA OБMEHA
C
C       1 AПPEЛЯ 1977 Г.  CAПOЖHИKOB.
C
C======================================
C     ПAPAMETPЫ ЧИCЛA ЗAДAЧ:
  * И П Д :LC,BLOCK,XNF,XNFM(4)
  ,CONT,XNC,XNCM(2),Ш/CЛYЖ,Ш/FULL(6)
  ,CONT,MБД,*LFATA(11),MONO,FREXT
  NMAT :,WEQ,XNC
  NMAT1:,WEQ,XNF
C---------------------------
  ШЛAГБAYM:LC,BLOCK,SEM/NR57,SEM/OCCD
  SEMDOWNS:,SUBP,
  SEMUP  :,SUBP,
  *700:B,BLOCK,B48,B47,B46,B45,B44,B43,B42,B41
  ,CONT,B40,B39,B38,B37,B36,B35,B34,B33,B32,B31
  ,CONT,B30,B29,B28,B27,B26,B25,B24,B23,B22,B21
  ,CONT,B20,B19,B18,B17,B16,B15,B14,B13,B12,B11
  ,CONT,B10,B9,B8,B7,B6,B5,B4,B3,B2,B1
  TABLEMT:LC,BLOCK,T1(96),TNAM(48)
 STATUSMT:LC,BLOCK,(5),NEW(27),MISTERX
  REWINDSC:LC,BLOCK,(1),STWRIS,CHECKWR
   SMASAV:LC,BLOCK,SAVAC(3),S15,S14,S13
  F A T A  :,LC,1
  * И П K 1:,LC,1
  MONOW :,EQU,*ИПK1+NMAT
 NFIL:,EQU,T1+48
 BNRD:,EQU,B29
     *YCЫ:LC,BLOCK, Г Y C
  ,CONT,RDSCAL
  SAVAR:,EQU,SAVAC+2
  BITS:,EQU,677B
  DISREG:,LC,1
  FULWOR:,LC,1
  C2003 :,LC,1
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
  Ш/ДИCП:,EQU,XNF+23B
 C777:,LC,1
  C2004:,LC,1
    C77:,LC,1
    C7 :,LC,1
    C3 :,LC,1
  TRAKYS:,EQU,=0070 0000 0000 1600
  CLANEWTA:,SUBP,
  FULSAV  :,SUBP,
  SAVTOTAL:,EQU,FULSAV+1
  NR//SEAR:,SUBP,
  TTPRINT 1:,SUBP,
   NEWTA  :,SUBP,
  NRESOFF:,SUBP,
  LFATA:,WEQ,*LFATA
  *127:B,BLOCK,MLD,RLD
  NC*5:,P*P,(NMAT)5
  NC*5P4:,EQU,NC*5+4
  POST:,LC,1
  WAITPOST:,EQU,POST+NC*5P4
  C7777:,LC,1
  LTF  :,EQU,LFATA-1
  EFATA:,EQU, FATA+LTF
  ET1  :,EQU,T1+47
  REGSCAL:,EQU,100B
  ERR*57:,SUBP,
  NUM*TL:,EQU,1067B
C
C..  COБCTBEHHOE ПOЛE YПPЯTЫBAHИЯ
C
  SIR:I,BLOCK,NAME(2),REGIM
  ,CONT,R33,R32
  ,CONT,R27,R16,R15,R14,R13
  ,CONT,REGISTER(11),R1
C
C..  ИHДEKC-PEГИCTPЫ
C
  *1:B,BLOCK,W1,SPEC,TAPE,ABSENT,BUSY
  ,CONT,NOREADY,WRITE,READ,BLOCK,NOBOBIN(0),STN
  ,CONT,TAKE,REFUSE,RET,BASA,W2
C
C..  ЭKOHOMИЯ HA PAБ.ЯЧEЙKAX
  WS:,EQU,R14
  IDENT:,EQU,R16
  TKYC:,EQU,R27
  RESULT:,EQU,R33
C
C..  KOЛИЧECTBO PAБOT
  ДEЯHИЯ:,EQU,9
  ДEЯHИE*1:,EQU,B4
  *****:14,REL,*****
  ,XTA,DISREG
  ,ATI,27B
  ,XTA,S14.CПACEHИE
  ,ATX,SAVAR.14 PEГ.
C
C.. CTPAXOBKA OT HAИБOЛEE OПACHЫX ДEЯHИЙ
C
  ,APX,B11
  ,UZA,AFT/WAIT
  ,WTC, Г Y C
  ,AAX,REGSCAL
  ,UZA,ERR*57
C.. ПOBTOPHЫЙ BXOД ПOCЛE WAIT.
  AFT/WAIT:,BSS,
C.. HA ПPEДMET BOЗMOЖHOГO ЗAKPЫTИЯ
C.. ЗAДAЧИ - CПACEM БAЗY HEPEЗИДEHTA
  ,ITA,BASA
  ,ATX,S14
C.. ПPEOДOЛEHИE CEMAФOPA
  ,ARX,W/DOWN
  ,UJ,SEMDOWNS
  W/DOWN:,Z00,SEM/NR57
  ,Z00,AFT/DOWN-*****
  AFT/DOWN:,BSS,
C
C..  ПOЛYЧИЛИ BOЗMOЖHOCTЬ ПOPAБOTATЬ
C.. CПACEM BCE ПOДPЯД
  15,VTM,SIR
  ,MTJ,33B.RESULT=0
  13,VJM,SAVTOTAL
  ,WTC,S14
  14,VTM,
C..  И OTKPOEM,HAKOHEЦ,ПPEPЫBAHИЯ
   :    ,24,3
  TAPE,VTM,-47
  W1,VTM,1-ДEЯHИЯ
  SPEC,VTM,ДEЯHИЯ
C.. ДЛЯ ПYЩEГO YДOБCTBA PACПИXAEM
C.. PEЖИMЫ OБPAЩEHИЯ ПO PEГИCTPAM
  MAKFLAGS:,XTA,REGIM
  SPEC,AAX,ДEЯHИE*1-ДEЯHИЯ
  SPEC,UTM,-1
  W1,ATI,REFUSE
  W1,VLM,MAKFLAGS
C
C.. A PEЖИMЫ ЭTИ TAKOBЫ :
C   1. ABSENT (4-Й P. AИCП.)-ПEЧATЬ 'HET MЛ',ECЛИ HAДO
C   2. BUSY   (5-Й P.)-ПEЧATЬ 'ЗAHЯT MФ'
C   3. NOREADY(6-Й P.)-ПEЧATЬ 'HEГOT.MФ'
C   4. WRITE  (7-Й P.)  -''-  'ЗAПИCЬ MФ'
C   5. READ   (8-Й P.)  -''-  'ЧTEHИE MФ'
C   6. BLOCK  (9-Й P.) - БЛOKИPOBKA TT-ДИAГHOCTИKИ
C   7. NOBOBIN(10-Й P.) ПOИCK TOЛЬKO ПO ИMEHИ
C                       / БEЗ N БOБИHЫ /
C   8. TAKE   (11-Й P.) ПOИCK C ЗAXBATOM MЛ
C                      /MAT.HOMEP MЛ - B 13 PEГ./
C   9. REFUSE (12-Й P.) OTKAЗ OT CBOИX MЛ
C                      ЗAДAHHЫX HA CYMMATOPE
C                       БИTOBOЙШKAЛOЙ:
C        ( 48 P. - MЛ 30 ДЛЯ  MAT.ЗAДAЧ
C         ИЛИ MЛ 00 ДЛЯ CЛYЖ.ЗAДAЧ )
  RET,VTM,ANAL
  ,U1A,REFTAP.HA OTKAЗ
  NOBOBIN,VZM,FULNAM
  NOBOBIN,VTM,12
C.. ФOPMИPOBAHИE ИДEHTA MЛ
  FULNAM:,ITA,TAKE
  ,UZA,SERONLY
  ,XTA,Д H З
  ,ASN,64-6
  ,AOX,R13
  ,ASN,64-36
  ,ATX,IDENT
  ,XTA,NAME
  ,ASN,64+12
  ,UZA,SETDNS.SCRATCH-ИMЯ
  ,ASN,64+28
  ,U1A,SETDNS.HOPM.ИMЯ
C
C.. ПEPEДAЧA MЛ-PECYPCA
C   1-12 P. NAME - ИД.MЛ Y CTAPOГO XOЗЯИHA
C   13-24     --''--        Y HOBOГO .
C
  ,XTA,NAME
  ,ASN,64-36
  ,ATX,WS
C.. ПOИCK CTAPOГO ИДEHTA
C   CПEPBA B T1MT, ПOTOM B FATA.
  SPEC,VTM,
  SE/1:SPEC,UTC,
  TAPE,XTA,ET1
  ,AEX,WS
  ,ASN,64+36
  ,UZA,SE/2
  TAPE,VLM,SE/1
  RET,UTC,
  SPEC,VIM,
  TAPE,VTM,-LTF
  SPEC,VTM,EFATA-ET1
  ,UJ,SE/1
C.. CMEHA HAЙДEHHOГO ИДEHTA HA HOBЫЙ
  SE/2:SPEC,UTC,
  TAPE,UTM,ET1.AДPEC ПO TAБЛ.
  ,XTA,NAME
  ,ASN,64+12
  ,AEX,NAME
  ,ASN,64-36
   :    ,24,2003B
  TAPE,AEX,
  TAPE,ATX,
  SPEC,VZM,EXIT.MЛ
  ,ASN,64+30
  ,AAX,C77
  ,ATI,SPEC.N MOD
  ,XTA,NAME
  ,AAX,C77
  ,ATI,TAPE
  TAPE,XTA,B48-30B
  ,AEX,FULWOR
C-- ЧИCTKA B  M Л Д
  ,WTC, Г Y C
  ,AAX,MLD
  ,WTC, Г Y C
  ,ATX,MLD
C-- OTKAЗ OT ПAKETA
  ,XTA,FULWOR
  SPEC,AEX,B48-30B
  ,WTC, Д H З
  ,AAX,MONOW-NMAT
  ,WTC, Д H З
  ,ATX,MONOW-NMAT
C-- ПEPEДAЧA ПAKETA KЛИEHTY
  ,XTA,NAME
  ,ASN,64+18
  ,AAX,C77
  ,ATI,W2.EГO ДHЗ
  SPEC,XTA,B48-30B
  W2,AOX,MONOW-NMAT
  W2,ATX,MONOW-NMAT
C.. B MЛД KЛИEHTA ПPOCTABЛЯTЬ '1'
C   BOЗДEPЖИMCЯ BBИДY YПЛЫTИЯ ИПЗ.
C   ЗAДAЧA OБMEHA CAMA PAЗБEPETCЯ.
  ,UJ,EXIT
C--
  SETDNS:,BSS,
  ,XTA,R13
C.. ПЛOTHOCTЬ ЗAПИCИ ЗAДAETCЯ
C.. 14-15 БИTAMИ MOДИФИKATOPA 13
C.. 13 БИT - ПPИЗHAK CHЯTИЯ OБMEHA
C            ПO ДИAГHOCTИKE 'ЦK MФ'
  ,ASN,64+12
  ,ASN,64-8
 ,AOX,IDENT
  SERONLY:,AOX,B1
  ,ATX,IDENT
C.. ПPOБA - HE PAБOЧAЯ ЛИ MЛ :
  ,XTA,NAME
  ,AEX,=2245 1252 5122 4512
  ,U1A,NO/WOR/T
C.. ПOИCK TOЛЬKO ПO PEAЛЬHЫM MЛ
  TAPE,VTM,-31
  NO/WOR/T:,ITA,TAPE
  ,ATX,TAPCNT
C
C.. ПPOБA HA CПEЦ-ЗAKAЗ :
C.. OПPOC COCTOЯHИЯ ФИЗ.MAГHИTOФOHA
C.. HOMEP MФ - B 4-9 P. CYMMATOPA
C.. 10-48 P. CYMMATOPA - EДИHИЦЫ
  ,XTA,NAME
  ,AOX,B48
  ,ARX,B10
  ,UZA,NOSPEC
C
C.. B ЭTOM CЛYЧAE  ABSENT  ЗAДAET
C.. ПEЧATЬ ДИAГH. 'ИMEHOB.MЛ', ECЛИ
C.. MЛ HE OTMEЧEHA B  MISTERX
  ,ASN,64+3.HOMEP
  ,ATI,TAPE.MЛ
  ,ATX,RESULT
  ,XTA,MISTERX
  TAPE,APX,B48-30B
  ,AAX,B48
  ,AEX,B48
  ,ASN,64+3
  ,AOX,RESULT
  ,UJ,CHECK1
C
C.. БЛOK OПPOCA COCTOЯHИЯ
C.. ГT.,ЧT/ЗП., И ЗAHЯTOCTИ MФ.
C
  CHECK:TAPE,UTM,67B
  ,ITA,TAPE
  CHECK1:,ATX,RESULT
 ,XTA,C777
 ,ATX,LSTZON
  TAPE,XTA,T1-10B
  TAPE,UTM,-67B
  ,ASN,64+42
  ,UZA,FRTAP
  ,AEX, Д H З
 ,UIA,BUSTAP
 TAKE,VZM,FRTAP
 TAPE,XTA,T1+47
 ,AEX,IDENT
 ,ASN,64+36
 BUSTAP:,BSS,
  ,UZA,FRTAP
  ,XTA,B46
  FRTAP:,AOX,RESULT
        ,ATX,RESULT
  ,ASN,64-42
  ,AUX,TRAKYS
  ,ATX,TKYC
  ,ASN,64+7
  ,ATI,W1
  ,ASN,64+32
  ,ATI,W2
  ,ARX,B1
  ,AAX,B3
  ,U1A,NO/MODEL
C... ПO MOДEЛИ ГOTOBHOCTЬ CMOTPИM B FATA
 TAPE,WTC,NFIL+47
 ,XTA,FATA-1
 ,AAX,BNRD
 ,ASN,64-18
 ,AOX,RESULT
  ,ATX,RESULT
 TAPE,WTC,NFIL+47
 ,XTA,FATA-1
 ,ATI,W1
 ,ASN,64+12
 ,AAX,C7777
 ,ATX,LSTZON
 ,ITA,W1
 ,AAX,C7777
 ,NTR,3
 ,A-X,LSTZON
 ,ATX,LSTZON
  ,XTA,REGIM
  ,APX,B8
  ,AOX,RESULT
 ,UJ,EXCHECK
  NO/MODEL:W2,XTA,NEW-3
  W1,ASN,64+6
  ,APX,C2004
  ,AOX,RESULT
 EXCHECK:,BSS,
  ,ATX,RESULT
  RET,UJ,
C
C.. OБЫЧHЫЙ PEЖИM ПOИCKA
C
  NOSPEC:TAKE,VZM,SE/NAM
C.. ПOИCK ПO ИДEHTY ПEPEД ЗAXBATOM
  SE/OWN:TAPE,XTA,T1+47
  ,AEX,IDENT
  ,ASN,64+36
  ,UZA,CHECK
  TAPE,VLM,SE/OWN
C.. HE HAШЛИ - ИЩEM CBOБOДHYЮ
C.. MЛ ПO ЗAДAHHOMY ИMEHИ
  ,XTA,TAPCNT.CЧETЧИK
  ,ATI,TAPE.ЦИKЛA
  SE/NAM:TAPE,XTA,TNAM+47
  ,AEX,NAME
  NOBOBIN,ASN,64
  ,U1A,ELSN
  RET,VJM,CHECK
C.. B XOPOШEM ЛИ COCTOЯHИИ
  ,ASN,64+45
  ,AAX,C3
  ELSN:,UZA,ANAL.BПOЛHE
  TAPE,VLM,SE/NAM
C.. HEYДAЧA
  TAKE,VTM,
  ANAL:,BSS,
C.. AHAЛИЗ - ЧEГO ДOCTИГЛИ
  ,XTA,RESULT
  W1,VTM,-2
  ,ATI,TAPE
  ,UZA,CHBLOK.NOTHING
  ,AEX,B48
C.. ПOЛYЧEHИE CЛOBA COCTOЯHИЯ MЛ
  ,ASN,64+1
  ,ARX,B47
  ,ASN,64+40
C.. OПPEДEЛEHИE - ЧTO HE TAK
  ,AAX,REGIM
  ,U1A,CHBLOK
  ,XTA,B46
  ,AOX,B47
  ,AAX,RESULT
  ,U1A,EXIT
  OKEY:,BSS,
C.. HYЖEH ЛИ ЗAXBAT
  TAKE,VZM,EXIT.HET
  ,ITA,TAPE
  ,ARX,B4
  ,ASN,64+5
  ,U1A,OCCTAP
  TAPE,WTC,NFIL-10B
  ,XTA,FATA-1
  ,ARX,B34
  ,APX,=0000 1740 7777 0000
  ,ASN,64+31
  ,AOX,B22
  BASA,MTJ,SPEC
  ,CALL,K COCEДY
  SPEC,MTJ,BASA
  ,UZA,OCCTAP
  ,XTA,B46
   ,AOX,RESULT
  ,ATX,RESULT
  ,UJ,ANAL
  OCCTAP:,24,2003B
  ,XTA,IDENT
  TAPE,ATX,T1-10B
C.. YCTAHOBKA ЗAKAЗAHHOГO
C.. PEЖИMA ЧTEHИЯ И KOHTPOЛЯ.
 WRITE,VIM,EXIT.STANDART
 TAPE,XTA,B48-10B.BIT MT
 13,VTM,STWRIS.ЗAПP.ЗП.
 READ,VIM,CLOWNBIT.-ДA
 13,VTM,CHECKWR.БEЗ KOHTPOЛЯ
 CLOWNBIT:,AEX,FULWOR
 13,AAX,.ГAШEHИE БИTA B
 13,ATX,.HYЖHOЙ ШKAЛE.
  ,UJ,EXIT
C
C.. ДИAГH.БЛOKИPOBAHA
  CHBLOK:BLOCK,VIM,EXIT.ДA
  ,ATX,WS
  W1,VTM,-4
C.. ЦИKЛ ПO TИПAM BOЗMOЖHЫX
C.. HEПPИЯTHOCTEЙ. ПOЛYЧEHИE
C.. TEKCTA COOTB.ДИAГHOCTИKИ
  DIATYP:W1,ITA,READ
  ,AAX,WS
  ,U1A,TYPIS
  W1,VLM,DIATYP
  W1,VTM,1
C.. KOДИPOBKA HOMEPA MФ B TT-KOД
  TYPIS:BASA,MTJ,SPEC
  W1,XTA,TИM+4
  ,ATX,MATHOMEP
  ,XTA,Ш/ДИCП
  ,AAX,BITJ
  ,AEX,BITJ
  ,UZA,TONБOБ
  NOBOBIN,VIM,BWOR
  ,XTA,NAME
  ,AEX,FULWOR
  ,ASN,64+9
  ,UZA,TON БOБ
  ,XTA,NAME
  ,FUN,202B
  SPEC,MTJ,BASA
  ,AOX,CБOБ
  TONБOБ:,BSS,
  ,ATX, БOБ
  ,XTA,RESULT
  ,UZA,TAPEABS
  ,ASN,64-42
  ,AUX,CON1
  ,AOX,CON2
  TONMF:,ATX,NMF
  W1,VTM,MATHOMEP
  ,XTA,BITJ
  ,AAX,Ш/CЛYЖ
  ,UZA,TELL
  :,24,
  ,XTA,NUM*TL
  :,24,3
  ,AAX,B41
  TELL:,ATX,TAPCNT
  ,ITA,W1
  ,AOX,TAPCNT
  14,CALL,TTPRINT1
  SPEC,MTJ,BASA
  ,UJ,EXIT
  BWOR:,XTA,TBW
  ,UJ,TONБOБ
  TAPEABS:,XTA,C/1
  ,UJ,TONMF
C
C.. БЛOK OTKAЗA OT CBOИX ЛEHT
C
  REF/FATA:TAPE,VTM,-LTF
  SPEC,VTM,EFATA-ET1
  REFTAP:,BSS,
  RT1:,BSS,
  SPEC,UTC,
  TAPE,XTA,ET1
  ,ATX,IDENT
  ,ASN,64+42
  ,AEX, Д H З
  ,U1A,ELOOPRT
  ,XTA,IDENT
  ,ASN,64+36
  ,AAX,C77
  ,ATI,W1
  ,ARX,B4
  ,ASN,64+5
  ,UIA,USEMN
  W1,UTM,30B
  USEMN:,BSS,
  W1,XTA,B48-30B
  NOREADY,VIM,GIVSCAL
  ,AAX,NAME
  ,UZA,ELOOPRT
  SPEC,VZM,NOFATA
  ,ITA,W1
  ,ASN,64-36
  ,ATX,MATHOMEP
  ,XTA,
  ,ATX,NMF
  ,ITA,14
  ,ARX,INGU
  14,MTJ,W1
  ,*57,-1
  W1,MTJ,14
  ,AEX,=6HOTЛYП
  ,U1A,SETRET
C
C....  ЗAДAЧE - ПOBTOPHЫЙ BXOД
C
  13,VTM,-11
  15,VTM,R1+1
  :,24,2003B
  12,VTM,2013B
  12,MTJ,27B
  12,VTM,AFT/WAIT
  12,MTJ,33B
  ,XTA,R32
  ,STI,32B
  R1/12:13,STI,12
  13,VLM,R1/12
  ,STI,13
  ,XTA,NAME.BOCCT.
  ,STX,SAVAC.CYMMATOPA
  ,ATI,15
  ,XTA,REGIM.И14+И27
  ,ATX,SAVAR
  ,XTR,NAME+1.PAY
  13,MTJ,16
  ,CALL,SAVE MOD
  ,XTA,BITJ
  ,AOX,WAITPOST
  ,ATX,WAITPOST
  ,XTA,REP/UP
  ,UJ,SEMUP
  REP/UP:,Z00,SEM/NR57
  ,Z00,CLANEWTA
  NO FATA:,24,2003B
  ,XTA,B1
  TAPE,ATX,T1+47
C.. BOCCT.CTATYCA ИMEHOB.MЛ
  TAPE,XTA,B1
  ,ASN,64-16
  ,AEX,FULWOR
  ,AAX,MISTERX
  ,ATX,MISTERX
C.. BOCCTAHOBЛEHИE  WRIT.-
C.. И CONTR.- БИTOB.
 TAPE,XTA,B1
 ,AOX,STWRIS
 ,ATX,STWRIS
 TAPE,XTA,B1
 ,AOX,CHECKWR
 ,ATX,CHECKWR
 SETRET:RET,VTM,
  ,UJ,ELOOPRT
C...
  GIV SCAL:,BSS,
C...  ЭK- ,*57,4040B - ЗAПPOC
C...  ШKAЛЫ MAT.HOMEPOB ЛEHT/ФAЙЛOB
  ,AOX,RESULT
  ,ATX,RESULT
  ELOOPRT:,24,3
  TAPE,VLM,RT1
  SPEC,VZM,REF/FATA
 RET,V1M,EXIT
  5,CALL,OPENWAIT
C
C
C.. BЫXOД ИЗ HEPEЗИДEHTA
C
C====================================
C  ПO BЫXOДE ИЗ ЭKCTPAKOДA
C  И14 COДEPЖИT HOMEP ПOCЛEДHEЙ ЗOHЫ
C  ДЛЯ CПEЦ.ФAЙЛA ИЛИ 777B ДЛЯ MЛ
C  HA CYMMATOPE CЛEДYЮЩAЯ ИHФOPMAЦИЯ:
C  1-6 P-ДЫ : ФИЗ.HOMEP HAЙДEHHOЙ MЛ
C            ( 0, ECЛИ MЛ HET )
C  48 P. : COCT.ЗAПИCИ (0-ECTЬ,1-HET)
C  47 P. : COCT.ГOTOBH.  -''-
C  46 P. : COCT.ЗAHЯTOCTИ (0-CBOБOДHA)
C      ПO CПEЦ-OБPAЩEHИЮ YCTAHABЛИBAETCЯ
C  45 P. : (1-ИMEHOB.MЛ, 0-HET)
C====================================
  EXIT:,24,2003B
  13,VTM,-12
  15,VTM,R1+1
C.. BOCCTAHOBЛEHИE ИHДEKC-PEГИCTPOB
  RIND:13,STI,12
  13,VLM,RIND
  ,STI,13
  ,XTA,RESULT
  ,STX,SAVAC.USER-Y
  ,ATI,15
  ,XTA,R32.AДPEC
  ,ATI,33B.BOЗBPATA
C.. BЫTACKИBAEM PEЖИM BOЗBPATA
  ,XTA,REGIM
  ,ASN,64-45
  ,UZA,USER
  ,AUX,C2003
  ,AOX,B4
  USER:,ATI,27B
  ,ITA,BASA
  ,ARX,W/UP
  ,UJ,SEMUP
  W/UP:,Z00,SEM/NR57
  ,Z00,AFT/UP-*****
  AFT/UP:,BSS,
  ,XTR,NAME+1
  ,XTA,WRET
 ,WTC,LSTZON
 14,VTM,
  ,UJ,NRESOFF
  WRET:,Z00,NR//SEAR
       ,Z00,NEWTA
  INGU:13,Z07,7241B
  8,Z05,MATHOMEP-*****
  MATHOMEP:,LOG,
  NMF:,LOG,
  БOБ:,LOG,
     :,LOG,
  C/1:,ISO,6H'1''1''1''1''1'
  CБOБ:,ISO,6HБ-''''''''
  TBW:,ISO,6HБ-PAБ.
  TИM:,ISO,6HИM.MЛ
  TЗAH:,ISO,6HЗAHЯT
  THГT:,ISO,6HHEГOT.
  TЗП:,ISO,6H ЗAП.
  TЧT:,ISO,6HЧTEH.
  THET:,ISO,6HHET MЛ
  TAPCNT:,LOG,
  CON1:,GOST,6H000770
  CON2:,ISO,6HMФ-00
 LSTZON:,BSS,1
 SIR:,BSS,22
  ,END,
 SAVE MOD:,NAME,
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR,SAVS16
 RETURN:,SUBP,
C   -------------     YПPЯTЫBAHИE B ИПД
C       CYMMATOP HE COXPAHЯETCЯ
 ,ITA,15
 15,VTM,SAVI15
 ,ITS,14
 ,ITS,20B
 ,XTS,SAVI15
 ,ATI,15
 ,RTE,7777B
 ,ATX,SAVSR
 13,UJ,
 ,END,
 CALCOMP*:,NAME,
  *TAKCA:LC,BLOCK,(7),TIM
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42
 ,CONT,BIT41,BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34
 ,CONT,BIT33,BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26
 ,CONT,BIT25,BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18
 ,CONT,BIT17,BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10
 ,CONT,BIT9,BIT8,BIT7,BIT6,BIT5,BIT4,BIT3,BIT2,BIT1
 TEL OUT:,SUBP,
 RETURN:,SUBP,
 CLOPIR:,SUBP,
 CLOMIR:,SUBP,
 CLA NEW TA:,SUBP,
 NEW TA:,SUBP,
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR
 SCALES:LC,BLOCK,(3),STCLTA
  SMASAV:LC,BLOCK,SAVAC,
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
  OUT MACRO:,SUBP,
 YCTP:LC,BLOCK,ПИ(2),ПЛ(3),Y CALC,Y CDC608,Y CDC405
 CON TIME:LC,BLOCK,TПИ(2),TПЛ(3),TCALC,TCDC608,TCDC405
 ,CONT,TAЦПY(2)
  C14:,LC,1
 FUL WOR:,LC,1
  C3:,LC,1
C-------------------
  BEGIN:13,MTJ,16
  ,CALL,SAVEMOD
 ,XTA,Y CALC
  ,U1A,NO FREE
 ,XTA,ГYC
 ,ATX,Y CALC
 NO FREE:,AEX,ГYC
 ,ASN,64+42
  14,VTM,TB
  ,U1A,DIAGN.ЗAHЯT
 ,EXT,4102B
 ,AAX,BIT9
  14,VTM,TNR
  ,UZA,DIAGN.HEГOTOB
 ,EXT,4030B
 ,AAX,BIT13
  ,UZA,NO END
 ,XTA,SAVAC
 ,EXT,173B
  ,XTA,TIM
  ,WTC,ГYC
 ,A+X,110B
 ,WTC,ГYC
 ,ATX,110B
 ,MTJ,23
  ,UJ,OUT MACRO
C          ----------------------------
 NO END:,BSS,
 ,XTA,BIT37
 ,CALL,PERMIR .OTKP. MACKY 37P. ГPП
 ,XTA,BIT13  .OTKP. MACKY 13P. ПPП
 ,AOX,COMPIR
 ,ATX,COMPIR
 ,EXT,34B
C---
  CLOSJOB:14,VTM,2007B
  14,MTJ,27B
  14,VTM,BEGIN
  14,MTJ,33B
  ,UJ,CLANEWTA
C---
  DIAGN:,XTA,BITJ
  ,AOX,STCLTA
  ,ATX,STCLTA
  ,ITA,14
  14,VTM,CLOSJOB
  ,UJ,TEL OUT
  TB :,ISO,12HЗAH.CALCOMP''
  TNR:,ISO,12HBЫK.CALCOMP''
 ,END,
 MACRO61:,NAME,.
 *YCЫ:LC,BLOCK,Г Y C.
  SMASAV:LC,BLOCK,SAVAC
  OUTMACRO:,SUBP,
  NRESCALL:,SUBP,
  NR/LINE :,SUBP,
  SAVEMOD:,SUBP,
 14,VZM,*1
  14,UTM,1
  14,VZM,*2
  14,UTM,-1
C...   ЧTEHИE 1-7 TYMБЛ.PEГИCTPOB
  *3:,ITA,13
  ,WTC,ГYC
  ,ATX,104B
  13,VTM,-6
C---
  R PUL:,24,2003B
  13,XTA,7
  :,24,
  13,UTC,6
  14,ATX,
  13,VLM,R PUL
  :,24,2003B
C---
  ,MTJ,27B
  13,VTM,OUTMACRO
  ,WTC,ГYC
  ,XTA,104B
  ,ATI,16
  ,UJ,SAVEMOD
C...   ,*61,-1  YПPABЛEHИE VT-340
  *2:,ATX,SAVAC
  ,UTC,MICALL
  ,XTA,
  ,UJ,NRESCALL
  MICALL:,Z00,NR/LINE
  ,Z00,13
C...    I F P U L T
 *1:,WTC,Г Y C
 ,XTA,113B
 ,MTJ,27B
 2,32,
 ,END,.
 MACRO74 :  , NAME ,
C
C*****   ЭKCTPAKOД KOHЦA
C
  * И П Д :LC,BLOCK,(56),ШKП(7),SCENDJO
  ШK:,EQU,ШKП
  MOЖHOKAЧ:,EQU,*ИПД+67B
 NRES074 :  , SUBP ,
 DISPBASE:LC,BLOCK,(1),DISMBASE
   TPHYS :  ,  LC  , 32
  TMATH:,EQU,30B
   *YCЫ  :LC,BLOCK,ГYC,RDSCAL
  ШЛAГБAYM:,LC,1
  SEMUP:,SUBP,
  C77:,LC,1
  XNSEM:,EQU,*ИПД+7
  NSEMAF:,WEQ,XNSEM.ЧИCЛO CEMAФOPOB
  NSEM1:,EQU,NSEMAF-1
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 BASE:,EQU,5
 NP74    :  , P/P ,(NRES074)1024
 AP74:,P*P,(NP74)1024
 C37:,LC,1
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 AДPПEP:,EQU,85.ЯЧEЙKA ИПЗ
  ,WTC,ГYC
  14,VTM,TMATH
  14,XTA,
  ,ASN,64+30
  ,U1A,IS0PAGE
  ,XTA,BIT48.ЗAKAЗ
  14,AOX,.0 ЛИCTA, ECЛИ
  14,ATX,.EГO HE БЫЛO
  IS0PAGE:,BSS,
   :    ,24,2003B
  14,VTM,-NSEM1
C
C...  BO ИЗБEЖAHИE ПOPOЧHOГO KPYГA
C     HA CEMAФOPAX,  ПEPBЫM ДEЛOM
C     OCBOБOДИM BXOДЫ B KPИT.ИHTEPBAЛЫ.
C
  CLCRIN:14,XTA,ШЛAГБAYM+NSEM1
  ,AEX,ДHЗ
  ,AAX,C77
  ,UZA,TOSUP
  ECLCRIN:14,VLM,CLCRIN
  ,XTA,ZBITJ
  ,AAX,MOЖHOKAЧ
  ,ATX,MOЖHOKAЧ
 ,XTA,ШK.
  ,AAX,BITJ
 ,UIA,ПEPEXBAT.
  ,WTC,ГYC
  ,ATX,83.SCEM = 0 !
  ,XTA,BITJ
  ,AOX,SCENDJO
  ,ATX,SCENDJO
C...  ЗДECЬ HAДO И14=0
            ,  XTA  ,K04660         .
   ,  ARX  , DISMBASE               .
   :              ,   24  , 02000B        .
            ,  ATX  , 00001B        .
   :              ,   24  , 02003B        .
 CALL1MEM:,SUBP,.
 ,XTA,*+1.
 :,UJ,CALL1MEM.
 ,Z00,*+1.
 ,WTC,ГYC
 14,VTM,AДPПEP
 14,ATX,
 ,ITA,32B
 ,ASN,64-15
 14,AOX,
 14,ATX,
 ,ASN,64+10.
 ,AAX,C37
 ,ATI,14.
          14,  XTA  , TPHYS         .
   ,  AOX  , BIT1
          14,  ATX  , TPHYS         .
   ,  XTA  , BIT3
   ,  ATI  , 27B
   :     ,  24  , 2000B
            ,  *70  , 00001B        .
   :     ,  24  , 2000B
            ,  XTA  , 00001B        .
   :              ,   24  , 02003B        .
 ,WTC,ГYC
 ,WTC,AДPПEP
 BASE,VTM,NRES074-AP74
 BASE,UJ,
  ПEPEXBAT:,BSS,
  ,AEX,ШK
  ,ATX,ШK
 ,MTJ,27B.
 ,WTC,ГYC.
 ,WTC,AДPПEP.
 14,VTM,.
 14,V1M,ПEP1.
 14,VTM,20B.
 ПEP1:14,MTJ,32B.
 2,IJ,.
C...   OCBOБOЖДEHИE KPИT.ИHTEPBAЛA
  TO SUP:,ITA,14
   ,ASN,64-24
  ,ARX,IWUP
  ,UJ,SEMUP
  IWUP:,Z00,ШЛAГБAYM+NSEM1
  ,Z00,ECLCRIN
 K04660  :  ,  010  ,
     ,  Z00  , NP74
   ,END,.HY, BOЛKOB, ...!
 MACRO7CH:,NAME,
 INF7CH:LC,BLOCK,NЗAД,W110,NЗCB,W107,FER
 ,CONT,ADR,FZ,RW,BUNL,SCAL
 ,CONT,(3)
 NRESCALL:,SUBP,
 DISREG:,LC,1
 SMASAV  :LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR
  , CONT ,SAVS16
 NRES7CH:,SUBP,
  ,ATX,SAVAC
 ,XTA,INF
 ,UJ,NRESCALL
 INF:,Z00,NRES7CH
  ,Z00,15.БAЗ.PEГ.
C
C=== BXOД ДЛЯ OTKPЫTИЯ ЗAДAЧИ CBЯЗИ
C
  R37B:,ENTRY,
  BNR7CH:,LC,1
  RETURN:,SUBP,
  NR7CH :,SUBP,
  OPENW7:,SUBP,
  NEWTA:,SUBP,
  15,VTM,NEWTA
  R37BR:,ENTRY,.BXOД ИЗ TASK70
  ,XTA,BNR7CH
  15,UZA,
  ,ATI,13
  13,UJ,OPENW7-NR7CH
    ,END,
 NR7CH:,NAME,
 FULWOR:,LC,1
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,(2),M1RDSC,STCLTA
 TPHYS:,LC,32
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 SMASAV  :LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR
  , CONT ,SAVS16
 *ИПД:LC,BLOCK,(63),SCENDJO
 R37B:,SUBP,
 R37BR:,SUBP,
 INF7CH: LC,BLOCK,NЗAД,W110,NЗCB,W107
 ,CONT,FER,ADR,FZ,RW,BUNL,SCAL
 ,CONT,FBACK,STPLINK
 ,CONT,FLACT70
 *LINKPAR:LC,BLOCK,SC/NL,SC/CONC
 ,CONT,TOTBBЗBП(0),TПYCП(8)
 C7777:,LC,1
  DISREG  :,LC,1
  READSCAL:,LC,1
  NRESCALL:,SUBP,
  NRESOFF :,SUBP,
  NRES7CH :,SUBP,
  SCCLJ:,LC,1
  Д H З   :LC,BLOCK,(1),BITJ,ZBITJ
  *102    : B,BLOCK,M*32,M*12,M*13
  ,CONT,M*15,M*XTR,LISTCBЗ
  MNEVM:,EQU,=774 0000
  BUZ  :,EQU,=160 0000
 CLANEWTA:,SUBP,
 RETURN:,SUBP,
  NEWTA:,SUBP,
 OUTMACRO:,SUBP,
 TTPRINT:,SUBP,
 CONTIME:LC,BLOCK,TПИ(2),TПЛ(3),TCALC,TCDC608,TCDC405
 ,CONT,TAЦПY(2),TCB
 TIME10:,SUBP,
 BNR7CH:,LC,1
   RES:  ,EQU,SCAL
 MACRO74:,SUBP,
 C77777:,LC,1
 C1400:,LC,1
 C37:,LC,1
 C1:,EQU,BIT1
 C77:,LC,1
 C3:,LC,1
 C7:,LC,1
 C377:,LC,1
 C177:,LC,1
C -------
 ALNBUF: ,EQU,435B
 DELREF: ,EQU,1040B
 FLERPRL:,EQU,1757B
 TELIS:,EQU,436B
 DEL74:,EQU,1760B
C -------
 ERRMACRO:,SUBP,
 BNR5:,BSS,
  15,REL,*
  ,ITA,15
  ,ATX,BNR7CH
  ,XTA,DISREG
  ,ATI,27B
  SET15:,XTA,BNR7CH
  ,ATI,15
  ,XTA,W110
  ,UZA,WORK
  CLOSE:,XTA,BITJ
  ,AOX,SCCLJ
  ,ATX,SCCLJ
  15,UTM,SET15-BNR5
  15,MTJ,33B
  ,UJ,CLANEWTA
  WORK:,XTA,NЗAД
  ,UZA,BEGIN
  ,AEX,ДHЗ
  ,U1A,CLOSE
  BEGIN:,WTC,ГYC
  15,VTM,M*32
  ,ITA,32B
  ,ITS,12
  ,XTS,SAVI13
  ,XTS,SAVI15
  ,XTS,SAVSR
  ,XTS,
  ,ATX,RES
  ,ATX,FER
  ,XTS,BNR7CH
  ,ATI,15
  ,XTA,=7777 7777 7777 7400
  ,AAX,COMPIR
  ,ATX,COMPIR
  ,EXT,34B
  ,ATI,
  ,XTA,ДHЗ
  ,ATX,NЗAД
  ,XTA,SAVI14
  ,AEX,C7
  ,UZA,ЭKOБM
  ,AEX,=500
  ,UZA,ГOTBБ6
  ERPR:,24,2003B
  14,VJM,ERRMACRO
  :,GOST,12HЭKCT. CBЯЗИ'231'
  ,BSS,
C
C---------------------------------------
C
C  ЭKCTPAKOД OБMEHA C ПEPEФ. ЭBM (,*56,7)
C
C   ПPИ OБPAЩEHИИ HA CYMMATOPE:
C   01-15 - AДP. OБMEHHOГO ЛИCTA
C   17-24 - HOMEP ЛИHИИ
C            21 - ЛBTA(M-6000)
C            22 - OHMY(M-6000)
C            23 - PXЛ (M-220)
C            24 - ЛBTA(EC-1010)
C   28    - HAПPABЛEHИE OБMEHA
C            1 - B БЭCM-6
C            0 - ИЗ БЭCM-6
C   29-30 - ДЛИHA ПOPЦИИ OБMEHA
C            00 - 8
C            01 - 256+8
C            11 - 1024+8
C   31-33 - TИП ФAЙЛA(ДЛЯ KOHЦEHTPATOPA)
C            1 - ПOДCKAЗKA ДЛЯ READ
C            2 - CTPOKA WRITE
C            3 - ЛИCTИHГ
C            4 - CTATYC ЗAДAЧ
C            5 - PEЗYЛЬTAT RUN'A
C            6 - HET ЛИCTИHГA
C ----------
C  CYMMATOP HA BЫXOДE:
C    1 - E O F
C    6 - HET ПYC-П
C    7 - HET BЗB-П
C    8 - HET KOHЦA OБMEHA
C    9 - OШ. БAЙTA
C   10 - OШ. OБMEHA
C   11 - HET ГOT-П
C   12 - BCTPEЧHЫЙ BЫЗOB
C
C   25 - COOБЩEHИE OПEPATOPY БЭCM-6
C   26 - ИГHOPИPOBATЬ ФAЙЛ
C   27 - CTPOKA ДЛЯ READ
C   28 - ЗAПPOC O CTATYCE ЗAДAЧ
C   29 - ЗAПPOC ЛИCTИHГA
C
C        (27-29 PP. - ДЛЯ KOHЦEHTPATOPOB)
C
C-----------------------------------------
C
 ЭKOБM:,XTA,SAVAC
 ,ATX,INFE
 ,ATI,14
 ,AAX,=10 1777
C  ЛИШHИE PAЗPЬДЫ B ИHФOPMAЦИOHHOM CЛOBE ЭKCTPAKOДA
 ,U1A,ERPR
 ,XTA,INFE
  ,ASN,64+33
 ,ATX,ADR8
 ,XTA,SC/NL
 ,ASN,64-16
 ,AAX,INFE
 ,UZA,ERPR
 ,ATX,NL
 ,ANX,
 ,YTA,
 ,U1A,ERPR
C ---
C        OПPOC ГOT-П
C ---
 ,XTA,NL
 ,ASN,64+16
 ,ATX,NL
 ,AAX,SC/CONC
 ,UZA,ЭKOБM1
 ,033,37B
 ,033,4037B
 ,AAX,BIT22
 ,UZA,HETГOTП
C ---
C      OПPOC  П P П
C ---
 ,033,4034B
 ,AAX,NL
 ,UIA,YЖEBЗBП
 ЭKOБM1:,BSS,
 ,XTA,INFE
 ,AAX,=60 0000 0000
 ,UZA,DTASK
  ,XTA,INFE
  ,APX,BIT28
  ,AUX,BITJ
  ,AOX,READSCAL
  ,ATX,READSCAL
   :   ,24,2000B
 14,XTA,
   :   ,24,2003B
  ,XTA,ZBITJ
  ,AAX,READSCAL
  ,ATX,READSCAL
 ,ITA,14
 ,ASN,64+10
 ,ATI,14
 ,WTC,ГYC
 14,XTA,30B
 ,ASN,64+30
 ,AAX,C177
 ' ФИЗИЧECKИЙ HOMEP ЛИCTA OБMEHA
  ,WTC,ГYC
 ,ATX,LISTCBЗ
 ,ATI,14
 ,ASN,64-41
 ,AUX,MNP
 ,ATX,NFL
 14,XTA,TPHYS
 ,AOX,BIT1
 14,ATX,TPHYS
 DTASK:,BSS,
   :   ,24,3
 ,XTA,INFE
 ,ASN,64+16
 ,ATX,WL
 ,AAX,C1400
 ,ATX,NC
 ,XTA,WL
 ,AAX,SC/NL
 ,ATX,NL
 ,ASN,64-40.ПOЛYЧEHИE
 ,ANX,C77777.BOCЬMEPИЧHOГO
 ,AAX,C77777.HOMEPA
 ,ATX,BNL.ЛИHИИ
 ,XTA,WL
 ,ASN,64-4
 ,ATX,WL
 ,AAX,BIT15
 ,ATX,PEOF
 ,XTA,WL
 ,AAX,BIT16
 ,ATX,FW
 ,XTA,WL
 ,AAX,=0000 0000 0060 0000
 ,ATX,LENGTH
 ,XTA,WL
 ,ASN,64+18
 ,AAX,C7
 ,ATX,SORTINF
 ,UZA,/1/
 ,XTA,FW
 ,UIA,ERPR
 ,XTA,SC/CONC
 ,AAX,NL
 ,UZA,ERPR
 /1/:,BSS,
   :   ,24,2003B
 ,XTA,744B
C
C  ////  ГOT-Ц
C
 ,033,37B
C ==
C  BЫДAЧA BЗB-Ц + БAЙT OБMEHA
C ==
 BЗBHAOБM:,XTA,LENGTH
 ,AOX,FW
 ,AOX,NC
 ,ATX,BUW
 ,XTA,
 ,ATX,J
 EK1:,XTA,
 ,ATX,I
 12,VTM,OTBHAЗAП
 BЗB:,XTA,BUW
  BЗB1:,BSS,
 13,VJM,CHBT
 ,AOX,730B
C
C  ////  BЗB-Ц
C
 ,033,37B
 ,AOX,BIT41
 13,VJM,PUTPRL
 13,VTM,BЗBR
 ,UJ,PR31
C ==
C  AHAЛИЗ OTBETHOГO БAЙTA
C ==
 OTBHAЗAП:,BSS,
 ,XTA,FTIME
 ,U1A,TEX
 ,XTA,BUNL
 ,AEX,BEQ
 ,U1A,ER1
 12,VTM,KOHEЦOБM
 ,XTA,FW
 ,U1A,ERW
 ,XTA,ADR8
 ,UZA,ERW1
 13,VTM,-7
 ,XTA,ADR8
 ,ATI,14
 RW8:,BSS,
   :   ,24,2000B
 14,UTC,
 13,XTA,7
   :   ,24,2003B
 13,ATX,77B
 13,VLM,RW8
 13,VTM,-7
 BЫT:,ATX,1
 13,VLM,BЫT
 ,UJ,ERW
 ERW1:,BSS,
 ,XTA,PEOF
 ,ASN,64+14
 ,ATX,77B
 ,XTA,SORTINF
 ,ATX,76B
 ,XTA,N OБM
 ,ATX,75B
C --
C  ПOДГOTOBKA KYCA
C --
 ERW:,BSS,
 ,XTA,LENGTH
 ,UZA,L8
 ,AEX,BIT17
 ,UZA,L256
 ,XTA,
 DIR:,AOX,NFL
 DIR1:,BSS,
 ,ATX,WL
 ,XTA,NL
 ,ASN,64-41
 ,ANX,
 ,AEX,=60
 ,UZA,ADL
 ,AEX,=60
 ,ASN,64-7
 ADL:,AOX,WL
 ,ATX,WL
 ,XTA,COMPIR
 ,AAX,=7777 7777 7777 7400
 ,ATX,COMPIR
 ,033,34B
 ,ATI,
 ,XTA,FW
 ,UZA,TR
 ,XTA,BIT18
 TR:,BSS,
 ,AOX,WL
C
C  ////  OБMEH
C
C --  YCTAHOBKA 25 P. ГPM
 ,033,7
 ,ATI,
 ,002,237B
 ,AAX,BIT25
 ,U1A,ERL
 ,XTA,COMMIR
 ,AOX,727B
 ,ATX,COMMIR
 ,002,36B
 ,ATI,
 ,XTA,NOБM
  ,AAX,=0017 7777 7777 7777
 ,AOX,BIT45
 13,VJM,PUTPRL
 ,XTA,NOБM
 ,ARX,BIT1
 ,ATX,NOБM
 ,XTA,TOБM
 ,ATX,CBTIME
 ,XTA,BIT3
  13,VTM,CLANEWTA
  ,UJ,TIM ON
 L8:,XTA,BIT21
 ,UJ,DIR1
 L256:,XTA,BIT20
 ,UJ,DIR
 ERL:,BSS,
 ,33,111
C ==
C  ПOЛYЧEHИE PEЗYЛЬTATOB OБMEHA
C ==
 KOHEЦOБM:12,VTM,OTBHAKOH
 ,XTA,FTIME
 ,UZA,KOБM/
  ,XTA,
  ,ATX,FTIME
 ,XTA,BIT8
 ,ATX,FER
 ,UJ,OШOБM
 KOБM/:,BSS,
 ,XTA,FW
 ,UZA,БYKOHEЦ
 ,XTA,ADR8
 ,UZA,RR
 13,VTM,-7
 ,XTA,ADR8
 ,ATI,14
 RR8:13,XTA,77B
   :   ,24,2000B
 14,UTC,
 13,ATX,7
   :   ,24,2003B
 13,VLM,RR8
   :   ,24,2003B
 RR:,BSS,
 ,XTA,FER
 ,AAX,BIT8
 ,U1A,OШOБM
 ,XTA,77B
 ,AAX,BIT1
 ,ATX,RES
 ,XTA,77B
 ,AAX,=76
 ,ASN,64-23
 ,AOX,RES
 ,ATX,RES
 ,XTA,SC/CONC
 ,AAX,NL
 ,UIA,БYKOHEЦ
 ,XTA,RES
 ,AAX,=3 0000 0001
 ,ATX,RES
C ==
C  BЫДAЧA BЗB-Ц + БAЙT 64B
C ==
 БYKOHEЦ:,XTA,BUEND
  БYKOH1:,BSS,
 ,AOX,NC
  ,UJ,BЗB1
C ==
C  AHAЛИЗ OTBETHOГO БAЙTA
C ==
 OTBHAKOH:,BSS,
 ,XTA,FTIME
 ,U1A,TEX
 ,XTA,FER
 ,AAX,BIT8
 ,U1A,CHREP
 ,XTA,BUNL
 ,AEX,BEQ
 ,UZA,EXIT
C --
C  ПOBTOPEHИE OБMEHA ПPИ CБOE
C  AППAPATYPЫ ИЛИ HECOBПAДEHИИ
C  OTBETHOГO БAЙTA KOHЦA.
C --
 CHREP:,BSS,
 ,XTA,J
 ,ARX,C1
 ,ATX,J
 ,AEX,C3
 ,UZA,OШOБM3P
 ,XTA,BIT20
 ,AOX,BUW
 ,ATX,BUW
 ,UJ,EK1
 OШOБM:,XTA,BUERM
 ,UJ,БYKOH1
C ---
C         H E T  Г O T - П
C ---
 HETГOTП:,BSS,
 ,XTA,BIT11
 ,ATX,RES
 ,UJ,EXIT
C -----------------------
C    BИCИT BCTPEЧHЫЙ BЗB-П
C -------------------------
 YЖEBЗBП:,XTA,BIT12
 ,ATX,RES
 ,UJ,EXIT
C --
C  OБMEH HE ПPOШEЛ 3 PAЗA
C --
 OШOБM3P:,BSS,
 ,XTA,BIT10
 ,ATX,RES
C ==
C    B Ы X O Д
C ==
 EXIT:,BSS,
 ' PACФИKCAЦИЯ ЛИCTA OБMEHA
  ,WTC,ГYC
 ,XTA,LISTCBЗ
 ,UZA,EXC
 ,ATI,14
 14,XTA,TPHYS
  ,AOX,BIT1
 ,AEX,BIT1
 14,ATX,TPHYS
 EXC:,BSS,
 ,XTA,SCCLJ
 ,AOX,RDSCAL
 ,ATX,RDSCAL
 ,XTA,
 ,ATX,FZ
 ,ATX,SCCLJ
 ,ATX,W110
 ,ATX,RW
 ,ATX,NЗAД
 ,ATX,NC
 ,ATX,NL
 ,ATX,FTIME
 ,XTA,COMPIR
 ,AAX,=7777 7777 7777 7400
 ,ATX,COMPIR
 ,XTA,NЗCB
 ,UZA,GOTOUT
 ,AEX,ДHЗ
 ,UZA,PINT
  ,XTA,W107
 ,U1A,PINT
 ,XTA,FLACT70
 ,UZA,SETM
 ,XTA,BIT1
 ,ATX,W110
 ,ATX,FBACK
 ,XTA,NЗCB
 ,ATX,NЗAД
  15,UTM,PINT-BNR5
 ,UJ,R37BR
 SETM:,BSS,
 ,XTA,6
 ,ASN,64+40
  ,AEX,FULWOR
  ,AAX,COMPIR
 ,AOX,SC/CONC
 ' ЗAKPЫTИE HEИCПPABHЫX ЛИHИЙ
 ,ATX,COMPIR
 PINT:,BSS,
 ,XTA,COMPIR
 ,033,34B
 EX1:,ATX,1
 ,XTA,RES
 ,AOX,BIT46
 13,VJM,PUTPRL
  ,XTA,STPLINK
  ,AAX,BITJ
 ,UZA,EX3
 ' БЫЛ BЫБPOC BO BPEMЯ PAБOTЫ ЭKCTPAKOДA
 ,AEX,STPLINK
 ,ATX,STPLINK
 ,UJ,MACRO74
 GOTOUT:,BSS,
C  ---   CHЯTИE ГOT-Ц,ECЛИ HET
C  ---   ЗAДAЧИ CBЯЗИ
 ,XTA,745B.BIT11
 ,033,37B
 ,UJ,PINT
 EX3:,BSS,
  ,XTA,RES
  ,ATX,SAVAC
  ,WTC,ГYC
  15,VTM,M*XTR+1
  ,XTA,
  ,STI,27B
  ,STX,SAVSR
  ,STX,SAVI15
  ,STX,SAVI13
  ,STI,12
  ,STI,33B
  ,UJ,RETURN
 ' ЗAHECEHИE БИTA B ШKAЛY HEИCПPABHЫX ЛИHИЙ
 LOFF:,BSS,
 ,XTA,RES
 ,AOX,BIT24
 ,AOX,BIT14
 ,ATX,RES
 ,UJ,EXC
C --
C  ПOBTOPEHИE OБMEHA ПPИ
C  HECOBПAДEHИИ OTBETHOГO БAЙTA
C  OБMEHA.
C --
 ER1:,XTA,I
 ,ARX,C1
 ,ATX,I
 ,AEX,C3
 ,UIA,PRECALL
 ,XTA,BIT9
 ,ATX,RES
 ,UJ,EXIT
 PRECALL:,XTA,BUW
 ,AOX,BIT20
 ,ATX,BUW
 ,UJ,BЗB
C -- ПOДГOTOBKA ПPEP. ПO 31P ГPП
 PR31:,BSS,
 ,XTA,COMPIR
 ,AAX,=7777 7777 7777 7400
 ,ATX,COMPIR
 ,033,34B
  ,XTA,721B
 ,AOX,COMMIR
 ,ATX,COMMIR
 ,002,36B
 ,ATI,
 ,ITA,13
 ,ATX,ADR
  13,VTM,CLANEWTA
  PR31A:,BSS,
  ,WTC,BNL
  ,XTA,TПYCП
  ,ASN,64+12
  ,AAX,C7777
  ,ATX,CBTIME
  ,XTA,BIT1
  TIM ON:,ATX,SW
  ,ATX,TIME
  14,VTM,PRTIMECB
  ,ITA,14
  ,ATX,TCB
  13,UJ,
C ==
C  AHAЛИЗ БAЙTA ЗAПPOCA HA OБMEH
C ==
 ЖДYBЗBП:,BSS,
 12,VTM,LIN2
 ,XTA,
 ,ATX,FLACT70
 ,XTA,FBACK
 ,UZA,ЖДY1
C -----------------------------------
C   COOБЩEHИE OT OПEPATOPA БЭCM-6
C -----------------------------------
 ACT:,BSS,
 ,XTA,BIT24
 ,AOX,BIT15
 ,ATX,W107
   ,ATX,RES
 ,XTA,
 ,ATX,FBACK
 ,UJ,EXC
 ЖДY1:,BSS,
 ,XTA,RW
 ,AAX,C1400
 ,ATX,NC
 ,XTA,RW
 ,AAX,SC/CONC
 ,UZA,ACT
 ,ATX,NL
 ,ATX,RES
 ,ATX,W107
 ,ASN,64-40
 ,ANX,C77777
 ,AAX,C77777
 ,ATX,BNL
 ,XTA,FTIME
 ,U1A,LOFF
 ,XTA,BBT
 ,AOX,NC
 13,VJM,CHBT
 ,XTA,BUNL
 ,AAX,MASK
  ,AOX,NL
 ,AEX,BEQ
 ,U1A,BER
 ,ATX,FLER60
C =====================================
C  BЫДAЧA BЗB-Ц + БAЙT 60B (260B)
C =====================================
C ==
 ,XTA,BEQ
 ,AOX,730B
 ,AOX,BBT
 B60/260:,BSS,
C
C  //// BЗB-Ц
C
 ,033,37B
 ,AOX,BIT41
 13,VJM,PUTPRL
 13,VTM,R37B
 ,UJ,PR31
 LIN2:,BSS,
 ,XTA,FTIME
 ,UIA,LOFF
 LIN3:,BSS,
 ,XTA,FLER60
 ,UZA,LIN33
 ,XTA,BIT13
 ,AOX,RES
 ,ATX,RES
  ,UJ,ЖДY2
 LIN33:,BSS,
 ,XTA,COMPIR
 ,AAX,=7777 7777 7777 7400
 ,ATX,COMPIR
 ,033,34B
 ЖДY2:,BSS,
 ,XTA,RES
 ,AOX,BIT24
 ,ATX,RES
 ,UJ,EXC
C --
C  ПPИHЯT HE БAЙT 60B
C --
 BER:,ATX,FLER60
 ,XTA,BUER
 ,AOX,NC
 13,VJM,CHBT
 ,AOX,730B
 ,UJ,B60/260
C =====================================
C  ЭKCTPAKOД OЖИДAHИЯ BЫЗOBA OT ЭBM-П
C        ( ,*56,507B )
C
C      CYMMATOP HA BЫXOДE:
C  1) 24P=1,1-8PP=NL => BЫЗOB ЭBM-П
C  2) 24P=1,13P=1,1-8PP=NL =>
C           HEПPABИЛЬHЫЙ BЫЗOB ЭBM-П
C  3) 24P=1,14P=1,1-8PP=NL =>
C     HET ПYC-П ИЛИ HE CБPOШEH BЗB-П
C  4) 24P=1,15P=1 => COOБЩEHИE OT
C     OПEPATOPA БЭCM-6
C
C ====================================
C
 ГOTBБ6:,BSS,
 ,XTA,744B
C
C  ////  ГOT-Ц
C
 ,033,37B
 12,VTM,ЖДYBЗBП
 ,XTA,NЗAД
 ,ATX,NЗCB
 ,XTA,
 ,ATX,NЗAД
 ,XTA,6
 ,ASN,64+40
 ,ATX,WL
 ,XTA,SC/CONC
 ,AOX,WL
 ,AEX,WL
 ,ATX,WL
 ,033,4034B.OПPOC ПPП
 ,AAX,WL
 ,UIA,CLJ
C   ---  HET ЛИ PRINT'OB
 ,XTA,TELIS
 ,UIA,CH70
 ,XTA,TELIS+1
 ,UIA,CH70
 CHTEL1:,BSS,
 ,XTA,ALNBUF
 ,UZA,CLJ
 ,ATI,13
 14,VTM,1-16
 L507:13,UTC,
 14,XTA,15
 13,UTC,DEL74
 14,AOX,15
 ,UIA,RET507
 14,VLM,L507
 CLJ:,BSS,
 ,XTA,COMPIR
 ,AOX,WL
 ,ATX,COMPIR
 ,033,34B
 ,XTA,COMMIR
 ,AOX,BIT37
 ,ATX,COMMIR
 ,002,36B
 ,ATI,
 ,XTA,
 ,ATX,W107
 ,ATX,RW
 ,ATX,FZ
 ,UJ,CLANEWTA
 CH70:,ASN,64+8
 ,AEX,=60
 ,AAX,=374
 ,UZA,CHTEL1
 RET507:,BSS,
 ,XTA,BIT24
 ,AOX,BIT15
 ,ATX,W107
 ,ATX,RES
 ,XTA,
 ,ATX,FLACT70
 ,UJ,EX1
C -- ДOПOЛHEHИE БAЙTA ДO HEЧETA
 CHBT:,BSS,
 ,ATX,WL
 ,ACX,
 ,ASN,64+1
 ,YTA,
 ,U1A,BE
 ,XTA,WL
 ,AOX,733B
 ,ATX,WL
 BE:,XTA,WL
 ,AOX,NL
 ,ATX,BEQ
 ,XTA,NL
 ,ATX,100B
 ,XTA,BEQ
 13,UJ,
C ------------------------------
C    ЗAПИCЬ CИГHAЛA B ПPOTOKOЛ
C            CBЯЗИ.
C ------------------------------
 PUTPRL:,BSS,
 ,ATX,WL
 ,XTA,6
 ,AAX,BIT40
 13,UZA,
 ,XTA,NЗCB
 13,UZA,
 ,XTA,ALNBUF
 13,UZA,
 ,ATI,14
 14,UTM,DELREF
 ,XTA,WL
 14,WTC,
 14,ATX,-1
 ,AAX,BIT46
 ,UZA,PPRL
 ,XTA,WL
 ,AAX,BIT24
 ,UZA,IFER7
 ,XTA,WL
 ,ASN,64+12
 ,ASN,64-46
 ,UZA,PPRL
 WR1757:,XTA,WL
 14,ATX,FLERPRL-DELREF
 PPRL:14,XTA,
 ,AEX,ENDCBUF
 ,UZA,CBUF
 ,AEX,ENDCBUF
 ,ARX,BIT1
 14,ATX,
 13,UJ,
 CBUF:,XTA,INT2
 14,ATX,
 13,UJ,
 IFER7:,XTA,WL
  ,AAX,=7740
 ,UZA,PPRL
 ,UJ,WR1757
C --
C  BЫXOД ПO ИCTEЧEHИЮ BPEMEHИ
C  OЖИДAHИЯ CИГHAЛA
C --
 TEX:,BSS,
 ,XTA,
 ,ATX,TIME
 ,XTA,SW
 ,ASN,64-5
 ,ATX,RES
 ,UJ,EXIT
 BЗBR:,BSS,
 ,XTA,
 ,ATX,FZ
 ,XTA,BNR7CH
  ,ATI,15
 ,XTA,FTIME
 ,U1A,R37B
 ,WTC,BNL
 ,XTA,TOTBBЗBП
 ,AAX,C7777
 ,ATX,CBTIME
 ,XTA,BIT2
  13,VTM,RETURN
  ,UJ,TIM ON
C --
C  CЧETЧИK BPEMEHИ OЖИДAHИЯ CИГHAЛA
C --
 PRTIMECB:,BSS,
 ,XTA,BNR7CH
  ,ATI,15
 ,XTA,NЗAД
 ,UZA,PTCB1
 ,XTA,STPLINK
 ,WTC,NЗAД
 ,AAX,BITS
 ,UIA,STPLI
 PTCB1:,BSS,
 ,XTA,TIME
 ,ARX,BIT1
 ,ATX,TIME
 ,AEX,CBTIME
 ,U1A,TIME10
C --  BPEMЯ OЖИДAHИЯ ИCTEKЛO
 STPLI:,BSS,
 ,XTA,
 ,ATX,TCB
 ,XTA,BIT1
 ,ATX,FTIME
 ,WTC,SW
 ,UJ,*
 :,UJ,NПYCП
 :,UJ,NOTBBЗBП
 :,33,30303B
 :,UJ,N KOБM
 NПYCП:,BSS,
 ,XTA,
 ,033,37B
 ,UJ,RETURN
 NOTBBЗBП:,BSS,
 ,XTA,COMPIR
 ,AAX,=7777 7777 7777 7400
 ,ATX,COMPIR
  ,033,34B
   ,XTA,
 ,UJ,R37B
 N KOБM:,BSS,
 ,XTA,BIT1
 ,033,31B
 ,UJ,RETURN
 TOБM:,LOG,200
 WL:,OCT,
 BUW:,OCT,
 BEQ:,OCT,
 BUEND:,LOG, 64 0000
 I:,OCT,
 J:,OCT,
 BUERM:,LOG,264 0000
 BUER:,LOG,260 0000
 BBT:,LOG,60 0000
 MASK:,LOG,777 0000
 MNP:,LOG,1 4037 0000
 INT2:,INT,2
 ENDCBUF:,INT,461
 NOБM:,LOG,1
 FLER60:,BSS,1
 LENGTH:,OCT,
 FW:,OCT,
 NFL:,OCT,
 PEOF:,OCT,
 INFE:,OCT,
 ADR8:,OCT,
 NC:,OCT,
  NL:,OCT,
 SW:,OCT,
 CBTIME:,OCT,
 TIME:,OCT,
 FTIME:,OCT,
 BNL:,OCT,
 SORTINF:,BSS,1
C
C
C===  BXOДЫ OT ПPEPЫBAHИЙ
C     (БЫBШИЙ PEЗИДEHT)
C
  15,REL,BNR5.*****
  KOHOБM7:,ENTRY,
  ,WTC,BNR7CH
  15,VTM,
  ,XTA,
  ,ATX,TCB
  ,XTA,BIT25
  ,CALL,CLOMIR
C --  OПPOC CXEM KOHTPOЛЯ OБMEHA
  ,XTA,.БЫЛO: ,EXT,4035B
 ,ATX,FER
 ,AOX,BIT47
  13,VTM,GO OPEN
 ,UJ,PUTPRL
 ПYCП:,ENTRY,
  ,WTC,BNR7CH
  15,VTM,
 ,XTA,
 ,ATX,TCB
C --  ГAШEHИE 31P,YCTAHOBKA 37P ГPM
 ,XTA,COMMIR
 ,AEX,721B
 ,AOX,713B
 ,ATX,COMMIR
 ,002,36B
 ,ATI,
C --  YCTAHOBKA NL B ПPM
 ,XTA,100B
 ,AAX,SC/NL
 ,AOX,COMPIR
 ,ATX,COMPIR
 ,033,34B
  13,VTM,RETURN
 14,VJM,IFEOJ
 ,XTA,ADR
 ,ATI,13
 14,VTM,R37R
 ,ITA,14
 ,AEX,ADR
 ,UZA,CБPOC
 ,XTA,BIT44
 ,UJ,PUTPRL
 CБPOC:,XTA,BIT48
 ,UJ,PUTPRL
 BЗBП:,ENTRY,
 ,033,4034B
  15,AAX,BITS.ИЗ EXTINTER
 ,UZA,RETURN
 ,ATX,100B
 ,ATX,W110
  ,WTC,BNR7CH
  15,VTM,
  ,AOX,731B
C
C  ////  ПYC-Ц, OПPOC KBM
C
 ,033,37B
 ,033,4037B
 ,AAX,MNEVM
  ,AOX,W110
  ,ATX,WL*
 ,AOX,BIT42
 13,VJM,PUTPRL
 ,XTA,BIT43
 13,VJM,PUTPRL
  ,XTA,
  ,ATX,TCB
  13,VTM,R37R
C --  ГAШEHИE 1-8 PP ПPM
 PR31A*:,XTA,COMPIR
 ,AAX,=7777 7777 7777 7400
 ,ATX,COMPIR
 ,033,34B
 ,XTA,721B
C --  YCTAHOBKA 31P ГPM
 ,AOX,COMMIR
 ,ATX,COMMIR
 ,002,36B
 ,ATI,
C --  ГAШEHИE 37P ГPП
 ,XTA,713B
 ,AEX,FULWOR
 ,ATI,
 ,002,37B
  ,ITA,13
 ,ATX,ADR
  13,VTM,RETURN
 14,VJM,IFEOJ
  ,UJ,PR31A
 R37R:,BSS,
 ,XTA,FZ
 ,U1A,ЗAHЯT
 ,XTA,NЗAД
 ,U1A,BЗB2
 ,XTA,W107
 ,U1A,ЗAHЯT
 ,XTA,NЗCB
 ,ATX,NЗAД
 BЗB2:,BSS,
  ,XTA,WL*
  ,ATX,BUNL
 ,AAX,SC/NL
 ,ATX,RW
  GO OPEN:,BSS,
  13,VTM,NEWTA
  ,UJ,OPENW7
C --
C  ПOДГOTOBKA BOЗBPATA ПO 12 ИP
C --
  OPENW7:,ENTRY,
  15,MTJ,13.BXOД ИЗBHE
  OPENW7:,WTC,BNR7CH
  15,VTM,
  14,VTM,NO EOJ
  IF EOJ:,XTA,NЗAД
  ,U1A,/10/
  ,XTA,NЗCB
  ,UZA,RETBAD
  /10/:,ATI,15
  15,XTA,BITS
  ,WTC,BNR7CH
  15,VTM,
  ,AAX,SCENDJO
  14,UZA,
  RET BAD:,BSS,
  ,XTA,COMPIR
  ,AAX,=7777 7777 7777 7400
  ,ATX,COMPIR
  ,EXT,34B
  ,ATI,
  ,XTA,SCCLJ
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  ,XTA,
  ,ATX,SCCLJ
  ,ATX,W110
  ,ATX,NЗAД
  ,ATX,NЗCB
  ,XTA,BIT25
  ,AOX,BIT31
  ,UJ,CLOMIR
  NO EOJ:,WTC,NЗAД
  14,VTM,
   :    ,24,2003B
 14,XTA,677B
 ,AOX,RDSCAL
 ,ATX,RDSCAL
 14,WTC,ГYC
  14,VTM,
  14,XTA,10
  14,ATX,3
  ,ATX,FZ
  ,XTA,DISREG
  14,ATX,5
  ,XTA,BNR7CH
  14,ATX,7.И15
  13,UJ,
 ЗAHЯT:,BSS,
  ,XTA,WL*
 ,AAX,SC/NL
 ,AOX,730B
 ,AOX,BUZ
 ,033,37B
 ,AOX,BIT41
  13,VJM,PUTPRL
  13,VJM,PR31A*
  ,XTA,SCCLJ
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  ,XTA,
  ,ATX,SCCLJ
  ,ATX,W110
  ,UJ,RETURN
  WL*:,BSS,1
 ,END,
 MACRO73:,NAME,.
 NRESCALL:,SUBP,.
 NR73:,SUBP,.
 ,XTA,NRINF.
 ,UJ,NRESCALL.
 NRINF:,Z00,NR73.
  ,Z00,15.БAЗA
 ,END,.
   NRES73:        ,NAME,                  .
   AW    :        ,EQU ,1                 .
 ДHЗ:,LC,1.
  TABLEMT:LC,BLOCK,(16),T1MT(48),T2MT(48),TANAMEMT(32)
 J1:,EQU,1.
 J2:,EQU,2.
 J3:,EQU,3.
 NAME:,EQU,114B
 M:,EQU,100B
 REGSCAL:,EQU,M
 MAXTIME:,EQU,111B
 I:,EQU,1
 J:,EQU,2
 TMATH:,EQU,30B
  I60/74:,EQU,85
 FULWOR:,LC,1
  C37:,LC,1
  C 7:,LC,1
  *677:B,BLOCK,BITS
  ,CONT,BIT48,BIT47,BIT46,BIT45
  ,CONT,BIT44,BIT43,BIT42,BIT41
  ,CONT,BIT40,BIT39,BIT38,BIT37
  ,CONT,BIT36,BIT35,BIT34,BIT33
  ,CONT,BIT32,BIT31,BIT30,BIT29
  ,CONT,BIT28,BIT27,BIT26,BIT25
  ,CONT,BIT24,BIT23,BIT22,BIT21
  ,CONT,BIT20,BIT19,BIT18,BIT17
  ,CONT,BIT16,BIT15,BIT14,BIT13
  ,CONT,BIT12,BIT11,BIT10,BIT9
  ,CONT,BIT8,BIT7,BIT6,BIT5
  ,CONT,BIT4,BIT3,BIT2,BIT1
  C77777:,LC,1
  C377:,LC,1
  C177:,LC,1
  C77:,LC,1
  C3:,LC,1
 15,REL,*.
 DISREG:,LC,1.
 NR73:,SUBP,.
 NRESOFF:,SUBP,.
 MACRO74:,SUBP,
 *YCЫ:LC,BLOCK,ГYC,RDSCAL.
  SEMDOWNS:,SUBP,
  SEMUP  :,SUBP,
 RETURN:,SUBP,
  ШЛAГБAYM:LC,BLOCK,(6),SCAL73
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR
 ,CONT,SAVS16.
 CLANEWTA:,SUBP,.
   S     :        ,EQU ,4                 .
 TELOUT:,SUBP,
 TODAY:,LC,1
 NRES73:,BSS,.
  ,ITA,15
 ,ATX,SAVAR.CПACEHИE БAЗЫ
  ,ARX,S/DOWN
  ,WTC,SAVI15
  15,VTM,
  ,UJ,SEMDOWNS
  S/DOWN:,Z00,SCAL73
  ,Z00,BEG///-NRES73
  BEG///:,BSS,
 ,WTC,SAVAR.BOCCTAHOBЛEHИE
 15,VTM,.БAЗЫ
C     ПPЯЧEM OCHOBHЫE PEГИCTPЫ
 ,XTA,SAVI15.
 ,ATX,IR15.
 ,ITA,15.
 ,ATX,SAVI15.
 ,XTA,SAVSR.
 ,ATX,SAVNTR.
 ,ITA,32B.
 ,ATX,ADDRET.
  ,XTA,C7
  ,ATI,27B
  ,WTC, Г Y C
  ,XTA,I60/74
  ,ASN,64+15
  ,ATX,ПPMБ
  ,U1A,BEGIN73
 ,WTC,ГYC.
 ,XTA,NAME.
 14,VJM,KODIR.
 ,ATX,INPTX+3.
 ,XTA,SAVI14.
 14,VJM,KODIR.
 ,ATX,INPTX+1.
C     BЫДAEM TEKCT : ГOTOBЫ K BBOДY
  14,VTM,BEGIN73
  ,UJ,TOTEL
 BEGIN73:,ITA,13.
 ,ATX,SAW.
C     AДPEC HAЧAЛA BBOДA
  ,XTA,BIT1
 ,ATX,ARRFLG.
C     ФЛAГ BBOДA MACCИBA
 ,ITA,14.
 ,ATX,NAMBER.
C     HOMEP MACCИBA
 14,VTM,-11.
 *1:14,ITA,12.
 14,ATX,SAVI1+11.
 14,VLM,*1.
 ,UJ,START
 ERROR73:,BSS,.
  ,XTA,ПPMБ
  ,U1A,MACRO74
  14,VTM,START
  TOTEL:,BSS,
   :   ,24,2003B.
  14,MTJ,33B
 14,VTM,INPTX.
 ,ITA,14.
  14,VTM,CLANEWTA
  ,UJ,TELOUT
    GAL/8:        ,OCT ,77777777 77777776 .
    GAN/2:        ,OCT ,62400000 00000000 .
    GAN/4:        ,OCT ,42400000 00000000 .
    GAN/5:        ,OCT ,36546314 63146315 .
    GAN/6:        ,OCT ,40177777 77777700 .
    GAN/7:        ,OCT ,77777777 77770237 .
    GAN/8:        ,OCT ,77777777 77777765 .
C     ПEPEBOД ПAP CИMBOЛOB
    GAO/1:        ,OCT ,07217037 05012412 .
    GAO/2:        ,OCT ,00026465 00000000 .
    GAO/3:        ,OCT ,17026000 14036471 .
    GAO/4:        ,OCT ,16675542 30020000 .
    GAO/5:        ,OCT ,00051124 00000000 .
    GAO/6:        ,OCT ,23447400 24252520 .
    GAO/7:        ,OCT ,37276173 36477400 .
    GAO/8:        ,OCT ,00177777 77777777 .
C     ДЛЯ ABTOKOДA
 TABLA0:,OCT,01202003 00400400
    GAP/2:        ,OCT ,16030411 02003406 .
    GAP/3:        ,OCT ,30677017 11623067 .
    GAP/4:        ,OCT ,12622457 16424476 .
    GAP/5:        ,OCT ,31465377 15074066 .
    GAP/6:        ,OCT ,62711723 46027147 .
    GAP/7:        ,OCT ,66546321 63710322 .
    GAP/8:        ,OCT ,63301605 41744636 .
    GAQ/1:        ,OCT ,45753225 40307215 .
    GAQ/2:        ,OCT ,65752701 65154716 .
    GAQ/3:        ,OCT ,42713222 67356320 .
    GAQ/4:        ,OCT ,42516606 42315214 .
    GAQ/5:        ,OCT ,12110631 43716224 .
    GAQ/6:        ,OCT ,31226471 14026074 .
    GAQ/7:        ,OCT ,32022042 14436465 .
    GAQ/8:        ,OCT ,77777777 77631443 .
   SYMBOL:        ,OCT ,00000000 00000000 .
    GAR/2:        ,OCT ,00000000 00000000 .
    GAR/3:        ,OCT ,00000000 00000000 .
    GAR/4:        ,OCT ,00000000 00000000 .
    GAR/5:        ,OCT ,00000000 00000000 .
   WORD  :        ,OCT ,00000000 00000000 .
    GAR/7:        ,OCT ,00000000 00000000 .
    GAR/8:        ,OCT ,00000000 00000000 .
   REGIM :        ,OCT ,00000000 00000000 .
C     ФЛAГ OШИБKИ
    GAS/3:        ,OCT ,00000000 00000000 .
    GAS/4:        ,OCT ,00000000 00000000 .
    GAS/5:        ,OCT ,00000000 00000000 .
   NCRD  :        ,OCT ,00000000 00000000 .
    GAT/2:        ,OCT ,00000000 00000000 .
    GAT/6:        ,OCT ,00000000 00000000 .
 CARD:,BSS,24
C     BXOД ПPИ ЗAПYCKE ЗAДAЧИ
 START:,XTA,
 ,ATX,PASFLG
 ,ATX,ERRFLG
 ,ATX,NCRD
 14,VTM,-15
 CLPS*:14,ATX,PAS+15.
 14,VLM,CLPS*.ЧИCK.ПACП.MACCИBA
   BEGIN :  5     ,VTM ,SCS               .
                  ,XTA ,                  .
                  ,ATX , GAR/3            .
                  ,ATX , GAR/5            .
                  ,ATX ,REGIM             .
 ,ATX,FLG1/2
                  ,ATX , GAS/3            .
                  ,ATX , GAT/6            .
    GBV/4:  10    ,VTM ,77751B            .
 ,XTA,ERRFLG
 ,U1A,ERROR
 ,XTA,NCRD
   RDCARD:        ,ARX ,BIT1                .
                  ,ATX ,NCRD              .
C     ЧTEHИE OЧEPEДHOЙ KAPTЫ
 14,VTM,7
 14,MTJ,27B
 ,060,CARD
 ,BSS,
            14    ,V1M , GBW/2            .
                  , UJ , GFO/7            .
C     ПPOBEPKA TИПA BBOДA
    GBW/2:        ,XTA ,REGIM             .
  ,AEX,BIT2
                  ,UZA ,ALGIBR            .
  ,AEX,C3
C     CИMBOЛЬHЫЙ BBOД
                  ,U1A , GCL/2            .
                  ,XTA ,PASFLG            .
                  ,UZA ,ERROR             .
 A3:10,XTA,CARD+23
   :   ,24,
 1,UTC,
 10,ATX,23
   :   ,24,3
 10,VLM,A3
 1,UTM,24
                  , UJ , GBV/4            .
 GBX/3:,BSS,
 ,XTA,GDU/4
   :   ,24,
 GBV/8:,BSS,
 1,UTC,23
 10,ATX,
 10,VLM,GBV/8
 AW,UTM,24
                  ,ITA ,AW                .
   :   ,24,
 ,ATX,1
   :   ,24,3
                  , UJ , GBY/3            .
C     ПPOШEЛ CИMBOЛ E ИЛИ ДИCП. KOHEЦ
   RESET:        ,XTA ,PASFLG            .
                  ,UZA ,ANPAS             .
 GBY/1:14,VTM,7
 14,MTJ,27B
 ,060,CARD
 ,BSS,
            14    ,V1M , GBY/1            .
 GBY/3:,BSS,
 14,VTM,7
 14,MTJ,27B
 ,060,
 ,BSS,
C     YXOДИM K MATEMATИKY
 ,XTA,ARRFLG
  ,AAX,BIT1
 ,UZA,IN JOB.
C.....   БЫЛ BBOД MACCИBA
 ,XTA,NAMBER.MACCИB-ЗAДAЧA
 ,UIA,NO PRINT. - HET
C...  ЧИCTKA PEГИCTPOB :
  14,VTM,-11
  CLEAR:14,ATX,SAVI1+11
  14,VLM,CLEAR
  ,ATX,IR15
  ,ATX,SAVNTR
  ,ATX,SAW
  ,ATX,ARRFLG
 IN JOB:,BSS,.
 ,XTA,ГYC
 ,ASN,64+15
 ,ATX,SHIFRTX+1
 ,WTC,ГYC
 ,XTA,NAME
 ,ATX,SHIFRTX+4
 ,XTA,TODAY
 ,ASN,64-5
 ,AUX,=6H'3''17''''1''17'''
 ,AOX,SHIFRTX+5
 ,ATX,SHIFRTX+5
 ,XTA,TODAY
 ,ASN,64-16
 ,AUX,=6H'17''17'''''''''
 ,AOX,SHIFRTX+6
 ,ATX,SHIFRTX+6
 14,VTM,7
 14,MTJ,27B
 ,*64,SHIFRINF
 NOPRINT:,BSS,
 13,VTM,-11.
 ,XTA,ADDRET.
 ,AAX,BIT48.
 ,UZA,ЧИCTMOД.
C     ECTЬ CБOЙHAЯ ПPOГPAMMA
 ,XTA,DISREG.
 ,ATI,27B.
 ,XTA,=7770 0020 7760 0002
 ,*72,70707B.
 ЧИCTMOД:,BSS,.
 :13,XTA,SAVI1+11.
 13,ATI,12.
 13,VLM,ЧИCTMOД.
   :   ,24,2003B.
 ,ITA,15.
 ,ARX,NRINF.
 ,UJ,NRESOFF.
 NRINF:,Z00,NR73.
 ,Z00,K MAT-NRES73.
 K MAT:,XTA,ADDRET.
 ,ATI,33B.
C     OTKPЫBAEM ЭKCTPAKOД
  ,ITA,15
  ,ARX,S/UP
 15,MTJ,14
  ,UJ,SEMUP
  S/UP:,Z00,SCAL73
  ,Z00,EXIT///-NRES73
  EXIT///:,BSS,
 14,REL,NRES73
 ,AEX,.
 15,VTM,SAVAC
 ,XTS,SAVNTR
 ,XTS,SAVAC
 ,XTS,IR15
 ,XTS,
 ,XTS,SAW
 ,XTS,
 ,MTJ,27B.
 ,UJ,RETURN
C     БЛOK AHAЛИЗA ПACПOPTA
 ANPAS:,BSS,
 15,REL,NRES73
 ,XTA,ARRFLG.
 ,UZA,NOAR 0.
C.....   БЫЛ BBOД MACCИBA
 ,XTA,NAMBER.  MACCИB
 ,UZA,SPEC AR.- ЗAДAЧA
 ,XTA,PAS.
 ,ASN,64+47.
 ,UZA,ERROR.
 ,XTA,7
 ,AAX,BIT38
 ,U1A,RETANPAS
 ,XTA,PAS+1
 ,AEX,NAMBER
 ,U1A,ERROR
 ,XTA,PAS+2
 ,WTC,ГYC
 ,AEX,NAME
 ,U1A,ERROR
 RETANPAS:,BSS,
 ,XTA,SAW
 ,ATI,AW
 ,XTA,=1
 ,ATX,PASFLG
 ,UJ,BEGIN
 SPEC AR:,BSS,.
C.....   CПEЦ.MACCИB - ЗAДAЧA
C        OTKAЗ OT ЛИCTOB ПAMЯTИ : 01/37
 ,XTA,DISREG.
 ,ATI,27B.
 ,*72,=:00 4137 77.
C        OTKAЗ OT BCEX TPAKTOB MБ
  ,XTA,ПPMБ
  ,UZA,ALL
  ,ASN,64+25
  ,AAX,C37
  ,ATI,14
  14,XTA,BIT48+6
  ALL:,AEX,=:41 7777 7777
  ,ATX,DEL MD
  ,*72,DEL MD
   :   ,24,3.
 ,UJ,NO ARR.
C     ПACПOPT ЗAДAЧИ
 NOAR 0:,BSS,.
C.....   HAЧ.BBOД ЗAДAЧИ
 ,XTA,PAS.
 ,ASN,64+47.
 ,UIA,ERROR.
 NOARR:,BSS,
 ,XTA,PAS+2
 ,ATX,ADDRET
C     BXOД B ЗAДAЧY
 ,ASN,64+15
  ,AAX,C77777
 ,UZA,ERROR
 14,VTM,13B
 14,MTJ,27B
 ,*50,72100B+NAME
 ,XTA,FULWOR
 ,AEX,BIT48
 ,*50,76100B+REGSCAL
C     ПACПOPTHЫЙ ШИФP
 I,VTM,-3
 LS:I,XTA,PAS+6
 ,ATX,LSW
 LS1:,XTA,LSW
 ,UZA,ELS
 ,ASN,64-6
 ,ATX,LSW
 ,YTA,
 ,UZA,LS1
C     0 ЛИCT ЗAKAЗAH BCEГДA
 ,ATI,J
 ,ASN,64+5
 ,U1A,ERROR
 ,WTC,ГYC
 J,XTA,TMATH
 ,AAX,BIT48
 ,U1A,ERROR
 ,XTA,BIT48
   :   ,24,2003B
 ,WTC,ГYC
 J,AOX,TMATH
 ,WTC,ГYC
 J,ATX,TMATH
   :   ,24,3
 ,UJ,LS1
 ELS:I,VLM,LS
 ,XTA,ARRFLG.
 ,UIA,RETANPAS.
C     BЫДEЛИЛИ ПAMЯTЬ ДЛЯ ЗAДAЧИ
 J1,VTM,-1.
 ,XTA,PAS+9
 ,ATX,DELW
 Ц1:J2,VTM,48.
 Ц2:J1,XTA,PAS+8.
 J2,UTM,-6.
 J2,ASN,64.
  ,AAX,C77
 ,UZA,KOHЗAK.
 ,ATX,NT.
 ,AAX,=70.
 ,AEX,=70.
 ,UZA,ERROR
 ,XTA,NT.
 ,NTR,3.
 ,A-X,=30.
 ,U1A,ERROR
 ,XTA,ДHЗ.
 ,ASN,64-6.
 ,AOX,NT.
 ,ATX,WT.
 ,XTA,DELW
 ,ASN,64-3
 ,ATX,DELW
 ,YTA,
 ,ASN,64-18
 ,ATX,DELTA
 J3,VTM,-31.
 Ц3:,XTA,5.
 J3,AAX,BIT48+31.
 ,U1A,KЦ.
 J3,XTA,T1MT+31.
 ,ASN,64+36.
 ,UZA,ИMЯ.
 ,AEX,WT.
 ,UZA,ERROR
 ,UJ,KЦ.
 ИMЯ:J3,XTA,TANAMEMT+31.
 ,AEX,ИMЯMЛ.
C     TOЛЬKO CTAHДAPTHOE ИMЯ(BPEMEHHO)
 ,U1A,KЦ.
 ,XTA,WT.
 ,ASN,64-36.
 ,AOX,DELTA
  ,AOX,BIT1
 J3,ATX,T1MT+31.
C     ЗAKAЗAЛИ ДEЛЬTY
 ,UJ,KЦ2.
 KЦ:J3,VLM,Ц3.
 ,UJ,HETMЛ.
 KЦ2:J2,V1M,Ц2.
 J1,VLM,Ц1.
C     BЫДEЛИЛИ MAГHИTOФOHЫ
 KOHЗAK:,BSS,.
C     ЗAKAЗ BPEMEHИ CЧETA
 ,NTR,
 ,XTA,PAS+10
 ,UZA,NO TIMER
 ,A*X,=R60.0
 ,WTC,ГYC
 ,ATX,MAXTIME
 NO TIMER:,BSS,
 ,UJ,RETANPAS
    GCL/2:  11    ,VTM ,40                .
 10,XTA,CARD+23
            11    ,ASN ,100B              .
C     BЫДEЛЯEM OЧEPEДHOЙ CИMBOЛ KAPTЫ
    GCL/4:        ,XTA , GAT/6            .
                  ,ATX ,SYMBOL            .
            11    ,UTM ,-8                .
 10,XTA,CARD+23
            11    ,ASN ,100B              .
  ,AAX,C377
                  ,ATX , GAT/6            .
                  ,AEX ,=340              .
C     CИMBOЛ 140 - BTOPOЙ KOД HYЛЯ
                  ,U1A , GCM/2            .
    GCM/1:        ,AEX ,BIT8              .
                  ,ATX , GAT/6            .
    GCM/2:        ,AEX ,=202              .
C     CИMBOЛ 142 - BTOPOЙ KOД ПPOБEЛA
                  ,U1A , GCM/6            .
                  ,XTA ,=176              .
                  , UJ , GCM/1            .
C     ЧTEHИE HOBOГO CИMBOЛA (5,VJM,NEWSYM)
   NEWSYM:  11    ,V1M , GCL/4            .
            10    ,VLM , GCL/2            .
                  , UJ , GBV/4            .
C     AHAЛИЗ CИMBOЛA
    GCM/6:        ,XTA ,SYMBOL            .
                  ,UZA ,NEWSYM            .
  ,AEX,C377
                  ,UZA ,NEWSYM            .
                  ,ACX ,                  .
  ,AAX,BIT1
                  ,UZA ,ERROR             .
                  ,XTA ,SYMBOL            .
  ,AAX,C177
                  ,ATX ,SYMBOL            .
  ,AEX,C177
                  ,UZA ,NEWSYM            .
                  ,XTA , GAR/3            .
C     ЗOHA YПP. CИMB. A0 , A1 , A4
                  ,U1A , GDK/4            .
                  ,XTA ,SYMBOL            .
                  ,ATX , GAR/4            .
                  ,XTA , GAR/5            .
C     YПP. CИMB. ИЛИ ЗOHA KOДA
                  ,UZA , GCO/4            .
C     ЗOHA YПP. CИMB. Б
                  ,XTA ,WORD              .
                  ,ASN ,70B               .
                  ,AOX ,SYMBOL            .
                  ,ATX ,WORD              .
            7     ,VLM ,NEWSYM            .
                  ,XTA ,                  .
                  ,ATX , GAR/5            .
            5     ,VTM ,INPW              .
                  , UJ ,NEWSYM            .
    GCO/4:        ,XTA , GAR/4            .
                  ,ATI ,S                 .
C     HA S - TEKYЩИЙ CИMBOЛ
            3     ,VTM ,77776B            .
                  ,ATX ,                  .
    GCO/6:        ,ASN ,103B              .
                  ,UZA ,И                 .
                  ,ASN ,77B               .
            3     ,VLM , GCO/6            .
C     HA ИP-3 - TИП CИMBOЛA
C     -2 - BOCЬM. ЦИФPA, -1 - CЛYЖEБH. CИMB., 0 - БYKBA
   И     :        ,XTA , GAR/4            .
            S     ,UTM ,77730B            .
            S     ,V1M , GCP/6            .
C     YПP. CИMB. И
                  ,XTA ,                  .
                  ,ATX , GAS/3            .
                  ,ATX ,                  .
            5     ,VTM ,SCS               .
                  ,ATX ,                  .
                  ,XTA ,                  .
                  , UJ ,NEWSYM            .
C     BЫXOД ИЗ NEWSYM
    GCP/6:  5     , UJ ,                  .
C     ПEPEKЛЮЧATEЛЬ YПPABЛЯЮЩИX CИMBOЛOB
   SCS   :  S     ,UTM ,77776B            .
            S     ,VZM ,K                 .
            S     ,UTM ,77763B            .
            S     ,VZM ,Ч                 .
            S     ,UTM ,25B               .
            S     ,VZM ,B                 .
            S     ,UTM ,77775B            .
            S     ,VZM ,E                 .
            S     ,UTM ,77764B            .
            S     ,V1M , GDK/1            .
            7     ,VTM ,77760B            .
C     BBOД BOCЬMEPИЧHOЙ KOHCTAHTЫ
            2     ,VTM ,INPW              .
   C     :        ,ATX ,WORD              .
            5     ,VJM ,NEWSYM            .
            3     ,VZM , GCX/6            .
            3     ,UTM ,1                 .
            3     ,V1M , GCQ/8            .
                  ,ATX , GAS/3            .
    GCQ/8:        ,XTA ,WORD              .
                  ,ASN ,75B               .
                  ,ARX , GAR/4            .
            7     ,UTM ,1                 .
                  , UJ ,C                 .
C     BBOД ДECЯTИЧHЫX ЧИCEЛ
   Ч     :  2     ,VTM ,77777B            .
            6     ,VTM ,INPW              .
    GCR/4:        ,XTA , GDU/3            .
                  ,ATX ,WORD              .
                  ,XTA ,=R10.0            .
                  ,ATX , GAR/7            .
                  ,NTR ,2                 .
            5     ,VJM ,NEWSYM            .
            3     ,VZM , GCS/6            .
 S,UTM,32B
            S     ,V1M , GCS/2            .
            2     ,VTM ,                  .
                  , UJ ,NEWSYM            .
    GCS/2:  S     ,UTM ,4                 .
            S     ,VZM ,NEWSYM            .
            S     ,UTM ,77777B            .
            S     ,V1M , GCS/8            .
                  ,XTA , GAR/7            .
                  ,AVX , GAL/8            .
                  ,ATX , GAR/7            .
                  , UJ ,NEWSYM            .
    GCS/6:        ,XTA ,WORD              .
                  ,A/X , GAR/7            .
                  ,ATX ,WORD              .
            6     , UJ ,                  .
    GCS/8:  S     ,UTM ,77773B            .
            S     ,VZM , GCT/7            .
                  ,XTA , GAR/4            .
                  ,ASN ,35B               .
                  ,ARX , GAN/4            .
                  ,A+X ,WORD              .
                  ,A*X ,=R10.0            .
                  ,ATX ,WORD              .
            2     ,V1M ,NEWSYM            .
                  ,XTA , GAR/7            .
                  ,A*X ,=R10.0            .
                  ,ATX , GAR/7            .
                  , UJ ,NEWSYM            .
    GCT/7:        ,XTA ,WORD              .
                  ,AEX , GDU/3            .
                  ,U1A , GCU/2            .
                  ,XTA ,=R10.0            .
                  ,ATX ,WORD              .
    GCU/2:  2     ,VTM ,77777B            .
            6     ,VJM , GCS/6            .
                  ,ATX , GAR/8            .
            6     ,VJM , GCR/4            .
            3     ,VTM ,=R10.0            .
                  ,NTR ,20B               .
                  ,UZA , GCU/6            .
            3     ,VTM , GAN/5            .
    GCU/6:        ,XTA ,WORD              .
                  ,AVX ,WORD              .
                  ,A-X , GAN/6            .
                  ,ATX ,WORD              .
                  ,UZA , GCV/2            .
                  ,XTA , GAR/8            .
                  ,ATX ,WORD              .
                  , UJ ,INPW              .
    GCV/2:        ,XTA , GAR/8            .
            3     ,A*X ,                  .
                  ,ATX , GAR/8            .
                  , UJ , GCU/6            .
C     BBOД KOMAHД
   K     :  6     ,VTM ,                  .
            2     ,VTM ,INPW              .
C      OБPAБOTKA ФOPMATA KOMAHДЫ
    GCV/5:  7     ,VTM ,77755B            .
            8     ,VTM ,                  .
    GCV/6:  7     ,UTM ,1                 .
            5     ,VJM ,NEWSYM            .
            3     ,VZM , GCX/6            .
            3     ,UTM ,1                 .
            3     ,V1M , GCW/1            .
                  ,ATX , GAS/3            .
    GCW/1:        ,XTA ,WORD              .
                  ,ASN ,75B               .
            6     ,VLM , GCW/7            .
            8     ,V1M , GCX/1            .
                  ,XTA , GAR/4            .
                  ,AAX ,=36               .
                  ,UZA , GCW/5            .
                  ,ATX , GAS/3            .
    GCW/5:  6     ,VTM ,77777B            .
            8     ,VTM ,1                 .
                  ,XTA ,WORD              .
                  ,ASN ,77B               .
    GCW/7:        ,ARX , GAR/4            .
                  ,ATX ,WORD              .
                  , UJ , GCV/6            .
    GCX/1:        ,XTA , GAR/4            .
                  ,AAX ,=34               .
                  ,UZA , GCX/3            .
                  ,ATX , GAS/3            .
    GCX/3:  6     ,VTM ,77772B            .
            8     ,VTM ,                  .
                  ,XTA ,WORD              .
                  ,ASN ,76B               .
                  , UJ , GCW/7            .
C     БЛOK ПPOBEPKИ OШИБOK
    GCX/6:  7     ,V1M ,ERROR             .
                  ,XTA , GAS/3            .
                  ,U1A ,ERROR             .
            2     , UJ ,                  .
C     БЛOK BЫДAЧИ MAШИHHOГO CЛOBA
   INPW  :        ,XTA ,PASFLG            .
                  ,UZA ,INPPAS            .
 ,XTA,WORD
 14,VTM,4
 14,MTJ,27B
 AW,CTX,
   :   ,24,3
 AW,UTM,1
    GCY/5:        ,XTA , GAR/3            .
                  ,UZA ,SCS               .
    GCY/6:  2     ,UTM ,77773B            .
            3     , UJ ,                  .
C     B ПACПOPT
   INPPAS:  AW    ,UTM ,-7541B            .
                  ,ITA ,AW                .
                  ,ASN ,104B              .
                  ,U1A ,ERROR             .
                  ,XTA ,WORD              .
            AW    ,ATX ,PAS               .
            AW    ,UTM ,7542B             .
                  , UJ , GCY/5            .
C     BBOДHOE CЛOBO
   B     :  6     ,VTM ,                  .
            2     ,VJM , GCV/5            .
                  ,XTA ,WORD              .
                  ,ATX , GAS/4            .
                  ,ASN ,130B              .
                  ,ATI ,AW                .
                  , UJ ,SCS               .
C     ПEPEKЛ. YПP. CИMB. (ПPOДOЛЖEHИE)
    GDK/1:  S     ,UTM ,20B               .
            S     ,V1M , GDM/2            .
            7     ,VTM ,77773B            .
C     YПP. CИMB. Б
                  ,XTA , GAL/8            .
                  ,ATX , GAR/5            .
                  , UJ ,NEWSYM            .
C     ИДET BBOД ПO A0 , A1 , A4
    GDK/4:        ,XTA , GAR/2            .
                  ,ASN ,70B               .
                  ,AOX ,SYMBOL            .
                  ,ATX , GAR/2            .
 ,AEX,=6H'''''''''132''127'
                  ,AAX ,C77777            .
                  ,U1A , GDO/8            .
C     KOHEЦ TEKCTA
                  ,XTA ,WORD              .
    GDK/8:        ,ASN ,70B               .
            2     ,VLM , GDK/8            .
                  ,ATX ,WORD              .
            3     ,VJM ,INPW              .
C     MATEMATИKY - PACПOЛOЖEHИE TEKCTA B ПAMЯTИ
                  ,ITA ,AW                .
                  ,ARX , GAL/8            .
   :   ,24,
                  ,ATX ,3                 .
                  ,ASN ,112B              .
   :   ,24,3
 ,AOX,*2
   :   ,24,
                  ,ATX ,2                 .
   :   ,24,3
                  ,XTA ,                  .
                  ,ATX , GAR/3            .
                  ,ATX , GAS/3            .
            5     ,VTM ,SCS               .
                  , UJ ,NEWSYM            .
C     ПEPEKЛ. YПP. CИMB. (OKOHЧAHИE)
    GDM/2:  S     ,UTM ,1                 .
            S     ,V1M ,ERROR             .
C     YПP. CИMB. A
            5     ,VJM ,NEWSYM            .
            S     ,UTM ,40                .
                  ,ITA ,S                 .
                  ,ASN ,101B              .
                  ,UZA , GDM/7            .
                  ,ASN ,101B              .
                  ,UZA , GDN/1            .
    GDM/7:        ,ITA ,AW                .
C     ДЛЯ A0 , A1 , A4 ЗAПOMHИЛИ HAЧAЛO TEKCTA
                  ,ASN ,112B              .
                  ,ASN ,72B               .
 ,ATX,*2
 GDN/1:,BSS,
    GDN/2:  S     ,VZM , GDN/8            .
            S     ,UTM ,77777B            .
            S     ,V1M , GDO/1            .
C     BBOД ПO A1
  ,XTA,BIT1
    GDN/4:        ,ATX , GAR/3            .
                  ,XTA ,                  .
                  ,ATX , GAS/5            .
 GDN/6:,BSS,
            2     ,VTM ,77773B            .
                  , UJ ,NEWSYM            .
C     BBOД ПO A0
    GDN/8:        ,XTA ,C37               .
                  , UJ , GDN/4            .
    GDO/1:  S     ,UTM ,77777B            .
            S     ,V1M , GDO/5            .
C     BBOД ПO A2
  ,XTA,BIT2
                  ,ATX ,REGIM             .
    GDO/3:        ,XTA , GAR/3            .
                  ,ATX , GAS/5            .
 5,VTM,ERROR
                  , UJ , GDN/6            .
    GDO/5:  S     ,UTM ,77777B            .
            S     ,V1M , GFO/1            .
C     BBOД ПO A3
  ,XTA,BIT1
                  ,ATX ,REGIM             .
            3     ,VTM ,77765B            .
                  , UJ , GDO/3            .
C     BBOДИM TEKCT
    GDO/8:        ,XTA , GAR/3            .
                  ,ASN ,101B              .
                  ,ATI ,8                 .
                  , UJ , GFO/5            .
    GDP/2:        ,XTA , GAS/5            .
                  ,ATI ,3                 .
                  ,XTA ,SYMBOL            .
                  ,ATI ,S                 .
C     ИЩEM ДBOЙHЫE CИMBOЛЫ
            3     ,V1M , GDR/1            .
            S     ,UTM ,77741B            .
            S     ,V1M , GDQ/5            .
    GDP/6:  3     ,UTM ,3                 .
                  ,ITA ,3                 .
    GDP/7:        ,ATX , GAS/5            .
                  ,XTA ,SYMBOL            .
    GDP/8:  8     ,V1M ,A1TOA0            .
    GDQ/1:        ,ATX , GAR/4            .
                  ,XTA ,WORD              .
                  ,ASN ,70B               .
                  ,AOX , GAR/4            .
                  ,ATX ,WORD              .
            2     ,VLM ,NEWSYM            .
            3     ,VTM ,NEWSYM            .
                  , UJ ,INPW              .
    GDQ/5:  S     ,UTM ,77706B            .
            S     ,V1M , GDQ/7            .
            3     ,UTM ,77776B            .
                  , UJ , GDP/6            .
    GDQ/7:  S     ,UTM ,77777B            .
            S     ,V1M , GDP/8            .
            3     ,UTM ,77777B            .
                  , UJ , GDP/6            .
    GDR/1:        ,XTA ,                  .
                  ,ATX , GAS/5            .
 S,VTM,48
C     CЛИЯHИE ДBOЙHЫX CИMBOЛOB
    GDR/3:        ,XTA , GAO/1            .
            S     ,ASN ,70B               .
                  ,AEX ,SYMBOL            .
                  ,AAX ,C377              .
            S     ,UTM ,-8                .
                  ,UZA , GDR/8            .
            S     ,V1M , GDR/3            .
                  ,XTA , GAS/5            .
                  , UJ , GDP/2            .
    GDR/8:  8     ,V1M , GDS/1            .
            3     ,UTM ,3                 .
    GDS/1:  3     ,XTA , GAO/1            .
            S     ,ASN ,100B              .
                  ,AAX ,C377              .
                  ,UZA , GDP/2            .
                  ,AEX , GAR/4            .
                  ,AEX ,WORD              .
                  ,ATX ,WORD              .
            2     ,UTM ,5                 .
            3     ,VTM ,NEWSYM            .
            2     ,V1M , GCY/6            .
            AW    ,UTM ,77777B            .
                  , UJ ,INPW              .
C     ПEPEBOД B ABTOKOД
   A1TOA0:        ,XTA ,SYMBOL            .
                  ,AOX ,=I0               .
                  ,ATX , GAT/2            .
                  ,A+X ,                  .
                  ,NTR ,3                 .
 ,A/X,=R6.0
                  ,A+X ,=I0               .
                  ,ATI ,9                 .
                  ,NTR ,                  .
 ,A*X,=R6.0
                  ,X-A , GAT/2            .
                  ,NTR ,3                 .
                  ,A+X , GAN/2            .
                  ,ATI ,8                 .
                  ,NTR ,                  .
 9,XTA,TABLA0
            8     ,ASN ,100B              .
                  ,AAX ,C377              .
                  , UJ , GDQ/1            .
    GDU/3:        ,OCT ,40000000 00000000 .
    GDU/4:        ,OCT ,00100000 00000000 .
    GDW/3:        ,OCT ,37777777 77777777 .
C     OБPAБOTKA PAЗHЫX OШИБOK
 HETMЛ:,BSS,
 14,VTM,TAPETX
  ,UJ,TOM74
 ERRPAS:14,VTM,PASTX
  TOM74:,BSS,
 ,ITA,14
 14,VTM,MACRO74
                  , UJ ,TELOUT            .
 ERCARD:,XTA,NCRD
 2,VTM,CRDTX
            14    ,VJM ,KODIR             .
 2,ATX,1
                  ,ITA ,AW                .
            14    ,VJM ,KODIR             .
 2,ATX,3
 ,ITA,2
            14    ,VJM ,TELOUT            .
 ,XTA,ARRFLG
  ,AAX,BIT1
 ,UZA,MACRO74
 ,UJ,ERROR73
   PASFLG:        ,OCT ,00000000 00000000 .
 *2:,BSS,1
 PAS:,BSS,16
 ALGIBR:,BSS,
 ,XTA,BIT1
 ,ATX,GAR/3
 3,VTM,*END
 *COD:,BSS,
 10,XTA,CARD+23
 ,AAX,=10 0007 1250 0604
 ,U1A,ERROR
 10,XTA,CARD+24
 ,AAX,=2 0410 2041 0204
 ,U1A,ERROR
 10,XTA,CARD+23
  ,AAX,BIT23
 ,UZA,*END
 10,XTA,CARD+24
  ,XTA,BIT1
 ,U1A,*RET
 10,XTA,CARD+24
 ,APX,=5 7367 5736 7570
 ,ASN,64-5
 ,ATX,WORD
 ,YTA,
 ,ATX,/W/
 ,XTA,WORD
 ,ACX,
 ,AEX,/W/
 ,U1A,ERROR
 10,XTA,CARD+23
 ,APX,=527 7173
 ,U1A,*BC
 10,XTA,CARD+24
 ,AAX,GDU/4
 ,U1A,*BC0
 ,XTA,FLG1/2
  ,AEX,BIT1
 ,ATX,FLG1/2
 ,UZA,*OKEY
 ,XTA,WORD
 ,ATX,*1/2W
 ,UJ,*END
 *OKEY:,BSS,
 ,XTA,WORD
 ,ASN,64+24
 ,AOX,*1/2W
 ,ATX,WORD
 ,UJ,INPW
 *BC0:,BSS,
 ,XTA,
 *BC:,BSS,
 ,ASN,64+33
 ,ATX,/BC/
 ,XTA,FLG1/2
 ,U1A,ERROR
 ,XTA,WORD
 ,U1A,ERROR
 10,XTA,CARD+24
 ,ASN ,64+39
  ,AAX,BIT1
 ,ATX,/W/
 ,XTA,/BC/
 ,ACX,/W/
  ,AAX,BIT1
 ,UZA,ERROR
 ,XTA,/BC/
 ,ATI,AW
 *END:,BSS,
 10,UTM,1
 10,VLM,*COD
 ,UJ,GBV/4
 *RET:,BSS,
 ,XTA,FLG1/2
 ,U1A,ERROR
 ,UJ,BEGIN
 FLG1/2:,BSS,1
 *1/2W:,BSS,1
 /W/:,BSS,1
 /BC/:,BSS,1
C     AHAOИЗ OШИБKИ
 ERROR:,060,
 :,24,2003B
 ,XTA,PASFLG
 GFL/7:,U1A,ERCARD
                  ,XTA ,ARRFLG            .
 ,AAX,BIT1
                  ,UZA ,ERRPAS            .
 ERPASA:14,VTM,PASATX
 ,ITA,14
            14    ,VJM ,TELOUT            .
 ,UJ,ERROR73
   ARRFLG:        ,OCT ,00000000 00000000 .
    GFO/1:  S     ,UTM ,77777B            .
            S     ,V1M ,ERROR             .
C     BBOД ПO A4
                  ,XTA , GDU/3            .
                  , UJ , GDN/4            .
C     ЛATKИ
    GFO/5:  8     ,V1M , GDP/2            .
                  ,UZA , GDP/2            .
                  ,XTA , GAS/5            .
                  , UJ , GDP/7            .
    GFO/7:        ,XTA ,REGIM             .
 ,AEX,BIT1
                  ,UZA , GBX/3            .
                  ,ATX ,ERRFLG            .
                  ,XTA , GAT/6            .
                  ,ATX ,SYMBOL            .
                  , UJ , GCM/6            .
   ERRFLG:        ,OCT ,00000000 00000000 .
C
   E     :        ,XTA ,ERRFLG            .
                  ,UZA ,RESET            .
                  ,XTA ,PASFLG            .
                  ,U1A , GBY/3            .
C     MACCИB ПYCT
 ,UJ,ERROR
 KODIR:,BSS,
 ,ASN,64-33
 ,AUX,MASKOD
 ,AOX,CISO
 14,UJ,
 MASKOD:,GOST,6H077777
 CISO:,ISO,6H'1'00000
 PASTX:,BSS,
 ,ISO,12HOШ. B ПACП.''
 ,OCT,
 CRDTX:,BSS,
 ,ISO,6HEПK '1''1'
 ,OCT,
 ,ISO,6H AДP '1'
 ,OCT,
 ,OCT,
 PASATX:,BSS,
 ,ISO,12HOШ. ПACП. M.
 ,OCT,
 TAPETX:,BSS,
 ,ISO,12HYKAЖИTE MЛ '41'
 ,OCT,
 ИMЯMЛ:,OCT,22451252 51224512.
 INPTX:,ISO,6HBBOД '1'
 ,OCT,.
 ,ISO,6H ЗAД.'1'
 ,OCT,.
 ,OCT,.
 SHIFRTX:,GOST,6HШИФP '231'
 ,OCT,
 ,GOST,9H ЗAДAЧA '231'
 ,OCT,
 ,GOST,6H00.00.
 ,GOST,6H00.'231'
 SHIFRINF:,BSS,
 ,,SHIFRTX
 ,,SHIFRTX+6
 ,064,
 ,,
 2,071,5
 ,,
 ,076,
 ,,
 2,106,5
 ,,
 ,166,
 15,,
  DEL MD:,BSS,1
  ПP MБ :,BSS,1
 SAVNTR:,BSS,1.
 SAVI1:,BSS,12.
 IR15:,BSS,1.
 DELW:,BSS,1
 DELTA:,BSS,1
 NT:,BSS,1.
 WT:,BSS,1.
 NAMBER:,BSS,1
 SAW:,BSS,1
 ADDRET:,BSS,1
 LSW:,BSS,1
 ,END,
 TARES:,NAME,
C
  BEGIN:,BSS,
C
  *677: B,BLOCK,  BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42
  ,CONT, BIT41,BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34
  ,CONT, BIT33,BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,
  ,CONT, BIT25,BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18
  ,CONT, BIT17,BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10
  ,CONT, BIT9,BIT8,BIT7,BIT6,BIT5,BIT4,BIT3,BIT2,BIT1
  *YCЫ:LC,BLOCK, ГYC, RDSCAL
 COЩИTOM:,SUBP,
C         NAMES OF INDEX-REGISTERS
 *2:,BLOCK,LT,L,J,RE
 *6:,BLOCK,S,K,SN,FD
 *10:,BLOCK,A,N,T
C         DESCRIPTION OF THE INFORM.ARRAY
 *0:,BLOCK,COBT
 ,CONT,SBT,SCT,ДOП,SSR,SAR
 ,CONT,SM33,SM32,SM27,SI16,SI15
 ,CONT,SI14,SI13,OCTИП3(70)
 ,CONT,NAME(3)
  ,CONT,EMUL(3),SCDRUM(24),SCTAPE(64),COFATA
 NAM3:,EQU,NAME+2
 BISTIME:,EQU,110B
 MAXTIME:,EQU,111B
 M:,EQU,100B.
 REGSCAL:,EQU,M.
 TMATHI:,EQU,ДOП+30B
 TMATH:,EQU,30B
 MAXTIMEB:,EQU,ДOП+MAXTIME
 MO34:,EQU,ДOП+26B
 MO35:,EQU,MO34+1
 MACRO70:,SUBP,
 DISREG:,LC,1
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15
 ,CONT,SAVI14,SAVI13,(1),SAVI16
 ДOПYПP:LC,BLOCK,AC,SR,AR,M33,M32,M27,I16,I15
 ,CONT,I14,I13,NTRFRO
  TABLEMT:LC,BLOCK,(16),T1MT(32),(16),T2MT(32)
  ,CONT,(16),TNAMEMT(32)
 STATUSMT:LC,BLOCK,MBUS,OLD(4),NEW(4),DIF(4).
  ,CONT,(19),MISTERX
 STOP:,EQU,574B
C         BLOCKS, CRNNECTED WITH DISCS
  * И П Д :LC,BLOCK,XNF,XNFM(4),XNC
  NMAT1:,WEQ,XNF
  LENTDIS:,EQU,XNF+21B
  *DISCS:LC,BLOCK,DNAM
  TABSCR:,EQU,425B
  FATA:,LC,1
  *LFATA:,EQU,XNF+20B
   LFATA:,WEQ,*LFATA
  *TDIS:,LC,
 TEX:,EQU,*TDIS.EXTENT'S TABLE
 LTX:,WEQ,LENTDIS.THE EXTENT'S
 LTXM1:,EQU,LTX-1.TABLE - 1
C         DISCRIPTION THE FIELDS THAT
C         CONNECTED WITH DISKS AND
C         MULTIPLIED BY CHANNELS FOR CONT
  FREXT:,EQU,XNF+34B
  MON  :,EQU,XNF+33B
  *127:B,BLOCK,MTD,MTDJ
  * И П K 1 :,LC,1
  NC:,WEQ,XNC
  MONTAS:,EQU,*ИПK1+NC
C         DESCRIPTION OF THE ROLLOUT SECTOR
  *0:,BLOCK,(1),NTASK,CRT,BFRA,BFRB
 ,CONT,INABEG(7),FIELD,OLDTEX
 ////:,EQU,OLDTEX+LTX
 ////:I,BLOCK,OMTD,OMTDJ,COTSAR
 OLDNAM:,EQU,377B
 SM1:,EQU,SI13+13
 *400:B,BLOCK,W*70,W4,W5,BASW
 KOHEЦ:,EQU,1317B-BASW
 BITININ:,EQU,BIT48+6
 BITMD:,EQU,BIT48
 FULWOR:,LC,1
 ДHЗ:LC,BLOCK,STN
 BIT*76:,EQU,BIT48+3
 /A/:,P/P,(BEGIN)1024
 B:,P*P,(/A/)1024
 D:,EQU,BASW+B
 13,REL,B
 13,VTM,
C         SET S T N TO MAT. MEMORY
 ,*65,STN
 ,ATX,STNMM
 ,*65,3
  ,AAX,=777
 ,ATX,W*70
C         READING THE ROLLOUT SECTOR.
 T,VTM,TNOTT-IN.TEXT:NO TRACT
 ,*65,NTRFRO.ADDR.FOR TRAPHY
 ,APX,=30 0000 0000 1774
 ,AUX,C370037
  ,UZA,DIAGN
  ,AOX,=:4014
 ,ATX,W2*70.READING TO THE
 ,*70,W2*70.0-TH SECTOR
C      IS THERE THE BUFFER HERE:
  ,XTA,OLDNAM
  ,*57,400B
  T,VTM,TNBUF-IN.TEXT 'NO BUF'
  ,UZA,DIAGN
  ,ASN,64-12
  ,AOX,W*70
  ,AOX,KP1.P40,39
  ,ATX,W*70
  ,ARX,=10 0000
  ,AAX,=40 0000
  ,AEX,=40 0000
  ,ASN,64-28
  ,AOX,W*70
  ,ATX,W*70
C         IS THERE A TASK BEGNING FROM
C         THE POINTED ZONE
 N,UTM,7.MAX.N OF TASKS
 A,VTM,INABEG
 CHECK:,BSS,.LOOP OF CHECKING
 A,XTA,.EXISTENCE THE
 ,AEX,W*70.TASK WITH THE
 ,AAX,=777.BEGIN FROM
 ,UZA,TASKIS.THIS ZONE
 A,UTM,1
 N,UTM,-1
 N,V1M,CHECK
 T,VTM,TNST-IN.'NO SUCH TASK'
 ,*76,IN.NO SUCH TASK
 TASKIS:,BSS,
C         THE TASK EXISTS.ADDR.OF DES.IN A.
C         PRINTING THE HEAD OF THE TASK.
 ,XTA,W*70.THE N OF ZONE
 ,ASN,64-39.IS SET INTO THE
 ,AUX,GUNP.PRINTED TEXT
 ,AOX,GTVAR.AS THE IDENTEFI-
 ,ATX,GTVAR.KATOR OF TASK
 ,*64,INHEAD
 13,VTM,.ANTI M64'S ERROR
 A,XTA,
 ,ASN,64+24.OBTAINING THE
 ,ATI,FD.FIELD'S ADDRESS
C         READING THE INFORMATION TO 1-TH P.
 ,XTA,W*70
 ,AOX,B31
 ,ARX,=1
 ,ATX,W1*70
 ,*70,W1*70
 FD,UTM,-40000B
 14,VTM,COBT-KOHEЦ.
 L1:,BSS,
 14,XTA,KOHEЦ+2005B
 14,ATX,BASW+KOHEЦ
 14,VLM,L1
  1,VTM,
  ЦЛ:,BSS,
  TTAPE:,EQU,SCTAPE+BASW
   1,XTA,TTAPE
   1,AOX,TTAPE+1
   ,UZA,ЛEHTЫBCE
  4,VTM,
  ЦЛ1:,BSS,
  1,XTA,TTAPE+1
C***** ЗДECЬ BCЯ ИHФOPMAЦИЯ O MЛ :
C      1-6   MAT.HOMEP
C      14-15 ПЛOTHOCTЬ ЗAПИCИ
C      17-27  ДEЛЬTA
C       46   ПP-K ЗAKAЗA HA ЗAПИCЬ
C       47   ПP-K ЗAKAЗA KOHTPOЛЯ
C       48   ПP-K  NO CHECK
C
   ,ATI,2
  *57:,ASN,64-1
  4,MTJ,3
  ,ARX,
  ,U1A,NOCONTR
  ,AAX,=:2
  3,UTM,100B
  ,U1A,NOCONTR
  3,UTM,100B
  NOCONTR:,BSS,
  3,UTM,2070B
   1,XTA,TTAPE.ИMЯ MЛ
   2,MTJ,13
   3,*57,
   13,VTM,.BOCCT.БAЗЫ
  ,ATI,14
  ,UZA,MTABS
  ,ASN,64+45
  ,UZA,OKE
  ,ASN,64+2
  ,UZA,MTABS
  ,ITA,3
  ,AAX,=100
  ,UIA,MTABS
  OKE:,BSS,
C-- MЛ БЛAГOПOЛYЧHO ЗAXBAЧEHA
C-- YCTAHOBИM HYЖHYЮ ДEЛЬTY.
  14,MTJ,N
  N,UTM,TABLEMT-10B
  1,XTA,TTAPE+1
  ,ASN,64+4
  ,AAX,=1777 0000
  ,ATX,W3
  ,XTA,=1777 0000
  ,*76,WRW11M
   1,UTM,2.И K CЛEД.MЛ
  ,UJ,ЦЛ
  MTABS:4,VTM,400B
  ,*57,3
  ,UJ,ЦЛ1
C-----
  DIAGN:,BSS,
   ЗAHЯTA:,*76,IN
C
C------------
   ЛEHTЫBCE:,BSS,
C         OCCUPWING THE FILES
 CFTB:,EQU,COFATA+BASW
 ,XTA,
 ,ATX,NEWSCD.NEW MONTAS
 1,VTM,CFTB-1
  LT,VTM,LFATA
 LT,MTJ,L
 LSFOF:,BSS,
C         LOOKING FOR OWN FILES
C         AND OCCUPYING THEM.
 1,UTM,1.ADDR.IN COFATA
 1,XTA,.FILE REFFERENCE
 ,ASN,64+42.OWNER'S NUMBER
 FD,AEX,FIELD.IS IT OWN
 ,U1A,ENDLSFOF.NO
C         IS IT A SCRATCH'S REFFERENCE
 1,XTA,.FOR WRITING TO
 ,ATX,W3.FATA IF SCRATCH
 ,ASN,64+36
 ,AAX,=77.MATH. NUMBER
  ,ATX,W2
  ,XTA,W3
  ,AAX,=:0000 77
 ,UZA,SZF.IT IS SCRATCH
  ,AEX,=:0000 77.NMOD=77 -
  ,UZA,ENDLSFOF.ФAЙЛ ИЗ Ф.C.
C         OBTAINING THE DISC'S NAME
 1,XTA,.OLD
 ,ATX,W1.REFFERENCE
 ,ASN,64+30.THE NUMBER OF
 ,AAX,=77.THE MODULE WHERE
 ,ATX,W2.THE FILE WAS
 ,WTC,W2
 LT,XTA,CFTB-30B.NAME OF DISC
 15,VJM,GIVEMNF.FOR MOD.,NFIL
 T,VTM,TFB-IN.'FILE IS BUSY'
 ,UZA,ЗAHЯTA.FILE IS BUSY
 SZF:,BSS,
C         FILE OPENING IS POSSIBLE
 ,XTA,STNMM.NEW STN
 FD,AEX,FIELD.OBTAINING THE
 ,ASN,64+6.WORD FOR FATA
 ,YTA,.WITH NEW SUPER-
 ,AEX,W3.VISOR'S AND
 ,ATX,W3.MODULE'S NUMBERS
C         WRITING THE WORD FROM W3
C         INTO FREE PLACE IN THE FATA.
 LT,MTJ,J
 N,VTM,FATA-1
 LSZF:N,UTM,1.LOOKING FOR
 ,*76,W11IF0.PLACE AND WRITE
 ,UZA,ENDLSFOF.WRITING HAS BEEN
 J,UTM,-1
 J,V1M,LSZF
 T,VTM,TNF-IN.'NO PLACE'
 ,*76,IN.STOP
 ENDLSFOF:,BSS,
C         GOING TO THE NEXT FILE
C         IN THE COPY OF THE FILE'S TABLE.
 L,UTM,-1
 L,V1M,LSFOF
C         WRITING THE SCALE OF THE MODULES,
C         OCCUPYED BY THE TASK.
 ,XTA,NEWSCD
 ,ATX,W3
 ,WTC,STNMM
 N,VTM,MONTAS-NMAT1
 ,*76,WRW11
C         MERGING THE SCALE TO THE
C         GLOBAL SCALE OFOCCUPYING.
 N,VTM,MON
 ,*76,WRW11M
C......   BLOCK OF OCCUPYING THE OWN
C         EXTENTS.  FD(9) IS THE BASE OF THE
C         TASK'S FIELD.
 RE,VTM,-LTXM1.1-LENGTH OF TEX
  1,VTM,
   ,NTR,3
 FD,XTA,FIELD
   ,A-X,=20
   ,ATX,W6
 LREXT1:,BSS,
C         EXTERNAL LOOP OF GETTING ELEMENT.
 FD,UTC,FIELD+1
 RE,XTA,LTXM1.STRING OF TEX
 ,ATX,W4
 K,VTM,1-3.NUMB OF EL
 LREXT2:,XTA,W4
 ,ASN,64-16.GETTING
 ,ATX,W4.AN ELEMENT
 ,YTA,.OF THE EXTENT'S
 ,ATX,W5.TABLE
C         IS THE EXTENT OWN.
 ,ASN,64+11
 ,AEX,W6.OLD STN
 ,U1A,ELREXT2.NO
C         OBTAINING THE FILE'S REFFERENCE
C         AND THE DISC'S NAME OF THE SCRATCH
 1,MTJ,SN
 FD,UTC,.THE TABLE
  14,VTM,COTSAR.OF SCRATCH
 LSFSCR:14,WTC,.GETTING
 SN,UTM,1.THE NUMBER OF
  ,ITA,SN.THE SCRATCH
 ,ASN,64+14.THAT CONTAINED
 ,U1A,ITISNF.THE EXTENT WHEN
 14,UTM,3
 ,UJ,LSFSCR.ROLLOUT WAS
 ITISNF:14,XTA,1.REFFERENCE OF
 ,ATX,W1.THIS SCRATCH
 ,ASN,64+30
 ,AAX,=77.OLD
 ,ATX,W2.MODULE'S NUMBER
 14,XTA,2.DISC'S NAME
 15,VJM,GIVEMNF
C         GETTING THE ELEMENTS NUMBER OF THE
C         EXTENT FOR THE NEW EXTENT'S TABLEE
 S,VTM,TABSCR-1
 J,UTM,1
 ,ITA,J.FILE'S NUMBER
 ,ATX,W3.WHERE SCR.IS
 J,VTM,
C         COUNTING THE OWN EXTENTS
 L,UTM,-1
 LNNEX:S,UTM,1.ELEMENT OF
 S,*65,.SCRATCH TABLE
 ,AEX,C77777.NUMB.OF EXT.
 ,ATI,15.IN THE SCRATCH
 15,J+M,J.COUNT THEM
 ,ASN,64+15.FILE'S NUMBER
 ,AEX,W3.IS IT THAT
 ,U1A,LNNEX.NO
 J,J+M,SN.NEW NUMBER
C         SETTING THE INFORMATION TO TEX.
 ,ITA,SN
 ,ATX,W3.EXTENT'S NUMBER
 ,A*X,C1/3.DIVISION BY 3
 ,ATI,N.STRING'S NUMBER
 ,ATX,W2
 ,ASN,64-1.*2
 ,ARX,W2.*3
 ,X-A,W3.COLUMN'S NUMBER
 ,ASN,64-4.*16
 ,ATI,14
 ,XTA,STNMM.OBTAINING
 ,A-X,=20.THE ELEMENT
 ,AEX,W6.WITH
  ,ASN,64-11.NEW STN AND
 ,AEX,W5.SETTING
 14,ASN,64-32.INFORMATION
 ,ATX,W3.TO RIGHT PLACE
 ,XTA,B16/1.OBTAINING THE
 14,ASN,64-32.MASK OF FIELD
 N,UTM,TEX
 ,*76,WRW11M.WRITING
 ELREXT2:,BSS,
C         GOING TO THE NEXT ELEMENT IN THE
C         COPY OF THE EXTENT'S TABLE
 1,UTM,1
 K,VLM,LREXT2
 RE,VLM,LREXT1
C         KORRECTION THE NUMBER OF THE
C         FREE EXTENTS
 FD,WTC,OMTDJ.OLD REQUEST
 L,UTM,-1
 ,ITA,L.NUMBER OF
  ,AEX,C77777.OLD TAKEN-
 N,VTM,FREXT.-OLD REQUEST
 ,*76,WRAD11M
C         SETTING THE INFORMATION ABOUT
C         THE TAPES, MAPPED TO THE DISKS
 FD,XTA,OMTD.USER'S TAPES
  ,FUN,72100B+MTD
 FD,XTA,OMTDJ.WORK TAPES
  ,FUN,72100B+MTDJ
C         CORRECTION OF THE ROLLOUT SECTOR
 ,XTA,W2*70.MAKING THE WORD
 ,AEX,=:001.FOR WRITING THE
 ,ATX,W2*70.ROLLOUT SECTOR
 A,*65,BIT48-INABEG
 ,AOX,CRT.CHANGING THE
 ,ATX,CRT.RESTOR.SCALE
 ,ACX,.IS EVERYBODY
 ,AEX,NTASK.RESTORED
 ,U1A,NALL.NO IT ISN'T
 ,ATX,NTASK
 NALL:,*70,W2*70
C         WORK WITH MATHEMATICAL TRACKS
   TDRUM:,EQU,SCDRUM+BASW
   1,VTM,-23
   2,VTM,-31
   ,XTA,
   ,ATX,W2.IW ЗAПИCИ
  ЦБ:,XTA,=:4
  2,ASN,64+31
  1,AAX,TDRUM+23
   ,UZA,ЧYЖOЙ
  3,VTM,ББ
  R70:,BSS,
   ,XTA,W1*70
   ,ARX,=1
   ,ATX,W1*70
   ,*70,W1*70
   ,XTA,W2
  3,UJ,
  ББ:,BSS,
  ,AUX,C370037
  ,AOX,B31
  ,ATX,W1
  ,*70,W1
   ЧYЖOЙ:,XTA,W2
  ,ARX,=:0004
  ,ATX,W2
  2,VLM,ЦБ
  2,VTM,-31
   1,VLM,ЦБ
 1,VTM,-30
C ЗAПИCЬ ЛИCTOB БEЗ ПEPBOГO
 ЦCTP:,UTC,BASW
 1,XTA,TMATHI+31
 ,ASN,64-1
 ,ASN,64+31
 ,UZA,HE HAДO P
 ,*76,RESPP
  3,VJM,R70
 ,ITA,1.
 ,ASN,64-10.
 ,ATI,14.
 14,XTA,76001B.
 HEHAДOP:,BSS,
 ,XTA,W1*70
 ,ARX,B31
 ,ATX,W1*70
 1,VLM,ЦCTP
 15,VTM,BASW+SM1
 14,VTM,-11
 ЦMOД:15,XTA,
 14,ATI,12
 14,VLM,ЦMOД
 ,*76,ПY
 GIVEMNF:,BSS,
C......   SUBROUTINE FOR LOOKING FOR MODULE
C         WHERE THE DISC WITH THAT NAME
C         (ACCUMULATOR) IS, AND THE FILE
C         ON IT (W1). W2 IS THE OLD NUMBER
C         OF MODULE. IF DISC IS ABSENT -
C         - STOP. IF FILE IS BUSY, ACC=0.
C         AFTER RETURN S = N OF MODULE.
C         J = N IN FATA FROM 0. W3 IS WORD
C         FOR FATA WITH NEW MODULE NUMBER.
C         REGISTER N IS CHANGED.
 ,ATX,W3.NEEDED NAME
C         LOOKIING FOR MODULE
 S,VTM,1-16
 LSFDP:S,*65,DNAM+15.NAME
 ,AEX,W3
 ,UZA,HEREITIS.IT IS THAT
 S,VLM,LSFDP
C         THERE IS NOT THE DISK. DIAGN.STOP
 T,VTM,TNP-IN.TEXT OF ABCENSE
 ,*76,IN
 HEREITIS:S,UTM,15+30B.THE N OF MOD.
C         SETTING THE BIT TO THE MATH.SCALE
C         OF THE OCCYPYED MODULES
 S,*65,BIT48-30B
 ,AOX,NEWSCD
 ,ATX,NEWSCD
 ,ITA,S.N WHERE THE NAME
 ,AEX,W2.OLD NUMBER
 ,ASN,64-30.CREATING A WORD
 ,AEX,W1.FOR FATA WITH
 ,ATX,W3.NEW N OF MOD.
C         LOOKING FOR SUCH WORD IN FATA
 ,ITA,LT.LENGTH OF FATA
 ,AEX,C77777
 ,ATI,N.THE COUTER OF
 N,UTM,2.LOOP OF LOOKING
 J,VTM,-1
  LSSF:J,UTM,1
 J,*65,FATA.IS THE WORD
 ,AEX,W3.THE SAME
  ,ASN,64-12.WITHOUT IDENT.
 15,UZA,.SAME
 N,VLM,LSSF
 15,UJ,
 ПY:,BSS,.ПOCЛEДHEE YCИЛИE
 14,REL,*
  BASA:,EQU,D-ПY
 ,WTC,Г Y C.
 15,VTM,.
  13,VTM,-21
 IF:13,UTC,21+BASA
 14,XTA,OCTИП3+54.
  13,UTC,21
 15,ATX,REGSCAL.
 13,VLM,IF.
 15,XTA,REGSCAL.
 ,AEX,BIT48.
 ,AAX,BIT48.
 ,ATX,I16.
 15,XTA,REGSCAL.
 ,AOX,BIT48
 15,ATX,REGSCAL.
 14,XTA,BASA+MO34
 15,ATX,26B.
 14,XTA,BASA+MO35.
 15,ATX,27B.
 14,XTA,SBT+BASA
  15,ATX,117B.AUS
 14,XTA,COBT+BASA
 ,ATX,I13. BT ДЛЯ KOPPEK
 15,VTM,-5
 ЦД:15,UTC,
 14,XTA,BASA+SM27
 15,ATX,M27
 15,VLM,ЦД
 14,XTA,BASA+SI14
 ,ATX,I14
 14,XTA,BASA+SI13
 ,ATI,13
 14,XTA,BASA+SI15
 ,ATI,15
 14,XTA,BASA+SI16
 ,ATX,SAVI16.
 14,XTA,TEK1-ПY
 14,ATX,BASA+NAM3
 14,UTM,BASA+NAME
 ,ITA,14
 14,CALL,TELOUT. NAME+(ПPOД) OПEPATOPY
 ,XTA,DISREG
 ,ATI,27B
 14,VTM,CO ЩИTOM
 14,MTJ,32B
 14,VTM,W*70
 ,UJ,MACRO70
 W11IF0:,BSS,
C         IF(MEMORY(N).NE.0) RETURN
C         MEMORY(N)=W3
C         ACC=0
C         RETURN
 14,REL,*
 N,XTA,
 ,U1A,M76RET
 ,XTA,W3
 ,UJ,WRW11
 WRAD11M:,BSS,
C         MEMORY(N)=MEMORY(N)+ACC(MOD2**15)
 14,UTM,W11IF0-WRAD11M
 N,ARX,
 ,AAX,C77777
 ,UJ,WRW11
 WRW11M:,BSS,
C         WRITING FROM W3 WITH
C         CLEANING WITH ACCUMULATOR
 14,UTM,W11IF0-WRW11M
 ,AEX,FULWOR
 N,AAX,
 ,AOX,W3
 WRW11:,BSS,.WRITE TO (N)
 N,ATX,
 ,XTA,
 M76RET:,MTJ,27B
 2,IJ,
 RESPP:,BSS,
 14,REL,*
 ,WTC,ГYC
 1,UTC,31.
 15,VTM,
 15,XTA,TMATH
 ,ASN,64+30
 ,U1A,*1
 ,XTA,BIT48
 15,AOX,TMATH
 15,ATX,TMATH
 *1:,MTJ,27B.
 2,IJ,.
 IN:,BSS,
 14,REL,*
C         PRINT ON THE TT AND STOP.
C         (ADDRESS OF THE TEXT - IN) IN T.
 T,J+M,14
 ,ITA,14
 14,CALL,TELOUT
 ,MTJ,27B
 ,UJ,STOP
C
 C77777:,LOG,77777
 B16/1:,LOG,177777
 C1/3:,LOG,4005 2525 2525 2526
 INHEAD:13,Z00,THEAD-B
 13,Z00,GTVAR-B
 :,055,
 9, ,
 THEAD:,GOST,18HПPOДOЛЖEHИE, ЗOHA
 GTVAR:,GOST,6H- 000'231'
 GUNP:,GOST,6H007770
 B31:,OCT,000001
 KP1:,OCT,0014
 C370037:,LOG,370037
 TNOTT:,ISO,12HHET TPAKTA(R
 ,OCT,
 TNST:,ISO,12HHET ЗAДAЧИ(R
 ,OCT,
 TFB:,ISO,12HФAЙЛ ЗAHЯT(R
 ,OCT,
 TNF:,ISO,12HHET MECTA(R''
 ,OCT,
 TNP:,ISO,12HHET ПAKETA(R
 ,OCT,
  TNBUF:,ISO,12HHET БYФEPA''''
 ,OCT,
 TEK1:,BSS,
  ,ISO,6H(ПP.)''
 W1*70:,BSS,1
 W1:,BSS,1
 W2:,BSS,1
 W3:,BSS,1
 W6:,BSS,1
 W2*70:,BSS,1
 NEWSCD:,BSS,1
 STNMM:,BSS,1
 ,END,
 TASKSAVR:,NAME,
 M:,EQU,100B.
 REGSCAL:,EQU,M.
 BISTIME:,EQU,110B
 *YCЫ:LC,BLOCK,ГYC
 ДHЗ:,LC,1
 B*76:,EQU,703B
 NEWTA:,SUBP,
 NRESCALL:,SUBP,
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR
 ДOПYПP:LC,BLOCK,AC,SR,AR,M33,M32,M27,I16,I15,I14,I13
 NRESTS:,SUBP,
 ,XTA,SAVSR.
 ,ATX,SR.
 ,YTA,
 ,ATX,AR
 ,XTA,INF
 ,UJ,NRESCALL
 INF:,Z00,NRESTS
 ,Z00,*+1
 ,ATI,13
 13,UJ,
 CO ЩИTOM:,ENTRY,
 ,XTA,ГYC
 ,ATI,14
 ,XTA,I13
 14,X-A,BISTIME+1
 14,ATX,BISTIME+1. KOPP ЗAKAЗ BPEM
 ,XTA,
 14,ATX,BISTIME
 14,ATX,-1
 14,XTA,REGSCAL.
 ,AEX,I16.
 14,ATX,REGSCAL.
 ,XTA,I14
 ,ATX,SAVAR+2
 ,XTA,M33
 ,ATI,33B
 ,XTA,M32
 ,ATI,32B
 ,XTA,M27
 ,ATI,27B
 ,XTA,AC.
 ,ATX,SAVAC.
 HA ЩИTE:,ENTRY,
 ,XTA,AR
 ,ATX,SAVAR
 ,XTA,SR.
 ,ATX,SAVSR.
 ,UJ,NEWTA
 ,END,
 TASKSAV:,NAME,
 Д H З:LC,BLOCK,STN
 HAЩИTE:,SUBP,
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,(1),SAVI16
 ДOПYПP:LC,BLOCK,AC,SR,R,M33,M32,M27,I(4)
 ,CONT,NTRFRO
 *YCЫ:LC,BLOCK,ГYC
  TABDRU:,LC,1
 DISREG:,LC,1
 *677:B,BLOCK,(9),BIT40,BIT39,(20)
 ,CONT,BIT18,(1),BIT16(11)
 ,CONT,BIT5(4),BIT1
 STATUSMT:LC,BLOCK,MBUS,OLD(4),NEW(4),DIF(4).
  ,CONT,(19),MISTERX
   REWINDSC:LC,BLOCK,(1),R/WR,R/CONTR
  TPAKTЫ:,EQU,175B
  C7777:,LC,1
  C3    :,LC,1
  MACRO70S:,SUBP,
  C77357:,LC,1
  BUFI14:,EQU,103B
  BUFS27:,EQU,104B
 C77777:,LC,1
 C77:,LC,1
 C20:,EQU,BIT5
 TTPRINT:,SUBP,
 BIT48:,EQU,700B
 M:,EQU,100B.
 REGSCAL:,EQU,M.
  * И П Д :LC,BLOCK,XNF(5),XNC
 ,CONT,(21),MONO
  NMAT1:,WEQ,XNF
  NC   :,WEQ,XNC
  * И П K 1 :,LC,1
 BISTIME:,EQU,110B
 BIT46:,EQU,BIT48+2
 TABLEMT:LC,BLOCK,(16),T1MT(32),(48)
 ,CONT,(16),TNAM(32)
 NRESTS:,SUBP,
 NRESOFF:,SUBP,
 TRAPHY:,SUBP,.
 C7:,LC,1
C         БЛOKИ, CBЯЗAHHЫE C ДИCKAMИ
  *DISCS:LC,BLOCK,DNAM
  TABSCR:,EQU,425B
  FATA:,LC,1
  LFATA:,EQU,XNF+20B
  LENTDIS:,EQU,XNF+21B
  *TDIS:,LC,
 TEX:,EQU,*TDIS.TAБЛ.ЭKCTEHTOB
  LTX:,WEQ,LENTDIS.ЭKCTEHTOB
 LTXM1:,EQU,LTX-1
  FREXT:,EQU,XNF+34B
  MONC :,EQU,XNF+33B
  *127:B,BLOCK,MTD,MTDJ
  MONTAS:,EQU,*ИПK1+NC
C         OПИCAHИE AБЗAЦA CБPOCA
 *0:,BLOCK,(1),CST,CRT,BFRA,BFRB
 ,CONT,(7),FIELD
C
 AKATBB:,EQU,506B.AДP.KAT.BBOДA
 NPL:,P/P,(*)1024
 BEGIN:,P*P,(NPL)1024
 13,REL,BEGIN
 SB:,EQU,1400B
 13,UTM,BEGIN-*
 ,XTA,SAVAC.CПACENИE KOПИИ
 ,ATX,AC.CYMMATOPA
 ,XTA,SAVI16. ''
 ,ATX,I.16- O MOДИФИKATOPA
 14,VTM,1-3
 SAVIND:14,XTA,SAVI13.CПACEHИE KOПИЙ
 14,ATX,I+3.PEГИCTPOB
 14,VLM,SAVIND.13,14,15
C         CПACEHИE BPEMEH
 ,WTC,ГYC
 15,VTM,
 15,XTA,BISTIME
 ,ATX,BT
C         ECTЬ ЛИ Y ЗAДAЧИ ДИCK
C         B MOHOПOЛЬHOM PEЖИME
C         ПPИ ЭTOM HEЛЬЗЯ CБPACЫBATЬ
 14,VTM,TABMON.TEKCT O MOHOПOЛ
 ,WTC,STN
 ,XTA,MONTAS-NMAT1
 ,ASN,64+32.ШK.MOHOПOЛИИ
 ,AAX,MONO
 ,U1A,MES1.ECTЬ MOHOПOЛИЯ
C         ECTЬ ЛИ ROLL TPAKT
 14,VTM,TEKHET
 ,XTA,NTRFRO
 ,UZA,MES1.HET
C         ЧTEHИE CEKTOPA CБPOCA HA AБЗAЦ
 ,ITA,13.БAЗA
 ,ATX,SAVAR.CПACAETCЯ
 ,ASN,64+8
 ,ASN,64-10.BCTABKA B KYC
 ,AOX,NTRFRO
 ,ATX,KYCWR.ДЛЯ TRAPHY
 ,AOX,BIT18.ЧTEHИE
 ,ATX,W
 13,UTM,W-BEGIN.AДPEC W
 14,VJM,TRAPHY
 ,WTC,SAVAR.BOCCTAHOBЛEHИE
 13,VTM,.БAЗЫ
C         CБPACЫBAЛИCЬ ЛИ ДPYГИE ЗAДAЧИ
 13,XTA,CST+SB
 ,UZA,RINTR1.HET
 13,XTA,BFRB+SB.HAЧ.CBOБ.ЗOH
 ,ATX,WFOR*70
 ,ATX,DWFOR
 ,UJ,SETREC
 RINTR1:,BSS,
C         CБPOCOB EЩE HE БЫЛO -
C         MECTO CБPOCA ЧИTAETCЯ C TP3.
 ,XTA,3
 ,ASN,64-33.
 ,AUX,C770777
 ,AOX,BIT39
 ,ATX,WFOR*70
 ,ATX,DWFOR
 ,ASN,64+12.ФИЗ. HOMEP
 ,ATX,I1R.MAГHИTOФOHA
C         ПPOBEPKA, ЛEHTOЧHOE ЛИ HAПPABЛEHИE
 ,XTA,DWFOR
 ,ARX,BIT16
 ,AAX,BIT18
 ,U1A,GOODTAPE.OБЫЧHAЯ ЛEHTA
C         CБPOC HA MOДEЛЬ ЛEHTЫ,
C         ПOИCK MOДEЛИ CO CTAHД.ИMEHEM
C         ECЛИ EE HET, CБPOC HEBOЗMOЖEH
  ,XTA,OWNNAME.CTAHД. ИMЯ
 ,*57,400B
 14,VTM,TNOSPMOD.ДИAГHOCTИKA
 ,UZA,MES1.MOДEЛИ HET
 ,ATX,I1R.EE ФИЗ. HOMEP
 ,XTA,BIT46.YCTAHOBKA
 ,AOX,WFOR*70.ПPИЗHAKA
 ,ATX,DWFOR.MOДEЛИ ЛEHTЫ
 ,ATX,WFOR*70
 GOODTAPE:,BSS,
C         ЗAПИCЬ ИCXOДHOГO COCTOЯHИЯ HA
C         AБЗAЦ DЛЯ CEKTOPA CБPOCA
 ,XTA,
 13,ATX,CRT+SB.ЧИCЛO BOCCT.
 13,ATX,BFRA+SB.CB.MECTO AБЗAЦA
 ,XTA,WFOR*70.HAЧ.БYФEPA
 13,ATX,BFRB+SB.CB.MECTO БYФ
C         ЗAПИCЬ ИMEHИ БYФEPA CБPOCA.
 ,WTC,I1R
 ,XTA,TNAM-30B.ИMЯ B ПOCЛEДEИE
 13,ATX,SB+377B.CЛOBO CEKTOPA
 SETREC:,BSS,
C         OБЩAЯ ЧASTЬ HEЗABИCИMO OT
C         TOГ0, KAKOЙ HOMEP BXOДA
C
C         YCTAHOBKA PEЖИMA ФИЗ.ДEЙCTBИЙ
 ,WTC,ГYC
 15,VTM,.
 15,XTA,REGSCAL.
 ,ATX,SRSCAL.
 ,AOX,BIT48.ФИЗ.ДEЙCTBИЯ
 15,ATX,REGSCAL.
   :   ,24,3.
C         ЗAПИCЬ ПEPBOГO ЛИCTA
 ,XTA,WFOR*70
  14,VJM,WRITEP
C         ПOДГOTOBKA CBEДEHИЙ O ЗAДAЧE
C         ЗAПИCЬ CBEДEHИЙ ДЛЯ CTATИCTИKИ
C          И KOMMEPЧECKOГO BPEMEHИ.
  ,FUN,70100B+117B.AUS
   :   ,24,
 ,ATX,6.AUS(MШ) AБC
   :   ,24,3
 ,XTA,BT. KOMM.BPEMЯ
   :   ,24,
 ,ATX,5
   :    ,24,3
C         ПEPEПИCЬ ПOЛЯ MAЛOГO YПPЯTЫBAHИЯ
 15,VTM,10B
 ,XTA,INДOП
 14,VJM,ARRTOARR
C         ПEPEПИCЬ OCTATKA ИПЗ.
 ,XTA,ГYC
 ,AAX,C77777
 ,ARX,ININF
 14,VJM,ARRTOARR
 ,XTA,SRSCAL.
C         ЗAПOMИHAHИE ИCXOДHOГO PEЖИMA
   :   ,24,2000B
   15,ATX,-26B
   :     ,24,3
C..  ЗAПOMИHAHИE CПИCKA CBOИX MЛ
C..  И ИXHИX PEЖИMOB.
  ,XTA,DISREG
  ,ATI,27B
  ,ITA,15
  ,ATX,N1P
  ,AOX,=:4200 0000 001
  15,UTM,24
  12,VTM,-47
  ,ATX,BT
  ,*72,BT
  ЦЛEHT:12,XTA,TABLEMT+47
  ,ASN,64+42
  ,AEX, Д H З
  ,U1A,KOЦЛEHT
  12,XTA,TNAM+31
   :    ,24,
  15,ATX,
   :    ,24,3
  11,VTM,
  12,XTA,BIT48+47
  ,ASN,64-16
   ,AAX,MISTERX
  ,UZA,ИMMЛ
   11,UTM,4.NO CHECK
  ИMMЛ:,XTA,R/WR
  12,AAX,BIT48+47
  ,UZA,NOWRIT
  11,UTM,1.PEЖ.ЗAПИCИ
  NOWRIT:,XTA,R/CONTR
  12,AAX,BIT48+47
  ,UZA,NOCONTR
  11,UTM,2.PEЖ.C KOHTPOЛEM
  NOCONTR:12,XTA,TABLEMT+47
   ,ASN,64+9
  ,ATI,10.ДEЛЬTA+ПЛOTHOCTЬ
  ,ASN,64+27
   ,AAX,C77
  ,ATI,9.MAT.HOMEP
   :    ,24,
   ,ITA,11
   ,ASN,64-45
  ,ITS,10
   ,ASN,64-13
  ,ITS,9
  15,AOX,
  15,AOX,
  15,ATX,
  KOЦЛEHT:,24,3
  12,VLM,ЦЛEHT
  ,XTA,
   :    ,24,
  15,ATX,
  15,ATX,
   :    ,24,3
   ,WTC,N1P
    15,VTM,88
C         ПEPEПИCЬ ФAЙЛOBOЙ TAБЛИЦЫ
 ,XTA,LFATA.ДЛИHA TAБЛИЦЫ
 ,AEX,C77777
 ,ASN,64-24
 ,ARX,INFATA
 14,VJM,ARRTOARR
C         ПEPEПИCЬ ИMEH ПAKETOB
 ,XTA,INDNAM
 14,VJM,ARRTOARR
C         ЗAПИCЬ CBEДEHИЙ O ЗAДAЧE
  14,VJM,WRITEP1
   ,WTC, Г Y C
  5,VTM,TPAKTЫ
  ,XTA,
  ,ATX,N1P
  8,VTM,-191
  ЦMБ:5,XTA,
  5,UTM,1
  ,ATX,BT
  7,VTM,-3
   Ц4TP:,XTA,BT
   ,ASN,64-12
   ,ATX,BT
   ,YTA,
  ,UZA,KOЦMБ
  ,XTA,N1P
  ,AUX,=37 0037
  ,AOX,BIT40
  14,VJM,WRITEP
  14,VJM,WRITEP1
  KOЦMБ:,XTA,N1P
  ,ARX,BIT39
  ,ATX,N1P
  7,VLM,Ц4TP
  8,VLM,ЦMБ
 8,VTM,-30
C         ЗAПИCЬ ЛИCTOB
 CICSAVP:,WTC,ГYC
 8,XTA,30B+31.ПPOCMOTP C 2 CTP.
 7,UTM,2000B.EE AДPEC
  ,ASN,64-1
  ,ASN,64+31
 ,UZA,ЧYЖCTP
 ,XTA,WFOR*70
 ,ARX,BIT1
 ,ATX,WFOR*70
  ,ITA,7
  ,ASN,64-20
 ,AOX,WFOR*70
 14,VJM,WRITEP
C         ДEPГAHИE ЛИCTA ДЛЯ
C         OЖИДAHИЯ KOHЦA OБMEHA
   :   ,24,.
 7,XTA,1
   :   ,24,3.
 ЧYЖCTP:8,VLM,CICSAVP
 YCTP:LC,BLOCK,(6),YCDC608(2)
 ,XTA,YCDC608.
 ,AEX,Г Y C.
 ,U1A,HET CDC.
 ,ATX,YCDC608.
 HET CDC:,BSS,.
C         ПOДГOTOBKA HOOГO CEKTOPA CБPOCA
 ,XTA,WFOR*70
 ,AAX,Z35/31
 ,ARX,BIT1.HOBOE HAЧAЛO
 13,ATX,BFRB+SB.CBOБOДHЫX ЗOH
 13,XTA,SB+CST
 ,ARX,BIT1.YBEЛИЧEHИE ЧИCЛA
 13,ATX,CST+SB.CБPOШEHHЫX ЗAДAЧ
 13,XTA,BFRA+SB.CBOБ. MECTO
 ,ATI,1
 ,ASN,64-24.MECTO ЗAДAЧИ
 ,AOX,DWFOR.БYФEP ЗAДAЧИ
 13,WTC,CST+SB.ЗAПИCЬ HAЧAЛ
 13,ATX,BFRB+SB.ПOЛЯ И ЗOH
 1,MTJ,15
C         YЧET STN,TEX,MTD,MTDJ
 1,UTM,LTX+3.OTH.AДP.ПOЛЯ
 13,UTC,FIELD+SB.AДPEC HAЧAЛA
 15,UTM,.CBOБOДHOГO MECTA
 ,XTA,STN.ЗAПИCЬ
 15,ATX,.ДHЗ ЗAДAЧИ
  ,NTR,3
  ,A-X,C20
  ,ATX,BT
 ,ASN,64-16.ПOДГOTOBKA
 ,AOX,BT.PAЗMHOЖEHHOГO
 ,ASN,64-16.ДHЗ ДЛЯ БЛOKИ-
 ,AOX,BT.POBKИ ЭKCTEHTOB,
 ,ATX,BT.ЗAHЯTЫX ЗAДAЧEЙ
 3,VTM,-LTXM1
C         ПEPEПИCЬ TAБЛИЦЫ ЭKCTEHTOB
 MOTEX:,24,2003B
 3,XTA,TEX+LTXM1.CЛOBO TAБЛИЦЫ
 15,ATX,.ЗAПИCЬ B ПOЛE
C         БЛOKИPOBKA CBOИX ЭKCTEHTOB
 ,ASN,64+11
 ,AEX,BT
 ,AAX,C37*
 ,ARX,C37*
 ,ASN,64+5
 ,AAX,C37*.B ЧYЖИX - 1
 ,ATX,CT
 ,ARX,C3777*
 ,AAX,C3777*.B CBOИX - 3777
   ,ATX,W
   ,ASN,64-5
   ,AOX,W.B CBOИX- 177777
 15,AAX,-1
   ,AEX,W
 15,AEX,-1
 3,ATX,TEX+LTXM1
C         ИЗ CЧETЧИKA CBOБOДHЫX ЭKCTEHTOB
C         BЫЧИTAETCЯ KOЛИЧ.CBOИX B CЛOBE
 ,XTA,CT
 ,ACX,MIN3AD.2**15-3
 ,ARX,FREXT.CЧETЧИK
 ,AAX,C77777.CBOБOДHЫX
 ,ATX,FREXT.ЭKCTEHTOB
   :   ,24,3
 3,VLM,MOTEX
C         ЗAПИCЬ ЯЧEEK O ИCПOЛЬЗOBAHИИ
C         ДИCKOB, ДYБЛИPOBAHHЫX ПO ШИФPAM
  ,WTC, Г Y C
  ,XTA,MTD
  ,WTC, Г Y C
  ,XTS,MTDJ
  15,ATX,
C         ПEPEПИCЬ TAБЛИЦЫ SCRATCH,
C         COOTBETCTBYЮЩИЬ ФAЙЛOB И
C         ИMEH ДИCKOBЫX ПAKETOB.
 3,VTM,TABSCR
 MSCRT:3,XTA,.ЗAПИCЬ ЭЛEMEHTA
 15,ATX,.ИЛИ ПPИЗ.KOHЦ-0
 1,UTM,1
 ,UZA,EMSCRT.KOHEЦ
 ,ASN,64+15.HOMEP ФAЙЛA
 ,ATI,4
  4,XTA,FATA-1.CCЫЛKA ФAЙЛA
 15,ATX,
 ,ASN,64+30
 ,AAX,C77.HOMEP MOДYЛЯ
 ,ATI,5
 5,XTA,DNAM-30B.ИMЯ ПAKETA
 15,ATX,
 1,UTM,2.OTH.AДPEC
 3,VLM,MSCRT
 EMSCRT:,BSS,
 ,ITA,1.HAЧAЛO CB.MECTA
 13,ATX,BFRA+SB
C         ПPИФOPMИPOBKA ЛИCKA B KYC
C         ЗAПИCИ AБЗAЦA HA MБ.
 ,ITA,13
   :   ,24,2003B
 ,ATX,SAVAR.CПACEHИE БAЗЫ
 ,ASN,64-2
 ,AOX,NTRFRO
 ,ATX,KYCWR.ЗAП.AБЗAЦA
   ,AOX,C3
   ,ATX,W
   ,AOX,BIT18
   ,ATX,BASE1
C         ЗAПИCЬ AБЗAЦA HA CПEЦИAЛЬHЫЙ TP.
 13,UTM,KYCWR-BEGIN
 14,VJM,TRAPHY
   ,WTC,SAVAR
   13,VTM,BASE1-BEGIN
   14,VJM,TRAPHY.ЧTEHИE 3 CEKTOPA
   ,WTC,SAVAR
   13,VTM,
   ,XTA,MISTERX
   13,AOX,1776B
   13,ATX,1776B
  13,UTM,W-BEGIN
   14,VJM,TRAPHY.ЗAПИCЬ 3 CEKTOPA
 ,XTA,DISREG
 ,ATI,27B
 ,WTC,SAVAR.БAЗA
 13,VTM,
 ,*64,IN*64
 ,SJ,
  WRITEP1:,XTA,WFOR*70
   ,ARX,BIT1
   ,ATX,WFOR*70
 WRITEP:,BSS,
 ,ATX,BASE1.ИHФ. CЛOBO
 ,ITA,14
 14,VJM,GIVPHN.ЗA N MAГHИTOФOHA
   :    ,24,2003B
  ,XTA,RET
  ,ATI,32B
  ,ITA,27B
  ,AAX,C77357
  ,ATI,27B
  ,WTC,Г Y C
  ,ATX,BUFS27
 ,XTA,BASE1.BEPHOE ИHФ.
  ,UJ,MACRO70S
 ARRTOARR:,BSS,
 ,ATX,BASE1
 ,ASN,64-24
 ,ITA,14
 ,ATX,CT
 ,YTA,
 ,ATI,14
 ,AEX,C77777
 ,ARX,BASE1
 ,ARX,BIT1
 ,ATX,BASE1
 CIC:,WTC,BASE1
 14,XTA,
   :   ,24,
 15,ATX,
   :   ,24,3
 14,VLM,CIC
 ,WTC,CT
 ,UJ,
 GIVPHN:,BSS,
C         ПOДПPOГPOMMA ПOЛYЧEHИЯ ИHФ.CЛOBA
C         C ПPOBИЛЬHЫM ФИЗ.HOMEPOM ЛEHTЫ.
C         ACC BXOДA ПPЯЧETCЯ B RET.
C         CЛOBO KOPPEKTИPYETCЯ B BASE1.
C         HA BЫXOДE PEЖИM И I27 - 2013B,
 ,ATX,RET
 ,ITA,14.AДP. BOЗBPATA
 ,ATX,I1R
   :   ,24,2003B
 ,XTA,DISREG
 ,ATI,27B
C         A HE ФИЗИЧECKИЙ ЛИ БAPAБAH
 ,XTA,BASE1
 ,ARX,BIT16
 ,AAX,B46A18
 14,UZA,.ФИЗ. БAPAБAH
 ,XTA,BASE1.ЧИCTKA
 ,AAX,Z18/13.HOMEPA B
 ,ATX,BASE1.ИHФ.CЛOBE
 15,VTM,
 LOOPWAIT:13,XTA,SB+377B.ИMЯ MЛ
 15,*57,170B.ГДE ЛEHTA
 ,U1A,HSTS.HAЙДEHA
 ,*57,3.ЗAДEPЖKA
 15,VTM,210B
 ,UJ,LOOPWAIT
 HSTS:,ASN,64-12.ЗAHECEHИE
 ,AOX,BASE1.HOMEPA B
 ,ATX,BASE1.ИHФ.CЛOBO
 ,WTC,I1R
 ,UJ,
 MES1:,BSS,
 ,ITA,14
 14,VJM,TTPRINT
 ,XTA,M33
 ,ATI,33B
 ,XTA,M27
 ,ATI,27B
 ,XTA,M32
 ,ATI,32B
 ,XTA,WFNROFF
 ,AEX,.
 ,XTA,SAVI13.
 ,ATI,13.
 ,XTA,SAVI14.
 ,ATI,14.
 ,XTA,SAVI15.
 ,ATI,15.
 ,YTA,.
 ,UJ,NRESOFF
 WFNROFF:,Z00,NRESTS
 ,Z00,HAЩИTE
 INДOП:,Z00,-9
 ,Z00,ДOПYПP
  ININF:,Z00,-75.OCT.ИПЗ
 ,Z00,10
 INFATA:, ,2
 ,Z00,FATA
 INDNAM:,Z00,1-16
 ,Z00,DNAM
 C770777:,LOG,770777
 IN*64:,,ATEKCT
 ,,WFOR*70
 ,055,
 ,,
 2,111,3
 ,,
 ,115,
 ,,
 2,117,3
 8,,
 C37*  :,GOST,6H0'37'0'37'0'37'
 C3777*:,GOST,6H7'377'7'377'7'377'
 ATEKCT:,GOST,6HЗAДAЧA
 ,CONT,15H CБPOШEHA HA MЛ
 ,CONT,6H ЗOHЫ'231'
 DWFOR:,BSS,1
 ,GOST,2H-'231'
 WFOR*70:,BSS,1
 OWNNAME:,TEXT,8HROLLIB'0''1'
 Z18/13:,LOG,7777 7777 7700 7777
 B46A18:,LOG,1000 0000 0040 0000
 Z35/31:,OCT,7777 4077 7777 7777
 MIN3AD:,LOG,77775
 TEKHET:,ISO,12HHET TPAKTA''''
 TABMON:,ISO,12HMOHOПOЛИЯ''''''
 TNOSPMOD:,ISO,12HHET R.MOДEЛИ
 ,LOG,
 N1P:,BSS,1
 W:,BSS,1
 I1R:,BSS,1
 BASE1:,BSS,1
 CT:,BSS,1
 BT:,BSS,1
 RET:,BSS,1
 SRSCAL:,BSS,1.
 KYCWR:,BSS,1
 ,END,
