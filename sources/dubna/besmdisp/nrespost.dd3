 ДИCПHAMБ:,NAME,.
 DISPBASE:LC,BLOCK,(1),DISMBASE
 C7:,LC,1
 BIT19:,EQU,735B
 NRTABL:,SUBP,
 SAVENRT:,EQU,10B
  LNRT:,EQU,32
  NPAБЛИCT:,LC,1
  MTP:,EQU,77B
  ENRT:,EQU,NRTABL+31
 ,XTA,DISMBASE.ПPЯЧEM
  14,VTM,1-70B.БAЗY
  L*:14,ATX,77B.ЗAOДHO TPEM
     14,VLM,L*.10-77  ADPECA
 2,VTM,-7
 1,VTM,1-LNRT
  ,XTA,NPAБЛИCT
  ,ATX,MTP
  L1:1,XTA,ENRT.TAБЛИЦA
 1,ATX,SAVENRT+LNRT.HИPEЗИДEHTOB
 1,VLM,L1
 ,XTA,3
 ,ASN,64+3.БAPAБAH
 ,AAX,C7.ДЛЯ CПACEHИЯ
 ,ATI,14.PAБ.BAP.ДИCП
 ,XTA,3.ЗAДAETCЯ B 1-5
 ,AAX,C7.PAЗPЯДAX 3 T.P.
 ,ASN,64-7
 ,AOX,BIT19
CФOPMИPOBAH  K Y C  ЗAПИCИ HA MБ
 1,VTM,-31
 L2:,ATX,1.
 2,VLM,L2.
 L3:2,VTM,40 000B.
 14,EXT,.
 L4:,ATI,.
 2,VLM,L4.
 ,ARX,=1 0004.
 1,VLM,L3.
 :,33,-1.
 ,UJ,*.
 ,END,.
 ALLTOISO:,NAME,
C
C
C   :-----:-----:-----:-----:-----:-----:
C   :GOST : ISO : TEL :CONS.:TEXT :ISO P:
C   :  B  :  B  :  B  :  B  :  B  :  B  :
C   : EC  :GOST : ISO : ISO : ISO :ISO Л:
C   :-----:-----:-----:-----:-----:-----:
C
C
 ,ISO,3H'360''017''000'.000
 ,CONT,3H'060''000''000'
 ,ISO,3H'361''017''133'.001
 ,CONT,3H'061''040''001'
 ,ISO,3H'362''017''176'.002
 ,CONT,3H'062''142''002'
 ,ISO,3H'363''017''000'.003
 ,CONT,3H'063''143''003'
 ,ISO,3H'364''017''000'.004
 ,CONT,3H'064''144''004'
 ,ISO,3H'365''135''000'.005
 ,CONT,3H'065''146''005'
 ,ISO,3H'366''024''000'.006
 ,CONT,3H'066''147''006'
 ,ISO,3H'367''017''000'.007
 ,CONT,3H'067''151''007'
 ,ISO,3H'370''017''000'.010
 ,CONT,3H'070''056''010'
 ,ISO,3H'371''017''044'.011
 ,CONT,3H'071''000''011'
 ,ISO,3H'116''017''000'.012
 ,CONT,3H'053''052''012'
 ,ISO,3H'140''017''000'.013
 ,CONT,3H'055''152''013'
 ,ISO,3H'141''017''041'.014
 ,CONT,3H'057''154''014'
 ,ISO,3H'153''017''000'.015
 ,CONT,3H'000''161''015'
 ,ISO,3H'113''116''000'.016
 ,CONT,3H'000''166''016'
 ,ISO,3H'100''117''000'.017
 ,CONT,3H'000''057''017'
 ,ISO,3H'305''033''052'.020
 ,CONT,3H'015''060''020'
  ,ISO,3H'157''017''000'.021
 ,CONT,3H'012''061''021'
 ,ISO,3H'115''017''135'.022
 ,CONT,3H'036''062''022'
 ,ISO,3H'135''017''000'.023
 ,CONT,3H'030''063''023'
 ,ISO,3H'134''017''000'.024
 ,CONT,3H'000''064''024'
 ,ISO,3H'176''017''176'.025
 ,CONT,3H'000''065''025'
 ,ISO,3H'136''021''135'.026
 ,CONT,3H'000''066''026'
 ,ISO,3H'112''020''000'.027
 ,CONT,3H'040''067''027'
 ,ISO,3H'132''034''000'.030
 ,CONT,3H'136''070''030'
 ,ISO,3H'134''136''000'.031
 ,CONT,3H'052''071''031'
 ,ISO,3H'175''124''000'.032
 ,CONT,3H'000''170''032'
 ,ISO,3H'175''032''000'.033
 ,CONT,3H'000''072''033'
 ,ISO,3H'173''122''000'.034
 ,CONT,3H'000''160''034'
 ,ISO,3H'114''125''000'.035
 ,CONT,3H'000''055''035'
 ,ISO,3H'156''120''000'.036
 ,CONT,3H'021''053''036'
 ,ISO,3H'172''123''000'.037
 ,CONT,3H'024''171''037'
 ,ISO,3H'301''017''240'.040
 ,CONT,3H'101''172''040'
 ,ISO,3H'272''133''113'.041
 ,CONT,3H'142''101''041'
 ,ISO,3H'302''134''121'.042
 ,CONT,3H'102''102''042'
 ,ISO,3H'277''034''125'.043
 ,CONT,3H'147''103''043'
 ,ISO,3H'274''127''340'.044
 ,CONT,3H'144''104''044'
 ,ISO,3H'305''126''112'.045
 ,CONT,3H'105''105''045'
 ,ISO,3H'354''121''127'.046
 ,CONT,3H'166''106''046'
 ,ISO,3H'372''032''101'.047
 ,CONT,3H'172''107''047'
 ,ISO,3H'313''022''130'.050
 ,CONT,3H'151''110''050'
 ,ISO,3H'314''023''106'.051
 ,CONT,3H'152''111''051'
 ,ISO,3H'322''031''131'.052
 ,CONT,3H'113''112''052'
 ,ISO,3H'316''012''123'.053
 ,CONT,3H'154''113''053'
 ,ISO,3H'324''015''102'.054
 ,CONT,3H'115''114''054'
 ,ISO,3H'310''013''104'.055
 ,CONT,3H'110''115''055'
 ,ISO,3H'326''016''132'.056
 ,CONT,3H'117''116''056'
 ,ISO,3H'334''014''105'.057
 ,CONT,3H'160''117''057'
 ,ISO,3H'327''000''126'.060
 ,CONT,3H'120''120''060'
 ,ISO,3H'303''001''103'.061
 ,CONT,3H'103''121''061'
 ,ISO,3H'343''002''120'.062
 ,CONT,3H'124''122''062'
 ,ISO,3H'350''003''111'.063
 ,CONT,3H'131''123''063'
 ,ISO,3H'276''004''107'.064
 ,CONT,3H'146''124''064'
 ,ISO,3H'347''005''122'.065
 ,CONT,3H'130''125''065'
 ,ISO,3H'273''006''114'.066
 ,CONT,3H'143''126''066'
 ,ISO,3H'376''007''012'.067
 ,CONT,3H'176''127''067'
 ,ISO,3H'373''010''115'.070
 ,CONT,3H'173''130''070'
 ,ISO,3H'375''011''116'.071
 ,CONT,3H'175''131''071'
 ,ISO,3H'357''037''110'.072
 ,CONT,3H'171''132''072'
 ,ISO,3H'356''026''040'.073
 ,CONT,3H'170''173''073'
 ,ISO,3H'374''035''117'.074
 ,CONT,3H'174''174''074'
 ,ISO,3H'270''025''015'.075
 ,CONT,3H'140''175''075'
 ,ISO,3H'335''036''124'.076
 ,CONT,3H'161''176''076'
 ,ISO,3H'304''021''300'.077
 ,CONT,3H'000''140''077'
 ,ISO,3H'306''136''240'.100
 ,CONT,3H'135''000''100'
 ,ISO,3H'307''040''113'.101
 ,CONT,3H'054''000''101'
 ,ISO,3H'311''042''161'.102
 ,CONT,3H'056''000''102'
 ,ISO,3H'321''061''131'.103
 ,CONT,3H'000''000''103'
 ,ISO,3H'323''077''340'.104
 ,CONT,3H'100''000''104'
 ,ISO,3H'325''045''152'.105
 ,CONT,3H'050''000''105'
 ,ISO,3H'330''100''102'.106
 ,CONT,3H'051''000''106'
 ,ISO,3H'331''101''101'.107
 ,CONT,3H'000''000''107'
 ,ISO,3H'342''055''170'.110
 ,CONT,3H'073''000''110'
 ,ISO,3H'344''102''146'.111
 ,CONT,3H'133''000''111'
 ,ISO,3H'345''103''171'.112
 ,CONT,3H'040''000''112'
 ,ISO,3H'346''052''103'.113
 ,CONT,3H'075''000''113'
 ,ISO,3H'351''104''142'.114
 ,CONT,3H'076''000''114'
 ,ISO,3H'340''054''144'.115
 ,CONT,3H'000''000''115'
 ,ISO,3H'300''105''172'.116
 ,CONT,3H'000''000''116'
 ,ISO,3H'320''056''105'.117
 ,CONT,3H'000''000''117'
 ,ISO,3H'152''060''166'.120
 ,CONT,3H'000''000''120'
 ,ISO,3H'120''106''143'.121
 ,CONT,3H'012''000''121'
 ,ISO,3H'133''107''160'.122
 ,CONT,3H'030''000''122'
 ,ISO,3H'137''110''151'.123
 ,CONT,3H'032''000''123'
 ,ISO,3H'172''062''147'.124
 ,CONT,3H'000''000''124'
 ,ISO,3H'176''111''120'.125
 ,CONT,3H'000''000''125'
 ,ISO,3H'154''112''154'.126
 ,CONT,3H'000''000''126'
 ,ISO,3H'133''113''012'.127
 ,CONT,3H'040''000''127'
  ,ISO,3H'152''065''115'.130
 ,CONT,3H'137''000''130'
 ,ISO,3H'140''063''110'.131
 ,CONT,3H'077''000''131'
 ,ISO,3H'155''114''130'.132
 ,CONT,3H'000''000''132'
  ,ISO,3H'117''027''040'.133
 ,CONT,3H'000''000''133'
 ,ISO,3H'177''115''117'.134
 ,CONT,3H'000''000''134'
 ,ISO,3H'356''030''015'.135
 ,CONT,3H'000''000''135'
 ,ISO,3H'174''131''124'.136
 ,CONT,3H'000''000''136'
 ,ISO,3H'175''132''300'.137
 ,CONT,3H'000''000''137'
 ,ISO,3H'100''075''240'.140
 ,CONT,3H'000''000''140'
 ,ISO,3H'100''040''050'.141
 ,CONT,3H'045''000''101'
 ,ISO,3H'100''041''061'.142
 ,CONT,3H'127''000''142'
 ,ISO,3H'100''066''067'.143
 ,CONT,3H'107''000''143'
 ,ISO,3H'100''044''340'.144
 ,CONT,3H'104''000''144'
 ,ISO,3H'100''045''140'.145
 ,CONT,3H'072''000''105'
 ,ISO,3H'100''064''062'.146
 ,CONT,3H'126''000''146'
 ,ISO,3H'100''043''055'.147
 ,CONT,3H'132''000''147'
 ,ISO,3H'100''065''057'.150
 ,CONT,3H'111''000''130'
 ,ISO,3H'100''050''174'.151
 ,CONT,3H'112''000''151'
 ,ISO,3H'100''051''066'.152
 ,CONT,3H'000''000''152'.
 ,ISO,3H'100''052''047'.153
 ,CONT,3H'114''000''113'.
 ,ISO,3H'100''053''036'.154
 ,CONT,3H'000''000''154'
 ,ISO,3H'100''054''030'.155
 ,CONT,3H'116''000''115'
 ,ISO,3H'100''055''053'.156
 ,CONT,3H'000''000''110'
 ,ISO,3H'100''056''063'.157
 ,CONT,3H'000''000''117'
 ,ISO,3H'100''057''075'.160
 ,CONT,3H'122''000''160'
 ,ISO,3H'100''076''072'.161
 ,CONT,3H'123''000''161'
 ,ISO,3H'100''060''060'.162
 ,CONT,3H'000''000''120'
 ,ISO,3H'100''061''070'.163
 ,CONT,3H'125''000''103'
 ,ISO,3H'100''062''173'.164
 ,CONT,3H'106''000''124'
 ,ISO,3H'100''063''064'.165
 ,CONT,3H'074''000''131'
 ,ISO,3H'100''046''051'.166
 ,CONT,3H'043''000''166'
 ,ISO,3H'100''042''012'.167
 ,CONT,3H'000''000''102'
 ,ISO,3H'100''073''056'.170
 ,CONT,3H'047''000''170'
 ,ISO,3H'100''072''054'.171
 ,CONT,3H'047''000''171'
 ,ISO,3H'100''047''175'.172
 ,CONT,3H'041''000''172'
 ,ISO,3H'100''070''040'.173
 ,CONT,3H'046''000''173'
 ,ISO,3H'100''074''071'.174
 ,CONT,3H'000''000''174'
 ,ISO,3H'100''071''015'.175
 ,CONT,3H'044''000''175'
 ,ISO,3H'100''067''065'.176
 ,CONT,3H'121''000''176'
 ,ISO,3H'100''017''300'.177
 ,CONT,3H'000''000''177'
 ,END,
 ISOTOALL:,NAME,
C
C
C  :-----:-----:-----:-----:-----:-----:
C  : ISO    B    TEL : ISO : ISO : ISO :
C  :     :     :     :  B  :  B  :  B  :
C  : ЛAT : PYC : ЦИФ :CONS.:TEXT :ISO P:
C  :-----:-----:-----:-----:-----:-----:
C
C
 ,ISO,3H'000''000''000'.000
 ,CONT,3H'000''000''000'
 ,ISO,3H'000''000''000'.001
 ,CONT,3H'000''000''000'
 ,ISO,3H'000''000''000'.002
 ,CONT,3H'000''000''000'
 ,ISO,3H'000''000''000'.003
 ,CONT,3H'000''001''003'
 ,ISO,3H'000''000''000'.004
 ,CONT,3H'000''000''000'
 ,ISO,3H'000''000''000'.005
 ,CONT,3H'000''000''000'
 ,ISO,3H'000''000''000'.006
 ,CONT,3H'000''000''000'
 ,ISO,3H'100''200''300'.007
 ,CONT,3H'023''302''007'.TLIM
 ,ISO,3H'000''000''000'.010
 ,CONT,3H'000''000''010'
 ,ISO,3H'000''000''000'.011
 ,CONT,3H'000''000''000'
 ,ISO,3H'075''075''075'.012.NL
 ,CONT,3H'020''001''012'
 ,ISO,3H'000''000''000'.013
  ,CONT,3H'000''000''013'
 ,ISO,3H'000''000''000'.014
 ,CONT,3H'000''000''014'
 ,ISO,3H'067''067''067'.015.RET
 ,CONT,3H'020''000''015'
 ,ISO,3H'000''000''000'.016
 ,CONT,3H'000''000''000'
 ,ISO,3H'000''000''000'.017
 ,CONT,3H'000''000''017'
 ,ISO,3H'000''000''000'.020
 ,CONT,3H'236''000''000'
 ,ISO,3H'140''140''140'.021.ON
 ,CONT,3H'236''302''000'
 ,ISO,3H'140''244''377'.022.KP
 ,CONT,3H'222''000''000'
 ,ISO,3H'140''244''377'.023.ЧP
 ,CONT,3H'023''302''000'
 ,ISO,3H'140''244''377'.024.0TK
 ,CONT,3H'037''000''000'
 ,ISO,3H'000''000''000'.025
 ,CONT,3H'000''000''000'
 ,ISO,3H'100''200''300'.026.EXP
 ,CONT,3H'023''302''000'
 ,ISO,3H'000''000''000'.027
 ,CONT,3H'000''000''027'
 ,ISO,3H'244''054''244'.030.NEQ
 ,CONT,3H'166''000''030'
 ,ISO,3H'000''000''000'.031
 ,CONT,3H'000''000''031'
 ,ISO,3H'244''055''244'.032.DIV
 ,CONT,3H'023''000''032'
 ,ISO,3H'000''000''000'.033
 ,CONT,3H'000''000''033'
 ,ISO,3H'000''000''000'.034
 ,CONT,3H'000''000''034'
 ,ISO,3H'000''000''000'.035
 ,CONT,3H'000''000''035'
 ,ISO,3H'000''000''000'.036
 ,CONT,3H'000''000''036'
 ,ISO,3H'000''000''000'.037
 ,CONT,3H'000''000''037'
 ,ISO,3H'073''073''073'.040.EMP
 ,CONT,3H'227''001''040'
 ,ISO,3H'244''054''244'.041.BOC
 ,CONT,3H'172''000''041'
 ,ISO,3H'000''000''000'.042
 ,CONT,3H'000''000''042'
 ,ISO,3H'244''054''244'.XEШ+NEQ
 ,CONT,3H'166''000''043'
 ,ISO,3H'377''377''051'.044.ДOЛ
 ,CONT,3H'375''000''044'
 ,ISO,3H'000''000''000'.045
 ,CONT,3H'141''000''045'
 ,ISO,3H'000''000''000'.046
 ,CONT,3H'373''000''046'
 ,ISO,3H'244''053''244'.047.AПП
 ,CONT,3H'171''000''047'
 ,ISO,3H'244''041''244'.050.(
 ,CONT,3H'105''000''050'
 ,ISO,3H'244''066''244'.051.)
 ,CONT,3H'106''000''051'
 ,ISO,3H'377''377''060'.052.*
 ,CONT,3H'031''112''052'
 ,ISO,3H'244''056''244'.053.+
 ,CONT,3H'212''136''053'
 ,ISO,3H'244''071''244'.054.,
 ,CONT,3H'301''000''054'
 ,ISO,3H'244''047''244'.055.-
 ,CONT,3H'013''135''055'
 ,ISO,3H'244''070''244'.056..
 ,CONT,3H'302''110''056'
 ,ISO,3H'244''050''244'.057./
 ,CONT,3H'214''117''057'
 ,ISO,3H'244''062''244'.060.0
 ,CONT,3H'200''220''060'
 ,ISO,3H'244''042''244'.061.1
 ,CONT,3H'001''221''061'
 ,ISO,3H'244''046''244'.062.2
 ,CONT,3H'002''222''062'
 ,ISO,3H'244''057''244'.063.3
 ,CONT,3H'203''223''063'
 ,ISO,3H'244''065''244'.064.4
 ,CONT,3H'004''224''064'
 ,ISO,3H'244''076''244'.065.5
 ,CONT,3H'205''225''065'
 ,ISO,3H'244''052''244'.066.6
 ,CONT,3H'206''226''066'
 ,ISO,3H'244''043''244'.067.7
 ,CONT,3H'007''227''067'
 ,ISO,3H'244''063''244'.070.8
 ,CONT,3H'010''230''070'
 ,ISO,3H'244''074''244'.071.9
 ,CONT,3H'211''231''071'
 ,ISO,3H'244''061''244'.072.:
 ,CONT,3H'345''133''072'
 ,ISO,3H'000''000''000'.073
 ,CONT,3H'310''000''073'
 ,ISO,3H'000''000''000'.074
 ,CONT,3H'165''000''074'
 ,ISO,3H'244''060''244'.075.=
 ,CONT,3H'313''001''075'
 ,ISO,3H'000''000''000'.076
 ,CONT,3H'114''000''076'
 ,ISO,3H'000''000''000'.077
 ,CONT,3H'331''000''077'
 ,ISO,3H'000''000''000'.100
 ,CONT,3H'304''000''100'
 ,ISO,3H'047''140''047'.101.A
 ,CONT,3H'040''141''141'
 ,ISO,3H'054''140''046'.102.B
 ,CONT,3H'242''142''167'
 ,ISO,3H'061''140''053'.103.C
 ,CONT,3H'061''143''163'
 ,ISO,3H'055''140''140'.104.D
 ,CONT,3H'144''144''104'
 ,ISO,3H'057''140''057'.105.E
 ,CONT,3H'045''145''145'
 ,ISO,3H'051''140''140'.106.F
 ,CONT,3H'364''146''106'
 ,ISO,3H'064''140''140'.107.G
 ,CONT,3H'343''147''107'
 ,ISO,3H'072''140''071'.110.H
 ,CONT,3H'255''150''156'
 ,ISO,3H'063''140''140'.111.I
 ,CONT,3H'150''151''111'
 ,ISO,3H'045''140''140'.112.J
 ,CONT,3H'351''152''112'
 ,ISO,3H'041''140''041'.113.K
 ,CONT,3H'052''153''153'
 ,ISO,3H'066''140''140'.114.L
 ,CONT,3H'153''154''114'
 ,ISO,3H'070''140''070'.115.M
 ,CONT,3H'054''155''155'
 ,ISO,3H'071''140''140'.116.N
 ,CONT,3H'155''156''116'
 ,ISO,3H'074''140''074'.117.O
 ,CONT,3H'256''157''157'
 ,ISO,3H'062''140''065'.120.P
 ,CONT,3H'260''160''162'
 ,ISO,3H'042''140''140'.121.Q
 ,CONT,3H'376''161''121'
 ,ISO,3H'065''140''140'.122.R
 ,CONT,3H'160''162''122'
 ,ISO,3H'053''140''140'.123.S
 ,CONT,3H'361''163''123'
 ,ISO,3H'076''140''076'.124.T
 ,CONT,3H'062''164''164'
 ,ISO,3H'043''140''140'.125.U
 ,CONT,3H'163''165''125'
 ,ISO,3H'060''140''140'.126.V
 ,CONT,3H'346''166''126'
 ,ISO,3H'046''140''140'.127.W
 ,CONT,3H'142''167''127'
 ,ISO,3H'050''140''072'.130.X
 ,CONT,3H'265''170''150'
 ,ISO,3H'377''377''043'.131.Y
 ,CONT,3H'263''171''165'
 ,ISO,3H'056''140''140'.132.Z
 ,CONT,3H'147''172''132'
 ,ISO,3H'377''377''066'.133.ЛKC
 ,CONT,3H'111''000''133'
 ,ISO,3H'073''073''073'.134.EMP
 ,CONT,3H'127''002''134'
 ,ISO,3H'377''377''062'.135.ПKC
 ,CONT,3H'100''000''135'
 ,ISO,3H'000''000''000'.136
 ,CONT,3H'230''000''136'
 ,ISO,3H'000''000''000'.137
 ,CONT,3H'130''000''137'
 ,ISO,3H'244''045''244'.140.Ю
 ,CONT,3H'075''177''140'
 ,ISO,3H'000''000''000'.141
 ,CONT,3H'000''000''141'
 ,ISO,3H'377''377''054'.142.Б
 ,CONT,3H'241''102''142'
 ,ISO,3H'377''377''061'.143.Ц
 ,CONT,3H'266''103''143'
 ,ISO,3H'377''377''055'.144.Д
 ,CONT,3H'244''104''144'
 ,ISO,3H'000''000''000'.145
 ,CONT,3H'000''000''145'
 ,ISO,3H'377''377''051'.146.Ф
 ,CONT,3H'064''105''146'
 ,ISO,3H'377''377''064'.147.Г
 ,CONT,3H'043''106''147'
 ,ISO,3H'000''000''000'.150
 ,CONT,3H'000''000''150'
 ,ISO,3H'377''377''063'.151.И
 ,CONT,3H'250''107''151'
 ,ISO,3H'377''377''045'.152.Й
 ,CONT,3H'051''113''152'
 ,ISO,3H'000''000''000'.153
 ,CONT,3H'000''000''153'
 ,ISO,3H'377''377''066'.154.Л
 ,CONT,3H'253''114''154'
 ,ISO,3H'000''000''000'.155
 ,CONT,3H'000''000''155'
 ,ISO,3H'000''000''000'.156.
 ,CONT,3H'000''000''156'
 ,ISO,3H'000''000''000'.157
 ,CONT,3H'000''000''157'
 ,ISO,3H'377''377''062'.160.П
 ,CONT,3H'057''134''160'
 ,ISO,3H'377''377''042'.161.Я
 ,CONT,3H'076''115''161'
 ,ISO,3H'000''000''000'.162
 ,CONT,3H'000''000''162'
 ,ISO,3H'000''000''000'.163
 ,CONT,3H'000''000''163'
 ,ISO,3H'000''000''000'.164
 ,CONT,3H'000''000''164'
 ,ISO,3H'000''000''000'.165
 ,CONT,3H'000''000''165'
 ,ISO,3H'377''377''060'.166.Ж
 ,CONT,3H'046''116''166'
 ,ISO,3H'000''000''000'.167
 ,CONT,3H'000''000''167'
 ,ISO,3H'377''377''050'.170.Ь
 ,CONT,3H'073''132''170'
 ,ISO,3H'377''377''052'.171.Ы
 ,CONT,3H'272''137''171'
 ,ISO,3H'377''377''056'.172.З
 ,CONT,3H'247''140''172'
 ,ISO,3H'244''064''244'.173.Ш
 ,CONT,3H'070''173''173'
 ,ISO,3H'244''051''244'.174.Э
 ,CONT,3H'274''174''174'
 ,ISO,3H'244''072''244'.175.Щ
 ,CONT,3H'271''175''175'
 ,ISO,3H'244''065''244'.176.Ч
 ,CONT,3H'067''176''176'
 ,ISO,3H'000''000''000'.177
 ,CONT,3H'000''000''000'
 ,END,
 T*CC:,NAME,
C
C*****   TAБЛИЦA ПEPEKOДИPOBKИ CЛYЖEБHЫX
C*****         CИMBOЛOB /000-037/
C
C.....   PP.48/33 = C B O Б O Д H Ы
C
C.....   PP.32/25 = 15-ИЭ -> ISO
C.....   PP.24/17 = ISO -> 15-ИЭ
C.....   PP.16/09 = VDT-52130 -> ISO
C.....   PP.08/01 = ISO -> VDT-52130
C
 00,ISO,6H  '000''00''00''0'
 01,ISO,6H  '000''00''31''0'
 02,ISO,6H  '000''00''32''0'
 03,ISO,6H  '000''25''30''0'
 04,ISO,6H  '000''00''10''0'
 05,ISO,6H  '000''00''37''0'
 06,ISO,6H  '023''00''00''0'
 07,ISO,6H  '007''00''00''07'.  BELL
C--------
 10,ISO,6H  '014''32''14'D
 11,ISO,6H  '011''30''11'I.  TAB
 12,ISO,6H  '012''12''00''12'.  LF
 13,ISO,6H  '000''26''00'S.  INS-LIN
 14,ISO,6H  '000''10''00'H.  HOME
 15,ISO,6H  '015''15''00''15'.  C R
 16,ISO,6H  '201''00''00''0'
 17,ISO,6H  '200''37''00''0'
C--------
 20,ISO,6H  '000''00''34''0'
 21,ISO,6H  '021''00''35''0'
 22,ISO,6H  '036''00''00''0'
 23,ISO,6H  '034''00''13''0'
 24,ISO,6H  '035''00''36''0'
 25,ISO,6H  '003''00''00''0'
 26,ISO,6H  '013''00''00''0'
 27,ISO,6H  '000''15''00''15'. PRINT
C--------
 30,ISO,6H  '011''31''00'C.  CUR-RIGHT
 31,ISO,6H  '030''34''00'A.  CUR-UP
 32,ISO,6H  '010''35''00'B.  CUR-DOWN
 33,ISO,6H  '033''33''00''0'.ESCAPE
 34,ISO,6H  '031''23''00'P.  INS-CH
 35,ISO,6H  '032''24''00'Q.  DEL-CH
 36,ISO,6H  '036''22''00'T.  DEL-LIN
 37,ISO,6H  '037''14''00'E.  ERASE
C--------
 ,END,
 DEBMULT:,NAME,
 'PEДAKЦИЯ OT 04.06.73'
 MONITOR*:,SUBP,.
 EXCH NRS:,SUBP,.
C......   EXCH NRS - ИHФ. CЛOBO ДЛЯ
C         BЫЗOBA HEPEЗИДEHTA MYЛЬTИTAЙПA.
 D0:,PC,0.
 FETCH:,SUBP,
 FORMPACK:,SUBP,.
 OPERANDS:,SUBP,.
   BUFSAP:,LC,20
 *TGOSISO:,SUBP,
 *DRUMUS:,SUBP,.B XBOCTE
  PTRP:,PC,46000B
 NPTRP:,P/P,(PTRP)16
 ,DRUM,RTRP.ЧTEH. TPП
 ,XTA,17B.KOHEЦ TPП
 ,UTC,PTRP+3774B.
 ,ATX,.ДЛЯ DISPLOAD
 14,VTM,-2.
C   ПEPEПИCЬ ЗAГOЛOBKA
 LH:14,UTC,HEAD+2.
 ,XTA,.
 14,UTC,PTRP+3777B.
 ,ATX,.
 14,VLM,LH.
 ,DRUM,WTRP.
 ,DRUM,WTRP+1.
 ,XTA,EXCH NRS.
 ,AAX,Z40.
 ,ATX,IW70.
 ,DRUM,IW70
 ,UJ,MONITOR*+1.
 IW70:,BSS,
 RTRP:,010,NPTRP.
 ,020,.TPП
 WTRP:,,NPTRP.
 ,,30B
 :,,NPTRP+100B.
 ,,31B.
 HEAD:,ISO,18H* MYЛЬTИTAЙП *
 ,LOG,
 Z40:,LOG,7767 7777 7777 7777
 CODE:,LOG,3053 4576 1634 0112.
C  BUFSAP(20) ФOPMИPYET WRITDISP
 ,END,
 FETCH:,NAME,
 '30.10'72 , ГYPEBИЧ'
 '30.05.73'
C---------   БЛOK OБMEHOB 'MYЛЬTИTAЙПA'
 C:,EQU,2.HOMEP KAHAЛA
 *1:,BLOCK,BA,(3),N,T,L,JP,R
 ,CONT,RS,NS,JS,RR,(1),WS
 NCH:,EQU,10.
 SC BL NL:,EQU,73B
 SC VID:,EQU,75B
 ЭT OБPAЗ:,EQU,64+NCH.(NCH)
 BCH:,EQU,656B.БИT KAHAЛA
 SC WAIT:,EQU,656B+9
 JOB:,EQU,670B.HAЧAЛO ДЛЯ MT
 RETADR  :,EQU,656B+20
 NUMBUS  :,EQU,NCH+RETADR.
 TEKAДP  :,EQU,NCH+NUMBUS.
 MBINF   :,EQU,NCH+TEKAДP.
 A STR   :,EQU,NCH+MBINF.
  RONLY  :,EQU,ASTR+NCH
  FILLEN :,EQU,RONLY+1
 NC:,EQU,NCH
 COPYRA:,EQU,FILLEN+NC
 LPAG:,EQU,COPYRA+NC
 LASTORD:,EQU,LPAG+NC
 SC100:,EQU,LASTORD+NC
 ZBCH:,EQU,SC100
 MAXL:,EQU,SC100+1.ДЛЯ VR
 *1TYPE:,EQU,MAXL+NC.ДЛЯ FETCH И
 XRS:,EQU,*1TYPE+NC.FORM PACK
 TYP:,EQU,XRS+NC
 TYPE:,EQU,TYP
 SPB:,EQU,TYP+NC
 MBINFOWN:,EQU,SPB+NC
 PБYФ:24,EQU,1750B.ДЛЯ COSY
 X    :,EQU,3.
 SPF:,EQU,200B.
 SF:,EQU,1
 NL:,EQU,12B.
 SPACE:,EQU,40B.
 NCH*2:,EQU,NCH+NCH.
 BUFSAP:,LC,NCH*2
 LPSM:,EQU,10.CMEЩEHИE AЦПY
 *TGOSISO:,LC,24
 SGNCON:,EQU,=6H*CONTA
 FORMPACK:,SUBP,.
 FRC:,EQU,=6H'224''300'''''''''
 BIT80S:,EQU,=400 000
 BITSTF:,EQU,=1 000 000
 BITEND:,EQU,=200 000
 B24/1:,EQU,=7777 7777
 BIT48:,EQU,=:4.
 BIT47:,EQU,=:2
 BIT 40:,EQU,=:001
 BIT 39:,EQU,=:0004
 B COSY:,EQU,=:0000 004.B30
 B GOST:,EQU,=:0000 002.B29
 B NT:,EQU,=:0000 001.B28
 OPERANDS:,SUBP,.
 *DRUMUS:LC,BLOCK,DRUMUS.
 MFREE:,EQU,=77777 00000
 B35/31:,EQU,=:0000 37.
 CMIN4:,EQU,=7777 7777 7777 7773
 CMIN1:,EQU,=7777 7777 7777 7776
LCON CL:,EQU,=6H'177''177''177''177''177''177'
 CONOR:,EQU,=200.
 XNL:,EQU,=12
 BSP:,EQU,SPB
 :,UJ,FETH
 ,Z00,DRUMUS.
 :,UJ,STORE
 :,UJ,FORMPACK.PACШИФP.ФOPMATA
 ,Z00,SCERRTRA
 :,BSS,1.LABEL-NEXT
 :,BSS,1.LABEL-FORMJOB
 :,UJ,SCAN.HA ПPOП. CTP.
 ,,
 :,UJ,FORMINFA.ФOPM. ПO CYMM.
 :,UJ,OPERANDS.
 MLTBAS:,BSS,1
 ,UJ,CAT I/O.PAБOTA C KAT "OB"
  ,Z00,BUFSAP.ДЛЯ MAKEMT
 :,UJ,CHE PASS.ПPOBEPKA ПPИ BXOДE B CEAHC
 CLEAR:,BSS,1.ГAШ.BЫ/BB
 ,BSS,3.PEЗEPB
 CLOCH:,BSS,1
 CHE PASS:,BSS,
C  П/П ПPOBEPKИ PASS ПOЛЬЗOBATEЛЯ
C  ПPИ BXOДE B CEAHC
C  BЫЗOB ПO ИP13
C  PASS(ISO) ЗAДATЬ B ЭTOБPAЗ(C)
C  PEЗYЛЬTAT HA CM: - N PASS
C            CM=0 - HET PASS
C
C  YПPЯЧEM AДPEC BOЗBPATA:
 ,ITA,13
 C,ATX,X RS
C  ПEPEBOД ISO = TEXT
 13,VTM,0.T=0
 4,VJM,OPERANDS
 C,ATX,ЭT OБPAЗ.ПPИЖAT K ЛEB.KPAЮ, ДOПOЛHEH 0
 ,AAX,=:77
 ,UZA,END F.HE PASS
 ,*65,564B
 ,ATI,13.A *USESTA
 13,*65,2.A T/PASS
 ,AOX,=14 00 0777 000 000.ЧT,ФИЗ MБ
 C,ATX,MBINFOWN.ЗAГOT.ИC
 14,VJM,CLAF**. ЖДEM
 FR CHAN:14,VTM,NCH.=10
 15,VJM,READP.HA OБMEH
 C,XTA,BUFSAP+NCH.ЛИCT KAHAЛA
 14,VJM,CLAF.ЖДEM KOHЦA
C  BOЗMOЖHA ДИAГHOCTИKA ИЗ-ЗA ПЛOXOГO OБMEHA
 C,XTA,BUFSAP+NCH
 ,ASN,64+20
 ,AAX,=76000.AДPEC
 ,ATI,14.HAЧAЛA
 LOOP CH:14,UTM,1.0-E CЛ. CЛYЖ.
 14,XTA,
 ,UZA,END F.KOHEЦ TAБЛ.
 C,AEX,ЭT OБPAЗ
 ,ASN,64+12
 ,U1A,LOOP CH
 YES:,ITA,14
 ,AAX,=1777.HOMEP PASS:1..1776
 ,ATX,W1
C  ПPOBEPKA ДOCTYПA K 7/M:
 13,VTM,DRUMUS-1
 L DR:13,XTA,1
 13,UTM,1
  ,U1A,L DR
  13,MTJ,15.'0'
 CH PA:13,UTM,-DRUMUS
 13,VZM,OUT.ПYCT
C  ЧACTИ *DRUMUS'A ПOЗИЦИOHHO COOTBETCTBYЮT
 15,UTC,.KOHEЦ БYФEPA
 13,XTA,.PASS-TEXT
  13,UTM,DRUMUS-1
 C,AEX,ЭT OБPAЗ
 ,ASN,64+12
 ,U1A,CH PA
C  ДOOФOPMИM ЭЛ-HT *DRUMUS'A:
 13,XTA,
 ,AAX,=:7777 7777 7777 6
 ,AOX,W1
 13,ATX,
 OUT:,XTA,W1
 ,UJ,ENDF.BOЗBPAT B MT
 CAT I/O:,BSS,.9ИP=M000I
C   M=4 - C ЧИCTKOЙ ШKAЛ "OB" ДЛЯ NN ИЗ TYPE(C)
C   M=2 - ПPИKAЗ ПEЧ
C   M=0 - ЧTEHИE И ДEMOHOПOЛИЗAЦИЯ
C   I=1 - KATAЛOГ BBOДA
C   I=0 - KATAЛOГ BЫBOДA
C   TYPE(C) = 0  : БEЗ ПPOBEPKИ PASS'A
C                  TOЛЬKO ЧTEHИE KATAЛOГA
 ,ITA,13
 C,ATX,XRS
 14,VJM,CLAF**.ЖДEM KO
 FR CHA:C,XTA,BUFSAP+NCH
 ,ASN,64+20
 ,AAX,=76000
 ,ATI,3.=PP
 ,ATI,RR.=13
 ,ITA,R.=9
 ,ATX,W1
 ,ASN,64+13
 ,ATI,NS.11 ИP=1-ЧИCTKA
 ,XTA,W1
 ,AAX,=1
 ,ATI,R.YБPAЛ 15P
 R,XTA,RCAT OI
 15,VJM,EX CAT
 3,XTA,1023
 R,AEX,MCAT
 RS,VTM,HETKAT
  ,UZA,CLEARSC
 MNPL OFF:R,XTA,SEM OI
 ,*50,210B
 ,XTA,.ДЛЯ LIST B
 RS,UJ,
 HETKAT:RR,VTM,T CAT
 ,UJ,TO DIAG
 HETBЫД:RR,VTM,THBЫД
 ,UJ,TO DIAG
 CLEAR SC:,BSS,.OCBOБ.ЭЛ-TOB
 C,XTA,TYPE.N BЫBOДA 6P
 R,V1M,EL/BB.1=INPUT
 ,ASN,64-2
 C,ARX,TYPE.*5
 ,ATI,RS.10ИP
 ,UJ,EL/
 *1:,BSS,
 ,AOX,BIT39
 RR,ATX,
 ,UJ,*2
 EL/BB:,ASN,64-4
 ,ATI,RS
 RS,UTM,-16
 EL/:RS,J+M,RR.=AДPEC ЭЛ-TA
  ,AEX,
  RS,VTM,ENDF.TOЛЬKO
  ,UZA,MNPLOFF.ЧTEHИE
 RR,XTA,.XAPAKT-KA
 RS,VTM,HET BЫД.HET BЫДAЧИ
 ,UZA,MNPL OFF
 ,AAX,=:3
 ,U1A,MNPL OFF.ИЛИ ЗAHЯT
 RR,XTA,1
 C,AEX,NUMBUS
 ,AAX,=1777
 ,U1A,MNPL OFF.ЧYЖOЙ
 RS,VTM,ENDF.БEЗ
 NS,VZM,MNPLOFF.ЧИCTKИ
 NS,UJ,*
 :RR,XTA,
 ,UJ,*1
 :,BSS,
 ,XTA,=:777
 C,AAX,MBINF
 C,ATX,MBINF.БYФEP
 RR,XTA,
 ,APX,=77 77 000 777.NBB,NЛAБ,1ЗOHA
 ,ASN,64+27
 C,AOX,MBINF
 C,ATX,MBINF.N 1 ЗOHЫ
 RR,XTA,
 ,ARX,
C  ПPИ ЭTOM BЫXOДE  JS=0 ДЛЯ ПPИK. ИCK NN
 ,U1A,MNPL OFF.YЖE CBOБ.
 C,WTC,ASTR
 JS,VTM,
 15,VTM,-15
 ,XTA,
 ZER SCZ:15,UTC,15
 JS,ATX,1.HYЛИM ШKAЛY
 15,VLM,ZER SCZ
 C,XTA,MBINF
 JS,ATX,17.YПPЯT YAЗ.
C  ЗAMEHA HA 2-Й ЛИCT:
 C,XTA,BUFSAP
 ,AEX,
 C,XTA,BUFSAP+NCH.ЗДECЬ KAT
 C,ATX,BUFSAP
 ,YTA,
 C,ATX,BUFSAP+NCH.CЮДA ЧT.ЗOHЫ
 ,ASN,64+20
 ,AAX,=76000
 ,ATI,JP
 FORM SCZ:,BSS,.KOПИM ШKAЛY
 C,XTA,MBINF
 ,AAX,=777
 ,UZA,ALL SC.KOHEЦ
 ,ATX,W1
 ,ASN,64+5
 ,ATI,14
 ,ASN,64-5
 ,AEX,W1
 ,ATI,15
 ,XTA,BIT48
 15,ASN,64
 JS,UTC,1
 14,AOX,.B ШKAЛY
 JS,UTC,1
 14,ATX,
 14,VJM,CLAF**.ЖДEM KO
 FR P:14,VTM,NCH
 R,XTA,RZ OI
 15,VJM,EX INI.BЫДATЬ OБMEH
 C,XTA,BUFSAP+NCH
 14,VJM,CLAF.ЖДEM KO
 JP,XTA,
 ,ASN,64+9
 C,AEX,MBINF
 ,AAX,=77 77 000.NBB,NЛAБ
 RS,VTM,KOHBUF
 ,U1A,MNPL OFF.ЧYЖAЯ ЗOHA
 JP,XTA,
 C,AEX,MBINF
 ,AAX,=777
 C,AEX,MBINF.CЛEД ЗOHA
 C,ATX,MBINF
 ,UJ,FORM SCZ
 ALL SC:C,XTA,BUF SAP.ПEPEПИCЬ
 ,ASN,64+20.B ШKAЛЫ
 ,AAX,=76000.KATAЛOГA "OB"
 ,ATI,JP
 JS,XTA,17.BOCCTAH.
 C,ATX,MBINF.YKAЗ.1 ЗOHЫ
 15,VTM,-15
 WR SCZ:JP,UTC,1740B.ШK ЗOH
 15,XTA,15
 JS,UTC,1
 15,AOX,15
 JP,UTC,1740B
 15,ATX,15
 ,XTA,
 JS,UTC,1
 15,ATX,15
 15,VLM,WR SCZ
 JS,ATX,17.:=0
  R,VZM,CONT2.OUTPUT
  JP,XTA,1772B.ЧИCЛO ЗAДAЧ
  ,ARX,=777
  ,AAX,=777.-1
  JP,ATX,1772B
  CONT2:,BSS,
 C,XTA,TYPE
  ,ASN,64-4.16*N
 SC/C:,BSS,
  ,ATI,RS.OTH.AДP.ПACП.
  ,ASN,64-38
  R,VZM,CONT1.OUTPUT
  ,ARX,=:77.-1
  CONT1:,BSS,
 ,AUX,=17 00003
 ,ATI,15
 ,ASN,64+15
 ,ATI,14
 ,XTA,BIT48
 15,ASN,64
 JP,UTC,1720B
 14,AOX,
 JP,UTC,1720B
 14,ATX,.OCB.ЭЛ-HT
 R,VZM,EL/C.0=OUT
C     ПACПOPT-ПPOДOЛЖEHИE (INPUT)
  JP,UTC,
  RS,XTA,-16.XAP-KA 1
  ,ASN,64+26
  ,AAX,=1760.16*N
 ,U1A,SC/C
  EL/C:,BSS,.KAKOЙ KATAЛOГ
  ,XTA,BIT48
  R,VZM,EL/CO
  :JP,XTA,1772B.NJOB(INP)
  ,UZA,*+2
 ,ARX,=777.-1
 ,AAX,=777
  :JP,ATX,1772B
  ,XTA,=:1
  EL/CO:,BSS,
  RR,AEX,
 RR,ATX,.48P:=0
 C,XTA,BUFSAP
 ,AEX,
 C,XTA,BUFSAP+NCH.ЗДECЬ ЗOHA
 C,ATX,BUFSAP
 ,YTA,
 C,ATX,BUFSAP+NCH
 *2:,BSS,
 R,XTA,WCAT OI
 15,VJM,EX CAT.ЗAПИCЬ KAT
C PEГИCTP JS - ФЛAГ 0/1 ДЛЯ ПPИK. ИCK NN
C  ПPИ ЭTOM BЫXOДE  JS=1
 R,VZM,ENDF.0=OUTPUT
 C,XTA,MBINF
 ,AAX,=:777
 C,ATX,MBINF
 ,UJ,END F
 FETH:,BSS,
C         ISO B COSY
 R,VTM,N64.
 ,ITA,RR.
  C,AEX,XRS
  ,AAX,=77777
  C,AEX,XRS
 C,ATX,XRS
 L,VTM,1.
 C,XTA,TEKAДP
 ,ATI,JP
 ,AAX,BITSTF.
 ,U1A,TFC.
 L,VTM,.ЭTO HOBAЯ CTPOKA
 C,XTA,*1TYPE.
 C,ATX,TYPE
 TFC:,BSS,
C......   ПPOБA  БИTA ЧИCЛA CИMBOЛOB
 C,XTA,TEKAДP
 NS,VTM,83.ДЛЯ ПEPФ.
 T,VTM,
 RR,VTM,.
 N,VTM,128.
 ,AAX,BIT80S.
 ,U1A,N64.
 R,VJM,FTYPE
 RR,VTM,1
 NS,VTM,80
 N64:,BSS,.
 ,MTJ,JS.
 JP,VZM,FSTCALL..BOЗBPAT HA /15M1
   14,VTM,READ.
 C,XTA,JOB
 ,AAX,B COSY
 ,UZA,YBA
 C,AEX,JOB
 C,ATX,JOB
C  ПPOБA COSY-GOST
 ,AAX,B GOST
 ,ASN,64+14.B 15 PAЗPЯД
 ,ATI,BA.=1-GOST
 ,XTA,BIT48
 C,ASN,64
 ,ATX,BCH
 ,AEX,FULWOR
 ,ATX,ZBCH
C ПEPEПИCЬ C ASTR HA PБYФ:
 14,VTM,-22
 L COSY:C,WTC,ASTR
 14,XTA,22
 14,UTC,22
 JP,ATX,
 14,VLM,L COSY
 ,XTA,FULWOR
 JP,ATX,23
  NS,VTM,128
 READM1:,BSS,.
C         ЧTEHИE HOBOГO CЛOBA
 BA,VZM,READ
C       KOPPEKЦИЯ ГOCT-CЛOBA.
 JP,XTA,
 ,AEX,FULWOR
   ,UZA,ENDF
 JP,XTA,
 ,ARX,=6H'1''1''1''1''1''1'
 JP,ATX,
 READ:,BSS,.1
C......   ЧTEHИE CИMBOЛA
 JP,XTA,
 ,U1A,/3
 JP,UTM,1
 ,ITA,JP
 ,AAX,=1777
 ,U1A,READM1
 NEWPAGE:,BSS,
C......   ПEPEXOД HA CЛEДYЮЩИЙ ЛИCT
 C,XTA,RETADR
 ,AAX,MFREE.
 ,UZA,/15.
C         ЛИCT PEЗEPBHЫЙ ЗAHЯT
 C,XTA,BUFSAP+NCH
 14,VJM,CLAF
 /15M1:,BSS,
 14,VTM,/15
 ,UJ,YBA
 /15:,BSS,
C......   ЗAMEHA TEKYЩ.  ЛИCTA HA PEЗEPB.
 14,VJM,IFTRAERR
 C,XTA,BUFSAP+NCH
 ,ASN,64+20
 ,AAX,=76000
 ,ATI,JP.AДPEC ЛИCTA
C  PACПPEДEЛEHИE PAЗPЯДOB B MBINF(C):
C -- ДЛЯ ЛИЧHOГO БYФEPA:
C  48-40 TИП (48-46) И MAT.N MЛ
C  39-31 HAЧ.ЗOHA
C  30-10 HE ИCП.(=0)
C  09-01 KOHEЧ.ЗOHA
C -- ДЛЯ CИCTEMHOГO BЫBOДA:
C  48-40 HE TPOГAET,COXPAHЯET
C  39-28 HE ИCП.(=0)
C  27-10 NBЫBOДA,NBBOДA,NЛAБ
C  09-01 N ЗOHЫ ПO CПИCKY ЛИБO 0
C -- ДЛЯ ПPИKAЗA "HOB"
C  БИTЫ 10-39 COДEPЖAT "1"
 C,XTA,MBINF
 ,AAX,=77 77 000.NBB,NЛAБ
 14,VTM,0
 ,U1A,SYSOUT
 15,VTM,ЗAMEHA.БYФEP MT
 ,UJ,READ P
 SYS OUT:,BSS,.OБЛACTЬ BЫBOДA
  C,XTA,MB INF
  ,AAX,BIT39
  ,U1A,READ."HOB"
 JP,XTA,
 ,AAX,=777
 ,UZA,ALLZ.БOЛЬШE HET
 C,AEX,MBINF
 ,AAX,=777
 C,AEX,MBINF
 C,ATX,MBINF.CЛEД.ЗOHA
 ,XTA,RZ OI
 15,VJM,EX INI.BЫДAЛ OБMEH
 ЗAMEHA:,BSS,
C   OБMEH BCEГДA ЧEPEЗ ЛИCT,YKAЗAH.
C   B    BUFSAP+NCH(C)
C   ДЛЯ BCEX TИПOB БYФEPOB
 C,XTA,BUFSAP+NCH
 ,AEX,
 C,XTA,BUFSAP
 C,ATX,BUFSAP+NCH
 ,YTA,
 C,ATX,BUFSAP
 ALLZ:,BSS,.БEЗ ЗAMEHЫ
 NS,VZM,/3SC.HA ПPOПYCK
 BA,VZM,READ.
C         ПPOПYCK CЛYЖ. CЛOB ЗAИKИHA
 JP,UTM,LPSM
 ,UJ,READM1
 /3:,BSS,
 JS,V1M,/3*1.
C......   OБPAБOTKA 1-ГO CЛOBA CTPOKИ
 ,ATX,W1.
 C,WTC,ASTR.
 JS,VTM,
 ,ITA,
 JS,ATX,
 L,VZM,NOTCON.
 L,VTM,.
 ,XTA,BCH
 ,AAX,SC BL NL
 ,UZA,/5
 ,AOX,SC VID
 ,ATX,SC VID
 ,XTA,BCH
 ,AEX,SC BL NL
 ,ATX,SC BL NL
 /5:,BSS,
 ,XTA,W1
 ,AAX,=6H'200''377''0''0''0''0'
 ,AEX,=6H'200''12''0''0''0''0'
 ,U1A,/4
 ,XTA,
 C,ATX,BSP.ДЛЯ BИДEOTOHA
 C,XTA,TEKAДP
 ,AOX,BITSTF
 ,AEX,BITSTF
 C,ATX,TEKAДP
 C,XTA,*1TYPE
 C,ATX,TYPE
 R,VTM,BLCARD
 ,UJ,FTYPE
 /4:,BSS,
 ,XTA,BIT48.
 JS,ATX,-1.
 C,XTA,BSP.
 ,ARX,
 ,U1A,TESTBLT.HA ПPOB. ПYCT.
 ,ASN,64+40
 ,ATI,RS.
 C,ATX,BSP.
 RS,MTJ,WS.
 ,UJ,FBL.
 NOTCON:,BSS,.HET OCTATKA
C......   ЭTO HE ПPOДOЛЖEHИE CTPOKИ
C         ПPOБA CИMBOЛA KOHЦA
 ,XTA,W1
 BA,AEX,SGNEND
 ,UZA,ENDF
C......   ПPOБA HA CTPOKY AЦПY
 BA,V1M,AЦПY
 TESTBLT:,BSS,.
C......   ПPOБA ПYCTOЙ CTPOKИ
 ,XTA,W1.
 ,AAX,=6H'200''377'''''''''
 ,AEX,=6H'200''012'''''''''
 ,UZA,BLCARD.
C......   ECЛИ ПEPBOE CЛOBO ECTЬ *READ
C         TO RR ДOЛЖHO БЫTЬ 0 ИЛИ 2
 ,XTA,W1.
 ,AEX,=6H*READ
 ,ASN,64+8
 ,U1A,/3*0.
 C,XTA,TEKAДP.
 ,AAX,BITSTF.
 ,U1A,/3*0.
 RR,VZM,/3*0.
 RR,VTM,2.
 ,XTA,FRC.
 C,ATX,TYPE.
 R,VJM,FTYPE.
 /3*0:,BSS,.
C  ПPOБA ПPИЗHAKA ПEPEXOДA HA HOBЫЙ ЛИCT
 ,XTA,W1.
 ,AEX,SGNCON.
 ,UZA,NEWPAGE.
 ,XTA,W1.
 /3*1:,BSS,.
C......   BЫБOPKA CИMBOЛA
 ,ASN,64-8
 JP,ATX,
 ,YTA,
 ,ATX,SYM
 BA,VZM,RETGI.KOД ISO
C         ПEPEKOДИPOBKA ГOCTA B ISO
 ,ATX,W4
 ,AEX,=177.GOST NL +1
 ,UZA,RETGI
 ,AAX,=200
 ,U1A,GOSBL.ПPOБEЛЫ
C         OБЫЧHAЯ БYKBA-ЦИФPA
 ,XTA,W4
 ,ARX,CMIN1
 ,UZA,NULLG.HOЛЬ
 ,ATX,W4
 ,ASN,64+2
 ,ATI,14
 ,ASN,64-2
 ,AEX,W4
 ,AEX,=3
 ,ASN,64-3
 ,ATI,15
  14,XTA,*TGOSISO
 15,ASN,64
 ,AAX,=377
 ,UJ,RETGI
 NULLG:,XTA,=60
 ,UJ,RETGI
 GOSBL:,XTA,W4
 RETGI:,BSS,
C         HA CYMMATOPE CИMBOЛ ISO
 R,VZM,NEXTS
 ,ATI,RS
 RS,MTJ,WS.6
 ,AAX,=200
 ,U1A,FBL.TO 7
  ,ITA,RS
  14,VJM,CH LF
  ,UZA,END READ
  R,VTM,READ
 SYMBOL:,BSS,.13
C......   ЗAПИCЬ CИMBOЛA ПO ФOPMATY
 T,MTJ,14.
 14,UTM,-X.
 14,VZM,STEP.
 WRITE:,BSS,.
C  БEЗYCЛOBHAЯ ЗAПИCЬ CИMBOЛA ИЗ WS
 L,UTM,1
 ,ITA,WS
 JS,AOX,
 ,ATX,W1
 ,ASN,64-8
 JS,ATX,
 ,YTA,
 ,ATX,W2
 ,UZA,/10
 ,XTA,W1
 ,AAX,CON CL.
 JS,ATX,.WRITE WORD
 JS,UTM,1
 ,ITA,
 JS,ATX,.
 /10:NS,UTM,-1
 NS,VZM,ENDSTRSP
 STEP:,BSS,.11
C......   ШAГ ПO ФOPMATY
 N,UTM,-1
 R,UTC,
 N,V1M,
 FTYPE:,BSS,
C......   BЫБOPKA ФOPMATA
 T,VTM,
 N,VTM,128
 C,XTA,TYP
 R,UZA,
 ,ASN,64-2
 C,ATX,TYP
 ,YTA,
 ,ATI,T
 C,XTA,TYP
 ,ASN,64-6
 C,ATX,TYP
 ,YTA,
 R,UZA,
 ,ATI,N
 R,UJ,
 FBL:,BSS,.7
C......   ПEPBЫЙ ПPOБEЛ
 R,VTM,
 ,UJ,READ
 NEXTS:,BSS,
C......   ПEPBЫЙ CИMBOЛ ЗA ПPOБEЛAMИ
 ,ATX,W3
  14,VJM,CH LF
 ,UZA,ENDRAB.
 RR,VZM,TRANBL
 T,V1M,TRANBL.
 RS,MTJ,14.
 L,J+M,14
 14,UTM,-80
 NOT VID:,BSS,
 ,ITA,14
 ,AAX,=200
 14,UTM,-200B.
 ,U1A,KTCH0
 TRANBL:,BSS,.
C......   BЫДAЧA CEPИИ ПPOБEЛOB
 WS,VTM,SPACE
 R,VTM,NFBL.TO 12
 RS,UTM,-201B
 NF:T,UTM,-SF
 T,VZM,FS
 T,UTM,SF
 ,UJ,SYMBOL.13 TO
 FS:T,VTM,SPF
 ,UJ,SYMBOL
 NFBL:,BSS,.12
 T,MTJ,14
 RS,VZM,ENDBL.
 RS,UTM,-1.
 14,UTM,-SPF
 14,VZM,STEP.TO 11
 ,UJ,NF
 ENDBL:,WTC,W3
C......   KOHEЦ BЫДAЧИ ПPOБEЛOB
 WS,VTM,
 WS,VZM,ENDREAD
 R,VTM,READ
 14,UTM,-SPF
 14,V1M,SYMBOL
 T,VTM,SF
 ,UJ,SYMBOL.TO 11
 ENDRAB:,ATX,W3
 ,ATX,SYM
 C,XTA,TEKAДP
C  ЗA ПPOБEЛAMИ БЫЛ ПEPEBOД CTPOKИ
 ,AAX,BIT80S.
 ,UZA,ENDREAD.
 ,UJ,TRANBL
 ENDSTRSP:,BSS,
C  CPЫB ПO ИCЧEPПAHИЮ BЫXOДHOЙ CTPOKИ
 RS,MTJ,14
 RR,V1M,KTCH0
 ENDREAD:,BSS,.5
C......   OБЫ4HЫЙ KOHEЦ CTPOKИ
 ,XTA,
 JP,ATX,
 ,XTA,.
 C,ATX,TEKAДP
 ENDRDG:,BSS,
C......   OБЩИЙ БЛOK KOHЦA
 WS,VTM,200B.
 NS,VTM,21
 DOK:R,VJM,WRITE
 L,UTM,-1.
 ,XTA,W2
 ,UZA,DOK
 ,ITA,JP
 C,AOX,TEKAДP
 C,ATX,TEKAДP
 RR,VZM,TEST*RO.
 RR,UTM,-2.
 RR,V1M,ENDF.
 ,UJ,TEST2.
 TEST*RO:,BSS,.
 C,WTC,ASTR
 ,XTA,.
 ,AEX,=6H*READ
 ,U1A,ENDF.
 TEST2:,BSS,
 C,WTC,ASTR.
 ,XTA,1.
 ,AEX,=3HOLD
 ,AAX,=:7777 7777
 ENDF:,BSS,
 ,WTC,MLTBAS.BOCCTAHOBЛEHИE
 BA,VTM,.БAЗЫ MYЛЬTИTAЙПA
 C,WTC,X RS.
 ,UJ,.
  CH LF:14,UZA,.'000'
  ,AEX,=1
  ,UZA,BIT1.'001'
  ,AEX,=1
  ,AEX,XNL
  14,UZA,.'012'
  ,ASN,64+5
  ,UZA,KILLSC.<40B
  BIT1:,XTA,=1
  14,UJ,.HOPM.CИMBOЛ
 BLCARD:,BSS,.ПYCTAЯ KAPTA
 ,ITA,
 JP,ATX,.
 JS,VTM,
 ,UJ,READ.
 AЦПY:,XTA,W1.
 ,ASN,64-8.
 ,UJ,/3*1
 KTCH0:,BSS,
 ,XTA,BCH
 ,AOX,SC BL NL
 ,ATX,SC BL NL
 KTCH:,BSS,
C  ПOДГOTOBKA BЫДAЧИ OCTATKA CTPOKИ
 ,XTA,BITSTF
 C,ATX,TEKAДP
 R,VZM,SERSPACE.
 R,UTM,-NFBL.
 R,V1M,SAVEFORM.
 SERSPACE:,BSS,.
C......   CPЫB БЫЛ C CEPИИ ПPOБEЛOB
 ,XTA,SYM
 ,ASN,64-40
 ,ATX,SYM
 JP,XTA,
 ,ASN,64+8
 ,AOX,SYM
 JP,ATX,
 14,VZM,SAVEFORM.
C......   CEPИЯ ПPOБEЛOB HE ИCЧEPПAHA
 14,UTM,200B
 ,ITA,14
 ,ASN,64+8
 ,YTA,
 C,ATX,BSP
 SAVEFORM:,BSS,.
C......   CПACEHИE TEKYЩEГO ФOPMATA
 T,VZM,ENDRDG
 N,UTM,-1.
 N,VZM,ENDRDG.
 ,ITA,N
 ,AAX,=100
 ,AEX,=100
 ,UZA,NCORF.
 ,ITA,N.
 NCORF:,BSS,.
 ,ATX,W3
 ,ITA,T
 ,ASN,64-6
 ,AOX,W3
 ,ASN,64-40
 ,ATX,W3
 C,XTA,TYPE
 ,ASN,64+8
 ,AOX,W3
 C,ATX,TYPE
 ,UJ,ENDRDG.
 FSTCALL:,BSS,.16
 14,VTM,FREE
  CLAF**:,BSS,
  C,XTA,RETADR
  ,AAX,MFREE
  14,UZA,
  C,XTA,RETADR
 CLAF:,BSS,
 ,AAX,B35/31
 C,ATX,RETADR
 ,ITA,14
 C,AOX,RETADR
 C,ATX,RETADR
 14,VTM,WOST
 ,ITA,14
 ,ASN,64-15
 C,AOX,RETADR
 C,ATX,RETADR
 14,VTM,-1
 LSM1:C,XTA,BUFSAP
 ,AAX,B35/31
 C,ATX,BUFSAP
 14,ITA,R
 C,AOX,BUFSAP
 C,ATX,BUFSAP
 14,ITA,RR
 ,ASN,64-15
 C,AOX,BUFSAP
 C,ATX,BUFSAP
 14,ITA,NS
 ,ASN,64+8
 ,YTA,
 C,AOX,BUFSAP
 C,ATX,BUFSAP
 C,UTM,NCH
 14,VLM,LSM1.
 C,UTM,-NCH*2
 14,VTM,-2
 R,VTM,8
 C,XTA,TEKAДP
 ,AAX,B24/1
 C,ATX,TEKAДP
 LSM2:14,ITA,L
 R,ASN,64
 ,YTA,
 C,AOX,TEKAДP
 C,ATX,TEKAДP
 R,UTM,8
 14,VLM,LSM2
 ,ITA,4
 C,ATX,SPB.
 ,ITA,3
 ,ASN,64-15
 C,AOX,SPB.
 C,ATX,SPB.
  ,WTC,MLTBAS
  BA,VTM,
 ,UJ,CLOCH
 FREE:,BSS,.17
 C,XTA,MBINF
 ,AAX,=77 77 000.NBB,NLAB
 14,VTM,NCH
 ,UZA,OWN BUF
 15,VTM,ЗAKPЫTЬ
 ,XTA,RZ OI
 ,UJ,EX INI
 OWN BUF:,BSS,
 C,XTA,MBINF.
 15,VJM,FORMINFA.
 ,AOX,BIT40.
 C,ATX,MBINFOWN.
 C,XTA,XRS.
 ,AAX,=77777
 ,AOX,BIT48.
 C,ATX,XRS.
 14,VTM,NCH
 15,VJM,READP
C      ЗAKPЫTИE ПO OБMEHY HA PEЗEPBHOM
 ЗAKPЫTЬ:,BSS,
 C,XTA,BUFSAP+NCH
C  CLAF ПPOBEPИT KO OБMEHA
 14,VJM,CLAF
 C,XTA,BUFSAP+NCH
 ,ASN,64+20
 ,AAX,=76000
 ,ATI,14.HAЧAЛO ЛИCTA
  ,XTA,ZBCH
  ,AAX,SCGOST
  ,ATX,SCGOST
C...   ПPOBEPKA TИПA KOДA :
  BA,VTM,0
  14,XTA,
  ,ASN,64+38
  ,U1A,/15
  14,XTA,9
  ,AEX,=6H'12'FOUT'200'
  ,U1A,/15
C...     KOД - ГOCT
  BA,VTM,1
  ,XTA,BCH
  ,AOX,SCGOST
  ,ATX,SCGOST
  ,UJ,/15
 YBA:,BSS,
C         YCTAHOBKA TИПA KOДA B BA.
C         0 OЗHAЧAET KOД ISO.
 BA,VTM,0
 ,XTA,BCH
 ,AAX,SCGOST
 14,UZA,
 BA,VTM,1
 14,UJ,
 EX CAT:,BSS,
 ,ATX,W2
 ,ITA,15
 C,ATX,MBINFOWN.A BOЗPATA
 14,VTM,NCH
 C,J+M,14
 14,XTA,BUFSAP
 ,AAX,B35/31
 14,ATX,BUFSAP
 ,ASN,64+20.ЛИCT KAHAЛA
 15,VJM,*57
 C,XTA,BUFSAP+NCH.ЖДATЬ KO
 14,VJM,CLAF
 C,WTC,MBINFOWN
 ,UJ,
 EX INI:,BSS,.BЫДAЧA OБMEHA
 ,ATX,W2.C ЗOHOЙ "OB"
 C,J+M,14
 14,XTA,BUFSAP
 ,AAX,B35/31
 14,ATX,BUFSAP
 C,XTA,MBINF
 ,AAX,=777
 14,AOX,BUFSAP
 *57:,AOX,W2
 ,ATX,W2
 14,XTA,BUFSAP
 ,AOX,MFREE
 C,ATX,RETADR.OБMEH BЫДAH
 ,XTA,BCH
 ,AOX,SC WAIT
 ,ATX,SC WAIT
  C,XTA,MB INF
  ,AAX,BIT39
  ,UZA,HE HOB
  14,XTA,BUFSAP
  ,AOX,=37.ЗOHA HOBOCTEЙ
  ,AOX,BIT40
  ,ATX,W2
  ,*65,523B
  ,ATI,14.DISPBASE
  14,*65,4
  ,ANX,=7
  ,ASN,64-12.N MБ
  ,AOX,BIT39
  ,AOX,W2
  ,ATX,W2
  ,DRUM,W2
  15,UJ,
  HE HOB:,XTA,W2
  ,*57,7
 15,UJ,
 READP:,BSS,
 C,J+M,14
 14,XTA,BUFSAP
 ,AAX,B35/31
 14,ATX,BUFSAP
 ,AOX,MFREE.
 C,ATX,RETADR.
 C,XTA,MBINFOWN.
 14,AOX,BUFSAP.
 14,ATX,BUFSAP.
 C,XTA,MBINFOWN.
 ,ASN,64+18
 C,AEX,MBINFOWN.
 ,AAX,=777.
 ,UZA,LSTZONE.KOHEЦ MECTA
 C,XTA,MBINFOWN.
 ,ARX,=1.
 C,ATX,MBINFOWN.
 TRANSF:,BSS,.BЫД. OБMEHA
  14,XTA,BUFSAP
  ,ATX,W5
  C,XTA,NUMBUS.N PASS KЛИEHTA
  ,*50,72100B+117B.CEБE B ИПЗ
  ,*70,W5
 ,XTA,BCH
 ,AOX,SC WAIT.
 ,ATX,SC WAIT.
 15,UJ,
 LSTZONE:,BSS,.
C......   KOHEЦ OTBEДEHHOГO MECTA HA MБ(MЛ)
 C,XTA,MBINFOWN.
 ,AAX,BIT40.
 ,UIA,CORXRS.
 ,ITA,JP.
 ,AAX,=1777
 ,U1A,TRANSF
 JP,UTM,-3.OPГ. KOHЦA ФAЙЛA
 DELLST:,BSS,.ПOИCK KOHЦA CTPOKИ
 JP,UTM,-1.
 JP,XTA,-1.
 ,AEX,XNL.
 ,AAX,=377.
 ,U1A,DELLST.
 ,XTA,=6H*READ
 JP,ATX,
 ,XTA,=6HOLD'312''12''12'
 JP,ATX,1.
 ,XTA,SGNEND.
 JP,ATX,2.
 ,XTA,=6H'315''12'   '12'
 JP,ATX,3
 15,VJM,TRANSF.
 ,ITA,
 C,WTC,TYPE
 ,UJ,.
 CORXRS:,BSS,.
C......   KOPPEKЦИЯ BOЗBPATA
 C,XTA,XRS.
 ,ARX,
 ,UIA,KOHBUF.
 ,ARX,BIT47.
 ,UZA,OK
 ,ARX,CMIN1.
 OK:C,ATX,XRS.
 ,UJ,TRANSF.
 KOHBUF:,BSS,.
 RR,VTM,TKБ
 ,UJ,TODIAG
 IFTRAERR:,BSS,
C......   П/П ПPOBEPKИ HAЛИЧИЯ OШИБKИ
C         ПO TEKYЩEMY OБMEHY KAHAЛA.
 ,XTA,BCH
 ,AAX,SCERRTRA
 14,UZA,.HET OШИБKИ
 ,AEX,SCERRTRA
 ,ATX,SCERRTRA
 RR,VTM,TBADTRA
 TODIAG:,BSS,
C......   BЫДAЧA ДИAГHOCTИKИ ПO OБMEHY
 C,XTA,RETADR.
 ,AAX,B35/31
 C,ATX,RETADR
 ,XTA,
 C,ATX,TEKAДP.
 C,XTA,MBINF
 ,AAX,=:777
 C,ATX,MBINF.БYФEP:
 ,WTC,MLTBAS
 BA,VTM,
 ,UJ,MLTBAS
 WOST:,BSS,
 14,VTM,-2
 C,XTA,TEKAДP
 ,ATX,W1
 LRM1:,XTA,W1
 ,ASN,64-8
 ,ATX,W1
 ,YTA,
 14,ATI,L.
 14,VLM,LRM1
 14,VTM,-1
 LRM2:C,XTA,BUFSAP
 14,ATI,R
 ,ASN,64+15
 14,ATI,RR
 ,ASN,64+25
 14,ATI,NS
 C,UTM,NCH
 14,VLM,LRM2
 C,UTM,-NCH*2.
 C,XTA,SPB.
 ,ATI,4.
 ,ASN,64+15.
 ,ATI,3.
 14,VJM,IFTRAERR
 C,WTC,RETADR
 ,UJ,
 STORE:,BSS,.
 C,XTA,XRS.
 ,ARX,.
 ,U1A,HE HAДO.
 ,ASN,64-2
 ,YTA,
 ,ARX,CMIN4.
 C,ARX,MBINFOWN.
 C,ATX,MBINFOWN.
 HE HAДO:,BSS,.
 14,VJM,IFTRAERR
 C,XTA,MBINFOWN.
 ,AOX,BIT40.
 ,AEX,BIT40.
 C,ATX,MBINFOWN.
 ,ITA,RR
 C,ATX,TYPE
 C,XTA,TEKAДP.
 ,ATI,JP.
 ,AAX,BITEND.
 ,U1A,END FILE.
 C,XTA,ASTR.
 ,ATI,JS.
 ,ITA,.
 C,ATX,XRS.
 ,MTJ,L
 NS,VTM,83.
 R,VTM,READS.
 JP,VZM,FSTCS.
 ,XTA,
 JP,ATX,.ДЛЯ WRITES
 READS:C,XTA,XRS
 ,U1A,R1S.
 JS,XTA,
 ,AOX,CONOR
 JS,UTM,1.
 R1S:,ASN,64-8.
 C,ATX,XRS.
 ,YTA,
 ,AAX,=177
 ,ATI,RS.
 R,VTM,READS.
 RS,VZM,ENDST.
 RS,UTM,-NL.
 RS,VZM,ENDST.
 NS,UTM,-1
 RS,UTM,NL-SPACE.
 RS,VZM,BLANK.
 L,V1M,FNBL.
 BWRT:RS,UTM,SPACE.
 ,ITA,RS
 WRITES:JP,AOX,
 ,ATX,W1
 ,ASN,64-8
 JP,ATX,
 ,YTA,.
 ,ATI,T.
 R,UZA,
 ,XTA,W1.
 WRITEW:JP,ATX,
 JP,UTM,1
 ,ITA,JP
 ,AAX,=1777.
 ,U1A,NENDPAGE.
 C,XTA,RETADR.
 ,AAX,MFREE.
 ,U1A,CLSTORE
 WOZ1S:15,VJM,WRITEP.
 C,XTA,BUFSAP+NCH.
 ,AEX,
 C,XTA,BUFSAP.
 C,ATX,BUFSAP+NCH.
 ,YTA,.
 C,ATX,BUFSAP.
 FORMJP:,ASN,64+20.
 ,AAX,=76000.
 ,ATI,JP.
 NENDPAGE:,ITA,
 JP,ATX,
 R,UJ,
 CLSTORE:14,VTM,WOZ1S.
 ,UJ,CLAF.
 BLANK:,BSS,
 L,V1M,NFBLS
  L,VTM,200B
 NFBLS:,BSS,
 L,UTM,1
 ,UJ,READS
  FNBL:,ITA,L
 R,VJM,WRITES.
 R,VTM,READS.
 ,MTJ,L.
 ,UJ,BWRT.
 ENDST:,BSS,.
 L,V1M,BIAB.
 NS,VZM,CORST.
 NS,UTM,200B.
  ,UJ,GENEST
  BIAB:L,J+M,NS
  NS,UTM,-83-200B
  NS,VZM,RETSTORE
  NS,UTM,83+200B
  GENEST:,ITA,NS
 R,VJM,WRITES.
 CORST:RS,UTM,NL.
 DOKS:,ITA,RS.
 R,VJM,WRITES.
 T,VZM,DOKS.
 RETSTORE:,BSS,.
 ,ITA,JP.
 C,ATX,TEKAДP.
 C,XTA,TYPE
 ,ATI,RR
 ,ITA,
 C,ATX,XRS.
 RR,UJ,
 FSTCS:,BSS,
 14,VTM,GO ON.
 ,UJ,CLAF**.
 GO ON:,BSS,.
 15,VTM,RFCST.
C......   OPГ. ИHФ. CЛOBA OБMEHA
 C,XTA,MBINF.
 FORMINFA:,BSS,.BXOД ПO CYMM.
C         ПOЛYЧEHИE AДPECA OБMEHA ПO
C         YKAЗATEЛЮ. BЫXOД - CYMMATOP И
 ,ATX,W1.
 ,ARX,
 ,UZA,DRUM.
 ,ASN,64-3.
 ,AUX,=770777
 ,ATX,W3.
 ,AAX,=777
 ,NTR,7
 C,X-A,FILLEN
 ,U1A,BADCASE
 ,XTA,W1
 ,AAX,=777.
 ,U1A,*100.ПPAB. OГPAH.
  C,XTA,FILLEN
 *100:,ASN,64-18.
  ,UJ,*200
 DRUM:,BSS,.
C......   TPEБYETCЯ БAPAБAH
 14,VTM,DRUMUS-1.
 ,NTR,7.YCT. PEЖИMA
 SFDRUS:14,UTM,1.ПOИCK БAPAHЩИKA
 14,XTA,.
 ,UZA,BADCASE.
 C,AEX,NUMBUS.
 ,AAX,=1777
 ,U1A,SFDRUS.
 14,XTA,.
 ,AUX,=770777.
 ,ATX,W3.HAЧ. БYФEPA
 14,XTA,.
 ,ASN,64-18
 ,AUX,=770777.
 ,ATX,W2.KOH. БYФEPA
 ,XTA,W1.
 ,AAX,=777.
 ,A-X,=1.KOP. YK. KOHЦ.
 ,U1A,STANL.CTAHД. ДЛИHA
 ,ARX,W3.KOH. MECTA
 ,X-A,W2.
 ,UIA,BADCASE.
 ,X-A,W2.
 ,ATX,W2.
 STANL:,XTA,W1.
 ,ASN,64+30
 ,AAX,=777.
 ,A-X,=1.KOP. YK. HAЧ.
 ,U1A,BADCASE.
 ,ARX,W3.
 ,ATX,W3.HAЧ.MECTA
 ,X-A,W2.
 ,UIA,BADCASE.
 ,XTA,W3.
 ,AAX,=77 0000.
 ,UIA,NO MODEL.
 ,ITA,15.
 ,ATX,W1.
  ,XTA,NAMEMT
  ,*57,400B
  ,UZA,BADCASE
  ,AOX,=:0000 1000
 ,ASN,64-12.
 ,AOX,W3.
 ,ATX,W3.
 NO MODEL:,BSS,.
 ,XTA,W2.
 ,AAX,=777.
  ,ASN,64-18
  ,AOX,BIT39
  *200:,AOX,W3
  15,UJ,
 BADCASE:,WTC,MLTBAS.
 BA,VTM,.
 RR,VJM,CLEAR.
 RR,VTM,TД.
 ,UJ,MLTBAS.
 RFCST:,BSS,.BЫXOД 1 STORE
 C,ATX,MBINFOWN.
 C,XTA,BUFSAP.
 ,UJ,FORMJP.
 END FILE:,BSS,
 ,XTA,=6H*READ
 R,VJM,WRITEW.
 ,XTA,=6HOLD'312''12''12'
 R,VJM,WRITEW.
 ,XTA,SGNEND.
 R,VJM,WRITEW.
 ,XTA,=6H'315''12'   '12'
 R,VJM,WRITEW.
 C,XTA,TYPE
 ,ATI,RR
 C,ATX,XRS.
 ,ITA,JP.
 ,AAX,=1777.
 RR,UZA,
 15,VJM,WRITE P
 C,XTA,BUFSAP
 RR,MTJ,14.BOЗBPAT
 ,UJ,CLAF.ЖДATЬ KO
 WRITEP:,MTJ,14
 ,UJ,READP
 SCAN:,BSS,
 C,ATX,TYPE.
 C,XTA,XRS.
 ,AOX,=77777.
 ,AEX,=77777.
 C,ATX,XRS.
 ,ITA,RR.
 C,AOX,XRS.
 C,ATX,XRS.
 ,MTJ,JS.
 ,MTJ,NS.
 C,XTA,TEKAДP.
 ,ATI,JP.
 ,AOX,=7 7777.
 ,AEX,=7 7777.
 C,ATX,TEK AДP.
 JP,VZM,FSTCALL.BOЗBPAT HA /3SC
 ,AAX,BITSTF.
 ,UZA,READ SC.
 C,AEX,TEKAДP.
 C,ATX,TEKAДP.
 JS,VTM,1.
 READ SC:,BSS,.
 JP,UTM,1.
 ,ITA,JP.
 ,AAX,=1777
 ,UZA,NEW PAGE.
 /3SC:JP,XTA,.
 ,ATX,W1.
 JS,V1M,NON1.
 ,AEX,SGNEND.
 ,UZA,ENDF
 ,XTA,W1.
 C,AEX,TYPE.
  ,U1A,NOFIND
C...    M.Б. ИЩEM "*READ OLD"
  C,XTA,TYPE
  ,AEX,=6H*READ
  ,U1A,ENDSCAN.-HET
 ,ITA,JP
 ,AAX,=1777
 ,AEX,=1777
 ,UZA,ENDSCAN.HAЙДEH
  JP,XTA,1
  ,AEX,=6HOLD
  ,AAX,=:7777 7777
  NO FIND:,UZA,END SCAN
 ,XTA,W1.
 ,AAX,=:776.
 ,AEX,=:002.
 ,U1A,NON1.
C......   CTPOKA AЦПY
 ,XTA,W1.
 ,ASN,64-8.
 C,AEX,TYPE.
 ,ASN,64+8
 ,UZA,ENDSCAN.CИM. HAЙДEH
 NON1:JS,VTM,1.
 ,XTA,W1.
 ,AEX,XNL.
 ,AAX,=377.
 ,U1A,READSC.HE KOHEЦ CTP.
 ENDSCAN:,BSS,.
 ,ITA,JP.
 C,AOX,TEKAДP.
  KILLSC:,BSS,
 C,ATX,TEKAДP.
C  JS=0 - HAЙДEH ИЛИ ENDFILE, =1 - EЩE SCAN
 ,UJ,ENDF
 RCAT OI:1,,
 ,,.BЫBOД
 :9,,
 ,,.BBOД
 WCAT OI:2,,
 ,,.BЫBOД
 :10,,
 ,,.BBOД
 RZ OI:3,010,
 ,,
 :11,010,
 ,,
 SEM OI:,,
 ,,2
 :,,
 ,,3
 MCAT:,ISO,6HD78OUT
 ,ISO,6HD78INP
 TCAT:,ISO,12HHE KATAЛOГ'45'''
 THBЫД:,ISO,6HПPOЧЬ''
 SCERRTRA:,LOG,
 TBADTRA:,ISO,12HПЛOX.OБMEH''''
 SCGOST:,LOG,
  SGNEND:,ISO,6H*-*-*-
 FULWOR:,LOG,7777 7777 7777 7777
 TKБ:,ISO,12HOШ. KOHЦA''''''
 TД:,ISO,12HOШ. БYФEP''''''
 NAMEMT:,TEXT,8HM      '7'
 SYM:,BSS,1
 W1:,BSS,1
 W2:,BSS,1
 W3:,BSS,1
  W4:,BSS,1
  W5:,BSS,1
 ,END,
   *TGOSISO:,NAME,
 000,ISO,6H  0123
 004,ISO,6H  4567
 010,ISO,6H  89+-
 014,ISO,6H  /,.
 020,ISO,6H  Ю'77'()
 024,ISO,6H  '46'='73''133'
 030,ISO,6H  '135'*'47''47'
 034,ISO,6H  '43''74''76':
 040,ISO,6H  AБBГ
 044,ISO,6H  ДEЖЗ
 050,ISO,6H  ИЙKЛ
 054,ISO,6H  MHOП
 060,ISO,6H  PCTY
 064,ISO,6H  ФXЦЧ
 070,ISO,6H  ШЩЫЬ
 074,ISO,6H  ЭЮЯD
 100,ISO,6H  FGIJ
 104,ISO,6H  LNQR
 110,ISO,6H  SUVW
 114,ISO,6H  Z'134''136''1'
 120,ISO,6H  '1''1''1''1'
 124,ISO,6H  '1''1''45'$
 130,ISO,6H  '136''1''137''41'
 134,ISO,6H  '42'Ы'100''47'
 ,END,
 FORM PACK:,NAME,
 '15.10.72'
C          ЗAПAKOBKA ФOPMATA
C++4.6.73
 N CH:,EQU,10
 *2:,BLOCK,C,(1),R,S,W,N
 ,CONT,(2),SW,K,M,T
 SPACE:,EQU,40B
 COMMA:,EQU,54B
 LA   :,EQU,101B
 LC:,EQU,103B.
 LS   :,EQU,123B
 LX   :,EQU,130B
 LL:,EQU,114B
 TS:,EQU,100B
 TA:,EQU,200B
 TX:,EQU,300B
C---------
 L NRS:,EQU,2000B
 IW O/I:   ,EQU,=:7153 4000 0060
 L NRS : I ,BLOCK,(3)
 ,CONT,NEXT
 ,CONT,FG 0
 PAБ ЛИCT:,EQU,0
 PAБ ЛИCT:I,BLOCK,(440),***
 DELTA:,P*P,(5)(N CH)
 A STR:,EQU,*** + DELTA
 NC:,EQU,NCH
 RONLY:,EQU,ASTR+NC
 FILLEN:,EQU,RONLY+1
 COPYRA:,EQU,FILLEN+NC
 LPAG:,EQU,COPYRA+NC
 LASTORD:,EQU,LPAG+NC
 SC100:,EQU,LASTORD+NC
 MAXL:,EQU,SC100+1.ДЛЯ VR
 *1TYPE:,EQU,MAXL+NC.ДЛЯ FETCH И
 TYPE:,EQU,*1TYPE
C==========================================
 T,VTM,.TИП
 M,VTM,.MECTO B TИПE
 SW,VTM,.ПEPEKЛЮЧATEЛЬ
 C,WTC,A STR.AДPEC CTPOKИ
 N,VTM,.HOMEP CЛOBA
 ,XTA,.
 ,ATX,ACC.ГAШEHИE
 C,ATX,TYPE.ГAШEHИE
 R WORD:N,XTA,.TEK. CЛOBO
 K,VTM,.MECTO B CЛOBE
 READ:,ASN,64 - 8.TEK. CИMBOЛ
 ,ATX,WORD.
 ,YTA,.
 ,ATI,S.CИMBOЛ
 S,UTM,- SPACE.
 S,VIM,SWITCH.HE ПPOБEЛ
 SW,VIM,STEP.HOPMAЛЬHO
 SW,VTM,LETTER.ПEPBЫЙ ПPOБEЛ
 STEP:K,UTM,8.ШAГ K
 ,XTA,WORD.OCTATOK
 K,MTJ,S.ПPOБA
 S,UTM,- 48.   KOHЦA
 S,VIM,READ.      CЛOBA
 N,UTM,1.ШAГ N
 SW,VIM,R WORD.
  SW,VJM,R WORD.ПEPBOE CЛOBO
 'AHAЛИЗ'
 LETTER:,UZA,NEXT.KOHEЦ CTPOKИ
 SW,VJM,FIX.
 T,VTM,TA.AHAЛИЗ БYKB:
 S,UTM,SPACE - LA
 S,VZM,SET.TИП A
 T,VTM,TS
 S,UTM,LA - LC.
 S,VZM,SET.TИП S
 S,UTM,LC - LS.
 S,VZM,SET.TИП S
 T,VTM,TX
 S,UTM,LS - LX
 S,VZM,SET.TИП X
 S,UTM,LX - LL.
 S,VIM,ERR SP.HE БYKBA
 ,XTA,FOR L.CTAHД. ФOPMAT
 C,ATX,TYPE.
 ,UJ,NEXT... ...
C....
  SWITCH:SW,VZM,STEP.HAЧAЛO CTPOKИ
  SW,UJ,.HOPMAЛЬHO
C....
 FIGURE:S,UTM,SPACE - COMMA
 S, VZM,TO TYPE.ЗAПЯTAЯ
 S, UTM,COMMA.BOCCT.
 ,UJ,DIGIT.
 FIR DIG:,UZA,NEXT.KOHEЦ CTPOKИ
 SW,VJM,FIX.
 SW,VTM,FIGURE.
 S,UTM,SPACE.BOCCT.
 DIGIT:S,UTM,- 72B.ГPAHИЦA ЦИФPЫ
 ,ITA,S
 ,AAX,=7700.MИHYC
 ,UZA,ERR SP.HE ЦИФPA
 S,UTM,72B-60B . ГPAHИЦA ЦИФPЫ
 ,ITA,S
 ,AAX,=7700.MИHYC
 ,UIA,ERR SP.
 'ПOДПPOГPAMMЫ'   ---=---
 ,XTA,ACC.HAKOПИTEЛЬ
 ,ASN,64 - 1.BДBOE
 ,ATX,X1.
 ,ASN,64 - 2.BЧETBEPO
 ,ARX,X1.
 ,ATX,X1.
 ,ITA,S.
 ,ARX,X1.
 ,ATX,ACC.
 ,AAX,=7700.CBEPX 63-X
 ,UIA,ERR SP.
 ,UJ,STEP.
 SET:SW,VTM,FIR DIG.YCTAHOBKA TИПA
 ,ITA,T.
 ,ATX,ACC.
 ,UJ,TO TYPE.
 TO TYPE:,XTA,ACC.
 M,ASN,64 - 40.ИЗ XBOCTA
 ,UZA,ERR SP.БOЛЬШE 6-TИ
 C,AOX,TYPE.
 C,ATX,TYPE.ФOPMAT
 ,XTA,.
 ,ATX,ACC.ГAШEHИE
 T,VIM,STEP.OБXOД ШAГA M
 M,UTM,8.ШAГ ПO ПOЛЮ
 SW,VTM,LETTER.
 ,UJ,STEP......
 FIX:,ITA,N.
 ,ATX,XN.
 ,ITA,K.
 ,ATX,XK.
 T,VTM,.БЛOKИP. OБXOДA
 SW,UJ,
 ERR SP:,XTA,XN.OШ. CПEЦИФИKAЦИИ
 ,ATI,N.
 ,XTA,XK.
 ,ATI,K......
 ,XTA,=:776.MACKA
 K,ASN,64.
 N,AAX,...
 N,AEX,.ГAШEHИE
 N,ATX,...
 R,VTM,NEXT...BЫДAЧA...
 W,VTM,IW O/I.
 ,UJ,FG 0............
C==========================================
 FOR L:,GOST,6H'230''100'0000
 WORD:,BSS,1.P.Я.
 ACC :,BSS,1.P.Я.
 X1  :,BSS,1.P.Я.
 XN  :,BSS,1.P.Я.
 XK  :,BSS,1.P.Я.
 ,END,
  *DRUMUS:,NAME,
C.....   БYФEPA И XOЗЯEBA :
  0,LOG,00000 0 00007 00000
  1,LOG, 00000 0 00007 00000
  2,LOG, 00010 0 00017 00000
  3,LOG, 00020 0 00027 00000
  4,LOG, 00030 0 00037 00000
  5,LOG, 00040 0 00047 00000
  6,LOG, 00050 0 00057 00000
  7,LOG, 00060 0 00067 00000
 10,LOG, 00070 0 00077 00000
 11,LOG,00100 0 00177 00000.
   ,LOG,.KOHEЦ CПИCKA
  0,LOG,1.XOЗЯEBA:
  1,TEXT,6HAHTOШA
  2,TEXT,5HKAMAK
  3,TEXT,6HACYTEN
  4,TEXT,6HЙЫHЗAM
  5,TEXT,6HC44839
  6,TEXT,5HMTEXT
  7,TEXT,6HLIBRTS
 10,TEXT,5HMJPOP
 11,TEXT,6HWORKIN
  ,END,
 OPERANDS:,NAME,
 '25.10.72, ФEДOCEEB.
C                  ПOЛYЧEHИE OПEPAHДOB
C             ДЛЯ ПPИKAЗOB MYЛЬTИTAЙПA
C++4.6.73
C  MAЙ 80     ЛOПATKO B.Б.
C  ПO MOTИBAM ГOPHЯKOB-ПPEДШECTBEHHИKOB
 N CH:,EQU,10.
 *2:,BLOCK,C,(1),R,S,(1),N
 ,CONT,(1),W1,SW,K,L,T,P,TT
 SPACE:,EQU,40B.
 PLUS:,EQU,53B
 COMMA:,EQU,54B.
 SLASH:,EQU,57B.
 TWOP:,EQU,72B
 SMARK:,EQU,1.
 PAБЛИCT:,EQU,0.
C         ---------------------
 L NRS:,EQU,2 000B.
 PAБ ЛИCT:I,BLOCK,(84),MACKA OБ(10)
 ,CONT,(346),***
 DELTA:,P*P,(5)(N CH)
 A STR:,EQU,*** + DELTA
 L NRS:I,BLOCK,
 ,CONT,(8)
 ,CONT,DIAGN.
C==============================
 ,ITA,W1.HA XPAH.
 ,ATX,S/W1
 ,ITA,SW
 ,ATX,S/SW
 'HAЧAЛO'
 C,WTC,A STR.AДPEC CTPOKИ
 N,VTM,.
 T,MTJ,TT.YПP.TИПA
 SW,VTM,FIRST.HAЧ.CTPOKИ
 W1,VTM,STEP.ДЛЯ JOB'A
 ,XTA,.
 ,ATX,ACC.HAKOПИTEЛЬ
 ,ATX,APP.AППEHДИKC
 ,ATX,FLAG.ПP. ДOBBOДA
  ,*65,526B
  ,ASN,64+24
  ,ATX,PYC.TAБЛ. ISO->TEXT
 R WORD:N,XTA,.TEK. CЛOBO
 K,VTM,1 - 6.6 CИMBOЛOB
 READ:,ASN,64 - 8.
 ,ATX,WORD.OCTATOK
 ,YTA,.
 ,ATI,S.TEK. CИMBOЛ
 SW,U1A,.HE KOHEЦ CTPOKИ
 'BЫXOД'    ---------
 TT,UJ,MT.BOЗBPAT ПO TИПY
 MT:S,VTM,OUT
 ,UJ,TOM.ДOKPYTИTЬ ИMЯ,PASS
 :,XTA,ACC.1
 ,UJ,R3
 :SW,UTM,-FIGURE.2
 ,UJ,OPD
 :,XTA,ACC.3
 ,UJ,R3
 :,UJ,R4.4
 :T,V1M,DBUF.5
 ,UJ,MT
 :SW,UTM,-FIGURE.6
 ,UJ,OPD
 :,,.PEЗEPB
 :,XTA,APP.8
 ,ATI,T
 R9:,BSS,
 :,XTA,ACC.9
 ,UJ,OUT
 ,XTA,ACC.10
 ,UJ,OUT
 :,XTA,ACC.11
 ,UJ,R11
 OPD:SW,V1M,RT.БЫЛA COMMA
 T,VTM,1.ПEPBЫЙ OПEPAHД
 RT:,BSS,.ПAKYEM OПEPAHДЫ
   ,XTA,APP
 T,ASX,VV-1.T=1,2
 ,ATX,APP...
 ,XTA,ACC.
 R3:T,WTC,VV-1
 ,ASN,64.
 ,AOX,APP...
 ,WTC,FLAG.
 T,VTM,.BBOД/ДOBBOД
 ,UJ,OUT
 R4:,XTA,ACC.ЭTAЛOH CTAPЫЙ
 R,UZA,.-ДA
 ,XTA,FUL WOR.K ЛEB.KPAЮ
 ,WTC,APP.
 ,ASN,64.
 ,YTA,.
 C,ATX,MACKA OБ
 ,XTA,ACC
 R11:,BSS,
 ,WTC,APP.
 ,ASN,64.
 ,YTA,.
 OUT:,WTC,S/W1.BOCCT.
 W1,VTM,
 ,WTC,S/SW
 SW,VTM,.
 R,UJ,.
C   --------------------
 FIRST:S,UTM,-SPACE
 T,UJ,T SW
 T SW:S,V1M,IF**.0-PASS
 ,UJ,T0
 :S,V1M,IF**.1-BЫBOД ПO L CTPOK
 ,UJ,T1
 :S,V1M,IF**.2-AЦП,CON
 ,UJ,T2.ПYCKИ: 1-2 OП
 :S,VZM,S/SPACE.3=ДOH
 ,UJ,IF PLUS
 :S,V1M,IF**.4-ДO
 ,UJ,T4
 :S,V1M,IF**.5-БYФEP
 ,UJ,T5.  2-4-5 OП
 :S,VZM,S/SPACE.6=ЛИCT;
 ,UJ,IF PLUS. =BBOД:1-2 OП
 :,XTA,.PEЗEPB
 ,UJ,OUT
 :S,V1M,IF**.8-OTЛAДЫ:1-2 OП
 SW,VTM,0.ДЛЯ TO T1
 :S,V1M,IF**.9-ПYЛЬT,DENSITY
 ,UJ,T9
 :S,V1M,IF**.10-ДEЛЬTA
 ,UJ,T10
 :S,VZM,STEP.11=CKAHИPOBAHИE
 T,VTM,4.T11 B T4
 SW,VTM,CHE JOB
 L,VTM,-6
 ,UJ,MARK
 T0:S,V1M,STEP
 SW,VTM,TEXT
 L,VTM,-6
 ,UJ,STEP
 T4:L,VTM,-6
 SW,VTM,CHE JOB
 STEP:,XTA,WORD.
 K,VLM,READ.
 N,VLM,R WORD.
 IF**:S,UTM,SPACE-TWOP
 S,V1M,STEP
 T,UJ,T SW.ДBOETOЧИE
 IF PLUS:S,UTM,SPACE-TWOP
 S,VZM,S/SPACE.ЧTO И ПPOБEЛ
 S,UTM,TWOP-PLUS
 S,V1M,STEP
 T,UTM,-6
 T,VZM,PLT6
 ,ATX,FLAG.T3 И '+'
 ,UJ,T3
 S/SPACE:T,UTM,-6
 T,VZM,SPT6
 T3:L,VTM,-4
 T,VTM,3.BOCCT.
 ,UJ,DIG
 PLT7:,ATX,FLAG
 SPT7:T,VTM,1.T7 B T1
 T1:L,VTM,-3
 ,UJ,DIG
 T9:L,VTM,-16.T9 B T1
 ,UJ,TO T1
 T10:L,VTM,-4.T10 B T1
 TO T1:SW,VZM,T8
 T,VTM,1
 DIG:SW,VTM,DIGIT
 ,UJ,STEP
 PLT6:,ATX,FLAG
 SPT6:T,VTM,2.T6 B T2
 T2:L,VTM,-3
 ,ITA,L
 ,ATX,YC L.ДЛИHA 2 OП
 ,UJ,FIG
 T5:L,VTM,-4
 ,UJ,FIG
 T8:T,VTM,2.T8 B T2
 ,ITA,L
 ,ATX,YC L
 L,VTM,-5
 FIG:SW,VJM,STEP.SW:=FIGURE
C         ----------------
 FIGURE:S,UTM,- COMMA.
 S,VZM,F COMMA.
 S,UTM,COMMA - SLASH.
 S,VZM,F SLASH.
 DIGIT:,ATI,S.OБPAБ. ЦИФP
 S,UTM,- 60B.
 ,ITA,S.
 ,AAX,=7 000.MИHYC
 ,UIA,IF SP.MAЛO
 ,ITA,S.
 T,ARX,TYPE.
 ,AAX,=7 000.MИHYC
  ,U1A,JOB.HOPMA
  L,UTM,4
  L,VIM,ERROR
  T,UTM,-5
  T,VIM,ERROR
C
C...  ECЛИ KOHCTPYKЦИЯ "БYФEP:"
C     HAЧИHAETCЯ C БYKBЫ, TO ЭTO
C     OБPAЩEHИE K ФAЙЛOBOЙ CИCTEME
C     БYФEP:SNAME,MASTER,FILE,REGIM
C     SNAME - ИMЯ ФAЙЛOBOЙ CИCTEMЫ.
C
  ,ATX,APP
  ,ATX,ACC
  S,UTM,60B
  L,VTM,-6
 SW,VTM,TEXT
 SW,UJ,
 CHE JOB:L,V1M,ISO
 TT,UJ,MT.BOЗBPAT ПO TИПY
 ISO:,BSS,
 S,UTM,-SPACE.
 S,VZM,STEP.
 MARK:,BSS,
 S,UTM,SPACE-SMARK.
 S,VZM,STEP.
 S,UTM,SMARK.
 ,XTA,APP.
 ,ARX,=10.
 ,ATX,APP.
 JOB:,XTA,ACC.HAKOПЛEHИE
 T,ASX,TYPE.ДЛИHA БAЙTA
 ,ATX,ACC.
 ,ITA,S.
 ,AOX,ACC.
 ,ATX,ACC.
 W1,UTC,.ГДE ШAГATЬ
 L,VLM,.ДЛИHA OПEPAHДA
  TT,VZM,MT.PASS
 ,UJ,ERROR.ДЛИHA BEЛИKA
C
C
C ДЛЯ T5 (ПOCЛE /) B T0
  TEXT:S,UTM,-COMMA
  S,VZM,CHBUF.ЗAПЯTAЯ
  ,WTC,PYC
  S,XTA,COMMA
  ,ASN,64+8
  ,AAX,=77.CИMBOЛ "TEXT"
  ,UZA,MБPYC
  ,ATI,S
  ,UJ,JOB
  MБPYC:S,UTM,COMMA
  ,ITA,S
  ,AAX,=40
  ,UZA,ERROR.ЛATЫHЬ
  S,UTM,-40B
  ,UJ,TEXT
  CHBUF:,BSS,
 ,ITA,TT
 ,UZA,OUT.PASS, A ЗПT
C.. ЗAДAETCЯ БYФEP HA ДИCKE.
C.. ДOБEPEM ИMEHA MACTEPA И ФAЙЛA.
C.. HA BЫXOДE CYM.=ИMЯ ДП
C ПO T XPAH. ИMЯ MACTEPA(ISO)
C ПO T+1  -  ИMЯ ФAЙЛA
C ПO T+2  -  R/W
 S,VTM,MAS
C ДOKPYTKA ИMEHИ MЛ И ДП (TEXT)
  ,XTA,APP
  ,U1A,TOM
  L,VTM,.БEЗ ДOKPYTKИ
 TOM:L,UTM,-1.ДO 48P
 ,XTA,ACC
 ДOП:T,ASX,TYPE.T=0
 L,VLM,ДOП
 ,AOX,APP
 S,UJ,
 MAS:,ATX,APP.XPAH.
 T,VTM,4.ISO
 SW,VTM,LIST
 P,VTM,-2.3 ИMEHИ
 TO STEP:L,VTM,-6.ДЛИHA ИMEHИ
 ,UJ,STEP
 LIST:S,UTM,-COMMA
  ,XTA,ACC
 S,VZM,NAME
 S,UTM,COMMA
 ,UJ,JOB
C ДOПOЛHИM ИMЯ CПPABA ПPOБEЛAMИ
 NAME:L,VZM,FILE
 W1,VTM,NAME.ШAГATЬ ЗДECЬ
  NAME1:,BSS,
 S,VTM,40B.ISO-ПPOБEЛ
 ,UJ,JOB
 FILE:P,ATX,R/W.-2,-1,0
 W1,VTM,STEP.ИЗ CTPOKИ
 P,VLM,TO STEP
  ,XTA,APP
  ,ATX,ACC
  T,VJM,R9.T:=MASTER
  :,BSS,2.MASTER+NAMFIL
  R/W:,BSS,1
 DBUF:P,VZM,NAME
 P,UTM,1
 P,V1M,ERROR.HET ФAЙЛA
  ,XTA,ACC
  W1,VTM,*+1
  :L,VIM,NAME1.ДOKPYTKA
  ,ATX,R/W-1.ИMEHИ ФAЙЛA
  ,XTA,=6HR
  ,UJ,FILE.ПO YMOЛЧAHИЮ-R
  FSLASH:T,UTM,-5.TИП ИMEHИ
  L,VTM,-6.ДЛИHA ИMEHИ
  SW,VTM,TEXT
  ,UJ,F1
 F COMMA:S,VTM,- 2.TИП
   ,WTC,YC L
   L,VTM,
 SW,VTM,DIGIT.
 F1:T,J+M,S.
 S,VIM,ERROR.HE TOT TИП
 ,XTA,ACC.
  T,VIM,NO*NAM
  ,FUN,203B
  NO*NAM:,BSS,
 ,ATX,APP.XPAH.
 ,XTA,.
 ,ATX,ACC.ГAШ.
 ,UJ,STEP... ...
 IF SP:S,UTM,60B - SPACE.
 S,VZM,STEP.ПPOБEЛ
  ERROR:SW,UTM,-FIGURE
  ,XTA,
  TT,VZM,OUT. PASS
  SW,VIM,ERROR1
  T,UTM,-2
  T,VZM,OUT
  ERROR1:T,VTM,C ERR
 ,UJ,DIAGN.
 TYPE:0,OCT,3500
C       BЛEBO ПO 6P
 1,OCT,3640 0000 0007 7770
C       BЛEBO ПO 3P
 2,OCT,3640 0000 0007 7770
 3,LOG,3640 0000 0007 7770.BЛEBO ПO 3P
 4,OCT,3400
C       BЛEBO ПO 8P
 5,OCT,3600 0000 0007 7766
C       BЛEBO ПO 4P
 VV:,BSS,
    1,LOG,4000 0000 0007 7732.-38
    2,LOG,150000000007 7743.-38,-29
 3,LOG,77735.-35
 FUL WOR:,LOG,7777 7777 7777 7777.
 C ERR:,ISO,10HOШ.HAБOP'0'
 ACC:,BSS,1
 APP:,BSS,1
 FLAG:,BSS,1
 WORD:,BSS,1
 PYC:,OCT,.P.Я.
  YC L:,BSS,1
 S/W1:,BSS,1
 S/SW:,BSS,1
 ,END,
 MAKE MT:,NAME,.
C...... ЗAKAЗ БYФEPA HA MД/MЛ
C       1.2.78.  CAПOЖHИKOB.
  *700:B,BLOCK,B48(48)
  BIT30   :,EQU,B48+18
  ABUFSAP :,EQU,2011B
  OPERANDS:,EQU,2007B
 *1:,BLOCK,(1),C,(1),R,AT,W,(1),CA,(4),T
 N CH:,EQU,10
 DELTA:,P*P,(5)(N CH)
 PAБ ЛИCT:,EQU,0
 PAБ ЛИCT:I,BLOCK,(420),***
  NUMBUS:,EQU,714B
 TEK AДP:,EQU,*** + DELTA
 MБ ИHФ:,EQU,TEK AДP + N CH
  ASTR:,EQU,MБ ИHФ +NCH
 RONLY:,EQU,ASTR   +NCH
  FILLEN:,EQU,RONLY+1
 COPYRA:,EQU,FILLEN+NCH
 LPAG:,EQU,COPYRA+NCH
 LASTORD:,EQU,LPAG+NCH
 SC100:,EQU,LASTORD+NCH
 MAXL:,EQU,SC100+1
 *1TAPE:,EQU,MAXL+NCH
 XRS:,EQU,*1TAPE+NCH
 TYP:,EQU,XRS+NCH
 SPB:,EQU,TYP+NCH
 MBINFOWN:,EQU,SPB+NCH
 OLD BUF:,EQU,MBINFOWN+NCH
C  CBOБOДHO:,EQU,OLDBUF+NCH*4. !!!!
 LNRS:,EQU,2000B.
 LNRS:I,BLOCK,
 ,CONT,(3)
 ,CONT,NEXT
 ,CONT,(4)
 ,CONT,DIAGN
C----------------------------
 T,VTM,5.
 R,VJM,OPERANDS.
  /////:R,BASE,/////
  ,ATX,NAMT.ИMЯ MЛ/ДП
 C,MTJ,14
 C,J+M,14
 14,J+M,14.=4*C
 14,ATX,OLD BUF.ЗAПOMHИM
 T,VZM,ПOИCK.MЛ
 T,XTA,
 14,ATX,OLDBUF+1.MACTEP
 T,XTA,1
 14,ATX,OLDBUF+2.ФAЙЛ
 T,XTA,2
 14,ATX,OLDBUF+3.R/W
 ,UJ,FILE
 OLD MT:,ENTRY,
 R,BASE,/////
 ,ATX,NAMT.ИMЯ MЛ/ДП
 14,UTM,OLD BUF+1
 T,VTM,0
 14,XTA,
 ,UZA,ПOИCK.MЛ
 14,MTJ,T.ФAЙЛ
 ,UJ,FILE
  ПOИCK:AT,VTM,TAKET
  GN:,BSS,
  C,XTA,NUMBUS
  ,*50,72100B+117B.B AUS
  T,VTM,14
  ,*57,4040B
  ,AEX,=7777 7777 7777 7777
  ,ASN,64+16
  ,UZA,TO DIAGN
  ,ANX,=7
  ,ATI,T
  AT,UJ,
C--- ЗAXBAT MЛ
  TAKET:,XTA,NAMT
  ,*57,2400B
  T,MTJ,W
  ,UZA,MTABS.HET MЛ
  ,ATX,OTBET
  T,VTM,-1
  :,ASN,64-1.HEГOTOB
  ,ARX,.ИЛИ
  ,UZA,DIAGNRB.ЗAHЯT
  T,VLM,*-1
  ,ITA,14.KOЛИЧECTBO
  C,ATX,FILLEN.ЗOH - 1
  ,XTA,OTBET
  C,ASN,64
  ,ATX,OTBET
  C,*65,B48
  ,ATX,WS
  ,AAX,OTBET
  ,AEX,RONLY
  ,AAX,WS
  ,AEX,RONLY.PEЖИM
  ,ATX,RONLY.ЧT/ЗП
  OKF:,ITA,W
  ,ASN,64-39
  C,ATX,MБИHФ
  ,ASN,64+3
  ,AOX,=2
  ,ATX,NAMT
  ,XTA,CINF
  ,*57,-1
  CA,VZM,NEXT
  CA,UJ,
C---
  DIAGND:T,UTM,5
  ,UJ,DIAGNRB
 MTABS:T,VTM,
 ,UJ,TODIAGN
  DIAGNF:,ATI,T
  DIAGNRB:T,J+M,T
  T,UTM,4
C---
  TODIAGN:T,UTM,PYГAHЬ
  ,XTA,
  C,ATX,TEKAДP
  ,UJ,DIAGN
C---
  FILE:,BSS,
  T,XTA,
  ,ATX,MASTER
  T,XTA,1
  ,ATX,FILNAM
  T,XTA,2
  ,ATX,REGIM
  ,AEX,=6HR
  ,UZA,READONLY
  ,*65,BIT30
  READONLY:,ATX,OTBET
  C,ASN,64-18
  ,ATX,I57
  C,*63,B48
  ,AOX,RONLY
  ,AEX,I57
  ,ATX,RONLY
  AT,VJM,GN
  T,MTJ,W
  ,WTC,ABUFSAP
  C,XTA,
  ,ASN,64+30
  ,ASN,64-10
  ,ATI,AT
  ,XTA,NAMT
  ,AAX,=7777
  ,UZA,TOFS
  14,VTM,NAMT-1
  ,ITA,14
  ,AOX,KEY
  ,ATX,I57
  ,*57,-1.ЗAKAЗ ПAKETA
  ,ASN,64+45
  ,ATI,T.OTBET
  ,U1A,DIAGND
C--- ПAKET O'KEY
C--- БYДEM ЗAПPAШИBATЬ ФAЙЛO
C--- HYЖEH ЛИCT ДЛЯ ЧTEHИЯ KATAЛOГA
C    БEPEM EГO HOMEP ИЗ  BUFSAP.
  ,ITA,AT
  ,ASN,64-14
  ,AOX,=20 0001.CПPABKA
  ,ARX,I57
  ,*57,-1.ЗA CПPABKOЙ
C--- PAЗБOPKA OTBETA
  ,XTA,OTBET
  ,AAX,=40 7777 7777
  ,ATX,ЗAПPOC
  ,ASN,64+12
  ,NTR,3
  ,AAX,=7777
  ,X-A,ЗAПPOC
  ,AAX,=7777
  C,ATX,FILLEN
  ,XTA,OTBET
  ,ASN,64+45
  ,U1A,DIAGNF.HEYДAЧA
  ,ATX,WS.ДЛЯ CЛEД.ПOXOДA
  ,ITA,W
  ,ASN,64-36
  ,AOX,ЗAПPOC
  ,ATX,ЗAПPOC
  ,XTA,I57
  ,ARX,=30 0001
  ,*57,-1.ЗAKAЗ ФAЙЛA
  ,AEX,
  ,UZA,OKF
  ,XTA,ЗAПPOC
  ,ASN,64+42
  ,ATI,T.ФAЙЛ ЗAHЯT ИЛИ
  T,UTM,6.HET MECTA
  ,UJ,TO DIAGN.ЗAHЯT
C
C...   OБPAЩEHИE K ФAЙЛOBOЙ CИCTEME :
C
  TOFS:,XTA,=4
  AT,ATX,.JOB
  ,XTA,MASTER
  AT,ATX,1
  ,XTA,FILNAM
  AT,ATX,2
  ,XTA,REGIM.R,W ИЛИ
  AT,ATX,4.CREATE
  ,ITA,W
  AT,ATX,3.LUN
  ,ASN,64-42
  AT,ATX,5
  ,XTA,NAMT
  ,AAX,=3 0000.NFS
  ,ASN,64-24
  AT,AOX,5
  AT,ATX,5
  ,ITA,AT
  AT,AOX,5
  ,AOX,=17 0470 0000
  ,*52,2.***
  T,VTM,NOPOST-PYГAHЬ
  ,ASN,64+34
  ,U1A,TODIAGN
  AT,ATX,8
  AT,UTC,5
  T,VTM,-PYГAHЬ
  AT,XTA,4
  ,AAX,=7777
  ,U1A,TODIAGN
  AT,XTA,5
  ,AAX,=7777
  C,ATX,FILLEN
  ,UJ,OKF
  NOPOST:,ISO,18HHET ФAЙЛ.CИCTEMЫ''''
C=======================
  PYГAHЬ:,BSS,
  0,ISO,6HMЛ HET
   ,LOG,
  2,ISO,12HHE ГOTOB MФ''
  4,ISO,12HMЛ ЗAHЯTA''''''
  6,ISO,12HHET ДOCTYПA''
  8,ISO,12HHET ФAЙЛA''''''
 10,ISO,12HФAЙЛ ЗAHЯT''''
 12,ISO,12HБPEД COБAЧ.''
 14,ISO,12HCИДИ И ЖДИ''''
  16,ISO,12HHET ПAKETA''''
  18,ISO,12HПAKET ЗAHЯT''
  I57:,Z00,
  ,Z00,NAMT
  KEY:,OCT,6470 7240 40
  CINF:13,070,7240B
  8,37,NAMT
  REGIM:,BSS,1
C=============
  :,LOG,
  NAMT:,BSS,1
  ЗAПPOC:,BSS,
  MASTER:,BSS,1
  WS    :,BSS,
  FILNAM:,BSS,1
  OTBET :,BSS,1
  **//:,OCT,4
  :,OCT,4
 ,END,
 *D71LOAD:,NAME,.
 LIST:,PC,1024.
 NL:,P/P,(LIST)16
 LC:,EQU,LW-FW.
 MONREAD*:,SUBP,.
 KCOUNT*:LC,BLOCK,KC
 ARREAD*:LC,BLOCK,AR
 LOADLIS*:,LC,1
 *8:,BLOCK,B,L
 B,BASE,*.
 ,ITA,13.
 ,ATX,I13.
C.........   ПEPEПИCЬ KAPT HA MБ '06037'
 L,VTM,-LC.
 ,XTA,LOADLIS*
 ,UZA,LOOP
 ,XTA,=6H*
 ,ATX,DAPR
 LOOP:L,XTA,LW.
 L,UTC,LIST+LC.
 ,ATX,.
 L,VLM,LOOP.
 ,DRUM,INF.
C.........   ЗAПOMИHAHИE YKAЗAT. ЧTEHИЯ
 ,XTA,KC.
 ,ATX,AR.
 ,XTA,KC+1.
 ,ATX,AR+1.
C.........   YCTAHOBKA HOBЫX YKAЗATEЛEЙ
 ,XTA,.
 ,ATX,KC.
 ,XTA,=10 0000 0006 0036.
 ,ATX,KC+1.
 ,XTA,=1.
 ,ATX,KC+2.
C.........   TAЩИM ПEPBYЮ KAPTY
 ,WTC,I13.
 13,VTM,.
 ,UJ,MONREAD*.
 INF:,,NL.
 ,006,37B.
 FW:,BSS,.
C      ДЛЯ ЗAБЫBЧИBЫX CИCTEMЩИKOB :
  ,ISO,83H*FIX DRUM:00-27
  ,CONT,1H'12'
 ,ISO,83H*MAIN DEBMULT
 ,CONT,1H'12'
 ,ISO,83H*EXECUTE
 ,CONT,1H'12'
  ,ISO,83H*CALL ALLMEMOR
  ,CONT,1H'12'
 ,ISO,83H*MAIN DD86
 ,CONT,1H'12'
 ,ISO,83H*CALL LDSHIFT
 ,CONT,1H'12'
 DAPR:,BSS,
 ,ISO,83H*CALL DATAPR*
 ,CONT,1H'12'
 ,ISO,83H*EXECUTE
 ,CONT,1H'12'
 ,ISO,83H*READ OLD
 ,CONT,1H'12'
 ,ISO,83H*END FILE
 LW:,CONT,1H'12'
 I13:,BSS,1.
 TP4:,BSS,1.
 ,END,.
 Я6I:,NAME,
 ,ITS,7
 7,BASE,INF
 ,STX,I7
 ,STX,ARRAY
 ,ATX,WORD
 ,ITA,13
 ,ITS,6
 ,ITS,
 14,VTM,-1
 *1:,XTA,
 ,WTC,ARRAY
 14,ATX,1
 13,VTM,-48
 *2:,XTA,WORD
 ,ASN,64-6
 ,ATX,WORD
 ,YTA,
 ,AOX,=I0
 ,NTR,2
 ,E+N,64+3
 15,ATX,
 ,A/X,=R48.0
 ,NTR,3
 ,A+X,=I0
 ,ATI,6
 ,NTR,2
 ,A*X,=R48.0
 15,A-X,
 ,NTR,3
 ,A+X,=I0
 6,UTC,TABLE*6
 ,XTS,
 15,WTC,
 ,ASN,64
 ,AAX,=:776
 13,ASN,64+48
 ,WTC,ARRAY
 14,AOX,1
 ,WTC,ARRAY
 14,ATX,1
 13,UTM,8
 13,VIM,*2
 14,VLM,*1
 ,XTA,I7
 ,STI,7
 ,STI,6
 ,STI,13
 ,NTR,6
 13,UJ,
 INF:,BSS,
 TABLE*6:,ISO,20H  БЦДФГИ  *ЙЛЯЖ/0123
 ,CONT,16H456789Ь'72'П-+ЫЗABC
 ,CONT,20HDEFGHIJKLMNOPQRSTUVW
 ,CONT,8HXYZШЭЩЧЮ
 I7:,BSS,1
 WORD:,BSS,1
 ARRAY:,BSS,1
 ,END,Я6I
 DISPLOAD:,NAME,. 06.02.77
  LOADLIS*:,LC,1
 Я6I:,SUBP,.TEXT TO ISO
 PRINT8//:,SUBP,.ДYБHA
 PRINT8:,SUBP,
 DATAPR*:,SUBP,
 DATE*:,SUBP,
 MONITOR*:,SUBP,
  BAS/DR:,EQU,120B
 /412/:PC,BLOCK,TRP(2048), B(5120)
 LL:,P/P,(TRP)16
 LINE:I,BLOCK,ADR, ADRO
 ,CONT,EL(2),OLD
 ,CONT,OLDA
 7,BASE,*
 ,*70,IW1
 6,VTM,TRP
 6,XTA,
 ,AEX,MON
 ,UIA,SCHEISE
 2,VTM,0.HOMEP PEЗEPBA
 ,*70,IW2
 14,VTM,-2
 */*:14,UTC,/412/+2047
 ,XTA,
 ,UZA,NO COMM
 14,UTC,HEAD+2
 ,ATX,
 14,VLM,*/*
 NO COMM:,BSS,
 3,VTM,
  ,XTA,LOADLIS*
 ,UZA,HET
 3,VTM,-1
 HET:,BSS,
 M LOOP:,BSS,
 6,VTM,TRP
 6,XTA,2044
 ,ASN,64+30
 ,ATI,14
 ,ASN,64+1
 ,ARX,=1
 ,AAX,=1777
 ,ATX,SS4
 ,XTA,KOH1
 14,ATX,TRP
 ,XTA,KOH2
 14,ATX,TRP+1
  14,VTM,-100
 8,VTM,
 /SS:,BSS,
 6,UTM,2
 6,XTA,1
 ,AAX,=77777
 ,AEX,=1000
 ,UZA,TYT
 14,VLM,/SS
 SCHEISE:,*64,SCHINF
 ,SJ,
 TYT:,BSS,
  14,UTM,101
 ,XTA,SS4
 ,NTR,3
  ,ITS,14
 15,X-A,
 ,ATX,SS4
 ,ATI,4
 5,VTM,B
 QQ:4,VZM,FIN**
 1,VTM,QQ
 6,XTA,
 ,AEX,KOH1.**KOHEЦ*
 ,UZA,*KOH.
 8,VZM,BEG1
 6,XTA,1
 ,AAX,=1777
 ,U1A,ELEM.
 6,XTA,
 ,AEX,CEND.ДИCПHAMБ
 ,UZA,END1
 *KOH:,BSS,
 6,XTA,1
 ,AEX,OLDA
 ,AAX,=77777
 ,UZA,ELEM
C.....   ПOДГOTOBKA CПEЦ-ЭЛEMEHTA
 ,ITA,2.
 ,ASN,64-42.
 ,AUX,MA8/1.
 ,AOX,REN.
 ,ATX,EL
 ,XTA,OLD
 ,ASN,64+15
 ,ARX,OLD.
 ,AAX,=77777
 15,ATX,
 6,XTS,1
 ,AAX,=77777
 ,ATX,OLDA
 ,NTR,3.
 15,A-X,.
 ,ASN,64-15
 15,AOX,.
 ,AOX,=:000001
 ,ATX,EL+1.
 ,ITA,6.
 ,XTS,.
 6,VTM,EL
 1,VJM,ELEM
 ,XTA,SS4
 ,ARX,=1
 ,STX,SS4
 ,ATI,6.
 1,VTM,QQ
 2,UTM,1.
  4,UTM,1
 ,UJ,ELEM
 END1:8,VTM,
 ,UJ,ELEM
 BEG1:6,XTA,
 ,AEX,ERES.ERES*1
 ,U1A,ELEM
 8,VTM,1
 ELEM:,BSS,
 6,XTS,.
 ,ITS,5.
 ,CALL,Я6I.ИMЯ OБ'EKTA
 ,XTA,=H
 5,ATX,4
C....  ПEPEXOД OT 64000 K 70000
  6,XTA,1
  ,AAX,=77777
  ,ATI,14
  ,ARX,=1 4000
  ,AAX,=70 0000
  :,UZA,*+1.<64000
  14,UTM,4000B
  :,ITA,14
  ,ASN,64-33
 ,ATX,ADR
 ,ASN,64+45
 ,AOX,=20
 5,AOX,1
 5,ATX,1
 ,XTA,ADR
 ,ASN,64-3
 ,AUX,MA8
 ,AOX,DA8/1
 5,ATX,2.AДPEC ЗAГPYЗKИ
 6,XTA,1
 ,APX,=7 7777 0 0000
 ,ATX,LEND
 ,AUX,MA8
 ,AOX,DA8
 5,ATX,3.ДЛИHA OБ'EKTA
 ,XTA,LEND.
 ,UZA,ENTRY.
 6,XTA,1.
 ,ASN,64+30
 ,UIA,EX1
 ,UJ,SIS.
 ENTRY:6,XTA,1
 ,ASN,64+30
 ,U1A,EX1.
 ,XTA,ADR
 ,ASN,64+33
  ,NTR,3
 ,A-X,ADRO
 ,UZA,SIS.
 5,XTA,1
 ,AEX,=6H'''''' ''''
 ,AOX,=6H''''''E''''
 5,ATX,1
 ,XTA,=H
 5,ATX,3
 5,ATX,4
 3,V1M,EX2.
 5,XTA,2
 ,AEX,=40
 ,AOX,=6H''''''''''=
 5,ATX,2
 ,XTA,MAIN
 5,ATX,3.ИMЯ ГЛABHOГO
 ,XTA,MAIN+1. BXOДA
 ,AAX,=6H'377''377'''''''''
 ,AOX,=6H''''
 5,ATX,4....
 ,UJ,EX2
 SIS:5,XTA,1.
 ,AEX,=6H'''''' ''''
 ,AOX,=6H''''''C''''
 5,ATX,1
 EX1:,BSS,
 6,XTA,1
 ,ATX,OLD.
 EX2:,BSS,.
 ,XTA,LEND
 ,UZA,*10
 ,XTA,ADR
 ,ARX,LEND
  ,ASN,64+33
 ,ATX,ADRO
 5,XTA,.
  ,ATX,MAIN
 5,XTA,1
 ,ATX,MAIN+1
 *10:,BSS,
 6,UTM,2
 4,UTM,-1
 5,UTM,5
 1,UJ,.
 FIN**:,BSS,
 BEGIN:,BSS,
 ,XTA,
 ,CALL,DATAPR*
 14,VTM, HEAD
  2,VTM,-1
  14,XTA,
  ,AEX,=6HДИCПET
  ,ATI,13
  ,XTA,BAS/DR
  13,VZM,TOPRI
  ,ASN,64-6
  ,YTA,
  ,ASN,64-6
  ,AOX,BAS/DR
  ,ASN,64-36
  TOPRI:,BSS,
  ,AUX,=6H'''7''7''7''7'''
  ,AOX,=6H 0000
  14,ATX,4
  ,ITS,14
  14,UTM,4
  ,ITS,14
  ,XTS,=12
 ,CALL,PRINT8//
 4,VTM,-1
 LL/:14,VTM,=6H
 ,ITS,14
 ,ITS,14
 ,XTS,=3
 ,CALL,PRINT8//
 4,VLM,LL/
 ,XTA,KK
 ,ATX,K
 3,VIM,OL
 ,NTR,3
 ,WTC,SS4
 4,VTM,-1
 5,VTM,B-5
 Y1:4,VZM,OL
 5,UTM,5
 5,MTJ,9
 4,MTJ,8
 Y2:8,VZM,Y*1
 9,UTM,5
 5,XTA,
 ,ASN,64+8
 9,XTS,
 ,ASN,64+8
 15,X-A,
 ,UIA, NO EX
 ,AOX,
 ,UZA,DOP
 SM:,BSS,
  14,VTM,-4
 *11:14,UTC,4
 5,XTA,
 14,UTC,4
 9,XTS,
 14,UTC,4
 5,STX,
 14,UTC,4
 9,ATX,
 14,VLM,*11
 NO EX:,BSS,
 8,UTM,-1
 ,UJ,Y2
 Y*1:,BSS,
 4,UTM,-1
 ,UJ,Y1
 OL:,BSS,
  5,VTM,B
 ,XTA,SS4
 ,ATI,4
 ,ASN,64-2
 ,ARX,SS4
 ,ITS,5
 15,ARX,
 ,ATX,MAX A
 ,WTC,MKK
 6,VTM,
 GOOD:,BSS,
 PL*:,ITA,5
 ,NTR,3
 ,X-A,MAX A
 ,UIA,END.
 14,VTM,-4
 *PT:5,UTC,
 14,XTA,4
 14,UTC,4
 ,ATX,LINE
 ,ITA,5
 ,ARX,K
 ,AAX,=77777
 ,NTR,3
 ,X-A,MAX A
 ,UIA,SPACE
 ,WTC,K
 5,UTC,
 14,XTA,4
 *44:14,UTC,4
 ,ATX,LINE+5
 14,VLM,*PT
 14,VTM,LINE
 ,ITS,14
 14,UTM,9
 ,ITS,14
 ,XTS,=3
 5,UTM,5
 ,CALL,PRINT8//
 6,VLM,GOOD
 ,WTC,K
 5,UTM,
 2,UTC,2
 ,WTC,MKK
 6,VTM,
 2,UTC,2
 ,XTA,KK
 ,ATX,K
 2,VLM,EE
 EE:,BSS,
 ,UJ,GOOD
    END:,BSS,
 13,VJM,PRINT8//+1
 3,VLM,M LOOP
 ,UJ,MONITOR*+1
 SPACE:,XTA,=6H
 ,UJ,*44
 DOP:,BSS,
 5,XTA,
 ,ASN,64-40
 5,XTS,1
 ,ASN,64+8
 15,AOX,
 ,ASN,64+24
 9,XTS,
 ,ASN,64-40
 9,XTS,1
 ,ASN,64+8
 15,AOX,
 ,ASN,64+24
 15,X-A,
 ,UIA,NO EX
 ,UJ,SM
 IW1:,010,LL
 ,000,34B
 IW2:,010,LL+100B
 ,000,35B
 SCHINF:,,TSCH
 ,,TSCH
 :,001,
 8,,
 KK:,INT,310
 ,INT,325
 ,INT,330
 MKK:,INT,-61
 ,INT,-64
 ,INT,-65
 MA8:,GOST,6H777770
 MA8/1:,LOG,707
 ERES:,TEXT,8HERES*1
 CEND:,TEXT,8HДИCПHAMБ
 REN:,TEXT,8H******00
 KOH1:,TEXT,8H**KOHEЦ*
 KOH2:,LOG,1 00000 74000
 HEAD:,ISO,18HДИCПETЧEP OC ДYБHA
  ,ISO,12H  : MБ 2013
 DA8:,ISO,6H00000
 DA8/1:,ISO,6H0000
 MON:,TEXT,8HMONITOR*
 TSCH:,GOST,20HOШИБOЧHOE OБPAЩEHИE
 ,CONT,13HK DISPLOAD '133''231'
 MAIN:,ISO,12H
 LINE:,BSS,10
 SS4:,BSS,1
 K:,BSS,1
 MAX A:,BSS,1
 LEND:,BSS,1
 ,END,
 PAЗHИЦA:,NAME,
 TODAY:,LC,1
 CHEKMDFL:,EQU,512B
 NRTABL:,EQU,11B
  KOHHИЗ:,LC,
  *NRP1 :,LC,
   ///:,EQU,KOHHИЗ-*NRP1
   ////:,P/P,(///)1024
  LNRT:,EQU,////+1
  /NRP1:,EQU,524B
  /KH  :,EQU,525B
  DISPBASE:,LC,2
  MTP:,EQU,77B
  * И П Д :LC,BLOCK,XNF,XNFM(4),XNC,XNCM
  NMAT1:,WEQ,XNF
  NMATJ:,WEQ,XNFM
  NMAT :,WEQ,XNCM
  *100:B,BLOCK,WOR,INF,MTF
 L1:1,BASE,L1
 ,*65,3
CБPOШEHHЫЙ PAБ.ДИCП.
CИДИT HA MБ, HOMEP KOTOPOГO
COCTABЛЯЮT 1-5 P. 3 T.P.
 ,ATX,WOR
 ,AAX,=37
 ,ASN,64-12
 ,AOX,INFRA
 ,ATX,INFRA
  ,ARX,=:0000 03
  ,ATX,MTF
 ,XTA,WOR
 ,APX,=3737 0000
 ,AUX,=37 0037
 ,U1A,L2
  ,*65,DISPBASE+1
C...HECTAHДAPTHЫЙ ЭTAЛOH ДИCПETЧEPA
C...YKAЗЫBAETCЯ B 13-24 P. 3 T.P.
 L2:,AOX,INFET
 ,ATX,INFET
  ,ARX,=:0000 01
  ,ATX,INF
 ,APX,=37 0037
 ,AUX,CNMБ
 ,ARX,ЭД
C...БAЗA ЭTAЛOHA
 ,ATX,ЭД
 ,XTA,=:0004
 ,*76,KOHTP
 2,VTM,-3
 ,DRUM,INF
  3,VTM,10000B
  4,VTM,-4
C...   ЧTEHИE 0-4 ЛИCTOB ДAMПA
C      B 4-10 ЛИCTЫ ПAMЯTИ
  RDUMP:,BSS,
  ,DRUM,MTF
  ,XTA,=100 0000 0001
  ,ARX,MTF
  ,ATX,MTF
  4,VLM,RDUMP
  ,FUN,71B
  ,XTA,WOR
  ,AAX,=:0000 02
  ,UZA,NOMT
  3,XTA,MTP
  NOMT:,ATX,MTF
  ,*63,DISPBASE+1
CTAPAЯ БAЗA ДИCПETЧEPA
 ,APX,=37 0037
 ,AUX,CNMБ
 ,ARX,PД
 ,ATX,PД
CЧETЧИK AДPECOB B ДИCПETЧEPE
 4,VTM,100B
 ,*65,TODAY
 ,ASN,64-5
 ,AUX,CDAT
 ,ARX,DAT1
C...PACФACOBKA ДATЫ
 ,ATX,DAT1
 2,VTM,-1677B
 ,*65,TODAY
 ,ASN,64-16
 ,AUX,CDAT1
 ,ARX,DAT2
 ,ATX,DAT2
 8,VTM,C3
C...ПEЧATЬ OБOИX БAЗ, ДATЫ И BPEMEHИ
 ,PRINT,ЗAГЛAB
   5,VTM,*2R
 6,VTM,-3
 7,VTM,ADR1
  ,XTA,/NRP1+6000B
 ,ASN,64+10
  ,AAX,=37
 ,ATI,9
 ,ATI,12
  11,VTM,
 10,VTM,
C...PAБ.ДИCП. ЧИTAETCЯ HA 1-Й ЛИCT
C...     ЭTAЛOH - HA 2-Й ЛИCT
 READ:,XTA,=:0004
 ,*76,KOHTP
 ,ITA,11
 ,ARX,INFRA
 ,ATX,INF
 ,DRUM,INF
 ,XTA,2000B
 ,ITA,10
 ,ARX,INFET
 ,ATX,INF
 ,XTA,
 ,*76,KOHTP
 9,UTM,-1
 ,DRUM,INF
 LOOP:2,XTA,3777B
 2,AEX,5777B
COBПAДEHИE C ЭTAЛOHOM
 ,UZA,LOOP1
 ,XTA,WOR
 ,AAX,=:0000 01
C...MAЛAЯ PAЗHИЦA
 ,UZA,П1
 2,XTA,5777B
 ,UZA,LOOP1
C...B БYФEP ДЛЯ ПEЧATИ
 П1:,ITA,4
 7,ATX,
 2,XTA,5777B
 7,ATX,C2-ADR1
 ,ASN,64+24
 7,ATX,C1-ADR1
 2,XTA,3777B
 8,ATX,C4-C3
 ,ASN,64+24
 8,ATX,
 7,UTM,ADR2-ADR1
 8,UTM,C5-C3
 6,VLM,LOOP1
 13,VTM,LOOP1
 PRINT BUF:,BSS,
C...ПEЧATЬ БYФEPA
 7,VTM,ADR1
 ,PRINT,INFP1
 8,VTM,C3
 ,PRINT,INFP2
 6,VTM,-3
 13,UJ,
 LOOP1:4,UTM,1
CЛEДYЮЩИЙ AДPEC B ДИCПETЧEPE
 2,VLM,LOOP
 2,VTM,-1777B
 11,UTM,1
 10,UTM,1
 9,V1M,READ
C...ПPOCMOTPEHO ПOЛ-PEЗИДEHTA
  5,MTJ,13
  ,UJ,PRINTBUF
  *2R:,BSS,
 11,VTM,34B
  ,XTA,/KH+6000B
 ,ASN,64+10
 ,ATI,10
 10,UTM,1
 4,VTM,70000B
 9,VTM,4
   5,VJM,READ
  3,VTM,1-LNRT
C...ПOШЛИ ГYЛЯTЬ ПO HEPEЗИДEHTY
  TO NRP:,BSS,
  ,UTC,10000B
  12,XTA,NRTABL
 ,AAX,=37
 ,ATI,11
 12,MTJ,10
 9,VTM,1
  ,UZA,NEXTNRP
  ,PRINT,ANRP
  ,ITA,12
  ,ASN,64-10
  ,ATI,4
  5,VJM,READ
  NEXTNRP:12,UTM,1
  4,UTM,2000B
  ,XTA,NRP
  ,ARX,=400
  ,ATX,NRP
  ,AEX,NRP10/
  ,U1A,NO10
  ,XTA,NRP10
  ,ATX,NRP
  NO10:3,VLM,TONRP
C..... ПEЧATЬ ИПЗ
  ,XTA,HEAD1
  ,ATX,STR1.ЗAГOЛOBOK
  3,VTM,-NMAT
  ,WTC,6502B
  8,VTM,.AДP.ГYC-A
  PRIPZ:8,UTC,NMATJ+7777B
  3,XTA,NMAT
  ,AAX,=76000.A ИПЗ
  ,UZA,EPRI.ИПЗ HET
  ,ATI,4
  2,VTM,-1777B
  LPL:6,VTM,-3
  13,VJM,PRINTLIS
  EPRI:3,VLM,PRIPZ
C..... ПEЧATЬ PAБ.ЛИCTA MT.
  ,XTA,MTF
  ,UZA,STOP.HE TPEБYETCЯ
  ,ATI,4.HAЧ.AДPEC
  ,XTA,HEAD2
  ,ATX,STR1.ЗAГOЛOBOK
  6,VTM,-3
  13,VTM,STOP
C.... ПOДПP-MA PACПEЧATKИ 1 ЛИCTA
  PRINTLIS:,ITA,4
  ,ASN,64+10
  ,ARX,INFRA
  ,ATX,INF
  ,XTA,=:0004
  ,*76,KOHTP
  7,VTM,ADR1
  ,*70,INF
C---
  LOOP/:2,XTA,3777B
  ,UZA,LOOP//
  7,ATX,C2-ADR1
  ,ASN,64+24
  7,ATX,C1-ADR1
  ,ITA,4
  7,ATX,
  7,UTM,ADR2-ADR1
  6,VLM,LOOP//
  ,PRINT,INFP1
  7,VTM,ADR1
  6,VTM,-3
  LOOP//:4,UTM,1
  2,VLM,LOOP/
  ,XTA,
  ,*76,KOHTP
  2,VTM,-1777B
  ,PRINT,INFP1
  13,UJ,
C---
  STOP:,SJ,
  HEAD1:,GOST,4HИПЗ'231'
  HEAD2:,GOST,4HMLT'231'
 KOHTP:,WTC,CHEKMDFL
 ,ATX,
 ,MTJ,27B
 2,IJ,
 ANRP:,,NRP
 ,,NRP
 :,002,
 8,004,
 NRP:,GOST,6HNRP 1'231'
  NRP10/:,GOST,6HNRP +'231'
  NRP10 :,GOST,6HNRP10'231'
 ЗAГЛAB:,,DAT1
 ,,ЭД
 :,020,
 8,064,
 DAT1:,GOST,6H00.00.
 DAT2:,GOST,6H00
 ,GOST,12H PAБ. ДИCП.-
 PД:,GOST,6H0000
 ,GOST,12H ЭT. ДИCП.-
 ЭД:,GOST,6H0000'231'
 INFP1:,,STR1
 ,,ESTR1
 :0,001,
 ,003,
 :2,005,5
 ,005,
 :2,013,8
 ,011,1
 :2,040,5
 ,005,
 :2,046,8
 ,011,1
 :2,073,5
 ,005,
 :2,101,8
 ,011,1
 :2,126,5
 ,005,
 :2,134,8
 8,011,1
 INFP2:,,STR2
 ,,ESTR2
 :0,001,
 ,003,
 :2,013,8
 ,011,1
 :2,046,8
 ,011,1
 :2,101,8
 ,011,1
 :2,134,8
 8,011,1
 STR1:,GOST,4HЭT.'231'
 ADR1:,BSS,1
 C1:,BSS,1
 C2:,BSS,1
 ADR2:,BSS,1
 ,BSS,7
 ESTR1:,BSS,1
 STR2:,GOST,4HCP.'231'
 C3:,BSS,1
 C4:,BSS,1
 C5:,BSS,1
 ,BSS,4
 ESTR2:,BSS,1
 CDAT1:,GOST,6H'17''17'''''''''
 CDAT:,GOST,6H'3''17''''1''17'''
 CTIM:,GOST,6H'17''17''''17''17'''
 CNMБ:,GOST,6H'3''7''3''7'''''
 INFRA:,014,100B
 ,,
 INFET:,014,200B
 ,,
 ,END,
 OCTOPOЖH: ,NAME,
C
C********   ПPOГPAMMA - 'OCTOPOЖHO'
C---BEPETEHOB-ГOЛYБEB ЛETO 1973 K, ИH-T AKYCTИKИ--
C---HOCЛOBHAЯ ПEPEПИCЬ C ПOCЛEДOBATEЛЬH-81MИ-----
C---ПPEPЫBAHИЯMИ OCHOBHOГO ЦИKЛA ДЛЯ---------
C---BЫПOЛHEHИЯ PAЗЛИЧHЫX PAБOT---------------
C
C--- '1' B 16-M PAЗPЯДE T.P.3 ЗAДAET
C--- CДBИГ ФAЙЛA HA 1000 ЗOH ---
 B42:,EQU,=:004
 BIT1:,EQU,757B
 B1:,EQU,=1
 DINF:,EQU,INFD
 TINF:,EQU,INFT
 LIST:,EQU,2000B
  LIST1:,EQU,4000B
 EL:,P/P,(LIST)16
 ДHЗ:,LC,1
  TABLEMT:LC,BLOCK,(16),T1MT
 ATT:,EQU,LIST+1776B
 ND:,EQU,5.ЧИC. ПPOBEPOK MБ
 *1:,BLOCK,B,L,/H,/D,/1,R
 *1700:B,BLOCK,WS,INF3,KOHБИБ
 ,CONT,INFC,INF,LIBINF
 *2:,BLOCK,PR,PW,NSL,N40,TSK,FR,CN
 C:,BSS,
 B,BASE,*
 ,*65,3
 ,ASN,64-33
 ,ATX,WS
 ,ARX,BIT46
 ,U1A,ERROR.OШ. N HAПP.
 ,XTA,WS
 ,ASN,64+42
 ,ATI,L.ФИЗ. N MФ
 L,*65,T1MT-30B
 ,ASN,64+36
 ,U1A,ERROR.MЛ ЗAHЯTA
 ,XTA,WS
 ,AUX,MAS MT
 ,AOX,INFT.ИHФ. CЛOBO
 ,ATX,INFT
 ,AOX,B42
 ,ATX,INF3
  ,*65,3
  ,AAX,=10 0000
  ,ASN,64+6
  ,AOX,INFT
  ,ATX,INFT
  ,ARX,=77
  ,ATX,T/MON
 ,*76,ДAЙИMЯ
 PR,VTM,2000B
 PW,VTM,
 N40,VTM,
 NSL,VTM,3401B
 TSK,VTM,TASK1
 FR,VTM,1
 15,VTM,10000B
 ,CTX,.KOHTPOЛЬ KOMAHДЫ
C***OCHOBHOЙ ЦИKЛ*************
 RW40:,BSS,
 NSL,V1M,*1
 N40,VZM,NO40
 N40,UTM,-1
 NSL,VTM,32
 *1:,BSS,
 FR,VZM,CHCK
C---ДAЙ CЛOBO---
 PR,MTJ,14
 14,UTM,-1024
 14,V1M,ROLDT
 ,TAPE,TINF
 ,XTA,TINF
 ,ARX,B1
 ,ATX,INFT
 PR,VTM,
 ROLDT:,BSS,
 PR,XTA,LIST
 PR,UTM,1
 CHCK:,BSS,
 NSL,UTM,-1
 NSL,V1M,WW
 NO40:,BSS,
 TSK,UTC,
 N40,VZM,
 N40,UTM,-1
 NSL,VTM,40B
 WW:,BSS,
C   ЗAПИCЬ CЛOBA
 PW,MTJ,14
 14,UTM,-1024
 14,V1M,WOLDT
 PW,VTM,
 ,XTS,
 ,DRUM,DINF
 ,XTA,DINF
 ,ARX,=7741
 ,AAX,MINF
 ,STX,DINF
 WOLDT:,BSS,
 PW,ATX,LIST+1024
 PW,UTM,1
 ,UJ,RW40
C***********************
 AWAY:,BSS,
  12,VTM,BAD SYS
  ,TAPE,T/MON.LIST
  ,XTA,LIST+111B
  ,AEX,MNT
  ,U1A,DIAGN
  ,DRUM,S/CAT.LIST1
  ,XTA,LIST1+1400B
  ,AEX,MNT
  ,U1A,DIAGN
  ,XTA,LIST1+1401B
  ,ASN,64-3.ЧИCЛO
  ,ASN,64+38.CBOБ.ЗOH
  ,UZA,DIAGN
  ,XTA,LIST1+1403B
  ,ASN,64-3.HAЧAЛO
  ,ASN,64+38.CTATИKИ
  ,NTR,3
  ,A-X,=1041.MИHYC 1 ЗOHA
  ,ASN,64-38
  ,AUX,=37 0037
  ,AOX,W/MON
  ,ATX,WS
  ,ASN,64-38
  ,AUX,=6H'3''7''3''7'''''
  ,AOX,=6H0000''''
  12,ATX,2
  ,DRUM,WS
  DIAGN:,ITA,12
  ,FUN,76B
 ,XTA,FULWOR
 ,AEX,B1
 ,ARX,DINF
 ,AAX,MINF
 ,ATX,DINF
 CH2:,XTA,INF0
 ,ATX,INFC
  CH3:12,VTM,SYSDAT
  ,DRUM,INFC
 ,XTA,INFC
 ,ARX,=7741
 ,AAX,MINF
 ,ATX,INFC
 ,AEX,INFD
 ,ASN,64-30
 ,U1A,CH3
 ,DRUM,INFTT
 ,XTA,ATT
 ,ATX,DAT
 ,XTA,ATT+1
 ,ATX,DAT+1
  FINISH:,ITA,12
  ,FUN,76B
  ,*62,
  ERROR:12,VTM,=6HTP-3?''
  ,UJ,FINISH
  ДAЙ ИMЯ :,BSS,
 ,MTJ,27B
 ,XTA,ДHЗ
 ,ASN,64-42
 ,AOX,BIT1
 L,ATX,T1MT-30B
 14,VTM,INF3
 ,UJ,570B
C---БЛOKИ PAБOT---
C---ЗAПOMИHAHИE ИHФ. OVERLAY'Я---
 TASK1:,BSS,
 TSK,VTM,TASK1/
 NSL,VTM,1
 15,ATX,
 ,AEX,MNT
 ,UZA,**
 NSL,VTM,
 N40,VTM,250B
 TSK,VTM,TASK2
 ,XTA,
 ,ATX,INF
 **:,BSS,
 ,STX,
 ,UJ,WW
 TASK1/:,BSS,
 ,ATX,INF
 NSL,VTM,37B
 N40,VTM,247B
 TSK,VTM,TASK2
 ,UJ,WW
C---ЗAПOMИHAHИE CBOБ. MEC0A БИБЛ.---
 TASK2:,BSS,
 ,CTX,1.OTKЛЮЧEHИE KK
 ,ATX,LIBINF
 NSL,VTM,3
 TSK,VTM,TASK3
 CN,VTM,1-1023
 ,UJ,WW
C---KOPPEKTИPOBKA KATAЛOГA---
 TASK3:,BSS,
 15,ATX,
 ,AAX,=:2
 ,UZA,NOFIS
 ,XTA,=:4
 NOFIS:,BSS,
 15,AOX,
 NSL,VTM,2
 CN,VLM,WW
 ,XTS,LIBINF
 ,NTR,3
 ,A-X,=2122000
 ,NTR,16
 ,ASN,64+5
 ,STI,N40
 TSK,VTM,TASK4
 NSL,VTM,
 ,UJ,WW
 TASK4:,BSS,
C---PEAЛИЗAЦИЯ PAЗPЫBA COMMON-OVERLAY---
 ,XTS,INF
 ,U1A,*2
 ,STX,
 ,UJ,END
 *2:,BSS,
 ,ASN,64+30
 ,STI,N40
 TSK,VTM,TASK5
 FR,VTM,
 ,UJ,WW
 TASK5:,BSS,
C---ПEPEПИCЬ OVERLAY---
 FR,VTM,1
 ,XTS,INFD
 ,APX,=770037
 ,ASN,64+27
 ,ITS,PW
 15,AOX,
 ,ARX,B1
 ,XTS,INF
 ,AAX,=77777 00000
 ,ASN,64+5
 ,ARX,=21 00000
 ,NTR,3
 15,A-X,
 ,NTR,16
 ,ASN,64+5
 ,STI,N40
 TSK,VTM,END
 ,UJ,WW
C   ДOCБPOC БYФEPA---
 END:,BSS,
 FR,VTM,
 NSL,VTM,1
 TSK,VTM,END1
 ,UJ,WW
 END1:,BSS,
 PW,VTM,2000B
 NSL,VTM,1
 TSK,VTM,AWAY
 ,UJ,WW
  INFTT:,014,EL
 ,021,10B
 INFT:,014,EL
 , ,0
 INFD:,004,EL+64
 ,021,
 INF0:,014,EL
 ,021,10B
 SYSDAT:,ISO,10HCИCTEMA OT
 DAT:,BSS,2
 MNT:,TEXT,8HMONITOR*
 FULWOR:,LOG,7777 7777 7777 7777
 BIT46:,OCT,1
 MASMT:,LOG,77 0777
 MINF:,LOG,7777 7777 7777 0037
  BAD SYS:,ISO,18HCИCTEMA ИCПOPЧEHA''
   OK SYS:,ISO,18HMOHИTOP HA  2137''''
  S/CAT:,014,EL+64
  ,021,1
  W/MON:,004,EL
  ,,
  T/MON:,BSS,1
 ,END,
 ПPOOБMEH:,NAME,
C
C*********          ПPOГPAMMA OБMEHA BHEШHИX HAKOПИTEЛEЙ
C
C******* PEДAKЦИЯ OT 10.9.76 *******
C
C   KOЛ-BO ЗOH ЗAДAETCЯ B 31-40 PAЗPЯДAX
C   / T.E. MOЖHO БOЛЬШE 1000 ЗOH /
C
C    1  B 41 PAЗPЯДE - CДBИГ ФAЙЛA ЗAПИCИ HA 1000 ЗOH
C    1  B 42 PAЗPЯДE - CДBИГ ФAЙЛA ЧTEHИЯ HA 1000 ЗOH
C
C    1  B 43 PAЗPЯДE - ЗAПИCЬ HA MOДEЛЬ MЛ
C    1  B 44 PAЗPЯДE - ЧTEHИE C MOДEЛИ MЛ
C   / B ЭTИX CЛYЧAЯX HOMEP YCTPOЙCTBA - БAPAБAHHЫЙ /
C
 A ГYC:,EQU,502B.
 A TMT:,EQU,504B.
  ATNMT:,EQU,505B
 A TELOUT:,EQU,510B.
 *100:B,BLOCK,
 ,CONT,WS,WS1,WS2,BUF(6)
  ,CONT,(6),ИHФ,ДHЗ,TP3,ИCЧT(3),ИCЗAП(3),(6)
 DB:,EQU,2 523B.
 7,BASE,*
 ,*65,3
 ,ATX,TP3
C         ПPOBEPKA KOЛ-BA ЗOH/TPAKTOB
 ,ASN,64+30
  ,AAX,=1777
 ,UZA,OШИHФ.PABHO 0
 ,NTR,3
  ,X-A,=1640
 ,U1A,OШИHФ.БOЛЬШE 1000B
  ,A-X,=1637
 ,ATI,1.KOЛ-BO ЗOH/TPAKTOB
  ,*65,ATMT
  ,ATI,10.T1MT
  ,*65,ATNMT
  ,ATI,11.TANAMEMT
  ,*65,AГYC
  ,ATI,3
  3,*65,
  ,AAX,=:77
  ,ATX,ДHЗ
 ,XTA,TP3.
 ,AAX,B48/46.
 ,AEX,B48/46.
 ,ATX,WS.
 ,AEX,BIT46.
 ,ATX,WS2.
  2,VTM,ИCЧT
  12,VTM,-47
  ,XTA,TP3
  3,VJM,FORMNP
  13,VTM,3.OШHAБ
  15,VTM,200B.MAГAЗИH
 ,XTA,TP3
 ,ASN,64-18
 4,VTM,=14 01.
 3,VJM,TPИC. OБPAБOTKA YKAЗATEЛEЙ ЧTEHИЯ
 4,VTM,=14 02.
 ,XTA,WS2.
 ,UZA,CHEK1.
 4,VTM,=04 01.
 CHEK1:,BSS,.
  2,VTM,ИCЗAП
  ,XTA,TP3
  ,ASN,64-1
  3,VJM,FORMNP
  8,VTM,-11
 ,XTA,TP3
 ,ASN,64-33
 3,VJM,TPИC. OБPAБOTKA YKAЗATEЛEЙ ЗAПИCИ
 ,XTA,WS.
 ,U1A,ЦИKЛ.
  Ц0:8,XTA,ИCЧT+11
  8,ATX,BUF+11
 8,VLM,Ц0.
 8,VTM,76103B.
 ЦИKЛ:,BSS,
  9,VTM,
  ,XTA,ИCЧT+7
  ,AEX,ИCЗAП+7
  ,U1A,ЦИKЛ1
  ,ATX,ИCЧT+7
  ,ATX,ИCЗAП+7
  ЦИKЛ1:,BSS,
C.........ЦИKЛ ПEPEПИCИ C BY HA BY
 2,VTM,ИCЧT
 3,VJM,OБMEH. ЗA ЧTEHИEM
 ,XTA,WS.
 ,U1A,NODIS2.ПEPEПИCЬ HE ДИCПETЧEPA
 9,V1M,DIS1.AДPEC DISPBASE ECTЬ
 ,XTA,DB.
 ,ASN,64+10.
 ,AAX,=37.
 ,ARX,ИHФ.ИC OБMEHA (DISPBASE)
 ,ATX,WS1.
 ,XTA,DB.
 ,AOX,=76000.
 ,AEX,=74000.
 ,ATI,9.
 DIS1:,XTA,WS1.
 ,AEX,ИHФ.
 ,U1A,DIS2.HE TPAKT C DISPBASE
C.........   ПPABKA БAЗЫ ДИCПETЧEPA
 ,XTA,BUF+3.
 ,AUX,ИHФMБ.
 ,AOX,=:0004.
 9,ATX,1.
 ,XTA,BUF+3.
 ,AUX,=70 0000 0000 1774.
 9,ATX,.
C.........   ПOДCЧET KOHTPOЛЬHOЙ CYMMЫ
 DIS2:,XTA,KC.
 ,ARX,KC.
 ,ARX,KC.
 8,ARX,3777B.
 ,ATX,KC.
 8,VLM,DIS2.
 8,VTM,1-1024.
 NODIS2:,BSS,.
 2,VTM,ИCЗAП
 3,VJM,OБMEH. ЗA ЗAПИCЬЮ
 ,XTA,WS2.
 ,UZA,CHEK2.
 KЦ:,BSS,.
  1,VLM,ЦИKЛ1
 ,XTA,WS.
 ,UZA,DIS3.
 ,SJ,.
 DIS3:,BSS,.
C.........   BHECEHИE KOHTPOЛЬHOЙ CYMMЫ HA MБ
 2,VTM,BUF.
 3,VJM,OБMEH.
 ,XTA,KC.
 ,ATX,2101B.
 2,VTM,BUF+3.
 3,VJM,OБMEH.
 ,SJ,
 CHEK2:14,VTM,1-1024.
  13,VTM,.HECOBПAДEHИE
 :14,XTA,3777B.
 14,AEX,5777B.
 ,UIA,BAD.
 14,VLM,*-1.
 ,UJ,KЦ.
 BAD:,XTA,ИHФ.
  ,ASN,64-30
  ,AUX,=6H'7''7''7''7''7''7'
  ,AOX,=6H000000
 ,ATX,AДP.
 ,*76,HECO.
 OБMEH:,BSS,
C.........ЧTEHИE/ЗAПИCЬ ЗOHЫ/TPAKTA+KOPPEKЦИЯ ИC
C         ПOЛYЧEHИE ИC OБMEHA
 2,XTA,
 2,AUX,1
 ,ATX,ИHФ.
 2,XTA,.
 ,ASN,64-30.
 ,AOX,ИHФ.
  2,AOX,6.БИT MOДEЛИ+CДBИГ
 ,ATX,ИHФ
  2,XTA,7
  ,UZA,OBMEN1
  POISK:11,UTC,-16
  12,*65,47
  2,AEX,7
  ,UZA,BOT
  KOP:12,VLM,POISK
  ,UJ,OBMEN1
  BOT:10,UTC,-16
  12,*65,47
  ,AEX,ДHЗ
  ,AAX,=:77
  ,U1A,KOP
  12,UTM,47+10B
  ,ITA,12
  ,ASN,64-12
  ,XTS,ИHФ
  ,AAX,=7777 7777 7700 7777
  15,AOX,
  ,ATX,ИHФ
  OBMEN1:,BSS,
  12,VTM,-47
 ,*70,ИHФ.COБCTBEHHO OБMEH
 2,XTA,
 2,ARX,2.ПEPEAДPECAЦИЯ ИC
 2,ATX,
 3,UJ,
  FORMNP:,APX,=:024
  ,AUX,=1000 0000 0000 1000
  2,ATX,6
  3,UJ,
 TPИC:,BSS,
C.........OБPAБOTKA YKAЗATEЛЯ ЧTEHИЯ/ЗAПИCИ
 ,AAX,B48/34
 2,ATX,.
C         ПPOBEPKA HOMEPA HAПPABЛEHИЯ
 ,AAX,B48/46
 ,UZA,OШИHФ.HOMEP HAПPABЛ.=0
 ,AEX,B48/46
 ,UZA,OШИHФ.HOMEP HAПPABЛ.=7
 2,XTA,
 ,ARX,BIT46
 ,U1A,OБMБ
C         ПOЛYЧEHИE ИMEHИ MЛ ЗAHECEHИE EГO B TAБЛИЦY
  2,XTA,6.ЛИШHИЙ
  ,ASN,64+10.PAЗPЯД
  ,U1A,OШИHФ.MOДEЛИ
  LENTA:,BSS,
 2,XTA,
 ,ASN,64+42
 ,ATI,5.N MAГHИTOФOHA
 ,ASN,64-12
 ,AOX,=54 0000 0000 0000
  2,AOX,6
 ,ATX,ИHФ
 ,TAPE,ИHФ. ЧTEHИE ИMEHИ MЛ
  2,ATX,7
 ,*76,ЗAПИM.HA ЗAПИCЬ ИMEHИ
 5,VTM,ИHФMЛ
 ,UJ,MБMЛ
 ЗAПИM:,BSS,
  ,WTC,ATNMT
  5,ATX,-30B
 ,WTC,A TMT.
 5,XTA,-30B.
 ,ASN,64+36.
 14,UIA,ЗAHЯT-ЗAПИM.
 ,WTC,A ГYC.
 ,XTA,.
 ,ASN,64+42.
 ,ASN,64-42.
 ,WTC,A TMT.
 5,ATX,-30B.
 ,MTJ,27B
 2,32,
 OБMБ:,BSS,.
  2,XTA,6
  ,AAX,BIT46
  ,U1A,LENTA
  2,XTA,6
  ,U1A,OШИHФ
  2,ATX,7.BMECTO ИMEHИ
 2,XTA,
 ,APX,=77037 00000 00000 0
 2,ATX, . ЗAГOTOBKA ДЛЯ ИC
 5,VTM,ИHФMБ
 MБMЛ:,BSS,
 5,XTA,
 2,ATX,1.MACKA PACПAKOBKИ ИC
 5,XTA,1
 2,ATX,2.K-TA ПEPEAДPECAЦИИ
 2,XTA,
 4,AOX,
 2,ATX,
 3,UJ,
 OШИHФ:,BSS,
  13,VTM,3
 ,*76,OШHAБ.
 14,REL,OШHAБ.
 ЗAHЯT:14,UTM,OШHAБ-ЗAПИM.
  13,VTM,5
  OШHAБ:,BSS,
   HECO:,BSS,
  13,UTM,ERT1
 ER:,ITA,13.
 ,WTC,A TELOUT.
 14,VJM,.
 13,VTM,2013B.
 13,MTJ,27B.
 13,VTM,574B.
 13,MTJ,33B.
 3,IJ,.
 ERT1:,ISO,6HПЛOXO
 AДP:,BSS,2.
  ERT2:,ISO,12HOШ.HAБOP''''''''
  ERT3:,ISO,12HMФ ЗAHЯT''''''''
 ИHФMБ:,BSS,.
 ,LOG,77 0037.
 ,OCT,0002.
 ИHФMЛ:,BSS,.
 ,LOG,77 0777.
 ,OCT,00001.
 B48/34:,OCT,77777.
 B48/46:,OCT,7.
 BIT46:,OCT,1.
 KC:,BSS,1.
 ,END,.
  NRESERR:,NAME,
C      PEДAKЦИЯ OT 20.02.76
C    (Л.KAMИHCKИЙ,И.CИЛИH,A.ГYCEB)
 '    YBEЛИЧEHИE ЧИCЛA ШИФPOB - 03.07.78
C
C   22.03.84 - PEДAKЦИЯ B.BEPETEHOBA
C              ( OCA HA PAЗДEЛE ,
C                ENCODE/DECODE ЧEPEЗ ЭK )
C
 *ИПД:LC,BLOCK,
 ,CONT,(50)
 ,CONT,FLERBUS
  SCDEBUG:,EQU,*ИПД+71B
 *YCЫ:LC,BLOCK,ГYC,RDSCAL
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
C*****   ИCПOЛЬЗYEMЫE ЯЧEЙKИ  ИПЗ :
 S33:,EQU,3
 S32:,EQU,4
 S27:,EQU,5
 I14:,EQU,10B
 I9:,EQU,15B
 S34:,EQU,26B
 S35:,EQU,27B
 COPYS32:,EQU,46B
 COPYI14:,EQU,47B
 M:,EQU,100B
 REGSCAL:,EQU,M
 COPYS33:,EQU,M+6
 SCJOTЛ:,EQU,564B
 ИP/34:,EQU,563B
 ИP/35:,EQU,ИP/34
 PEГ34:,EQU,ИP/34
 READ :,EQU,ИP/34
 ФREAD:,EQU,ИP/34
 WRITE:,EQU,ИP/34
 *615:B,BLOCK,
C-----   ДOП.ПOЛE YПPЯTЫBAHИЯ OTЛAДЧИKA
 ,CONT,SSUM,SRK,PMP
 ,CONT,A(2),FLAG
 ,CONT,SI161432
 ,CONT,SI15,SI14,SI13,SI12,SI11,SI10
 ,CONT,S103,S104,S105
C-----   OБЩEE C MYЛЬTИTAЙПOM
 ,CONT,SWITCH
 ,CONT,READRERR(0),OF
 ,CONT,WRITWORD
 ,CONT,OCTADR
 ,CONT,IDENT(0),IDENTI(2)
 ,CONT,ISUB(2)
 ,CONT,SAVESUBP
C-----   PAБOЧEE ПOЛE OTЛAДЧИKA
 ,CONT,SWARD(0),ЧИ,MAG(2)
 ,CONT,IDI,RR1,RR2
 ,CONT,COMMAND
C
C-----    ЯЧEЙKИ П/П "NRESCODE"
C     (ИX HAДO ПPЯTATЬ, T.K. OTЛAДЧИK
C     CAM ПOЛЬЗYETCЯ  NRESCOD-OM)
C     И MECTO ДЛЯ YПPЯTЫBAHИЯ :
C
  *135:B,BLOCK,W/NRCOD(3)
  *772:B,BLOCK,CW/NRCOD(3)
  *771:B,BLOCK,MADRES.TEK.AДPEC "MЯЧ"
C-----   PAБ.ЯЧEЙKИ  "O C A  HA PAЗДEЛE"
 *775:B,BLOCK,OVNAM,OVSWI
C*****   ШKAЛЫ OTЛAДЧИKA
 *SCAL71:LC,BLOCK,(3),SCAL67,SCШAГ
 SCALES:LC,BLOCK,(9),SCSTOP
C*****   OБOЗHAЧEHИЯ ПO БYФEPY 'ERRMACRO'
 AHA:,EQU,1
C*****
 LOADANGO:,SUBP,
 SELECT :,SUBP,
 NRESOFF:,SUBP,
 NRERR:,SUBP,
 FULWOR:,LC,1
 C77777:,LC,1
 DISREG:,LC,1
 C14:,LC,1
 C7 :,LC,1
  C7777:,LC,1
  C77:,LC,1
  ISOTOALL:,SUBP,
C*****
 *677:B,BLOCK,BITS
 ,CONT,BIT48,BIT47,BIT46,BIT45
 ,CONT,BIT44,BIT43,BIT42,BIT41
 ,CONT,BIT40,BIT39,BIT38,BIT37
 ,CONT,BIT36,BIT35,BIT34,BIT33
 ,CONT,BIT32,BIT31,BIT30,BIT29
 ,CONT,BIT28,BIT27,BIT26,BIT25
 ,CONT,BIT24,BIT23,BIT22,BIT21
 ,CONT,BIT20,BIT19,BIT18,BIT17
 ,CONT,BIT16,BIT15,BIT14,BIT13
 ,CONT,BIT12,BIT11,BIT10,BIT 9
 ,CONT,BIT 8,BIT 7,BIT 6,BIT 5
 ,CONT,BIT 4,BIT 3,BIT 2,BIT 1
C*****
C
  NR:,BSS,
  12,REL,*
  11,XTA, W/NRCOD
  11,ATX,CW/NRCOD
  11,XTA, W/NRCOD+1
  11,ATX,CW/NRCOD+1
  11,XTA, W/NRCOD+2
  11,ATX,CW/NRCOD+2
  BEGIN:,BSS,
 14,VTM,-20
 ,XTA,ПYCTO
 CL21:14,UTC,
 15,ATX,AHA+20
 14,VLM,CL21
 11,MTJ,13
 11,WTC,SWITCH
 ,XTA,BITS
 ,AEX,FULWOR
 11,AAX,SCJ OTЛ
 11,ATX,SCJ OTЛ
  11,WTC,SWITCH
  ,UJ,*
 :,UJ,SIMOCA.= O C A
  :,UJ,SIMOЧT.= O Ч T
 :,UJ,SIMOЗA.= O З A
  :,UJ,OCTKOM.OCT.ПO NK
  :,UJ,OCTЧИC.OCT.ПO AЧ
  :,UJ,ADRERR1.= P E Г
  :,UJ,ADRERR2.= P E Г 1
  :,UJ,ADRERR3.MЯЧ,MЯK,ДEC,ИДИ
  :,UJ,ADRERR4.= Ф Я Ч
  :,UJ,ADRERR5.= З A П , Ч И З
 SIMOCA:,BSS,
C
C*****   ПPИKAЗ : O C A
C
 ,XTA,
 13,ATX,OVNAM
 13,ATX,OVSWI
  14,VJM,CHIDENT
 11,XTA,OVNAM
 ,UZA,SIM1
 ,XTA,=6HPAЗДEЛ
 11,ATX,A
 14,VTM,13B
 14,MTJ,27B
 ,XTA,B*1
 ,*50,13.TEKCT-6
 ,XTA,=3H :
 11,ATX,A
 ,XTA,B*5
 ,*50,13.TEKCT-3
  ,XTA,BIT18
  11,AOX,REGSCAL
  11,ATX,REGSCAL
 13,XTA,ИP/34
 13,ATX,S34
 ,UJ,SIM 3
  SIM1:,BSS,
  13,XTA,ИP/34
 13,ATX,S34
 13,XTA,REGSCAL
 ,UJ,WR REG
 SIMOЗA:,BSS,
C
C*****   ПPИKAЗ : O З A
C
 SIMOЧT:,BSS,
C
C*****   ПPИKAЗ : O Ч T
C
  14,VJM,CHIDENT
  13,XTA,ИP/34
 13,ATX,S35
 11,XTA,SWITCH
 ,ASN,64-4
 13,AEX,REGSCAL
 ,AAX,BIT5
 13,AEX,REGSCAL
 WRREG:,BSS,
 ,AOX,BIT18
 13,ATX,REGSCAL
 14,VTM,13B
 14,MTJ,27B
 ,XTA,=6H  AДP:
 11,ATX,A
 ,XTA,B*1
 ,*50,13.TEKCT-6
 11,XTA,ИP/34
 11,ATX,A
 ,XTA,B*2
 ,*50,14.AДPEC-5
 ,XTA,B*BL
 ,*50,13.ПPOБEЛ-1
 SIM3:,XTA,B*8
 ,*50,13.TEKCT-8
 ,XTA,
 15,ATX,AHA+4
 ,UJ,CBET
  ADRERR1:,BSS,
C
C*****   ПPИKAЗ : P E Г
C
   :    ,24,3
  11,XTA,SSUM
   14,VJM,TRASWOR
 14,VJM,KOPAHA
  11,XTA,PMP
   14,VJM,TRASWOR
 14,VJM,KOPAHA
   ,WTC,ГYC
   ,XTA,COPYS33
    14,VJM,TRANIR
   ,WTC,ГYC
   ,XTA,COPYS33
   ,ASN,64+15
 ,AAX,C14
   ,UZA,MP
   15,XTA,AHA
 ,AEX,=104
   15,ATX,AHA
   MP:,BSS,
  11,XTA,SRK
  ,ASN,64+41
 14,VJM,TRANIR 1
   15,UTM,1
  13,XTA,COPYS32
   14,VJM,TRANIR
   15,UTM,1
  11,XTA,SI15
   14,VJM,TRANIR
   13,XTA,COPYI14
   15,UTM,1
   14,VJM,TRANIR
  11,XTA,SI161432
   15,UTM,1
   14,VJM,TRANIR
  ,XTA,
  15,ATX,AHA+1
 15,UTM,-13
  ,UJ,CBET1
  ADRERR2:,BSS,
C
C*****   ПPИKAЗ : P E Г  1
C
 15,UTM,-1
 10,VTM,1-4
 REGS:10,UTC,3
 11,XTA,SI13
 14,VJM,TRANIR 1
 10,VLM,REGS
 10,VTM,1-9
 REG2:10,UTC,8
 13,XTA,I9
 14,VJM,TRANIR 1
 10,VLM,REG 2
 ,XTA,
 15,ATX,AHA+1
 15,UTM,-12
 ,UTC,-1
 CBET1:13,VTM,INFT
   :   ,24,2003B
 ,XTA,DISREG
 ,ATI,27B
 13,*71,
   ,UJ,CBET
  ADRERR5:,BSS,
C
C*****   ПPИKAЗЫ : З A П , Ч И З
C
  11,XTA,READRERR
  ,AAX,BIT5
  ,U1A,ЗAПЧИC
  11,ATX,OCTADR
  11,ATX,OF
  11,ATX,ISUB
  11,ATX,ISUB+1
  14,VJM,CHIDENT
  READYW:,BSS,
 14,VJM,CLE 35
   ,XTA,DISREG
   ,ATI,27B
  11,WTC,ИP/34
   10,VTM,
  11,XTA,WRITWORD
  10,*75,
  10,MTJ,14
  ,UJ,HE KOCB
  ININP:,BSS,
  15,Z06,AHA
  ,Z00,
  ЗAПЧИC:,BSS,
  11,XTA,READRERR
  ,AAX,BIT7
  ,U1A,ЗAПADR
 14,VJM,IDENTIOTL
  ЗAПADR:,BSS,
  11,XTA,READRERR
 ,AAX,=7777 7777 7777 7657
  11,ATX,READRERR
  11,XTA,ИP/34
  11,ATX,SWARD
 14,VTM,13B
 14,MTJ,27B
  ,*71,ININP
 ,XTA,INF5012
 14,VTM,13B
 14,MTJ,27B
 ,FUN,12
 14,UTM,-2
 14,VZM,OKNUM
 14,UTM,2-3
 14,V1M,BADNUM
 OKNUM:11,ATX,WRITWORD
 11,XTA,SWARD
 11,ATX,ИP/34
 ,XTA,
 11,ATX,READRERR
 11,ATX,SWARD
 ,UJ,READYW
 BADNUM:,XTA,=6HOШ.HAБ
 15,ATX,AHA
 ,XTA,
 15,ATX,AHA+1
 15,ATX,READRERR
 ,UJ,CBET
 INF5012:,Z00,
 15,Z00,AHA
  ADRERR4:,BSS,
C
C*****   ПPИKAЗ : Ф Я Ч
C
  11,WTC,ИP/34
  ,XTA,
  ,UJ,ФMЯЧ
  GOTO:,BSS,
C
C*****   ПPИKAЗ : И Д И  <ИДEHTИФ>
C
 11,AEX,READRERR
 11,ATX,READRERR
 14,VJM,IDENTIOTL
  11,XTA,ИP/34
 ,AAX,C77777
  ,WTC,ГYC
 13,VTM,
  13,ATX,COPYS33
  ,XTA,SCSTOP
 ,AAX,ZBITJ
  ,ATX,SCSTOP
  ,XTA,RDSCAL
 ,AOX,BITJ
  ,ATX,RDSCAL
  ,UJ,BOЗB
   ADRERR3:,BSS,
C
C***** ПPИKAЗЫ : M Я Ч  M Я K  Д E C  И Д И
C
  11,XTA,READRERR
 ,AAX,BIT43
  ,U1A,GOTO
  11,XTA,READ
 ,AEX,FULWOR
 ,U1A,IDIOT
 14,VJM,IDENTIOTL
 11,XTA,IDENTI
 15,ATX,AHA+6
 11,XTA,IDENTI+1
 15,ATX,AHA+7
 ,XTA,
 15,ATX,AHA+8
 IDIOT:,BSS,
 ,XTA,
 11,ATX,SWARD
 14,VJM,CLE 35
  11,XTA,ИP/34
  ,U1A,ADRIS. - ЗAДAHO
  11,XTA,MADRES. TEKYЩИЙ
  ,ARX,BIT1. + 1
  ADRIS:11,ATX,MADRES. - ЗAПOMHИM
  11,ATX,ИP/34
  ,ATI,14
  11,XTA,READRERR
 ,AAX,BIT21
 ,UZA,HE KOCB
 11,AEX,READRERR
 11,ATX,READRERR
   :   ,24,
 14,XTA,
   :   ,24,3
  11,ATX,ИP/34
 ,ATI,14
 HE KOCB:,24,
 14,XTA,
   :   ,24,3
 11,ATX,SWARD
 14,VJM,PUT 35
 11,XTA,OF
 ,AAX,BIT48
 ,U1A,OCTTODEC
 11,XTA,SWARD
  ФMЯЧ:,BSS,
   14,VJM,TRASWOR
  ФMЯЧД:,BSS,
  ,XTA,=6H AДP.
 15,ATX,AHA+4
  11,XTA,ИP/34
 15,UTM,5
   14,VJM,TRANIR
 15,UTM,-5
 ,XTA,
 15,ATX,AHA+6
   ,UJ,CBET
  OCTTODEC:,BSS,
  11,AEX,OF
  11,ATX,OF
  ,XTA,INF5015
  14,VTM,13B
  14,MTJ,27B
  ,FUN,15
  ,UJ,ФMЯЧД
  INF5015:11,Z25,ЧИ
  15,Z13,AHA
 CLE 35:,UTC,-30
 PUT 35:13,VTM,15
 11,XTA,S35
 13,ASN,64
 11,ATX,S35
   :   ,24,2002B
 ,ATI,35B
   :   ,24,2003B
 11,MTJ,13
 14,UJ,
   TEXT:,BSS,
  ,ISO,6H
  ,ISO,6HI-CYMM
  ,ISO,6HATOP-I
  ,ISO,6H
  ,ISO,6HI-PEГ.
  ,ISO,6HMЛ.P-I
  ,ISO,6H
  ,ISO,6HИP.33
 ,ISO,6HP.AY '1'
   :,ISO,6H ИP.32
  :,ISO,6H ИP.15
   :,ISO,6H ИP.14
   :,ISO,6H ИP.16
   :,OCT,
   TEXT1:,BSS,
  :,ISO,6H ИP.13
  :,ISO,6H ИP.12
   :,ISO,6H ИP.11
   :,ISO,6H ИP.10
   :,ISO,6H ИP. 9
  :,ISO,6H ИP. 8
   :,ISO,6H ИP.7
   :,ISO,6H ИP.6
  :,ISO,6H ИP.5
  :,ISO,6H ИP.4
  :,ISO,6H ИP.3
  :,ISO,6H ИP.2
  :,ISO,6H ИP.1
  :,OCT,
  ПYCTO:,ISO,6H'1''1''1''1''1''1'
   TRASWOR:,BSS,
   13,VTM,1-4
   TRANSLOOP:,BSS,
  11,ATX,A
   ,AUX,=0000 3407 0160 3400
  ,AOX,=1003 0060 1403 0001
   15,UTC,
   13,ATX,AHA+3
  11,XTA,A
   ,ASN,64-12
   13,VLM,TRANSLOOP
   ,WTC,ГYC
   13,VTM,
 14,UJ,
 KOPAHA:15,XTA,AHA+3
 ,AAX,=7777 7777 7777 7600
 ,AOX,BIT6
 15,ATX,AHA+3
 15,UTM,4
 14,UJ,
 TRANIR 1:15,UTM,1
   TRANIR:,BSS,
   ,ASN,64-33
   ,AUX,=0160 3407 0160 3400
   ,AOX,=1403 0060 1403 0040
   15,UTC,
   ,ATX,AHA
   14,UJ,
   INF71:,BSS,
 15,Z04,AHA
  ,Z00,
  INFT1:12,Z04,TEXT1-NR
  ,Z00,
   INFT:12,Z04,TEXT-NR
  ,Z00,
  OCTKOM:,BSS,
C
C*****   CИTYAЦИЯ : OCTAHOB ПO NK
C
 ,XTA,SC ШAГ
 ,AAX,BITJ
 ,U1A,BЫBOД
 11,XTA,OVNAM
 ,UZA,BЫBOД
 14,VTM,LOADANGO+21B
 11,AEX,SSUM
 ,UZA,OV/2
 11,XTA,OVSWI
 ,U1A,OV/3
 ,XTA,ZBITJ
 ,AAX,SCDEBUG
 ,ATX,SCDEBUG
 ,XTA,ZBITJ
 ,AAX,SCШAГ
 ,ATX,SC ШAГ
 ,XTA,BITJ
 ,AOX,SCAL67
 ,ATX,SCAL67
 13,XTA,S34
 ,AAX,C77777
 ,UZA,*B
 ,ASN,64-15
 OV/1:13,ATX,S34
  :,24,2002B
 ,ATI,34B
 ,24,2003B
 ,UJ,*B
 OV/2:,XTA,BIT1
 11,ATX,OVSWI
 ,ITA,14
 ,UJ,OV/1
 OV/3:,XTA,
 11,ATX,OVNAM
 11,ATX,OVSWI
  :,24,2002B
 ,XTA,15B
 ,24,2003B
 ,UJ,OV/1
 OCT ЧИC:,BSS,
C
C*****   CИTYAЦИЯ : OCTAHOB ПO AЧ
C
 BЫBOД:,24,2003B
  ,XTA,SCШAГ
 ,AAX,ZBITJ
  ,ATX,SCШAГ
   ,XTA,SCSTOP
 ,AOX,BITJ
   ,ATX,SCSTOP
 14,VTM,13B
 14,MTJ,27B
 ,XTA,=6HOCTAH.
 11,ATX,A
 ,XTA,B*1
 ,*50,13.TEKCT-6
 13,XTA,COPYS33
 11,ATX,A
 ,XTA,B*2
 ,*50,14.AДPEC-5
 13,XTA,COPYS33
 ,ATI,14
 ,ASN,64+15
 ,AAX,C14
 ,UZA,BЫB/1
 ,XTA,=1HФ
 11,ATX,RR1
 ,UJ,BЫB/2
 BЫB/1:,XTA,BIT41
 11,ATX,RR1
 ,ITA,14
 13,AEX,S35
 ,UZA,BЫB/3
 ,24,
 BЫB/2:14,XTA,
 ,24,3
 BЫB/3:11,ATX,COMMAND
 13,XTA,COPYS33
 ,AAX,BIT24
 ,U1A,BЫB/4
 11,XTA,COMMAND
 ,ASN,64+24
 11,ATX,COMMAND
 ,UTC,=1HЛ - =1HП
 BЫB/4:,XTA,=1HП
 11,ATX,A
 14,VTM,13B
 14,MTJ,27B
 ,XTA,B*3
 ,*50,13.TEKCT-1
 11,XTA,RR1
 11,ATX,A
 ,XTA,B*3
 ,*50,13.TEKCT-1
 11,XTA,SWITCH
 ,AEX,BIT3
 ,UZA,BЫB/6.OCT.ПO NK
 13,XTA,REGSCAL
 ,AAX,BIT5
 ,U1A,BЫB/5
 ,UTC,=4H ЧT- - =4H ЗП-
 BЫB/5:,XTA,=4H ЗП-
 11,ATX,A
 ,XTA,B*4
 ,*50,13.TEKCT-4
 13,XTA,S35
 11,ATX,A
 ,XTA,B*2
 ,*50,14.AДPEC-5
 ,UJ,BЫB/7
 BЫB/6:,XTA,=3H NK
 11,ATX,A
 ,XTA,B*5
 ,*50,13.TEKCT-3
 BЫB/7:,XTA,B*BL
 ,*50,13.1 ПPOБEЛ
 11,XTA,COMMAND
 ,*50,9
 11,ATX,RR1
 ,YTA,
 11,ATX,RR2
 14,VZM,BЫB/8
 ,UTC,=1HB - =1H
 BЫB/8:,XTA,=1H
 11,ATX,COMMAND
 ,XTA,B*6
 ,*50,13.TEKCT-14
 ,XTA,=4HCYM=
 11,ATX,A
 ,XTA,B*4
 ,*50,13.TEKCT-4
 11,XTA,SSUM
 11,ATX,A
 ,XTA,B*7
 ,*50,14.OCTAL-16
 ,XTA,
 15,ATX,AHA+10
 ,UJ,CBET
 B*BL:,Z01,BIT46
 ,,
 B*1:11,Z06,A
 15,,AHA
 B*2:11,Z05,A
 ,Z05,
 B*3:11,Z01,A
 ,,
 B*4:11,Z04,A
 ,,
 B*5:11,Z03,A
 ,,
 B*6:11,Z16,RR1
 ,,
 B*7:11,Z20,A
 ,Z10,
 B*8:11,Z10,IDENTI
 ,,
C-----   BЫДAЧA ПOДГOTOBЛEHHOЙ CTPOKИ
   CBET:,BSS,
   :   ,24,2003B
   ,XTA,DISREG
   ,ATI,27B
   ,*71,INF71
C-----     A HE ПOЯBИЛИCЬ ЛИ
C        HOBЫE ЗAKAЗЫ OTЛAДЧИKY
  *B:,BSS,
  11,XTA,SCJOTЛ
  ,UZA,BOЗB
  ,ANX,
  11,ATX,SWITCH
  ,UJ,BEGIN
C
C*****   B O З B P A T
C
  BOЗB:,BSS,
 ,WTC,ГYC
   13,VTM,
  13,XTA,CW/NRCOD
  13,ATX, W/NRCOD
  13,XTA,CW/NRCOD+1
  13,ATX, W/NRCOD+1
  13,XTA,CW/NRCOD+2
  13,ATX, W/NRCOD+2
 13,MTJ,15
 14,VTM,1-12
  :,24,2003B
 11,XTA,SSUM
 RES:11,UTC,
 14,XTS,SI10
 14,VLM,RES
C        ДOYПPЯTЫBAHИE PEГИCTPOB
C        MOЖET KTO-TO ИПЗ ЗAПAXAЛ
 14,VTM,9
 SI:14,ITS,
 14,UTM,-1
 14,V1M,SI
 13,XTS,COPYS33
 13,ATX,S33
 ,ASN,64+15
 13,ATX,S27
 13,XTA,COPYS32
 13,ATX,S32
 13,XTA,COPYI14
 13,ATX,I14
 15,UTM,56B
 11,XTA,S103
 11,XTS,S104
 11,XTS,S105
 ,XTS,ZBITJ
 ,AAX,FLERBUS
 ,ATX,FLERBUS
 ,XTA,SCSTOP
 ,AAX,BITJ
  ,UZA,SEL
 ,AEX,RDSCAL
    ,ATX,RDSCAL
  SEL:,BSS,
 ,XTA,INFOFF
  ,UJ,NRESOFF
 INFOFF:,Z00,NRERR
     ,Z00,SELECT
C
C=====  BXOД: AДPEC ИЛИ ИДEHTИФИKATOP
C
  CHIDENT:11,MTJ,13.HAДO
  11,XTA,ИP/34
  ,AEX,FULWOR
  14,U1A,. - AДPEC
 IDENTIOT:,BSS,
C
C=====   OTЛAДKA ПO ИДEHTИФИKATOPAM
C
 ,ITA,14
 11,ATX,SWARD
 14,VTM,2013B
 14,MTJ,27B
 ,*72,=:113777
 14,VJM,CLE 35
C
C...   ПEPEBOД ДBYX 8-CИMBOЛЬHЫX ИMEH
C      ИЗ ISO B TEXT.
C      IDENTI И ISUB PAЗMEЩEHЫ ПOДPЯД !
C
  10,VTM,-3.4 CЛOBA ISO
  13,VTM,-5.ПO 6 CИMB.
  ISOT1:10,UTC,3
  11,XTA,IDENTI
  ISOT2:,ASN,64-8
  15,ATX,AHA+1.OCTATOK ISO
  ,YTA,
  ,ATI,14.CИMBOЛ ISO
  15,XTA,AHA
  ,ASN,64-6
  15,ATX,AHA
  ,ITA,14
  ,UZA,ISOT3
  ,AEX,BIT6.ПPOБEЛ
  ,UZA,ISOT3
  14,XTA,ISOTOALL
  ,ASN,64+8
  ,AAX,C77.CИMBOЛ TEXT
  15,AOX,AHA
  15,ATX,AHA.HAKOПЛEHИE
  ISOT3:15,XTA,AHA+1
  13,VLM,ISOT2
  13,VTM,-5
  15,UTM,1
  10,VLM,ISOT1
  15,UTM,-4
C
C...  CБOPKA 8-CИMB.ИMEHИ ИЗ ДBYX CЛOB
C             ( 6+2 )
C
  15,XTA,AHA
  ,ASN,64-12
  15,ATX,AHA
  15,XTA,AHA+1
  ,ASN,64+24
  ,AAX,C7777
  15,AOX,AHA.ЛOKAЛЬHOE
  11,ATX,ИP/34.ИMЯ
C---
  15,XTA,AHA+2
  ,ASN,64-12
  15,ATX,AHA
  15,XTA,AHA+3
  ,ASN,64+24
  ,AAX,C7777
  15,AOX,AHA
  :,U1A,*+1
  11,XTA,SAVESUBP
  :15,ATX,AHA.ГЛOБAЛЬHOE
   11,ATX,SAVESUBP.ИMЯ
  11,MTJ,10.ПEPBOE ИMЯ
 ,AEX,=:12
  ,UZA,ГЛOБ
 ,AEX,=:05
 ,U1A,ЛOKAЛ
 11,ATX,OVSWI
 11,XTA,ИP/34
 11,ATX,OVNAM
  ГЛOБ:,BSS,
C-----   ПOИCK ГЛOБAЛЬHOГO OБ'EKTA
   :    ,24,
  ,XTA,17B
   :    ,24,0003
  ,ASN,64+30
  11,ATX,RR1
  ,XTA,
  11,ATX,RR2
  14,VTM,2013B
  14,MTJ,27B
  ,*72,=:10374177
  NEXTLIS1:,BSS,
  ,XTA,=0010 3700 0020 0000
  11,ARX,RR2
   :    ,24,
   ,ATX,76003B
   :    ,24,3
  14,VTM,2013B
  14,MTJ,27B
   ,*70,76003B
  ,WTC,ГYC
  13,VTM,
  14,VTM,
  FITA:,BSS,
 ,ITA,14
 11,AEX,RR1
 ,UZA,HETID0
   :    ,24,
  14,XTA,76000B
   :    ,24,3
  11,AEX,ИP/34
  ,UZA,HAID
 14,UTM,2-2000B
  ,ITA,14
  ,UZA,NEXTLIS2
  14,UTM,2000B
  ,UJ,FITA
 HET ID0:11,XTA,OVNAM
 ,UZA,HET ID1
 ,XTA,A/LGO
 ,UJ,HA ID0
 A/LGO:,,
 ,,LOADANGO
  NEXTLIS2:,BSS,
  11,XTA,RR1
  ,ATI,14
  14,UTM,-2000B
  ,ITA,14
  11,ATX,RR1
  11,XTA,RR2
  ,ARX,BIT1
  11,ATX,RR2
  ,UJ,NEXTLIS1
  HAID:,BSS,
 ,XTA,
 11,ATX,OVNAM
 ,24,
 14,XTA,76001B
 ,24,3
 HA ID0:,BSS,
 11,ARX,OCTADR
 ,AAX,C77777
  11,ATX,ИP/34
 ,XTA,
 11,ATX,OCTADR
  14,VTM,2013B
  14,MTJ,27B
  ,*72,=:10413777
 11,WTC,SWARD
 14,VTM,
 ,UJ,PUT 35
 ЛOKAЛ:,BSS,
C-----   ПOИCK ЛOKAЛЬHOГO OБ'EKTA
   :    ,24,
  ,XTA,17B
   :    ,24,0003
  ,ASN,64+30
  11,ATX,RR1
  ,XTA,
  11,ATX,RR2
  14,VTM,2013B
  14,MTJ,27B
  ,*72,=:10374177
  NEXTLIS3:,BSS,
   ,XTA,=0010370000200000
  11,ARX,RR2
   :    ,24,
   ,ATX,76003B
   :    ,24,3
  14,VTM,2013B
  14,MTJ,27B
   ,*70,76003B
  ,WTC,ГYC
  13,VTM,
  14,VTM,
  ИЩИ SUBP:,BSS,
 ,ITA,14
 11,AEX,RR1
  ,UZA,HETID2
   :    ,24,
  14,XTA,76000B
   :    ,24,3
  15,AEX,AHA
  ,UZA,HAШASUBP
 14,UTM,2-2000B
  ,ITA,14
  ,UZA,NEXTLIS4
  14,UTM,2000B
  ,UJ,ИЩИSUBP
  NEXTLIS4:,BSS,
  11,XTA,RR1
  ,ATI,14
  14,UTM,-2000B
  ,ITA,14
  11,ATX,RR1
  11,XTA,RR2
  ,ARX,BIT1
  11,ATX,RR2
  ,UJ,NEXTLIS3
  HAШASUBP:,BSS,
  ,ITA,14
  11,ATX,FLAG
  14,VTM,
  11,XTA,RR2
  ,ATI,13
  ,UZA,OKEY
  EЩE ЛИCT:,BSS,
  13,UTM,-1
  14,UTM,2000B
  ,ITA,13
  ,U1A,EЩE ЛИCT
  OKEY:,BSS,
  11,XTA,FLAG
  ,ATI,13
  13,J+M,14
  ,ITA,14
  11,ATX,FLAG
 ,XTA,C7
  11,ATX,MAG
  13,VTM,
  NEXTLIS5:,BSS,
  ,XTA,=:0010 3700 0020 0000
  11,AOX,MAG
   :    ,24,
   ,ATX,76003B
   :    ,24,3
 14,VTM,2013B
  14,MTJ,27B
   ,*70,76003B
   :   ,24,
 ,XTA,17B
   :   ,24,0003
 ,ASN,64+15
 ,AAX,C77777
 11,ATX,RR1
 14,VTM,1776B
 FITA1:,BSS,
 ,ITA,13
 11,AEX,RR1
 ,UZA,HETID1
   :    ,24,
  14,XTA,76000B
   :    ,24,3
  11,AEX,ИP/34
 ,UZA,HAID1
 *FI:,BSS,
  ,ITA,14
  ,UZA,NEXTLIS6
 13,UTM,2
 14,UTM,-2
 ,UJ,FITA1
  NEXTLIS6:,BSS,
  11,XTA,MAG
  ,ATI,14
  14,UTM,-1
  ,ITA,14
  11,ATX,MAG
  ,UJ,NEXTLIS5
 HAID1:,BSS,
   :      ,24,
  14,XTA,76001B
   :    ,24,3
  ,ASN,64+24
  11,AEX,FLAG
 ,AAX,C77777
 ,U1A,*FI
 ,UJ,HA ID
  HET ID2:11,MTJ,10.BTOPOE
  10,UTM,ISUB-IDENTI.ИMЯ
 HETID1:,BSS,
 ,XTA,=6H HET
  15,ATX,AHA
 10,XTA,IDENTI
 15,ATX,AHA+1
 10,XTA,IDENTI+1
 ,U1A,TWOWOR
 ,XTA,ПYCTO
  TWOWOR:,BSS,
 15,ATX,AHA+2
  ,XTA,
 15,ATX,AHA+3
  11,ATX,OCTADR
 11,ATX,READRERR
 14,VTM,2013B
 14,MTJ,27B
  ,*72,=:10413777
 14,VJM,PUT 35
 ,UJ,CBET
 ,BSS,
 ,END,.
 OCCUPYD:,NAME,
C******   ПPOЦEДYPЫ ЗAKAЗA/OTKAЗA ДИCKO-
C         BЫX PECYPCOB И EЩE KOE-ЧTO.
C
C         OБPAЩEHИE ЧEPEЗ ,*57,-1
C         HA CYMMATOPE ПPИ BXOДE:
C          PAЗPЯДЫ 48-30, 24-21 COДEPЖAT
C         KЛЮЧ ДOCTYПA;
C          PAЗPЯДЫ 15-1 - AДPEC ИHФOPMAЦИOH-
C         HOГO ПOЛЯ;
C          PAЗPЯДЫ 20-16 - KOД OПEPAЦИИ;
C          PAЗPЯДЫ 29-25 - ДOПOЛHИTEЛЬHAЯ
C         ИHФOPMAЦИЯ.
C
C......   KOДЫ OПEPAЦИЙ:
C           0B - ЗAKAЗ ПAKETOB;
C           1B - OTKAЗ OT ПAKETOB;
C           2B - ЗAПPOC KOOPДИHAT ФAЙЛOB;
C           3B - ЗAKAЗ OБЫЧHЫX ФAЙЛOB;
C           4B - ЗAKAЗ SCRATCH ФAЙЛOB;
C           5B - OTKAЗ OT ФAЙЛOB;
C           6B - OTKAЗ OT BCEX MД-PECYPCOB;
C          37B - ИЗMEHEHИE CTATYCA ФAЙЛA.
C
    NEWTA:,SUBP,
 TTPRINT:,SUBP,
 CLANEWTA:,SUBP,
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 BADMACRO:,SUBP,
 REGSCAL:,EQU,100B
 *YCЫ:LC,BLOCK,ГYC,RDSCAL
 NRESOFF:,SUBP,
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR
 ,CONT,SAVI15,SAVI14,SAVI13
 *TDIS:,LC,.TAБЛ,ЭKCTEHTOB
  * И П Д :LC,BLOCK,XNF,XNFM(4)
  ,CONT,XNC,XNCM(2)
  ,CONT,Ш/CЛYЖ,Ш/FULL
  ,CONT,(5)
  ,CONT,MБД
  ,CONT,LFATA
  ,CONT,LENTDIS
  ,CONT,(9)
  ,CONT,MONO
  ,CONT,FREXT
C
  * И П K :,LC,1
  * И П K 1 :,LC,1
C
  NMAT :,WEQ,XNC
  NMAT1:,WEQ,XNF
  NJM1 :,EQU,NMAT-1
  LTF1 :,WEQ,LFATA
  LTF  :,EQU,LTF1-1
  MONOW:,EQU,*ИПK1+NMAT
  FATA :,LC,1
  *127:B,BLOCK,MLD,RDL
  *140:B,BLOCK,DISNAM,FSJOB,FSINF(4)
 CMDREC:,LC,1
  *DISCS:LC,BLOCK,DNAM
 LTX:,WEQ,LENTDIS
 LTXM1:,EQU,LTX-1
 TABLEMT:LC,BLOCK,(16),T1MT(32)
  REWINDSC:LC,BLOCK,(1),WTAPES
 SCDICH:,SUBP,
 B24/1:,LC,1
 B36/31:,EQU,=:0000 77
 B48/31:,LC,1
 C76000:,LC,1
 C37:,LC,1
  C7777:,LC,1
 C77777:,LC,1
 FULWOR:,LC,1
 C2003:,LC,1
 C3:,LC,1
 *C:LC,BLOCK,C6
  C5:,LC,1
 C77:,LC,1
 B16/1:,LC,1
  *CB:,LC,
  C17:,EQU,*CB+1
 DISREG:,LC,1
  POST:,LC,1
  NC*5:,P*P,(NMAT)5
  NC*5P4:,EQU,NC*5+4
  WAITPOST:,EQU,POST+NC*5P4
  OUTMACRO:,SUBP,
  SEMDOWNS:,SUBP,
  SEMUP  :,SUBP,
  ШЛAГБAYM:LC,BLOCK,(1),SEMAFOR
 *677:B,BLOCK,BITS
 ,CONT,BIT48,BIT47,BIT46,BIT45
 ,CONT,BIT44,BIT43,BIT42,BIT41
 ,CONT,BIT40,BIT39,BIT38,BIT37
 ,CONT,BIT36,BIT35,BIT34,BIT33
 ,CONT,BIT32,BIT31,BIT30,BIT29
 ,CONT,BIT28,BIT27,BI326,BIT25
 ,CONT,BIT24,BIT23,BIT22,BIT21
 ,CONT,BIT20,BIT19,BIT18,BIT17
 ,CONT,BIT16,BIT15,BIT14,BIT13
 ,CONT,BIT12,BIT11,BIT10,BIT 9
 ,CONT,BIT 8,BIT 7,BIT 6,BIT 5
 ,CONT,BIT 4,BIT 3,BIT 2,BIT 1
 BGEN:,EQU,BIT42
 BIT30:I,BLOCK,BITW2W(0),BWGEN
 BWMAS:,EQU,BIT8
 WORK:I,BLOCK,SAVI14OW,SMONOW,REZACC
 ,CONT,MASTER,FILE,INF
 ,CONT,STEC
C         OБOЗHAЧEHИE ИHДEKC PEГИCTPOB
 *1:,BLOCK,TR,MP,AP,NM
 *5:,BLOCK,K,L,M,N
 *9:,BLOCK,(1),T,P,D
 *13:,BLOCK,J,R,S
 BASA:,BSS,
 14,REL,BASA
 ,XTA,SAVI14
 ,ATX,SAVAR
 ,XTA,DISREG
 ,ATI,27B
  ,XTA,SAVAC
  ,ARX,=30 0000.TИПЫ
   ,AAX,=70 00000.БOЛЬШИE 4
  ,UIA,CH/KEY.-ДA
C         ПPOBEPKA PEЖИMA
 ,WTC,*YCЫ
 ,XTA,REGSCAL
 ,AAX,BIT48
 ,UZA,BADMACRO
  CH/KEY:,BSS,
C         ПPOBEPKA KЛЮЧA ЭKCTPAKOДA
 ,XTA,SAVAC
 ,AAX,MASKEY
 ,AEX,KEY
 ,U1A,BADMACRO
  P/ENT:,BSS,.ПOBT.BXOД
C======   P-OPERATION
  ,ITA,14
  ,ATX,SAVI14
  ,ARX,W/DOWN
  ,UJ,SEMDOWNS
C======
  P/RET:,BSS,
 ,XTA,SAVAR
  ,ASN,64-45
  ,UZA,*5
  ,AUX,C2003
  ,AOX,BIT4
  *5:,BSS,
 ,ATX,SAVI14OW
 15,VTM,STEC
 ,XTA,SAVAC
  ,ATX,INFW*57
 ,XTS,SAVI15
 ,ASN,64-15
 ,AOX,SAVI13
 ,AOX,SAVSR
   :   ,24,3
 ,NTR,7
 13,VTM,1-4
 ,ITS,32B
C         CПACEHИE ИHДEKC PEГИCTPOB
 *50:13,ITS,12
 ,ASN,64-15
 13,ITS,8
 15,AOX,
 ,ASN,64-15
 13,ITS,4
 15,AOX,
 13,VLM,*50
 14,MTJ,9
 9,REL,BASA
 ,WTC,Д H З
 D,VTM,-NMAT1
C         CПACEHИE ШK.ЗAHЯTOCTИ ЗAДAЧИ И
C         ПOЛYЧEHИE ШK.ЗAHЯTOCTИ ДPYГИX
 ,XTS,
 ,ATX,REZACC.CYMMAT.BЫXOДA
 ,ATX,NEWDI.HOBЫE ПAKETЫ
 D,XTA,MONOW.CBOИ ПAKETЫ
 ,AAX,B48/33
 ,ATX,SMONOW
 D,AEX,MONOW.ЧИCTKA ШKAЛЫ
 D,ATX,MONOW.CBOИX ПAKETOB
 ,XTA,SMONOW
 ,ASN,64+32.CBOИ ПAKETЫ B
 ,AAX,MONO. MOHOПOЛИИ
 ,AOX,SMONOW
 ,ATX,SMONOW
 ,AEX,MONO.ЧИCTKA ШKAЛЫ
 ,ATX,MONO. ПAKETOB
 ,ASN,64-16.ШK.CПEЦ.ПAKETOB
 M,VTM,-NJM1
 *51:M,AOX,MONOW+NJM1
 M,VLM,*51
 ,AAX,B48/33
 ,AOX,MONO
 ,ATX,MONO
C         PACПOKOBKA CYMMATOPA BXODA
 ,XTA,STEC
 ,ATI,P.AДP.ИHФ.ПOЛЯ
 ,ASN,64+15
 ,AAX,C37
 ,ATI,T.TИП ЗAДAHИЯ
  ,XTS,STEC.ДOП.ИHФ.
  ,ASN,64+14.B BИДE
  ,AAX,C76000.AДPECA
  ,ATI,AP.PAБ.ЛИCTA
  ,STX,INF.ДЛЯ KOORD
C         HE OПEPAЦИЯ ЛИ ЭTO C ПAKETAMИ
 ,A-X,BIT2
 ,UZA,NOTDJ.HET
C         OПEPAЦИЯ C ПAKETAMИ
 14,VJM,NEXTWORD.ПOЛYЧEHИE ШKAЛЫ
 ,ATX,FILE.MOHOДEЙCTBИЙ
 ,XTA,STEC.OПPEДEЛEHИE
 ,ASN,64-20.ЧИCЛA ПAKETOB
 ,ASN,64+44.B ЗAKAЗE B BИДE
 ,X-A,.CЧETЧИKA
 ,ATI,N.ДЛЯ VLM
 MLDJ:,BSS,
C   ---   OCHOBHOЙ ЦИKЛ ПO ИMEHAM ПAKETOB
 13,VJM,NNOFD.ЗA N ПAKETA
 M,UTM,3.(N ЗAKAЗA)*3
  MP,VZM,EMLDJ.ПCEBДO
 ,U1A,REFD1.ПAKETA HET
C         YCTAHOBKA ПPИЗHAKA MOHOДEЙCTBИЙ
C         B CYMMATOP.
 ,XTA,FILE.ПPOДBИЖKA
 ,ASN,64-1.ШKAЛЫ
 ,ATX,FILE.
 ,YTA,.ПPИ MOHOДEЙCTBИИ
 ,ASN,64-5.CYMMATOP=0
 ,A-X,BIT6.ИHAЧE OH=-32
 T,VZM,PDOP.HA P-OПEPAЦИЮ
C   ...   OTKAЗ OT ПAKETA ИЛИ MOHOПOЛИИ
 ,UZA,MONV.OTKAЗ OT MOH.
C         HET ЛИ ПAKETE CBOИX ФAЙЛOB
 ,XTA,P770077.MACKA ПPOBEPKИ
 ,XTS,ДHЗ.PAЗMEЩEHИE ДHЗ
 ,ASN,64-12.И HOMEPA MOДYЛЯ
 ,ITS,NM.HA MECTA, ГДE
 15,AOX,.OHИ ЖИBYT B
 ,ASN,64-30.ФAЙЛOBOЙ TAБЛИЦE
 13,VJM,SFAMA.ПOИCK
 ,UZA,REFD2.HAШЛИ, OTKAЗ
C         БYДET OTKAЗ OT ПAKETA
 NM,XTA,BIT48-24
 MONV:NM,AOX,BIT16-24.И OT MOHOПOЛИИ
 ,AEX,FULWOR
 ,AAX,SMONOW
 ,ATX,SMONOW
 ,UJ,EMLDJ
 REFD2:,BSS,
C   ...   OTKAЗЫ B ДEЙCTBИЯX C ПAKETAMИ
 ,UTC,-1
 REFD1:M,XTA,BITS
 ,AOX,REZACC
 ,ATX,REZACC
 ,UJ,EMLDJ
 PDOP:,BSS,
C   ...   ЗAXBAT ПAKETA ИЛИ MOHOПOЛИИ
 ,ATI,K
 ,XTA,MONO.HE ЗAHЯT ЛИ
 K,ASN,64.ПAKET ЧYЖИMИ
 NM,AAX,BIT48-24.ЗAДAЧAMИ
 ,U1A,REFD2.ЗAHЯT
C
C...   OБPAЩEHИE ЗA PAЗPEШEHИEM
C      K COCEДHEЙ ЭBM
C
  ,ITA,NM
  ,ARX,BIT4
  ,AAX,C17
  ,ASN,64-13
  ,AOX,= 1000 7777
  K,AOX,BIT13
  ,CALL,K COCEДY
  ,U1A,REFD2.ЗAHЯT
C         PEAЛИЗAЦИЯ ЗAXBATA
 NM,UTC,
 K,XTA,BIT16-24
 NM,AOX,BIT48-24
 ,AOX,NEWDI
 ,ATX,NEWDI
 EMLDJ:,BSS,
C   ---   KOHEЦ ЦИKЛA ПO ПAKETAM
 N,VLM,MLDJ
C         OKOHЧATEЛЬHAЯ PAБOTA C ПAKETAMИ
 ,XTA,REZACC.HET ЛИ OTKAЗOB
 ,UZA,RETURN.ИX HET
 ,XTA,.БЛOKИPOBKA
 ,ATX,NEWDI.HOBЫX ЗAXBATOB
 ,UJ,RETURN
 NOTDJ:,BSS,
C......   OПEPAЦИЯ HE C ПAKETAMИ
 N,VTM,.CЧETЧИK HEYДAЧ
 ,NTR,7
 ,UZA,KOORD.HYЖHA CПPABKA
 ,A-X,BIT2
 ,U1A,*NP.ЗAK.OБЫЧ.ФAЙЛOB
 ,XTS,
 ,STX,MASTER
 ,U1A,NOTRSCR.KAKAЯ-TO V-OП.
C......   ЗAKAЗ SCRATCH ФAЙЛOB
 AP,VTM,*QSCF
 ,XTA,INF
 ,AAX,BIT15
 ,UZA,*QSCF
C......   ДOЗAKAЗ ЭKCTEHTOB
 N,VTM,1
 R,VJM,NEXTWORD
 L,VJM,IFFMN
  ,U1A,RETJF.FILE ABSENT
 J,VZM,RETJF.TAPE
 R,XTA,FATA+LTF
  ,AAX,B36/31
  ,U1A,RETJF.NOT SCRATCH
  ,XTA,STEC
  ,AAX,C77
  ,ATX,MASTER
  ,X-A,FREXT
  ,U1A,SFEEND
 N,VTM,
  ,XTS,MASTER
 R,ARX,FATA+LTF
 R,STX,FATA+LTF
  ,UJ ,SUC/S
 *QSCF:,BSS,.OCHOBHOЙ ЦИKЛ
 14,VJM,NEXTWORD
 ,UZA,SFEND.KOHEЦ ПOЛЯ
 L,VJM,IFFMN.HE ECTЬ ЛИ MAT.N
  ,UZA,FREFU.ЗAHЯT
C         MAT. HOMEP CBOБOДEH
 ,XTA,STEC
 ,AOX,B48/43.ДHЗ ПOKA
 ,ATX,STEC.ДEЛAETCЯ 77B
 ,AAX,C77777.TPEБYEMЫX
 ,ARX,MASTER.ЭKCTEHTOB
 ,ATX,MASTER.B ШKAЛAX
 K,VTM,-1.ПP. HET MECTA
 ,UJ,SETFATA
 SFEND:,BSS,
C         KOHEЦ ЗAKAЗA SCRATCH ФAЙЛOB
 N,V1M,FEND.БЫЛИ OШИБKИ
 ,XTA,MASTER.XBATИT ЛИ
 ,AAX,C77777
 ,X-A,FREXT.ЭKCTEHTOB
 ,UZA,SUC/S.ДA
 SFEEND:,BSS,
 N,VTM,-1.OTKAЗ ПO HEXBAT-
 ,UJ,FEND.KE ЭKCTEHTOB
C   ---   OCHOBHOЙ БЛOK PAЗБOPA
 *NP:,BSS,
C   ...   BЫБOPKA ИMEHИ ДИCKA
 13,VJM,NNOFD
 ,ACX,.M=0, ECЛИ
 ,ATI,M.ПAKET ДOCTYПEH
 *REFF:,BSS,
C   ...   BЫБOPKA CCЫЛKИ ФAЙЛA
 14,VJM,NEXTWORD
 AP,VTM,*REFF
 ,UZA,FEND.KOHEЦ ИHФ.ПOЛЯ
 ,ARX,
 ,UZA,*NP.KON.ГPYППЫ ПAKET
  MP,VZM,*REFF.ПCEBДO
 M,V1M,FREFU.ПAKETA TO HET
 ,AAX,=77 0040 7777 7777
 L,VJM,IFFMN.
 K,VTM,-1.ПP.ЗAHЯT MAT.N
 ,UZA,FKREF.MAT.N ЗAHЯT
C         MAT. HOMEP CBOБOДEH
 K,UTM,-1.
  13,VTM,TOSET
 ,ITA,NM
 ,ASN,64-30
 14,VJM,ORMAT
  FATASEAR:,BSS,
 ,ITA,NM.YCTAHOBKA HOMEPA
 ,ASN,64-30.MOДYЛЯ И ПPИЗ-
 ,AOX,STEC .HAKA HEOKOHЧEH-
 ,AOX,B48/43.HOГO ЗAKAЗA=
 ,ATX,STEC.(ДHЗ=77B)
C         HE ЗAHЯT ЛИ ЭTOT ФAЙЛ
 ,AAX,BIT30.БИT ЗAПИCИ
 ,AEX,=7740 7777 7777
 ,XTS,STEC
 ,AEX,BIT30
  ,UJ,SFAMA
  TO SET:,UZA,FKREF.ЗAHЯT
 K,UTM,-1.ПP. HET MECTA
 SETFATA:,BSS,
C......    П/П ПOИCKA CBOБOДHOГO MECTA B
C         FATA И PAЗMEЩEHИE TYДA KOДA ИЗ
C         STEC. BOЗBPAT ПO AP.
 ,XTA,FULWOR.MACKA
 ,XTS,.OБPAЗ
 13,VJM,SFAMA
 ,U1A,FKREF.HET MECTA
 ,XTA,STEC.ЗA ДHЗ ПOKA 1
 WRF:14,ATX,FATA+LTF
  AP,UJ,
 FKREF:,BSS,
C......   П/П ФИKCAЦИИ HEYДAЧ.BOЗBPAT AP.
 K,UTC,
 FREFU:,XTA,BIT43.
 N,UTM,1.CЧET HEYДAЧ
 AP,MTJ,14
 ,UJ,ORMAT
 SUC/S:,BSS,
C   ...   ФOPMИPOBKA CЧETЧИKA CBOБOДHЫX
C         ЭKCTEHTOB И ШKAЛЫ-CЧETЧИKA ЗAДAЧИ
  ,ATX,FREXT
 ,XTA,MASTER
  ,WTC,ГYC
  ,ARX,RDL
  ,WTC,ГYC
  ,ATX,RDL
 FEND:,BSS,
C   ---   KOHEЦ PAБOTЫ C ФAЙЛAMИ
C         БЫЛИ ЗAKAЗЫ ФAЙЛOB
 CORFA:,BSS,
C         ЦИKЛ ИCПPABЛEHИЯ HEOKOHЧ.CЛOB FATA
 ,XTA,B48/43.
 ,XTS,B48/43
 13,VJM,SFAMA.ПOИCK HEOKOHЧ.
 ,U1A,RETJF.ИX БOЛЬШE HET
 N,V1M,CRWF.БЫЛИ HEYДAЧИ
 14,XTA,FATA+LTF.ПOЛYЧKHИE MAT.
 ,ASN,64+36.HOMEPA ФAЙЛA
 ,ATI,13.+7700B
 13,XTA,BITS-7727B.YCTAHOBKA БИTA
  ,WTC,ГYC
  ,AOX,MLD
  ,WTC,ГYC
  ,ATX,MLD
 ,XTA,ДHЗ.ПPИ OTCYTCTBИИ
 ,ASN,64+6.HEYДAЧ HA MECTO
 ,YTA,.ДHЗ ПOMEЩAETCЯ
 ,AEX,B48/43.ДHЗ ЗAKAЗЧИKA
 14,AEX,FATA+LTF.BMECTO 1
 CRWF:14,ATX,FATA+LTF
 ,UJ,CORFA
 RETJF:,ITA,N.CYMMAT.BЫXOДA =
 ,ATX,REZACC.ЧИCЛO HEYДAЧ
 ,UJ,RETURN
 NOTRSCR:,BSS,
C......   HE OTKAЗ ЛИ ЭTO OT ФAЙЛOB:
 ,A-X,BIT2
 ,UZA,GLORST.HEЧTO ДPYГOE
C......   OTKAЗ OT ФAЙЛOB
 *FREFIL:,BSS,
 AP,VTM,*FREFIL
 14,VJM,NEXTWORD
 ,UZA,RETJF.KOHEЦ ПOЛЯ
 ,XTS,Д H З
 ,ASN,64+6
 ,YTA,
 15,AOX,
 ,ATX,FILE
 ,XTA,B48/37
 ,XTS,FILE
 13,VJM,SFAMA
 ,U1A,FREFU.TAKOГO HET
  14,XTA,FATA+LTF.ЗAПOMHИM
  ,AAX,P770077.ДHЗ И NMOD
  ,ATX,STEC
  AP,VJM,KILLFILE
C        ECTЬ ЛИ HA ПAKETE EЩE HAШИ ФAЙЛЫ
  ,XTA,P770077
  ,XTS,STEC
  13,VJM,SFAMA
C        HYЖEH ЛИ OTKAЗ И OT ПAKETA
  ,UZA,*FREFIL
  ,XTA,INF
  ,UZA,*FREFIL
C        OTKAЗ OT ПAKETA
  ,XTA,STEC
  ,ASN,64-12
  ,ASN,64-6
  ,YTA,
 ,UZA,*FREFIL.ЭTO SCRATCH
  ,ATI,NM
  ,AEX,C77
  ,UZA,*FREFIL.ПCEBДO
  ,XTA,SMONOW
  NM,AOX,BIT48-24
  NM,AEX,BIT48-24
  ,XTS,SMONOW
  ,ASN,64-32
  15,AOX,
  ,ATX,SMONOW
  ,UJ,*FREFIL
 KILLFILE:,BSS,
C......   П/П YHИЧTOЖEHИЯ ФAЙЛA
C         И14=N CЛOBA FATA-ДЛИHA FATA,
C         COOTBETCTBYЮЩEE HYЖHOMY ФAЙЛY
C         BOЗBPAT ПO AP.
 14,XTA,FATA+LTF
 ,AAX,B48/31.A KAKOЙ
 ,ASN,64-12.TИП ФAЙЛA:
 ,U1A,CPCSC.OБЫЧHЫЙ
C
C...   ПPИ OTKAЗE OT SCRATCH YЧИTЫBAEM
C      ДOП.ИHФOPMAЦИЮ. БИT 29 OЗHAЧAET
C      OTKAЗ OT OДHOГO TOЛЬKO ЭKCTEHTA
C      A HE OT BCEГO ФAЙЛA ЦEЛИKOM.
C      ЛOKAЛЬHЫЙ HOMEP (0..63)
C      ЭTOГO ЭKCTEHTA ЗAДAETCЯ B 6-1
C      PAЗPЯДAX ИHФOPMAЦИOHHOГO ПOЛЯ
 R,XTA,FATA+LTF
  ,ARX,=:5750
  ,AAX,B48/37
  ,XTS,FILE
  ,AAX,C77
 S,AEX,
  ,APX,=3737 0000 0000 0077
  ,ATX,FILE
  ,XTA,INF
  ,AAX,BIT15
 ,ASN,64+11
  ,ATI,T
  :,U1A,*+1
 14,WTC,FATA+LTF
 MP,VTM,
  ,XTA,B48/31
 T,ASN,64-8
  ,ATX,MASTER
 J,VTM,-LTXM1
 ,XTA,B16/1
 LCTEX1:,BSS,
C         ЦИKЛ ЧИCTKИ TAБЛ.ЭKCTEHTOB
 13,XTS,*TDIS+LTXM1
 15,APX,-1.OЧEPEД.ЭЛEMEHT
 ,AEX,FILE
 ,AAX,MASTER
 ,U1A,ELCTEX1.HE HAШ
 13,XTA,*TDIS+LTXM1
 15,AOX,-1.YHИЧTOЖEHИE
 15,AEX,-1.ЭЛEMEHTA
 13,ATX,*TDIS+LTXM1
 MP,UTM,1
 ELCTEX1:15,XTA,
 ,ASN,64-16
 ,U1A,LCTEX1
 ,XTA,B16/1
 13,VLM,LCTEX1
 ,ITA,MP
  ,ARX,FREXT.+ K CЧ.CBOБ.
  ,ATX,FREXT.ЭKCTEHTOB
 ,ITA,MP
 ,AEX,FULWOR.KOPPEKЦИЯ
 ,ARX,BIT1
 ,AAX,C77777
  ,WTC,ГYC
  ,ARX,RDL
 ,AAX,C77777
  ,WTC,ГYC
  ,ATX,RDL
  AP,UTC,
  T,VIM,
  CPCSC:,AEX,B48/43
  ,WTC,ГYC
  13,VTM,
  ,UZA,KILFFS.ПCEBДO
  14,XTA,FATA+LTF
 ,ASN,64+36.MATEMATИЧECKOГO
 ,AAX,C77.HOMEPA
 ,XTS,FULWOR.И MACKИ ЧИCTKИ
 15,WTC,.ШKAЛ MOДEЛEЙ
 ,AEX,BIT48-30B.MAT.ЛEHT
  13,AAX,MLD
  13,ATX,MLD
 ,AOX,C77777
  13,AAX,RDL
  13,ATX,RDL
 ,XTA,.YHИЧTOЖEHИE
 14,ATX,FATA+LTF.CCЫЛKИ
 AP,UJ,
C
C...    OTKAЗ OT ПCEBДOФAЙЛA
C
  KILFFS:,XTA,C3."CLOSE"
  13,ATX,FSJOB
  14,XTA,FATA+LTF
  ,APX,=:0077 0003.LUN+NFS
  ,AUX,=:7703
  15,ATX,
  ,ASN,64+42
  13,STX,FSINF.LUN
  ,AOX,BIT40
C---
  *522:,AOX,=17 0470 0000
  14,VTM,13B
  14,MTJ,27B
  ,*52,2
  ,AEX,=6HOTЛYП
  ,U1A,HE OTЛYП
  ,XTA,=6HOTЛYП
  ,UJ,WRACCRET
  HE OTЛYП:,AEX,=6HOTЛYП
  AP,UJ,
C----------
 KOORD:,BSS,
C......   ПOЛYЧEHИE KOOPДИHAT ФAЙЛA И ПPO-
C         BEPKA PEЖИMA ДOCTYПA. (CЧETЧИK
C         HEYДAЧ N BEДETCЯ B OБPATHOM KOДE)
 13,VJM,NNOFD
 ,U1A,ENKOOR.ДИCKA HET
C         OПPEДEЛEHИE TИПA ДИCKA.
 ,ITA,NM
 ,ASN,64+3.HOMEP
 ,ATI,14.HAПPABЛEHИЯ
 14,XTA,SCDICH.TИП ДИCKA
 ,AEX,BIT48.ДЛЯ MAЛЫX ДИCKOB
 ,ASN,64+5.YCTAHOBИM CДBИГ
 ,AOX,BIT48.HA 2 BПPABO,
 ,ATX,TDSH.ИHAЧE -  HA 0
 N,VTM,-1.HAЧ.COCT.CЧ.
C   ---   OCHOBHOЙ БЛOK PAЗБOPA
 /GM:,BSS,
C   ...   BЫБOPKA ИMEHИ MACTEPA
 14,VJM,NEXTWORD
 ,ARX,
 ,UZA,ENKOOR.KOHEЦ.ИHФ.ПOЛЯ
 ,ATX,MASTER.ИMЯ MACTEPA
 ,UJ,/GF.ЗA ФAЙЛAMИ
 EMLCP:,BSS,.
C         KOHEЦ ПPOXOДA KATAЛOГA
 MP,VLM,NEWPCAT
C         ФAЙЛ HE HAЙДEH
 WRBAD:,BSS,
C         COOБЩEHИE OБ OTKAЗE B KOOPДИHATAX
 TR,XTA,BIT48.TИП OTKAЗA
 N,UTM,-1.CЧET OTKAЗOB
C         ЗAПИCЬ PEЗYЛЬTATA
 WRINF:14,VJM,ORMAT
 /GF:,BSS,
C   ...   BЫБOPKA OПИCAHИЯ ФAЙЛA
 14,VJM,NEXTWORD
 ,ARX,
 ,UZA,/GM.KOHEЦ ГP.MACTEPA
 ,ATX,FILE.ИMЯ ФAЙЛA
 TR,VTM,.ПP.'ПЛOX.OПИC.'
 14,VJM,NEXTWORD.2 CЛOBO OПИC.
  ,ATX,STEC
  K,VTM,C5.'БEЗ ЗAПИCИ'
  ,UZA,*70
  ,AAX,BITW2W
  :,UZA,*+1
  K,VTM,0.'ЗAПИCЬ'
  :,AEX,STEC
  ,UZA,*70
C
C....   ПPИ ЗAKAЗE ПCEBДOФAЙЛA
C       1-Й И 3-Й ЭTAПЫ ИГHOPИPYЮTCЯ.
C       BCE ДEЛAETCЯ HA ЭTAПE ЗAПPOCA
C       KOOPДИHAT. ПPИ ЭTOM B 42:37 P.
C       2 CЛOBA OПИCAHИЯ ФAЙЛA ДOЛЖEH
C       YKAЗЫBATЬCЯ MAT.HOMEP.
C
  L,VJM,IFFMN
  ,UZA,WRBAD
 ,WTC,ГYC
  13,VTM,
  ,XTA,STEC
  ,ASN,64+36
  ,AAX,C77
  13,ATX,FSINF+2.LUN
  ,ASN,64-42
  13,ATX,FSINF+4
  ,XTA,MASTER
  13,ATX,FSINF
  ,XTA,FILE
  13,ATX,FSINF+1
 K,XTA,. 5 = "R"
  ,ASN,64-40
  ,AEX,=6HW
  13,ATX,FSINF+3
  ,XTA,BIT3."OPEN"
  13,ATX,FSJOB
  13,XTA,DISNAM
  ,ASN,64+12
  ,AAX,C3
  MP,VIM,WRBAD
  ,ASN,64-36
  13,AOX,FSINF+4
  AP,VJM,*522
  TR,VTM,2
  ,ASN,64+34
  ,U1A,WRBAD.HET Ф.C.
  13,XTA,FSJOB.HAЧ.OTBETA
  ,AAX,C77777
  TR,VTM,1
  ,U1A,WRBAD
  13,XTA,FSINF.LIMIT-1
  ,AAX,C7777
  ,UJ,WRINF
C---
  *70:,BSS,
 TR,VTM,1.ПP.'HET ФAЙЛA'
 MP,VTM,-1.CЧETЧИK ПPOXOДOB
 NEWPCAT:,BSS,
 L,VTM,4-1024
 14,VJM,GI1Z
 MLCP:,BSS,
C         ЦИKЛ ПPOXOДOB ПO KATAЛOГY
 13,VJM,GIWOCA
 ,UZA,EMLCP.KOHEЦ KATAЛOГA
 15,ATX,.ИMЯ ФAЙЛA
 13,VJM,GIWOCA.
 ,ATX,STEC.XAPAKTEPИCTИKA
 ,ASN,64+42
 ,STI,M.ЧИCЛO 'USER'OB
 ,AEX,FILE.TOT ЛИ ФAЙЛ
 ,U1A,HE TOT
  TR,VTM,2.ПP.'HET ДOCTYПA'
 MP,V1M,USERS.ПOИCK ПO 'USER'Y
C         ПPOBEPЯEM OБЩИЙ ДOCTYП
 ,XTA,STEC
 ,AAX,BGEN
 ,UZA,HE TOT.OБЩ.ДOCTYПA HET
 ,XTA,STEC.BЫДEЛEHИE ПPИЗH.
 ,AAX,BWGEN.PAЗPEШEHИЯ ЗAП.
 REGIM:,BSS,
C         ПPOBEPKA ДOCTYПA ПO ЗAПИCИ
  K,AOX,.HE 0 - HE HYЖEH
 ,U1A,WRGOOD.OH ECTЬ
 HE TOT:,BSS,
C         ПEPEXOД K CЛEДYЮЩEMY ФAЙЛY
 M,VZM,MLCP
 13,VJM,GIWOCA.ПPOПYCK 'USER'A
 M,UTM,-1
 ,UJ,HE TOT
 USERS:,BSS,
C         ПPOBEPЯEM ИMЯ 'USER'A
 M,VZM,MLCP.HET HAШEГO
 13,VJM,GIWOCA
 M,UTM,-1
 ,ATX,REZACC.ИMЯ
 ,AEX,MASTER
 ,AAX,D8/7F
 ,U1A,USERS.ИMЯ HE TO
 ,XTA,REZACC.BЫДEЛ.ПPИЗH.
 ,AAX,BWMAS.PAЗPEШEHA ЗAПИCЬ
 ,UJ,REGIM
 WRGOOD:,BSS,
C         ПOЛYЧEHИE KOOPДИHAT ФAЙЛA
 ,XTA,STEC
 ,ASN,64-20
 ,ASN,64+24
 ,ARX,BIT3.[B,E] B [B,E+1)
 ,ASX,TDSH
 ,AAX,B24/1
 ,A-X,BIT1.[B,E+1) B [B,E]
 ,ATX,FILE
  ,AOX,BIT30
  ,ATX,STEC
  13,VJM,FATASEAR
  ,U1A,FR/FILE
  14,XTA,FATA+LTF
  ,AAX,B48/37
  ,ASN,64+6
  ,AOX,FILE
  ,UJ,WRINF
  FR/FILE:,XTA,FILE
 ,UJ,WRINF
 ENKOOR:,BSS,
C   ---   KOHEЦ ПOЛYЧEHИЯ KOOPДИHAT
 ,ITA,N.B CYM.PEЗYЛЬTATA
 ,AEX,C77777.ЧИCЛO HEYДAЧ
 ,ATX,REZACC.B.ПPЯMOM KOДE
 ,UJ,RETURN
 GLORST:,BSS,
C......   ГЛOБAЛЬHЫЙ OTKAЗ ИЛИ CMEHA CTAT.
 ,X-A,C30
 ,UZA,GLOBAL
C......   YCTAHOBKA(CMEHA) CTATYCA.
 14,VJM,NEXTWORD
 L,VJM,IFFMN
 ,U1A,WRACCRET.PECYPCA HET
C         BЫДEЛEHИE CTATYCA И MAT.N
 ,XTA,STEC
  ,ATI,K.CTATYC
 ,ASN,64+36
 ,AAX,C77
 ,ATI,N.MAT.HOMEP
 13,VZM,ITISTAPE.PECYPC - ЛEHTA
C         HE ECTЬ ЛИ PECYPC SCRATCH-ФAЙЛ.
 14,XTA,FATA+LTF
 ,AAX,B48/31
 ,ASN,64-12
 ,UZA,BADSET.ДA - ЗAПPET
C         ЗAHECEHИE CTATYCA B FATA
 ,ITA,K
 ,ASN,64-26
 14,AEX,FATA+LTF
 ,AAX,B28/27
 14,UTM,FATA+LTF
 ,UJ,SETCTA
 BADSET:,BSS,
C         ПЫTAЛИCЬ ПOCTABИTЬ CTATYC
C         HA PECYPC ЗAПPEЩEHHOГO TИПA
 ,XTA,BIT1
 ,UJ,WRACCRET
 ITISTAPE:,BSS,
C         PECYPC ЛEHTA. A HE MOДEЛЬ ЛИ:
 14,UTM,31
 ,ITA,14
 ,AAX,BIT15
 ,U1A,BADSET.MOДEЛЬ-ЗAПPET
  ,ITA,K
  ,AAX,BIT3
  ,U1A,CHEKW
  ,UTC,FULWOR-WTAPES
  CHEKW:,XTA,WTAPES
  14,AAX,BIT48+16
  ,UZA,BADSET
C         YCTAHOBKA CTATYCA B T!MT
 14,UTM,T1MT
 ,ITA,K
 ,ASN,64-1
 14,AEX,
  ,AAX,=16
 SETCTA:,24,2003B
 14,AEX,
 14,ATX,
 ,WTC,ГYC
 ,XTA,RDL
 N,AOX,BIT48-24.BCTABKA
 K,UTM,-3.HAДЛEЖAЩEГO
 K,VZM,STCT1.БИTA
 N,AEX,BIT48-24.B ШKAЛY
 STCT1:,WTC,ГYC.CTATYCOB
 ,ATX,RDL
   :   ,24,3
 ,XTA,
 WRACCRET:,BSS,
 ,ATX,REZACC
 ,UJ,RETURN
 GLOBAL:,BSS,
C......   OTKAЗ BCEX ДИCKOBЫX PECYPCOB
 ,XTA,B48/43.
 ,XTS,ГYC.ПPOЧИCTKA
 13,VJM,SFAMA.CЛOB FATA
 ,U1A,ENGLBL.CO CBOИM ДHЗ
 AP,VTM,GLOBAL
 ,UJ,KILLFILE
 ENGLBL:,XTA,.ПPOЧИCTKA KOПИИ
 ,ATX,SMONOW.ШKAЛЫ ЗAHЯTOCTИ
 RETURN:,BSS,
C......   OKOГЧAHИE ЭKCTPAKOДA.
C         BOCCTAHOBЛEHИE ШKAЛ ЗAHЯTOCTИ.
 ,XTA,SMONOW
 ,AOX,NEWDI
 15,ATX,
 ,AAX,B48/33
 D,AOX,MONOW
 D,STX,MONOW
 ,AOX,MONO
 ,STX,MONO
 9,MTJ,14
 14,REL,BASA
 ,XTR,STEC+1
 13,VTM,4
 RESIR:,BSS,
C         BOCCTAHOBЛEHИE ИHДEKC PEГИCTPOB
 13,ATI,.PEГИCTPЫ 1-4
 ,ASN,64+15
 13,ATI,4.PEГИCTPЫ 5-8
 ,ASN,64+15
 13,STI,8.PEГИCTPЫ 9-12
 13,UTM,-1
 13,V1M,RESIR
C         OKOHЧATEЛЬHOE BOCCTAHOBЛEHИE
   :   ,24,2003B
 ,STI,32B.BOЗBPAT
 ,ATI,13
 ,ASN,64+15
 ,ATI,15
C======   V-OPERATION
  ,ITA,14
  ,ARX,W/UP
  ,UJ,SEMUP
C======
  V/RET:,BSS,
 ,XTA,REZACC.YCT.CYMMATOPA
 ,ATX,SAVAC.PEЗYЛЬTATA
  ,AEX,=6HOTЛYП
  ,U1A,V/RET1
C
C....  ЗAДAЧE - ПOBTOPHЫЙ BXOД
C
  ,XTA,ШЛAГБAYM
  ,AEX,Д H З
  ,AAX,C77
  ,UZA,V/RET1.Э57 4000
  ,XTA,BITJ
  ,AOX,WAITPOST
  ,ATX,WAITPOST
  ,XTA,INFW*57
  ,ATX,SAVAC
  ,XTA,SAVI14OW
  ,ATX,SAVAR
  13,MTJ,16
  ,CALL,SAVEMOD
  ,XTA,DISREG
  ,ATI,27B
  13,VTM,P/ENT
  13,MTJ,33B
  ,UJ,CLANEWTA
  V/RET1:,BSS,
C         BOCCTAHOBЛEHИE 27B MOДИФИKATOPA
 ,XTA,SAVI14OW
  ,ATI,27B
 ,XTA,CNROFF
 ,UJ,NRESOFF
 NROCCD:,SUBP,
 CNROFF:,Z00,NROCCD
  ,Z00,OUTMACRO
 9,REL,BASA
 IFFMN:,BSS,
C......   П/П OПPEДEЛEHИЯ ЗAHЯT ЛИ
C         MAT.HOMEP. HA BXOДE: ACC=
C         MAT.N, B PAЗPЯTAX 42-37. HA
C         BЫXOДE ACC=0.EQ.ЗAHЯT. ACC BXOДA
C         C ДHЗ B 48-43P B STEC. BOЗBPAT=L
 ,XTS,ГYC
 ,AAX,B48/43
 15,AOX,
 ,ATX,STEC
 ,XTA,B48/37
 ,XTS,STEC.C TEM ЖE
 13,VJM,SFAMA.MAT.HOMEPOM
 L,UZA,.ECTЬ TAKOЙ
C           ПOИCK TAKOЙ ЛEHTЫ
 13,VTM,.ПPИЗHAK ЛEHTЫ
 14,VTM,1-48
 *60:14,XTA,T1MT+31
 ,AEX,STEC
 ,AAX,B48/37
  L,UZA,
 14,VLM,*60
 ,XTA,B48/37.ПOИCK ФAЙЛA
 ,XTS,STEC.C TEM ЖE MAT.N
 ,AOX,B48/43.ИЗ ЧИCЛA HOBЫX
 L,MTJ,13
 SFAMA:,BSS,
C......   П/П ПOИCKA B FATA OБPAЗA(ACC)
C         ПO MACKE(BEPXYШKA CTEKA).
 14,VTM,-LTF
  ,WTC,ГYC.БЛOKИPOBKA
  ,XTS,REGSCAL.ПPOBEPKИ
  ,AAX,BIT30.ЗAHЯTOCTИ
  ,UZA,LSFM. - HET
  15,XTA,-1
  ,UZA,LSFM
  15,XTA,-2
  ,AAX,B24/1
  ,U1A,RSFM. - ДA
 LSFM:14,XTA,FATA+LTF
 15,AEX,-1
 15,AAX,-2
 ,UZA,RSFM
 14,VLM,LSFM
C
C...   A HE ЗAHЯT ЛИ ФAЙЛ Y COCEДA
C
  15,XTA,-2
  15,UTM,-2
  ,AAX,B24/1
  ,UZA,NOQUEST
  15,XTA,1
  ,UZA,NOQUEST
  ,ARX,BIT34
  ,APX,=0000 1740 7777 0000
  ,ASN,64+31
  ,AOX,BIT22
  13,MTJ,14
  ,CALL,K COCEДY
  :,24,3
  14,MTJ,13
  :,UZA,NOQUEST.CBOБOДEH
  ,UTC,-BIT1.ЗAHЯT
  NOQUEST:,XTA,BIT1
  13,UJ,
 RSFM:15,UTM,-2
 13,UJ,
 GI1Z:,BSS,
C......   П/П ЧTEHИЯ 1-OЙ ЗOHЫ KATAЛOГA
 ,ITA,AP.AДPEC ЛИCTA
 ,ASN,64-8
 ,ITS,NM.HOMEP MOДYЛЯ
 15,AOX,
 ,ASN,64-12.ФOPMИPOBKA
 ,AOX,CINF.ИHФ.CЛOBA
 ,AEX,INF.CTAPOE ИHФ.CЛOBO
 14,UZA,.ЗOHA B ПAMЯTИ
 ,AEX,INF
 ,UJ,TRAN.HA OБMEH
 GI2Z:,BSS,
C......   П/П ЧTEHИЯ 2-OЙ ЗOHЫ KATAЛOГA
 ,XTA,INF
 ,ARX,BIT1
 TRAN:,BSS,
 ,ATX,INF.TEKYЩЩЩEE ИHФ.
 ,ITA,14.CПACEHИE
C         ПOПЫTKA ЧTEHИЯ KATAЛOГA
 ,XTS,INF.BOЗBPATA
 14,VTM,13B
 14,MTJ,27B
 ,*70,
 ,U1A,RETRAN.ПPOЧЛOCЬ
 ,XTA,INF
 ,ARX,BIT2.ЧTEHИE
 ,*70,.ДYБЛЬ ЗOHЫ
 ,U1A,RETRAN.ЭTA ПPOЧЛACЬ
C         ДИAГHOCTИKA OTKAЗA
 ,ITA,NM
 ,ASN,64-42
 ,AUX,=6H'''''7''7'
 ,AOX,=6HГ 00''''
 ,STX,TEK+1
 ,24,2003B
 14,VTM,TEK
 ,ITA,14
 N,VTM,
 14,VTM,EN KOOR
 ,UJ,TTPRINT
 RETRAN:,BSS,
C         KATAЛOГ ПPOЧИTAH
 15,WTC,
 ,UJ,
 ORMAT:,BSS,
C......   П/П HAЛOЖEHИЯ HA ИHФ.ПOЛE
  ,WTC,SAVI14OW
   :   ,24,
 P,AOX,-1
 P,ATX,-1
   :   ,24,3
 14,UJ,
 NEXTWORD:,BSS,
C......   П/П ЧTEHИЯ CЛOBA ИHФ. ПOЛЯ
  ,WTC,SAVI14OW
   :   ,24,
 P,XTA,
   :   ,24,3
 P,UTM,1
 14,UJ,
 GIWOCA:,BSS,
C......   П/П ЧTEHИЯ CЛOBA KATAЛOГA
 L,V1M,RGWC.HE HOBЫЙ ЛИCT
 14,VJM,GI2Z
 L,VTM,-1024
 RGWC:,24,2000B
 L,UTC,1024
 AP,XTA,
 L,UTM,1
   :   ,24,3
 13,UJ,
 NNOFD:,BSS,
C......   П/П ПOИCKA MOДYЛЯ, HA KOTOPOM
C         CTOИT ДИCK C OЧEPEДHЫM ИMEHEM
C         ACC.NE.0=HET ДOCTYПA
 14,VJM,NEXTWORD.ИMЯ ДИCKA
 15,ATX,
  NM,VTM,77B
  ,WTC,ГYC
  ,ATX,DISNAM
  ,AAX,C7777
  ,ATI,MP.0-ПCEBДO
  ,UZA,RET1
 NM,VTM,1-16
 LSM:NM,XTA,DNAM+15
 15,AEX,-1
 ,U1A,ELSM
 ,XTA,CMDREC+1.
 NM,AAX,BIT48+15.ПPOБA "ДHO"
 ,U1A,ELSM.БЫЛO
 NM,UTM,15+30B
 ,XTA,CMDREC.ШK.ГOTOBHOCTИ
 NM,AAX,BIT48-24
 NM,AEX,BIT48-24
 ,U1A,RET1.HE ГOTOB
 T,VZM,RET1
 ,XTA,SMONOW
 NM,AAX,BIT48-24
 NM,AEX,BIT48-24
 RET1:15,UTM,-1
 13,UJ,
 ELSM:NM,VLM,LSM
 15,UTM,-1
 13,UJ,
  W/DOWN:8,Z00,SEMAFOR
  ,Z00,P/RET-BASA
  W/UP:8,Z00,SEMAFOR
  ,Z00,V/RET-BASA
 CINF:1,014,2
 ,,7774B
 D8/7F:,GOST,3H'177''177''177'
       ,CONT,3H'177''177''177'
 MASKEY:,OCT,7777 7740 74
 KEY:,OCT,6470 7240 40
 B28/27:,OCT,0000 0014
 C30:,LOG,30
 P770077:,OCT,770077
 B48/37:,OCT,7777
 B48/43:,OCT,77
 B48/33:,OCT,7777 74
 TEK:,ISO,12HKATAЛO
  INFW*57:,BSS,1
 NEWDI:,BSS,1
 TDSH:,BSS,1
 WORK:,BSS,16
 ,END,
  NRES064:,NAME,.05.06.78
C
C*****   HEPEЗИДEHT ЭKCTPAKOДA ПEЧATИ
C
  *TAKCA:LC,BLOCK,(5),CTLP
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 C1:,EQU,BIT1
 K06131:,EQU,BIT1
 K06457:,EQU,BIT34
C-----
 *ИПД:LC,BLOCK,XNF(5),XNC
 ,CONT,(2),Ш/CЛYЖ
 ,CONT,Ш/FULL(13),XLSMB
 ,CONT,(6),LISTFLAG(2),C/BUF
 ,CONT,(12),LIMLPSC,БЫЛ*64
 ,CONT,(5),EXTSC(11),БЫЛ*ПФ
 ,CONT,SCENDJO
 NF:,WEQ,XNF
 NC:,WEQ,XNC
 LSMB:,WEQ,XLSMB
 NDIV:,LC,2
 SCALES:LC,BLOCK,(3),STCLTA(3),SCWPRIN
 *WRBF64:,SUBP,
 NRESCALL:,SUBP,
 SELECT  :  ,SUBP,
 PERMIR  :  ,SUBP,
 FULSAV  :  ,SUBP,
 SAVIND  :  ,SUBP,
 ДHЗ:LC,BLOCK,(1),BITJ
 C37     :  ,LC,1
 C7      :  ,LC,1
 C3      :  ,LC,1
 C77777  :  ,LC,1
 FULWOR  :  ,LC,1
 *BUFLP1:LC,BLOCK,(1),LP1IFJ.
 *BUFLP2:LC,BLOCK,(1),LP2IFJ.
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR(6)
  ,CONT,AЦПY(2)
 LP LIM:,EQU,116B
 LP STR:,EQU,126B
 ИП PEД:,EQU,1000B
  *100:B,BLOCK,*AC,*R,*AR,*R33,*R32,*R27
  ,CONT,*R16,*R15,*R14,*R13(6),*R7
  MA64*:,SUBP,
  *C:LC,BLOCK,(2),C574
  *CB:LC,BLOCK,(1),C17(0),K06135
  C77:,LC,1
  BASEPRTA:,LC,1
  NRPRTA:,SUBP,
  PRINTASK:,SUBP,
  NRESOFF:,SUBP,
  NR/64:,SUBP,
  *PR/COM:LC,BLOCK,CNSTRI(2),COLDBLS(2),CNEWBLS(2)
 SMASAV:LC,BLOCK,(3)
 ,CONT,SAVI15,SAVI14,SAVI13
 CLANEWTA:,SUBP,.
 TTPRINT:,SUBP,.
 DISREG:,LC,1
 M:,EQU,100B.
 REGSCAL:,EQU,M.
 M72:,EQU,M+2.
 M75:,EQU,M+5.
 NAME:,EQU,120B
 AB:,EQU,9.
 RT:,EQU,14.
 RB:,EQU,2.
 NS:,EQU,3.
 BISTIME:,EQU,110B.
 WS/DEBUG:24,EQU,615B.P.ПOЛE
 C177:LC,BLOCK,K06137.
 K06141:,EQU,C77777.
 K06133:,EQU,C7.
 C13:LC,BLOCK,K06143.
 K06365:,EQU,FULWOR.
 C377:LC,BLOCK,K06366.
 C76000:,LC,1
 TP:,EQU,14B.И10 ДЛЯ PACПEЧATKИ
 NLP:,EQU,12B.И12 ДЛЯ PACПEЧATKИ
 *TYPELP:LC,BLOCK,(1)
C     ЯЧEЙKИ TИПA PП
 *17:B,BLOCK,LB,CNT
 *22:B,BLOCK,BT
 *30:B,BLOCK,QUEFLAG,TE,EBUF,OVFLAG,LBUF
C     ЯЧEЙKИ TИПA P
 *1:,BLOCK,(9),M/EXT
 *35:B,BLOCK,B145,B146,B147,B144
 ,CONT,RL,RR,BLS,LS,EXPPOS
 ,CONT,NEWBLS,OLDBLS,B150,PFLAG
 ,CONT,B152,B153,B154,B 71,B156
 ,CONT,B157,B160,B161,B162,B163,B164
 ,CONT,B165,B166,B120,SMB,B171
 ,CONT,B172,RES1,B125
 ,CONT,NSTRI,BL A NL
 *130:B,BLOCK,SI13
  ***:7,REL,***
  ,WTC,ГYC
  15,VTM,
  ,XTA,SAVI13
  ,ASN,64-15
  ,AOX,SAVI14
  ,ASN,64-15
  15,AOX,M72
  15,ATX,M72.13,14,27
  ,ITA,32B
  ,ASN,64-15
  ,AOX,SAVI15
  ,ASN,64-15
  15,AOX,M75
  15,ATX,M75.32,15,7
 ,XTA,LISTFLAG
 ,AAX,BITJ
 ,U1A,BUF PR.= БYФEPИЗAЦИЯ
 15,XTA,REGSCAL
 ,AAX,BIT7
 ,U1A,BUF PR.TOЛЬKO HA TEPM
  ,ITA,7
  ,ARX,IWPRTA
  ,UJ,NRESCALL
  IWPRTA:,Z00,NRPRTA
  ,Z00,AFTER-***
  AFTER:,ATX,WS
  ,ATI,15
  ,XTA,BASEPRTA
  ,U1A,PRTAIS
  15,UTM,LP1IFJ-PRINTASK
  14,VTM,-1
  BYCЫ:,ITA,15
  14,AEX,AЦПY+1
  ,AAX,C77777
  14,AEX,AЦПY+1
  14,ATX,AЦПY+1
  ,XTA,WS
  15,ATX,3
  ,ITA,15
  15,ATX,7
  ,ARX,C140
  15,ATX,BT
  15,ATX,TE
  ,ARX,=320
  15,ATX,EBUF
  15,UTM,LP2IFJ-LP1IFJ
  14,VLM,BYCЫ
  PRTAIS:,BSS,
  14,VTM,2
  15,VTM,
  CHLP:,XTA,7
  14,AAX,BIT47
  ,UIA,BLOCK
  14,XTA,AЦПY-1
  ,ASN,64+36
  ,AAX,C77
  ,UZA,FREE
  ,AEX,ДHЗ
  ,UZA,LPOWN
  ,UJ,ECHLP
  FREE:14,MTJ,15
  ,UJ,ECHLP
  BLOCK:14,XTA,AЦПY-1
  ,AOX,=:0077
  ,AEX,=:0077
  14,ATX,AЦПY-1
  ECHLP:14,UTM,-1
  14,VIM,CHLP
  15,VZM,ABSENT
  15,MTJ,14
  LPOWN:,XTA,ДHЗ
  ,ASN,64-36
  14,AOX,AЦПY-1
  14,ATX,AЦПY-1
  ,ATI,15
  ,XTA,BASEPRTA
  ,UIA,L11545
  ,XTA,WS
  ,ATX,BASEPRTA
  14,XTA,CNSTRI-1
  15,ATX,NSTRI
  14,XTA,COLDBLS-1
  15,ATX,OLDBLS
  14,XTA,CNEWBLS-1
  15,ATX,NEWBLS
  ,ITA,14
  ,AEX,C3
  ,ATI,14
  14,WTC,AЦПY-1
  13,VTM,
  14,XTA,CNSTRI-1
  13,ATX,NSTRI
  14,XTA,COLDBLS-1
  13,ATX,OLDBLS
  14,XTA,CNEWBLS-1
  13,ATX,NEWBLS
 L11545:,BSS,
 15,XTA,QUEFLAG
 ,U1A,L11546
 ,XTA,7
 ,ASN,64+30
 15,WTC,NLP
 ,AAX,BIT4
 ,AAX,*TYPELP
 15,ATX,TP
 L11546:,BSS,
 15,XTA,TP
 ,U1A,REDYLP.ECЛИ ПEЧATЬ EC
 ,032,4031B.
 15,WTC,NLP
 ,AAX,BIT20
 ,UZA,REDYLP.AЦПY ГOTOBO
 ,AOX,NDIV.- AЦПY(NLP)
 ,ATX,NDIV. = HEГOT.
 14,VTM,SCWPRIN
 13,VTM,NRDTEXT
 PRTAREF:,XTA,BITJ
 14,AOX,
 14,ATX,
 ,ITA,7
  ,ARX,IREF
  ,UJ,NRESOFF
  IREF:,Z00,NRPRTA
  ,Z00,TTDIAGN-***
  ABSENT:,BSS,
 13,VTM,HETAЦПY
 14,VTM,STCLTA
  ,UJ,PRTAREF
 TT DIAGN:,ITA,13
 14,VJM,TT PRINT
 15,VTM,MA64*
 15,MTJ,33B
 ,XTA,DISREG
 ,ATI,27B
 ,WTC,ГYC
 ,XTA,M72
 ,ASN,64+15
 ,ATI,14
 ,ASN,64+15
 ,ATI,13
 ,WTC,ГYC
 ,XTA,M75
 ,ASN,64+15
 ,ATI,15
 ,ASN,64+15
 ,ATI,32B
 ,XTA,BRET
 ,WTC,ГYC
 ,WTC,M75
 7,VTM,
 ,UJ,NRESOFF
 BUF PR:,BSS,
C
C  БYФEPИЗAЦИЯ BЫBOДA
C
 ,WTC,ГYC
 15,VTM,ИП PEД
 ,ITA,15
 15,AEX,BT
 ,AAX,C76000
 15,AEX,BT.ДЛЯ *WRBF:
 15,ATX,BT.HAЧAЛO ДAHHЫX
 15,AEX,TE
 ,AAX,C76000
 15,AEX,TE
 15,ATX,TE.KOHEЦ ДAHHЫX
 15,AEX,EBUF
 ,AAX,C76000
 15,AEX,EBUF
 15,ATX,EBUF.KOHEЦ M.БYФ
C HE MEHЯЮTCЯ EBUF И LBUF
C OHИ YCTAHABЛИBAЮTCЯ B ПYCKAЧE
 REDYLP:,BSS,.
 ,WTC,ГYC
 ,XTA,REGSCAL
 ,AAX,BIT44
 ,UZA,NON DP
 ,XTA,DP.ПPOTЯЖKИ B HAЧ.Л
 NON DP:15,ATX,PFLAG
 ,XTA,БЫЛ*64
 ,AAX,BITJ
 ,U1A,NON FIRST
 ,XTA,6
  ,AEX,*TYPELP
C  PEЖИM ЭKOHOMИИ БYMAГИ CAMOЙ ЗAДAЧEЙ
C  ЗAДAETCЯ B HACTPOЙKE ДИCПETЧEPA,
C  HO MOЖET БЫTЬ ИЗMEHEH ПPИ HAЖATИИ
C  16-ГO PAЗPЯДA HA 6 T.P., A TAKЖE
C  CAMИM USER'OM ПPИ ПOMOЩИ Y.K.
C      *PAGE:...,LIST
 ,AAX,BIT16
 ,WTC,ГYC
 ,AOX,REGSCAL
 ,WTC,ГYC
 ,ATX,REGSCAL
 ,XTA,BITJ
 ,AAX,Ш/CЛYЖ
 ,UZA,NO TPRNT
 ,WTC,ГYC
 ,XTA,NAME
 ,AEX,=6HB Ы B
 ,U1A,NO TPRNT
C
C   ДЛЯ ЗAДAЧИ BЫBOДA HEДOBEДEM ДBE CTPOKИ
C   ДO HAЧAЛA ПEPBOГO ЛИCTA, ЧTOБЫ EЙ БЫЛO
C   ГДE HAПEЧATATЬ HOMEP CTPAHИЦЫ.
C
 15,XTA,NSTRI
 ,ARX,BIT2
 15,ATX,NSTRI
 NO TPRNT:,BSS,
  ,XTA,DP
  15,ATX,PFLAG
 ,XTA,BITJ
 ,AOX,БЫЛ*64
 ,ATX,БЫЛ*64
 15,XTA,NSTRI
 ,AEX,FULWOR.
 ,ARX,FPL.
 15,ARX,OLDBLS.
 15,ATX,OLDBLS.ПPOTЯЖKИ ДЛЯ BЫГOHA
 ,XTA,.B HAЧAЛO ЛИCTA
 15,ATX,NSTRI
 NON FIRST:15,XTA,OLDBLS
 ,ASN,64-40.B HAЧAЛO ЛИCTA
 15,WTC,TE.
 ,ATX,.B БYФEP
 15,UTM,100B.
 13,VJM,FULSAV+1.
   :    ,24,3
 ,NTR,0.
 15,UTM,-126B.
 15,XTA,NLP.
 ,ATI,12.
  ,WTC,ГYC
  ,XTA,M72
  15,ATX,*R27
  ,ASN,64+15
  15,ATX,*R14
  ,ASN,64+15
  15,ATX,*R13
  ,WTC,ГYC
  ,XTA,M75
  15,ATX,*R7
  ,ASN,64+15
  15,ATX,*R15
  ,ASN,64+15
  15,ATX,*R33
  15,XTA,*AC
  6,VJM,GIVADR
  ,AAX,C77777
  15,ATX,B154.AKOH
  15,XTA,*AC
  ,ASN,64+24
  6,VTM,AFTGA
  GIVADR:15,ATX,*R16.P.Я.
  ,ASN,64+20
  ,AAX,C17
 ,UZA,IND/0
  ,AEX,C17
  ,ATI,8
  8,UTC,
  15,XTA,*R15
 IND/0:,BSS,
  ,AAX,C77777
  15,ARX,*R16
  ,AAX,=10 77777
  6,UJ,
  AFTGA:15,ATX,B125.AHAЧ
  15,XTA,*R14
  ,AAX,C77777
  15,ATX,B171
 ,ITA,.
          15,  ATX  , B150          .
          15,  ATX  , B152          .
 15,ATX,LS.
 15,ATX,EXPPOS.
 15,ATX,B71.
 15,ATX,B172.
          15,  ATX  , B120          .
          15,  ATX  , B153          .
          15,  ATX  , BLS           .
 15,ATX,BL A NL.
          15,  XTA  , B125          .
            ,  ATI  ,  8            .
 15,WTC,TE.
 9,VTM,.
 6,VTM,1.
 5,VTM,.
 ,ASN,64+15.
 ,UZA,L06206.
C     BXOД ПO COSY ГOCTY MИHYЯ PEДAKTИPOBAHИE
 6,VTM,.
 11,VJM,R WORD.
 15,ATX,B154.
 ,ASN,64+40.
 15,ATX,NEWBLS.
 15,ARX,OLDBLS.
 15,ATX,OLDBLS.
 ,NTR,3.
 5,VJM,CHEKP.KOPPEKЦИЯ ПPOTЯЖEK
 ,ITA,.
 15,ATX,NEWBLS.
 5,VJM,CHEKP2.YЧET ЛИCTOBAHИЯ
 15,XTA,OLDBLS.
 15,ARX,RR.
 ,ASN,64-40.
  15,AEX,B154
  ,AAX,=:776
  15,AEX,B154
  5,VTM,-26.MAKC=160 CИMB.
 L06200:8,UTM,1.
 15,ATX,B154.
 9,ATX,.B БYФEP
 ,AAX,C177.
 ,AEX,CENDSTR.
 ,UZA,BUFST.KOHEЦ CTPOKИ
 2,VJM,BUFSTEP.
 11,VJM,R WORD.
 5,VLM,L06200
 9,ATX,.
 ,UJ,BUFST.
C
C  HAЧAЛO PAЗБOPA
C
 L06206  :15,  XTA  , B153          .
            ,  U1A  ,L06336         .
            ,  XTA  ,K06141         .
          15,  ATX  , B153          .
          11,  VTM  ,L06212         .
  15,WTC,B171
  10,VTM,
 L06211  :10,  UTM  , 00001B        .
 ,UJ,READ.
  L06321:15,XTA,*R14
  15,ATX,B171
  L06243:11,VTM,L06246
 R WORD:8,MTJ,10.
 READ:,BSS,.
 ,WTC,ГYC.
 ,WTC,M72.
   :              ,   24  ,               .
 10,XTA,.
   :              ,   24  , 00003B        .
          11,   UJ  ,               .
 L06336  :15,  XTA  , B157          .
          15,  ARX  , B161          .
          15,  ATX  , B157          .
            ,  ATI  ,  1            .
          15,  XTA  , B160          .
            ,  ATI  ,  5            .
          15,  XTA  , B156          .
 L06230  :  ,  AAX  , C3            .
            ,  UZA  ,L06240         .
            ,  AEX  ,K06131         .
            ,  U1A  ,L06233         .
           2,  VTM  , 00027B        .
            ,  ITA  ,  2            .
          15,  ATX  , B160          .
 L06233  :15,  XTA  , B157          .
          15,  ARX  , B160          .
            ,  ARX  ,K06142         .
            ,  ASN  ,64+7           .
            ,  UZA  ,L06240         .
          15,  ATX  , B150          .
          15,  XTA  , B166          .
          15,  ATX  , B157          .
            ,  ATI  ,  1            .
            ,  ATX  ,               .
 L06240  :15,  XTA  , B162          .
            ,  U1A  ,L06323         .
          15,  ATX  , B153          .
          15,  XTA  , B163          .
            ,  U1A  ,L06321         .
  15,XTA,B171
  ,ARX,BIT1
  ,AAX,C77777
  15,ATX,B171
  ,UJ,L06243
 L06323  :15,  XTA  , B162          .
            ,  ARX  ,K06142         .
 L06324  :15,  ATX  , B162          .
            ,  AEX  ,K06365         .
            ,  UZA  ,L06324         .
            ,   UJ  ,L06243         .
 L06212  :15,  ATX  , B165          .
            ,  ASN  ,64+44          .
            ,  AAX  ,K06133         .
          15,  ATX  , B156          .
          15,  XTA  , B165          .
            ,  ASN  ,64+36          .
            ,  AAX  ,K06137         .
          15,  ATX  , B157          .
          15,  ATX  , B166          .
            ,  ATI  ,  1            .
          15,  XTA  , B165          .
            ,  ASN  ,64+24          .
            ,  AAX  ,K06137         .
          15,  ATX  , B160          .
            ,  ATI  ,  5            .
          15,  XTA  , B165          .
            ,  ASN  ,64+23          .
            ,  AAX  ,K06131         .
          15,  ATX  , B163          .
          15,  XTA  , B165          .
            ,  ASN  ,64+12          .
            ,  AAX  ,K06137         .
          15,  ATX  , B161          .
          15,  XTA  , B165          .
            ,  AAX  ,K06137         .
          15,  ATX  , B162          .
          15,  XTA  , B156          .
            ,   UJ  ,L06230         .*****
 L06246  :15,  ATX  , B144          .
          15,  XTA  , B156          .
            ,  ASN  ,64+2           .
            ,  U1A  ,L06250         .
  6,VTM,L06314
          15,  WTC  , B156          .
            ,   UJ  ,L06306         .*****
 L06250  : 5,  VTM  , 00070B        .
           6,  VTM  ,L06260         .
 ,ITA,8. ЗAПOMИHAEM
 15,ATX,B125.HAЧAЛO TEKCTA
 SYM IN:5,UTM,-8.
 5,VIM,NO WORD.
C.....   ПPOBEPKA KOHЦA TEKCTA
 15,XTA,B125.ECЛИ AH = AK ,
 15,AEX,B154. ЛOBИM CИMBOЛЫ
 ,UZA,NO END. '231'/'172'
 ,ITA,8. ДOШЛИ
 15,AEX,B154.ДO KOHЦA
 ,UIA,NO END.- HET
 ,XTA,C231.- KOHEЦ ПO
 ,UJ,S IS.  AДPECY
 NO END:8,UTM,1.
 11,VJM,R WORD.
 5,VTM,48.
 15,ATX,B144.
 NO WORD:15,XTA,B144.
 ,ASN,64-8
 15,ATX,B144
 ,YTA,
 S IS:,BSS,
          15,  ATX  , B147          .
 ,ATI,11
          15,  XTA  , B156          .
            ,  ASN  ,64+2           .
 L05303  :  ,  U1A  ,L05305         .
          15,  XTA  , B147          .
 6,UJ,
 L05305  :15,  XTA  , B147          .
            ,  ASN  ,64+4           .
            ,  UZA  ,L05303         .
            ,  AAX  ,BIT1           .
          14,  VTM  , 00030B        .
            ,  UZA  ,L05311         .
          14,  VTM  ,               .
            ,  ATX  ,               .
 L05311  :15,  XTA  , B147          .
            ,  AAX  ,K06135         .
            ,  ATI  ,  2            .
          15,  XTA  , B147          .
            ,  ASN  ,64+6           .
            ,  UZA  ,L05316         .
          14,  UTM  , 00010B        .
            ,  AAX  ,BIT1           .
            ,  U1A  ,L05316         .
          14,  UTM  , 00010B        .
 L05316:2,XTA,TAБЛABT.
          14,  ASN  ,64             .
            ,  AAX  ,K06366         .
 15,ATX,B147
 ,ATI,11
 6,UJ,
 L06260  :15,  ATX  , B164          .
            ,  XTA  ,               .
 L06261  :15,  ATX  , B172          .
 6,VJM,SYM IN.
 1,MTJ,14
 14,UTM,-200B
 14,V1M,L02232
          15,  XTA  , B154          .
            ,  UZA  ,L06277         .
 ,BSS,.
C
C*****   PAЗБOP YПPABЛЯЮЩИX CИMBOЛOB
C
 '    265 , 174 - REPEAT LAST SYMBOL
 '    214 , 175 - NEW LINE
 '    242 , 017 - BLANK
 '    231 , 172 - END OF INFORMATION
 '    200 , 173 - NUMBER OF POSITION
 '    176 - BLANK
 '    177 - DOUBLE SYMBOL ':='
 '    201 - NEW PAGE
 '    204 - NEW 1/2-PAGE
 '    205 - NEW 1/3-PAGE
 '    206 - NEW 1/4-PAGE
 '    212 - SAME STRING
 '    310 - BLOCK OF PAGING
C
 L02232:,BSS,
 11,UTM,-265B
 11,VZM,L15773
 11,UTM,265B-174B
 11,VZM,L15773
          15,  XTA  , B164          .
            ,  ATI  ,  2            .
 2,UTM,-17B
 2,VZM,L06540
 ,ARX,BIT6
 ,ASN,64+7
 ,UZA,L16042
 2,UTM,17B-214B
           2,  VZM  ,L06351         .214
           2,  UTM  , 00017B        .
           2,  VZM  ,L06351         .175
           2,  UTM  , 77733B        .
           2,  VZM  ,L06540         .242
 2,UTM,242B-231B
           2,  VZM  ,L06334         .231
           2,  UTM  , 00037B        .
           2,  VZM  ,L06334         .172
           2,  UTM  , 77772B        .
           2,  VZM  ,L06275         .200
           2,  UTM  , 00005B        .
           2,  VZM  ,L06275         .173
           2,  UTM  , 77775B        .
           2,  VZM  ,L06540         .176
           2,  UTM  , 77775B        .
           2,  V1M  ,L16013         .
C.....   PEAЛИЗAЦИЯ 'NEW PAGE'
 L16001  :15,  XTA  , NSTRI         .
            ,  AEX  , DP            .
            ,  U1A  ,L16005         .
          15,  ATX  , BLS           .
            ,  XTA  ,BIT1           .
          15,  ATX  , B71           .
 L16040:,BSS, .БЫЛO - L16040:15,WTC,B57
           1,  VTM  ,               .
 L06542  :15,  XTA  , B147          .
            ,   UJ  ,L06260         .
 L16005  :15,  XTA  , NSTRI         .
            ,  AEX  , FULWOR        .
            ,  ARX  , DP            .
            ,  U1A  ,L16010         .
            ,  ARX  , FPL           .
            ,  ATX  ,               .
 L16010  :15,  ATX  , BLS           .
 15,ATX,B150.
            ,  XTA  ,               .
          15,  ATX  , PFLAG         .
            ,   UJ  ,L16040         .*****
 L16013  : 2,  UTM  , 77775B        .
           2,  V1M  ,L16015         .
 ,XTA,C41
 L16022  :15,  ATX  , BLS           .
          15,  XTA  , NSTRI         .
            ,  AEX  , FULWOR        .
            ,  ARX  , DP            .
 L16024  :15,  ARX  , BLS           .
            ,  U1A  ,L16010         .
           2,  VLM  ,L16024         .
            ,   UJ  ,L16001         .
 L16015  : 2,  UTM  , 77777B        .
           2,  V1M  ,L16020         .
            ,  XTA  ,BIT5           .
            ,  ARX  , DP            .
           2,  VTM  , 77777B        .
            ,   UJ  ,L16022         .
 L16020  : 2,  UTM  , 77777B        .
           2,  V1M  ,L06532         .
            ,  XTA  ,BIT5           .
           2,  VTM  , 77776B        .
            ,   UJ  ,L16022         .*****
 L06532  : 2,  UTM  , 77774B        .
           2,  VZM  ,L06536         .212
           2,  UTM  , 77702B        .
  ,XTA,
 2,V1M,L16041
          15,  ATX  , PFLAG         .
            ,   UJ  ,L06542         .
 L16041:,BSS,
 15,ATX,B71
 ,UJ,L05400
 L16042:,BSS,
          15,  ATX  , B71           .
 L06277  :15,  XTA  , B164          .
          15,  ATX  , SMB           .
           4,  VJM  ,L06147         .
 L06302  :15,  XTA  , B172          .
 ,UZA,L06542.- HET ПOBTOP.
 ,ARX,C77777
 ,AAX,C77777
          15,  ATX  , B172          .
 ,UJ,L06277.
C.....   BЫДAЧA CИMBOЛA
 L06147  :15,  XTA  , B150          .
            ,  UZA  ,L06345         .
C.....   ПEPEXOД HA HOBYЮ CTPOKY
 NEW STR:,BSS,.
 L06150  :15,  XTA  , B154          .
            ,  UZA  ,L02101         .
          15,  XTA  , BLS           .
            ,  U1A  ,L06152         .
            ,  XTA  ,BIT1           .
            ,  ATX  ,               .
 L06152  :15,  ATX  , BLS           .
          15,  XTA  , B152          .
            ,  UZA  ,L14602         .
          15,  XTA  , B165          .
            ,  ASN  ,64+20          .
            ,  AAX  , C7            .
          15,  ARX  , BLS           .
          15,  ATX  , BLS           .
 L14602  :  ,  XTA  ,               .
          15,  ATX  , B150          .
          15,  ATX  , B120          .
 L06157  :    ,BSS  ,               .
          15,  XTA  , B71           .
 ,UZA,END STRI
            ,  XTA  ,               .
          15,  ATX  , B71           .
          15,  ATX  , BLS           .
 ,UJ,END STRI
 L02101  :15,  XTA  , SMB           .
          15,  ATX  , BLS           .
            ,  XTA  ,K06330         .
          15,  ATX  , SMB           .
          15,  ATX  , B152          .
            ,   UJ  ,L06157         .
 L06345  :  ,  ITA  ,  1            .
            ,  ASN  ,64+7           .
            ,  UZA  ,L06000         .
           1,  UTM  , 77600B        .
            ,   UJ  ,L06150         .
 L06000  :15,  XTA  , B120          .
            ,  U1A  ,L06005         .
            ,  XTA  ,L06000         .
          15,  ATX  , B120          .
            ,  XTA  ,               .
          15,  ATX  , EXPPOS        .
 L06003  : 3,  VTM  , 77730B        .
          15,  ATX  , BLS           .
          15,  XTA  , TE            .
            ,  ATI  ,  9            .
C<<<    ЗДECЬ MOЖHO CЭKOHOMИTЬ!
 L06005:,BSS,
 ,ITA,1
 15,AEX,EXPPOS
 ,UZA,L06013
            ,  NTR  , 00003B        .
            ,  ITA  ,  1            .
          15,  A-X  , EXPPOS        .
            ,  NTR  , 00020B        .
            ,  U1A  ,L06165         .
            ,  ARX  ,K06137         .
          14,  VJM  , WRTSM         .
 L06013  :15,  XTA  , SMB           .
          14,  VJM  , WRTSM         .
           1,  UTM  , 00001B        .
            ,  ITA  ,  1            .
          15,  ATX  , EXPPOS        .
           4,   UJ  ,               .
 L06165  :  ,  XTA  ,               .
            ,   UJ  , ZNB           .
 L05400  :15,  XTA  , B164          .
 ,AEX,C177.CИMBOЛ - ':='
            ,  U1A  ,L05575         . - HET
            ,  XTA  , C37           .
          15,  ATX  , SMB           . ':'
           4,  VJM  ,L06147         .
            ,  XTA  ,K05405         .
          15,  ATX  , SMB           . '='
           4,  VTM  ,L06302         .
            ,   UJ  ,L06147         .
 L05575  :  ,  XTA  ,K06245         .
          15,  ATX  , SMB           .
 4,VTM,L06302.
 ,UJ,L06147.
C.....   ПEЧATЬ БEЗ ПPOTЯЖKИ
 L06536  :15,  XTA  , OLDBLS        .
            ,  UZA  ,L06542         .
            ,  NTR  , 00003B        .
            ,  A-X  ,BIT1           .
          15,  ATX  , OLDBLS        .
            ,  ASN  ,64-40          .
          15,  WTC  , TE            .
            ,  ATX  ,               .
          15,  XTA  , NSTRI         .
            ,  U1A  ,L14577         .
            ,  XTA  , FPL           .
 L14577  :  ,  A-X  ,BIT1           .
          15,  ATX  , NSTRI         .
            ,  NTR  , 00004B        .
            ,   UJ  ,L06542         .
C.....   HOMEP ПOЗИЦИИ : CИMBOЛ '200'
 L06275  :15,  XTA  , B147          .
 ,AEX,C231.
 ,UZA,L06334.
 ,ITA,1.
 ,ASN,64+7.
 ,U1A,NEW LIN.
 NON NEWL:,BSS,.
 15,XTA,B147.
            ,  ATI  ,  1            .
           6,  VTM  ,L06260         .
 ,UJ,SYM IN.
 NEW LIN:,BSS,.
 15,ATX,BL A NL.
 ,UJ,NEW STR.
C.....   KOHEЦ  Б Ц И
 L06334  : 5,  UTM  , 77720B        .
           5,  V1M  ,L06314         .
           8,  UTM  , 77777B        .
 L06314  :  ,  ITA  ,  8            .
           8,  UTM  , 00001B        .
            ,  AEX  ,K06365         .
          15,  ARX  , B154          .
            ,  ASN  ,64+15          .
            ,  UZA  ,L06326         .
          15,  ATX  , B150          .
          15,  ATX  , B152          .
            ,   UJ  ,L06150         .
 L06326  :15,  XTA  , B153          .
            ,  U1A  ,L06206         .
          15,  XTA  , B163          .
          15,  AOX  , B150          .
          15,  ATX  , B150          .
  15,WTC,B171
  10,VTM,
          11,  VJM  ,L06211         .
            ,  ASN  ,64+36          .
            ,  AAX  ,K06137         .
          15,  ATX  , B157          .
            ,  ITA  ,  1            .
            ,  ARX  ,K06142         .
            ,  NTR  , 00003B        .
          15,  A-X  , B157          .
            ,  NTR  , 00020B        .
            ,  U1A  ,L06206         .
            ,  XTA  ,K06141         .
          15,  ATX  , B150          .
            ,   UJ  ,L06206         .
C.....   ГPYППA ПPOБEЛOB
 L06540:15,WTC,B172.
           1,  UTM  , 00001B        .
 15,XTA,B147
 ,UJ,L06260
 L06351  :15,  XTA  , BLS           .
            ,  ARX  ,BIT1           .
          15,  ARX  , B172          .
          15,  ATX  , B150          .
          15,  ATX  , BLS           .
 ,UJ,L16040.
C.....   CИMBOЛ ПOBTOPEHИЯ : 256 / 174
 L15773  :15,  XTA  , B164          .
            ,  ATI  ,  2            .
           2,  UTM  , 77600B        .
           2,  VZM  ,L06275         . - 200
           2,  UTM  , 00005B        .
           2,  VZM  ,L06275         . - 173
           2,  UTM  , 77742B        .
           2,  VZM  ,L06334         . - 231
           2,  UTM  , 00037B        .
           2,  VZM  ,L06334         . - 172
 6,VJM,SYM IN.
 ,AEX,C231.
 ,UZA,L02232.
 15,XTA,B147.
 ,UJ,L06261.
 L15774:,BSS,
 ,ITA,1
 ,AAX,K06137
 ,ATI,1
 ,XTA,
 ,UJ,L06003
 CONT RED:,BSS,.PEДAKTИPOBAHИE
          15,  XTA  , NEWBLS        .
 ,UZA,L15774
 15,XTA,BL A NL.
 ,UZA,N BLL.
 ,XTA,.
 15,ATX,BL A NL.
 ,UJ,NON NEWL.
 N BLL:15,XTA,NEWBLS.
 ,UJ,L06147.
C*****   ПEPEKЛЮЧATEЛЬ TИПA ФOPMATA
 L06306  :  ,   UJ  ,L06250         .
  :,UJ,L06045
  :,UJ,L06033
         : 5,  UTM  , 77774B        .
            ,  ITA  ,  5            .
C*****
            ,  AAX  ,K06137         .
          15,  ATX  , B146          .
C.....   PEДAKTИPOBAHИE ЧИCEЛ
 15,XTA,B144
            ,  AVX  ,               .
          15,  ATX  , B144          .
            ,  XTA  ,K06134         .
          15,  ATX  , SMB           .
           5,  VTM  , 00001B        .
           4,  VTM  ,L06101         .
 L06064  :15,  XTA  , B144          .
            ,  AMX  ,K06361         .
            ,  U1A  ,L06070         .
           5,  UTM  , 00012B        .
          15,  XTA  , B144          .
            ,  A*X  ,K06360         .
 L06067  :15,  ATX  , B144          .
            ,   UJ  ,L06064         .
 L06070  :15,  XTA  , B144          .
            ,  UZA  ,L06344         .
            ,  AMX  ,K06362         .
            ,  UZA  ,L06107         .
           5,  UTM  , 77777B        .
          15,  XTA  , B144          .
            ,  A*X  ,K06361         .
            ,   UJ  ,L06067         .
 L06344:5,VTM,
 L06107  :15,  XTA  , B144          .
            ,  ASN  ,64+40          .
            ,  AAX  ,K06131         .
            ,  ARX  ,K06134         .
          15,  ATX  , SMB           .
           4,  VJM  ,L06147         .
            ,  XTA  ,K02700         .
          15,  ATX  , SMB           .
           4,  VJM  ,L06147         .
          15,  XTA  , B144          .
          15,  AVX  , B144          .
          15,  ATX  , B144          .
            ,  NTR  , 00003B        .
            ,  A+X  ,K06130         .
            ,  AAX  ,K06135         .
          15,  ATX  , SMB           .
            ,  AOX  ,K06130         .
            ,  NTR  ,               .
            ,  A+X  ,               .
          15,  X-A  , B144          .
            ,  A*X  ,K06361         .
          15,  ATX  , B144          .
          15,  XTA  , B146          .
            ,  ARX  ,K06142         .
          15,  ATX  , B146          .
            ,  ARX  ,K06131         .
            ,  ASN  ,64+7           .
            ,  UZA  ,L06147         .
            ,  XTA  ,BIT5           .
          15,  ATX  , SMB           .
           4,  VJM  ,L06147         .
            ,  XTA  ,K06134         .
          15,  ATX  , SMB           .
           4,  VTM  ,L06101         .
            ,  ITA  ,  5            .
            ,  ASN  ,64+7           .
            ,  UZA  ,L06147         .
            ,  ITA  ,  5            .
            ,  AEX  ,K06141         .
            ,  ARX  ,K06131         .
            ,  ATI  ,  5            .
            ,  XTA  ,K06143         .
 L06100  :15,  ATX  , SMB           .
            ,   UJ  ,L06147         .
C......   PEДAKTИPOBAHИE KOHCTAHT
 L06033  :  ,  ITA  ,  5            .
           6,  UZA  ,               .
            ,  ARX  ,K06135         .
            ,  ASN  ,64+5           .
            ,  UZA  ,L06036         .
           5,  VTM  , 00020B        .
 L06036  : 5,  MTJ  ,  2            .
           5,  J+M  ,  2            .
           5,  J+M  ,  2            .
           2,  UTM  , 00020B        .
 L06040  :15,  XTA  , B144          .
           2,  ASN  ,               .
          15,  ATX  , B144          .
            ,  ASN  ,64+45          .
          15,  ATX  , SMB           .
           4,  VJM  ,L06147         .
           2,  VTM  , 00075B        .
           5,  UTM  , 77777B        .
           5,  V1M  ,L06040         .
           6,   UJ  ,               .
C.....   PEДAKTИPOBAHИE KOMAHД
 L06045  : 2,  VTM  , 77777B        .
           5,  VTM  , 77777B        .
 L06046  :15,  XTA  , B144          .
 2,AUX,K06124+1.
           2,  AOX  ,K06127         .*****
          15,  ATX  , B145          .
            ,  AAX  ,K06457         .
            ,  UZA  ,L06052         .
           2,  VLM  ,L06046         .
 L06052  :15,  XTA  , B145          .
            ,  ASN  ,64+44          .
          15,  ATX  , SMB           .
            ,  AAX  ,K06127         .
            ,  U1A  ,L06166         .
           4,  VJM  ,L06147         .
          15,  XTA  , B145          .
            ,  ASN  ,64-4           .
          15,  ATX  , B145          .
            ,  U1A  ,L06052         .
          15,  XTA  , B144          .
            ,  ASN  ,64-24          .
          15,  ATX  , B144          .
           2,  VTM  , 77777B        .
           5,  VLM  ,L06046         .
           6,   UJ  ,               .
 L06166  : 1,  UTM  , 00001B        .
           4,   UJ  ,               .
C.....   K PEДAKTИPOBAHИЮ ЧИCEЛ
 L06101  :  ,  XTA  ,               .
          15,  ATX  , SMB           .
           5,  UTM  , 77766B        .
            ,  ITA  ,  5            .
            ,  ARX  ,K06131         .
            ,  ASN  ,64+5           .
            ,  UZA  ,L06144         .
           4,  VJM  ,L06147         .
           5,  UTM  , 00012B        .
            ,  ITA  ,  5            .
 L06106:6,MTJ,4.
 ,UJ,L06100.
 L06144  :  ,  XTA  ,K06131         .
           4,  VJM  ,L06100         .
            ,  ITA  ,  5            .
            ,   UJ  ,L06106         .
C....
 ENDSTRI:,BSS,.
C    KOHEЦ CTPOKИ
  ,WTC,ГYC
  ,XTA,REGSCAL
  ,AAX,BIT16
  ,U1A,LTR.HET ЭKOHOMИИ
  15,XTA,BLS
  ,ASN,64+3
  ,UZA,LTR. < 8 ПPOTЯЖEK
  ,XTA,BIT4
  15,ATX,BLS. - ЭKOHOMИM !
 LTR:15,XTA,BLS
 ZNB:15,ATX,NEWBLS.
 ,NTR,3.
C CHEKP
 CHEKP:,BSS,.
 :15,XTA,OLDBLS.
 ,A-X,FPL.ПOЛHAЯ ДЛИHA ЛИCTA
 ,U1A,CHEKP1.
 ,A-X,FPL.
 ,U1A,CHEKP1.
 ,A+X,FPL.
 15,ATX,OLDBLS.
 ,UJ,CHEKP.
 CHEKP1:,BSS,.
  6,VZM,INCRN.OT COSY-GOST
 CHEKP2:,BSS,.
 ,XTA,.
 15,ATX,RR.
 15,XTA,NSTRI.
 15,X-A,PFLAG.
 ,U1A,INCRN.
 15,ATX,RR.
 15,ARX,NSTRI.
 15,ATX,NSTRI.
 INCRN:,BSS,.
 15,XTA,NSTRI.
 15,ARX,NEWBLS.
 CHP:,BSS,.
 15,ATX,NSTRI.
 ,A-X,FPL.
 ,UZA,CHP.
 5,UTC,.
 6,VZM,.
  ,NTR,0
 15,XTA,EXPPOS.
 ,U1A,WRE.
 15,XTA,OLDBLS.
 15,ARX,NEWBLS.
 15,ARX,RR.
 15,ATX,OLDBLS.
 15,XTA,TE.
 ,ATI,AB.
 ,UJ,CONT.ПPOДOЛЖEHИE PEДAKTИPOBAHИЯ
C WRE
 WRE:,BSS,.
 15,XTA,RR.
 ,ASN,64-40.
 15,WTC,TE.
 ,ARX,.
 15,WTC,TE.
 ,ATX,.
 :,XTA,CENDSTR.
 14,VTM,BUFST
C
C  ЗAПИCЬ B MAЛЫЙ БYФEP И CБPOC:
C
 WRTSM:2,VTM,WRSMB1
 3,VZM,BUFSTEP
 WRSMB1:3,ASN,64+8
 9,AOX,
 9,ATX,
 3,UTM,8
 14,UJ,
 BUFSTEP:15,ATX,RL.YПPЯT
 9,UTM,1
 ,ITA,9
 15,AEX,EBUF.KOHEЦ M.БYФ
 ,U1A,CHS
 15,WTC,LBUF
 CHS:9,UTM,
 3,VTM,-60B
 :,24,2003B
 15,XTA,LS
 ,ARX,C77777
 15,ATX,LS.=-ЧИCЛO CЛOB,ЗAHЯTЫX CTPOKOЙ
 15,ARX,LB.=+ЧИCЛO CBOБ.CЛOB B M.БYФEPE
 ,AAX,C77777
 ,UZA,CLOSJOB
 :,24,3
 ,UJ,OPEN
  PRINTER:,ITA,15
 15,ATX,OVFLAG
 15,VTM,OPEN
 ,UJ,SAVIND.ЖДY PRINTASK
 CLOSJOB:,XTA,LISTFLAG
 ,AAX,BITJ
 ,UZA,PRINTER
 ,ITA,13
 15,ATX,SI13
 7,UTC,-***
 13,VJM,*WRBF64
 15,XTA,SI13
 ,ATI,13
 OPEN:,XTA,
 9,ATX,
 15,XTA,RL.BOCCT
C  PRINTASK И *WRBF OБHOBЛЯЮT:
C  ДЛИHY CBOБ.MECTA (LB) - ДЛЯ NRES064
C  AДPEC CTPOKИ ,OTKYДA БYДET ЧTEHИE (BT) - ДЛЯ CEБЯ
 2,UJ,
 BUFST:,BSS,.
 9,XTA,.
 ,AAX,=7777 7777 7777 7400
 ,AOX,CENDSTR.
 9,ATX,.
 RB,VJM,BUFSTEP.
 ,WTC,ГYC
 RB,VTM,
 RB,XTA,REGSCAL
 ,AAX,BIT8.BЫBOД HA TEPM
 ,UZA,NEW LB.-HET
C ПEPEПИCЬ CTPOKИ C ЦИKЛИЧ.MAЛOГO БYФEPA
C B ИПЗ HA PAБ.ПOЛE OTЛAДЧИKA
 15,WTC,TE
 13,VTM,.OTKYДA БPATЬ
 14,VTM,-21
 L/WS:13,XTA,
 14,UTC,21
 RB,ATX,WS/DEBUG
 13,UTM,1
 ,ITA,13
 15,AEX,EBUF
 ,U1A,E L/WS
 15,WTC,LBUF
 E L/WS:13,UTM,
 14,VLM,L/WS
C BЫBOД HA TEPMИHAЛ
 ,XTA,DISREG
 ,ATI,27B
 ,*71,INF TER
 RB,XTA,REGSCAL
 ,AAX,BIT7.HYЖHA BЫДAЧA
 ,UZA,NEW LB.-ДA
 15,XTA,TE.HAЧAЛO ПOCЛEДH.CTP
 15,ATX,BT
 ,ATI,AB
  ,XTA,
  15,ATX,LS
 ,UJ,CONT RB
 NEW LB:,24,2003B
 15,XTA,LB.
 15,ARX,LS.
 ,AAX,C77777.
 15,ATX,LB.
 ,XTA,.
 15,ATX,LS.
 ,ITA,AB.
 15,ATX,TE.
 15,XTA,NEWBLS
 15,ATX,OLDBLS
  ,XTA,LISTFLAG
 ,AAX,BITJ
 15,AOX,QUEFLAG
 ,U1A,CONT
 15,XTA,TP
  :,UZA,*+1
  12,XTA,BIT41
  :,AOX,RDSCAL
   ,ATX,RDSCAL
  15,ATX,QUEFLAG
 ,XTA,COMMIR.
 12,AAX,BIT39.
  15,AOX,TP
 ,U1A,CONT.
 ,XTA,BIT3.
 12,032,14B.BKЛЮЧEHИE AЦПY
 12,XTA,BIT39.
  ,CALL,PERMIR."HYЛИ"
 CONT:,BSS,.
 ,WTC,ГYC
 RB,VTM,
 CONT RB:,BSS,
 ,NTR,3
 15,XTA,NEWBLS.
 15,ARX,RR
  ,AEX,
 ,U1A,*1.
 ,XTA,C1.
 *1:15,ATX,EXPPOS.ПPOБЫ:
 RB,A+X,LP STR.KOPPEKTИPOBKA
 RB,ATX,LP STR.CЧETЧИKA CTPOK
 RB,X-A,LP LIM.- ЛOПHYЛ ЛИMИT
 ,UZA,*01. = HET
 ,XTA,Ш/CЛYЖ
 ,AOX,SCENDJO.- БЛOKИPOBKИ
 ,AAX,BITJ
 ,U1A,*01. = ДA
 ,XTA,*TYPELP
 ,AAX,BIT1
 ,U1A,*01. = ДA
  :,24,2003B
 ,XTA,BITJ
 ,AOX,LIMLP SC
 ,ATX,LIMLP SC
 ,XTA,C574.BOЗBPAT
 15,ATX,*R33.B ЗAДAЧY
 ,XTA,DISREG.HA ЭK KOHЦA
 15,ATX,*R27....
 *01:,24,3
 ,XTA,Ш/FULL
 ,AAX,BITJ
 ,UZA,*010
 RB,XTA,571B
 ,AAX,BIT45
 ,U1A,*001.*LIST OUT
 *010:,NTR,
 15,XTA,EXPPOS.
 ,AOX,INT0.
 ,A*X,CTLP.
 RB,A+X,BISTIME
 RB,ATX,BISTIME
  *001:,BSS,
 NS,VTM,-40.
 15,XTA,OLDBLS.
 ,ASN,64-40
 AB,ATX,.
 ,XTA,.
 15,ATX,EXPPOS.
C       BOЗBPAT HA CЧET ИЛИ PEДAKTИPOBAHИE
 6,V1M,ENDRED.
 15,ATX,OLDBLS.
  ,UJ,RETURN
  END RED:15,XTA,B152
  ,UZA,CONT RED
  RETURN:,24,2003B
 ,XTA,LISTFLAG
 ,AAX,BITJ
 ,U1A,BOC ИПЗ
 ,ITA,7
 ,ARX,IREF1
 ,UJ,NRESOFF
 IREF1:,Z00,NRPRTA
 ,Z00,BOC ИПЗ-***
 BOC ИПЗ:,WTC,ГYC
 14,VTM,
C
C  BOCCTAHOBЛEHИE ИПЗ MAT.ЗAДAЧИ
C
 ,ITA,
 14,ATX,M72
 13,VTM,-25B
 15,UTM,101B
 L IREG:13,UTC,
 15,XTA,25B
 13,UTC,
 14,ATX,25B
 13,VLM,L IREG
 ,XTA,GRET
 ,UJ,NRESOFF
C*****   TEKCTЫ ДИAГHOCTИKИ
 NRDTEXT:,ISO,12HHEГOT.AЦПY''''
 HETAЦПY:,ISO,12HHET AЦПY''''''''
 ,BSS,
C*****   ИHФOPMAЦИOHHЫE CЛOBA
C        ДЛЯ 'NRESCALL' , 'NRESOFF'
 BRET:,Z00,NR/64
 ,Z00,CLANEWTA
 GRET:,Z00,NR/64
 ,Z00,SELECT
  INF TER:RB,Z14,WS/DEBUG.BЫBOД B COSY-GOST
  8,Z00,40000B."HEOБЯЗATEЛЬHЫЙ"
C*****   ПAPAMETPЫ ФOPMATA ЛИCTA
 FPL:,LOG,110.ПOЛHAЯ ДЛИHA
 DP:,LOG,6.ПPOMEЖYTOK
C*****
 CENDSTR:,LOG,176.
 K02700  :  ,LOG, 00000000 00000016
 K05405  :  ,LOG, 00000000 00000025
 K06124:,LOG,05601567 01673560.
        ,LOG,05601560 35673560.
        ,LOG,00100000 40000010.
 K06127  :  ,LOG, 00100010 00000010
  INT0:,BSS,
 K06130  :  ,LOG, 64000000 00000000
 K06134  :  ,LOG, 00000000 00000012
 C41:,LOG,41.
 K06142  :  ,LOG, 77777777 77777776
 K06245  :  ,LOG, 00000000 00000133
 C140:,LOG,140.
 C231:,BSS,.
 K06330  :  ,LOG, 00000000 00000231
 K06360  :  ,LOG, 17555746 77547276
 K06361  :  ,LOG, 42120000 00000000
 K06362  :  ,LOG, 40500000 00000000
 WS:,BSS,1
 TAБЛABT:,BSS,.
 ,OCT,00075177 11236120.
 ,OCT,14434405 23023412.
 ,OCT,00075527 17622126.
 ,OCT,13410532 10420533.
 ,OCT,00000130 22034032.
 ,OCT,13251426 14635124.
 ,OCT,21216415 20032030.
 ,OCT,13017016 15235414.
 ,OCT,00054515 10014413.
 ,OCT,21025423 22633521.
 ,OCT,21616004 20624424.
 ,OCT,20221427 00076175.
 ,OCT,20424117 22236516.
 ,OCT,14027522 21437125.
 ,OCT,14233037 12410022.
 ,OCT,22423025 00015400.
 ,END,
 *WRBF64:,NAME,.05.06.78
C
C*****   HEPEЗИДEHT БYФEPИЗAЦИИ BЫBOДA
C
 *ИПД:LC,BLOCK,(1),XNFM
 ,CONT,(4),XNCM
 ,CONT,(42),SCEM*64
 NFM:,WEQ,XNFM
 NCM:,WEQ,XNCM.KOЛ-BO ПOЛHЫX
 *ИПK:LC,BLOCK,*INFBA
 INFEX:,EQU,*INFBA+NCM
 BLI:,EQU,2000B.ДЛЯ БYФ.ЛИCTA
 INF 72:,EQU,=:10 0140 77
 ДHЗ:,LC,1
 *YCЫ:LC,BLOCK,ГYC
  STAT1:,EQU,571B
 NAME:,EQU,80
 TTPRINT:,SUBP,
 DISREG:,LC,1
 C1777:,LC,1
  *677:B,BLOCK,BITS
  ,CONT,BIT48,BIT47,BIT46,BIT45
  ,CONT,BIT44,BIT43,BIT42,BIT41
  ,CONT,BIT40,BIT39,BIT38,BIT37
  ,CONT,BIT36,BIT35,BIT34,BIT33
  ,CONT,BIT32,BIT31,BIT30,BIT29
  ,CONT,BIT28,BIT27,BIT26,BIT25
  ,CONT,BIT24,BIT23,BIT22,BIT21
  ,CONT,BIT20,BIT19,BIT18,BIT17
  ,CONT,BIT16,BIT15,BIT14,BIT13
  ,CONT,BIT12,BIT11,BIT10,BIT9
  ,CONT,BIT8 ,BIT7 ,BIT6 ,BIT5
  ,CONT,BIT4 ,BIT3 ,BIT2 ,BIT1
 NP/IW:,EQU,BIT31
 ИП PEД:,EQU,1000B
C     ЯЧEЙKИ TИПA  PП
 *31 :B,BLOCK,TE,EBUF(2),LBUF
C.....   PAБOЧИE ЯЧEЙKИ БYФEPИЗAЦИИ
 *1:,BLOCK,(6),NCTEK,NZNEXT,NZTEK
 ,CONT,M/EXT,M/END
 ,CONT,S1,S2,I6
 ,CONT,LB,CNT,LBA,BT
 ,CONT,I13,I14,*RS
 ,CONT,NZBEG
 *126:B,BLOCK,ONZ,ARET
C.....   ПPOЦEДYPЫ PAБOTЫ C OБЛACTЬЮ BЫBOДA
 *GIVNC:,SUBP,
 *GIVNZ:,SUBP,
 *RCAT :,SUBP,
 *WCAT :,SUBP,
 *RWOUT:,SUBP,
C.....
 *BEG:,BSS,
  NRES064:,SUBP,
  BAS64:,EQU,*BEG-NRES064
  7,REL,*BEG
 :,24,3
  7,UTM,BAS64
C
C*****   BXOД : ПEPEПИCЬ БYФEPA
C        HA ФOPMAЛЬHЫЙ ЛИCT
C
 ,ITA,1
 15,ATX,S1
 ,ITA,2
 15,ATX,S2
 ,ITA,13
 15,ATX,ARET.
 13,VJM,EXCH40/1
 15,XTA,BT.
 ,ATI,1
 15,XTA,CNT
 ,ATI,2
 15,XTA,LB
 15,ATX,LBA.
 WRB:,BSS,
 ,ITA,1
 15,AEX,TE
 ,UZA,WR
 1,XTA,
   :   ,24,
 2,ATX,BLI+1023
   :   ,24,3
 2,VLM,WRBC
 2,VTM,10-1023
 13,VJM,CБPOC
 WRBC:,BSS,
 1,UTM,1
 15,XTA,LBA.
 ,ARX,BIT1
 15,ATX,LBA.
 ,ITA,1
 15,AEX,EBUF
 ,U1A,WRB
 15,WTC,LBUF
 1,UTM,
 ,UJ,WRB
 WR:,BSS,
 15,XTA,LBA.
 15,ATX,LB
 ,ITA,1
 15,ATX,BT.
 ,ITA,2
 15,ATX,CNT
 13,VJM,DE FIX
 15,XTA,S2
 ,ATI,2
 15,XTA,S1.
 ,ATI,1
  7,UTM,-BAS64
 15,WTC,ARET
 ,UJ,
 *CБPOC64:,ENTRY,
C
C*****   BXOД : CБPOC ФOPMAЛЬHOГO ЛИCTA
C
 ,ITA,13
 15,ATX,I13
 13,VJM,EXCH40/1
 15,WTC,I13
 13,VTM,
 CБPOC:,BSS,
 ,ITA,13
 15,ATX,I13
 15,XTA,NZ NEXT
 15,ATX,NZ TEK
 ,U1A,NO FICA
 15,ATX,ONZ
 7,UTC,-*BEG
 13,VJM,*GIVNZ
 15,ATX,NZ TEK
 15,ATX,NZ BEG
 7,UTC,-*BEG
 13,VJM,*GIVNC
 15,ATX,NC TEK
 ,ASN,64-30.36-31 N BЫB
 6,AOX,*INFBA
 6,ATX,*INFBA
 NO FICA:,BSS,
 15,XTA,M/END
 ,UZA,NO END
 15,WTC,CNT
 14,VTM,1023
   :   ,24,
 14,ATX,BLI
 ,ATX,BLI+1023
 ,XTA,
  :,24,3
 ,UJ,WR NZ
 NO END:,BSS,
 7,UTC,-*BEG
 13,VJM,*GIVNZ
  WR NZ:,BSS,
  13,VTM,BLI
 15,ATX,NZ NEXT
 14,VJM,FORM
  :,24,
  ,ATX,BLI+9. CПEЦKOД
  :,24,3
C
C   ФOPMИPOBAHИE 5-ГO И 6-ГO CЛYЖ. CЛOB
C   ЗOHЫ ФAЙЛA BЫBOДA:
C   5-E  :   CЧ. BPEMЯ ЗAДAЧИ
C   6-E  :   KOMM. BPEMЯ ЗAДAЧИ.
 15,XTA,-1-ИПPEД
 :,24,
 ,ATX,BLI+5
 :,24,3
 15,XTA,110B-ИПPEД
 :,24,
 ,ATX,BLI+6
 :,24,3
 15,XTA,NZTEK
 ,AOX,NP/IW
 7,UTC,-*BEG
 13,VJM,*RWOUT
 15,XTA,M/EXT
 ,U1A,RET/2
 15,XTA,ONZ
 ,UZA,NO BIG
 ,ASN,64-34.14-10 - 1MБ
 ,U1A,NO BIG
 ,XTA,ГYC
 ,ASN,64-27
 ,AUX,C/ШИ
 ,AOX,T/ШИ
 14,VTM,ДЛB
 14,ATX,2
 ,ITA,14
   :   ,24,2003B
 14,VJM,TT PRINT
 NO BIG:,BSS,
 15,XTA,M/END
 ,U1A,COR CAT
 15,XTA,ONZ
 ,U1A,RET/2
 COR CAT:,BSS,
 13,VTM,BLI
 ,ITA,13
 7,UTC,-*BEG
 13,VJM,*RCAT
 15,XTA,NC TEK
 ,ASN,64-2
 15,ARX,NC TEK
 ,ATI,13
 13,UTM,BLI
  15,XTA,STAT1-ИПPEД
  ,AAX,=:077
 15,WTC,M/END
 ,AOX,BIT47.B48 ИЛИ B47
 15,AOX,NZBEG
 14,VJM,FORM
 13,VTM,BLI
 ,ITA,13
 7,UTC,-*BEG
 13,VJM,*WCAT
 RET/2:,BSS,
   :   ,24,3
 ,XTA,BIT10
 15,ARX,ONZ
 15,ATX,ONZ
 15,XTA,M/END
 ,UZA,RET/3
 13,VJM,DE FIX
 ,XTA,
 15,ATX,M/END
 RET/3:,BSS,
 15,WTC,I13
 ,UJ,
 EXCH40/1:,BSS,
 ,ITA,6
 15,ATX,I6
 ,ITA,14
 15,ATX,I14
 ,WTC,ДHЗ
 6,VTM,-NFM
 6,XTA,BITS+NFM
   :   ,24,2003B
 ,AOX,SCEM*64
 ,ATX,SCEM*64
 ,XTA,DISREG
 ,ATI,27B
 ,*72,INF 72
 RET F:,24,3
 13,UJ,
 DE FIX:,BSS,
   :   ,24,2003B
 ,XTA,DISREG
 ,ATI,27B
 ,*72,INF 72
 6,XTA,BITS+NFM
 ,AEX,SCEM*64
 ,ATX,SCEM*64
 15,WTC,I6
 6,VTM,
 15,WTC,I14
 14,VTM,
 ,UJ,RET F
 FORM:,BSS,
 15,ATX,*RS
 6,XTA,*INFBA
C   ФOPMИPOBAHИE ЭЛ-TA KATAЛOГA BЫBOДA
C   И CЛYЖEБHЫX CЛOB ЗOHЫ:
C   0 CЛ  48 - БYФEPИЗAЦИЯ OKOHЧEHA
C         47 - ИДET БYФEPИЗAЦИЯ
C         46 - ИCПOЛЬЗYETCЯ TAPEPRNT
C         45 - ЗAПPET ABTOPACПEЧATKИ
C         44 - OTMEHA HYMEPAЦИИ CTPAHИЦ
C         43 - ГPAФИKA EЩE HE BЫBOДИЛACЬ
C      42-40 - TИП ГPAФПЛOTTEPA
C      38-37 - HOMEP ЭBM (ИЗ DISPBASE)
C      36-31 - N BЫBOДA
C      30-25 - N BBOДA
C      24-19 - N ЛAБOPATOPИИ
C      18-10 - OБЩEE KOЛ-BO ЗOH CПИCKA,CЧИTAЯ C 0
C        9-1 - N 1 ЗOHЫ CПИCKA (ДЛЯ ЭЛ-TA KAT)
C              N CЛEДYЮЩEЙ ЗOHЫ ИЛИ 0=KOHEЦ
C   1 CЛ
C      48:31 - K-BO OTПEЧ. CTPOK
C      30:13 - ACTP. BPEMЯ ФOPM. ЭЛ-TA
C      10:01 - N PASS
C   2-4 CЛ   - NAME(ISO) C XBOCTOBЫMИ '0'
  ,APX,=3000 7777 7700 0000
  ,ASN,64+10
 15,AOX,*RS
 15,AOX,ONZ
   :   ,24,
 13,ATX,
 :,24,3
 15,XTA,126B-ИПPEД.OTПEЧ. CTPOK
 ,ASN,64-30
 15,ATX,*RS
 ,XTA,542B
 ,NTR,7
 ,A+X,=I0
 ,ASN,64-12
 15,AOX,*RS
 15,ATX,*RS
 6,XTA,INFEX
 ,AAX,C1777
 15,AOX,*RS
 :,24,
 13,ATX,1
   :   ,24,3
 ,ITA,14
 15,ATX,*RS
 14,VTM,-2
 F 1:,WTC,ГYC
 14,XTA,NAME+2
   :   ,24,
 14,UTC,2
 13,ATX,2
   :   ,24,3
 14,VLM,F 1
  ,XTA,=6H'12'FOUT'200'
 15,WTC,*RS
 ,UJ,
C.....
 C/ШИ:,GOST,6H077000
 T/ШИ:,ISO ,6HШ00''''''
 ДЛB:,ISO,18HДЛИH.BЫДAЧA-
  ,END,
 PROC/OUT:,NAME,
C
C*****   HAБOP ПPOЦEДYP ПO PAБOTE
C        C OБЛACTЬЮ BЫBOДA
C
C-----   B X O Д Ы :
C     ЧEPEЗ ЭKCTPAKOД : ,*57,7
C     И ИЗ '*WRBF64'
C
C.....   ПPИ BXOДE ЧEPEЗ ЭKCTPAKOД
C     HA CYMMATOPE ИHФ.CЛOBO :
C...  PP.48/45 - TИП PAБOTЫ
C        = 1 - ЧTEHИE KATAЛOГA
C        = 2 - ЗAПИCЬ KATAЛOГA
C        = 3 - OБMEH C OБЛACTЬЮ BЫBOДA
C...  PP.41/41 = 0
C...  PP.40/1 - ДOП.ИHФOPMAЦИЯ K TИПY
C
C.....   BXOДЫ OT '*WRBF64' C BOЗBPATOM ПO И13
C...  HA CYMMATOPE ДOП.ИHФOPMAЦИЯ
C
C.....
 *ИПД:LC,BLOCK,(1),XNFM,(4),XNCM
 ,CONT,(39),SNOZON
 NFM:,WEQ,XNFM
 NCM:,WEQ,XNCM
 *ИПK:LC,BLOCK,*INFBA
 INFEX:,EQU,*INFBA+NCM
 *YCЫ:LC,BLOCK,ГYC
 BUFS27:,EQU,104B.- ПO ИПЗ
 ДHЗ:LC,BLOCK,(1),BITJ
 ШЛAГБAYM:LC,BLOCK,(2),SEM/OUT,SEM/IN
 ,CONT,(7),SEM/GRF
 SMASAV:LC,BLOCK,SAVAC(3)
 ,CONT,SAVI15,SAVI14,SAVI13
  DISPBASE:LC,BLOCK,(6),NUMEVM
 /OUT/:LC,BLOCK,*SCAFR(2)
 KAT MБ:,EQU,506B
C.....
 C7:,LC,1
 C13:,LC,1
 C77:,LC,1
 C777:,LC,1
 C1777:,LC,1
 DISREG:,LC,1
 C7777:,LC,1
 C77777:,LC,1
C.....
 *WRBF64:,SUBP,
 *B:,EQU,*WRBF64
 MACRO70S:,SUBP,
 CLANEWTA:,SUBP,
 RETURN:,SUBP,
 ERR*57  :,SUBP,
 NR/64:,SUBP,
 NRESOFF:,SUBP,
 SEMDOWNS:,SUBP,
 SEMUP  :,SUBP,
 TTPRINT:,SUBP,
C.....   PAБOЧEE ПOЛE ПPOЦEДYP
 *1:,BLOCK,S/7,S/32,RET/,IW/,SAV/(0)
 ,CONT,RET*,I1*(4),M/EXT
C.....   OПИCATEЛИ KATAЛOГA
 CAT:,EQU,2000B
 WSC1:,EQU,1760B
 LAB :,EQU,1773B
 LAW :,EQU,1775B
 LAST W:,EQU,CAT+LAW
 INF 46/1:,EQU,=:10 4601 77
C.....
 *677:B,BLOCK,BITS
 ,CONT,B48,B47,B46,B45,B44,B43
 ,CONT,B42,B41,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33,B32,B31
 ,CONT,B30,B29,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21,B20,B19
 ,CONT,B18,B17,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B9,B8,B7
 ,CONT,B6,B5,B4,B3,B2,B1
C.....
 A/CAT:,EQU,B11
C
C=====   BXOД OT ЭKCTPAKOДA
C
 7,REL,*B
C.....   ДOYПPЯTЫBAHИE ИHФOPMAЦИИ
 14,MTJ,15
 15,AOX,S/7
 15,ATX,S/7
 ,ITA,32B
 ,ASN,64-15
 ,AOX,SAVI13
 ,ASN,64-15
 15,ATX,S/32
 ,ITA,8
 15,AOX,S/32
 15,ATX,S/32
C.....   ПPOBEPKA TИПA PAБOTЫ
 ,XTA,SAVAC
 ,AAX,CH MSK
 ,U1A,ERROR
 ,XTA,SAVAC
 15,ATX,SAV/.OTBET ПPИ OБMEHE
 ,AUX,UPM 1
 ,ATI,14
 ,ASN,64+15
 ,ATI,8
 ,XTA,SAVAC
 ,AAX,B44
 ,UZA,OUT/IN
 8,VTM,2.=GRAF/EXP.DATA
 OUT/IN:,BSS,
C.....   ПEPEKЛЮЧATEЛЬ ПO TИПY PAБOTЫ
 ,XTA,SAVAC
   :   ,24,3
 ,AAX,B40/1
 13,VTM,P/RET
 14,UJ,P/SW
 P/SW:,BSS,
 :,UJ,ERROR.= PEЗEPB
 READ C:,BSS,
 :,AOX,B20
 ,UJ,RW CAT
 :,UJ,WRIT C.= ЗAПИCЬ KAT.
 :15,ATX,IW/
 ,UJ,RE WR.=OБMEH C OB
 :14,VTM,0
 ,UJ,ДAЙ.= ДAЙ ЭЛK
 :14,VTM,1
 ,UJ,ДAЙ.= ДAЙ ЗOHY
 ,BSS,
C......   BOЗBPAT ИЗ ЭKCTPAKOДA
 P/RET:,24,2003B
 ,ITA,7
 ,ARX,I/REF.= OTKAЗ OT
 ,UJ,NRESOFF.  HEPEЗИДEHTA
 I/REF:,Z00,NR/64
 ,Z00,RET1-*B
C.....   BOCCTAHOBЛEHИЯ И BOЗBPAT
 RET1:,BSS,
 15,XTA,S/32
 ,ATI,8
 ,ASN,64+15
 ,ATX,SAVI13
 ,ASN,64+15
 ,ATI,32B
 ,ATI,33B
 15,XTA,S/7
 ,ATX,SAVI15
 ,ASN,64+15
 ,ATI,27B
 ,ASN,64+15
 ,ATI,7
 15,XTA,SAV/
 ,ATX,SAVAC
 ,ITA,15
 ,ATX,SAVI14
 ,UJ,RETURN
C.....   ДИAГHOCTИKA
 ERROR:,BSS,
C.....   BOCCTAHOBЛEHИЯ ДЛЯ ПEЧATИ
 15,XTA,S/32
 ,ASN,64+30
 ,ATI,32B
 ,XTA,C7
 ,ATI,27B
 ,ATX,SAVI14
 15,XTA,S/7
 ,ASN,64+30
 ,ATI,7
 ,UJ,ERR*57
C=====   'ДAЙ ЭЛEMEHT KATAЛOГA'
C        BXOД TOЛЬKO OT '*WRBF64'
 *GIV NC:,ENTRY,
 ,UTC,-1
C=====   'ДAЙ CBOБOДHYЮ ЗOHY'
C        BXOД TOЛЬKO OT '*WRBF64'
 *GIV NZ:,ENTRY,
 14,VTM,1
 ,ITA,1
 ,ASN,64-15
 15,ATX,I1*
 ,ITA,8
 15,AOX,I1*
 15,ATX,I1*
 8,VTM,.ПPИЗHAK BЫBOДA
 14,MTJ,1
 ,ITA,13
 15,ATX,RET*
C.....   ПPOБA ПEPEXBATA AЦПY
C-----   BЫДAЧA PECYPCA ИЗ OБЛACTИ BЫBOДA
 GIV:,24,2003B
 ,XTA,B48/17.- EЦTЬ ЛИ PECYPC
 1,AAX,*SCAFR.  B PEЗИДEHTE
 ,UZA,ABSENT. = HET
 ,ANX,C77777
 ,ATI,13
 13,XTS,B48.ИПЗ-PEДAKTИP.
 1,AEX,*SCAFR
 1,ATX,*SCAFR
 15,ARX,
   :   ,24,3
 ,AAX,C777
 PUT:,BSS,
C.....   BOЗBPAT ИЗ BЫДAЧИ PECYPCA
 RET:15,XTS,I1*-1.AЙ-ЯЙ-ЯЙ
 ,ATI,8
 ,ASN,64+15
 ,STI,1
 15,WTC,RET*
 ,UJ,
C-----   B PEЗИДEHTE HET PECYPCA
C        ПO OБЛACTИ BЫBOДA
 ABSENT:,BSS,
 13,VJM,DOWN.= MOHOПOЛИЯ
C.....   A HE ИЗBЛEK ЛИ KTO PECYPC
 1,XTA,*SCAFR
 ,AAX,B48/17
 13,VTM,GIV
 ,U1A,UP.= ИЗBЛEK
 ,XTA,C13
 ,ATI,27B.- ДOCTAHEM
 ,*72,INF 46/1.  46 ЛИCT
 ,XTA,A/CAT.=ЗA ЧTEHИEM
 13,VJM,READ C.  KATAЛOГA
   :   ,24,
 1,XTA,LASTW
 ,ATI,13
 14,VTM,-16.16 ШKAЛ И XBOCT
C.....   ПOИCK PECYPCA B KATAЛOГE
 SE/SC:,24,3
 ,ITA,13
  1,AEX,C1740.(C1760)
  :,U1A,*+1
  13,UTM,-20B
  :,24,
 13,XTA,CAT.- B OЧEP.ШKAЛE
 ,ASN,64+16.  ECTЬ PECYPC
 ,U1A,SCAL IS. = ДA
 13,UTM,1
 14,VLM,SE/SC.BMECTO ИP6
C
C-----   Y B Ы  :  PECYPCA HET
C
 13,VJM,REFUSE
 ,XTA,BITJ
 ,AOX,SNOZON.= MЫ ЖДEM
 ,ATX,SNOZON.  PECYPCA
C.....   ИЗBECTИM OПEPATOPA
 1,XTA,T/OVFL.= ПOДГOTOBKA
 ,ATX,TT+1.  TEKCTA
 ,ITA,15.= ПOДГOTOBKA
 ,ATX,SAVI15.K CAMOЗAKPЫTИЮ
 ,XTA,DISREG
 ,ATI,27B.= PEЖИM И
 14,VTM,ABSENT.  AДPEC BXOДA
 14,MTJ,33B....
 14,VTM,TT
 ,ITA,14
 14,VTM,CLANEWTA
 ,UJ,TT PRINT.* TT-ПEЧATЬ
C-----   HAШЛИ B KATAЛOГE ШKAЛY
C        OTOБPAЗИM B PEЗИДEHT И KATAЛOГ
 SCAL IS:,BSS,
  ,XTA,NUMEVM
  ,ASN,64+46
  ,ATI,14
  14,J+M,14.0,2,4
 13,UTM,1
 ,ITA,13
 1,ATX,LASTW
 13,XTA,CAT-1
   :   ,24,3
 1,ATX,*SCAFR
   :   ,24,
  14,UTC,CAT
  1,ATX,WSC1
  ,ASN,64-39
  ,ASN,64+39
 13,ATX,CAT-1
   :   ,24,3
 ,XTA,A/CAT.= HA ЗAПИCЬ
 13,VJM,WRIT C.  KATAЛOГA
 13,VTM,GIV
C-----
 REFUSE:,BSS,
   :   ,24,2003B
 ,XTA,C13
 ,ATI,27B.= BEPHEM
 ,*72,INF 46/1.  46 ЛИCT
C-----   BЫXOД ИЗ KPИT.ИHTEPBAЛA KATAЛOГA
 UP:,BSS,
 ,ITA,13
 8,ARX,I/SEM
 ,UJ,SEM UP.
C-----   BXOД B KPИT.ИHTEPBAЛ KATAЛOГA
 DOWN:,BSS,
 ,ITA,13
 8,ARX,I/SEM
 ,UJ,SEMDOWNS
 I/SEM:8,Z01,SEM/OUT
 ,Z00,
 :8,Z01,SEM/IN
 ,Z00,
 :8,Z01,SEM/GRF
 ,Z00,
C-----
C
C=====   ЧTEHИE KATAЛOГA C MOHOПOЛИЗAЦИEЙ
C     BXOД OT ЭKCTPAKOДA И '*WRBF64'
C     ДOП.ИHФOPMAЦИЯ = AДPEC KATAЛOГA
C
 *RCAT:,ENTRY,
 ,AOX,B20
 ,BSS,
C
C=====   ЗAПИCЬ KATAЛOГA C ДEMOHOПOЛ.
C     BXOД OT ЭKCTPAKOДA И '*WRBF64'
C     ДOП.ИHФOPMAЦИЯ = AДPEC KATAЛOГA
C
 *WCAT:,ENTRY,
 15,ATX,IW/
 14,VJM,SAVE 8
 WRIT C:,BSS,
 RW CAT:,ASN,64-20
 15,ATX,IW/
 ,ITA,13
 15,ATX,RET/
 13,VJM,DOWN.= MOHOПOЛИЗAЦИЯ
  15,XTA,IW/
  ,AAX,B40
  ,U1A,RWC
C
C----- A HE ПИШEM ЛИ MЫ ДYPHOГO B KAT.
C
  15,XTA,IW/
  ,ASN,64+20
  ,ATI,13
   :    ,24,2000B
  13,XTA,1777B
   :    ,24,2003B
  8,AEX,SIGN
  ,UZA,RWC
C----- TAK TOЧHO: MYPИЩA
 ,33,57B.OCTAHOB
 ,UJ,AFT/EXCH.И BOЗBPAT
C
  RWC:,BSS,
 ,XTA,DISREG
 ,ATI,27B
C KATAЛOГ GRAF/EXP.DATA HA HOCИTEЛE
C    CATALO/8
C    ИЛИ D73GRF/12
 ,ITA,8
 ,AEX,B2
 ,UZA,WR0.=GRAF
C.....   KATAЛOГ HA MБ ИЛИ HOCИTEЛE
 ,XTA,KAT MБ. MБ-KATAЛOГ
 ,UZA,WR 1. = HET
 8,V1M,WR 2
 ,ARX,B1
 ,UJ,WR 2
 WR0:,XTA,2
 ,AAX,B39.ПYЛЬT
 ,UZA,WR1.=D73GRF/12
 ,UTC,GIV C/8-GIV OUT.=CATALO/8
 WR 1:13,VJM,GIV OUT
 WR 2:14,VJM,EXCH.= ЗA OБMEHOM
  AFT/EXCH:,BSS,
 15,WTC,RET/
 13,VTM,
 15,XTA,IW/
 ,AAX,B40.OБMEH = ЧTEHИE
  13,U1A,. = ДA
 ,UJ,UP.- ДEMOHOПOЛИЗAЦИЯ
C-----   ПPOЦEДYPЫ ПOИCKA OБЛACTEЙ
 GIV C/8:,UTC,2.ДЛЯ GRAF
 GIV OUT:,BSS,.OБЛACTИ BЫB/BB
 8,XTA,FIL/OUT
 ,*57,540B
 ,AAX,C77
 ,ASN,64-12
   :   ,24,2003B
 ,ATX,WS
 ,ARX,C/MOD
 ,AAX,B46
 ,AEX,B46
 ,AOX,B39
 ,AOX,WS
 13,UJ,
C
C=====   ЧTEHИE / ЗAПИCЬ ЗOHЫ
C     BXOД OT ЭKCTPAKOДA И *WRBF64'
C
C     ДOП.ИHФOPMAЦИЯ :
C...  B39=1 - OБMEH C 7/M , ИHAЧE
C...  B18/13#0 - ЛИЧHAЯ OБЛACTЬ
C...  ИHAЧE = OБЛACTЬ BЫBOДA ИЛИ BBOДA
C...  B40,B35/31,B10/1 - ДЛЯ ЭK70
C
 *RW OUT:,ENTRY,
 15,ATX,IW/
 14,VJM,SAVE 8
 REWR:,BSS,
 ,ITA,13
 15,ATX,RET/
 ,XTA,C13
 ,ATI,27B
 15,XTA,IW/
 ,AAX,MSK/OWN.- OБЛACTЬ BЫBOДA
 13,VTM,RW 1
 ,UZA,GIV OUT. = ДA
 8,V1M,ERROR
 ,AAX,B39.- OБЛACTЬ 7/M
 8,VTM,3
 ,U1A,GIV OUT.=ДA
 RW 1:14,VJM,EXCH.= ЗA OБMEHOM
 15,WTC,RET/
 ,UJ,
C-----   CПACEHИE И BOCCTAHOBЛEHИE И8
C        ( BXOД OT '*WRBF64' )
 SAVE 8:,BSS,
 ,ITA,8
 ,ASN,64-15
 15,ATX,I1*
 8,VTM,.ПPИЗHAK BЫBOДA
 ,ITA,13
 15,AOX,I1*
 15,ATX,I1*
 15,XTA,IW/
 14,UTC,
 13,VJM,
 :15,XTA,I1*
 ,ATI,13
 ,ASN,64+15
 ,ATI,8
 13,UJ,
C
C=====   ЗAПPOC PECYPCOB ПO OБЛACTИ BBOДA
C   И OБЛACTИ ГPAФИЧECKOГO BЫBOДA И ЭKCПEPИMEHT.ДAHHЫX
C   ДOП.ИHФOPMAЦИЯ = AДPEC KATAЛOГA
C
 ДAЙ:,BSS,
  ,AOX,C1777
  ,AEX,C1777.HAЧAЛO KATAЛOГA
  15,ATX,IW/
  ,ITA,1
  ,ASN,64-15
  15,ATX,I1*
  14,MTJ,1
  ,ITA,6
  15,AOX,I1*
  15,ATX,I1*
 15,XTA,IW/
 ,ATI,6
 8,XTA,I/SEM
 ,ASN,64+24
 ,ATI,14.AДPEC CEMAФOPA
 14,XTA,
 ,AEX,ДHЗ
  ,AAX,C77
  ,U1A,NOMONOP
C... ECЛИ K MOMEHTY ЗAПPOCA ЭЛ-TA
C    KATAЛOГA ИЛИ ЗOHЫ
C    YЖE ECTЬ MOHOПOЛИЯ HA KATAЛOГ
C    И KATAЛOГ B TOM ЖE MAT.ЛИCTE,
C    TO OБMEH C KATAЛOГOM HE ДEЛAEM
C    И COXPAHЯEM MOHOПOЛИЮ.
   :    ,24,
  6,XTA,1777B
   :    ,24,3
  8,AEX,SIGN
  ,U1A,NOMONOP
 ,ITA,6
 ,AOX,B48.ФЛAГ MOHOПOЛ
 BEG LS:,BSS,
  15,ATX,IW/
  1,J+M,6
C.....   YCTAHOBKA ЦИKЛA ПOИCKA
   :   ,24,
  6,ARX,LAW
 ,ATI,13.AДPEC ШKAЛЫ
  6,XTA,LAB
 ,ATI,14.HOMEP БИTA
 :,24,3
 6,VTM,-16
C.....   ЦИKЛ ПOИCKA PECYPCA
 IN 1:,BSS,
 ,ITA,13
 1,AEX,C1740.ПEPEAДPECAЦИЯ
  ,AAX,C1777
  :,U1A,*+1
  13,UTM,-20B
 ,XTA,B48/17
 14,ASN,64
 ,AAX,B48/17
   :   ,24,
 13,AAX,
 :,24,3
 ,U1A,IN 2.= HAШЛИ
 14,VTM,
 13,UTM,1
 6,VLM,IN 1.= HA ЦИKЛ
C-----   Y B Ы : PECYPCA HET
C
 15,ATX,SAV/.=0
 RET AC:,BSS,
C.....   BOCCTAHOBЛEHИЯ
 15,XTA,I1*
  ,ATI,6
  ,ASN,64+15
  ,ATI,1
 13,VTM,P/RET
  15,XTA,SAV/
 ,UZA,UP.= HET PECYPCA
  15,XTA,IW/
  ,ARX,
  ,UZA,P/RET
 ,UJ,WRIT C.= ЗAПИCЬ KAT.
C-----   HAШЛИ PECYPC
 IN 2:,BSS,
 ,ANX,C77777
 ,ATI,14
 :,24,
 13,ARX,
 :,24,3
 ,AAX,C777
 ,AOX,B48.=PEЗYЛЬTAT
 15,ATX,SAV/
  15,XTA,IW/
 ,ATI,6
C.....   OTOБPAЗИM HAXOДKY B KATAЛOГ
 1,J+M,6
 14,XTA,B48
   :   ,24,
 13,AEX,
 13,ATX,.= PECYPC ЗAHЯT
 14,UTM,1
 ,ITA,14
 6,ATX,LAB.=HOMEP БИTA
 ,ITA,13
 ,ASN,64-38
 ,ASN,64+38
 6,ATX,LAW.=HOMEP CЛOBA
   :   ,24,3
 ,UJ,RET AC
 NO MONOP:,BSS,
 15,XTA,IW/
 13,VJM,READ C
 ,ITA,6
 ,UJ,BEG LS
C-----   OPГAHИЗAЦИЯ CYMMATOPHOГO ЭK70
 EXCH:15,AOX,IW/
 15,ATX,IW/
 14,MTJ,32B
 ,XTA,DISREG
 ,WTC,ГYC
 ,ATX,BUFS27
 15,XTA,IW/
 ,UJ,MACRO70S
C-----   ИMEHA OБЛACTEЙ
 FIL/OUT:,TEXT,8HD73OUT '3'
 ,TEXT,8HD73INP '1'
 ,TEXT,8HD73GRF '22'
 FIL/MT :,TEXT,8HM      '7'
 ,TEXT,8HCATALO '10'
  SIGN:,ISO,6HD78OUT
       ,ISO,6HD78INP
 ,ISO,6HD78OUT
C-----   TEKCTЫ И KOHCTAHTЫ ДИAГHOCTИKИ
 TT:,ISO,18HПOЛOH ФAЙЛ BЫBOДA''
 T/OVFL:,ISO,6HKAT. B
        ,ISO,6HФAЙЛ B
 ,BSS,
C-----   KOHCTAHTЫ ДЛЯ KYC'A И ИC
 C/MOD:,OCT,0777 7777 775
 MSK/OWN:,LOG,4 0000 0077 0000
 C/37:,LOG,37 0000
C-----   MACKИ ПOЛEЙ
 B48/17:,OCT,7777 7777 776
 CH MSK:,OCT,0163 4077 77
 B40/1:,LOG,17 7777 7777 7777
 B23/15:,LOG,3774 0000
 UPM 1:,LOG,1 00007
 C1740:,LOG,1740
 ,LOG,1760
C-----   PAБOЧИE ЯЧEЙKИ
 WS:,EQU,TT+1.1 ЯЧ.
C-----
 ,END,
 MACRO NEW:,NAME,.HOBЫE ЭKCTPAKOДЫ
C  HAЧAЛO B ЯЧ.557:
C   14,VZM,MACRO57
C     ,UJ ,MACRONEW
 NRECMT:,SUBP,
 ERR MACRO:,SUBP,
  INF*57:,EQU,14.HOMEP ДИAГHOCTИKИ
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42
 ,CONT,BIT41,BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34
 ,CONT,BIT33,BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26
 ,CONT,BIT25,BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18
 ,CONT,BIT17,BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10
 ,CONT,BIT9,BIT8,BIT7,BIT6,BIT5,BIT4,BIT3,BIT2,BIT1
  *YCЫ:LC,BLOCK,ГYC,RDSCAL
 SCEM:,EQU,83.
 S/7:,EQU,131B
 B24/1:,LC,1.
 NEWTA:,SUBP,
  *ИПД:,LC,
  XLQTIM:,EQU,*ИПД+30B
  LQUE:,WEQ,XLQTIM
  QUETIM:LC,BLOCK,NTIMER,QT
 SCALES:LC,BLOCK,(8),SCLTWJ.
  FREESEM:LC,BLOCK,(1),MSELECT
 C77357:,LC,1.
 ABTIME:,LC,2.
 CLANEWTA:,SUBP,.
  Д H З :LC,BLOCK,(1),BITJ,ZBITJ
 RETURN:,SUBP,
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR,SAVS16
 NR/64   :,SUBP,
 NRES064 :,SUBP,
 *WRBF64 :,SUBP,
 PROC/OUT:,SUBP,
 NRESCALL:,SUBP,
  NR//SEAR:,SUBP,
  NR OCCD :,SUBP,
  CALCOMP*:,SUBP,
  C2003:,LC,1
  C7777:,LC,1
  C77777:,LC,1
  C77   :,LC,1
C      -------------------------------------
 ,ATX,SAVAC
 ,ITA,14
  ,ATX,SAVI14
 ,ASN,64+3
  14,UZA,ERR*57
  14,UTM,-7777B
  14,VZM,EC/608
  14,UTM,7777B-13B
  14,VZM,WAIT.Э57,13
  ,ASN,64-3
  ,ATX,SAVI14
  ,ITA,27B
  DIREG:,APX,C2003
  ,ASN,64+45
  ,AOX,SAVI14
  ,ATI,14
  ,ASN,64+3
  ,AEX,C7777.ПPOБA
  ,U1A,TAPE.HA -1
  ,UTC,1
  TAPE:,XTA,OCCUP
  ,UJ,NRESCALL
  OCCUP:,Z00,NR//SEAR
  ,Z00,14
  :,Z00,NR OCCD
  ,Z00,14
  ADRNREC:,Z00,NRECMT
  ,Z00,14
C      -----------
  ERR*57:,ENTRY,
  ERR*57:14,VTM,INF*57
  ,UJ,ERR MACRO
  :,UJ,EC/608.1=CDC608
  FIRM:4,IFSEQ,D,DD**FI
  K*CIO:,SUBP,
  /2:,XTA,SAVAC
  ,UJ,K*CIO.2
  FIRM:2,ELSE,
  :,NTR,2
  ,UJ,CALCOMP*
  :14,VTM,=R1.0 - SAVAC
  ,UJ,WAIT
  EC/608:,XTA,ADRNREC.4=EC5012
 ,UJ,NRESCALL
 :,XTA,SAVAC.
 ,UJ,EMUL.
  :,UJ,TAKTIM
 ,BSS,
C-----   BЫXOД HA ПPOЦEДYPЫ PAБOTЫ
C        C OБЛACTЬЮ BЫBOДA
 ,ITA,7.CПACEHИE
 ,ASN,64-15.PEГИCTPOB
 ,ATX,SAVAR
 ,ITA,27B
 ,AAX,C77357
 ,AOX,SAVAR
 ,ASN,64-15
 ,WTC,ГYC
 14,VTM,S/7-1
 14,ATX,1....
 ,XTA,INFC64.BЫЗOB
 ,UJ,NRESCALL.HEPEЗИДEHTA
 INFC64:,Z00,NR/64
 ,Z00,*+1
 :,ATI,7.= БAЗИPOBAHИE
 7,UTM,*WRBF64-NRES064
 ,ITA,15
 7,UJ,PROC/OUT-*WRBF64
C-----
  TAKTIM:,WTC,ГYC
  ,XTA,-1
  ,MTJ,27B
  2,IJ,
C*****   YCTAHOBKA/CHЯTИE ИHTEPПPET. ЭK
 EMUL:,AOX,B24/1.
 ,AEX,B24/1.
 ,WTC,ГYC.
 ,ATX,SCEM.
 ,ITA,27B.
 ,AAX,C77357.
 ,ATI,27B.
 2,IJ,.
C*****
C
C     ЗAKPЫTИE ЗAДAЧИ HA BPEMЯ OKOЛO CEKYHДЫ
C     ИЛИ HA ЗAДAHHOE BPEMЯ (B CEK.)
C     ПPИ PAБOTE OT ,Э057,13
C
 WAIT:,BSS,
 13,MTJ,16
 ,CALL,SAVEMOD
 ,ITA,32B
 ,ATI,33B
 ,ITA,27B
 ,AAX,C77357
 ,ATI,27B
  13,VTM,NEWTA
  ,NTR,2
  14,XTA,SAVAC.BPEMЯ OTH.
  ,A+X,ABTIME.BPEMЯ AБC.
  ,ASN,64+21
  ,ASN,64-6
  ,AOX,Д H З
  ,ASN,64-15
  ,AOX,P/NEWTA
C
C
C
C...   BEДEHИE OЧEPEДИ TAЙMEPOB :
C   SET - ПOCTAHOBKA B OЧEPEДЬ
C   DEL - ИЗ'ЯTИE ИЗ OЧEPEДИ
C   CHK - ПPOBEPKA ИCЧEPПAHИЯ TAЙMEPA
C
C...   ФOPMAT TAЙMEPA :
C   48-22 : BPEMЯ CPAБATЫBAHИЯ (CEK.)
C   21-16 : Д H З  ЗAДAЧИ ИЛИ 0
C   15-1  : AДPEC ПPOЦEДYPЫ OTPAБOTKИ
C
  SET TIMER:,ENTRY,
  :,24,2003B
  ,ATX,TIMER
  ,NTR,2
  ,WTC,NTIMER
  :14,VTM,-LQUE
  14,VIM,*+2
  :,33,.OЧEPEДЬ
  13,UJ,.ПOЛHA
  :,XTA,NTIMER
  ,ATI,14
  ,ARX,BIT1
  ,ATX,NTIMER
C
C   BCTABKA HOBOГO TAЙMEPA
C   B OЧEPEДЬ, YПOPЯДOЧEHHYЮ
C   ПO BOЗPACTAHИЮ BPEMEH
C
  SET1:14,XTA,QT-1
  14,ATX,QT
  ,A-X,TIMER
  ,U1A,SET2
  14,UTM,-1
  14,VIM,SET1
C---
  SET2:,XTA,TIMER
  14,ATX,QT
  ,ASN,64+15
  ,AAX,C77
  ,ATI,14.ДHЗ
  ,XTA,RDSCAL
  14,AOX,BITS
  14,AEX,BITS
  ,ATX,RDSCAL
  ,XTA,SCLTWJ
  14,AOX,BITS
  ,UJ,TO SCAL
C
C...  PAБOTA OT ПPEPЫBAHИЙ
C
  CHK TIMER:,ENTRY,
  ,NTR,2.БЛИЖAЙШИЙ
  ,XTA,ABTIME.TAЙMEP
  ,A-X,QT.CДOX
  13,U1A,. - HET
  ,XTA,QT
  ,ATI,13.ПOCЛE "DEL"
C
C...  ИCKЛЮЧEHИE ИЗ OЧEPEДИ TAЙMEPOB
C
  DEL TIMER:,ENTRY,
  :,24,2003B
  ,ATX,TIMER
  14,VTM,QT
  ,AAX,C77777
  :,UZA,*+1.TAЙMEP ЗAДAH
  ,XTA,C77777.ПOЛHOCTЬЮ
  :,AOX,=77 00000.TOЛЬKO ДHЗ
  ,ATX,MASK
C---
  DEL1:14,XTA,
  14,UTM,1
  ,AEX,MAXTIMER
  13,UZA,.HE HAЙДEH
  ,AEX,TIMER
  ,AAX,MASK
  ,U1A,DEL1
  ,XTA,NTIMER
  ,ARX,C77777
  ,ATX,NTIMER
C---
  DEL2:14,XTA,.ПOДBИЖKA
  14,ATX,-1.OЧEPEДИ
  14,UTM,1
  ,AEX,MAXTIMER
  ,U1A,DEL2
  ,XTA,TIMER
  ,ASN,64+15
  ,AAX,C77
  13,UZA,
  ,ATX,MSELECT
  ,ATI,14.Д H З
  ,XTA,RDSCAL
  14,AOX,BITS
  ,ATX,RDSCAL
  ,XTA,SCLTWJ
  14,AOX,BITS
  14,AEX,BITS
  TO SCAL:,ATX,SCLTWJ
  13,UJ,
C---
  P/NEWTA:,Z00,
  ,Z00,NEWTA
  MAXTIMER:,OCT,775
  MASK:,BSS,1.PAБ.ЯЧ.
  TIMER:,BSS,1.PAБ.ЯЧ.
 ,END,
 K*CIO:,NAME,.30 OKT 79 ЛBБ
C
C     ЛOПATKO B.Б., ФИAЭ
C
C  ПPOГPAMMA ЭKCTPAKOДA CBЯЗИ C
C  ДPYГИMИ ЭBM ЧEPEЗ KOMMYTATOP
C   ЭBM БЭCM-6 - ЭBM MOДYЛИ
C  И ПЛATY ПEPEДAЧИ ДAHHЫX B M-6000
C  /KOMMYTATOP PAЗPAБOTAH B OBT ФИAЭ
C   OTЧET 10/HИP-566 OT 13.10.78Г.
C  ABTOPЫ:C.T.OKYHEB,E.П.CHEГИPEB И ДP./
C
C
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR
 ,CONT,SAVI15,SAVI14,SAVI13
 ,CONT,SAVMIR
 *YCЫ:LC,BLOCK,ГYC,RDSCAL
 ,CONT,COMMIR,COMPIR
C
 ABTIME:,LC,1
 DISREG:,LC,1
 FULWOR:,LC,1
 C77777:,LC,1
 C377:,LC,1
 C7:,LC,1
 C5:,LC,1
 C3:,LC,1
 *677:B,BLOCK,BITS
 ,CONT,B48,B47,B46,B45
 ,CONT,B44,B43,B42,B41
 ,CONT,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33
 ,CONT,B32,B31,B30,B29
 ,CONT,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21
 ,CONT,B20,B19,B18,B17
 ,CONT,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B9
 ,CONT,B8,B7,B6,B5
 ,CONT,B4,B3,B2,B1
 CONTIME:LC,BLOCK,(5),TCALC
 YCTP:LC,BLOCK,(5),XГYC
 K*N/SEND:LC,BLOCK,N/SEND
 SETMIR:,SUBP,
 PERMIR:,SUBP,
 RETURN:,SUBP,
 TIME10:,SUBP,
 CL A NEW TA:,SUBP,
 NEW TA:,SUBP,
C
C
C   ПPOГPAMMA OБMEHA БAЙTOM
C   C YKAЗAHHЫM MOДYЛEM (ЭBM)
C
C
C       BЫЗOB ЭKCTPAKOДA:
C        ,*57,2
C
C   CПEЦИФИKAЦИИ ЗAДAЮTCЯ HA CYMMATOPE
C   ПEPEД BЫЗOBOM Э/KOДA.
C   ПOCЛE ИCПOЛHEHИЯ PEЗYЛЬTAT BOЗBPAЩAETCЯ
C   TAKЖE HA CYMMATOPE
C
C
C   PAЗPЯДЫ CYMMATOPA:
C
C
C
C  48-47PP=11 - ЗAДAЧA OCBOБOЖДAET ЛИHИЮ
C
C
C
C
C
C  48-47PP=10 - ЗAДAЧA ЗAXBATЫBAET ЛИHИЮ
C    8-1PP=0  - БYДET CBЯЗЬ C M-6000
C               ЧEPEЗ ПЛATY
C    8-1PP HE 0 - CBЯЗЬ ЧEPEЗ KOMMYTATOP
C       ЗAДAETCЯ ПOЗИЦИOHHЫЙ AДPEC MOДYЛЯ:
C       1P=1 - 1-Й MOДYЛЬ
C       2P=1 - 2-Й MOДYЛЬ
C       .....
C       8P=1 - 8-Й MOДYЛЬ.
C
C  PEЗYЛЬTAT:
C       ACCUMULATOR=0 - ЛИHИЯ ЗAXBAЧEHA
C        48P=1 - ЛИHИЯ ЗAHЯTA ДPYГOЙ ЗAДAЧEЙ
C
C
C
C
C  48-47PP=01 - ЗAПИCЬ B MOДYЛЬ
C     45P=1 - KOHTPOЛЬ ЗAПИCИ ПO 15 ПPП
C  ( ЖДY CИГHAЛ *KOД ПPИHЯT* OT MOДYЛЯ )
C      39-25PP - BPEMЯ OЖИДAHИЯ ПPИ KOHTPOЛE
C                ЗAДAHHOE B 1/19 CEK
C      8-1PP   - KOД ЗAПИCИ
C
C  PEЗYЛЬTAT:
C       ACCUMULATOR=0 - KOД ЗAПИCAH
C         48P=1 - ЛИHИЯ ЧYЖAЯ: ЗAДAЧA HE
C         ЗAXBATИЛA ЛИHИЮ ЛИБO ЛИHИЯ
C         ЗAHЯTA ДPYГOЙ ЗAДAЧEЙ
C         47P=1 - ИCTEKЛO BPEMЯ KOHTPOЛЯ,
C         ECЛИ БЫЛ ЗAДAH KOHTPOЛЬ ЗAПИCИ
C
C
C
C
C  48-47PP=00 - ЧTEHИE ИЗ MOДYЛЯ
C     45P=1 - KOHTPOЛЬ ЧTEHИЯ
C   ( BЫДATЬ CИГHAЛ *KOД ПPИHЯT* B MOДYЛЬ )
C      39-25PP - BPEMЯ OЖИДAHИЯ ПPИ ЧTEHИИ,
C                ЗAДAHHOE B 1/19 CEK
C
C  PEЗYЛЬTAT:
C       ACCUMULATOR:
C         48P=1 - ЛИHИЯ ЧYЖAЯ: ЗAДAЧA HE
C         ЗAXBATИЛA ЛИHИЮ ЛИБO ЛИHИЯ
C         ЗAHЯTA ДPYГOЙ ЗAДAЧEЙ
C  47P=1 - ИCTEKЛO BPEMЯ OЖИДAHИЯ ЧTEHИЯ
C   12-10PP - AДPEC MOДYЛЯ ЧTEHИЯ,
C             ЧИCЛO OT 0 ПO 7
C     9P - ДOПOЛHEHИE ЧИCЛA "1" B KOДE
C          ДO ЧETHOГO
C        8-1PP   - KOД ЧTEHИЯ
C
C
C   BXOД ИЗ NEW MACRO:
C  YПPЯTAHЫ AC И I14.
C   AC HA CYMMATOPE:
 ,ASN,64+46.
C  KOД OПEPAЦИИ = 00..11
 ,ATI,14
C  ЗAXBAЧEH ЛИ З/KOД ( ЛИHИЯ )
 ,XTA,XГYC
 ,AEX,ГYC
 ,ASN,64+15.KAЧKA ИПЗ
 14,UJ,SW
 SW:,BSS,.OПEPAЦИИ:
C 00 - ЧTEHИE ИЗ MOДYЛЯ
 ,U1A,ЗAHЯT
 ,UJ,IN REC
C 01 - ЗAПИCЬ B MOДYЛЬ
 ,U1A,ЗAHЯT
 ,UJ,IN SEND
C 10 - ЗAXBAT ЛИHИИ
 ,UZA,SET N/.CMEHA MOДYЛЯ
 ,UJ,CH MNPL
C 11 - OCBOБOЖДEHИE ЛИHИИ
 ,U1A,IN JOB1
 ,ATX,XГYC
 IN JOB1:,BSS,
C BOЗBPAT B ЗAДAЧY - ПPЯMO
C ЛИБO ПOCЛE NEW TASK
 ,MTJ,27B
 2,IJ,
C
C
 CH MNPL:,BSS,
 ,XTA,XГYC
 ,UZA,MNPL
C ЛИHИЯ ЗAHЯTA,BOЗBPAT B ЗAДAЧY
 ЗAHЯT:,BSS,
 ,XTA,B48
 ,UJ,IN JOB1
C
 MNPL:,BSS,
 ,XTA,ГYC
 ,ATX,XГYC
C
 SET N/:,BSS,
C ПPOBEPKA YCTPOЙCTBA:KOMMYTATOP ИЛИ ПЛATA
 ,XTA,SAVAC
 ,AAX,C377
 ,ATX,N/SEND.AДPEC 8-1PP
 ,UZA,ГAШ41.ДЛЯ M-6000
 ,AOX,B9.ПOЗИЦ.
 ,ATX,N/SEND
C ЗAПYCK KOMMYTATOPA
C C ГAШEHИEM ПO BCEM MOДYЛЯM
 14,VTM,-8
 ,XTA,C5
 ПYCK:,EXT,11B
 14,VLM,ПYCK
C ГAШEHИE 41P ГPП
 ГAШ41:,XTA,B41
 ,AEX,FULWOR
 ,ATI,
 ,MOD,37B
 ,XTA,.XOPOШO
 ,UJ,IN JOB1
C
C
 SAVI:,BSS,
C  ПPЯЧEM SR,I15,I13
 ,RTE,177B
 ,ATX,SAVSR
 ,ITA,15
 ,ATX,SAVI15
 ,ITA,13
 ,ATX,SAVI13
C ПPЯЧEM KOHTPOЛЬ OБMEHA
 ,XTA,SAVAC
 ,AAX,B45
 ,ATX,CTRL
 14,UJ,
C
C  ЗAПИCЬ B MOДYЛЬ
 IN SEND:14,VJM,SAVI
 ,XTA,N/SEND
 ,ATI,14.=N/SEND
 ,UZA,ЗAПKOД.M-6000
 ,EXT,171B.AДPECAT
 ЗAПKOД:,BSS,
 ,XTA,SAVAC
 ,AAX,C377
 ,EXT,171B.KOД
C ЗAKAЗAH ЛИ KOHTPOЛЬ ЗAПИCИ
 ,XTA,CTRL
 ,UZA,IN JOB1.-HET
C  YCTAHOBKA 15P ПPM
 ,XTA,B15
 ,AOX,COMPIR
 ,ATX,COMPIR
 ,EXT,34B
 14,VZM,GRM.N/SEND=0
C  PAЗPEШEHИE OTPAБOTKИ B KOMMYTATOP
 ,XTA,B9
 ,EXT,171B
 GRM:,BSS,
C  OTKPOEM 37P ГPM
 ,XTA,B37
C ЗABEДEM БYДИЛЬHИK И ЗAKPOEM ЗAДAЧY
 ,UJ,TIME ON
C
C  BXOД ПO 37P ГPП И 15P ПPП
C
 K*SEND:,ENTRY,
C  AHAЛИЗ:OTKOГO OTPAБOTKA
 ,UZA,ACCUM.M-6000
C  ЖДY OTPAБOTKИ OT MOДYЛЯ N
 ,EXT,171B
 ,EXT,0.CБPOC PABY
C  ЧTEHИE ПPП
 ,EXT,4030B.24-13PP
 ,AAX,B15
 ,UZA,RETURN
 ,XTA,C11
 ,EXT,11B.ГAШ.OTP.
 ,XTA,
 ,UJ,ACCUM
C
C
C
 IN REC:,BSS,
 14,VJM,SAVI
C
C  ЧTEHИE ИЗ MOДYЛЯ
C ПPOБA ПPEP 41P ГPП
 ,MOD,237B
 ,AAX,B41
 ,U1A,QUIC
C OTKPOEM 41P ГPM
 ,XTA,B41
 TIME ON:,BSS,
 15,VTM,TIMER
 ,CALL,SETMIR.=PERMIR+4
C ЗABOДИM БYДИЛЬHИK
 ,XTA,SAVAC.BPEMЯ
 ,ASN,64+24.B 39-25PP
 ,AAX,C77777.1=1/19CEK
 ,ARX,ABTIME+1
 ,ATX,WAIT.
 ,ITA,15.=A*TIMER
 ,ATX,TCALC
C  ЗAKPOEM ЗAДAЧY:
C  ФИKCИPYEM ИПЗ B MOЗY
 ,XTA,DISREG
 ,ATI,27B
C ЗAПOMHИM MECTO ИПЗ
 ,XTA,ГYC
 ,ATX,XГYC
C  ЗAKAЖEM BXOД ИЗ NEW TASK
 13,VTM,IN JOB1
 13,MTJ,33B
 ,UJ,CL A NEW TA
C  ЖДEM,ЖДEM,...,A БYДИЛЬHИK TИKAET
C
 TIMER:,BSS,
 ,NTR,3
 ,XTA,ABTIME+1
 ,A-X,WAIT
 ,U1A,TIME10
C  ЗBOHOK БYДИЛЬHИKA
 ,XTA,B47
 ,UJ,ACCUM
C
 QUIC:,BSS,
C  ГACИM 41P ГPП
 ,AEX,FULWOR.ACC=B41
 14,VTM,0.ФЛAГ QUIC
 ,MOD,37B
 ,EXT,4015B.ЧT.KOДA
C
C  BXOД ПO 41P ГPП ИЗ EXTINTER'A
C  BAЖHO, ЧTO I14=8
C
 K*RECEIV:,ENTRY,
C YПPЯT CЧИT KOДA
 ,ATX,WAIT
C ЗAДAH ЛИ KOHTPOЛЬ ПPИEMA
 ,XTA,CTRL
 ,UZA,HEHAДO
C  CИГHAЛ *KOД ПPИHЯT* B MOДYЛЬ
 ,XTA,N/SEND
 ,UZA,RESM6000
 ,XTA,B2
 RESM6000:,AOX,B1.1,3
 ,ATI,
 ,EXT,11B
 ,ATI,
C CЮДA - ПYCK CA (ДЛЯ MYЛЬTИПЛEKCOPA)
 HEHAДO:,BSS,
C  KYДA ДAЛЬШE
 ,XTA,WAIT
 14,VZM,IN JOB1
 ACCUM:,BSS,
 ,WTC,XГYC
 ,ATX,.ACCUM
C  OTKPOEM ЗAДAЧY
C  ГACИM 15P ПPM (И 37P ГPM)
 ,XTA,B15
 ,CALL,CLOPIR
C  ГACИM 41P ГPM
 ,XTA,B41
 ,CALL,CLOMIR
 ,XTA,XГYC
 ,ASN,64+42
 ,ATI,15
 15,XTA,BITS
 ,AOX,RDSCAL
 ,ATX,RDSCAL
 ,XTA,
 ,ATX,TCALC
 ,UJ,NEW TA
C  BOЗBPAT ПOCЛE NEW TASK ЧEPEЗ
C  IN JOB1
C
 C11:,LOG,11
 CTRL:,BSS,1
 WAIT:,BSS,1
 ,END,
 MULTITYP:,NAME,.
C
 '15.02.73. , BEPETEHOB  '
C
C---------   MOHИTOP CИCTEMЫ 'MYЛЬTИTAЙП'
C
 'PEДAKЦИЯ OT 30.05.73'
 'PEДAKЦИЯ OT 24.06.78'
C--------
 *ИПД:LC,BLOCK,
 ,CONT,XNF,XNFM,(2),XNW
 ,CONT,(1),XNCM,(2),Ш/FULL(2)
 ,CONT,Ш/ПYCK(2),Ш/CЛY(29)
 ,CONT,OUTJOBSC,(7),FLERBUZ
 ,CONT,EXTSC(2)
 ,CONT,ПAPTИЗAH,БЛOKAЦПY
  ,CONT,MOЖHOKAЧ,ШKП
  ,CONT,SCDEBUG
  ,CONT,(5)
  ,CONT,SCENDJO
  LISTFLAG:,EQU,*ИПД+35B
  C/BUF   :,EQU,*ИПД+37B
C--------
 NFM  :,WEQ,XNFM
 NЖДY :,WEQ,XNW
 NLMAT:,EQU,NЖДY-1
C--------
 NSHI:,WEQ,XNCM
 NJ  :,EQU,NSHI-1
C--------
 BITS:,EQU,677B
 BLMAT:,EQU,BITS+NLMAT
C--------
 *ИПK:LC,BLOCK,INFBA
 INFEX:,EQU,*ИПK+NSHI
C--------
 SCALES:LC,BLOCK,(4),SCALCLTA
 ,CONT,(4),SCSTOP
 ,CONT,SC/CLJ
C--------
C
C*****   ИCПOЛЬЗYEMAЯ B ИПЗ ПAMЯTЬ
C
 CPTIME:,EQU,-1
 S33:,EQU,3
 S32:,EQU,4
 S27:,EQU,5
 I14:,EQU,10B
 S34:,EQU,26B
 S35:,EQU,27B
 TMATH:,EQU,30B
 COPYS32:,EQU,46B
 COPYI14:,EQU,47B
 REGSCAL:,EQU,100B
 COPYS33:,EQU,106B
 BISTIME:,EQU,110B
 LIMTIME:,EQU,111B
 PULT:,EQU,113B
 PASS/J:,EQU,114B
  AUS:,EQU,117B.HOMEP PASS'A
 NAM/J:,EQU,120B.3 CЛOBA
  ИP/34:,EQU,563B
 PEГ34:,EQU,ИP/34
 READ :,EQU,ИP/34
 ФREAD:,EQU,ИP/34
 WRIT :,EQU,ИP/34
 SCJOTЛ:,EQU,564B
 ИP/35:,EQU,ИP/34
 *635:B,BLOCK,D/SW
 ,CONT,R/R,W/W,O/A/
 ,CONT,IDENTI/(2),ISUB/(2)
 *632:B,BLOCK,П YПP(14)
  *655:B,BLOCK,NAMBUFER(5)
C
C*****   TИПЫ PAБOT OTЛAДЧИKA
C
 *1:,BLOCK,
  1,CONT,BЫCBSUMR
  2,CONT,BЫCBIR
  3,CONT,BЫCBOCT
  4,CONT,BЫCBФИЗ
  5,CONT,WRIWOR
  6,CONT,(2)
  8,CONT,CИMOCA
  9,CONT,CИMOЗA
 10,CONT,CИMOЧT
C
C*****   CTPYKTYPЫ ИHФOPMAЦИOHHЫX ПOЛEЙ
C
C..... - 'BЫ/BB' (CЛOBO-KAHAЛ)
C
 '    48 -  ЗAДAH OПEPAHД BЫBOДA (ЛИCT,RPU)
 '    47-39 OTH. N ЗOHЫ BЫBOДA
 '    38 -  ЗAДAH 'BBOД'/'SEND'
 '    37-29 HAЧ.ЗOHA ДЛЯ BBOД/SEND
 '    28-20 OTH. N ЗOHЫ-OГPAHИЧИTEЛЯ
 '    19-01 PEЗEPB
C
C.....   INFEX (CЛOBO-ШИФP)
C        OЧEPEДЬ (CЛOBO-ЭЛEMEHT)
C
 '    48-34 ФИЗ.YKAЗATEЛЬ ЗAП.ЗAДAЧИ
 '    33-22 PEЗEPB
 '    21 -  OTЛAДKA ЗAПPEЩEHA
 '    20 -  ИHKOГHИTO
 '    19 -  AYПY ==> TEPMИHAЛ
 '    18 -  БЛOK. AЦПY ПPИ B19=1
 '    17-15 ЗHAЧEHИЯ 13-11 PP.INFEX
 '          ПOCЛE ЗAПYCKA ИЗ ПAKETA
 '    14 -  БYФEP HA MБ ИЛИ 7/M
 '    13-12 TИП ЗAПYCKA ЗAДAЧИ
 '          = 0 - ЗAПИCЬ B ПAKET
 '          = 1 - 'TEP' , 'OTЛ'
 '          = 2 - 'CЛY'
 '          = 3 - 'CЛA'
C     11 -  ЗAПYCK ПO 'OTЛ' (OCTAHOB - 100B)
C     10-01 HOMEP ПOЛЬЗOBATEЛЯ ПO PASS-ФИO
C
C.....   ЧИCЛO KAHAЛOB И EГO ПPOИЗBOДHЫE
C
 NC:,EQU,10.ЧИCЛO KAHAЛOB
 NCM1:,EQU,NC-1
 NCM3:,EQU,NC-3
 NC*2:,P*P,(NC)2
 NC*3:,EQU,NC*2+NC
 NC*4:,P*P,(NC)4
 NC*4P1:,EQU,NC*4+1.
C
 NЛ ИПЗ:,EQU,30B
 NЛИПЗ/:,EQU,=:0000 30
 AИПЗ1:,P*P,(NЛИПЗ)1024
 AИПЗ :,EQU,AИПЗ1+3
 L WLS:,EQU,16.
C******
 CLOSE*MT:,SUBP,
 *TLSIZE:LC,BLOCK,(3),XNSS
 NSS:,WEQ,XNSS
 *TLSYS:LC,BLOCK,(1),STATMT,EDITOR
 INITMT:,EQU,STATMT+NSS
 REFMT:,EQU,INITMT+NSS
 XNT:,EQU,-4
  *TLBUFI:LC,BLOCK,CIN
  EDIT/INF:,EQU,= 7770 0000 7770 0067
    NPAБЛИCT:,LC,1
 *SCAL71:LC,BLOCK,SC71,REDY71,SCTER
 ,CONT,SCAL67,SCШAГ,SCB71
 *TASK71:LC,BLOCK,(8),CHAN/J(8)
    C77777:,LC,1
 BIT13D:,EQU,743B
 BIT12D:,EQU,744B
   BIT47:,EQU,701B
 BIT1:,EQU,757B
   B48/31:,LC,1
    BIT33D:,EQU,717B
C******
 OUTJOB:,SUBP,.
 OUT CW:,LC,2.
   DISPBASE:,LC,4
 CL TASK:,SUBP,
 SELECT:,SUBP,
 VALERINA:,SUBP,.
  *PL/MT:,LC,1
 B48:,EQU,=:4.
 B43:,EQU,=:01.LF,ПC
 B24:,EQU,=4000 0000.
 OTBЯЗKA:,EQU,=:0000 2.
 *1:,BLOCK,B,C,PP,R,NT,W,N,CA,W1,W2
 ,CONT,AI,M,T
 AI:I,BLOCK,S,AS.
C
C......   PAБOЧИЙ ЛИCT MYЛЬTИTAЙПA
C
 PAБЛИCT:,EQU,0.
 BEG Z:,EQU,72B
 SC BL NL:,EQU,73B
 SC VID:,EQU,75B
 SC SEND:,EQU,76B
 SC LOC:,EQU,77B.
 ЭTOБPAЗ:,EQU,PAБЛИCT+74.112B
 MACKAOБ:,EQU,ЭTOБPAЗ+NC.
 RETSCAN:,EQU,MACKAOБ+NC.
 NUSTR:,EQU,RETSCAN.
C 48-37 NUSTR(4 ЦИФPЫ), 15-1 RETSCAN
 BЫ/BB:,EQU,NUSTR+NC.
 CONT1:,EQU,BЫ/BB+NC.
 CONT1:I,BLOCK,
 ,CONT,CARD1(44)
 ,CONT,WLS(17)
 ,CONT,STRINGS(240)
 ,CONT,SCJOB(0),БЫЛKOД
 ,CONT,SCЖДY
 ,CONT,LISC
 ,CONT,LISC1
 ,CONT,LISC2
 ,CONT,TAKESC
 ,CONT,PASS
 ,CONT,T IN(0),WS
 ,CONT,SYM
 ,CONT,DD(0),TW(0),WS1
 ,CONT,DN(0),RW(0),WS2
 ,CONT,BIT
 ,CONT,XAP
 ,CONT,(2)
 ,CONT,BCH
 ,CONT,MTSCAL(6)
 ,CONT,SCMT,REMT,SCWAIT
 ,CONT,JOB.
 ESCAL:,EQU,REMT
 RET ADR:,EQU,JOB+NC.
 NUMB US:,EQU,RET ADR+NC.
C  PACПPEДEЛEHИE PAЗPЯДOB NUMB US(C):
C  48-43 - ДHЗ TEЛE-ЗAДAЧИ
C     24 - PAЗPEШEH BBOД B БYФEP
C     20 - ПPEPBAH BЫBOД ( ДЛЯ *71 )
C  19-16 - N TEЛE-KAHAЛA ЗAДAЧИ C *71
C  10-01 - N PASS KЛИEHTA ПO PASS-ФИO
 TEK AДP:,EQU,NUMB US+NC.
  MБ ИHФ:,EQU,TEK AДP+NC.
C  PACПPEДEЛEHИE PAЗPЯДOB  MБ ИHФ(C):
C  - ДЛЯ БYФEPOB ( ЛИЧHOГO ИЛИ 7/M )
C    48-46 TИП БYФEPA 48=1 - 7/M
C    45-40 MAT.HOMEP MЛ БYФEPA
C    39-31 OTH. N HAЧ.ЗOHЫ ДЛЯ BBOД/SEND/ЛИCT
C    09-01 OTH. N ПOCЛ.ЗOHЫ (OГPAHИЧИTEЛЬ)
C
C   - ДЛЯ CИCTEMHOГO BЫBOДA:
C     27-10 NBЫBOДA,NBBOДA,NЛAБ
C     09-01 N TEK.ЗOHЫ B CПИCKE ЛИБO 0
C
 A STR:,EQU,MБ ИHФ+NC.
  RONLY:,EQU,ASTR+NC
  FILLEN:,EQU,RONLY+1
  COPYRA:,EQU,FILLEN+NC
  LPAG:,EQU,COPYRA+NC
 LASTORD:,EQU,LPAG+NC
 SC100:,EQU,LASTORD+NC
 ZBCH:,EQU,SC100
 CARD1:I,BLOCK,
 ,CONT,WNF,WNW,WNN,BCH/T
 ,CONT,O/A,IDENTI(2),ISUB(2)
 MAXL:,EQU,SC100+1.ДЛЯ VR
 *1TYPE:,EQU,MAXL+NC.ДЛЯ FETCH И
 XRS:,EQU,*1TYPE+NC.FORM PACK
 TYP:,EQU,XRS+NC
 SPB:,EQU,TYP+NC
 MBINFOWN:,EQU,SPB+NC
 OLD BUF:,EQU,MBINFOWN+NC.ДЛЯ MAKE MT
  MATBUFSP:,EQU,OLDBUF+NC*4.ГPYПП.BBOД
  BUFSP:,EQU,MATBUFSP+NC
C
 PБYФ:24,EQU,1750B.ДЛЯ VR И FETCH
C
C
C......   ПOДBЯЗKA HEPEЗИДEHTA MYЛЬTИTAЙПA
C
 L NRS:,EQU,2000B.
C  LNR(0)  15-1 - A(*DRUMUS)
 L NRS :I,BLOCK,
 ,CONT,GIVECARD(0),*DRUMUS
 ,CONT,WRITE
 ,CONT,FORMAT(0),ASTERR
 ,CONT,E NEXT
 ,CONT,E FG0
 ,CONT,SCAN
 ,CONT,FORM INF
 ,CONT,OPERANDS
 ,CONT,E DIAGN(0),MULTITYP
 ,CONT,CAT I/O(0),BUFSAP
 ,CONT,CHE PASS
 ,CONT,CLEAR
 ,CONT,(3).PEЗEPB
 ,CONT,A WEXCH
 C UJ:,EQU,=30 00000.
  MAKE MT:,SUBP,
 OLD MT:,SUBP,
 EXCH NRS:,SUBP,.MECTO HEP.
 DEXNRS:,EQU,776B.B PEЗИДEHTE ДД
 E FIL:,EQU,=2 00000.BIT 17
C
C......   YBЯЗKA MYЛЬTИTAЙПA C ДИCПETЧEPOM
 *YCЫ:LC,BLOCK,ГYC,RDSCAL(8),YCLP2
 ДHЗ:,LC,1.
 TPHYS:,LC,1.
 L2:,P/P,(*TLSYS)1024.
  TABLEMT:LC,BLOCK,(16),T1MT(32),(64),TNMT(32)
  LISTSTRA:,LC,
C..........
 BAS:,BSS,.
 B,BASE,BAS.
   N1L:,P/P,(BAS)(1024)
   N1L2:,EQU,N1L+1
 N1L1:,P*P,(N1L2) 64
 ,*65,STATMT
 ,ASN,64+42
 ,U1A,HAЧAЛO.ПPИBЯЗKA БЫЛA
C
C******   ПEPBOHAЧAЛЬHAЯ HACTPOЙKA CИCTEMЫ
    ,*65,DISPBASE+1
 ,ARX,AN2L
 ,AOX,BIT40M
   ,ATX,BCH
   ,*70,BCH
  ,*72,=:11 40 37 77
 ,ITA,B
 ,FUN,77B.ФИKC.1 ЛИCT MT
 ,XTA,
 ,FUN,77B.ФИKC.PAБ.ЛИCT
 ,*76,DD1.
 BIT40M:,OCT,001
 AN2L:,,N1L1
 ,,N1L2
 CL2:,,.
 ,,L2.
 DD1:,BSS,.
 14,REL,DD1.
 ,ATX,NPAБЛИCT
C......   PAЗPEШEHИE PAБOTЫ C 34 ФИЗ-ЛИCTOM
 ,XTA,CL2.
 ,ASN,64-21.
 ,AOX,BIT1
 ,ATX,TPHYS+L2.
 ,ASN,64-9.
   ,AOX,BIT47
 ,WTC,ГYC
 ,ATX,TMATH+L2
C......
  ,XTA,EXCHNRS
  ,ATX,DEXNRS
 ,MTJ,27B.
 ,REL,.
 15,VTM,DD2.
 15,MTJ,33B.
 3,IJ,.
 B21/16:,LOG,77 00000
 B,BAS,BAS
  SAVW1:,BSS,1
  XPM32:,BSS,1
 DEL CNT:,BSS,.ИCKЛ. CO CЧETA
 ,XTA,OUTJOBSC.
 W1,AOX,BLMAT
 ,ATX,OUTJOBSC.
 W1,XTA,*YCЫ+NLMAT.YC ЗAДAЧИ
 ,ATX,OUT CW.
 W,VTM,574B.BXOД ЗAДAЧИ
 ,ITA,W.HA ЭK-74
 13,VJM,OUT JOB.
 W,VTM,NEXT.
 W,MTJ,33B.
 ,MTJ,27B.BOЗBPAT ИЗ
 3,IJ,.BЫБPACЫBAHИЯ
 PEAK:15,37,ABOCTMT.
 15,36,2.
 DD2:,BSS,.
C......   ЗAГPYЗKA CBOEГO HEPEЗИДEHTA И KOHTAKT
 W1,VTM,1-1024.
  ,DRUM,.CYMMATOP=EXCHNRS
  W,VTM,
  ,XTA,.ЧИCTKA PAБ.ЛИCTA
 CLE:W1,ATX,PAБЛИCT+1023.
 W1,VLM,CLE.
 ,XTA,PEAK.
 ,*72,70707B.
  ,CTX,1.ЧИCЛ.CBEPTKA
 14,VTM,HAЧAЛO.
 ,ITA,14.
 ,AOX,C UJ.
 ,CTX,A WEXCH.
 14,VTM,NEXT.
 ,ITA,14.
 ,AOX,C UJ.
 ,CTX,E NEXT.
 14,VTM,FG0.
 ,ITA,14.
 ,AOX,C UJ.
 ,CTX,E FG0.
 ,XTA,CDIAGN
 ,CTX,E DIAGN.
 ,XTA,CCLE
 ,CTX,CLEAR.
 14,VTM,STRINGS+6
  13,VTM,BUFSP
 15,VTM,-7
 DD3:,ITA,14.
 15,ATX,A STR+9.
 14,UTM,30
  ,ITA,13
  15,ATX,MATBUFSP+9
  13,UTM,24
 15,VLM,DD3.
C
C.....   YCTAHOBKA  BETBЛEHИЯ
 ,UTC,VALERINA
 ,XTA,
 ,FUN,50B
 ,XTA,EV*STRT.ПPИTBOPИMCЯ
 ,FUN,54B. CTPOЧHИKOM
 ,UJ,CLOSE
 EV*STRT:,OCT,00200000 4
C
 CDIAGN:,UJ,RONE
 ,Z00,BAS
 CCLE:C,XTA,BЫ/BB.
 ,UJ,ГAШ BB.
C
C******   KOHEЦ HACTPOЙKИ CИCTEMЫ
C
 HAЧAЛO:,BSS,.
 NT,VTM,MTSCAL-ESCAL
 ,FUN,56B.БЛOK.BETBЛEH.
 MLOOP:,BSS,.
C......   ЦИKЛ ПO TИПAM PAБOT (ШKAЛAM)
 NT,XTA,ESCAL
 ,U1A,ML1
 NT,VLM,MLOOP
 CLOSE:,BSS,
 ,FUN,57B.ДEБЛOK.BETBЛEH.
 ,UJ,CLOSE*MT
 ML1:,ANX,=77777.
 ,ATI,C.HOMEP KAHAЛA
 ,XTA,B48.
 C,ASN,64.
 ,ATX,B CH.
 ,AAX,SCTER
 ,AAX,SC71
 ,ATX,BCH/T
 ,XTA,FULWOR
 ,AEX,BCH
 ,ATX,ZBCH
 NT,AAX,ESCAL.OT KAHAЛA
 NT,ATX,E SCAL.
 ,FUN,57B.ДEБЛOK.BETBЛEH.
 NT,UJ,E SC SW.
 SC SW:,BSS,.
C.........   ПEPEKЛЮЧATEЛЬ ШKAЛ
C------------------
 :R,VTM,REPEAT.OTMEHA CTPOKИ
 ,UJ,ПH KOДA.
 :,UJ,END CHAN.CБPOC KAHAЛA
 :,XTA,BCH.BBOД/BЫBOД
 ,UJ,LINE
 :R,VTM,INTERRUP.ПPEP.BЫBOД
 ,UJ,ПH KOДA.
 :T,VTM,HAЧCEAHC.H A Ч A Л O
 ,UJ,NEW USER.HAЧ.CEAHCA
 :R,VTM,ANAL
 ,UJ,ПPOB ЖДY.
 :,UJ,ЖДYOБMEH.ПPOB. KO
 E SCSW:,BSS,
 :C,WTC,RET SCAN.
 ,UJ,.CKAHИPOBAHИE
C------------------
 ПH KOДA:,XTA,БЫЛ KOД.
 ,AAX,BCH.
 ,UZA,ПOДKOД.
 R,UJ,.
 LINE:,BSS,
 C,XTA,CHAN/J-2
  ,UZA,*+3
  ,AEX,
  ,*53,RDSCAL
 ,XTA,
 C,ATX,CHAN/J-2
 ,XTA,BCH
 ,AOX,REDY71
 ,ATX,REDY71
 ,XTA,BCH/T.ЗAKAЗ ЭK71
 C,WTC,RETADR
 ,UZA,. = HET
C-----   KOHEЦ OБMEHA ПO ЭK71
 C,XTA,JOB.  БЫЛ BBOД
 ,AAX,=:0000 04
 ,UZA,HE BB. = HET
  C,WTC,ASTR
  ,XTA,
  ,U1A,HE BB
  C,WTC,ASTR
  ,XTA,-2.ПOCЛ.CИMBOЛ
  ,AEX,=13."IL"
  ,UZA,TO MT
  ,AEX,=7.ИЛИ "HOME"
  ,U1A,HE BB
  TO MT:,BSS,
C...   ПEPEXOД B PEЖИM MT
  ,XTA,ZBCH
  ,AAX,SCTER
  ,ATX,SCTER
  ,XTA,ZBCH
  ,AAX,SC71
  ,ATX,SC71
  ,UJ,NEXT
 HE BB:C,XTA,NUMBUS
 ,ASN,64+42
 ,ATI,W1
 W1,*65,BITS
 ,AAX,SC/CLJ.ЗAДAЧA ЗAKPЫTA
 ,UZA,ЖДY
C-----   OTKPOEM ЖДYЩYЮ ЗAДAЧY
 WAS CLJ:,*76,OP J
 ,UJ,ЖДY
 OP J:,BSS,
 ,AEX,SC/CLJ
 ,ATX,SC/CLJ
 ,YTA,
  OTKP:,BSS,
 ,AOX,RDSCAL
 ,ATX,RDSCAL
  RET76:,BSS,
  ,MTJ,27B
  2,IJ,
 NEW USER:,BSS,.
 ,XTA,ZBCH
 ,AAX,SC LOC.
 ,ATX,SC LOC.
 ,XTA,SC SEND
 ,AAX,ZBCH
 ,ATX,SC SEND .ГAШEHИE ПPИЗHAKA SEND
 ,XTA,SC VID
 ,AAX,ZBCH
 ,ATX,SC VID
 R,VTM,ПOД KOД
 ,*65,7
 ,ASN,64+25
 ,AEX,NEVM
 ,AAX,=6H'''''''''7'''
 ,AEX,NEVM
 ,ATX,NEVM
 ,UJ,REDOUT
 INTERRUP:,BSS,.
 ,XTA,BCH/T.ЗAKAЗ ЭK71
  ,UZA,NO71. = HET
  ,XTA,= 20 00000
  C,AOX,NUMBUS
  C,ATX,NUMBUS
  ,UJ,NEXT
  NO71:,BSS,
 ,XTA,SC BLNL.
 ,AAX,ZBCH
 ,ATX,SC BLNL.
 ,XTA,LI SC.
 ,AAX,B CH.
 ,UIA,NEXT.
 C,WTC,ASTR
 ,XTA,
 ,AEX,TLIMT
 ,UZA,NEXT
 NEW TASK:,XTA,.
 C,ATX,TEK AДP.
 NEXT:R,VTM,ANAL.BBOД KAPTЫ
 ,XTA,BCH
 ,AAX,SC ЖДY.
 ,U1A,ЖДY IN.PEЖИM 'ЖДY'
 ,UJ,IN.HOPM. BBOД
 ANAL:,BSS,.ДИAЛOГ HA KAHAЛE
 R,VTM,NEXT
 C,WTC,ASTR
 ,XTA,.
 ,ATX,WS.
 ,AAX,=:776.
 ,UZA,DUMMY.M.B. COMM.RET
 ,XTA,WS
 ,AEX,KOHCEAHC
 ,UZA,TO ABORT.БEЗ ДOCБPOCA
 ,XTA,SC SEND.ЗAДAH ЛИ
 ,AAX,B CH
 ,U1A,E/SEND.-ДA
 C,XTA,NUMBUS.PEЖИM BBOДA
 ,AAX,B24
 ,U1A,TAKECARD.-ДA
 ,UJ,AN0.PEЖИM KOMAHД
 E/SEND:,BSS,
 ,XTA,WS.-ECTЬ SEND
 ,AEX,REFUSE
 ,AAX,=6H'377''377''377'''''''
 ,U1A,T/CARD.TEKCT
C.........   ПOИCK YK ПO TAБЛИЦE
 AN0:W,VTM,
 W1,VTM,CO CA.
 AN1:W1,XTA,.
 ,UZA,ПOДCKAЗ.KOHEЦ TAБЛ.
 AN2:,ATX,WS1.
 ,AEX,WS.
 ,AAX,=6H'377''377''377'''''''
 ,UZA,AN3
 W,UTM,1.
 ,XTA,WS1.
 ,ASN,64-24.
 ,U1A,AN2.2-Я ПOЛOB.
 W1,VLM,AN1.CЛEД.CЛOBO
 AN3:,XTA,B48
 W,ASN,64
 ,AAX,TYP/ORD
 ,UZA,AN4
  ,XTA,ZBCH
  ,AAX,LISC
  ,ATX,LISC
 ,XTA,WS
 AN4:C,ATX,LASTORD
 W,UJ,CC SW
 CC SW:,BSS,.
C------------------
 :,UJ,REF SEND.OTKAЗ OT ЖДY/SEND
 ПOД KOД:T,VTM,TPASS.HAЧAЛO
 ,UJ,OUT KOД.
 :,,.KOД
 ,UJ,ПPOB KOД.
  :CA,VTM,NEXT
 ,UJ,БYФEP.
  :C,XTA,MБ ИHФ
  ,UJ,ДEЛЬTA
 :,XTA,B CH
 ,UJ,SEND
 :,XTA,
 ,UJ,BBOД.
 :,,.BЫBOД-БYФEP
 ,UJ,BЫBOД.
 :T,VTM,TBREAK.AЦПY
 ,UJ,RO NE
 :,UJ,B80.BBOД БEЗ NNNN
 :T,VTM,CATOUT.KAT BЫBOДA
 ,UJ,CHAEND
 :T,VTM,CATINP.KAT BBOДA
 ,UJ,CHAEND
 :T,VTM,OЧEPEДЬ.OЧEPEДЬ
 ,UJ,CHAEND
 :T,VTM,TЗAПP
 ,UJ,ПEЧ.ПEЧATЬ
 :T,VTM,PEЗ.ПPOCMOTP
 ,UJ,CHAEND.ЛИCTИHГA
 :T,VTM,ИCK.ИCKЛЮЧИTЬ
 ,UJ,CHAEND.ИЗ ПAK.BBOДA
 ,UJ,HOB
 :R,VTM,LIST.ПPИKAЗ : 'ЛИCT'
 ,UJ,KIL BL
  :,XTA,
 ,UJ,TEL OP
 :, ,.ФOPMAT
 ,UJ,FORMAT.
 :T,VTM,ПYCK.ПYCK
 ,UJ,CHA END.
 :T,VTM,TEPП.TEP
   ,UJ,ЭK*71
 :,BSS,1.BPEMЯ
 END CHAN:,BSS,.
 :T,VTM,CEKOH.CTOП
 ,UJ,CHA END.
 TO ABORT:,BSS,
 :C,XTA,JOB.KOHEЦ
 ,UJ,ABORT
 :,UJ,ЖДY..ЖДY
  :W,VTM,ЗACЛ.ЗAП
  ,UJ,OTЛAДKA1
 :W,VTM,ЗAП ЧИC.ЧИЗ
  ,UJ,OTЛAДKA
 :T,VTM,OTЛП.OTЛ
 ,UJ,CHAEND
 :W,VTM,OCT ПO AДP.OCA
   ,UJ,OTЛAДKA
 :W,VTM,OCT ЗAП.OЗA
   ,UJ,OTЛAДKA
 :W,VTM,OCT ЧTEH.OЧT
   ,UJ,OTЛAДKA
 :W,VTM,OPEN JOB.ИДИ
   ,UJ,OTЛAДKA
    :T,VTM,PEГИCTPЫ.PEГ
   ,UJ,NJ C ИПЗ
 :W,VTM,OCT WORD.MЯЧ
   ,UJ,OTЛAДKA
 :W,VTM,KOCB ЧT.MЯK
  ,UJ,OTЛAДKA
 :W,VTM,ФИЗ ЧT.ФЯЧ
  ,UJ,OTЛAДKA
  :T,VTM,ШAГИ.ШAГ
  ,UJ,NJ C ИПЗ
 :W,VTM,DEC ЧИC.ДEC
 ,UJ,OTЛAДKA
 :W,VTM,NOTEP.PET
  ,UJ,OTЛAДKA
 :W,VTM,NOOTЛ.ЛTO
  ,UJ,OTЛAДKA
  :PP,VTM,0.KAK
 ,UJ,CПPAB.KAK ДEЛA
  :PP,VTM,1.CЧET
  ,UJ,CПPAB.(Ш20-01)
C
C+++++   ГOCПOДA! ЗABOДЯ HOBЫE ПPИKAЗЫ,
C           ПOMHИTE   ПPO   TYP/ORD !
C        ДOГOBOPИMCЯ, ЧTO BCE ПPИKAЗЫ,
C        ИMEЮЩИE TYP/ORD=1, БYДYT PACПO-
C        ЛOЖEHЫ BЫШE ЭTOГO KOMMEHTAPИЯ.
C
  :T,VTM,CЛYП.CЛY
 ,UJ,CHAEND
  :T,VTM,CЛAП.CЛA
 ,UJ,CHAEND
 :T,VTM,CЛOП.CЛO=CЛA+OTЛ
 ,UJ,CHAEND
  :T,VTM,RUNП.RUN
  ,UJ,ЭK*71
 :T,VTM,TPR.ПEЧATЬ И
 ,UJ,ЭK*71.HA TEPMИHAЛ
 :T,VTM,TNP.BЫBOД TOЛЬKO
 ,UJ,ЭK*71.HA TEPMИHAЛ
 :W1,VTM,-NJ. ПYЛЬT
 ,UJ,ПYЛЬT.ЗAДAЧE
 :W1,VTM,-NJ.OTKAЗ
 ,UJ,OTKAЗ.
 :R,VTM,ДOH.= ПPOПYCK
 ,UJ,KIL BL.  ДO HOMEPA
 :R,VTM,SCAN LIS.ПPИKAЗ : 'ДO'
 ,UJ,KIL BL.= ИCKATЬ OБPAЗ
  :T,VTM,8
  ,UJ,CH/XAP. CHAN
  :W1,VTM,1
  ,UJ,DENSITY
  :W1,VTM,
  ,UJ,DENSITY
 :C,XTA,NUMBUS.EDIT
  ,UJ,TO EDIT
 :W2,VTM,1
 ,UJ,ПPOTOKOЛ
 :W2,VTM,0
 ,UJ,ПPOTOKOЛ
C------------------
C
C-----   ПPИKAЗ : Д E C
C
 DECЧИC:,BSS,
 ,XTA,=:4
 ,AEX,
 W2,*53,R/R
 ,UJ,OCTWORD
C
C-----   П/П ПPИKAЗOB OTЛAДЧИKA
C
  OTЛAДKA1:,UTC,7-2
  OTЛAДKA:R,VTM,2
  ,ITA,R
  ,ATX,WS
 T,VJM,NJ C ИПЗ
  T,VJM,IFDEBUG
  C,XTA,ASTR
  ,AAX,=77777
  ,*50,12
  T,VTM,8
  R,VTM,BADR
  ,XTA,=600000
  ,*50,12
  14,UTM,-4
  14,VIM,OPERANDS
  ,ATX,IDENTI
  ,YTA,
  ,ATX,IDENTI+1
  ,XTA,
  ,ATX,O/A
  ,*50,70100B+136B
  ,ATI,14
  14,UTM,-54B
   14,VIM,FINISH1
  ,XTA,WS
  ,ASN,64-15
  ,*50,12
  ,ATX,ISUB
  ,YTA,
  14,UTM,-4
  14,VZM,FINISH2
  14,UTM,4-1
  14,VZM,OCTAL
  14,UTM,1-2
  14,VIM,OШHAБOP
  OCTAL:,XTA,ISUB
  ,ATX,O/A
  FINISH1:,XTA,
  ,ATX,ISUB
  FINISH2:,ATX,ISUB+1
  R,VTM,-4
  FIN:R,XTA,ISUB+1
  W2,*52,O/A/
  W2,UTM,1
  R,VLM,FIN
  W2,UTM,-5
  ,XTA,FULWOR
  BADR:,ATX,WS
  W,UJ,
 NJ C ИПЗ:W1,VTM,1-NSHI
C ПOИCK  HAШ ШИФP-KAHAЛ
 ,ITA,T
 ,ATX,WS2
 T,VTM,THETЗ
  LOOP:W1,XTA,INFEX+NJ
  C,AEX,NUMBUS
 ,AAX,=1777
   ,UZA,HAШKAH
  W1,VLM,LOOP
 ,UJ,RO NEW
   HAШKAH:,BSS,
 W1,UTM,NLMAT
 W1,*65,BITS
 ,ATX,BIT
 T,VJM,ДAЙ ИПЗ
  W2,VZM,DIAGN.HET ЗAДAЧИ
 ,*65,FLERBUZ
 ,AAX,BIT
  ,U1A,SECOND
  W2,*65,SCJOTЛ
  ,U1A,SECOND
 ,WTC,WS2
 ,UJ,
C.....   ПEPEПИCЬ ИПЗ HA ЛИCT MT
C
C     ПOTPEБИTEЛИ ЧYЖИX ИПЗ !
C   ПPOBEPЯЙTE PEГИCTP  W2  ПOCЛE
C        ЗAПPOCA ИПЗ !
C  -------------------------------
C
 ДAЙ ИПЗ:R,VTM,B48
 ,UJ,ДAЙ/HA
 ДAЙИПЗ B:R,VTM,=:6
 ,UJ,ДAЙ/HA
  TO DEB:,AEX,
  ,*53,SCDEBUG
  GO:,XTA,BIT
  ,*76,OTKP
 HA ИПЗ:R,VTM,
 T,VTM,ЖДY
 ДAЙ/HA:,BSS,
 ,ITA,W1
 ,ASN,64-9
 ,AOX,=50
 R,AOX,
 ,AOX,NЛИПЗ/
 ,FUN,212B
 ,ATI,W2
  T,UTC,
  W2,VZM,.HET ЗAДAЧИ
 R,XTA,
 ,AAX,=:2
 T,UZA,
 W2,VTM,A ИПЗ
 T,UJ,
C
C-----   ПPИKAЗ : O C A
C
   OCTПOAДP:,BSS,
  ,XTA,WS
  W2,*52,PEГ34
  ,XTA,B48
  ,UJ,ПPИOT
C
C-----   ПPИKAЗ : O З A
C
   OCTЗAП:,BSS,
  ,XTA,WS
  W2,*52,ИP/35
  ,XTA,=:1
  ,UJ,ПPИOT
C
C-----   ПPИKAЗ : O Ч T
C
   OCTЧTEH:,BSS,
  ,XTA,WS
  W2,*52,ИP/35
  ,XTA,=:2
  ,UJ,ПPИOT
C
C-----   ПPИKAЗ : И Д И
C
   OPENJOB:,BSS,
  ,UZA,MAT
 W2,*65,S27
  ,AAX,=14
  ,U1A,ПЛOX
  MAT:,BSS,
 ,XTA,BIT
   ,AAX,SCSTOP
  ,UZA,ПЛOX
 ,AEX,SCSTOP
   ,ATX,SCSTOP
 ,XTA,WS
 ,UZA,TOЛKHEM
  ,AEX,FULWOR
  ,UZA,ИДИД
   ,XTA,WS
 W2,*52,S33
 ,XTA,
 W2,*52,S27
 ,UJ,OTKPOEM
 TOЛKHEM:,BSS,
  W2,*65,REGSCAL
 ,AAX,=10 00000
 ,UZA,CHЯTЬK
 W2,*65,S35
 ,ASN,64-15
 W2,*52,S35
 CHЯTЬK:W2,*65,S34
 ,AAX,=77777
 ,UZA,YCTФЛ
 W2,*65,S34
 ,ASN,64-15
 W2,*52,S34
 YCTФЛ:,XTA,BIT
 ,AOX,SCAL67
 ,ATX,SCAL67
   OTKPOEM:,BSS,
 ,XTA,BIT
  ,AAX,SCШAГ
  ,UZA,GO
  ,AAX,SCSTOP
 ,UZA,HA ИПЗ
  ,AEX,SCSTOP
  ,ATX,SCSTOP
  ,UJ,GO
  ИДИД:,BSS,
 ,XTA,=:01
 ,AEX,
 W2,*53,R/R
  ,XTA,WS
    W2,*52,READ
    ,XTA,=:002
  ,AEX,
  W2,*53,SCJOTЛ
  ,XTA,BIT
  ,UJ,TO DEB
C
C-----   ПPИKAЗ : P E T
C
   PEГИCTPЫ:,BSS,
   C,WTC,ASTR
   AS,VTM,
   AS,XTA,
   ,AAX,=0000 0000 0017 7777
  ,UZA,SUMIR
  ,XTA,=:004
  ,UJ,ПPИOT
  SUMIR:,BSS,
  ,XTA,=:01
  ПPИOT:,BSS,
  ,AEX,
  W2,*53,SCJOTЛ
  ,XTA,BIT
  ,AEX,
  ,*53,SCDEBUG
 ,XTA,SCSTOP
 ,AAX,BIT
  ,UZA,HA ИПЗ
  ,UJ,GO
C
C-----   ПPИKAЗ : M Я K
C
  KOCBЧT:,BSS,
  ,XTA,=0000 0000 0400 0000
 ,AEX,
 W2,*53,R/R
C
C-----   ПPИKAЗ : M Я Ч
C
   OCT WORD:,BSS,
  ,XTA,WS
  ,AEX,FULWOR
  ,UZA,NO AD
 R,VJM,ПPOB ЧЛ
  NO AD:,BSS,
    ,XTA,WS
  W2,*52,READ
  ,XTA,=:002
  ,UJ,ПPИOT
 ПPOB ЧЛ:,XTA,WS
 ,ASN,64+10
 ,ATI,T
 T,UTC,
 W2,*65,TMATH
 ,ASN,64+30
  R,U1A,
  ПЛOX:R,VTM,.OCBOБ-E
  T,VJM,ДAЙ/HA.ИПЗ
  OШHAБOP:T,VTM,TOШHAБ
  ,UJ,RONE
C
C-----   ПPИKAЗ : Ш A Г
C
  ШAГИ :,BSS,
  T,VJM,IFDEBUG
 ,XTA,BIT
  ,AOX,SCШAГ
  ,ATX,SCШAГ
 ,XTA,=4 00000
 ,AEX,
 W2,*53,REGSCAL
  ,UJ,TOЛKHEM
C
C-----   ПPИKAЗ : Ф Я Ч
C
  ФИЗЧT:,BSS,
  ,XTA,WS
  W2,*52,ФREAD
  ,XTA,=:001
  ,UJ,ПPИOT
C
C-----   ПPИKAЗ : Ч И З
C
  ЗAПЧИC:,BSS,
  ,XTA,=20
 ,AEX,
 W2,*53,R/R
 ,XTA,WS
 ,ATI,T
  ,UZA,ПЛOX
 ,AEX,FULWOR
 ,UZA,ЗAПЧA1
  ,XTA,=100
 ,AEX,
 W2,*53,R/R
 ,UJ,ЗAПЧA
C
C-----   ПPИKAЗ : З A П
C
 ЗACЛ:,BSS,
  R,VZM,ЗAПЧAA
 W2,*52,W/W
 ЗAПЧA:,ITA,T
  ,ATX,WS
  R,VTM,ЗAПЧA1
  ,UJ,ПPOB ЧЛ
  ЗAПЧAA:,XTA,ISUB
  ,U1A,*+2
  ,XTA,O/A
  :W2,*52,W/W
  ,XTA,FULWOR
  ,ATX,WS
  ЗAПЧA1:,BSS,
  ,XTA,WS
  W2,*52,WRIT
  ,XTA,=:0004
  ,UJ,ПPИOT
 NOTEP:,BSS,
  ,XTA,SCTER
 ,AAX,ZBCH
  ,ATX,SCTER
  ,XTA,SCЖДY
 ,AAX,ZBCH
  ,ATX,SCЖДY
 NOOTЛ:,BSS,
 ,XTA,
 ,AEX,=4 00000
  W2,*53,REGSCAL
  ,UJ,HA ИПЗ
 OUT KOД:R,VTM,ПPOB KOД
 ,UJ,OUT/IN Q.
 ПPOB KOД:,BSS,.
 C,WTC,A STR.
 ,XTA,1.
 ,UZA,ПOД KOД.ПYCT БYФEP
 13,VJM,CHE PASS
 ,ATI,14.N PASS=1-1776
 14,V1M,US IS
 US ABS:,BSS,.
 T,VTM,TUSABS.
 R,VJM,RED OUT.
 CEKOH:,BSS,.
  R,VJM,OTЛYП1
  NOREFBUF:T,VTM,KOHCEAHC
 W,VTM,SCJOB-TAKESC.
 CK1:W,XTA,TAKESC.
 ,AAX,ZBCH
 W,ATX,TAKESC.
 W,VLM,CK1.
 ,XTA,.
 C,ATX,NUMB US.
  C,ATX,MБИHФ
 ,XTA,BCH
 ,AOX,SC LOC.
 ,ATX,SC LOC.
  ,XTA,ZBCH
  ,AAX,BEGZ
  ,ATX,BEGZ
 R,VTM,ANAL
 ,UJ,REDOUT
C
C...   ЗAПYCK  LINE-EDITOR
C
 TO EDIT:,BSS,
  ,AAX,=1777
  ,ATX,WS
 C,WTC,ASTR
  ,XTA,XNT
  ,AAX,=77
  ,ASN,64-15
  ,AOX,WS
  ,ATX,WS
 ,XTA,EDITOR
 ,ASN,64+42
  ,ATI,W1
  W1,VIM,PUTINF
   ,XTA,EDIT/INF
  ,*72,3.ИЗ  Б C З
  14,VZM,ЖДИTE
  14,MTJ,W1
  ,ITA,W1
 ,ASN,64+6.-> B PMP
 ,XTA,=:77
 ,*53,EDITOR
 W1,*65,BITS
 ,AEX,
 ,*53,ПAPTИЗAH
C
C...   BПИCЫBAEM B ИПЗ EDITOR-A
C      ИHФOPMAЦИЮ O ЮЗEPE :
C      25:34 - HOMEP PASS'A
C      40:43 - HOMEP KAHAЛA (ФИЗ.)
C       48   - ФЛAГ ПPИBЯЗKИ
C
  PUTINF:T,VJM,ДAЙ ИПЗ
  W2,VZM,ЖДИTE
  W2,*63, A U S
 ,ARX,
 ,UZA,SECOND.HE ГOTOB
  R,VTM,
  ,XTA,WS
 ,ASN,64-24
 ,AOX,B48
 ,AEX,
 ,XTA,=:7777 7777
 W2,*53,A U S
  T,VTM,CEKOH
  ,UJ,ДAЙ/HA.ПHEM
 USIS:,BSS,.
 T,VTM,-NCM1.=-9
  14,MTJ,W1
    OДИHKЛЮЧ:,BSS,
    ,ITA,14
 T,AEX,NUMBUS+NCM1
 ,AAX,=1777
   ,UZA,YЖE
    T,VLM,OДИHKЛЮЧ
  ,ITA,14
  ,AOX,=1140 0000
  ,FUN,16.A Y COCEДA
  ,U1A,YЖE. - ЗAHЯT !
 C,ATX,RET ADR.
 C,ATX,MБ ИHФ.
 C,ATX,BЫ/BB.
 C,ATX,LPAG
 ,ATX,WS
 C,ATX,*1TYPE.ЧИCTKA ФOPMATA
 C,MTJ,T
 C,J+M,T
 T,J+M,T.=4*C
 T,ATX,OLDBUF.ИMЯ MЛ/ДП
 T,ATX,OLDBUF+1.MACTEP ФAЙЛA
 ,ITA,W1.
 C,AOX,NUMBUS
 C,ATX,NUMBUS.HOMEP B APXИBE
 ,ITA,W1
 C,WTC,ASTR
 W1,VTM,XNT+1
 W1,AEX,
 ,AAX,=1777
 W1,AEX,
 W1,ATX,
 ,XTA,БЫЛ KOД.
 ,AOX,B CH.
 ,ATX,БЫЛ KOД.
 W1,VTM,-NCM3
 ST CH:,BSS,
 W1,XTA,CHAN/J+NCM3
 ,AOX,WS
 ,ATX,WS
 ,XTA,
 W1,ATX,CHAN/J+NCM3
 W1,VLM,ST CH
 ,XTA,WS
 ,AOX,SC/CLJ
 ,*76,OTKP
 ,XTA,
 ,ATX,SC/CLJ
C
C...   ЗAПИCЬ B DAYFILE COOБЩEHИЯ
C      O HAЧAЛE CEAHCA :
C      >MT <Ф-KAHAЛ> <NPASS>
C
  T,VTM,NAMTIM
C
C...   METKA B TEPMИHAЛЬHYЮ CTATИCTИKY
  ,*52,531B
 C,WTC,ASTR
 ,XTA,XNT
 ,ASN,64-42
 ,AUX,=6H'''''''7''7'''
 ,AOX,=6H>MT00
  T,ATX,
  C,XTA,NUMBUS
 ,ASN,64-38
 ,AUX,=6H'1''7''7''7'''''
 ,AOX,=6H0000''''
 T,ATX,1
  ,ITA,T
  ,AOX,=7770 0000 7760 0000
  ,*72,4
  ,UJ,OUTБYФ
C  -------  ЗAKAЗ БYФEPA:
 БYФEP:,BSS,.ГAШ.ПPИЗHAKA
  C,XTA,BЫ/BB
  T,VJM,ГAШ BB
 ,XTA,BCH
  ,AAX,RONLY
  ,AEX,RONLY
  ,ATX,RONLY
 ,WTC,ASTERR.ПPOЧИCTKA
 ,XTA,.ПPИЗHAKA
 ,AAX,ZBCH
 ,WTC,ASTERR.ABAPИИ HA
 ,ATX,.HA OБMEHE
 C,XTA,NUMBUS
 ,AAX,=1777
 ,*50,72217B
 C,WTC,A STR.
 ,XTA,1.
  C,MTJ,14
  C,J+M,14
  14,J+M,14
 ,ATX,WS
 ,ASN,64-8.ГДE БYФEP
 ,UZA,MT BUF
 ,XTA,WS
 ,AEX,=6H: ''
 ,ASN,64+24
 ,U1A,MAKE MT.HOBЫЙ БYФEP
 14,XTA,OLDBUF
 ,U1A,OLD MT.B MAKE MT
 ,UJ,OUT БYФ.HET БYФEPA
 MT BUF:,BSS,
  14,ATX,OLDBUF
 ,XTA,B 48.БAPAБAH
 C,ATX,MБ ИHФ.
 ,UJ,NEW TASK.
  ДEЛЬTA:,AAX,=:777
 ,UZA,OUT БYФ.HET БYФEPA
  ,ARX,
 T,VTM,TOШHAБ
  ,UZA,RONE
  ,ASN,64-3
  ,ASN,64+30
  ,ATX,WS
  ,FUN,113B.ЗAПPOC ДEЛЬTЫ
  ,ARX,
  ,U1A,RO NE.HET ЛEHTЫ
 T,VTM,10.4 ЦИФPЫ
  R,VJM,OPERANDS.ЗA ДEЛЬTOЙ
  ,AOX,WS.+MAT.HOMEP
  ,FUN,112B.YCTAHOBKA
  ,UZA,OUTБYФ.HE ПPOШЛA
  ,UJ,NEXT.O'KEY
 ГAШ BB:,AAX,CL IN.ГAШEHИE
 C,ATX,BЫ/BB.ПPИЗHAKA BBOДA
 ,XTA,ZBCH.ГAШEHИE
 ,AAX,LI SC.ПPИЗHAKA
 ,ATX,LI SC.PACПEЧATKИ
 T,UJ,.
C--------
 REF SEND:,BSS,.OTKAЗ OT PEЖИMOB SEND И ЖДY
 ,XTA,ZBCH
 ,AAX,SC SEND
 ,ATX, SC SEND
 ,XTA, SC ЖДY
 ,AAX,ZBCH
 ,ATX, SC ЖДY
 T,VTM,NEW TASK
 ,UJ,CHA END
C
C ======= ПPИKAЗЫ BBOДA
C   BBOД, SEND, B80
 B80:,BSS,.BBOД БEЗ HOMEPOB
 ,XTA,BCH
 ,AOX,BEGZ
 ,ATX,BEGZ
 ,XTA,
C---------------------
 SEND:,BSS,
C----------------------
 BBOД:,ATX,SAVW1.ДЛЯ ШKAЛ
  T,VTM,NO/WRIT
 ,XTA,B CH
  ,AAX,RONLY
  ,U1A,RO NE
 T,VJM,CHA END.HA ДOCБPOC
 T,VTM,6.2 OПEPAHДA
 R,VJM,OPERANDS.
 ,UZA,B CTAP.ПPEЖHИЙ БYФEP
 ,AOX,B48.
 ,ASN,64+10.
 ,ATX,WS
 T,MTJ,R
 T,VJM,CCLE.ГAШ BBOДA
 R,MTJ,T
 ,XTA,WS
 C,AOX,BЫ/BB.
 C,ATX,BЫ/BB.
 B CTAP:,BSS,
 ,XTA,=:0001
 C,ATX,NU STR.
 ,XTA,.
 C,ATX,LASTORD
 C,ATX,TEK AДP.
 C,XTA,MБ ИHФ.
   ,ATX,WS1
 ,AAX,=:777.
 ,ATX,WS.
 ,UZA,OUT БYФ.
 C,XTA,BЫ/BB.
 ,ASN,64-10.ЗAДAHЫ ЗOHЫ
 ,ARX,
 ,U1A,OШHAБOP.-HET
 ,ASN,64-1
 ,AUX,=000777 00000 00777.
 ,AOX,WS.
 C,ATX,MБ ИHФ.
 ,ATX,WS2
C         PПPEДEЛEHИE MECTA БYФEPE.
C         ПPИ OШИБKE ПPИKAЗ ИГHOPИPYETCЯ.
 15,VJM,FORM INF
C         ПOCTAHOBKA ФЛAГA 'SEND'-A B ШKAЛЫ.
 ,XTA,WS1
 C,ATX,MБ ИHФ
 ,XTA,B24
 C,AOX,NUMBUS.PAЗPEШИM
 C,ATX,NUMBUS.BBOД
 ,XTA,SAVW1.1 ПPИ SEND
 ,AOX,SCSEND
 ,ATX,SCSEND
 ,XTA,BCH.0-BBOД,1-BBOД БEЗ NNNN
 ,AOX,SCЖДY
 ,ATX,SCЖДY
 ,XTA,BEGZ
 ,AAX,BCH
 ,AOX,SAVW1
 ,U1A,SEND0
 ,XTA,ZBCH.OTKAЗ OT
 ,AAX,SCЖДY.PEЖИMA ЖДY
 ,ATX,SCЖДY
 SEND0:,BSS,
 T,VZM,NEXT.ПPOCTOЙ BBOД
 ,XTA,WS2
 C,ATX,MБ ИHФ
 R,VTM,BB1.
 ,ITA,R.
 C,ATX,RET SCAN.CKAHИPOBAHИE
 BB1:,XTA,=6H*READ .ПPИ ДOBBOДE
 T,VJM,SCAN.
 ,XTA,=:0001
 C,ARX,NU STR.
 C,ATX,NU STR.
 T,VTM,BB1.ПOCЛE SCAN'A
 M,VIM,NEXT S.CKAHИPOBAHИE
 ,UJ,NEXT.
C  =======================
 ПOДCKAЗ:,BSS,
 C,XTA,MБИHФ.ЗAДAH БYФEP
 ,AAX,=:777
 ,UZA,OUT БYФ.-HET
 T,VTM,TBLOWR
 R,VTM,ANAL
 ,UJ,REDOUT
C  ========= ЗAПИCЬ KAPTЫ HA БYФEP
 TAKECARD:,BSS,
C  HAЧAЛO KAPTЫ HAXOДИTCЯ B WS
C  П/П ПOИCKA ЭTAЛOHA ДЛЯ BЫДAЧИ
C  ПOДCKAЗKИ BBOДA
 T,VTM,TEXTS-2
 TC:T,UTM,2
 T,XTA,.ЭTAЛOH
 ,UZA,T/CARD
 ,AEX,WS
 ,ASN,64+8.5 CTAPШ.БAЙT
 ,U1A,TC
 T,XTA,1
 ,AAX,=377
 ,UZA,T/CARD
 ,ATI,T.CЛEДYЮЩAЯ
 T,UTM,TEXTS.ПOДCKAЗKA
 R,VTM,REDOUTN
 T/CARD:,BSS,
 ,XTA,BCH
 ,AAX,TAKESC
 ,U1A,TCARD
 ,XTA,BCH
 ,AOX,TAKESC
 ,ATX,TAKESC
 C,XTA,BЫ/BB
 ,ASN,64-11
 ,AUX,=77700 0000 0777
 ,ATX,WS
 C,XTA,MБИHФ
 ,AAX,=:777
 ,AOX,WS
 C,ATX,MБИHФ
 TCARD:,BSS,.ПPOДOЛЖEHИE
 T,MTJ,PP
 T,VJM,WRITE
 PP,MTJ,T
 ,XTA,=:0001
 C,ARX,NUSTR.+1
 C,ATX,NUSTR
 R,UJ,
C .....
C  ПPИKAЗ 'BЫBOДИTЬ ПO L CTPOK':
 BЫBOД:T,VTM,1.1 OПEPAHД
 R,VJM,OPERANDS.
 ,ASN,64-1
 C,ATX,LPAG
 ,UJ,NEXT.
C--------
C------TEЛEГPAMMA OПEPATOPY:TEЛ---
 TEL OP:,BSS,
 C,XTA,A STR
 ,FUN,76B
 ,UJ,NEXT
C=====   'ПYCTOЙ' ПPИKAЗ
 DUMMY:,BSS,
 C,XTA,NUMBUS.PEЖИM BBOДA
 ,AAX,B24
 ,UZA,IF LIST.-HET
 ,XTA,SC SEND
 ,AAX,B CH
 ,U1A,NEXT.EMPTY CARD
 ,XTA,BEGZ.BBOД БEЗ NNNN
 ,AAX,BCH
 ,UZA,IF TELE.-HET
 ,AEX,BEGZ
 ,ATX,BEGZ
 ,XTA,ZBCH
 ,AAX,SCЖДY
 ,ATX,SCЖДY
 IF TELE:,BSS,
 ,XTA,SCTER.TEЛE-ЗAДAЧA
 ,AAX,BCH
 ,UZA,TER UP.-HET
 ,AOX,SCЖДY.-BOCCTAHOBИM
 ,ATX,SCЖДY
 TER UP:,BSS,
 T,VTM,NEW TASK
C ДOCБPOC И BOЗBPAT B KOM.PEЖИM
 ,UJ,CHAEND
 IF LIST:,BSS,
 ,XTA,LISC.BHYTPИ ЛИCTA
 ,AAX,BCH
 ,UZA,IF LAST.-HET
 C,XTA,LPAG
 ,AAX,=:777.ПOBTOPHAЯ
 C,ATX,LPAG.YCTAHOBKA L
 T,VTM,-22
 ,UJ,NNS
 IF LAST:,BSS,
 C,XTA,LASTORD
 ,UZA,DUM1
 ,ATX,WS
 ,UJ,AN0
 DUM1:,BSS,
 C,XTA,MБИHФ
 ,AAX,=:777.БYФEP ЗAДAH
 ,UZA,OUT БYФ. = HET
 ,UJ,NEXT
C=====   ПPИKAЗ : ЛИCT NЗOHЫ
 LIST:,BSS,.
C
C......   PACПE4ATKA BBEДEHHOГO ПAKETA
C......   OБPATHAЯ BЫДAЧA
C
C......   CMЫCЛ ШKAЛ, CBЯЗAHHЫX C ПPИKAЗOM - 'ЛИCT'
C
C         LISC  - HAXOДИMCЯ BHYTPИ ПPИKAЗA - 'ЛИCT'
C         LISC1 - ИЩEM ЗAДAHHЫЙ OБPAЗ
C         LISC2 - 'ЛИCT' C HOMEPAЦИEЙ/БEЗ
C
 T,VTM,6.C PEAKЦИEЙ HA +
 R,VJM,OPERANDS.
 ,UZA,LIS 0
  ,ASN,64+38
  ,ASN,64-38
  ,ATX,WS
 ,XTA,LISC2. - ПPИЗHAK
 ,AOX,BCH. 'ПEЧATЬ
 T,V1M,LIS N
 ,AEX,BCH
 LIS N:,ATX,LISC2
 C,XTA,BЫ/BB.
 ,AAX,CL OUT.
 ,AOX,WS.
 ,AOX,B48
 C,ATX,BЫ/BB.
 LIS 0:,UIA,FI LIST.
 ,XTA,LI SC.
 ,AAX,B CH.ПPИKAЗ - 'ЛИCT'
 ,UIA,LIS1.CAM B CEБE
 FI LIST:,XTA,LI SC.
 ,AOX,B CH.
 ,ATX,LI SC.
 T,VJM,CHA END.HA ДOCБPOC
 C,XTA,MБ ИHФ.
 ,AAX,=:777.
 ,ATX,WS.
 T,VTM,OUT БYФ.ПOДCKAЗKA
 ,UZA,LIS1 0. 'БYФEP'
 C,XTA,BЫ/BB.
 ,ASN,64-1.
 ,AAX,=:777
 ,ASN,64+9.
 ,AOX,WS.
 C,ATX,MБ ИHФ.
 ,XTA,.
 LIST B:C,ATX,NUSTR
 C,ATX,TEK AДP.
 LIS1:,BSS,.
 T,VTM,1-23
 C,XTA,LPAG
 ,AAX,=:777
 ,UZA,NNS
 ,ASN,64+9
 C,AEX,LPAG
 ,AAX,=:000 777
 ,UZA,NEXT
 NNS:C,XTA,NU STR.HOMEP CTPOKИ
 ,ARX,=:0001.+1
 C,ATX,NU STR.
 ,XTA,
 CL STR:C,WTC,ASTR
 T,ATX,22
 T,VLM,CL STR
 T,VJM,GIVECARD.ЗA OЧEP. CTPOKOЙ
 ,UIA,LIS2.HE KOHEЦ
  C,XTA,TEKAДP
  ,UZA,NON TEXT
 ,XTA,BCH
 ,AAX,LISC1.ИCKAЛИ ЛИ
 ,UZA,LIST E.OБPAЗ - HET
 T,VTM,T HETOБP.ДИAГHOCTИKA
 R,VJM,RED OUT.'HET OБPAЗA'
  ,UJ,LIST E
 NON TEXT:T,VTM,T NONTX.HETEKCTOBAЯ
  R,VJM,RED OUT. ИHФOPMAЦИЯ
 LIST E:,BSS,.KOHEЦ ЛИCTИHГA
 T,VTM,NEW TASK.
 LIS1 0:,BSS,
 C,XTA,MБ ИHФ.BOCCT OT
 ,AAX,=:777.ПOPЧИ PEЗ-OM
 C,ATX,MБ ИHФ
 W,VTM,1-3.
 LIS1 1:W,XTA,LI SC2.
 ,AAX,ZBCH
 W,ATX,LI SC2.
 W,VLM,LIS1 1
 ,XTA,SC BLNL.
 ,AAX,ZBCH
 ,ATX,SC BLNL.
 T,UJ,.
 LIS2:,BSS,
 ,XTA,BCH.ПPOBEPKA:
 ,AAX,LISC1.ИЩEM OБPAЗ
 ,UZA,OUT LIS.  HET
 C,WTC,ASTR.
 AS,VTM,-1.
 AS,XTA,.
 ,AEX,B48.
 ,UIA,LIS3.
 AS,ATX,.
 C,XTA,NU STR.
 ,ARX,=7776 7777 7777 7777
 C,ATX,NU STR.
 LIS 3:C,XTA,MACKA OБ
 ,U1A,LIS3/1
 C,XTA,NUSTR
 C,AEX,ЭTOБPAЗ
 ,AAX,=:7777 7777.4 ЦИФPЫ B 48-37
 ,UJ,LIS3/2
 LIS3/1:T,VTM,11
 R,VJM,OPERANDS.ЗA TEK. OБPAЗOM
 C,AEX,ЭT OБPAЗ.
 C,AAX,MACKA OБ.
 LIS3/2:T,VTM,LIS1.ПOCЛE SCAN'A
 ,UIA,NEXT S.OБPAЗ HE COBПAЛ
 ,XTA,BCH.
 ,AEX,LISC1. - ПPИЗHAK
 ,ATX,LISC1.'ПOИCK OБPAЗA'
 R,VJM,KIL BL
 OUT LIS:R,VTM,LIS1.
 T,VTM,23
C=====   OTБPACЫBAHИE XBOCT.ПPOБEЛOB И HYЛEЙ
 LIS4:C,WTC,ASTR
 T,XTA,-1
 ,ATX,WS
 N,VTM,0
 LIS5:,ASN,64+8
 ,ATX,WS1
 ,YTA,
 ,UZA,LIS6
 ,AEX,=:1
 ,U1A,LIS7
 LIS6:N,UTM,-8
 ,XTA,WS1
 ,U1A,LIS5
C.....   BCE CЛOBO = HYЛИ + ПPOБEЛЫ
 ,UJ,LIS8
 LIS7:,XTA,FULWOR
 N,ASN,64
 ,AAX,WS
 LIS8:C,WTC,ASTR
 T,ATX,-1
 ,U1A,OUTL
 T,UTM,-1
 T,V1M,LIS4
 ,UJ,OUTL.
 NEXT S:,BSS,.
C......   OPГAHИЗAЦИЯ CKAHИPOBAHИЯ
 ,ITA,T.AДPEC BOЗBPATA
 C,AEX,RETSCAN
 ,AAX,=77777
 C,AEX,RETSCAN
 C,ATX,RET SCAN.
 ,XTA,BCH.ECTЬ ЛИ OБMEH
 ,AAX,SC WAIT.
 ,UZA,NEXT S1.
 C,XTA,RET ADR.
 ,ASN,64+15.
 ,AAX,=77777.
 ,UZA,NEXT S1.
 ,AEX,=77777.
 ,UIA,HAЧAЛO.
 NEXT S1:,XTA,B CH.
 ,AOX,RE MT.
 ,ATX,RE MT.
 ,UJ,HAЧAЛO.
C=====   ПPИKAЗ : ДOH NCTPOKИ
 ДOH:T,VTM,3
 R,VJM,OPERANDS
 ,UZA,OШHAБOP
 ,ASN,64-1
 T,VZM,ДOH 1.= БEЗ'+'
 C,ARX,NU STR
 ДOH1:,BSS,.48-37PP
 C,ATX,ЭT OБPAЗ
 ,XTA,
 C,ATX,MACKA OБ
 ,UJ,CTA ЭT
C=====   ПPИKAЗ : ДO OБPAЗ
 SCAN LIS:,BSS,.
C......   ЗAДAHИE ЭTAЛOHHOГO OБPAЗA
 T,VTM,4.
 R,VJM,OPERANDS.ЗA ЭTAЛOHOM
 ,UZA,CTA ЭT.CTAPЫЙ ЭTAЛOH
 C,ATX,ЭT OБPAЗ.
 CTA ЭT:,XTA,BCH.= ПPИЗHAK
 ,AOX,LISC 1.  ПOИCKA
 ,ATX,LISC 1
 ,XTA,LISC.ПPOBEPKA
 ,AAX,BCH.BHYTPИ ЛИCTA
 ,UIA,LIS1.ДA - ПPOДOЛЖEHИE
 ,UJ,NEXT.HET - CЛEД.KAPTA
 ЭK*71:,BSS,.ДЛЯ  T E P
 C,WTC,ASTR
 ,XTA,
 ,AAX,=177777
 ,U1A,CHAEND
 W1,VTM,1-NSHI
 T,VTM,THETЗ
 LOOPJ:W1,XTA,INFEX+NJ
 C,AEX,NUMBUS
 ,AAX,=1777
 ,UZA,HAШJ
 W1,VLM,LOOPJ
 ,UJ,RO NEW
 HAШJ:,XTA,BCH
 ,AOX,SCTER
 ,ATX,SCTER
 ,XTA,BCH
 ,AOX,SCЖДY
 ,ATX,SCЖДY
 R,VTM,ANAL
 ,UJ,ЖДY IN
 CHAEND:,BSS,.
 C,XTA,NUMBUS.БЛOKИPYEM
 ,AOX,B24.BBOД
 ,AEX,B24
 C,ATX,NUMBUS
 ,XTA,BCH
  ,AAX,БЫЛKOД
 ,AAX,TAKESC.
 T,UZA,.БYФEP ПYCT
 ,AEX,TAKESC.
 ,ATX,TAKESC.
 C,XTA,TEKAДP.
 ,AOX,E FIL.
 C,ATX,TEKAДP.
 ,UJ,WRITE.
C
C  ======  ПPИKAЗ  "HOB"
C
  HOB:,XTA,ZBCH
  ,AAX,LISC2
  ,ATX,LISC2
  T,VJM,CHA END
  ,XTA,= 7 7777 7777 7777
  C,AOX,MБ ИHФ
  C,ATX,MБ ИHФ
C  =======  ПPИKAЗ  PEЗ NN - ПPOCMOTP PEЗYЛЬTATOB
  PEЗ1:,XTA,BCH
  ,AOX,LISC
  ,ATX,LISC
  R,VJM,KILBL
  ,XTA,
  ,UJ,LISTB
C=============  ПPИKAЗЫ ПYCKOB ЗAДAЧ
 TPR:,XTA,=200
 ,UJ,T/PR
 TNP:,XTA,=300
 T/PR:PP,VTM,4000B
 ,UJ,JSTART1
 ПYCK:PP,VTM,0
 ,UJ,JSTART
 TEPП:PP,VTM,4000B
 ,UJ,JSTART
  RUNП:PP,VTM,14000B
 ,UJ,JSTART
 CЛYП:PP,VTM,10002B
 ,UJ,JSTART
 CЛAП:PP,VTM,14002B
 ,UJ,JSTART
  CЛOП:,UTC,10002B.CЛA
  OTЛП:PP,VTM,6000B.+OTЛ
  ,UTC,=40 0000
 JSTART:,XTA,
 JSTART1:,ATX,WS2.ПEPEXB.AЦПY
  ,XTA,
  C,ATX,ЭT OБPAЗ
  C,ATX,MACKA OБ
 C,XTA,BЫ/BB
 T,VJM,ГAШBB
  C,XTA,ASTR
  ,ATI,15
  ,AAX,=77777
  ,*50,12
  ,XTA,=600000
  ,*50,12
  14,UTM,-1
  14,VZM,OPERZON
  14,UTM,1-4
  14,VIM,OШHAБOP
  C,ATX,ЭT OБPAЗ.ИMЯ KOЛOДЫ
 ,ITA,PP.OTЛAДKA
 ,AAX,=2000.C MONSYS
 ,U1A,ЗAПP.ЗAПPEЩEHA
  ,ATX,WS
  ,XTA,=400 0000
  C,ATX,MACKA OБ
  PP,UTM,1
  ,UJ,COMCST0
  OPERZON:,ATX,WS.ЗOHA
  ,AAX,=777
  :,U1A,*+1
  PP,VZM,OШHAБOP
  NEXTOPER:,XTA,=600000
  ,*50,12
 14,UTM,-4
  14,VIM,OPERSHIF
  C,ATX,ЭT OБPAЗ
  ,UJ,NEXTOPER
  OPERSHIF:,ASN,64-29
  14,UTM,4-1
  14,VZM,TO SHI
  14,UTM,1-6
  14,V1M,OШHAБOP
  PP,VZM,COMCST0."ПYCK"
C
C   ПPOBEPИM, ДOЛЖHЫ ЛИ MЫ OTДABATЬ TEPMИ-
C   HAЛЬHYЮ ЗAДAЧY B PYKИ ПЛAHИPOBЩИKA.
C   HE БYДEM ЭTOГO ДEЛATЬ, ECЛИ COДEPЖИMOE
C   ЯЧEЙKИ *PL/MT OTЛИЧHO OT HYЛЯ, A TAKЖE
C   ECЛИ ECTЬ HAБOP B 1-24 PP. T.P.-4.
C   HAБPAHHYЮ OПEPATOPOM ШKAЛY TV-KAHAЛOB
C   ДOПOЛHЯEM ШKAЛOЙ, ПOMEЩEHHOЙ (ПPИ ГEHE-
C   PAЦИИ ДИCПETЧEPA) B 48-25 PP. *PL/MT.
C   COДEPЖИMOE 24-1 PP. *PL/MT CЛYЖИT MACKOЙ
C   HAБOPA HA T.P.-4.
C
  T,VTM,*PL/MT.TAM ПPИЗHAK
  ,*65,4.TAM ШKAЛA
  T,AAX,
  ,ASN,64-24
  T,AOX,
  ,UZA,COMCST0.HA AEROPLAN
C   ПPOBEPИM BOЗMOЖHOCTЬ USER'A ЗAПYCTИTЬCЯ
C   ПPЯMO HA CЧET.   TEПEPЬ BCE ЗABИCИT OT
C   ДOБPOTЫ OПEPATOPA И ПOPЯДOЧHOCTИ USER'A.
  C,WTC,ASTR
  ,WTC,XNT
  ,ASN,64-24
  ,AAX,B48
  ,UZA,ЗAПP.OПEPATOPOM
  PP,UTM,1.REAL
  14,VTM,NSHI
  CH TASK:,BSS,.HET ЛИ YЖE ЗAДAЧ
  14,VZM,COMCST1
  14,UTM,-1
  14,XTA,INFBA
  ,AAX,=77 0000 0000
  ,U1A,CH TASK.ИЗ OЧEPEДИ BBOДA
  14,XTA,INFEX
  ,AAX,=14000
  ,UZA,CH TASK."ПYC" - MOЖHO
  ,AEX,=14000
  ,UZA,CH TASK."RUN" - MOЖHO
  14,XTA,INFEX
  C,AEX,NUMBUS
  ,AAX,=1777
  ,U1A,CH TASK
  FULQU:T,VTM,TFULQ.COBECTЬ
  ,UJ,RO NE.  HAДO ИMETЬ!
  CH BUS:,XTA,WNN
  ,AAX,=77
  ,UZA,FULQU
  T,V1M,FULQU
  T,VTM,TSPBU."ЗAHЯT"
  ,UJ,RO NE
  TO SHI:,BSS,
  ,UZA,OШHAБOP
  R,VJM,CHESHI
 C,XTA,NUMBUS
 ,AAX,=1777
 ,ASN,64+4
 ,U1A,OШHAБOP.FOR WHITE ONLY
  T,V1M,RO NE.ПЛOX.ШИФP
  PP,VLM,COMCST2
  COMCST0:,XTA,=:777 00002 777
  ,UJ,COMCST
  COMCST1:,BSS,
  ,*65,Ш/FULL
  ,ATX,WNN
  ,*65,6
  ,ASN,64+23
  ,AAX,WNN
  :,U1A,*+1
  ,XTA,WNN
  :,AAX,=377400.Ш20-Ш10
  ,ATX,WNN
  COM1:,XTA,WNN
  ,UZA,FULQU
  ,ANX,
  ,ATI,W1
  ,YTA,
  W1,ASN,64
  ,ATX,WNN
  W1,*65,*YCЫ
  ,AAX,=77777 00000
  ,U1A,COM1
  COMCST2:,ITA,W1
  ,AOX,=:777 00003 777
  COMCST:,BSS,
  ,ATX,WNN.ИHФ.CЛOBO ПYCKA
  ,XTA,WS
  ,UZA,GET US
 ,ASN,64-30
C   П/П ФOPMИPOBAHИЯ INFEX
C         OБPAЩEHИE ПO PEГИCTPY R.
C         HA CYMMATOPE HOMEP ЗOHЫ ПAKETA
C         B PAЗPЯДAX 39:31
C         B PEГИCTPE PP ЗAДAH TИП ПYCKA
C         БYФEP ЗAДAH B MБИHФ(C)
  ,AAX,=:000777
  ,ATX,WS.
 C,XTA,MБИHФ
 ,AAX,=:777
 ,UZA,OUTБYФ
 ,AOX,WS
 ,ATX,WS
 ,AAX,B48
 ,ASN,64+34
  ,ATX,WS1
 ,XTA,WS
 15,VJM,FORM INF.
 ,APX,=77 0777.
 ,AOX,WS1
 ,ATX,WS.FILE INPUT
  GET US:,BSS,
 C,XTA,NUMBUS.
 ,AAX,=1777
 ,AOX,WS. + NUMBUS
 ,ATX,WS.
  ,XTA,WNN.COБCTBEHHO
  ,*72,3.ПYCK
  ,ATX,WS1.OTBET
  14,MTJ,W1.ДHЗ
  W1,VZM,CH BUS
 C,WTC,ASTR
 ,XTA,XNT
 ,ASN,64-36
 ,AOX,=100 0000
C   OTMEЧAEM TEPMИHAЛ B INFBA
 W1,ATX,INFBA-NFM
  T,VJM,ДAЙ ИПЗ
C
C...  ЗAПИCЬ B NAME ЗAДAЧИ
C
  C,XTA,ЭT OБPAЗ
  W2,*52,NAM/J
  ,AEX,=6H
  ,ARX,=6H'177''177''177''177''177''177'
  ,AAX,=6H'200''200''200''200''200''200'
  ,ACX,.6,5,..,1 HE ПPOБEЛOB
  ,ASN,64-3
  ,ATI,14
  ,XTA,FULWOR
  14,ASN,64
  ,AEX,FULWOR
  W2,*52,NAM/J+2
 ,ITA,PP
 ,AAX,=1
 ,UZA,TO BATCH
  PP,UTM,-1
  ,ITA,PP
  ,AAX,=2
  ,UZA,KAK OTЛ
  PP,UTM,-2.ПO "CЛY"
  C,XTA,NUMBUS.HEKOTOPЫE
  ,AAX,=1777.ПOЛYЧAЮT
  ,ASN,64+4.MAЛEHЬKYЮ
  ,U1A,KAK OTЛ.ПPИBИЛEГИЮ
  ,XTA,B48
  W1,ASN,64-1
  ,AEX,
  ,*53,ПAPTИЗAH
  ,XTA,=200 0000.-"ИHKOГHИTO"
  ,UJ,MOЖ BCE
  KAK OTЛ:,BSS,
  C,XTA,MACKA OБ.9/MONSYS
  ,UZA,MOЖ OTЛ. - HET
  MOЖ BCE:,AOX,WS
  ,ATX,WS
  MOЖ OTЛ:,BSS,
  ,XTA,WS2
  ,AOX,=7300 0000 0000 0010
  W2,*52,REGSCAL
  ,AAX,=40 0000
  ,UZA,HEOTЛПYC
  ,ASN,64+11.OCA 100
  W2,*52,26B
  HEOTЛПYC:,BSS,
  ,ITA,PP.TИП
  ,AOX,WS.ПYCKA
  W1,ATX,INFEX-NFM
  ,AAX,=14000
  ,AEX,=14000
  ,U1A,FLY
 ,XTA,B48
 W1,ASN,64-1
 ,AEX,
 ,*53,БЛOKAЦПY
 FLY:,BSS,
C
C...  BHИMAHИE !  HAXOДЯCЬ B KPИT.ИHTEPBAЛE
C     "ДAЙ ИПЗ", OCTEPEГAЙTECЬ BЫДABATЬ
C     ЗACEMAФOPEHHЫE ЭKCTPAKOДЫ !
C     MOЖHO ПOЛYЧИTЬ KЛИHЧ.
C
  ,XTA,WS1.TOЛKHEM
  ,FUN,212B.ЗAДAЧY
  HECЛ:W1,XTA,INFEX-NFM
  ,AAX,=2 0000
  ,U1A,NO37
  W1,XTA,INFEX-NFM
  ,ASN,64+33
  ,UZA,OTЛYП
  C,MTJ,T
  C,J+M,T
  T,J+M,T
  T,XTA,OLDBUF
  ,ASN,64-36
  ,UZA,TRANSFIL
C...   ПEPEДAЧA БYФEPA (MAT.HOMEP=37)
  ,ITA,W1
  ,ASN,64-18
  ,ATX,WS
  W1,XTA,INFEX-NFM
  ,ASN,64+42
  ,AOX,WS
  ,ATX,WS
  ,*65,ДHЗ
  ,ASN,64-6
  ,AOX,WS
  ,AOX,=37 0000.MAT.HOMEP
  ,*57,2400B.ПEPEДAЧA
  ,UJ,NO 37
C
C...  ПEPEДAЧA ФAЙЛA
  TRANSFIL:,BSS,
  T,XTA,OLDBUF
  W2,*52,NAMBUFER
  T,XTA,OLDBUF+1
  W2,*52,NAMBUFER+1
  T,XTA,OLDBUF+2
  W2,*52,NAMBUFER+2
  T,XTA,OLDBUF+3
  W2,*52,NAMBUFER+3
  OTЛYП:,BSS,
  R,VJM,OTЛYП1
C
 NO37:,BSS,
 W1,XTA,INFEX-NFM
 ,AAX,=14000
 :,U1A,*+1
 ,UTC,TJBATCH-TJSTAR
 :T,VTM,TJSTAR
  ,XTA,BCH
  ,AOX,SCTER
  ,ATX,SCTER
  ,XTA,BCH
  ,AOX,SCЖДY
  ,ATX,SCЖДY
  ,XTA,.OTKAЗ OT
  C,ATX,MБИHФ.БYФEPA
  C,XTA,ЭT OБPAЗ
  ,AEX,=6HKERMIT
  :,U1A,*+1
  ,UTC,END CHAN-NEW TASK
  RO NEW:,BSS,
  ERROR :,BSS,
  R,VTM,NEW TASK
  ,UJ,RED OUT
 TO BATCH:,BSS,
 ,XTA,WS2
  ,AAX,=300
 ,ASN,64-11
 ,ATX,WS2
 ,ITA,PP
  ,ASN,64+2
  ,ASN,64-6
  ,AOX,=400 0000
 ,AOX,WS2
 ,AOX,WS
 W1,ATX,INFEX-NFM
 ,XTA,=7300 0000 0004 0010
 W2,*52,REGSCAL
 ,UJ,FLY
C
C...   ECЛИ ЗAДAЧA ЗAПYЩEHA ПO ИMEHИ
C      HEЛЬЗЯ ПOЛЬЗOBATЬCЯ OTЛAДЧИKOM
C
  IFDEBUG:W1,XTA,INFEX-NFM
  ,AAX,=400 0000
  ,XTA, . A B ДYБHE MOЖHO !
  T,UZA,
  ЗAПP:,BSS,
 T,VTM,TЗAПP
  ,UJ,RO NE
C
C...  OTKAЗ OT БYФEPA
C
  OTЛYП1:C,XTA,MБ ИHФ
  ,ASN,64+39
  ,ATI,14
  R,UZA,
  ,ASN,64+6
  R,U1A,.7/M
  C,ATX,MБ ИHФ
  ,XTA,B48
  14,ASN,64-30B
  ,*57,4000B
  R,UJ,
 CHE SHI:,BSS,
C.....   ПOЛYЧEHИE ИЗ ШИФPA ДHЗ И ПPOBEPKA
 ,ASN,64+29
 ,AAX,=77
 ,ATX,WNN
 ,*65,XNF
 ,ATX,WNF
 ,*65,XNW
 ,ATX,WNW
 ,NTR,3
 ,XTA,WNN
 ,X-A,WNW
 ,ATI,W1.= ДHЗ
 T,VTM,T ERSH
 ,A-X,WNF
  R,U1A,
 W1,*65,BITS
 ,ATX,BIT
 ,*65,Ш/FULL
 ,AAX,BIT
  R,UZA,
  T,VTM,
  W1,*65,*YCЫ
  ,AAX,B21/16
 R,UJ,
 CПPAB:,BSS,.
  W1,VTM,-NJ
C ======  CПPABKИ O CЧETHЫX ЗAДAЧAX
 ,XTA,
 C,ATX,TEKAДP
 CПP1:W1,XTA,INFEX+NJ. ПOИCK
 C,AEX,NUMB US.HA ШИФPE
 ,AAX,=1777
 ,UZA,CПP.HAШA
 PP,VZM,CПP2.ЧYЖAЯ
 W1,XTA,INFEX+NJ
 ,AAX,=200 0000
 ,U1A,CПP2
  C,WTC,ASTR.ЗAПYЩEHA
  ,XTA,XNT.  C HAШEГO
  ,ASN,64-36.  TEPMИHAЛA
  ,AOX,=100 0000.MYЛЬTИTAЙПOM
  W1,AEX,INFBA+NJ.  MИHYЯ
  ,AAX,=:0077 0077 77.ПЛAHИPOBЩИK
  ,UZA,CПP
 ,XTA,=6H*''''''''''
 CПP:,BSS,
 ,ATX,SYM
  W1,UTM,NLMAT
  T,VJM,ДAЙИПЗB
  W1,UTM,-NLMAT
  W1,*65,BITS+NLMAT
  ,ATX,WS
  W2,V1M,ISTSK
  ,*65,SCENDJO
  ,AAX,WS.KOHЧAETCЯ ЛИ
  ,UZA,CПP 2.HET BOOБЩE
  ISTSK:,BSS,
 C,WTC,ASTR
 15,VTM,
 ,ITA,PP
 ,ASN,64-15
 ,ITS,W1
 15,AOX,
 C,ATX,TEKAДP
 W1,*65,*YCЫ+NLMAT
 ,ASN,64-27
 ,AUX,=6H'''''7''7'''''
 ,AOX,=6H Ш00:
 ,AOX,SYM
  W2,V1M,ISTSK1.HOPMA.
  ,XTS,=6HCЧET O
  ,XTS,=6HKOHЧEH
  ,XTS,=6H     :
  PP,VZM,E MT
  ,XTA,=6H     -
  ,UJ,E MT
C
  ISTSK1:,BSS,
 W2,XTS,BISTIME
  R,VJM,T TRAN.ПEPEKOДИPOBKA
 W2,XTS,CPTIME
 R,VJM,T TRAN.
 15,ATX,.CЧET. BPEMЯ
 PP,V1M,LTIM
  W1,*65,BITS+NLMAT
  ,ATX,WS.БИT ЗAДAЧИ
 ,*65,SCALCLTA.
 ,AAX,WS.
 T,VTM,=6H MЛ  :
 ,UIA,E CHET.ЖДET MЛ
  W,VTM,LISTSTRA-1
  T,VTM,=6H     :
  ,XTA,WS
  ,ANX,
  ,ASN,64-42
  ,ATX,WS.ДHЗ
  CHT1:W,UTM,1
  W,*65,
  ,UZA,ECHET
  ,ATX,WS1
  ,AEX,WS
  ,AAX,=:77
  ,U1A,CHT1
  ,XTA,WS1
  ,AAX,=100
  ,UZA,CHT1
  ,XTA,WS1
  ,APX,=0070 0000 0000 1600
  ,ASN,64+42
  ,ATI,R
  R,*65,T1MT-30B
  ,AEX,WS
  ,AAX,=:77
  ,U1A,CHT1
  T,VTM,=6HГT.MФ:
 E CHET:T,XTA,.
 EMT:,BSS,
 ,XTS,=6H BЫ/BB
 W1,XTS,INFBA+NJ
 ,ASN,64-12
 ,AUX,=6H'''7''7''7''7'''
 ,AOX,=6H=0000
  W2,VZM,CПP1/2
 W2,XTS,NAM/J
 W2,XTS,NAM/J+1
 W2,XTS,NAM/J+2
  CПP1/2:,BSS,
 ,XTS,
 ,XTS,LISC2
 ,AAX,ZBCH
 ,ATX,LISC2
 R,VJM,OUTL
 C,XTA,TEKAДP
 ,ATI,W1
 ,ASN,64+15
 ,ATI,PP
 CПP2:W1,VLM,CПP1
 C,XTA,TEKAДP
 ,U1A,NEXT.YДAЧHO
 PP,VZM,KAK/CONT
 ,UJ,DIAGN.HET ЗAДAЧИ
 LTIM:T,VTM,=6H00.00-
 W2,XTA,LIMTIME
 W2,A-X,BISTIME
 ,U1A,E CHET
  R,VTM,EMT
 T TRAN:,BSS ,.
C......   ПOДПP-MA ПEPEBOДA BPEMEHИ B ISO
 ,ATX,TIN
 ,NTR,6
 ,X-A,=R3600.0
 ,U1A,OVTIM
 ,XTA,TIN
 14,VTM,1-4
 TTR1:,BSS,
 ,NTR,0
 14,A/X,NTIM+3
 ,NTR,3.
 ,A+X,=I0.
 ,ATX,DD.
 ,AAX,=17.
 ,ATX,SYM.
 ,XTA,DN.
 ,ASN,64-4.
 ,AOX,SYM.
 ,ATX,DN.
 ,XTA,DD.
 ,NTR,2.
 14,A*X,NTIM+3
 ,X-A,T IN
 ,ATX,TIN
 14,VLM,TTR 1
 ,XTA,DN.
 ,ASN,64-32.
 ,AUX,=6H'17''17''''17''17'''
 ,AOX,=6H00.00-
 R,UJ,
 OVTIM:,XTA,=6H**.**-
 R,UJ,
 ПYЛЬT:,BSS,.
C.........   ПEPEДAЧA COOБЩEHИЯ ЗAДAЧE
 W1,XTA,INFEX+NJ. ПOИCK
 C,AEX,NUMB US.
 ,AAX,=1777
 ,UZA,З ECTЬ.HAШЛИ ЗAДAЧY
 W1,VLM,ПYЛЬT
 ,UJ,DIAGN.HET ЗAДAЧИ
 З ECTЬ:,BSS,
 W1,UTM,NLMAT
 T,VJM,ДAЙ ИПЗ
  W2,VZM,DIAGN
 T,VTM,9.ЗA
 R,VJM,OPERANDS.COOБЩEHИEM
 R,VTM,
 W2,*52,PULT
 T,VTM,NEXT
 ,UJ,ДAЙ/HA
C
C ===== ПPИKAЗ   CHAN XXX
C
  CH/XAP:C,WTC,ASTR
  ,XTA,XNT
  ,ATI,W
  R,VJM,OPERANDS. T=8
  ,UZA,CH/XAP1.TOЛЬKO BЫДAЧA
  ,ASN,64-21
  ,AEX,
  ,XTA,=:0000 0077 7
  W,*53,CIN
  CH/XAP1:W,*65,CIN
  ,ASN,64-18
  ,AUX,=6H'7''7''7'''''''
  ,AOX,=6H000''''''
  ,ATX,WS
  T,VTM,WS
  ,UJ,RO NE
 OTKAЗ:,BSS,.
C   ========  YБИTЬ ЗAДAЧY
 T,VTM,1.1 OПEPAHД
 R,VJM,OPERANDS
 ,UZA,И1
 ,ASN,64+9
 R,VJM,CHE SHI.BEPHET W1=ДHЗ
  T,VIM,RO NE
 ,AAX,B21/16
 ,UZA,DIAGN.HET ЗAДAЧИ
 W1,UTM,-NLMAT
 W1,XTA,INFEX+NJ
 C,AEX,NUMBUS
 ,AAX,=1777
 ,U1A,DIAGN.ЧYЖ. ЗAДAЧA
 ,*76,DEL CNT
 И1:,BSS,
 W1,XTA,INFEX+NJ
 ,UZA,И2.
 C,AEX,NUMB US.
 ,AAX,=1777
 ,U1A,И2
 ,*76,DEL CNT.ИCKЛ. CO CЧETA
 И2:W1,VLM,И1
 ,UJ,DIAGN.HET ЗAДAЧИ
 ПPOTOKOЛ:,BSS,
C   BЫДAЧA HA ЭKPAH TEPMИHAЛA YПPABЛЯЮЩИX
C      KAPT ПO MEPE ИX BЫПOЛHEHИЯ
 W1,VTM,-NJ
 T,VTM,1
 R,VJM,OPERANDS
 ,UZA,SEAR
 ,ASN,64+9
 R,VJM,CHE SHI.W1 - ДHЗ
 ,UZA,DIAGN
 W1,UTM,-NLMAT
 W1,XTA,INFEX+NJ
 C,AEX,NUMBUS
 ,AAX,=1777
 ,U1A,DIAGN
 BIT/PRO:,BSS,
 W2,*65,677B
 ,AEX,
 ,XTA,B48
 W1,*53,INFBA+NJ
 ,UJ,NEXT
 SEAR:,BSS,
 W1,XTA,INFEX+NJ
 ,UZA,S1
 C,AEX,NUMBUS
 ,AAX,=1777
 ,U1A,S1
 ,UJ,BIT/PRO
 S1:W1,VLM,SEAR
 ,UJ,DIAGN
 ЖДYOБMEH:,BSS,.
C.........   ПPOBEPKA KOHЦA OБMEHA
  C,XTA,RETADR
  ,ASN,64+20
  ,AAX,=76000
  ,FUN,200B.OПPOC CTATYCA ЛИCTA
  ,ATI,14
  14,VZM,HEOБM.CBOБOДEH
  14,UTM,-1
  14,VZM,HEKO.ЗAKPЫT
  14,UTM,-1
  14,VIM,HEOБM.B ПOДKAЧKE
 ,XTA,BCH
 ,WTC,ASTERR
  ,AOX,
 ,WTC,ASTERR
 ,ATX,
 HE OБM:,BSS,.
 ,XTA,SCWAIT
 ,AOX,BCH
 ,AEX,BCH
 ,ATX,SCWAIT
 C,XTA,RET ADR.
 ,ASN,64+15.
 ,ATI,W.AДPBOЗBPAT
 W,VZM,HAЧAЛO.=OБMEHA HET
 ,ITA,W.
 ,ASN,64-15
 C,AEX,RETADR.ГAШEHИE
 C,ATX,RETADR.ПPИЗHAKOB
 W,UTM,1.
 W,VZM,HAЧAЛO.
 W,UJ,-1.
 HE KO:,XTA,SC WAIT.
 ,AOX,B CH.
 ,ATX,SC WAIT.
 ,UJ,HAЧAЛO.
C
C  ====== ПPИKAЗ  ИCK NN - ИCKЛЮЧИTЬ
C  ======         ФAЙЛ C БYФEPA BBOДA
C
  ИCK1:12,VZM,DIAGN.HE БЫЛO
  T,VJM,RO NE
  :,ISO,6HГOTOB''
C
C...   OБЩAЯ ЧACTЬ  ПEЧ, PEЗ, ИCK :
C
 ПEЧ:,BSS,
 ,UTC,1
  PEЗ:,UTC,1
  ИCK:W1,VTM,
  R,VJM,KILBL
  T,VTM,6
  R,VJM,OPERANDS
  ,ASN,64+38
  ,UZA,OШHAБOP
  C,ATX,TYP
  ,ASN,64+6
  ,U1A,OШHAБOP
  12,VTM,.ДЛЯ "ИCK"
  ,XTA,LISC2
  ,AOX,BCH
  :T,VIM,*+1."+"
  ,AEX,BCH
  :,ATX,LISC2
  W1,XTA,ИPП
  ,ATI,T
  ,ASN,64+24
  ,ATI,W1
  ,UJ,CAT I/O
  ИPП:,Z00,40001B
  ,Z00,ИCK1
  :,Z00,40000B
  ,Z00,PEЗ1
 :,Z00,20000B
 ,Z00,NEXT
C
C========  ПOИCK CBOИX ЗAДAЧ B KATAЛOГAX "OB"
C                KBB   И   KBЫ
 KAK/CONT:,UTC,1
 OЧEPEДЬ:,UTC,1
 CATINP:,UTC,1
 CATOUT:R,VTM,
 R,XTA,I/O ADR
 ,ATI,W1
  ,XTA,
  C,ATX,TYP
 T,VJM,CAT I/O.BEPHET
C  П/П BEPHET ИP3 = AДPEC KAT.
 R,MTJ,W1
 ,XTA,LISC2
 ,AAX,ZBCH.БEЗ HOMEPOB
 ,ATX,LISC2
 R,VJM,KIL BL
C
C    TEKAДP   XPAHИT  :
C   25-39 : AДPEC ПO KATAЛOГY
C    1-15 : O-BЫBOД, 1-BBOД
C     16  : 1=BCE ГOTOBЫE ЗAДAЧИ
C     17  : 1=ПPOДOЛЖEHИE ПPИKAЗA "KAK"
C     24  : ПPИЗHAK YCПEXA
C   42-47 : CЧETЧИK ПACПOPTOB
C
  :,ITA,PP
  ,ASN,64-24
 W1,ARX,I/O ADR
  LSTR:C,ATX,TEKAДP
 C,XTA,L PAG
 ,AAX,=:777
 ,UZA,CL STR1
 ,ASN,64+9
 C,AEX,L PAG
 ,AAX,=:000777
 ,UZA,NEXT
C  ПOДГOTOBKA CTPOKИ KATAЛOГA BЫBOДA:
C  ИCПOЛЬЗYЮTCЯ B ЭЛ-TE KAT.BЫBOДA:
C 0-E CЛ 48P=1 - ГOTOB K ПEЧATИ
C        47P=1 - CБPOC
C        46P=1 - ЗAHЯT PACПEЧATKOЙ
C        48-46=0 YЖE PACПEЧATAH
C        43P=1 - ECTЬ HEBЫBEДEHHAЯ ГPAФИKA
C        39P=1 - B OЧEPEДИ HA ПEЧATЬ
C       36-31 - N BЫBOДA
C        30-25 - N BBOДA ИЛИ 0
C        24-19 - N ЛAБ(ECЛИ ЗAДAH N BBOДA) ИЛИ 0
C        21P=1 - OT ПB
C        19P=1 - OT MT
C        ИHAЧE - ИЗ CETИ
C 1-E CЛ 10-1P - N PASS
C  2-4 CЛ - NAME (ISO)
C
C
C  ФOPMAT COOБЩEHИЯ:
C       ИCЫЫBB NAME
C   И-ИCTOЧHИK = -ПB
C               C-CETЬ
C               T-TEPMИHAЛ MT
C   C-COCTOЯHИE=+-PACПEЧATЫBAETCЯ
C                -ГOTOB K ПEЧATИ
C               /-CБPOC
C               *-PACПEЧATAH
C               <-B OЧEPEДИ HA ПEЧATЬ
C               G-ECTЬ HEBЫBEДEHHAЯ ГPAФИKA
C   ЫЫ - HOMEP ПO KAT.BЫBOДA
C   BB - HOMEP ПO KAT.BBOДA
C   NAME - ИMЯ ПAKETA
C
C  ПOДГOTOBKA CTPOKИ KATAЛOГA BBOДA:
C  ИCПOЛЬЗYЮTCЯ B ГOЛOBHOM ЭЛ-TE ПACПOPTA:
C 0-E CЛ 48P=1 - BBOД ЗAKOHЧEH,ГOTOB K ПЛAHИPOBKE
C     47P=1 - ПAKET CЧИTAH (INPUTCAL)
C             ЭЛEMEHTЫ KATAЛOГA OCBOБOЖДEHЫ
C        46P=1 - ЗAДAЧA CПЛAHИPOBAHA
C        37P=1 - ПPOДOЛЖEHИE ПACПOPTA
C     30-25 - N BBOДA
C     24-19 - N ЛAБOPATOPИИ:
C     21P=1 - OT ПB
C     19P=1 - OT MT
C        ИHAЧE - ИЗ CETИ
C  1-E CЛ 10-1 - N PASS
C    ( ПOKA TOЛЬKO ДЛЯ ЗAДAЧ TO MT )
C  2-4 CЛ - NAME (ISO)
C
C  ИCПOЛЬЗYETCЯ MACCИB INFBA(NJ)
C     36-31 - N BЫBOДA
C     30-25 - N BBOДA
C     24-19 - N ЛAБOPATOPИИ
C
C
C  ФOPMAT COOБЩEHИЯ:
C                     ИCBB00 NAME
C  И-ИCTOЧHИK (KAK ПO BЫBOДY)
C  C-COCTOЯHИE=+-BBOДИTCЯ B "OB"
C               -ГOTOBA K ПЛAHИPOBKE
C              /-CЧET
C              *-ПOCЧИTAHA
C  BB - HOMEP ПO KAT.BBOДA
C  NAME - ИMЯ ПAKETA
C
  CLSTR1:C,XTA,TEKAДP
  ,ATI,W1
 ,ASN,64+15
 ,AAX,=3
 ,ATI,W2
 C,XTA,TEKAДP
 ,ASN,64+24
  ,ATI,PP
  C,XTA,TEKAДP
  W1,ARX,NEWEL
  ,UZA,ALL
  C,ATX,TEKAДP
  ,ITA,W1
  ,ASN,64-36
  PP,AAX,
  ,U1A,CLSTR1.HE ГOЛOBA
 W2,V1M,ГЗ/
 IFUS:,BSS,
  PP,XTA,1
  C,AEX,NUMBUS
  ,AAX,=1777
 CHN:,BSS,
  ,U1A,CLSTR1.HE HAШ
  PP,XTA,2
  ,UZA,CLSTR1.NAME
  C,WTC,ASTR
  15,VTM,
 PP,XTA,1
 ,ASN,64-19
 ,ASN,64+31
 ,AOX,=I0
 ,NTR,6
 ,E+N,64
 ,A/X,=R60.0
C   ACC =  ACTP. BPEMЯ ФOPMИPOBAHИЯ B MИHYTAX
 R,VJM,TTRAN
C
C...   ФOPMИPOBAHИE  "И" :
C
 ,XTS,=6H'1''1''1'
 PP,XTS,
  ,ASN,64+18
  ,AAX,=77
  ,ATI,R.ЛAБ.
 T,VTM,40B
 R,UTM,-4
 R,VZM,FORMИ.
 T,VTM,103B.C
 R,UTM,4-1
 R,VIM,FORMИ
 T,VTM,124B.T
 W1,VZM,FORMИ
 PP,XTA,4
 ,ASN,64+9
 ,AAX,=3
 ,UZA,FORMИ
 T,VTM,104B.D
  FORMИ:,ITA,T
  ,ASN,64-40
C
C...   ФOPMИPOBAHИE  "ЫЫBB" :
C
  PP,XTS,
  ,ASN,64-12
  :W1,VZM,*+1
  ,AAX,=:0077
  ,AUX,=6H'''''7''7''7''7'
  ,AOX,=6H''''0000
  15,AOX,
  PP,XTS,
C
C....   ФOPMИPOBAHИE  "C" :
  W1,VIM,FCIN
  ,AAX,=:01
  T,VTM,107B.G
  ,U1A,FORMC
  PP,XTA,
 T,VTM,57B./
 ,ASN,64-1
 ,ARX,
 ,UZA,FORMC
 ,ASN,64-1
 T,VTM,53B.+
 ,ARX,
 ,UZA,FORMC
 ,ASN,64-7
 T,VTM,74B.<
 ,ARX,
 ,UZA,FORMC
 PP,XTA,
 T,VTM,40B
 ,ARX,
 ,UZA,FORMC
 T,VTM,52B.*
 ,UJ,FORMC
 FCIN:T,VTM,57B
  ,ARX,
  ,U1A,FORMC
  PP,XTA,
 ,AAX,=:3
  T,VTM,40B
  ,UZA,FORMC
  T,VTM,52B
  FORMC:,ITA,T
  ,ASN,64-32
  FORMNAM:15,AOX,
 ,XTS,=6H  '1''1''1''1'
 W1,VZM,FORMLIM
 PP,XTS,5
 ,ASN,64+36
 ,AOX,=I0
 R,VJM,TTRAN
 FORMNAM*:,XTS,=6H  '1''1''1''1'
  PP,XTS,2
  PP,XTS,3
  PP,XTS,4
    ,XTS,
    ,XTS,
  R,VJM,OUTL.BЫДAЧA
  C,XTA,TEKAДP
  ,AOX,B24.YCПEX
  ,UJ,LSTR
 FORMLIM:PP,XTS,1
 ,ASN,64+30
 ,AOX,=I0
 ,A/X,=R72.0
 ,A+X,=R0.999
 ,NTR,7
 ,A+X,=I0
 ,ATX,WS
 ,XTA,I/ENCOD
 ,*50,15
 ,XTA,SYM
 ,UJ,FORMNAM*
 ГЗ/:PP,XTA,
 W2,UJ,*
 :,AAX,=:3000 0000 04."OЧEPEДЬ"
 ,UJ,CHN
 :,AAX,=:3."KAK"
 ,U1A,CLSTR1.=HE ГЗ
 ,UJ,IFUS.CBOЯ-ЛИ
 I/ENCOD:,Z03,WS
 ,Z00,SYM
  NEWEL:,OCT,0040 0005.BЫBOД
       :,OCT,0040 0020.BBOД
  ALL:,AAX,B24
 ,U1A,NEWTASK
 T,VJM,LIS1 0.ГAШEHИE ШKAЛ
 DIAGN:,BSS,
 T,VTM,T HETЗ
 RO NE:,BSS,
 R,VTM,NEXT.
 ,UJ,RED OUT.
C=========   ПOДПPOГPAMMЫ BBOДA/BЫBOДA
C
C......   ЗHAЧEHИE PAЗPЯДOB PEГИCTPA N
 '        7P. - БEЗ ПOPЧИ CTPOKИ
 '        6P. - C HOMEPAMИ
 '        5P. - PEЖИM: IN/OUT
 '        4P. - ПEPEПИCЬ CЛOBAMИ
 '        3P. - KPACHЫЙ
 '        2P. - ЧEPHЫЙ
 '        1P. - БЫCTPЫЙ/MEДЛEHHЫЙ
C......
C
  YЖE:T,VTM,TBYSKEY
  R,VTM,CEKOH
 ,UJ,REDOUT
 OUTБYФ:T,VTM,TБYФ
 R,VTM,ANAL
 REDOUT:N,VTM,4.
 ,UJ,OUT/IN.
 OUT/IN Q:N,VTM,5.
 ,UJ,OUT/IN.
 OUT L:N,VTM,102B.
 C,XTA,LPAG
 ,ARX,=:000 001
 ,AAX,=:777 377
 C,ATX,LPAG
 C,WTC,ASTR.
 AS,VTM,-1.
 AS,XTA,.
 ,AEX,B48.
 ,UZA,OL1.
 ,XTA,BCH.
 ,AAX,LISC2.
 ,UZA,OL3.
 N,UTM,40B.
 ,UJ,OUT/IN.
 OL1:C,XTA,NU STR.
 ,ARX,=7776 7777 7777 7777
 C,ATX,NU STR.
 AS,XTA,1.  COBCEM
 ,ASN,64+40.ПYCTAЯ CTPOKA
 AS,ATX,.
 ,UZA,OL4.
 ,XTA,=6H =  '1''1'
 OL2:AS,ATX,.
 ,UJ,AFT MI1.
 OL3:,XTA,=6H'1''1''1''1''1''1'
 ,UJ,OL2.
 OL4:C,XTA,LPAG
 ,ARX,=7777 7677 7777 7777
 C,ATX,LPAG
 ,XTA,BCH
 ,AAX,LISC2.
 R,UZA,. - ДA
 KIL BL:,BSS,.
 ,XTA,ZBCH
 ,AAX,SC VID.
 ,ATX,SC VID.
 ,XTA,ZBCH
 ,AAX,SC BLNL.
 ,ATX,SC BLNL.
 R,UJ,.
 IN:,BSS,.
C......   OПPEДEЛEHИE: HYЖHO ЛИ HOMEPOBATЬ
 C,XTA,NUMBUS.БЛOK. ЛИ
 ,AAX,B24.ЗAПИCЬ
 ,UZA,INWN.-ДA
 ,XTA,BCH
 ,AAX,TAKESC.
 ,UIA,NUM IN.
 C,XTA,MБИHФ.
 ,AAX,=:777.
 ,UZA,IN WN.
 NUM IN:N,VTM,62B.C HOMEPAMИ
 ,UJ,OUT/IN.
 REPEAT:,BSS,
 C,WTC,RETADR
 R,VTM,
 ,AAX,SC ЖДY
 ,U1A,ЖДY IN
 IN WN:N,VTM,22B.БEЗ HOMEPOB
 ,UJ,OUT/IN.
 FG0:N,VTM,104B.
 ,UJ,OUT/IN.
 ПPOBЖДY:,BSS,
 ,XTA,SCЖДY
 ,AAX,BCH
 ,U1A,ЖДY IN
 T,VJM,CHAEND
 T,VTM,TLIMT
 ,UJ,REDOUT.R=ANAL
 ЖДY:,BSS,.SET PEЖИM ЖДY
 ,XTA,BCH
 ,AOX,SCЖДY
 ,ATX,SCЖДY
 R,VTM,ANAL
 ЖДY IN:C,XTA,ASTR.
 ,AAX,=77777.
 ,AOX,IW ЖДY.
 C,ATX,JOB   .ДЛЯ PEЖИMA
  ,XTA,SC SEND
 ,AAX,B CH  . ГACИM LINE FEED
  ,UZA,REDY JOB
 ,UJ,KILL NL
  CHE VID:,BSS,
 ,XTA,BCH
 ,AAX,SC VID
 ,AOX,LISC2.
 ,AEX,LISC2.
 ,UZA,REDY JOB
 ,AEX,SC VID
 ,ATX,SC VID
 KILL NL:,BSS,
 C,XTA,JOB
 ,AEX, B43
 WR JOB:C,ATX,JOB.
 ,UJ,REDY JOB.
 ABORT:,BSS,.БЫXOД БEЗ ДOCБP
 ,AAX,=:0000 04.БЫЛ BBOД
 ,U1A,CEKOH.-ДA
  C,ATX,RETADR
  ,XTA,ZBCH
  ,AAX,SCWAIT
  ,ATX,SCWAIT
C
C-----   KOHEЦ CEAHCA B DAY-FILE
C        ( <MT <Ф-KAHAЛ> )
 C,WTC,ASTR
 ,XTA,XNT
 ,ASN,64-42
 ,AUX,=6H'''''''7''7'''
 ,AOX,=6H<MT00''
 14,VTM,NAMTIM
 14,ATX,
 ,ITA,14
 ,AOX,=777 00000 776 00000
 ,*72,4
 ,XTA,OTBЯЗKA
 ,UJ,WR JOB
 RED OUT N:R,VTM,ANAL
 N,VTM,44B
 ,XTA,BEGZ
 ,AAX,BCH
 ,UZA,OUT/IN
 N,VTM,4
 C,WTC,ASTR
 AS,VTM,-1.ДЛЯ ЗAБИBKИ
 ,UJ,OL3.BOЗBPAT HA AFTMI
 OUT/IN:,BSS,.
 C,WTC,ASTR.
 AS,VTM,-1.
 ,ITA,N.
 ,AAX,=40.
 ,UZA,БEЗ N.
 C,XTA,NU STR.
 ,AUX,=6H'7''7''7''7'''''
 ,AOX,=6H'20''20''20''20'''''
 БEЗ N:,AEX,=6H     '1'
 AS,ATX,.
 AFT MI1: ,ITA,AS.
 ,AOX,IW O/I.
 C,ATX,JOB.
 ,ITA,N.
 ,ASN,64-45.
 ,AUX,=:1200 1.
 C,AOX,JOB.
 C,ATX,JOB.
 ,ITA,N.
 ,AAX,=130.
 ,UZA,MOVE S.
 ,AEX,=100.
 ,UZA,CHE VID
 ,AAX,=20.
 ,UIA,/IN.
C......   ПEPEПИCЬ TEKCTA CЛOBAMИ
 W,VTM,1-14.
 MOVE W:W,UTC,13.
 T,XTA,.
 AS,UTM,1.
 AS,ATX,.
 W,VLM,MOVE W.
 ,UJ,REDY JOB.
C......   ПEPEПИCЬ TEKCTA CИMBOЛAMИ
 MOVE S:AS,UTM,1.
 W1,VTM,.
 MS1:W,VTM,1-6.
 T,XTA,.
 ,ATX,TW.
 AS,XTA,.
 MS2:,ASN,64-8.
 ,ATX,RW.
 ,YTA,.
 W1,VIM,WRIT S.
 ,XTA,TW.
 ,ASN,64-8.
 ,ATX,TW.
 ,YTA,.
 ,ATI,S.
 S,VZM,LAST S.
 S,UTM,-15B.
 S,VZM,LAST S.
 S,UTM,15B-32B.
 S,VIM,WRIT S.
 LAST S:W1,VTM,1.
 WRIT S:,AOX,RW.
 W,VLM,MS2.
 AS,ATX,.
 W1,V1M,S LIMIT
 T,UTM,1.
 AS,VLM,MS1.
 /IN:AS,XTA,.
 ,AEX,=3.
C  KOД '2' = STEP + INPUT  ДЛЯ VR
 AS,ATX,.
 S LIMIT:C,XTA,JOB
 ,AOX,=:0000 000126.-79 ДЛЯ CЧ-KA CИMBOЛOB
 C,ATX,JOB
 REDY JOB:,ITA,R.
 C,AEX,RETADR
 ,AAX,=77777
 C,AEX,RETADR
 C,ATX,RETADR.
 C,XTA,JOB.ЗAKAЗ HA BЫBOД
 ,APX,=:000004.BIT*IN
 ,AUX,BCH
 ,AEX,ZBCH
 ,AAX,REDY71
 ,ATX,REDY71
C-----   MT-ЗAKAЗ (JOB) HA ИCПOЛHEHИE
 ,XTA,EV*PROG
 ,FUN,54B
 ,UJ,HAЧAЛO.
 EV*PROG:,OCT,00100000 4
  SECOND:R,VTM,.OCBOБ-E
  T,VJM,ДAЙ/HA.ИПЗ
  ЖДИTE:,BSS,
  T,VTM,TЗAH
 ,UJ,RONE
  DENSITY:C,XTA,MБ ИHФ
  ,AAX,=:777
  T,VTM,TOШHAБ
  ,UZA,RO NE
  ,ARX,
  ,UZA,RO NE
 ,ASN,64+39
 ,AAX,=77.БYФEP
  ,ATX,WS
 ,XTA,STATMT
 ,ASN,64+42
  ,ASN,64-6
  ,AOX,WS
  ,ASN,64-36
  ,ATX,WS
  ,ITA,W1
  ,UZA,STADENS
 T,VTM,9
  R,VJM,OPERANDS
  STADENS:,BSS,
  ,ATX,WS1
  T,VTM,-31
  S/TAP/:T,*63,T1MT+31
  ,AEX,WS
  ,AAX,=:7777
  ,U1A,NOMYTAP
  ,XTA,WS1
  ,ASN,64-9
  ,AOX,=1
  ,AEX,
  ,XTA,=3001
  T,*53,T1MT+31
  ,UJ,NEXT
  NOMYTAP:T,VLM,S/TAP/
  ,UJ,OUT БYФ
 ABOCTMT:,BSS,
 ,*62,.STOP
 I/O ADR:,BSS,.4 CЛOBA ПOДPЯД!
 ,LOG,5 0000 0000.KBЫ
 B1:,LOG,1.KBB+B1 (!)
 ,LOG,10 0001.OЧEPEДЬ
 ,LOG,20 0001.ПPOДOЛЖ. "KAK"
 IW ЖДY:,BSS,.
 ,LOG,0373 45 0142 6 00000.-85 CЧ-K CИMBOЛOB
 IW O/I:,BSS,.
 ,OCT,6153 4000 006 00000.
 N TIM:,BSS,.
 ,REAL,600.
 ,REAL,60.
 ,REAL,10.
 ,REAL,1.
  FUL WOR:,LOG,7777 7777 7777 7777.
 CL IN  :,LOG,7774 0000 0177 7777
 CL OUT :,LOG,0003 7777 7777 7777
 CL AЦП :,LOG,7777 7777 7600 0000
 HAЧCEAHC:,BSS,.
 ,ISO,12H'12'MYЛЬTИTAЙП
  ,ISO,12H (BEPCИЯ OT
  ,ISO,12H15/12/87)
 NEVM:,ISO,6HЭBM-1''
 TPASS:,BSS,.
 ,ISO,6H'1'PASS:
 ,CONT,6H'15''22'''''''''
 TUSABS:,BSS,.
 ,ISO,12HHET TAKOГO''''
  NO/WRIT:,ISO,12HЗAПP.ЗAПИCЬ''
 OШKAЛ:,BSS,.
 KOHCEAHC:,BSS,.
 ,ISO,6HK O H
 ,CONT,6HE Ц'12'''''
 TOШHAБ:,ISO,6HOШ.H.''
 TЗAH:,ISO,6HЖДИTE''
 TЗAПP:,ISO,6HЗAПP'41'''
 TBREAK:,ISO,H*ПPИKAЗ ИЗ'47'ЯT!''*
 TJBATCH:,ISO,H*ЖДИTE OTBETA''''''''''''*
 TJSTAR:,BSS,.
 ,ISO,5HCЧET''
  NAMTIM:,BSS,4
 T HET З:,BSS,.
  ,ISO,12HHET ЗAДAЧ''''''
 T HETOБP:,BSS,.
  ,ISO,12HHET OБPAЗA''''
  TNONTX:,BSS,
  ,ISO,12HHET TEKCTA''''
 T FULQ:,BSS,.
 ,ISO,12HMHOГO ЗAДAЧ''
 T LIMT:,BSS,.
 ,ISO,6HBPEMЯ''
 T ERSH:,ISO,12HOШ.ШИФP''''''''''
 TBYSKEY:,BSS,
 T SPBU:,ISO,6HЗAHЯT''
 T BLOWR:,BSS,.
 ,ISO,5HBBOД'22'
 TБYФ:,ISO,10H'1'БYФEP:'15''22'''
 TYP/ORD:,BSS,
 ,GOST,6H0'70'00'356''140'
 ,BSS,
C-----
 CO CA:,BSS,.
 REFUSE:,ISO,3H'45''45''45'.3 ПPOЦEHTA
 ,CONT,3H'12'MY
 ,CONT,3H'1'PA.PASS:
 ,CONT,3H'1'БY.БYФEP:
  ,CONT,3HДEЛ.ДEЛЬTA
 ,CONT,3HSEN.    SEND
 ,CONT,3HBBO.BBOД
 ,CONT,3HBЫB.BЫBOД
 ,CONT,3HAЦП.AЦПY
 ,CONT,3HBБH
 ,CONT,3HKBЫ
 ,CONT,3HKBB
 ,CONT,3HOЧE
 ,CONT,3HПEЧ
 ,CONT,3HPEЗ
 ,CONT,3HИCK
 ,CONT,3HHOB
 ,CONT,3HЛИC.ЛИCT
 ,CONT,3HTEЛ.OПEPATOPY
 ,CONT,3HФOP.ФOPMAT
 ,CONT,3HПYC.ПYCK
   ,CONT,3HTEP
 ,CONT,3HBPE
 ,CONT,3HCTO.CTOП
 ,CONT,3HK O
 ,CONT,3HЖДY
    ,CONT,3HЗAП
  ,CONT,3HЧИЗ
  ,CONT,3HOTЛ
   ,CONT,3HOCA.OCTAHOB ПO N KOMAHДЫ
   ,CONT,3HOЗA.OCTAHOB ПO ЗAПИCИ
   ,CONT,3HOЧT.OCTAHOB ПO ЧTEHИЮ
    ,CONT,3HИДИ
   ,CONT,3HPEГ
  ,CONT,3HMЯЧ
  ,CONT,3HMЯK
  ,CONT,3HФЯЧ
  ,CONT,3HШAГ
 ,CONT,3HДEC
  ,CONT,3HPET
  ,CONT,3HЛTO
 ,CONT,3HKAK.KAK ДEЛA
 ,CONT,3HCЧE
  ,CONT,3HCЛY
  ,CONT,3HCЛA
 ,CONT,3HCЛO.=CЛA+OTЛ
  ,CONT,3HRUN.=CЛA-CЛY
 ,CONT,3HTPR.TEPMИHAЛ+AЦПY
 ,CONT,3HTNP.ПEPEXB.AЦПY
 ,CONT,3HПYЛ.COOБЩ.ЗAДAЧE
 ,CONT,3HOTK.OTKAЗ
 ,CONT,3HДOH.= ДO HOMEPA
 ,CONT,3HДO .ПPOПYCK ДO
  ,CONT,3HCHA
  ,CONT,3HПЛO.ПЛOTHOCTЬ HA MЛ
  ,CONT,3HOПЛ.CTAHД.ПЛOTH.
  ,CONT,3HEDI.LINE-EDITOR
 ,CONT,3HПPT.ПPOTOKOЛ
 ,CONT,3HTPП.OTKAЗ OT ПPT
  ,CONT,3H'12''1''12'.ДЛЯ ЧETHOCTИ
 ,OCT,.
 TEXTS:,BSS,
C  TAБЛИЦA TEKCTOB ЭTAЛOHOB И ПOДCKAЗOK.
C  1-E CЛOBO - ЭTAЛOH ДЛЯ CPABHEHИЯ
C  2-E B 1-8 PAЗPЯДAX ЗAДAH YKAЗATEЛЬ
C      (CMEЩEHИE OT HAЧAЛA TAБЛИЦЫ) HA CЛEД.ПOДCKAЗKY
 0,ISO,12H*NAME '''''''''''4'
 2,ISO,12H*PASS:'15''22''''''''4'
  4,ISO,12H*TIME:'22''''''''''6'
  6,ISO,12H*LIST OUT'22''''10'
 10,ISO,12H*DISC:'22''''''''''12'
 12,ISO,12H*FILE:'22'''''''''''
 14,ISO,12H*EDIT '22''''''''''16'
 16,ISO,12H* R : '22''''''''''20'
 20,ISO,12H* W : '22'''''''''''
  22,ISO,12H MASTER '22''''''26'
 24,ISO,12H DISC '22''''''''''26'
  26,ISO,12H GIVE FILE '22'
  30,ISO,12H*DOS       '24'
  32,ISO,12H*EXPRESS   '34'
  34,ISO,12H*PAGE:'22''''''''''10'
  36,ISO,12H*DOS'''''''''''''''24'
 ,LOG,
 ,BSS,
 ,END,.
 WRPHYSM:,NAME,.17.08.78
C
C*****   ЗAПИCЬ B ЯЧEЙKY ПO MACKE
C
 BADMACRO:,SUBP,
 *ИПД:LC,BLOCK,(1),XNFM
 NFM:,WEQ,XNFM
 *YCЫ:LC,BLOCK,ГYC
 REGSCAL:,EQU,100B
 ДHЗ:,LC,1
 SMASAV:LC,BLOCK,SAVAC
 DISREG:,LC,1
 BIT48:,EQU,700B
C
 ,ATX,SAVAC.= MACKA
 ,XTA,
 ,YTA,.= HOBЫЙ KOД
 14,AEX,
 ,AAX,SAVAC
 14,AEX,.= PEЗYЛЬTAT
 WRPHYS:,ENTRY,
C
C*****   ЗAПИCЬ B ФИЗ.ЯЧEЙKY (ПPOCTAЯ)
C
 ,ATX,SAVAC.= ЗAПOMHИM
 ,ITA,14
 ,ASN,64+6
 ,UZA,RET.MOЛЧKOM
 ,XTA,DISREG
 ,ATI,27B.ДЛЯ 'ERRMACRO'
C-----   ПPOBEPKA ДOПYCTИMOCTИ
 ,XTA,3
 ,WTC,ДHЗ
 ,APX,BIT48-NFM
 ,WTC,ГYC
 ,AOX,REGSCAL
 ,ARX,
 ,U1A,BADMACRO
 ,XTA,SAVAC
  14,ATX,.ЗAПИCЬ
  RET:,BSS,
 ,MTJ,27B
 2,IJ,
 ,END,
 MACRO71:,NAME,.22.07.78
C
C*****   PEЗИДEHT 71 ЭKCTPAKOДA
C
C        1. ПEPФOPAЦИЯ ПK/ПЛ
C        2. PAБOTA C TEPMИHAЛAMИ
C
 *YCЫ:LC,BLOCK,ГYC
 BUFS27:,EQU,103B
 SMASAV:LC,BLOCK,SAVAC(2),SAVAR
 NRESCALL:,SUBP,
 NRES71:,SUBP,
 NRTERM:,SUBP,
 NRTERM7:,SUBP,
 BASE*NR:,LC,3
 *ИПK:LC,BLOCK,ИПK
  ДHЗ:LC,BLOCK,(1),BITJ
  *ИПД:LC,BLOCK,(1),XNFM(8),Ш/FULL
 NFM:,WEQ,XNFM
 C77357:,LC,1
 B1:,EQU,757B
  TERMINAL:,SUBP,
  TЮPИH*71:,SUBP,
  SCEM:,EQU,83
  B31 :,EQU,721B
 B17:,EQU,737B
C
 ,ATX,SAVAC
 ,ITA,27B
 ,AAX,C77357.= PEЖИM BOЗBPATA
 ,WTC,ГYC
 ,ATX,BUFS27
 14,VZM,M/ACC.= CYMMATOP.ЭK
 ,ATX,SAVAR
 ,WTC,SAVAR
   :   ,24,
 14,XTA,
   :    ,24,2003B
 ,ATX,SAVAC.= ИHФ.CЛOBO
  M/ACC:,WTC, Г Y C
  ,XTA,SCEM
  ,AAX,B31
  ,U1A,DISPAC
  ,XTA,SAVAC
 ,ASN,64+41
 ,AAX,B1
 ,AEX,B1
 ,ATI,14
 ,WTC,ДHЗ
 ,XTA,ИПK-NFM
 ,APX,B17
  ,AUX,BITJ.K KAДAHЦEBY
  ,AAX,Ш/FULL.OT MAT.ЗAДAЧ
 ,UZA,NRCALL
 14,VTM,2
C
C*****   ПOBTOPHЫЙ BXOД B ЭK71
C
 NRCALL:,BSS,
 MACRO71*:,ENTRY,
 14,XTA,INF*NR
 ,UJ,NRESCALL
 INF*NR:,Z00,NRTERM
 ,Z00,TO NRS
 :,Z00,NRES71
 ,Z00,TO NRS
 :,Z00,NRTERM7
 ,Z00,TO NRS
 TO NRS:14,ATX,BASE*NR
 ,ATI,13.= БAЗA HEPEЗИД.
 ,XTA,SAVAC
 13,UJ,
  DISPAC:,XTA,D/TERM
  ,UJ,NRESCALL
  D/TERM:,Z00,TЮPИH*71
  ,Z00,13
 ,END,
 TERM7:,NAME,
C**********************************************
C*
C*   OБMEH CTPOKAMИ C TEPMИHAЛAMИ ЧEPEЗ
C*            KOHЦEHTPATOP(EC-1010)
C*
C*   ИHФOPMAЦИOHHOE CЛOBO - KAK ПPИ OБMEHE
C*   C TEPMИHAЛAMИ B CИCTEME MULTITYPE,
C*   OДHAKO ECTЬ OTЛИЧИE: BBOД TOЛЬKO ЧИCTЫЙ.
C*           B41/40=0 -> BЫBOД
C*           B41/40#0 -> BBOД
C*
C***********************************************
C ---  COMMON БЛOKИ И П/П ДД
C
 *ИПД:LC,BLOCK,(1),XNFM(5),XNCM
 NFM:,WEQ,XNFM
 NCM:,WEQ,XNCM
 *ИПK:LC,BLOCK,ИПK
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR
 ДHЗ:LC,BLOCK,(1),BITJ
 SMASAV: LC,BLOCK,SAVAC,SAVSR(2),SAVI15(2),SAVI13
 INF7CH:LC,BLOCK,NЗAД,W110,NЗCB,W107(7),FBACK
 ,CONT,(1),FLACT70
 ALBUF:,EQU,435B
 *LINKPAR:LC,BLOCK,(1),SC/CONC
 NRESOFF:,SUBP,
 RETURN :,SUBP,
  R37BR :,SUBP,
 NRTERM7:,SUBP,
C
C ---  B ИПЗ
C
 *135:B,BLOCK,STR(16)
 *600:B,BLOCK,SAVR13,SAVR15,SAVR27,SAVR32,
 ,CONT,SAVR12(4),IW71,ADR,FL/IN
 WS:,EQU,IW71
C
C ---  KOHCTAHTЫ
C
 C77777:,LC,1
 C377:,LC,1
 B2:,EQU,756B
 B1:,EQU,757B
 DELCAT:,EQU,20B
 DELSTR:,EQU,400B
 DISREG:,LC,1
C ----------------------------------------
 B:13,REL,B
 ,WTC,ГYC
 15,VTM,SAVR13
 ,XTA,SAVI13
 ,XTS,SAVI15
 ,ITS,27B
 ,ITS,32B
 ,AOX,SAVSR
 ,ITS,12
 ,ITS,11
 ,ITS,10
 ,ITS,9
 ,XTS,SAVAC
C ---
 ,WTC,ГYC
 15,VTM,
 ,ASN,64+24
 15,ATX,ADR
 ,ASN,64+20
 ,AAX,C17
 ,ATI,14
 ,AEX,C17
 ,UZA,IND15
 ,AEX,B2
 ,UZA,IND13
 14,ITA,
 ,UJ,L1
 IND15:,XTA,SAVI15
 ,UJ,L1
 IND13:,XTA,SAVI13
 ,UJ,L1
 L1:15,ARX,ADR
 ,AAX,C77777
 15,ATX,ADR
 ,XTA,SAVAC
 ,AAX,B41/40
 15,ATX,FL/IN
 :,24,3
 ,WTC,ДHЗ
 9,VTM,
 15,XTA,FL/IN
 ,UIA,SETNT
 15,XTA,ADR
 ,ATI,11
 12,VTM,1-16
 LRW1:15,WTC,SAVR27
 :,24,
 11,XTA,
 :,24,3
 12,UTC,15
 15,ATX,STR
 ,AAX,C377
 ,UZA,SETNT
 11,UTM,1
 12,VLM,LRW1
 SETNT:9,XTA,ИПK-NFM
 ,ASN,64+36
 ,AAX,C17
 ,ATI,10.NT
 ,ARX,B1
 ,ASN,64-4
 ,ATI,11
 11,UTM,20B
 ,ITA,11
 15,ATX,WS
 ,UJ,MAINW
 WAITW:,BSS,
 ,24,3
 ,XTA,DISREG
 ,ATI,27B
 ,*57,3
 MAINW:,24,2003B
 ,XTA,NЗCB
 ,UZA,WAITW
 15,XTA,WS
 ,ATI,11
 ,WTC,ALBUF
 11,UTM,.STR BUF
 10,MTJ,12
 ,WTC,ALBUF
 12,UTM,.NT BUF
 12,XTA,
 ,UIA,WAITW
 12,XTA,DELCAT
 ,UZA,ACT70
 11,XTA,DELSTR
 ,AEX,/C/
 ,UZA,ACT70
 ,AEX,/C/
 ,AEX,/S/
 ,UZA,WAITW
 15,XTA,FL/IN
 ,UIA,MAINRC
 ACT70:,XTA,W107
 ,UIA,MW
 ,XTA,NЗAД
 ,UIA,TOFL70
 ,XTA,COMPIR
 ,AAX,SC/CONC
 ,UZA,TOFL70/
 ,XTA,COMPIR
 ,AAX,B48/9
 ,ATX,COMPIR
 ,033,34B
 ,XTA,B1
 ,ATX,W110
 ,ATX,FBACK
 ,XTA,NЗCB
 ,ATX,NЗAД
 13,MTJ,9
 15,VJM,R37BR
 9,MTJ,13
 ,WTC,ГYC
 15,VTM,
 ,UJ,MW
 TOFL70:,AEX,NЗCB
 ,UZA,MW
 TOFL70/:,XTA,B1
 ,ATX,FLACT70
 MW:,BSS,
 15,XTA,FL/IN
 ,UIA,IN
 9,VTM,1-16
 LRW2:9,UTC,15
 15,XTA,STR
 9,UTC,15
 11,ATX,
 ,AAX,C377
 ,UZA,OK1
 9,VLM,LRW2
 OK1:,XTA,B2
 12,ATX,
 ,UJ,OK
 IN:,XTA,
 12,ATX,DELCAT
 ,XTA,B1
 12,ATX,
 OK:,24,3
 15,XTA,FL/IN
 ,UZA,EXIT
 WAITR:,BSS,
 ,24,3
 ,XTA,DISREG
 ,ATI,27B
 ,*57,3
 MAINR:,24,2003B
 ,XTA,NЗCB
 ,UZA,WAITR
 12,XTA,DELCAT
 ,UZA,WAITR
 11,XTA,DELSTR
 ,AEX,/C/
 ,UZA,ACT70
 ,AEX,/C/
 ,AEX,/S/
 ,UZA,WAITW
 MAINRC:,BSS,
 11,UTM,DELSTR
 12,UTM,DELCAT
 ,XTA,
 12,ATX,
 9,VTM,1-16
 LRW3:9,UTC,15
 11,XTA,
 9,UTC,15
 15,ATX,STR
 ,AAX,C377
 ,UZA,OK2
 9,VLM,LRW3
 OK2:,24,3
 9,VTM,1-16
 15,XTA,ADR
 ,ATI,12
 LRW4:,BSS,
 9,UTC,15
 15,XTA,STR
 15,WTC,SAVR27
 :,24,
 9,UTC,15
 12,ATX,
 :,24,3
 ,AAX,C377
 ,UZA,EXIT
 9,VLM,LRW4
C ---
 EXIT:15,UTM,SAVR12+4
 15,XTA,
 ,STI,9
 ,STI,10
 ,STI,11
 ,STI,12
 :,24,2003B
 ,ATX,SAVSR
 ,STI,33B
 ,STI,27B
 ,STX,SAVI15
 ,STX,SAVI13
 ,XTA,REFNR
 ,ATX,SAVSR+1.SAVAR
 ,UJ,NRESOFF+2
 REFNR:,Z00,NRTERM7
 ,Z00,RETURN
C---------------------------------------
 C17:,LOG,17
 MASK IW:,LOG, 774 77777 540 77777
 B41/40:,OCT,003
 /C/:,ISO,6H'45'C''''''''
 /S/:,ISO,6H'45'S''''''''
 B48/9:,LOG, 7777 7777 7777 7400
 ,END,
  ПEPФOPAЦ:,NAME,
C
C******************************
C****** HEPEЗИДEHT  Э071 ******
C******************************
C
C.....   CTPYKTYPA IW71 HA BXOДE :
C       --------------------------------
C    48:45, 39:25 - ИHДEKCИPOBAHHЫЙ AHAЧ.
C    24:21, 15:1  - ИHДEKCИPOBAHHЫЙ AKOH.
C       44:40     -  K O П
C               0 - BЫBOД HA П/Л
C               1 - BЫBOД HA П/K
C               3 - БYФEPИЗAЦИЯ ГPAФИKИ
C          20     - HE ЗAKPЫBATЬ ЗAДAЧY
C
C
C.....   ИHФOPMAЦИOHHOE ПOЛE ДИCПETЧEPA :
C       --------------------------------
  * И П Д :LC,BLOCK,XNF,XNFM,XNFD(3)
  ,CONT,XNC,XNCM(2),Ш/CЛYЖ,Ш/FULL
 XLSMB:,EQU,XNF+26B
  LISTFLAG:,EQU,XNF+35B
 C/BUF:,EQU,XNF+37B
  OUTJOBSC :,EQU,XNF+52B
 БЫЛ*64:,EQU,XNF+55B
  EXTSC :,EQU,XNF+63B
 БЫЛ*ПФ:,EQU,XNF+76B
C
  NF :,WEQ,XNF
  NFM:,WEQ,XNFM
  NFD:,WEQ,XNFD
  NC :,WEQ,XNC
  NCM:,WEQ,XNCM
C
C.....  ИHФOPM.ПOЛЯ KAHAЛOB :
C       ---------------------------
  * И П K :,LC,1
  INFEX:,EQU,*ИПK+NCM
  * И П K 1 :LC,BLOCK,PRTSTAT
C
C.....  БИTЫ :
C       -------------
  *677:B,BLOCK,BITS
  ,CONT,B48,B47,B46,B45,B44
  ,CONT,B43,B42,B41,B40,B39
  ,CONT,B38,B37,B36,B35,B34
  ,CONT,B33,B32,B31,B30,B29
  ,CONT,B28,B27,B26,B25,B24
  ,CONT,B23,B22,B21,B20,B19
  ,CONT,B18,B17,B16,B15,B14
  ,CONT,B13,B12,B11,B10,B9
  ,CONT,B8 ,B7 ,B6 ,B5 ,B4
  ,CONT,B3 ,B2 ,B1
C
C.....  HAЗBAHHЫE БИTЫ :
C       ----------------------
  PCBUZ:,EQU,B1.ФЛAГ ПEPФOPAЦИИ
  BLBIT:,EQU,B44.БЛOKИP.HA TP 7
  BNOCLOS:,EQU,B20.БЛOK.ЗAKPЫTИЯ ЗAДAЧИ
   B R C :,EQU,B16.БИT ГOTOBHOCTИ ПИ
   B R T :,EQU,B12.БИT ГOTOBHOCTИ ПЛ
C
C.....  KOHCTAHTЫ ДИCПETЧEPA :
C       --------- ---------------
  DIS REG :,LC,1
  C3:,LC,1
  C7:,LC,1
  C37     :,LC,1
  C13:,LC,1
  C77777  :,LC,1
 C76000:,LC,1
  B16/1   :,LC,1
  B24/1   :,LC,1
  B48/31  :,LC,1
  C377:,LC,1
  FULWOR:,LC,1
C
C.....  ПOЛE MAЛOГO YПPЯTЫBAHИЯ :
C       ----------------- ---------
  SMASAV:LC,BLOCK,SAVAC,SAVSR
  ,CONT,SAVAR,SAVI15
  ,CONT,SAVI14,SAVI13
  ,CONT,SAVMIR,SAVS16
C
C.....  ПPOЧИE COMMON-Ы ДИCПETЧEPA :
C       -------------------------------
  *YCЫ :LC,BLOCK, Г Y C , RDSCAL
  ,CONT,COMMIR,COMPIR
  ДHЗ  :LC,BLOCK,(1),BITJ,ZBITJ
  SCALES:LC,BLOCK,(2),S1CLTA,STCLTA(4),SCWPERF
  N DIV :LC,BLOCK,(1),BR/PERF
  YCTP  :LC,BLOCK,XOЗПK(2),XOЗПЛ(2)
  CON TIME:LC,BLOCK,(4),PTIME
  *STATBUF:LC,BLOCK,(11),CTATПИ(2)
  TPHYS:,LC,1
C
C.....  ПOДПPOГPAMMЫ ДИCПETЧEPA :
C       ---------------------------
  TYP/PL:,SUBP,
  COPY7 :,EQU,TYP/PL+1
  TTPRINT:,SUBP,
  NRES71 :,SUBP,
 MACRO71*:,SUBP,.ПOBTOPHЫЙ BXOД
 NRESCALL:,SUBP,
 NRES OFF:,SUBP,
 CLANEWTA:,SUBP,
 CL OPER :,SUBP,
  STATIST:,SUBP,
 BOC ИПД :,SUBP,
 NEWTA   :,SUBP,
 FULSAV  :,SUBP,
 SELECT  :,SUBP,
 RETURN  :,SUBP,
  TIME10:,SUBP,
  ERRMACRO:,SUBP,
  ERREXT:,SUBP,
 NR/64  :,SUBP,
 NRES064:,SUBP,
 *WRBF64:,SUBP,
C
C.....  XPAHИЛИЩE БAЗOBOГO PEГИCTPA :
C       -----------------------------------
  BASE*NR:LC,BLOCK,(1),BASA
C
C.....  ЯЧEЙKИ CBOEГO  И П З :
C       ----------------------------
  ST/EXCH:,EQU,-2
  *100:B,BLOCK,REGSCAL(2),M72,BUFS27,M74,M75
  *135:B,BLOCK,IW71
  ,CONT,AC(3),R33,R32,R27(5),R12,R11
  ,CONT,ENDMAT.MAT AДP.KOHЦA
  ,CONT,BEGMAT.MAT AДP.HAЧAЛA
  ,CONT,WS1(0)
  ,CONT,ABUF.БYФEP ФИЗ.YCTP-BA
  ,CONT,PMASK.MACKA ПPП
  ,CONT,FL/END.
  ,CONT,COUNT.CЧ-K CИMBOЛOB ПЛ
  ,CONT,MAXCOUNT.K-BO CИMB.B ПOPЦИИ
  ,CONT,SYMBOL.ПEPФOPИPYEMЫЙ CИMBOЛ
  FL/END:I,BLOCK,COUNSI(2),SORTIR
  STAT1:,EQU,571B
C
C.....  ЯЧEЙKИ  И П З  PEДAKTИPOBAHИЯ
C       -----------------------------
 И П P:,EQU,1000B
 LB :,EQU,17B
 CNT:,EQU,20B
 BT :,EQU,22B
 TE :,EQU,31B
 EBUF:,EQU,32B
 LBUF:,EQU,34B
 SAVIR:,EQU,100B
 BUFSAV:,EQU,ИПP+SAVIR
C
C...  ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
C     ----------------------------
C
 *1:,BLOCK,AB,L,R,A
C=========================================
C
  *TAKCA:LC,BLOCK,(6),CTP1.ЦEHA 6 CИMB.П/Л ИЛИ 1/24 П/K
  BEGIN:13,REL,BEGIN. * * *
  B:,BSS,
  ,WTC,BASA
  13,VTM,
  15,VTM,48
  ,UJ,OLD 71
C     --------------------------
C     I БYФEPИЗAЦИЯ ПEPФOPAЦИИ I
C     --------------------------
 BUFPUNCH:,BSS,
C...  YПPЯЧEM KЛИEHTA (ДЛЯ HAЧAЛA)
 15,XTA,BUFS27-AC
 ,ATI,27B
 ,ITA,32B
 ,ATI,33B
 15,UTM,BUFSAV-AC
 13,VJM,FULSAV+1
 ,WTC,BASA.- BOCCTAHOBИM
 13,VTM,.  БAЗY
 ,WTC,ГYC
 15,VTM,И П P
 ,ITA,15
 15,AEX,BT
 ,AAX,C76000
 15,AEX,BT
 15,ATX,BT
 15,AEX,TE
 ,AAX,C76000
 15,AEX,TE
 15,ATX,TE
 ,ATI,AB
 15,AEX,EBUF
 ,AAX,C76000
 15,AEX,EBUF
 15,ATX,EBUF
C...  ФOPMИPOBAHИE CЛYЖEБHOГO CЛOBA
 ,XTA,SAVAC
  ,ASN,64-7
  ,ASN,64-2
  ,YTA,
  ,ATI,R.0,1,3
  ,AEX,C3
  ,U1A,NOMARK
  ,XTA,B43.ПPИЗHAK
  15,AOX,STAT1-ИПP.ПOПAДET
  15,ATX,STAT1-ИПP.B KATAЛOГ
  NOMARK:,BSS,
  R,XTA,BITS
  ,ASN,64+8
 ,AOX,SAVAR
 ,ARX,M/PU
 ,ATI,L.= ДЛИHA ПOPЦИИ
   :   ,24,3
 R,VJM,WRIT W.= ЗAПИШEM EГO
 15,XTA,BEGMAT-ИПP
 ,ATI,A.= AДPEC HAЧAЛA
  L,UTM,1
C...  ПEPEПИCЬ ПOPЦИИ B MAЛЫЙ БYФEP
 TRAN:,BSS,
 15,WTC,BUFS27-ИПP
   :   ,24,
 A,XTA,
   :   ,24,3
 R,VJM,WRIT W
 A,UTM,1
 L,UTM,-1
 L,V1M,TRAN
C...  BOCCTAHOBЛEHИE ИПЗ KЛИEHTA
C        (ЯЧEЙKИ 00-25)
 ,WTC,ГYC
 A,VTM,
 L,VTM,-25B
   :   ,24,2003B
 RESET:,BSS,
 15,UTC,SAVIR
 L,XTA,25B
 A,ATX,
 A,UTM,1
 L,VLM,RESET
  TO NROF:,BSS,
 ,XTA,M/REF
 ,UJ,NRESOFF
 M/REF:,Z00,NRES71
 ,Z00,SELECT
C
C***  БЛOK ЗAПИCИ CЛOBA B MAЛЫЙ БYФEP
C
 WRIT W:,BSS,.  CЛOBO
 AB,ATX,.= HA MECTO
 AB,UTM,1
C...  KOЛЬЦEBATOCTЬ MAЛOГO БYФEPA
 ,ITA,AB
 15,AEX,EBUF
 ,U1A,WW 1
 15,WTC,LBUF
 WW 1:AB,UTM,
C...  HE ПOЛOH ЛИ MAЛЫЙ БYФEP
 15,XTA,LB.= ЗAHЯTO
 ,ARX,C77777.  CTPOKOЙ
 ,AAX,C77777
 15,ATX,LB
 ,UZA,TO WRBF.= HA CБPOC
C...  BOЗBPAT ИЗ ЗAПИCИ CЛOBA
 WW/RET:,XTA,
 AB,ATX,
C ЗAПOMHИM AДPEC KOHЦA ДAHHЫX B M.БYФ (TE)
C B *WRBF64 TE YПPABЛЯET ЦИKЛOM CБPOCA HA Ф.Л.
C *WRBF OБHOBИT CЧETЧИK CBOБ.MECTA (LB) И
C YKAЗATEЛЬ,OTKYДA EЙ БPATЬ ДAHHЫE (BT)
 ,ITA,AB
 15,ATX,TE
 R,UJ,
C---  CБPOC MAЛOГO БYФEPA HA Ф-ЛИCT
 TO WRBF:,BSS,
C...  BЫЗOB HEPEЗИДEHTA БYФEPИЗAЦИИ
 ,ITA,13
 ,ARX,I/NR64
 ,UJ,NRESCALL.= BЫЗOB
 I/NR64:,Z00,NR/64
 ,Z00,TOWR-BEGIN
 TOWR:,ATI,7
 7,UTC,*WRBF64-NRES064
 13,VJM,.HA HEPEЗИДEHT
C...  OTKAЗ OT HEPEЗИДEHTA
 ,WTC,BASA
 13,VTM,
 ,XTA,R/NR64
 ,ARX,BASA
 ,UJ,NRESOFF.= OTKAЗ
 R/NR64:,Z00,NR/64
 ,Z00,WW/RET-BEGIN
C     ------------------
C     I OTБYФEPИЗOBAЛИ I
C     ------------------
  M/PU:,OCT,7740 0000 0000 0000
C
C
C---------------------------------
C/// OLD DRIVER ///BEGIN//////////
C---------------------------------
C
C
  C7777:,LC,1
 TMAT:,EQU,30B.
 BISTIME:,EQU,110B.
 *C:LC,BLOCK,C6,C571,C574,C176000.
 C77:,LC,1.
  L0304 :,EQU,XOЗ ПK
  L0700 :,EQU,XOЗ ПЛ
  CALL1MEM:,SUBP,
  C2013:,EQU,DISREG
 PUNTIME:LC,BLOCK,TIMECNT.
  B30/16:,LC,1
  TYP/PC:,EQU,TYP/PL
  C5:,LC,1
  C14:,LC,1
  C177:,LC,1
 *677:B,BLOCK,(1),BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42
 ,CONT,BIT41,BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34
 ,CONT,BIT33,BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26
 ,CONT,BIT25,BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18
 ,CONT,BIT17,BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10
 ,CONT,BIT9,BIT8,BIT7,BIT6,BIT5,BIT4,BIT3,BIT2,BIT1
  C1:,EQU,BIT1
 L0677:,EQU,L0700-1.
 FIXBIT:,EQU,BIT1.
C
C
C/////////////////////////////
C
C
  ,REL,
  OLD71:13,ATX,INFW - B
 ,XTA,SAVI15.
 ,ASN,64-15.
 ,AOX,SAVI14.
 ,ASN,64-15.
 ,AOX,SAVI13.
 ,WTC,Г Y C.
 ,ATX,M74.ЗAЩИTA ИHД. ЗAДAЧИ OT ПPEP.
  ,XTA,SAVAC
  GAD:15,UTM,-24
  15,ASN,64+20
 13,AAX,C17-B.
 ,ATI,14.N ИHД. B AK ИHФ.
 13,AEX,C15-B.
 13,UZA,IND13-B.
  ,AEX,BIT2
 13,UZA,IND15-B.
 14,ITA,.COДEPЖ. ИHД. ИHФ. CЛOBA
  BAKM:13,UTC,-B
  15,VIM,MATB
  13,ARX,ABEG-B
  13,UJ,FORMNK-B
  MATB:,ASN,64-24
  13,ARX,INFW-B
  FORMNK:13,ATX,ABEG-B
  13,UTC,-B
  15,V1M,GAD
  ,ATI,14.MAT.ADP.KOHЦA
  ,ASN,64+24 .ADP.HAЧAЛA
  ,AAX,C77777
  13,ATX,ABEG-B
  13,U1A,NOREF-B
C--- OTKAЗ OT ПEPФOPATOPA, ECЛИ AHAЧ=0
  13,XTA,INFW-B
  ,ASN,64+38
  ,AAX,BIT2
  ,AEX,BIT2
  ,ATI,14.0-ПИ, 2-ПЛ
  14,XTA,XOЗПK
  ,AEX,ГYC
  ,ASN,64+42
  13,UZA,REF-B
  14,UTM,1
  14,XTA,XOЗПK
  ,AEX,ГYC
  ,ASN,64+42
  13,U1A,*OTK-B
  REF:14,ATX,XOЗПK
  ,XTA,STCLTA
C--- OTKPЫTИE ЗAДAЧ, ЖДYЩИX YCTP-BO
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  ,XTA,
  ,ATX,STCLTA
  13,UJ,*OTK-B
C---
  NOREF:,BSS,
  ,ITA,14
  ,AEX,C77777
  13,ARX,ABEG-B
  13,ATX,AEND-B
  ,XTA,SAVAC
  13,AAX,=:003 -B
  13,AEX,=:003 -B
  13,UZA,NOTIM-B
  13,XTA,AEND-B
  13,AEX,=6400 0000 0007 7777 -B
  ,NTR,2
  ,A*X,CTP1
  ,WTC,Г Y C
  ,A+X,BISTIME
  13,A+X,CTP2-B
  ,WTC,Г Y C
  ,ATX,BISTIME
  NO TIM:,BSS,
  ,ITA,14
  ,NTR,3
  13,A-X,ABEG - B
C/////////////////////////////
  13,REL,BEGIN
 ,ATX,SAVAR
  ,WTC, Г Y C
  15,VTM,AC
  ,XTA,ABEG
  15,ATX,BEGMAT-AC
  ,XTA,BITJ.A BИTЯ - ГAД,
  ,AOX,БЫЛ*ПФ.OH ЭTO
  ,ATX,БЫЛ*ПФ.BЫPEЗAЛ !
 ,XTA,LISTFLAG
 ,AAX,BITJ
 ,U1A,BUFPUNCH.= БYФEPИЗOBAH
  ,XTA,SAVAC.ECЛИ BЫBOД
  ,AAX,=:003.HE БYФEPИЗOBAH
  ,AEX,=:003. - ГPAФИKY
  ,UZA,TO NROF.ИГHOPИPYEM
    ,XTA,AEND
    ,AAX,B30/16
    ,U1A,MHOГOПФ
  ,REL,
C
C
C--------------------------------
C///// OLD DRIVER///CONTINUE/////
C--------------------------------
C
C
  ,ITA,14
  13,ATX,AEND-B
  ,ASN,64-15
  13,AOX,ABEG-B
  ,ASN,64-15
  ,WTC,Г Y C
  ,ATX,M75
    ,WTC,ГYC
   ,XTA,BUFS27
   ,AAX,BIT1
   ,AEX,BIT1
   13,UZA,FAD-B
   ,ITA,13
 13,ARX,*1-B.
 *1:,UJ,CALL1MEM.
 ,Z00,*2-B.
 *2:,BSS,.
 ,ASN,64+10.
  ,ATI,14
  ,WTC,Г Y C
  ,XTA,M75
  ,ASN,64+15
  13,ATX,ABEG-B
  ,ASN,64+15
  13,ATX,AEND-B
  ,ITA,14
   FAD:,BSS,
 ,ATI,14.
 ,WTC,Г Y C.
 ,ATX,M75.
 ,XTA,SAVAC.
 13,ATX,INFW-B.BOCCTAHOBЛEHИE
 ,XTA,C2013.
 ,ATI,27B.
 ,XTA,FIXBIT.
 14,AOX,TPHYS.
 14,ATX,TPHYS.ФИKCAЦИЯ ЛИCTA
  ,XTA,ГYC
  13,ATX,NP-B
 13,XTA,INFW-B.
 ,AAX,BIT40.
C
C  ПOИCK CBOEГO ИЛИ
C  ЗAXBAT CBOБOДHOГO ПЛ/ПK
C
   13,ATX,L0775-B
   SE/FREE:,BSS,
C....  1-ПK, 0-ПЛ
  15,VTM,-1
  14,VTM,L0700
  13,UZA,ИЩИПEPФ-B
  14,VTM,L0304
  ИЩИПEPФ:14,UTC,
   15,XTA,1
  13,AEX,NP-B
 ,ASN,64+42
  13,UZA,ПPOЗA-B
  ЧYЖYCTP:13,UTC,
  15,VLM,ИЩИПEPФ-B
C  CBOEГO HET
C  ИЩEM CBOБOДHЫЙ
  13,XTA,NP-B
  13,UZA,ABSENT-B
  ,XTA,
  13,ATX,NP-B
  13,XTA,L0775-B
  13,UJ,SE/FREE-B
  ABSENT:14,UTM,-L0304
  13,UTC,
  14,VZM,ABS1-B
  14,VTM,4
  ABS1:13,UTC,
  14,UTM,HПИ-B
  ,ITA,14
  14,VJM,TTPRINT
  14,VTM,STCLTA
  13,UJ,L0373-B
C  ПPOBEPKA БЛOKИPOBKИ HA T.P.7
  ПPOЗA:,XTA,7
 ,AOX,TYP/PL+1.ПPOГ KOПИЯ TP 7
  14,UTC,-L0304
   15,AAX,BIT44+1
  13,UZA,NOBLOK-B
  ,XTA,
  14,UTC,
   15,ATX,1
  13,UJ,ЧYЖYCTP-B
   NO BLOK:14,UTM,-L0700
   13,UTC,
   14,V1M,L0022-B
    15,UTM,2.ПЛ:1,2
  L0022:,BSS,
  ,WTC,Г Y C
  ,XTA,BUFS27
  ,AAX,BIT1
  ,AEX,BIT1
  13,UZA,MATEM-B
  13,XTA,AEND-B
  ,ASN,64+10
  ,ARX,Г Y C
  ,ATI,14
  14,XTA,TMAT
  ,ASN,64+20
  ,AAX,C76000
  MATEM:13,ATX,NP-B
  13,UZA,MATEM1-B
  13,AEX,ABEG-B
  ,AAX,C176000
  13,AEX,ABEG-B
  ,AAX,C77777
  13,ATX,ABEG-B
  13,XTA,AEND-B
  13,AEX,  NP-B
  ,AAX,C176000
  13,AEX,AEND-B
  13,ATX,AEND-B
  MATEM1:,BSS,
  13,XTA,ABEG-B
 15,UTC,1.
 13,ATX,L0307-B.AHФ
  13,XTA,AEND-B
 15,UTC,1.
 13,ATX,L0312-B.AKФ
 ,XTA,Г Y C.
 15,ATX,L0304+1.
  15,MTJ,14
  14,UTC,
  14,XTA,BIT14
  14,UTM,-2
  13,UTC,-B
  14,V1M,HAШБИT
  ,ASN,64-1
  HAШБИT:13,ATX,NP-B
  13,ATX,NRBIT-B
  ,EXT,4102B
  13,AAX,NP-B
  13,UZA,NO/REA-B
  ,ASN,64+12
  13,UIA,BPEZA-B
  ,XTA,TYP/PL
  15,AAX,BIT43
  13,U1A,BPEZA-B
  ,XTA,BIT9
  15,EXT,167B
  BPEZA:,BSS,
 L0742:,XTA,TIMECNT.CЧETЧИK ДЛЯ BPEM.ЗAДEPЖEK
 ,ARX,BIT6.64
 15,UTC,1.
 13,ATX,L0315-B.BPEM.ЗAДEPЖKA
 13,UTC,.
 14,VTM,OTKAЗ-B.
  CLOSJOB:14,MTJ,33B
  ,WTC,ГYC
 ,XTA,M74.
 ,ATX,SAVI13.
 ,ASN,64+15.
 ,ATX,SAVI14.
 ,ASN,64+15.
 ,ATX,SAVI15.BOCCT. ИПД
 ,UJ,CLANEWTA
  NO/REA:13,XTA,NP-B
  ,AOX,BR/PERF
  ,ATX,BR/PERF
  13,UTC,
  14,VTM,BПЛ-B
  ,ASN,64+12
  13,UZA,L0751-B
  14,UTM,-4
  15,XTA,CTATПИ+1
  ,ARX,BIT37
  15,ATX,CTATПИ+1
  L0751:,BSS,
 ,ITA,14.
  14,VJM,TTPRINT
  14,VTM,SCWPERF
 L0373:,BSS,.
 ,WTC,Д H З.
 ,XTA,BITS.
  14,AOX,
  14,ATX,
  ,WTC,ГYC
 ,XTA,M75.
 ,ATI,14.
 14,XTA,TPHYS.
 ,AEX,FIXBIT.
 14,ATX,TPHYS.PACФИKCAЧИЯ ЛИCTA
 ,XTR,SAVSR.
  ,ITA,13
  13,ARX,NRINF-B
  14,VTM,MACRO71*
 ,UJ,NRESOFF.OTKAЗ OT HEPEЗИДEHTA
 NRINF:,Z00,NRES71.
  ,Z00,CLOSJOB-B
C
 IND13:,WTC,Г Y C.
 ,XTA,M74.
  TOBAKM:,AAX,C77777
 13,UJ,BAKM-B.
 IND15:,XTA,SAVI15.
  13,UJ,TOBAKM-B
 MHOГOПФ:,BSS,.
 13,UTC,-B.
 14,VTM,TMHПФ.
 ,UJ,ERREXT.
 TMHПФ:,GOST,9HMHOГO ПФ'231'.
C
C     BЫБOP YCTP. ПЛ
C
 TPCHEK:,ENTRY,.
C
C      BXOД ИЗ BPEMEHHЫX ПPEPЫBAHИЙ ПO 10P. ГPП
C
C
C----------------------------------------
C     PAБOЧИE PAЗPЯДЫ ЛEHTOЧHOЙ ПФ :
C
C          1.  TYP/PL:,LC,1
C  48-46  -  TИП ПЛ  ( '1' - ПЛ-80 )
C..  42-40  -  '1'-ПPOБИBKA COBMEЩEHA
C..          C ЗAПYCKOM MOTOPA
C  12-10  -  ПPИЗHAK ЗAHЯTOCTИ ('1' - ЗAHЯT)
C
C          2.  ПЛ CДOX:,BSS,1
C  48-46  -  ФЛAГИ ПOBTOPEHИЯ ПOCЛEДHEГO CИMBOЛA
C..  42-40  -  '1'-ГЛYШИ MOTOP
C..  24-22  -  ПЛ ЗAHЯT BЫДAЧEЙ CИMBOЛA
C  12-10  -  БЫЛA  TT-ПEЧATЬ : ''BЫK.ПЛ''
C
C-----------------------------------------
C
  13,UTC,
  15,VJM,CH101-B
  ,ITA,12
  13,ATX,SAVE12-B
 ,ITA,11.
  13,ATX,SAVE11-B
  SAVER:,BSS,
 ,XTA,TIMECNT.
 ,ARX,BIT1.
 ,ATX,TIMECNT.
  11,VTM,-1
  12,VTM,-2
  14,VTM,-1
   BЫДEPЖKA:14,UTC,1
  13,UTC,
  12,AEX,L0712-B
   14,UTM,1
  13,UZA,BOTYC-B
   ,XTA,TIMECNT
  13,UTC,-B
   14,VZM,BЫДEPЖKA
  12,VTM,
  14,VTM,-1
  13,UTC,-B
  11,VLM,BЫДEPЖKA
C  M.Б. БЫЛ CДOXШИЙ ПЛ
  ,EXT,4102B
  ,AAX,TYP/PL
  ,AEX,TYP/PL
  ,AAX,C176000
  13,U1A,KTOCДOX-B
  ,AEX,TYP/PL
  13,AAX,ПЛ CДOX-B
  ,AAX,C176000
  13,UZA,L0615-B.BCE O'KEY
  11,VTM,1
  KTOCДOX:,ASN,64-32
  ,ANX,C77777
  ,ATI,14
  14,XTA,BIT16
  13,ATX,NRBIT-B
  13,UTC,-B
  11,UTC,
  14,UJ,PEAKЦИЯ
  PEAKЦИЯ:14,VTM,
  13,UJ,ПИ CДOX -B
  :14,VTM,
  13,UJ,ПИ ГOT -B
  :14,VTM,1
  13,UJ,ПИCДOX-B
  :14,VTM,1
  13,UJ,ПИГOT-B
  :14,UTM,-4
  13,UJ,REPL-B
  :14,UTM,-4
  13,UJ,REPL-B
  :14,UTM,-4
  REPL:13,UTC,-B
  11,VIM,ПЛГOT
  12,VTM,2
  13,UJ,NRD*PL-B
  ПЛГOT:,BSS,
  14,MTJ,12.HOMEP ПЛ
  13,J+M,12
  12,XTA,L0723-B
  ,ATI,11
C  HAДO ЛИ ПOBTOPЯTЬ ПOCЛEДHИЙ CИMBOЛ
  13,XTA,ПЛCДOX-B
   14,AAX,BIT48
  13,UZA,NOREPEAT-B
  13,UJ,CH*READY-B
C   HAШЛИ BЫДEPЖAHHOE YCTP-BO
   BOTYC:,BSS,
 L0264:,XTA,TIMECNT.
 13,ARX,L0220-B.-1
 ,ATX,TIMECNT.BOЗBPAT CЧETЧИKA BP.
  14,MTJ,12
  13,J+M,12
  13,UTC,-B
  11,VZM,ПOДГ ПPП
 ,033,4102B.OПPOC PAЗP.ПYCKA
 14,UTC,.
 14,AAX,BIT15.
  13,U1A,ПYCПИ-B.ПИ B PAБOTY
 14,XTA,CTATПИ.HEГOT.ПИ
 ,ARX,BIT37.B
 14,ATX,CTATПИ.CTATИCTИKY
 14,MTJ,11.
 13,UTC,.
 14,VTM,BПИ-B.
 ,ITA,14.
 14,VJM,TTPRINT.
 11,MTJ,14.
  ,XTA,
 13,UJ,L0561-B.
C
C        ПPOBEPKA ПЛ
C
  ПOДГ ПPП:,BSS,
  12,WTC,L0704-B
  ,XTA,
  12,ATX,L0715-B
  ,XTA,TYP/PL
  14,AOX,BIT12
  ,ATX,TYP/PL
  11,VTM,50B
  ,ITA,11
  12,ATX,L0723-B
 ,XTA,.
 12,ATX,L0712-B.
 14,XTA,BIT16.
 ,AOX,COMPIR.
 ,ATX,COMPIR.
 ,033,34B.
 14,XTA,BIT16.
 ,AEX,FULWOR.
 ,033,30B.
 ,XTA,BIT37.
 ,AOX,COMMIR.
 ,ATX,COMMIR.
 ,002,36B.
  ,XTA,TYP/PL
  14,APX,BIT42
  ,ASN,64+39
  13,UJ,NOREPEAT-B
 CИПEPФ:,ENTRY,.
C
C         CИ ПPOБИBKИ ПИ80
C
 L0642:14,XTA,BIT18.
 ,AEX,COMPIR.
 ,ATX,COMPIR.
 ,033,34B.ЗAKP.CИ ПPOБИBKИ
 ,XTA,BIT37.
 ,AEX,FULWOR.
 ,ATI,.
 ,002,37B.ГAШ.37P.ГPП
  13,UTC,-B
  15,VTM,CИПEPФ1
 L0065:,ITA,12.
  13,ATX,SAVE12-B
 14,MTJ,12.N YCTPOЙCTBA
 13,J+M,12.БAЗA +N ПИ
 ,ITA,11.
  13,ATX,SAVE11-B
  ,ITA,14
  ,ASN,64-2
  ,ATI,11.4N
  ,XTA,
  DUBNPC:,BSS,
  13,ATX,PCCOUNT-B
  15,UJ,
  ПYCПИ:,BSS,
 ,XTA,.
 12,ATX,L0315-B.ЗAHYЛEHИE BЫДEPЖKИ
 14,XTA,BIT18.
 14,AOX,BIT20.
 ,AEX,FULWOR.
 ,033,30B.ГAШ.CИ ПPOБ. И KOHTP.
  ,AEX,FULWOR
 ,AOX,COMPIR.
 ,ATX,COMPIR.
 ,033,34B.OTKP.CИ ПPOБ. И CИ KOHTP.
 ,XTA,BIT37.
 ,AOX,COMMIR.
 ,ATX,COMMIR.
 ,ATI,.
 ,002,36B.OTKP.37P. ГPП
 12,XTA,L0307-B.HAЧ.BЫB.
 ,ASN,64-15.
 12,ATX,L0325-B.
 13,XTA,L0623-B.C11
 14,033,0154B.ПYCK ПИ80
  ,XTA,TYP/PL
  14,UTC,
  14,AOX,BIT16
  ,ATX,TYP/PL
  L0242:13,UTC,-B
  15,VTM,L0110
  REPEAT2K:,BSS,
  12,XTA,L0325-B
 ,ASN,64+15.
  ,AAX,C77777
 12,ATX,L0307-B.AHK B AHП
 ,ASN,64-15.
 12,AOX,L0307-B.
 12,ATX,L0325-B.ДBA AДPECA
  ,AAX,C77777
  ,AEX,C77777
 12,ARX,L0312-B.
 ,ARX,BIT1.
 ,ASN,64+15.
 12,ATX,L0332-B.AK-AT-1 B ПP ПPOП.ПYCT.K
  ,XTA,
  12,ATX,L0321-B
  15,UJ,
 L0110:12,MTJ,15.
 12,WTC,L0321-B.
 15,UTM,.AДPEC CTP.БYФEPA
 12,XTA,L0332-B.
 13,UZA,L0114-B.HYЖHЫ ПYCT.K.
 12,WTC,L0307-B.
 ,XTA,.
 13,AAX,L0653-B.
 L0114:15,ATX,L1100-B.
 12,XTA,L0332-B.
 13,UZA,L0665-B.HYЖEH ПPOПYCK ПYCT.K.
 12,WTC,L0307-B.
 ,XTA,1.
 L0665:13,AAX,L0653-B.
 15,ATX,L1102-B.
C
C      BOCCTAHOBЛEHИE I11,I12 И BOЗBPAT ИЗ ПPEPЫBAHИЯ
C
  L0615:,BSS,
  13,XTA,SAVE11-B
 ,ATI,11.
  13,XTA,SAVE12-B
 ,ATI,12.
 ,UJ,RETURN.
C
C       ИЗ CИ ПPOБИBKИ ИЛИ KOHTPOЛ5
C
  CИПEPФ1:,BSS,
 12,XTA,L0323-B.
 13,UZA,L0626-B.HE HYЖHA COPTИPOBKA
 ,XTA,.
 12,ATX,L0332-B.ПPИЗH.ПPOП.ПYCT.K.
 L0626:12,MTJ,15.
 12,WTC,L0321-B.
 15,UTM,.AДPEC CTP. БYФEPA
 15,XTA,L1100-B.
 11,033,0162B.
 ,ATI,.
 ,ASN,64+20.
 11,033,0163B.
 ,ATI,.
 15,XTA,L1102-B.
 11,033,0160B.
 ,ATI,.
 ,ASN,64+20.
 11,033,0161B.ПEPФ. 80KOЛ. CTP. ПK
 ,ATI,.
 12,XTA,L0321-B.
 ,ARX,BIT3.CЧ.ИЗM.AДPECA CTP.
 12,ATX,L0321-B.
 13,AEX,L0157-B.
 13,U1A,L0673-B.БYФEP BЫB. HEЗAПOЛHEH
 12,ATX,L0321-B.0 B AДPEC CTP БYФEPA
 12,XTA,L0323-B.
 L0250:12,AOX,L0335-B.
 13,U1A,L0106-B.
 L0125:12,XTA,L0307-B.
  ,AEX,C77777
 12,ARX,L0312-B.AK-AT
 ,ASN,64+15.
 13,U1A,L0127-B.AT MEHЬШE AK
 12,ATX,L0332-B.ПPИЗH.ПPOП.ПYCT.K.
 L0127:12,XTA,L0307-B.
 ,ARX,BIT2.
 12,ATX,L0307-B.YBEЛ.AT.BЫB.
 L0106:12,XTA,L0321-B.A CTP. БYФEPA
 13,UZA,L0137-B.
 13,AEX,L0156-B.
  13,U1A,L0110-B
 L0137:,XTA,BIT1.
 14,033,0154B.ПYCK ПEPФOPATOPA
 ,XTA,BIT1.CЧETЧИK
 14,ARX,CTATПИ.ПEPФ. П/K
 14,ATX,CTATПИ.B CTATИCTИKY
  13,UJ,L0110-B
  CИKOHTP:,ENTRY,
  14,XTA,BIT18
  ,AOX,COMPIR
  ,ATX,COMPIR
  ,EXT,34B
  13,UTC,-B
  15,VJM,L0065
 L0462:14,XTA,L0304.
 ,ASN,64+42.
  ,ATI,15
 ,XTA,OUTJOBSC.
  15,AAX,BITS
 13,U1A,L0200-B.
 ,XTA,7.
 14,AAX,BIT44.
 13,UZA,L0176-B.ПИ OTKPЫT
  12,VTM,
  13,UJ,ПEPEXOД-B
  L0200:,XTA,FULWOR
  14,UTC,
  14,AEX,BIT16
  ,AAX,TYP/PL
  ,ATX,TYP/PL
  ,XTA,FULWOR
  14,UTC,
  14,AEX,BIT16
  13,AAX,ПЛCДOX -B
  13,ATX,ПЛCДOX -B
  14,XTA,BIT18
  14,AOX,BIT20
  L0561:13,MTJ,11
  ,CALL,CLOPIR
  11,MTJ,13
  14,XTA,L0304
  ,ASN,64+42
  ,ATI,15
 L0564:15,XTA,BITS.
 ,AOX,RDSCAL.
 ,ATX,RDSCAL.
  13,XTA,SAVE11-B
 ,ATI,11.
  13,XTA,SAVE12-B
 ,ATI,12.
 ,UJ,NEWTA.
C
C          CИ KOHTPOЛЯ ПИ80
C
 L0176:12,XTA,L0312-B.AK
 13,ARX,L0156-B.+60
  ,AEX,C77777.ИHBEPCИЯ
 12,ARX,L0307-B.
 ,ASN,64+15.
 13,UZA,L0160-B.ПPOШЛИ 2 K.ПOCLE KOHЦA
 12,XTA,L0323-B.
 12,AOX,L0335-B.
 13,U1A,L0160-B.
 13,UJ,L0200-B.HA OTKP. ЗAДAЧИ MAT.
  L0160:,BSS,
 12,MTJ,15.
 12,XTA,L0321-B.
 12,WTC,L0321-B.
 15,UTM,-52.AДP. CTPOKИ БYФEPA
  ,ARX,C14
 ,ASN,64+6.
 13,U1A,L0165-B.HE 1Я I/2 БYФ.
 15,UTM,96.AДP.CTP.KOHTP.
 L0165:,BSS,.
C.........   ЧTEHИE ПPOБИTOЙ CTPOKИ (OБP.KOД)
 11,EXT,4163B.PP 80-61
 ,ASN,64-20.
  13,ATX,CTPK - B
 11,EXT,4162B.PP 60-41
  13,AOX,CTPK - B
 13,AEX,L0653-B.ИHBEPCИЯ
  13,ATX,CTPK - B
 11,EXT,4161B.PP 40-21
 ,ASN,64-20.
  13,ATX,CTPK1 - B
 11,EXT,4160B.PP 20-1
  13,AOX,CTPK1 - B
 13,AEX,L0653-B.ИHBEPCИЯ
  13,ATX,CTPK1 - B.ECTЬ HCBП
 15,AEX,L1102-B.ПO PP 40-1
 13,UIA,L0144-B. - ДA
  13,XTA,CTPK - B.ECTЬ HCBП
 15,AEX,L1100-B.ПO PP 80-41
 L0144:13,UZA,L0251-B. - HET
 12,XTA,L0335-B.OДHOKPATHO
 13,UIA,L0251-B.B CTATИCTИKY
 15,XTA,L1100-B.ПEPEПИCЬ
  13,ATX,CTPП - B.CTPOKИ
 15,XTA,L1102-B.ЭTAЛOHA
  13,ATX,CTPП1 - B
 ,XTA,BIT25.CЧETЧИK
 14,ARX,CTATПИ.БPAKA
 14,ATX,CTATПИ.B CTATИCTИKY
 12,ATX,L0335-B.ПPИЗHAK HCBП
 ,ITA,14.HOMEP ПИ
 ,ASN,64-15. B ИC
 13,AOX,ИC ПИ-B.CTATИCTИKИ
 13,ATX,L0334-B.
  ,ITA,13
  ,ASN,64-24
  13,ARX,L0334 - B
  13,ATX,L0334 - B
 ,ITA,13.ЭTAЛOH И
 13,ARX,L0334-B.ПPOБИTOE
 ,UJ,STATIST.B CTATИCTИKY
 ИC ПИ:4,Z04,CTPП-B.ИHФ.CЛOBO
 ,Z00,L0251-B.K CTATИCTИKE
 L0251:12,XTA,L0321-B.
 13,UZA,L0253-B.
 13,AEX,L0156-B.
 13,U1A,L0615-B.K. HE ДOПEЧATAHA
 L0253:12,XTA,L0335-B.
 13,UZA,L0237-B.HE БЫЛO OШ.
  ПИГOT1:,BSS,
  ,XTA,FULWOR
  13,AEX,NRBIT-B
  13,AAX,ПЛCДOX -B
  13,ATX,ПЛCДOX -B
 ,XTA,BIT3.
 12,ATX,L0323-B.CЧ.COPTИPOBKИ
 15,VTM,-96.
 ,XTA,.
 L0426:15,UTC,96.
 12,ATX,L1100-B.ЧИCTKA БYФEPA
 15,UTM,2.
 13,UTC,.
 15,V1M,L0426-B.
  13,ATX,PCCOUNT-B
 L0237:12,ATX,L0335-B.0 B OШ.
 12,XTA,L0323-B.
 13,U1A,L0660-B.HYЖHA COPTИPOBKA
 12,XTA,L0325-B.
 ,ASN,64-15.
 12,AOX,L0307-B.
 12,ATX,L0325-B.AHK=AHП,AHП=AT
 ,XTA,BIT1.ПYCK ПИ
 L0241:14,033,0154B.OBY YПP.ПИ80
 13,UJ,L0615-B.
C
C       BЫBOД HA ПEPФOЛEHTY
C
 CИ ПЛ:,ENTRY,.
  13,UTC,
  15,VTM,CИ ПЛ-B
C
C...   ПPИKAЗ  PTAPE.N
C     OCTAHOBKA П/ЛEHTЫ ИЛИ
C     ПPOДOЛЖEHИE ПEPФOPAЦИИ
C
  CH101:,XTA,101B
  13,AEX,DIRPL-B
  15,U1A,
  13,XTA,MASP-B
  13,U1A,STARTP-B
C...   OCTAHOBKA (ДЛЯ CMEHЫ ЛEHTЫ)
  ,XTA,BIT10
  14,EXT,170B.BЫKЛ.ДBИГ.
  14,XTA,BIT16
  13,ATX,MASP-B
  ,AEX,FULWOR
  ,AAX,COMPIR.CHЯTЬ MACKY
 13,UJ,WRMASK-B
C...   ПPOДOЛЖИTЬ ПEPФOPAЦИЮ
  STARTP:14,VTM,
  ,AAX,BIT16
  13,U1A,STARTP1-B
  14,VTM,1
  STARTP1:13,XTA,MOTOP-B
  13,U1A,STARTP2-B
  ,XTA,BIT9
  14,EXT,170B.BKЛ.ДBИГ.
  STARTP2:,ARX,BIT1
  13,ATX,MOTOP-B
  ,AAX,C77
  ,U1A,RETURN.ЗAДEPЖKA
  13,ATX,MASP-B
  ,XTA,BIT37
  ,AOX,COMMIR
  ,ATX,COMMIR
  ,MOD,36B.ГPП-37
  14,XTA,BIT16
  ,AOX,COMPIR
  15,VTM,
  WRMASK:,ATX,COMPIR
  ,EXT,34B
  ,XTA,
  13,ATX,MOTOP-B
  ,ATX,101B
  15,VIM,RETURN
C---
  CИ ПЛ:,BSS,
  13,XTA,ПЛ CДOX-B
  14,AAX,BIT24
  13,AEX,ПЛ CДOX-B
  13,ATX,ПЛ CДOX-B
  ,ITA,12
  13,ATX,SAVE12-B
 ,ITA,11.
  13,ATX,SAVE11-B
 13,MTJ,12.
 14,J+M,12.
 12,XTA,L0723-B.
 ,ATI,11.
 ,XTA,7.
 14,AAX,BIT42.
  13,UZA,L0541-B
  12,VTM,2
  13,UJ,ПEPEXOД-B
 L0541:14,033,4170B.KOHTP.ПPEД.CИMBOЛA
  12,AEX,L0720-B
  ,AAX,C377
  13,UZA,L0437-B
  ,XTA,TYP/PL
  14,AAX,BIT48
  13,U1A,L0437-B
 12,XTA,L0720-B.
 ,ASN,64-8.
 12,ATX,L0720-B.
 ,ASN,64-32.
 14,033,170B.ПEPФ. CИMBOЛA OTMEHЫ
  L0454:12,VTM,2.ПЛ.
  13,UIA,L0615-B
  ПEPEXOД:,BSS,
 14,MTJ,15.
 13,UTC,.
  14,VTM,BПИ-B
  12,J+M,14
  12,J+M,14
  12,UTC,
  15,WTC,L0304
  11,VTM,.AИПЗ.
 ,ITA,14.
 14,VJM,TTPRINT.
 15,MTJ,14.
 ,XTA,C571.ПOBTOP. ПOPЦИИ HA ДP. ПЛ
  11,ATX,3
  ,XTA,C2013
  11,ATX,5
  AБЗAЦ:13,UTC,-B
  12,VZM,L0200
  BЫKMOT:,XTA,BIT10
  14,EXT,170B
  L0556:,BSS,
   ,XTA,FULWOR
  14,AEX,BIT48
  14,AEX,BIT42
  14,AEX,BIT12
  13,AAX,ПЛ CДOX -B
  13,ATX,ПЛ CДOX -B
  ,XTA,TYP/PL
  14,AEX,BIT12
  ,ATX,TYP/PL
  14,XTA,BIT16
  14,UTM,2
 13,UJ,L0561-B.
  L0437:,XTA,TYP/PL
  14,AAX,BIT48
  13,UZA,ПЛ20-B
  13,XTA,ПЛ CДOX-B
  14,AAX,BIT42
  13,U1A,BЫKMOT-B
  NO REPEAT:12,ATX,L0720-B
  13,UJ,L0447-B
  ПЛ20:12,XTA,L0720-B
 ,ASN,64-8.
 12,ATX,L0720-B.ЯЧEЙKИ BЫД. CИMBOЛB
 ,ASN,64+8.
 ,AAX,C377.
  13,U1A,L0447-B
  12,XTA,L0720-B
  ,ASN,64+24
  ,AAX,C377
  13,UZA,L0454-B
  12,XTA,L0720-B
  ,ASN,64+16
  ,AAX,C377
  13,UZA,L0454-B
 L0444:12,AOX,L0720-B
 12,ATX,L0720-B.ЯЧ.BЫД. CИMBOЛOB
  ,XTA,TYP/PL
  14,AAX,BIT48
  13,UZA,CH*READY-B
C----
C-------------------------------
  13,UTC,.******
  11,V1M,CH*READY-B.******
  12,XTA,L0704-B.******
  12,AEX,L0707-B.******
  13,U1A,CH*READY-B.******
  13,XTA,ПЛ CДOX-B
  14,AOX,BIT42
  13,ATX,ПЛ CДOX-B
  ,XTA,TYP/PL
  14,APX,BIT42
  ,ASN,64+38
  12,AOX,L0720-B.******
  12,ATX,L0720-B.******
C------------------------------
C----
  CH*READY:,BSS,
C  OПPOC ГOTOBHOCTИ ПЛ
  14,XTA,BIT12
  13,ATX,NRBIT-B
  12,VTM,2.ПЛ.
  ПИГOT:,BSS,
  OПPOC:,BSS,
  ,EXT,4102B
  13,AAX,NRBIT-B
  13,UZA,PROPRI-B
  13,XTA,ПЛCДOX-B
  13,AOX,NRBIT-B
  13,AEX,NRBIT-B
  13,ATX,ПЛCДOX-B
  13,UJ,ПPOBЫ-B
  ПИCДOX:,BSS,
  NRD*PL:,BSS,
  12,MTJ,11
  13,UTC,-B
  11,UTM,PCCOUNT
  11,XTA,
  ,ARX,BIT1
  11,ATX,
  ,ASN,64+6
  13,UZA,L0615-B
  13,UTC,-B
  12,VZM,PROPRI
C ФЛAГ - HAДO ПEPEБИTЬ ПOCЛEДHИЙ CИMBOЛ
  13,XTA,ПЛ CДOX -B
  14,APX,BIT24
  13,AOX,ПЛ CДOX -B
  13,ATX,ПЛ CДOX -B
  PROPRI:,BSS,
C  БЫЛA ЛИ TT-ПИЧATЬ
  14,MTJ,11
  13,XTA,ПЛCДOX-B
  13,AAX,NRBIT-B
  13,UIA,ПPOBЫ-B.БЫЛA
C  ПEЧATЬ: ''BЫKЛ ПЛ''
  12,MTJ,14
  12,J+M,14
  13,UTC,-B
  14,UTM,BПИ
  ,ITA,11
  13,AOX,=6H     0-B
  ,ASN,64-32
  14,ATX,1
  ,ITA,14
  14,VJM,TTPRINT
  13,XTA,NRBIT-B
  13,AOX,ПЛCДOX-B
  13,ATX,ПЛCДOX-B
  11,MTJ,14
C  HE HAДO ЛИ BЫБPOCИTЬ ЗAДAЧY
  ПPOBЫ:12,UTC,
  14,XTA,L0304
  ,ASN,64+42
  ,ATI,11
  ,XTA,OUTJOBSC
  11,AAX,BITS
  13,U1A,AБЗAЦ-B
  11,XTA,*YCЫ
  ,ASN,64+15
  ,ARX,B6
  ,ASN,64-6
  13,AOX,CNEWL - B.TEPMИHATOP + N
  ,AEX,101B
  ,AAX,C7777
  ,UZA,AБЗAЦ
C
  13,XTA,ПЛCДOX-B
  13,AAX,NRBIT-B
  13,UIA,L0615-B
  13,UTC,-B
  12,VZM,L0615
  13,MTJ,12
  14,J+M,12
  12,XTA,L0723-B
  ,ATI,11
  ПEPC:,BSS,
  13,XTA,ПЛ CДOX-B
  14,AOX,BIT24
  13,ATX,ПЛ CДOX-B
  ,XTA,
  13,ATX,PLCOUNT-B
  12,XTA,L0720-B
 14,033,0170B.ПEPФ.CИMBOЛA.
 ,ASN,64+8.BЫДEЛEHИE CИMBOЛA
 ,AAX,C377.
  13,U1A,NEXT SYM -B
  ,XTA,TYP/PL
  14,AAX,BIT48
  13,UZA,L0615-B
  ,XTA,TYP/PL
  14,AAX,BIT42
  14,AEX,BIT42
  13,AAX,ПЛ CДOX-B
  13,U1A,L0615-B
  NEXT SYM:,BSS,
  13,XTA,ПЛ CДOX -B
  14,AAX,BIT48.БЫЛ ПOBTOP
  13,UZA,NS*1-B.-HET
  13,AEX,ПЛ CДOX -B
  13,ATX,ПЛ CДOX -B
  13,UJ,L0615-B
  NS*1:,BSS,
 13,UTC,.
  11,VZM,ALLREADY-B.BCE CЛOBO BЫДAHO
  11,UTM,-8
  13,UJ,END///-B
  ALLREADY:,BSS,
 12,XTA,L0704-B.
 12,AEX,L0707-B.
 13,UZA,L0556-B.BECЬ MACCИB BЫДAH.
 12,XTA,L0704-B.
 ,ARX,BIT1.
 12,ATX,L0704-B.YBEЛ.AT
 12,WTC,L0704-B.
 ,XTA,.
 12,ATX,L0715-B.OЧEP.CЛOBO B БYФEP
 11,VTM,50B.
  END///:,BSS,
 ,ITA,11.
 12,ATX,L0723-B.
 13,UJ,L0615-B.
  L0447:,XTA,TYP/PL
  14,AAX,BIT48
  ,ASN,64+40
  ,ATI,15
  12,XTA,L0715-B
  11,ASN,64
  ,AAX,C377
  13,UTC,-B
  15,V1M,NO INVER
  ,AEX,C377
  NO INVER:,BSS,
  13,UJ,L0444-B
C
C     HYЖHA COPTИPOBKA
C
 L0660:,ASN,64+1.
 12,ATX,L0323-B.CЧET COPTИPOBOK
 13,UZA,L0242-B.
 13,XTA,L0623-B.COPTИPOBKA,ПYCK
 13,UJ,L0241-B.HA COPTИPOBKY
 L0673:13,AEX,L0056-B.
 13,U1A,L0125-B.
 12,XTA,L0323-B.
 13,UJ,L0250-B.
    OTBЫB:,BSS,
   OTKAЗ:,BSS,
 ,WTC,Г Y C.
 ,WTC,M75.
 ,XTA,TPHYS.
 ,AEX,FIXBIT.
 ,WTC,Г Y C.
 ,WTC,M75.
 ,ATX,TPHYS.PACФИKCAЦИЯ ЛИCTA
    *OTK:,BSS,
 ,WTC,ГYC
 ,XTA,M74
 ,ATI,13
 ,ASN,64+15
 ,ATI,14
 ,ASN,64+15
 ,ATI,15
     ,ITA,32B
     ,ATI,33B
   ,WTC,ГYC
   ,XTA,BUFS27
    ,ATI,27B
 14,VTM,NRES71.
 ,ITA,14.
 ,ASN,64-24.
 ,ATX,SAVAR.
 14,VTM,NEWTA.
 ,ITA,14.
 ,AOX,SAVAR.
 ,UJ,NRESOFF.OTKAЗ OT HEPEЗ. И K MAT.
  DIRPL:,TEXT,8H PTAPE'10'N
  MOTOP:,LOG,
  MASP:,LOG,
 HПИ:,ISO,6HHET ПИ
 ,OCT,.
 BПИ:,ISO,6HBЫK.ПИ
 ,OCT,.
 HПЛ:,ISO,6HHET ПЛ
 ,OCT,.
 BПЛ:,ISO,6HBЫK.ПЛ
 ,OCT,.
 NP:,BSS,1.
 INFW:,BSS,.
 L0300:,BSS,1.ИHФ. CЛOBO
  ABEG:,BSS,
 L0302:,BSS,1.
  AEND:,BSS,1
 L0307:,BSS,2.AHФ
  L0704:,BSS,2
 L0312:,BSS,2.AKФ
  L0707:,BSS,2
 L0315:,BSS,1.BP. ЗAДEPЖKA ПИ
 L0316:,BSS,1.
  L0712:,BSS,2
  SAVE12:,BSS,1
  SAVE11:,BSS,1
 L0321:,BSS,2.AДPEC CTP. БYФEPA
 L0323:,BSS,2.ПPИЗHAK COPTИPOBKИ
 L0325:,BSS,2.
 L0332:,BSS,2.ПPИЗHAK ПPOП.ПYCT.K.
 L0334:,BSS,1.
 L0335:,BSS,2.
  L0715:,BSS,2.БYФEP ПЛ
  L0720:,BSS,2..ЯЧ.BЫД.CИMB.
  L0723:,BSS,2.CЧ.CИMB.B ЯЧ.
 L0775:,BSS,1.TИП YCTPOЙCTBA
 L1100:,BSS,2.БYФEP ПK.
 L1102:,BSS,94.ПPOДOЛЖ. БYФEPA ПK
 CTP2:,REAL,2..
 C15:,LOG,15.
 C17:,BSS,.
 L0052:,LOG,17.
 L0056:,LOG,120.
 L0156:,LOG,60.
 L0157:,LOG,140.
  CNEWL:,TEXT,8H       N
  ПЛCДOX:,LOG,
 L0220:,OCT,77777777 77777776.
 L0623:,LOG,11.
      *ПФ:,OCT,774
 L0653:,OCT,00177777 77777777.
C
C--- PCCOUNT И PLCOUNT ДOЛЖHЫ
C--- CTOЯTЬ ЧEPEЗ OДИH AДPEC.
C
  PCCOUNT:,LOG,
  NRBIT  :,LOG,
  PLCOUNT:,LOG,
  CTPП :,BSS,1
  CTPП1:,BSS,1
  CTPK :,BSS,1
  CTPK1:,BSS,1
 ,END,.
 ERRMACRO:,NAME,.
C      PEДAKЦИЯ OT 20.02.76
C    (Л.KAMИHCKИЙ,И.CИЛИH,A.ГYCEB)
  * И П Д :LC,BLOCK,XNF,XNFM(5),XNCM(3),Ш/FULL
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
  SCDEBUG:,EQU,*ИПД+71B
 DEBS33:,EQU,565B
  SCJOTЛ:,EQU,564B
 DISREG:,LC,1.
 C3:,LC,1.
 C77777:,LC,1.
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,PPIR,MPPIR,M1RDSC,STCLTA
  *677:B,BLOCK,BITS
  ,CONT,BIT48,BIT47,BIT46,BIT45
  ,CONT,BIT44,BIT43,BIT42,BIT41
  ,CONT,BIT40,BIT39,BIT38,BIT37
  ,CONT,BIT36,BIT35,BIT34,BIT33
  ,CONT,BIT32,BIT31,BIT30,BIT29
  ,CONT,BIT28,BIT27,BIT26,BIT25
  ,CONT,BIT24,BIT23,BIT22,BIT21
  ,CONT,BIT20,BIT19,BIT18,BIT17
  ,CONT,BIT16,BIT15,BIT14,BIT13
  ,CONT,BIT12,BIT11,BIT10,BIT9
  ,CONT,BIT8 ,BIT7 ,BIT6 ,BIT5
  ,CONT,BIT4 ,BIT3 ,BIT2 ,BIT1
 S34:,EQU,26B.
 S35:,EQU,27B.
 COPYS32:,EQU,46B.
 COPYI14:,EQU,47B.
 RETM67:,EQU,107B.
 M:,EQU,100B.
 REGSCAL:,EQU,M.
 I10:,EQU,12
  NRERR:,SUBP,
  NRESCALL:,SUBP,
 NRESOFF:,SUBP,
  NRERROR:,SUBP,
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR,SAVS16
 C14:,LC,1
 *SCAL71:LC,BLOCK,(3),SCAL67
 FLERBUZ:,EQU,XNF+62B
 ERRSC:,EQU,XNF+64B
 БYФИПЗ/M:,EQU,535B.AДPEC B ИПЗ
 *615:B,BLOCK,SSUM(16),SWITCH
 TOЛKAЙ:,SUBP,
 RETURN:,SUBP,
 CLANEWTA:,SUBP,
 FULSAV:,SUBP,
 C37:,LC,1
 FULWOR:,LC,1
 SELECT:,SUBP,.
 MACRO74:,SUBP,.
C
 ERRPRI:,ENTRY,.
 ERRPRI:,BSS,
 ,XTA,BITJ
 ,AOX,ERRSC
 ,ATX,ERRSC
 ,WTC,ГYC
  13,VTM,
  15,CALL,MICROSAV
  SAVSAVAR:,XTA,SAVAR
  13,MTJ,15
  15,ATX,-3
  ,XTA,NRERINF
  ,ATX,SAVAR
  ,ITA,14
  ,ATX,SAVI14
  ,UJ,NRESCALL+2
  NRERINF:,Z00,NRERROR
  ,Z00,*+1
  ,ATI,13
  13,UJ,
C    --------------------
 ERRNRES:,ENTRY,
C    --------------------
C    OTKAЗ OT HEPEЗИДEHTA,YXOД K ERRMACRO.
C    MAЛOE YПPЯTЫBAHИE ДOЛЖHO БЫTЬ YЖE
C    CДEЛAHO. HA CYMMATOPE ДOЛЖHO БЫTЬ
C    CЛOBO:
C           ,Z00,POINTER HEPEЗИДEHTA
C           ,Z00,N OШИБKИ (N<1000B)
C
   :   ,24,2003B
 ,WTC,Г Y C
 ,ATX,-3
 ,ATX,SAVAR
 ,AEX,INFRET
 ,AAX,C77777
 ,AEX,SAVAR
 ,ATX,SAVAR
 INFRET:,UJ,NRESOFF+2
 ,UJ,*+1
 ,WTC,Г Y C
 ,WTC,-3
 14,VTM,
C    --------------------
 ERREXT:,ENTRY,
C    --------------------
C    OШИБKA ЭKCTPAKOДA
 ,ITA,32B
  ,ARX,C77777
  ,ATI,33B
  ,UJ,ERRPRI
C    -------------------------
 OCTAHOB:,ENTRY,
C     ------------------
C  И13 - AДPEC ИПЗ
C  И14-TИП OCTAHOBA
C     0 - OCT.ПO ЗAП.
C     1 - OCT.ПO ЧTEH.
C     2 - OCT.ПO NK
C     3 - ПPOKPYTKA
  13,XTA,REGSCAL
  ,AAX,BIT18
  ,U1A,OT
 15,CALL,MICROSAV
 ,ITA,27B
 ,AAX,C14
 ,UZA,IFMAT2.PEЖИM MATEMATИKA
 14,V1M,TOЛKAЙ.OCT.ПO ЧTEH. B PEЖ.ЭKCTPAKOДA
C                  .ЗAП.B PEЖ.ДИCП.
 13,XTA,RETM67
 ,AAX,BIT24
 ,UZA,TOЛKAЙ.ПEЧATЬ HE HYЖHA
  ,UJ,SAVSAVAR
 IFMAT2:,BSS,.PEЖ.MAT.
 13,XTA,RETM67
  ,ATI,33B
 ,AAX,BIT24
  ,U1A,SAVSAVAR
 ,MTJ,27B
 ,UJ,RETURN.ПOД Э67
C          PEДAKЦИЯ O.>OMИДЗE
  OT:,BSS,
  ,XTA,BIT45
  14,UTM,-2
  14,VZM,OБЩEE
  ,ITA,33B
  13,ATX,DEBS33
  ,XTA,BIT44
  OБЩEE:,BSS,
 13,AOX,SCJOTЛ
  13,ATX,SCJOTЛ
  ,XTA,BITJ
  ,AOX,SCDEBUG
  ,ATX,SCDEBUG
  ,XTA,SCAL67
  ,AAX,ZBITJ
  ,ATX,SCAL67
    ,ITA,27B
  ,AAX,C14
  ,UZA,RETURN
 14,V1M,TOЛKAЙ
  ,UJ,RETURN
  ADRERR:,ENTRY,
C.. BXOД B OTЛAДЧИK OT ИMEHИ ЗAДAЧИ
C   ИHИЦИИPYETCЯ ИЗ 'MULTITYP'.
C   B  SWITCH - PEЖИM PAБOTЫ
  ,WTC,ГYC
  13,VTM,
  13,XTA,SCJOTЛ
  ,ANX,
  13,ATX,SWITCH
  15,CALL,MICROSAV
  ,CALL,FULSAV
  ,XTA,SCDEBUG
  ,AAX,ZBITJ
  ,ATX,SCDEBUG
  ,WTC,ГYC
  13,VTM,
  ,XTA,FLERBUZ
 ,AOX,BITJ
  ,ATX,FLERBUZ
 13,UTC,
 15,VTM,SSUM
 14,VTM,1-12
 ,XTA,SAVAC
 SAV:13,UTC,
 14,XTS,I10
 14,VLM,SAV
 13,XTS,M+3
 13,XTS,M+4
 13,XTS,M+5
    ,XTS,INFCALL
  ,UJ,NRESCALL
  INFCALL:,Z00,NRERR
         ,Z00,*+1
  ,ATI,12
 13,MTJ,11
 13,UTC,
 15,VTM,БYФИПЗ/M
  12,UJ,
 ,END,.
  NRERRMAC:,NAME,
C      PEДAKЦИЯ OT 20.02.76
C    (Л.KAMИHCKИЙ,И.CИЛИH,A.ГYCEB)
  * И П Д :LC,BLOCK,XNF,XNFM(5),XNCM(3),Ш/FULL
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
 БЫЛ*64:,EQU,*ИПД+55B
  SCOUT   :,EQU,*ИПД+56B
  SCEM*64 :,EQU,*ИПД+61B
  БЛOKAЦПY:,EQU,*ИПД+66B
  SCDEBUG:,EQU,*ИПД+71B
 DEBS33:,EQU,565B
  SCJOTЛ:,EQU,564B
 DISREG:,LC,1.
 C3:,LC,1.
 C77777:,LC,1.
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR,COMPIR,PPIR,MPPIR,M1RDSC,STCLTA
  *677:B,BLOCK,BITS
  ,CONT,BIT48,BIT47,BIT46,BIT45
  ,CONT,BIT44,BIT43,BIT42,BIT41
  ,CONT,BIT40,BIT39,BIT38,BIT37
  ,CONT,BIT36,BIT35,BIT34,BIT33
  ,CONT,BIT32,BIT31,BIT30,BIT29
  ,CONT,BIT28,BIT27,BIT26,BIT25
  ,CONT,BIT24,BIT23,BIT22,BIT21
  ,CONT,BIT20,BIT19,BIT18,BIT17
  ,CONT,BIT16,BIT15,BIT14,BIT13
  ,CONT,BIT12,BIT11,BIT10,BIT9
  ,CONT,BIT8 ,BIT7 ,BIT6 ,BIT5
  ,CONT,BIT4 ,BIT3 ,BIT2 ,BIT1
 S33:,EQU,3.
 S32:,EQU,4.
 S27:,EQU,5.
 S34:,EQU,26B.
 S35:,EQU,27B.
 COPYS32:,EQU,46B.
 COPYI14:,EQU,47B.
 RETM67:,EQU,107B.
 M:,EQU,100B.
 REGSCAL:,EQU,M.
 OШBHYПP:,EQU,M+1.
 BITININ:,EQU,BIT43.
  TLIMS:,EQU,84
 C1:,EQU,757B.
  I12:,EQU,12B
  NRERROR:,SUBP,
  NRESCALL:,SUBP,
  NRESOFF:,SUBP,
 SMASAV:LC,BLOCK,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13,SAVMIR,SAVS16
 C14:,LC,1
 B48/31:,LC,1
 *SCAL71:LC,BLOCK,(3),SCAL67
 FLERBUZ:,EQU,XNF+62B
 ERRSC:,EQU,XNF+64B
  БYФИПЗ/C:,EQU,131B
 БYФИПЗ/M:,EQU,535B.AДPEC B ИПЗ
 SAVI16:,EQU,SAVS16
 S13/14:,EQU,45B
 TOЛKAЙ:,SUBP,
 COPYS33:,EQU,M+6
 KOM:,EQU,14
 RETURN:,SUBP,
 CLANEWTA:,SUBP,
 FULSAV:,SUBP,
 C37:,LC,1
 FULWOR:,LC,1
 SELECT:,SUBP,.
 MACRO74:,SUBP,.
C
  BEGIN:13,REL,BEGIN
C*
  ,WTC,ГYC
  15,VTM,
C*   И.P.14 - HOMEP OШИБKИ ( <1000B )
C*            ИЛИ AДPEC ДИAГHOCTИKИ.
C*
C   B PEЖИME MAT.ПOPTИM S32,A B PEЖ.Э - S33
 15,XTA,S13/14
 ,AAX,B48/31
 15,ATX,S13/14
 ,ITA,14
 15,AOX,S13/14
 15,ATX,S13/14
C--- BOCCTAHOBЛEHИE ИПД ПEPEД FULSAV
  15,XTA,COPYS33
  ,ATI,33B
  ,ASN,64+15
  ,ATI,27B
  ,ASN,64+26
  ,ATX,SAVSR
  ,ASN,64-41
  ,AOX,SAVSR
  ,ATX,SAVSR
  15,XTA,COPYS32
  ,ATI,32B
  15,XTA,COPYI14
  ,ATX,SAVI14
  ,ASN,64+15
  ,ATX,SAVS16
  15,XTA,-3
  ,ATX,SAVAR
C   YПAKOBKA ДЛЯ ПEЧATИ
 ,ITA,27B
 ,AAX,C14
 ,UZA,IFMAT
 ,ITA,32B
 ,ARX,C77777
 ,ATI,33B
 IFMAT:,BSS,
 15,XTA,S35
 ,ATI,32B
  13,MTJ,14
  14,REL,BEGIN.*****
  15,UTM,БYФИПЗ/C
  ,XTA,Ш/FULL
  ,AAX,BITJ
  ,UZA,BUF/IS
  15,UTM,БYФИПЗ/M - БYФИПЗ/C
 BUF/IS:,XTA,BITJ
  ,AOX,FLERBUZ
  ,ATX,FLERBUZ
  13,VJM,FULSAV+1
C
C...  ПPИ ABAPИЯX B *WRBF CЛEДYET
C     БЛOKИPOBATЬ BCE BOЗMOЖHOCTИ
C     ПOBTOPHOГO BXOДA TYДA.
C
  ,XTA,BITJ
  ,AAX,SCEM*64
  ,AOX,SCOUT
  ,ATX,SCOUT
 ,AAX,BITJ.!!!
  ,AOX,БЛOKAЦПY
  ,ATX,БЛOKAЦПY
 ,XTA,6.ABOCT B ЗAДAЧE,
 ,APX,BIT5.HE ПOДABABШEЙ
 ,AUX,BITJ.PAHEE Э64,
 ,AOX,БЫЛ*64. ПEЧATAETCЯ
 ,AEX,BITJ.TOЛЬKO ПPИ
 ,AAX,BITJ.HAЖATOM
 ,AOX,БЛOKAЦПY.5-M PAЗPЯДE
 ,ATX,БЛOKAЦПY.6-ГO T.P.
 15,UTM,-22
 ,WTC,ГYC
 ,XTA,S13/14
 ,ATI,13
  14,MTJ,12
  12,REL,BEGIN.*****
 14,VTM,2013B
 14,MTJ,27B
 ,PRINT,STR2.PAЗMETKA STR3
 ,PRINT,STR3.ПEЧATЬ БYФEPA(ИПЗ)
 15,XTA,S33
 ,ASN,64+10
 ,AAX,C37
 ,ATI,14
 ,WTC,ГYC
 14,XTA,30B
 ,ASN,64+30
 ,U1A,HEЧYЖOЙ
 ,XTA,FULWOR
 ,UJ,TOKOM
 HEЧYЖOЙ:,BSS,
 15,XTA,S33
 ,ATI,14
   :   ,24,2000B
 14,XTA,.CЧИT.KOMAHДЫ
   :   ,24,2003B
 14,VTM,2013B
 14,MTJ,27B
 TOKOM:,BSS,
 15,ATX,KOM
 15,XTA,S27
 ,AAX,BIT9
 ,ASN,64+8
 ,ATI,14
 14,XTA,TЛEB
 15,ATX,KOM-1
 ,XTA,TSTR4
 15,ATX,KOM-3
 ,XTA,TSTR4+1
 15,ATX,KOM-2
C--- ИHФOPMAЦИЯ OБ OШИБKE HA И.P.13
C    ЗДECЬ Д.Б. PAЗБOP: TEKCT ИЛИ HOMEP
  ,ITA,13
  ,ASN,64+9
  ,U1A,TEXTOШ
 ,XTA,SC/IN
 13,APX,BIT48
 ,AUX,BITININ
 ,AEX,FULWOR
 ,WTC,ГYC
 ,AAX,REGSCAL
 ,WTC,ГYC
 ,ATX,REGSCAL
  13,J+M,13
  13,UTM,DIAGN
  TEXTOШ:,BSS,
 13,XTA,
 15,ATX,KOM+1
 13,XTA,1
 15,ATX,KOM+2
 ,XTA,S231
 15,ATX,KOM+3
 ,PRINT,STR4
C   BOCCTAHOBЛEHИE ИПЗ
C       HA CM И15
  15,MTJ,13
 ,WTC,ГYC
 15,VTM,
 14,VTM,-9
 13,XTA,
 ЦBOC:14,UTC,10
 13,XTS,
 14,VLM,ЦBOC
  ,XTS,.ИP 12
  15,UTM,-1
 15,XTA,S33-10
 ,ARX,C1
 15,ATX,S32-10
  ,ITA,12
  ,ARX,NR/REF
  ,UJ,NRESOFF
  NR/REF:,Z00,NRERROR
  ,Z00,BOCИПД*-BEGIN
  BOCИПД*:,BSS,
 15,XTA,
 14,CALL,BOCИПД
 15,UTM,1
 ,XTA,ZBITJ
 ,AAX,FLERBUZ
  ,ATX,FLERBUZ
 15,XTA,S13/14
  ,ATI,13
 15,AEX,S33
 ,AAX,C77777
 15,AEX,S13/14
 15,ATX,S13/14
C--- CHOBA PAЗБИPATEЛЬCTBO :
C    YXOДИTЬ HA SELECT ИЛИ RETURN
  ,ITA,13
  ,ASN,64+2
  ,UZA,AFT/STOP.OCTAHOB
 15,MTJ,14
 14,XTA,REGSCAL.
 ,AAX,BITININ.
 ,UZA,MACRO74.
 14,AEX,REGSCAL.
 14,ATX,REGSCAL.
  13,UTM,-13
  13,VZM,MACRO74
  13,UTM,13-4
  13,VIM,NO TIMER
  ,XTA,
  14,ATX,TLIMS
 NO TIMER:,BSS,
 ,ITA,13
 ,ARX,BIT3.+4
 ,ASN,64+9
 ,ATI,13
 ,YTA,
 13,VZM,IS NUMB
 ,XTA,BIT46.>1000
 IS NUMB:14,AEX,OШBHYПP
 ,AAX,B46/40
 14,AEX,OШBHYПP
 14,ATX,OШBHYПP
 ,AAX,B37/31.KPATHЫЙ ABOCT
 ,UZA,NO REP. - HET
 14,XTA,OШBHYПP.
 ,ARX,B37/31.ЧИCЛO
 ,AOX,BIT38.ЗAKAЗ.ABOCTOB
 ,AEX,BIT38. - 1
 14,ATX,OШBHYПP.
 14,XTA,REGSCAL.
 ,AOX,BITININ.BOCCTAHOBЛ.
 14,ATX,REGSCAL.PEAKЦИИ
 NO REP:,BSS,.
 14,XTA,OШBHYПP.
 14,ATX,S33.
 ,ASN,64+15.
 14,ATX,S27.
 ,XTA,SAVMIR.
 ,AAX,MASINTRE.
 14,ATX,.
 ,UJ,SELECT.
  AFT/STOP:15,MTJ,13
  15,XTA,I12
  12,MTJ,14
  14,REL,BEGIN.*****
  ,ATI,12
 15,XTA,COPYS33
 ,ATI,33B
  ,ITA,27B
  ,AAX,C14
  ,U1A,TOЛKAЙ
 15,XTA,RETM67
 ,ATI,33B
 ,MTJ,27B
 ,UJ,RETURN.ПOД Э67
 B46/40:,OCT,177
 B37/31:,OCT,0001 77.
 STR2:,BSS,.
  12,Z00,STRING2-BEGIN
  12,Z00,STRING2-BEGIN
 ,000,
 8,,.
 STR3:,BSS,
 15,Z00,
 15,Z00,25B
 :2,000,16.AC
 ,000,
 :2,021,3.PAY
 ,000,
 :2,024,0.PMP
 ,000,
 :2,025,5.И33,32,27
 ,006,2.(AП,И35,27)
 :2,047,0.И16
 ,000,
 :2,047,5.И15-И1
 8,006,14
 STR4:,BSS,
 15,Z00,
 15,Z00,15
 :3,000,17.AC
 ,000,
 :2,025,0.SR
 ,000,
 :2,033,16.AR(PMP)
 ,000,
 :2,055,0.И33,32,27B
 ,000,2
 :2,055,5.И16
 ,000,
 :2,063,0.И15,14,13,12
 ,000,3
 :,063,.TEKCT K STR4
 ,000,
 :1,105,27B.KOMAHДA
 ,000,
 :,164,.TИП OШИБKИ
 8,000,
 TSTR4:,GOST,12HPMP-И16/KOM.
 TЛEB:,GOST,6HЛEB:'231'
 ,GOST,6HПPAB:'231'
 S231:,GOST,6H'231'00000
 MASINTRE:,BSS,.
 ,LOG,3637 4000.
 SC/IN:,BSS,
C    ШKAЛA HEПEPEXBATЫBAEMЫX ABOCTOB
C     ПEPEXBATЫBAЮTCЯ: 8,9,27-30
 ,LOG,7763 7777 7037 7777
 STRING2:,BSS,.
 ,GOST,39H----CYMMATOP-----PAY-AДPEC--OCT---27B--
 ,CONT,60H-И15---И14---И13---И12---И11---И10----И9----И8----И7----И6--
 ,CONT,31H--И5----И4----И3----И2----И1-'231'
  DIAGN:,BSS,
 0,GOST,12HOCT.ПO ЗAП'231'
 ,GOST,12HOCT.ПO ЧTEH'231'
 ,GOST,12HOCT.ПO NKOM'231'
 ,GOST,12HПPOKPYTKA'231'
   4,GOST,12HBPEMЯ ПO ЭK'231'
   5,GOST,12HЧYЖ.KOMAHДA'231'
   6,GOST,12HЧYЖOЙ ЛИCT '231'
   7,GOST,12HЗAПP. KOM. '231'
   8,GOST,12HПEPEПOЛH.AY'231'
   9,GOST,12HДEЛEH. HA 0'231'
  10,GOST,12H KOHTP.ЧИC.'231'
  11,GOST,12H KOHTP.KOM.'231'
  12,GOST,12HCБOЙ ЭBM   '231'
  13,GOST,12HAДPEC MБ   '231'
  14,GOST,12HПЛOXOЙ Э057'231'
  15,GOST,12HПЛOXOЙ Э067'231'
  16,GOST,12HПЛOX.OБMEH '231'
  17,GOST,12HЗAПP.ЭKCTP.'231'
  18,GOST,12H*ЧYЖAЯ MЛ* '231'
  19,GOST,12HЗAK.PAБ.MД '231'
  20,GOST,12HЧYЖOЙ TPEK '231'
  21,GOST,12HЗAПP.ЗAПИCЬ'231'
  22,GOST,12HHEГOTOB MД '231'
  23,GOST,12HПЛOXAЯ MЛ  '231'
  24,GOST,12HHE ИДET OБM'231'
  25,GOST,12HABAPИЯ ДИCK'231'
  26,GOST,12HПЛOXOЙ TPEK'231'
  27,GOST,12H(KOPEHЬ)   '231'
  28,GOST,12H(APKCИHYC) '231'
  29,GOST,12H(ЛOГAPИФM) '231'
  30,GOST,12H(EXP)      '231'
 31,GOST,12HПЛOXOЙ Э050'231'
 32,GOST,12H/ЭKCTPAKOД/'231'
 33,GOST,12HЭK-ЧYЖ.ЛИCT'231'
 34,GOST,12HCБOЙ Ф.CИCT'231'
 ,END,.
 DISPAC71:,NAME,.04/02-81
C     ИHTEPПPETAЦИЯ Э71 ДИCПAKA
C
C========================================
C          CTPYKTYPA  TTDISPAC:
C  B48    - TEKCT B ISO  (ИHAЧE - GOST)
C  B47    - HE ПOCЛEДHИЙ OБMEH ПO
C           TEKYЩEMY ИHФ.CЛOBY
C  B46    - HYЖEH EЩE Э/K BBOДA
C  B45-31 - AHAЧ БYФEPA USER'A
C  B24-16 - <ДЛИHA БYФEPA> - 1
C  B15-01 - TEKYЩИЙ ADR.HAЧ. TEKCTA USER'A
C           ДЛЯ OЧEPEДHOГO ДYБHEHCKOГO Э71
C.........................................
C   ДИCПAKOBCKИE ЭKCTPAKOДЫ, ECTECTBEHHO,
C   MOГYT BЫДABATЬCЯ TOЛЬKO ИЗ MAT.PEЖИMA
C.........................................
C   BBOД C ПOДCKAЗKOЙ BЫПOЛHEH B CTИЛE
C   ДИCПAKA: K USER'Y  ПOПAДAET TOЛЬKO
C   BBEДEHHЫЙ ПOCЛE ПOДCKAЗKИ TEKCT.
C.........................................
C
C   ПPИ ПOXOДE HA MACRO71* B KAЧECTBE БY-
C   ФEPA ИCПOЛЬЗYETCЯ ИПЗ.
C.........................................
C         B   R E G S C A L:
C   B40=1 - 48-MИTEPMИHAЛЬHЫЙ PEЖИM
C            (Y TЮPИHA ЭTO ЗOBETCЯ
C            "ПO-HOBOMY")
C   B38=1 - PAЗPEШEHИE ДИAЛOГA. БEЗ ЭTOГO
C           БИTA HA ЛЮБOЙ OПPOC BЫДAETCЯ
C           OTBET  'HET KAHAЛA'.
C........................................
 REGSCAL:,EQU,100B
C
 *ИПД:LC,BLOCK,(1),XNFM(5),XNCM
 NFM:,WEQ,XNFM
 NCM:,WEQ,XNCM
 *ИПK:,LC,
 INFEX:,EQU,*ИПK+NCM
 SMASAV:LC,BLOCK,SAVAC,SAVSR(2),SAVI15
 ,CONT,SAVI14,SAVI13
 *YCЫ:LC,BLOCK,ГYC
 ДHЗ:LC,BLOCK,(1),BITJ
 TЮPИH*71:,SUBP,
 NRESOFF:,SUBP,
 MACRO71*:,SUBP,
 ALLTOISO:,SUBP,
 RETURN:,SUBP,
C.......................................
C            ЯЧEЙKИ  ИПЗ:
 SCEM:,EQU,83
 BUFS27:,EQU,103B
 *515:B,BLOCK,MSAV(7)
 ,CONT,D/IW71,TTDISPAC,W
 ,CONT,D/BUF(23).
C  ИCП. BTOPOE ПOЛE EMULATOR'A И PAБ.
C  ПOЛE ERRMACRO (KYCOK)
C.......................................
 *700:B,BLOCK,B48,B47,B46,B45
 ,CONT,B44,B43,B42,B41
 ,CONT,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33
 ,CONT,B32,B31,B30,B29
 ,CONT,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21
 ,CONT,B20,B19,B18,B17
 ,CONT,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B 9
 ,CONT,B 8,B 7,B 6,B 5
 ,CONT,B 4,B 3,B 2,B 1
 BNEW:,EQU,B40.B  REGSCAL
 BDIAL:,EQU,B38.B REGSCAL
 DISREG:,LC,1
 FULWOR:,LC,1
 C77777:,LC,1
 C377:,LC,1
 C3  :,LC,1
 *B:,BSS,
 13,REL,*B
 ,WTC,ГYC
 ,XTA,BUFS27
 ,AAX,DISREG
 ,U1A,DYBNA.CBOИ ЛЮДИ
 14,VZM,Д/OПPOC
 ,XTA,SAVAC
C     CYMMATOP = IW71
 ,UZA,D/ANSWER
 ,AEX,FULWOR
 ,UZA,D/NEW."ПO-HOBOMY"
 ,XTA,SAVAC.IW71
 ,ASN,64+40
 ,AEX,B1
 ,AAX,C3
 ,UZA,D/TERM.PAБOTA C TEPM.
C     ЭK. ПEPФOPAЦИИ
 ,ITA,13
 ,ARX,REFNR
 ,WTC,SAVI13
 13,VTM,
 ,UJ,NRESOFF
 REFNR:,Z00,TЮPИH*71
 ,Z00,TM-*B
 TM:,BSS,
 14,VTM,1
 ,UJ,MACRO71*
C========================================
 D/NEW:,BSS,
 ,WTC,ГYC
 ,XTA,REGSCAL
 ,AOX,BNEW
 ,WTC,ГYC
 ,ATX,REGSCAL
 Д/OПPOC:,BSS,
 ,WTC,ГYC
 ,XTA,REGSCAL
 ,AAX,BDIAL
 ,UZA,D/ANSWER
 ,WTC,ГYC
 ,XTA,REGSCAL
 ,APX,BNEW
 ,U1A,D/ANSWER."ПO-HOBOMY"
 ,XTA,B48*24
 D/ANSWER:,BSS,
 ,ATX,SAVAC
 RET:,BSS,
C     BOЗBPAT B ЗAДAЧY
 ,ITA,13
 ,ARX,D/REFNR
 ,ATX,SAVAC+2.B SAVAR
 ,UJ,NRESOFF+2.БEЗ YПP.
 D/REFNR:,Z00,TЮPИH*71
 ,Z00,RET/-*B
 RET/:,BSS,
 ,ITA,32B
 ,ATI,33B
 ,WTC,ГYC
 ,XTA,BUFS27
 ,ATI,27B
 ,UJ,RETURN..........
C========================================
 DYBNA:,BSS,
 ,XTA,SAVAC
 ,ASN,64+41
 ,AAX,B1
 ,AEX,B1
 ,ATI,14
C  Э71 BЫДAH, BИДИMO, OTЛAДЧИKOM.
C  ИCПOЛHЯEM EГO БEЗ BCЯKИX ФOKYCOB.
 ,ITA,13
 ,ARX,REFNR2
 ,WTC,SAVI13
 13,VTM,
 ,UJ,NRESOFF
 REFNR2:,Z00,TЮPИH*71
 ,Z00,TM2-*B
 TM2:,BSS,
 ,UJ,MACRO71*
C........................................
 D/TERM:,BSS,
C     YПPЯTЫBAHИE PEГИCTPOB
 ,WTC,ГYC
 15,VTM,MSAV
 ,ITA,32B
 ,AOX,SAVSR
 ,XTS,SAVI15
 ,XTS,SAVI14
 ,XTS,SAVI13
 ,ITS,12
 ,ITS,11
 ,ITS,10
 ,XTS,DISREG
 ,ATI,27B
 ,XTA,SAVAC
 :,24,3.*****
 ,WTC,ГYC
 15,VTM,
 BEGIN:,BSS,
C   HAЧAЛO PAЗБOPA OЧEPEДHOГO ИHФ.CЛOBA
 15,ATX,D/IW71
 ,AAX,B43
 ,UZA,EXCHENGE.PEAЛЬHЫЙ OБMEH
C     O П P O C / O T K A З.
 15,XTA,D/IW71
 ,AAX,B26.БИT OTKAЗA
 ,AEX,B26
 ,U1A,OПPOC
C     OTKAЗ OT TEPMИHAЛA
C........................................
 TOTASK:,BSS,
C   B O З B P A T  B  З A Д A Ч Y
 :,24,2003B.*****
  ,WTC,ГYC
 15,VTM,MSAV+7
 ,STX,SAVAC
 ,STI,10
 ,STI,11
 ,STI,12
 ,STX,SAVI13
 ,STX,SAVI14
 ,STX,SAVI15
 ,ATX,SAVSR
 ,ATI,32B
 ,XTA,
 ,WTC,ГYC
 ,ATX,BUFS27
 ,UJ,RET
C=======================================
 OПPOC:,BSS,
 15,XTA,REGSCAL
 ,AAX,BDIAL
 ,UZA,TO TASK.HET TEPM.
 15,XTA,REGSCAL
 ,APX,BNEW
 ,ASN,64-1
 ,YTA,
 ,ATI,14
 14,XTA,ACC1.CYMMATOP OTBETA
 ,UJ,TO TASK
C========================================
 GIV15:15,XTA,MSAV+1
 ,UJ,GETIND
 GIV13:15,XTA,MSAV+3
 ,UJ,GETIND
 EXCHENGE:,BSS,
C   PAЗБOP ДИCПAKOBCKOГO ИHФ.CЛOBA
C   OБMEHA И EГO OБPAБOTKA.
 15,ATX,TTDISPAC
 15,XTA,D/IW71
 ,AAX,=7770 7777 7400 7777
 ,ASN,64+24
 15,ATX,W
 ,YTA,
 15,AOX,W
C        AKOH / AHAЧ
 GIVADR:,BSS,.BЫЧ. ИCП. ADR.
 15,ATX,W
 ,ASN,64+20
 ,AAX,=17
 ,ATI,14
 ,AEX,=17
 ,UZA,GIV15.IR 15.
 ,AEX,B2
 ,UZA,GIV13.IR 13.
 14,ITA,
 GET IND:15,ARX,W
 15,ATX,W
 ,ASN,64+24
 ,UZA,HAVADR.OБA AДPECA
 15,XTA,W
 ,AAX,C77777
 15,ATX,TTDISPAC.AHAЧ
 ,ASN,64-24
 15,AOX,TTDISPAC
 15,ATX,TTDISPAC
 15,XTA,W
 ,ASN,64+24.AKOH
 ,UJ,GIVADR
 HAVADR:,BSS,
 15,XTA,W
 ,AAX,C77777
 15,ATX,W.AKOH
 15,XTA,TTDISPAC
 ,AAX,C77777.AHAЧ
 ,NTR,7
 15,X-A,W
 ,U1A,MANY
 15,ATX,W
 ,A-X,MAXL
 ,UZA,MANY
 15,XTA,W
 ,UJ,GLONG
 MANY:,XTA,MAXL
 GLONG:,BSS,
 ,ASN,64-15
 15,AEX,TTDISPAC
 ,AAX,=3770 0000
 15,AEX,TTDISPAC
 15,ATX,TTDISPAC
 15,XTA,D/IW71
 ,APX,B37
 15,AEX,TTDISPAC
 ,AAX,B48
 15,AEX,TTDISPAC
 15,ATX,TTDISPAC
 15,XTA,D/IW71
 ,AAX,B40.BBOД
 ,UZA,OUT
C   BBOД.  HYЖHA ЛИ ПOДCKAЗKA!
 15,XTA,D/IW71.
 ,AAX,=:0005.B39+B37
 ,UZA,INPUT.ЧИCTЫЙ BBOД
 OUT:,BSS,
 11,VTM,-19
 COPY:15,WTC,TTDISPAC
 11,UTC,19
 14,VTM,
 :,24,.*****
 14,XTA,
 :,24,3.*****
 11,UTC,19
 15,ATX,D/BUF
 12,VTM,-5
 TRW:,BSS,
 ,ASN,64-8
 11,UTC,19
 15,ATX,D/BUF
 ,YTA,
 15,ATX,W
 15,XTA,TTDISPAC
 ,ARX,
 ,UZA,LOK.ISO
C    K O Д   G O S T
 15,XTA,W
 ,AEX,C377
 ,UZA,E/TEXT1
 ,AEX,=205.ИHB.172
 ,UZA,E/TEXT1
  14,VTM,OWNTAB-1
C  ПEPEKOДИPOBKA:  GOST - ISO.
  OWNCOD:14,UTM,1
  14,XTA,
  ,UZA,*1
  15,AEX,W
  ,AAX,C377
  ,U1A,OWNCOD
  14,XTA,
  ,ASN,64+9
  ,UJ,SYMB/
  OWNTAB:,LOG,040 017
  ,LOG,105 020
  ,LOG,077 021
  ,LOG,052 024
  ,LOG,047 032
  ,LOG,047 033
  ,LOG,043 034
  ,LOG,074 116
  ,LOG,076 117
  ,LOG,077 120
  ,LOG,077 121
  ,LOG,077 122
  ,LOG,077 123
  ,LOG,053 124
  ,LOG,075 125
  ,LOG,041 130
  ,LOG,170 135
  ,LOG,072 136
  ,LOG,047 137
  ,LOG,
 *1:15,XTA,W
 ,ASN,64-32
 15,ATX,W
 14,VTM,-177B
 TRANS1:,BSS,
 14,AEX,ALLTOISO+177B
 ,AAX,=:000774.2-Й БAЙT
 ,UZA,SYMB.HAШ CИMB.
 15,XTA,W
 14,VLM,TRANS1
  14,VTM,1-177B.ПYCTЫШKA
 SYMB:14,UTM,177B
 ,ITA,14
 SYMB/:11,UTC,19
 15,AOX,D/BUF
 12,VLM,TRW
 11,UTC,19
 15,ATX,D/BUF
 11,MTJ,14
 14,UTM,19
 ,ITA,14
 ,ASN,64-15
 15,AEX,TTDISPAC
 ,AAX,=3770 0000.ДЛИHA БYФ.
 ,UZA,E/COPY
 11,VLM,COPY
C
C     TEKCT HE ЛEЗET B 20 ЯЧEEK
C
 ,XTA,B47
 ,UJ,O/CONT
 E/COPY:,BSS,
 15,XTA,D/IW71
 ,AAX,B40.
 ,U1A,INP.BBOД
 15,XTA,D/IW71
 ,AAX,B37
 ,UZA,OUT1
C     BЫBOД B KOДE TEPMИHAЛA  (ISO)
 ,XTA,
 ,UJ,O/CONT
 INP:,BSS,
 ,XTA,=:3
 O/CONT:,BSS,
 15,AOX,TTDISPAC
 15,ATX,TTDISPAC
 ,XTA,=6H'24'''''''''''
 OUT1:,BSS,
 11,UTC,20
 15,ATX,D/BUF
C     БYФEP ГOTOB, MOЖHO BЫBOДИTЬ
C........................................
 OUTPUT:,UTC,1
 INPUT:14,VTM,
 ,ITA,15
 ,ASN,64-24
 14,ARX,IW71/DD.INP/OUT
 :,24,2003B.*****
 ,ATX,SAVAC
 ,XTA,DISREG
 15,ATX,BUFS27
 14,VTM,RET/MAC
 14,MTJ,32B
  ,WTC, Д H З
  ,XTA,*ИПK-NFM
  ,AAX,B17
  :,UZA,*+1
  ,UTC,2.K KAДAHЦEBY
  :14,VTM,. - CBOЙ
 ,UJ,MACRO71*.HA ИCПOЛHEHИE
C........................................
 E/TEXT1:,BSS,.ДOKPYTKA
 11,UTC,19
 15,XTA,D/BUF
 ,UJ,*2/1
 *2:,ASN,64-8
 *2/1:,AOX,B1
 12,VLM,*2
 11,UTC,19
 15,ATX,D/BUF
 ,UJ,E/COPY
C........................................
 LOK:,BSS,
C     BЫBOД B KOДE TEPMИHAЛA (ISO)
 15,XTA,W
 ,UZA,E/TEXT1.KOHEЦ
 ,AAX,=177.HA BCЯK.CЛYЧAЙ
 ,UJ,SYMB/
C=======================================
C     BЫBOД CЛEДYЮЩEЙ ЧACTИ TEKCTA
C
 REPEAT:,BSS,
 15,AEX,TTDISPAC
 15,ATX,TTDISPAC
 ,ARX,=3540 0024
 15,AEX,TTDISPAC
 ,AAX,=3777 7777
 15,AEX,TTDISPAC
 15,ATX,TTDISPAC
 ,AAX,B46
 ,UZA,OUT.ПPOДOЛЖ.BЫBOД
C   A TEПEPЬ HYЖEH BBOД
 15,AEX,TTDISPAC
 15,ATX,TTDISPAC
 ,ASN,64+24
 ,AAX,C77777
 15,ATX,W.AHAЧ БYФ.
 15,XTA,TTDISPAC
 ,AAX,C77777.TEK.AHAЧ
 15,A-X,W.HACTOЯЩИЙ AHAЧ
 ,ASN,64-15
 15,ARX,TTDISPAC
 ,AAX,=3770 0000
 15,AOX,W
 15,AEX,TTDISPAC
 ,AAX,=3777 7777
 15,AEX,TTDISPAC
 15,ATX,TTDISPAC
 ,UJ,INPUT
C========================================
C    O Б P A Б O T K A   K O H Ц A
C    O Б M E H A:
C........................................
 RET/MAC:,BSS,
 :,24,3.*****
 15,XTA,TTDISPAC
 ,AAX,B47
 ,U1A,REPEAT
 15,XTA,D/IW71
 ,AAX,B40.БИT BBOДA
 ,UZA,NEXT.БЫЛ ЧИCTЫЙ OUT
C     OKOHЧEH BBOД
 11,VTM,-22
 10,VTM,.BUF.USER'A
 COPY/A:,BSS,
 15,XTA,TTDISPAC
 ,ARX,
 ,UZA,ISO.KOД TEPMИHAЛA
 11,UTC,22
 15,XTA,D/BUF
 12,VTM,-5
 TRW/A:,BSS,
 ,ASN,64-8
 11,UTC,22
 15,ATX,D/BUF
 ,YTA,
 ,UZA,E/TEXT2
 ,ATI,14.ПEPEBOД:
 14,XTA,ALLTOISO.ISO-GOST
 ,ASN,64+32
 ,AAX,C377
  ,ATI,14
  14,UTM,-32B
  14,VIM,HEKAB
  ,ARX,B1.32 HA 33 (AПOCTPOФ)
  HEKAB:,BSS,
 11,UTC,22
 15,AOX,D/BUF
 12,VLM,TRW/A
 WRWORD:15,WTC,TTDISPAC
 14,VTM,
 :,24,.*****
 14,UTC,
 10,ATX,
 :,24,3.*****
 ,ITA,10
 ,ASN,64-15
 15,AEX,TTDISPAC
 ,AAX,=3770 0000
 ,UZA,NEXT.БYФ.ПOЛOH
 10,UTM,1
 11,VLM,COPY/A
C     HAШ БYФEP (B ИПЗ) KOHЧИЛCЯ
 15,XTA,TTDISPAC
 ,AAX,B48
 ,AEX,B48
 ,UZA,WR2.KOД TEPMИHAЛA
 ,XTA,=6H'377'''''''''''
 WR2:,24,.*****
 14,UTC,
 10,ATX,
 :,24,3.*****
 ,UJ,NEXT.ЗAKAЗ BЫПOЛHEH
 E/TEXT2:11,UTC,22
 15,XTA,D/BUF
  ,AOX,C377
 ,UJ,*4/1
 *4:,ASN,64-8
  *4/1:12,VLM,*4
C
C   <ПPOБEЛ><LF> - ПYCTAЯ ПOCЫЛKA
C
  10,VIM,WRW3
  ,AEX,=6H'17''377'''''''''
  :,U1A,*+1
  ,XTA,=6H'360''377'''''''''
 :,AEX,=6H'17''377'''''''''
 WRW3:15,WTC,TTDISPAC
 14,VTM,
 ,UJ,WR2
 ISO:,BSS,
 11,UTC,22
 15,XTA,D/BUF
 ,AAX,C377
 ,UZA,E/ISO
 11,UTC,22
 15,XTA,D/BUF
 ,UJ,WRWORD
 E/ISO:11,UTC,22.KOHEЦ ЗAKAЗA
 15,XTA,D/BUF
 ,UJ,WRW3
C=======================================
 NEXT:,BSS,
C     OЧEPEДHOE ИHФ.CЛOBO OБPAБOTAHO.
C     ПPOBEPKA: A ЧTO TAM, ДAЛЬШE.
 15,XTA,D/IW71
 ,AAX,B19.ПOCЛEДHEE
 ,U1A,END.ИHФ.CЛOBO
 15,XTA,MSAV+2.IR 14
 ,ARX,B1
 15,ATX,MSAV+2
 ,ATI,14
 :,24,.*****
 14,XTA,
 :,24,3.*****
 ,AEX,FULWOR
 ,UZA,END/.OПPOC/NEW
 ,AEX,FULWOR
 ,UJ,BEGIN.PAЗБOP
C==============================
 END:,BSS,
C  K O H E Ц   Э K C T P A K O Д A
C
C  ПEPEД BЫXOДOM - OПPOC ПOДKЛ.
 15,XTA,REGSCAL
 ,AAX,BDIAL
 ,UZA,TOTASK
 15,XTA,REGSCAL
 ,APX,BNEW
 ,U1A,TOTASK
 ,XTA,B48*24
 ,UJ,TOTASK
C..........................................
 END/:,BSS,
 :,24,2003B
 15,XTA,REGSCAL
 ,AOX,BNEW.ПPИЗHAK: NEW
 15,ATX,REGSCAL
 :,24,3
 ,UJ,END
C==========================================
C         K O H C T A H T Ы
C..........................................
 B48*24:,OCT,4000 0000 4
 ACC1:,OCT,4
 ,OCT,5000 0002 0000 0001
 IW71/DD:,Z06,D/BUF.BBOД
 ,,
 :,Z04,D/BUF.BЫBOД
 ,,
 MAXL:,LOG,323.324
 ,END,
   NRCDC405:,NAME,
C
C*****   YПPABЛEHИE ЧИTAЛKOЙ CDC405
C      ФИЗИЧECKOE ПOДKЛЮЧEHИE B YBY-6
C      ЛOГИЧECKOE ПOДKЛЮЧEHИE B KBY-4
C
  *677:B,BLOCK,BITS
  ,CONT,B48,B47,B46,B45,B44,B43
  ,CONT,B42,B41,B40,B39,B38,B37
  ,CONT,B36,B35,B34,B33,B32,B31
  ,CONT,B30,B29,B28,B27,B26,B25
  ,CONT,B24,B23,B22,B21,B20,B19
  ,CONT,B18,B17,B16,B15,B14,B13
  ,CONT,B12,B11,B10,B9,B8,B7,B6
  ,CONT,B5,B4,B3,B2,B1
  DISREG:,LC,1
  C2004 :,LC,1
  MASK12:,LC,1
  C7777:,LC,1
  FULWOR:,LC,1
  C77777:,LC,1
  B24/1 :,LC,1
  C76000:,LC,1
C
C---  CBЯЗЬ C PEЗИДEHTOM BBOДA :
C
  FSBASENR:LC,BLOCK,(1),BASE405
  БAЗAПPИЗ:LC,BLOCK,BASEFLAG(7)
  ,CONT,DN405,BIT405,KД
C
C---  CЧETЧИK KAPT И OШИБOK (YBBK-2)
C
  *STATBUF:LC,BLOCK,(8),STAT
C
C---  OCHOBHЫE  БЛOKИ ДИCПETЧEPA :
C
  * И П Д :LC,BLOCK, XNF
  OUTJOBSC:,EQU,XNF+52B
  SCALES :LC,BLOCK,(5),SC/YBBK
  * Y C Ы :LC,BLOCK, Г Y C, RDSCAL, COMMIR
  Д H З   :LC,BLOCK,(1),BITJ,ZBITJ
  SMASAV  :LC,BLOCK,SAVAC,SAVSR,SAVAR
  ,CONT,SAVI15,SAVI14,SAVI13
  CONTIME:LC,BLOCK,(7),TCDC405
  *TAKCA:LC,BLOCK,(3),T
C
  BOCИПД  :,SUBP,
  ERRMACRO:,SUBP,
  MACRO74 :,SUBP,
  TTPRINT :,SUBP,
  RETURN  :,SUBP,
  CLANEWTA:,SUBP,
  NEWTA   :,SUBP,
  NEWTA*  :,SUBP,
  TIME10  :,SUBP,
  CLOMIR  :,SUBP,
  TOCDC405:,SUBP,
  NRESOFF :,SUBP,
  NR405   :,SUBP,
  TRA TAPE:,SUBP,
C
C---  БЛOKИ, OБЩИE C ЗAДAЧEЙ OБMEHA :
C
  TASKSTRA :LC,BLOCK,TBUC(6),TBUT(6),CSUMSTAT
  SCALSTRA :LC,BLOCK,SBUC(6),SRJC(6),SJMT
  STATUSMT:LC,BLOCK,(5),NEW(4),W05741(19),ШHГ(4)
  TRAMASK :,LC,1
  TRABUS:,LC,1
C
  GIVTRA  :,SUBP,
  TRAINT:,SUBP,
  TRAPHY  :,SUBP,
  TASKOFF :,SUBP,
  AFGVTR:,SUBP,
C
C---   ПOЛE YПPЯTЫBAHИЯ PEГИCTPOB :
C
  SAVE:I,BLOCK,AC,SR,AR,S33,S32,S27,S16,S15
  ,CONT,S14,S13,S12,S11,STAC(4)
C
C---   ЯЧEЙKИ B ИПЗ :
C
  TIME:,EQU,110B
C
C---   БYФEPHЫЙ CEKTOP :
C
  N BUF:,EQU,13
  SHIFT:,EQU,48-NBUF
  BUF405:,SC,0
  BUF1:,EQU,BUF405
  BUF2:,EQU,BUF1+10
C
C==================================
C
  B:13,REL,B
  ,ITA,32B
  ,ATI,33B
  ,XTA,DN405
  14,VZM,OTKAЗ
  ,UZA,FREE
  ,AEX, Д H З
  ,UZA,OWN
C...  BY ЗAHЯTO
  14,VTM,TBYЗAH
  ,ITA,14
  14,VTM,MACRO74
  ,UJ,TTPRINT
  OTKAЗ:,AEX, Д H З
  ,U1A,NRSRET
  ,ATX,TCDC405
  ,ATX,DN405
  NRSRET:,BSS,
  ,XTA,W/OFF
  ,ATX,SAVAR
  ,UJ,NRESOFF+2
  W/OFF:,Z00,NR405
  ,Z00,RETURN
C
C...   ЗAXBAT ЭKCTPAKOДA :
C
  FREE:,ATX,DEND
  ,XTA, Д H З
  ,ATX,DN405
  ,XTA,BITJ
  ,ATX,BIT405
  ,XTA,B48
  ,ATX,RECARD
  ,ATX,WRCARD
  ,ATX,ISCAR.KAPT HET
  OWN:,XTA,DEND
  ,U1A,ERROR
  15,VTM,SAVE+1
  ,XTA,SAVSR
  ,ITS,13
  15,ATX,
  ,ASN,64-24
  15,AOX,
  ,ATX,BASE405
  ,ITS,33B
  ,ITS,32B
  ,ITS,27B
  ,XTS,DISREG
  ,ATI,27B
  ,XTS,SAVI15
  ,XTS,SAVI14
  ,XTS,SAVI13
  ,ITS,12
  ,ITS,11
  ,ITS,
C
C...   ECTЬ ЛИ ГOTOBЫE KAPTЫ :
C
  ПPИEM:,24,3
  ,WTC,BASE405
  13,VTM,
  ,XTA,RECARD
  ,AEX,WRCARD
  ,U1A,GIVADR.-ДA
  ,XTA,ISCAR
  ,U1A,ЖДEM.-HET
C
C...   ПOЛYЧEHИE AДPECA KAPTЫ :
C
  GIVADR:,XTA,RECARD
  ,ANX,C77777
  ,ATX,ABUF
  ,XTA,BASE405
  ,AAX,C76000
  ,WTC,ABUF
  ,ARX,POIN
  ,ATX,ABUF
  ,ATI,14
  ,WTC,S14
  15,VTM,
C
C...  YCTAHOBKA ПPИЗHAKA ДИCП.KOHЦA
C
  14,XTA,20
  ,ATX,DEND
  ,AEX,B1
  ,ATX,S14
C
C...  HYЖEH ЛИ ПEPEBOPOT :
C
  ,XTA,BASEFLAG
  ,AEX,=6HЭ60CDC
  ,AAX,B24/1
  ,U1A,REVCARD
  11,VTM,-19
C
C...   ПEPEПИCЬ ПOKOЛOHHAЯ :
C
  TRAN:14,XTA,
  ,WTC,S27
  :,24,
  15,ATX,
  :,24,3
  14,UTM,1
  11,VLM,TRAN
C
C...  BOЗBPAT ПOД ЭKCTPAKOД 060
C
  ИCXOД:15,VTM,S11+1
  :,24,2003B
  ,XTA,RECARD
  ,ASN,64+1
  ,ATX,RECARD
  ,ASN,64+SHIFT
  ,U1A,COUNT
  ,XTA,B48
  ,ATX,RECARD
  COUNT:,ATX,ISCAR
  ,XTA,B1.ЧИCЛO
  ,ARX,STAT.BBEДEHHЫX
  ,ATX,STAT.KAPT
  ,NTR,6
  ,WTC, Г Y C
  ,XTA,TIME.ДOБABKA
  ,A+X,T.ЗA BBOД
  ,WTC, Г Y C.OДHOЙ
  ,STX,TIME.KAPTЫ
  ,STI,11
  ,STI,12
  14,VTM,RETURN
  ,UJ,BOCИПД
C
C...  ПEPEBOPOT KAPTЫ B YПП-ФOPMAT
C
  REVCARD:11,VTM,-24
  ,XTA,=0001 0001 0001 0001
  REV3:,ATX,MASK
  12,VTM,-20
  REV2:11,UTM,1
  14,VTM,-40
  ,XTA,
  ,ATX,KOD
  REV1:,WTC,ABUF
  12,XTA,20
  ,APX,MASK
  14,ASN,64+48
  ,AOX,KOD
  ,ATX,KOD
  14,UTM,4
  12,UTM,1
  14,VIM,REV1
  ,WTC,S27
  :,24,
  15,ATX,
  :,24,3
  12,VIM,REV2
  ,XTA,MASK
  ,ASN,64-1
  11,VIM,REV3
  ,UJ,ИCXOД
C
C...    З A K P Ы T И E   З A Д A Ч И
C     ПOCTAHOBKA, ECЛИ HAДO, ЗAKAЗA HA OБMEH
C
  ЖДEM:,24,2003B
  14,VTM,ПPИEM
  14,MTJ,33B
  12,VTM,CLANEWTA
  ,XTA,TCDC405
  ,U1A,TO SCAL.HET ГT.
  ,XTA,DN405
  ,ASN,64-42
  ,AOX,KYCWL
  ,ATX,KYC
  ,AEX,TBUC+3
  ,UZA,TO SCAL.ECTЬ ЗAKAЗ
  ,XTA,ADR2E
  ,ARX,BASE405
  ,ATX,KYC+1
  ,ITA,13
  ,ARX,AKYC
  ,ATX,TKYC
  13,VTM,TKYC
  12,VTM,TRAPHY
  TO SCAL:,XTA,BITJ
  ,AOX,SC/YBBK
  ,ATX,SC/YBBK
  12,UJ,
  KYCWL:,Z04,
  8,Z00,200B
  ADR2E:,Z00,EXCH-B
  ,Z00,EXCH-B
  AKYC:,Z07,
  ,Z00,KYC-B
  TKYC:,LOG,
  KYC:,BSS,2
C
C************************************
C
C    K O H E Ц    O Б M E H A
C   BXOД OT ПPEPЫBAHИЯ ПO 26 P. ГPП
C
C************************************
C
  END EXT6 :,ENTRY,
C
  ,XTA,C2004
  ,EXT,145B
  PUT TRAM:,BSS,
  ,XTA,
  ,ATX,TCDC405
  ,XTA,B26
  ,CALL,CLOMIR
  ,XTA,B2.ИMИTИPYEM
  ,AOX,W05741+1.ПPOXOД
  ,ATX,W05741+1.ЗOHЫ MЛ
  14,VTM,4
  15,VTM,AFGVTR
  ,UJ,TRA TAPE
C
C**********************************
C     Б Y Д И Л Ь H И K
C   BXOД ИЗ BPEMEHHЫX ПPEPЫBAHИЙ
C**********************************
C
  TIMER:,XTA,B16
  ,ARX,TCDC405
  ,ATX,TCDC405
  ,AAX,B23
  ,UZA,TIME10
  ,XTA,
  ,ATX,TCDC405
  ,XTA,B2
  ,EXT,31B
  ,WTC,BASE405
  14,VTM,PYГAHЬ - B
  ,ITA,14
  14,VTM,RETURN
  ,UJ,TTPRINT
  CHEKRD:,XTA,C2004
  15,VJM,TOCDC405
  ,UZA,TIME10
  ,XTA,B11
  15,VJM,TOCDC405
  ,U1A,TIME10
  ,ATX,TCDC405
  ,XTA,BIT405
  ,AAX,SC/YBBK
  ,AEX,SC/YBBK
  ,ATX,SC/YBBK
  ,YTA,
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  ,UJ,NEWTA
C
C********************************
C   PAБOTA OT ЗAДAЧИ OБMEHA :
C********************************
C
  EXCH:9,MTJ,6.BOЗBPAT
  ,WTC,BASE405
  13,VTM,
  ,XTA,OUTJOBSC
  ,AAX,BIT405
  ,U1A,OUTJOB
  ,XTA,KД
  ,UZA,ПYCK
C...   ЭTO KOHEЦ OБMEHA
  ,EXT,4101B
  ,AAX,B11
  ,U1A,БAYC6.HET OШBY
  ,XTA,=2010
  ,ATX,MASK
  15,VJM,TOCDC405
  14,VTM,
  ,UZA,OШBY
  БAYC6:,EXT,4036B
  ,ASN,64-36
  ,AUX,=6H'7''7''7''7'''''
  ,AOX,=6H0000)''
  ,ATX,OШБAYC+2
  ,AEX,=6H0024)''
  14,VTM,OШБAYC-OШBYK0
  ,U1A,DIAGN
  14,VJM,AKTIV
C...  KYДA ПИCATЬ KAPTY :
   ,XTA,WRCARD
  ,ANX,C77777
  ,ATI,14
  ,XTA,WRCARD
  ,ASN,64+1
  ,ATX,WRCARD
  ,ASN,64+SHIFT
  ,U1A,NEXT
  ,XTA,B48
  ,ATX,WRCARD
  NEXT:,XTA,BASE405
  ,AAX,C76000
  14,ARX,POIN
  ,ATI,14
  15,VTM,STAC
  ,XTA,MASK12
  13,AEX,BUF2-B
  13,ATX,BUF2-B
  13,XTA,BUF1-B
  14,ATX,
  ,AEX,MASK12
  11,VTM,-18
  TRANW:11,UTC,19
  13,XTS,BUF1-B
  11,UTC,19
  14,ATX,
  15,AOX,
  11,VLM,TRANW
  14,XTS,10
  ,AEX,MASK12
  14,STX,10
  ,U1A,NO DK
  ,UTC,B1
  NO DK:,XTA,
  14,ATX,20
  ,U1A,TOPMOЗ
  ,XTA,WRCARD
  ,AEX,RECARD
  ,U1A,ПYCK
  ,ATX,ISCAR.OБOГHAЛИ
  ,UJ,TOPMOЗ.HA KPYГ
C---
  ПYCK:,XTA,
  15,VJM,TOCDC405
  ,U1A,NO READY
  ,XTA,C2004
  15,VJM,TOCDC405
  ,UZA,NO READY
  ,XTA,B10
  ,ATX,KД
  15,VJM,TOCDC405
  ,ITA,13
  ,AAX,C76000
  ,ASN,64-2
  ,AOX,KYC6
  ,EXT,6.OБMEH
  ,XTA,=1026
  ,EXT,145B.ПYCK
  ,XTA,KYC.ЗAXBAT
  ,ATX,TBUC+3.KAHAЛA
  ,XTA,B26
  ,AOX,TRAMASK
  ,ATX,TRAMASK
  7,VTM,TIMER
  14,VTM,4
  ,ITA,7
  ,ATX,TCDC405
  6,UJ,
C     OБMEH BEДETCЯ C 1-M CEKTOPOM
C     CBBOEГO  NR-ЛИCTA :
  KYC6:,LOG,240 2100
C
C...   OTPAБOTKA HEГOTOBHOCTИ ПEPEД ПYCKOM
C
  NO READY:,XTA,=2040.PRE-READ
  15,VJM,TOCDC405
  ,ATX,MASK
  14,VTM,2
  OШ BY:,XTA,=2100.FEED FILE
  15,VJM,TOCDC405
  ,AAX,MASK
  ,U1A,DIAGN
  14,UTM,2
  DIAGN:,24,2003B
  14,UTM,OШBYK0
  7,VTM,CHEK RD - B
  14,XTA,1
  ,AAX,B33
  ,U1A,CБOЙ CИ
  ,UTC,B37-B25
  CБOЙ CИ:,XTA,B25
  ,ARX,STAT
  ,ATX,STAT
  13,J+M,7
  ,ITA,14
  14,VJM,TTPRINT
  ,ITA,7
  ,ATX,TCDC405
  14,VTM,TOPMOЗ
C
C...   AKTИBBИЗAЦИЯ ЮЗEPA :
C
  AKTIV:,24,2003B
  ,XTA,BIT405
  ,AAX,SC/YBBK
  ,AEX,SC/YBBK
  ,ATX,SC/YBBK
  ,YTA,
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  :,24,3
  14,UJ,
C
C...   ИЗ'ЯTИE ЗAKAЗA ИЗ WL1 :
C
  TOPMOЗ:,BSS,
  OUTJOB:,BSS,
  ,XTA,
  ,ATX,KД
  ,ATX,TBUC+3
  9,VJM,TASKOFF
  :,24,2003B
  ,XTA,TRABUS
  ,AOX,B43.KBY-4
  ,AOX,B41.KBY-6
  ,ATX,TRABUS
  ,UJ,TRAINT
C
C========================
C
  ERROR:14,VJM,ERRMACRO
    :,GOST,12H HET KAPT'231'
  TBYЗAH :,ISO,12HBY ЗAHЯTO''''''
  PYГAHЬ :,ISO,18HHET PБYC-6 CDC405''
  OШ BY K0:,ISO,12HOШ.BY K0''''''''
  OШ BY K1:,ISO,12HOШ.BY K1''''''''
  TNORD   :,ISO,18HHET READY CDC405''''
  OШ БAYC :,ISO,18HOШ.BY K1   (0000)''
  POIN:,BSS,
C
C----   AДPECA БYФEPOB :
C
  1,LOG,425
  2,LOG,452
  3,LOG,477
  4,LOG,524
  5,LOG,551
  6,LOG,576
  7,LOG,623
  8,LOG,650
  9,LOG,675
 10,LOG,722
 11,LOG,747
  12,LOG,774
  13,LOG,1021
  ISCAR:,LOG,1
  SAVE   :,BSS,16
  RECARD :,BSS,1
  ABUF:,BSS,1
  WRCARD :,BSS,1
  DEND   :,BSS,1
  MASK   :,BSS,1
  KOD    :,BSS,1
C
C======================
C
  ,END,
 SWTCHM52:,NAME,
 WRPHYS:,SUBP,
 NRESCALL:,SUBP,
 NR  POST:,SUBP,
 SMASAV:LC,BLOCK,SAVAC
 *YCЫ:LC,BLOCK,ГYC
 C77357:,LC,1
 BUFS27:,EQU,104B
 NAMTRNSR:,EQU,135B
 14,UTM,-2
 14,V1M,WRPH
C***    +1 : BXOД OT MACRO70
  :,ATX,SAVAC
 ,YTA,
 ,WTC,ГYC
 ,ATX,NAMTRNSR
  ,ITA,27B
  ,AAX,C77357
  ,WTC,ГYC
  ,ATX,BUFS27
  ,XTA,INFNRES
  ,UJ,NRESCALL
 WRPH:14,UTM,2
  ,UJ,WRPHYS
 INFNRES:,BSS,
  ,Z00,NR  POST.ПOЧTOBAЯ
  ,Z00,14.CЛYЖБA.
  ,END,
 NRESPOST:,NAME,
C        HEPEЗИДEHT MEЖПPOГP.KAHAЛA CBЯЗИ
C
C         ЭKCTPAKOД CYMMATOPHЫЙ
C    35-31P - N MAT ЛИCTA ПPИEMA/ПEPEДAЧИ
C    30-25  - BPEMЯ OЖИДAHИЯ ПPИ ПPИEME
C    24-21  - BCЯKИE ПPИЗHAKИ
C    18-16  - N OПEPAЦИЙ
C    15-01  - AДPEC ДOПOЛH. ИHФOPMAЦИИ
C
C
C     N OПEPAЦИИ = 7  : ИHTEPФEЙC
C       C  ФAЙЛOBЫMИ CИCTEMAMИ
C
C...   ПPИHAДЛEЖHOCTИ ДИCПETЧEPA
 *ИПД:LC,BLOCK,XNF,XNFM(4),XNC(2),USE FS(2)
 ,CONT,Ш/FULL(2),Ш/ПYCK(5)
 ,CONT,XLFATA(37),ПAPTИЗAH,БЛOKAЦПY
 ,CONT,MOЖHOKAЧ(3),LIB/BOSS
 NF:,WEQ,XNF
 NFM:,WEQ,XNFM
 NC:,WEQ,XNC
 NC1:,EQU,NC-1
  LTF:,WEQ,XLFATA
  LFATA:,EQU,LTF-1
  *C:LC,BLOCK,C6
 *YCЫ:LC,BLOCK,ГYC,RDSCAL
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
 SMASAV:LC,BLOCK,SAVAC,SAVSR(2)
 ,CONT,SAVI15,SAVI14
 SCALES:LC,BLOCK,(1),MRDSCAL(3),WAITMT,SCOPER
 ШЛAГБAYM:LC,BLOCK,(1).CEMAФOPЫ :
 ,CONT,SEM/DIS(3).ЗAK/OTK ДИCKOB
 ,CONT,SEM/RES(5).CHEKJOB*
  ,CONT,SEM212.ДOCTYП K ИПЗ
  ,CONT,SEMPOST.ПOЧTOBЫЙ
 YДABЛEHЫ:,LC,1
 TPHYS:,LC,
  TABLEMT:,LC,1
  FATA:,LC,1
 DISREG:,LC,1
 FULWOR:,LC,1
 MASK12:LC,BLOCK,M12B(3)
 B48/31:,LC,1
 C77777:,LC,1
  C1777:,LC,1
 C177:,LC,1
 C77:,LC,1
 C37:,LC,1
  C14:,LC,1
 C7:,LC,1
 C3:,LC,1
  ABTIME:,LC,1
  SET TIMER:,SUBP,
  DEL TIMER:,SUBP,
 SEMDOWNS:,SUBP,
 SEMUP:,SUBP,
 GIVEPAGE:,SUBP,
 NEWTA:,SUBP,
 CLOPER:,SUBP,
 NRESOFF:,SUBP,
 OUTMACRO:,SUBP,
 COБЫTИE:,SUBP,
  ERRNRES:,SUBP,
 *677:B,BLOCK,BITS
        ,CONT,B48,B47,B46,B45,B44,B43
 ,CONT,B42,B41,B40,B39,B38,B37
 ,CONT,B36,B35,B34,B33,B32,B31
 ,CONT,B30,B29,B28,B27,B26,B25
 ,CONT,B24,B23,B22,B21,B20,B19
 ,CONT,B18,B17,B16,B15,B14,B13
 ,CONT,B12,B11,B10,B 9,B 8,B 7
 ,CONT,B 6,B 5,B 4,B 3,B 2,B 1
C
 БИTMПKC:,EQU,B20
 BETB:,EQU,B18
 ЗAKP:,EQU,B17
 БЛOK:,EQU,B16
 *9 :,BLOCK,T,B,TB,A,R,C,S
C
C...   ПOЧTOBOE XOЗЯЙCTBO
 NC*5:,P*P,(NC)5
 LPLC:,EQU,NC*5+8
 POST:,LC,LPLC
 TNPBOX:,EQU,POST    .ИMEHA ПЯ
 NTRRFREC:,EQU,TNPBOX  +NC.ПPИEM ПO ИПЯ
 MESSAGE:,EQU,NTRRFREC+NC.COOБЩ. ПPИEMHИKAM
 MESSFRTS:,EQU,MESSAGE +NC.COOБЩ. OT TC
 BLRECS:,EQU,MESSFRTS+NC.OTKAЗЫ OT ПPИEMA
 TSTSC:,EQU,BLRECS  +NC.TPAHCП. CTAHЦИИ
 CLTS:,EQU,TSTSC   +1.TC БEЗ PAБOTЫ
 CLTRNSSC:,EQU,CLTS    +1.ЗAKPЫT. ПO ПEPEДAЧE
 CLRECRS:,EQU,CLTRNSSC+1.ЗAKPЫT. ПO ПPИEMY
 CLTRNREC:,EQU,CLRECRS +1.ЗAKPЫT. ПO OTCYT. ПPИEMHИKA
 TSNADMES:,EQU,CLTRNREC+1.TC C COOБЩ ДЛЯ OTCYT ПPИEMHИKOB
 NEWMESTS:,EQU,TSNADMES+1.HOBЫE COOБЩ.ДЛЯ TC
 EVENTSC:,EQU,NEWMESTS+1.PAБOTA C COБЫT
 ENDTAB:,EQU,EVENTSC
 LTAB:,EQU,MESSAGE-ENDTAB
 NRPOST:,SUBP,
C
C...  MOHOПOЛЬHЫE ЯЧEЙKИ
C
  WSFILD:I,BLOCK,TRNSTM,CHTM
C
C...   OHИ ЖE ПPИ ЗAMEHE ЛИCTOB
C
 *0:B,BLOCK,S12,S15,(1)
 ,CONT,EFR,FR,(1)
C
C...   PAБOЧEE ПOЛE B 0 ЛИCTE
C     (TO ЖE, ЧTO И B П/П EMULATOR)
C
  *121:B,BLOCK,C/TM(2)
  ,CONT,M/ПTP(2)
  ,CONT,A/ПTP(2)
C.........   И П З
 ST/EXCH:,EQU,-2
 *30:B,BLOCK,TMATH(9),NPPW(8)
 ,CONT,M/Ф,MC,ШC
 *100:B,BLOCK,(2),SAVR1,SAVR2,BUFS27
 ,CONT,INFW(5),ДШ(5),AUS
 *135:B,BLOCK,NAMTRNSR(0)
  ,CONT,SHMESS(20).KOPOTK.COOБЩ.
  ,CONT,W
 ,CONT,SCNFS,ПTP
C
C
C....   CBЯЗИ CO STARTJOB-OM :
C
  FLMAMБ:,LC,1
  B30/16:,LC,1
 NSTAJOB:,LC,1
  MШ    :,LC,1
  *ИПK:LC,BLOCK,INFBA
  *ИПK1:,LC,
  MONO:,EQU,*ИПK1+NC
  STARTJOB:,SUBP,
C
C
C     ДИAГHOCTИKA ПPИ BOЗBPATE
 CERRCALL:,EQU,B48.HE OTKPЫT ПЯ
 CBADM:,EQU,B47.HEBEPHЫЙ ЭKCTPAK
 CEROPEN:,EQU,B46.ИПЯ YЖE ЗAHЯЛИ
 CERMEM:,EQU,B45.ЧYЖOЙ ЛИCT
 CERLMES:,EQU,B44.OШ ДЛИHA COOБЩ
 CERLIST:,EQU,B43.BЫЗOB HE ИЗ TC
 CNRDYRCV:,EQU,B42.ПPИEM-K HE ГOTOB
 CERREJ:,EQU,B41.OШ.ПЯ ПPИ OTKAЗE
 CERREC:,EQU,B40.HEBEPHOE ИПЯ
 CMESSABS:,EQU,B39.HET COOБЩ.
 CRABS:,EQU,B38.HET ПPИEMHИKA
 COTKAЗ:,EQU,B37.OTKAЗ ПPИEMHИKA
 BCTPПOC:,EQU,B36.BCTPEЧH.ПOCЫЛKA
 CDINI:,EQU,B35.ПOBTOPH.OTKPЫTИE
  NEGRFS:,EQU,B34.ERR.FILE.SYST.
 BASE:B,REL,*
 ,ITA,S
  ,WTC,ГYC
 S,VTM,SAVR1.S=15
 ,ASN,64-15
 ,ITS,R
 S,AOX,
 ,ASN,64-15
 ,ITS,A
 S,AOX,.S,R,A
  ,ITS,TB
 ,ASN,64-15
 ,ITS,B
 S,AOX,
 ,ASN,64-15
 ,ITS,T
 S,AOX,.TB,B,T
 S,MTJ,TB
 TB,UTM,-SAVR2.ИПЗ ЗAДAЧИ.
  ,XTS,BITJ.ДЛЯ
  ,AOX,LIB/BOSS.ПOBЫШEHИЯ
  ,ATX,LIB/BOSS.ПPИOPИTETA
 ,WTC,ДHЗ. HOMEP ЗAДAЧИ
 T,VTM,-NF.B MПKC.
 14,MTJ,B
 C,VTM,CERREC.C=14
  ,XTA,SAVAC
 :,24,3
  TB,ATX,INFW
  ,ATI,A
 ,ASN,64+15
 ,AAX,C7
 ,ATI,S
  ,UZA,OPENPB.0 - OTKPЫTИE ПЯ
  ,AEX,C7
  ,UZA,FILESYST.7 - ФAЙЛ.CИCT.
 T,XTA,TNPBOX
 S,U1A,SWITCH-1
 C,VTM,CERRCALL.HE OTKPЫT ПЯ
  ,UJ,RETERR
C
 SWITCH:C,VTM,CERLIST.BЫЗOB HE ИЗ TC
  ,UJ,LISTFTS.1 - CПPABKA ДЛЯ TC
 :C,VTM,CERLMES.OШ.ДЛИHA COOБЩ.
  ,UJ,TRNSR.2 - ПEPEДAЧA
 :,UJ,RECVR.3 - ПPИEM
 :C,VTM,-NC1
  ,UJ,REJECT.4 - OTKAЗ OT ПPИEMA
 :,UJ,ENDJOB.5 - YHИЧTOЖ. ПЯ
 :,24,2003B
  ,UJ,CLOSETS.6 - ЗAKPЫTИE TC
C
C-----------------------------------
C
C...   OTKPЫTИE ПOЧTOBOГO ЯЩИKA
C    21P INFW - OTKPЫBAETCЯ TC
C    22P      - TC PEAГИPYET HA COБЫTИЯ
C
 OPENPB:,BSS,
 TB,WTC,BUFS27
   ,24,
 A,XTA,.ИMЯ COЗДAB-ГO
  ,24,2003B
 TB,ATX,W.ПOЧTOBOГO ЯШИKA
  ,UZA,RETERR.HEBEPHOE ИПЯ
 T,XTA,TNPBOX
 C,VTM,CDINI.ПOBTOPHOE
  ,U1A,RETERR.OTKPЫTИE
 C,VTM,CEROPEN.ИПЯ YЖE ЗAHЯЛИ
 R,VJM,SEMD
C        HET ЛИ TAKOГO ЯЩИKA
  :,24,3
 R,VTM,-NC1
 LCHPB:,BSS,
 R,XTA,TNPBOX+NC1
 TB,AEX,W
  ,UZA,RETERR.TAKOЙ ПЯ ECTЬ
 R,VLM,LCHPB
C        ЗABOДИM CBOЙ ПЯ
 TB,XTA,W
  :,24,2003B
 T,ATX,TNPBOX
  ,XTA,CLTRNREC.ЗAKP.ПEPEДATЧИKИ
 TB,ATX,W.БEЗ ПPИEMHИKOB.
  TB,XTA,INFW
  ,AAX,B21
  ,UZA,LCHTRNR
  ,XTA,BITJ.OTKPЫBAETCЯ
  ,AOX,TSTSC.TPAHCПOPTHAЯ
  ,ATX,TSTSC.CTAHЦИЯ.
 TB,XTA,INFW
 ,AAX,B22
  ,UZA,LCHTRNR
C      TC PAБOTAET C AППAPATOM COБЫTИЙ
 ,XTA,BITJ
 ,AOX,EVENTSC
 ,ATX,EVENTSC
 ,XTA,БИTMПKC
 TB,AOX,MC.MACKA
 TB,ATX,MC.COБЫTИЙ.
C     HET ЛИ COOБЩEHИЙ ЭTOMY ПЯ
 LCHTRNR:,24,3
 TB,XTA,W
 C,VTM,TSNADMES.ЗAПYCKAEM TC
 R,VTM,RETURN.C COOБЩEHИЯMИ
  ,UZA,OTKPTC.БEЗ AДPECATOB.
  ,ANX,
 ,ATI,C.ДHЗ ПEPEДATЧИKA
 R,VJM,ДAЙ ИПЗ
 R,VTM,LCHTRNR
 C,XTA,BITS
 TB,AEX,W
 TB,ATX,W
  C,WTC,*YCЫ.
  S,VTM,.ИПЗ ПEPEДATЧИKA
  ,XTA,TSTSC
  ,AAX,BITJ.MЫ -
 ,U1A,OPNTS.TC,
 S,UTM,1.OБЫЧHAЯ ЗAДAЧA.
 OPNTS:S,XTA,SHMESS+1
 T,AEX,TNPBOX.COOБЩEHИE
  ,U1A,HA ИПЗ.HE ДЛЯ HAC
  C,XTA,BITS
  ,AEX,CLTRNREC
 ,ATX,CLTRNREC
 C,XTA,BITS
 ,AOX,RDSCAL
 ,ATX,RDSCAL
  ,UJ,HA ИПЗ.OTKAЗ OT ИПЗ.
C
C-----------------------------------
C
C...   ПEPEДAЧA COOБЩEHИЯ.
C
C       ПPИЗHAKИ B INFW:
C    21P=0 - ЗAДAЧA ЗAKPЫBAETCЯ ДO TEX ПOP,
C            ПOKA HE ЗAБEPYT COOБЩEHИE
C       =1 - B 30-25P ЗAДAHO BPEMЯ B CEK,
C            B TEЧEHИИ KOTOPOГO
C            ПPИEMHИK MOЖET ЗAБPATЬ COOБЩ.
C    22P - ПEPEДAETCЯ И CTPAHИЦA
C    23  - KOHTPOЛЬ BCTPEЧHOЙ ПOCЫЛKИ
C
C       ДOПOЛHИTEЛЬHAЯ ИHФOPMAЦИЯ:
C    1 CЛOBO -26-16 ДЛИHA COOБЩ B ЛИCTE
C             15-01 ДЛИHA KOPOTKOГO COOБЩ
C    2       -ИMЯ ПЯ TC
C             0B ECЛИ ПEPEДAЧA БEЗ TC
C    3       -ИMЯ ПЯ ПPИEMHИKA
C    4       -PEЗEPB
C    5 И TД  -KOPOTKOE COOБЩ(HE БOЛEE 17)
C       ПPИ ПEPEДAЧE ИЗ TC:
C    2 CЛOBO - ИMЯ ПЯ ПPИEMHИKA
C    3       - ИMЯ ПЯ ПEPEДATЧИKA
C
 TRNSR:,BSS,
  A,VZM,SEND MESS
  TB,MTJ,S
 TB,WTC,BUFS27
 :,24,
  A,XTA,
 :,24,3
  ,ATI,R.ДЛИHA KOP. COOБЩ
 R,UTM,-17. Д.Б. <= 16 !!!
  ,ITA,R
  R,UTM,17+4.ПЛЮC ШAПKA
  ,AAX,B15
  ,UZA,RETERR.ДЛИHHOE COOБЩ.
C     KOPOTKOE COOБЩ.B CBOE ИПЗ
 S,UTM,SHMESS
 LRWR:R,UTM,-1
 TB,WTC,BUFS27
 :,24,
 A,XTA,
 :,24,3
 S,ATX,
 A,UTM,1
  R,V1M,LRWR
  SEND MESS:,BSS,
 C,VTM,CERREC.HEBEPHOE ИПЯ
 TB,XTA,SHMESS+1
 TB,AOX,SHMESS+2
  ,UZA,RETERR
 T,XTA,TNPBOX.HE CEБE ЛИ
 TB,AEX,SHMESS+1.COOБЩEHИE.
  ,UZA,RETERR
 TB,AEX,SHMESS+1
 TB,AEX,SHMESS+2
 ,U1A,CHPMES
 ,XTA,TSTSC
 ,AAX,BITJ
 CHPMES:,UZA,RETERR
 TB,XTA,INFW
 ,AAX,B22
 R,VTM,CHRCVR.TOЛЬKO KOPOTKOE
  ,U1A,PAGESTS.И CTPAHИЦA
C
 CHRCVR:,BSS,
 R,VJM,SEMD
 TB,MTJ,S
  ,XTA,TSTSC
  ,AAX,BITJ.ПEPEДATЧИK - TC
 TB,AOX,SHMESS+1.ИЛИ ПEPEДAЧA
  ,U1A,SCHRCVR.ЧEPEЗ TC,
 S,UTM,1.HAПPЯMYЮ.
 SCHRCVR:,24,3
 A,VTM,-NC1
 LSRCVR:A,XTA,TNPBOX+NC1.ГДE ЖE
 S,AEX,SHMESS+1.ПPИEMHИK
  ,UZA,PBOXIS
 A,VLM,LSRCVR
 C,VTM,CRABS.HET ПPИEMHИKA
  ,XTA,TSTSC
  ,AAX,BITJ
  ,U1A,RETERR
 TB,XTA,SHMESS+1.ПEPEДAЧA ЧEPEЗ
  ,U1A,CLTRR.TC И TC HET ???
 TB,XTA,INFW
 ,AAX,B21.ПEPEДAЧA C
  ,U1A,RETERR.ЗAKPЫTИEM ЗAДAЧИ
 CLTRR:R,VJM,SEMU
  ,XTA,BITJ
  ,AOX,CLTRNREC.ЗAKPЫBAEMCЯ
  ,ATX,CLTRNREC.ИЗ-ЗA OTCYTCTBИЯ
 R,VTM,CHRCVR.ПPИEMHИKA.
C     ЗAПYCTЯT HAC ПPИ OTKPЫTИИ ПЯ ПPИEMHИKA
  ,UJ,CLTASK
C
 PBOXIS:S,VTM,-NC1
C     ДЛЯ ПPOBEPKИ HAЛИЧИЯ OTKAЗOB OT ПPИEMA
C     HAЙДEM TPETЬEГO ПAPTHEPA ПO ПEPEДAЧE.
C     ПPИ ПEPEДAЧE ЧEPEЗ TC - ЭTO KOHEЧHЫЙ
C     ПPИEMHИK, ECЛИ OH ECTЬ. ПPИ ПEPEДAЧE
C     OT TC - ЭTO ИCXOДHЫЙ ПEPEДATЧИK.
 A,MTJ,C.ECЛИ HET
 SEAR3:TB,XTA,SHMESS+2.COOБЩEHИE
  ,UZA,FOUND3.ДЛЯ TC ИЛИ OT TC
 S,AEX,TNPBOX+NC1
 S,MTJ,C.ECЛИ ECTЬ
  ,UZA,FOUND3
 S,VLM,SEAR3
 A,MTJ,C.ECЛИ HE OTKPЫT
C     BTOPOЙ ПEPEДATЧИK -> S, ПPИEMHИK -> C
C     1. ПEPEДATЧИK - OБЫЧHAЯ ЗAДAЧA.
 FOUND3:A,MTJ,S.BTOPOЙ - TC
  ,XTA,TSTSC
  ,AAX,BITJ
  ,UZA,CHBLREC
C     2. ПEPEДATЧИK - TC
 C,MTJ,S.ИCX. ПEPEДATЧИK
 A,MTJ,C.BTOPOГO HET
 CHBLREC:,XTA,BITJ.OT KOГO
 S,AOX,BITS+NC1+NF.OTKAЗЫ
  ,ATX,CHTM
 A,XTA,BLRECS.ЧЬИ
 C,AOX,BLRECS.OTKAЗЫ
  ,AAX,CHTM
 C,VTM,COTKAЗ
  ,U1A,RETERR
C     OTKAЗOB ПPИEMA HET.
 A,UTM,NC1+NF.ДHЗ ПPИEMHИKA
  ,XTA,TSTSC
  ,AAX,BITJ.ПEPEДATЧИK
 ,U1A,CHRDYRCV.TC.
 TB,XTA,SHMESS+1.ПEPEДAЧA
 ,U1A,CLTRNS.ЧEPEЗ TC.
 ,XTA,CLTRNSSC
 T,AAX,MESSAGE
 A,AAX,BITS
 ,UZA,CLTRNS
C     ПPИEMHИK CИДИT HA ПEPEДAЧE
C     И COOБЩEHИE ДЛЯ HAC!
 TB,XTA,INF W.ECTЬ ЛИ PEAKЦИЯ
 ,AAX,B23.HA BCTP.ПOCЫЛKY
 C,VTM,BCTPПOC.- ECTЬ,
  ,U1A,RETERR.BOЗBPAЩAEMCЯ.
C     KTO-TO ДOЛЖEH BЫЙTИ ИЗ
C     TYПИKA,ПYCTЬ KЛИEHT.
 A,MTJ,C
 C,XTA,BITS
  ,AEX,CLTRNSSC
  ,ATX,CLTRNSSC
 R,VJM,ДAЙ ИПЗ
 ,XTA,BCTPПOC
  ,AOX,B1.OTB.ПEPEДATЧИKY
 C,WTC,*YCЫ
 ,ATX,W
 C,XTA,BITS
 ,AOX,RDSCAL
 ,ATX,RDSCAL
 R,VTM,CLTRNS
  ,UJ,HA ИПЗ
 CHRDYRCV:,XTA,CLRECRS.ПPИEMHИK
 A,AAX,BITS.HE ЖДET -
  ,UZA,TIMEOUT.BOЗBPAT.
 CLTRNS:,BSS,
 :,24,2003B
  ,XTA,BITJ
 A,AOX,MESSAGE-NF.ПOMEЧAEM CEБЯ
 A,ATX,MESSAGE-NF. Y ПPИEMHИKA.
 ,XTA,BITJ
 ,AOX,CLTRNSSC
 ,ATX,CLTRNSSC
 ,XTA,TSTSC
 A,AAX,BITS
  ,U1A,CHETSREC
  ,XTA,CLRECRS
 A,AAX,BITS.ECЛИ ПPИEMHИK
  ,AEX,CLRECRS.ЖДET -
  ,ATX,CLRECRS.ЧИCTИM ШKAЛY И
  ,YTA,.ЗAПYCKAEM EГO
  ,UJ ,OPENRCVR
 CHETSREC:,AOX,NEWMESTS
 ,ATX,NEWMESTS
 ,XTA,EVENTSC
 A,AAX,BITS
 ,UZA,HEPEAГ
  S,VTM,CLTRNS1-BASE
  ,ITA,A
  ,AOX,БИTMПKC-24
C
C...   ГEHEPAЦИЯ COБЫTИЯ, ЗAДAHHOГO
C      B CTAPШИX PAЗPЯДAX CYMMATOPA
C      ЗAДAЧE C ДHЗ=<MЛ.PAЗP.CYMM.>
C      PEГ.S = OTHOC.AДPEC BOЗBPATA
C
  ГEHCOБ:,24,2003B
  ,ATX,TRNSTM
  ,AAX,B48/31
  ,ATX,CHTM
  B,J+M,S
  ,ITA,S
  ,AOX,CHTM
  ,ATX,CHTM
  ,WTC,TRNSTM
  ,XTA,*YCЫ
  ,AEX,
  ,XTA,CHTM
  ,UJ,COБЫTИE
 HEPEAГ:,BSS,
 A,XTA,BITS.ПPИEMHИK - TC.
  ,AAX,CLTS.ECЛИ OHA ЗAKPЫTA
  OPENRCVR:,AOX,RDSCAL.ЗAПYCKAEM
  ,ATX,RDSCAL.ПPИEMHИK
 CLTRNS1:,BSS,
 ,XTA,
 TB,ATX,W
  S,VJM,TIMER
  :,24,3
  TB,XTA,W
  ,AEX,B1
  ,UZA,RETURN.ПPИHЯTO
  TIMEOUT:,24,2003B
  ,XTA,ZBITJ.YHИЧTOЖAEM
 A,AAX,MESSAGE-NF.COOБЩEHИE
 A,ATX,MESSAGE-NF
  ,XTA,ZBITJ.И CEБЯ
  ,AAX,CLTRNSSC.B ШKAЛE ЗAKPЫTЫX
  ,ATX,CLTRNSSC.ПO ПEPEДAЧE
 C,VTM,CNRDYRCV
  :,24,3.ПPИEMHИK
  ,UJ,RETERR.HE ПPИHЯЛ
C-----------------------------------
C
C...   ПPИEM COOБЩEHИЯ
C
C       ПPИЗHAKИ B INFW:
C    21P=0 - ЗAДAЧA ЗAKPЫBAETCЯ ДO ПOЯB-
C            ЛEHИЯ COOБЩEHИЯ
C       =1 - ЗAДAЧA ЖДET COOБЩ. B TEЧEHИИ
C            BPEMEHИ YKAЗ-ГO B 30-25P
C    22P - ПPИEM C ПЯ YKAЗAHHOГO B PEГИC-
C          TPE MЛAДШИX PAЗPЯДOB
C
C       ПO AДPECY B 15-01 PP. ПPИHИMAETCЯ:
C    2 CЛOBO - ИMЯ ПЯ TC ИЛИ 0B
C    3       - ИMЯ ПЯ ПEPEДATЧИKA
C    OCTAЛЬHЫE CЛOBA TE ЖE,ЧTO Y ПEPEД-KA
C      KOГДA ПPИHИMAET TC:
C    2       - ИMЯ ПЯ ПPИEMHИKA
C
 RECVR:,BSS,
 A,VTM,.ФЛ.-ИCTEK TAЙMEP
 TB,XTA,INFW
 ,AAX,B22
 ,UZA,CHPAGE
 TB,XTA,NAMTRNSR.ПPИEM C
  ,UZA,RETERR.YKAЗAHHOГO ПЯ.
 T,AEX,TNPBOX
  ,U1A,SETRANAM
 TB,XTA,SHMESS+1.???PAБOTA БEЗ TC
  ,UZA,RETERR.-TPEБYET OT CEБЯ
 SETRANAM:TB,XTA,NAMTRNSR
 T,ATX,NTRRFREC
 CHPAGE:,BSS,
 R,VJM,PAGESTS
 TOCHTBL:,BSS,
 R,VJM,SEMD
 T,XTA,MESSAGE
  ,UZA,CHTSMESS
  ,AAX,TSTSC
 TB,ATX,W.COOБЩEHИЯ OT TC.
 :,U1A,*+1.ПPИOPИTET TC.
 T,XTA,MESSAGE
 :,ANX,.ДHЗ
  ,ATI,C.ПEPEДATЧИKA.
  TB,XTA,INFW
  ,AAX,B22.ПPИEM
  ,UZA,CLEMSC.OT KOГO YГOДHO.
  C,VTM,-NC1
 LRR:C,XTA,TN PBOX+NC1.ИЩEM
 TB,AEX,NAMTRNSR.ЖEЛAHHЫЙ ПЯ
  ,UZA,TRRIS
  C,VLM,LRR
 ,UJ,CHTSMESS
 TRRIS:T,XTA,MESSAGE
  C,UTM,NC1+NF
  C,AAX,BITS
  ,U1A,CLEMSC.COOБЩ. ECTЬ
 ,XTA,TSTSC
 ,AAX,BITJ
 ,U1A,NWAIT
C     HE Y TC ЛИ COOБЩEHИE
 TB,XTA,W
 SCHMTS:,24,3
 ,UZA,CHTSMESS
 ,ANX,
 ,ATI,C
 R,VJM,ДAЙ ИПЗ
 C,WTC,*YCЫ
 ,XTA,SHMESS+2.ИПЯ ПEPEДATЧИKA
 TB,AEX,NAMTRNSR
 ,UZA,CLEMSC
 R,VJM,HAИПЗ
 C,XTA,BITS
 TB,AEX,W
 TB,ATX,W
 ,UJ,SCHMTS
C     COOБЩEHИЙ ПOKA HET
 CHTSMESS:,BSS,
  ,XTA,TSTSC
  ,AAX,BITJ
  ,U1A,NWAIT.TC HE ЖДET
 A,V1M,NWAIT.ИCTEK TAЙMEP
  ,XTA,BITJ
  ,AOX,CLRECRS
  ,ATX,CLRECRS
 T,UTC,MESSFRTS.OTKPЫTИE TC
 C,VTM,.C COOБЩEHИЯMИ
 R,VJM,OTKPTC.ДЛЯ HAC
 S,VJM,TIMER
 :,24,3
 TB,XTA,INFW
  ,AAX,B21
  ,UZA,TOCHTBL.ЖДEM ДO YПOPA
 A,VTM,1.YCTAHOBИM ФЛAГ
 T,XTA,MESSAGE.ECTЬ KAKOE TO
  ,U1A,TOCHTBL.COOБЩEHИE
 NWAIT:,24,2003B
  ,XTA,
 T,ATX,NTRRFREC
  ,XTA,ZBITJ
  ,AAX,CLRECRS
  ,ATX,CLRECRS
 C,VTM,CMESSABS.ДЛЯ HEЖДYЩИX
  ,UJ,RETERR.OTKAЗ
C     COOБЩEHИE ECTЬ, ЗAБИPAEM.
 CLEMSC:C,XTA,BITS
 T,AEX,MESSAGE
 T,ATX,MESSAGE
  ,XTA,
 T,ATX,NTRRFREC
 R,VJM,ДAЙ ИПЗ
 :,24,3
 C,WTC,*YCЫ
 A,VTM,.ИПЗ ПEPEДATЧИKA
 A,WTC,SHMESS.ДЛИHA
 R,VTM,4.KOP.COOБЩ.
 R,MTJ,S.+ ШAПKA
C
C...   ПEPEПИCЬ B CBOE ИПЗ
C
 TRSM:A,UTC,SHMESS
  S,XTA,-1
  TB,UTC,SHMESS
  S,ATX,-1
  S,UTM,-1
  S,VIM,TRSM
C     KOPPEKTИPOBKA ШAПKИ COOБШEHИЯ
 ,XTA,TSTSC
 ,AAX,BITJ.ПPИEMHИK
  ,U1A,CORRETS.TC.
C    ПPИEMHИK HE TC
  ,XTA,TSTSC
 C,AAX,BITS
 ,UZA,TRNMNT
C    ПEPEДATЧИK TC
 C,XTA,TNPBOX-NF.ИПЯ TC
  TB,ATX,SHMESS+1
  ,UJ,TRTM
C    ПPИEMHИK TC
 CORRETS:A,XTA,SHMESS+2.ИПЯ ПOЛYЧATEЛЯ
 TB,ATX,SHMESS+1
C    ПEPEДATЧИK HE TC
 TRNMNT:C,XTA,TNPBOX-NF.ИПЯ ПEPEДATЧИKA
  TB,ATX,SHMESS+2
C
C...   ПEPEПИCЬ ИЗ ИПЗ B ПAMЯTЬ
C
 TRTM:TB,WTC,INFW.AДPEC ДЛЯ ПPИEMA
 S,VTM,.KOPOTK.COOБЩEHИЯ
 S,VZM,TRTM2.- HE HAДO
  TRTM1:TB,UTC,SHMESS
 R,XTA,-1
  TB,WTC,BUFS27
  ,24,
 S,UTC,
 R,ATX,-1
  :,24,3
 R,UTM,-1
 R,VIM,TRTM1
  TRTM2:,BSS,
 A,XTA,INFW
 ,AAX,B22
  ,UZA,RECR RET.TOЛЬKO KOPOTKOE
C
C...   ЗAMEHA ЛИCTA ПEPEДATЧИKA
C      HA ЛИCT ПPИEMHИKA
C      (CПИCAHO ИЗ П/П EMULATOR)
C
C...   ИCПOЛЬЗYEM PEГИCTPЫ:TB,A,R,C,S
C
  R,VTM,WS FILD
  R,MTJ,S
  ,XTA,ДHЗ
  ,ASN,64-27
  ,ITS,TB
  S,AOX,.S12
  ,ITS,C
  ,ASN,64-27
  ,ITS,A
  S,AOX,.S15
  R,XTS,S12.SUM
  TB,XTS,INFW
  ,ASN,64+30
  ,AAX,C37.EFR
  A,XTS,INFW
  ,ASN,64+30
  ,AAX,C37.FR
  R,XTS,EFR.FR1
  S,ATX,
  11,MTJ,15
  15,UTM,17.MECTO И5
C
C...   COБCTBEHHO ЗAMEHA CTPAHИЦ
C    1. YПPЯTЫBAHИE PEГИCTPOB 1-5
C
 :,24,2003B
  ,ITA,5
  ,ITS,4
  ,ITS,3
  ,ITS,2
  ,ITS,1
  R,XTS,FR
  ,ATI,2
  R,MTJ,1
  15,VTM,-1
C
C...   ЖДEM KOHЦOB OБMEHOB
C
  CHEXCH:1,WTC,S15
  2,XTA,TMATH.ЧYЖOЙ
  1,WTC,EFR
  TB,AOX,TMATH.CBOЙ
 ,AAX,B46.CM.MACRO70
  ,UZA,ЗAM1.CM.PAGESTS
  ,XTA,DISREG
  ,ATI,27B
  ,*57,3.TPEM ЗAДAЧE I1,2
  :,24,2003B
  ,UJ,CHEXCH
C
C    2. BЫБOPKA XAPAKTEPИCTИK ЛИCTOB
C
  ЗAM1:1,XTA,EFR
  ,ATI,11.MAT.ЛИCT
  ,AAX,C3
  ,ATI,12
  12,XTA,M12B
  15,ATX,M/ПTP+1.MACKA ПTP
  ,ITA,11
  ,ASN,64+2
  1,ARX,S12
  15,ATI,3.AДPEC B ПTP
  1,WTC,S12
  11,XTA,TMATH
  15,ATX,C/TM+1.KOПИЯ TMATH
  ,ASN,64+30
  ,AAX,C177
  ,UZA,KЗAM1
C
C    3. ECЛИ ЛИCT B MOЗY, MEHЯEM
C       EГO ИДEHTИФИKATOP B TPHYS
C
  ,ATI,5.ФИЗ.ЛИCT
  1,WTC,S12
  13,VTM,."CBOE" ИПЗ
  1,XTA,FR
  ,ASN,64-21
  1,AOX,S15."ЧYЖOЙ" ИДEHT.
  ,ATI,12."ЧYЖOE" ИПЗ
  5,AEX,TPHYS
  ,AAX,B33/22
  5,AEX,TPHYS
  5,ATX,TPHYS
C
C    4. KOPPEKЦИЯ ЧИCЛA ЛИCTOB B MOЗY
C
  ,XTA,B1.HOBOMY
  12,ARX,NPPW.BЛAДEЛЬЦY
  12,ATX,NPPW.ПPИБЫЛO,
  ,XTA,CM1
  13,ARX,NPPW.Y CTAPOГO
  13,ATX,NPPW. - YБЫЛO
  5,CALL,CLOSPAGE.OTПИCKA
C...
  KЗAM1:1,UTM,1
  15,VLM,ЗAM1
C
C    5. ПEPECTAHOBKA B ПTP
C
  15,VTM,A/ПTP
  2,XTA,ПTP
  ,APX,M/ПTP
  3,XTS,ПTP
  ,APX,M/ПTP+1
  15,AEX,
  15,ATX,
  ,AUX,M/ПTP
  2,AEX,ПTP
  2,STX,ПTP
  ,AUX,M/ПTP+1
  3,AEX,ПTP
  3,ATX,ПTP
C
C    6. ПEPECTAHOBKA B TMATH
C
  3,VTM,-1
  ЗAM2:1,XTA,FR-2
  1,ARX,S15-2
  ,ATI,13."ЧYЖOE" ИПЗ
  3,XTA,C/TM+1."CBOЯ" CTPOKA
  13,AEX,TMATH
  ,AAX,B48/31
  13,AEX,TMATH
  13,ATX,TMATH
  ,ASN,64+30
  ,ATI,13.ФИЗ.ЛИCT
  1,UTM,-1
  ,AAX,B17.ЗAKPЫT ПO
  ,U1A,KЗAM2.ПPИOPИTETY
  13,VZM,KЗAM2.ИЛИ YKAЧAH
  15,CALL,OPENPAGE.ПPИПИCKA
  KЗAM2:3,VLM,ЗAM2
C
C    7. YCTAHOBKA PП И PЗ
C
  ,WTC,ГYC
  15,VTM,
  15,MTJ,TB.BOCCTAH.TB
  14,CALL,PUT TMP
C
C    8. BOCCTAHOBЛEHИE PEГИCTPOB
C
  15,UTM,-2
  1,XTA,S15
  ,ASN,64+27
  ,STI,C.ДHЗ ПEPEДATЧИKA
  ,STI,1
  ,STI,2
  ,STI,3
  ,STI,4
  ,ATI,5
  RECR RET:,24,3
 C,XTA,BITS
 ,AEX,FULWOR
 ,AAX,CLTRNSSC
 ,ATX,CLTRNSSC
  ,XTA,B1.ПPИЗHAK -ЗAБPAЛИ
 COPERET:C,WTC,*YCЫ
  ,ATX,W
 R,VJM,HA ИПЗ
 C,XTA,BITS
 ,AOX,RDSCAL
 ,ATX,RDSCAL
  ,UJ,RETURN
C
C-----------------------------------
C
C        CПPABKA ДЛЯ TPAHCП. CTAHЦИИ.
C
C    21P=0 - CПИCOK ПOЧTOBЫX ЯЩИKOB
C       =1 - CПИCOK COOБЩ.ДЛЯ TC И
C            ГOTOBЫX ПPИEMHИKOB
C
 LISTFTS:,XTA,TSTSC
  ,AAX,BITJ.HE ДЛЯ TC
  ,UZA,RETERR.HE PAЗPEШAETCЯ
  S,VTM,
  TB,XTA,INFW
  ,AAX,B21
  ,U1A,LISTRTR
C     CПИCOK ПOЧTOBЫX ЯЩИKOB
  C,VTM,-NC1
 LIST1:C,XTA,TNPBOX+NC1
  ,UZA,ELIST1
 TB,WTC,BUFS27
  ,24,
  A,UTC,
  S,ATX,1
 :,24,3
  S,UTM,1
 ELIST1:,BSS,
  C,VLM,LIST1
  ,ITA,S.KOЛ-BO ЯЩИKOB
  ,UJ,LISRET
C     ПEPEДATЧИKИ C COOБЩEHИЯMИ ДЛЯ HAC
 LISTRTR:,BSS,
 T,XTA,MESSAGE
 LIST2:,UZA,SNMESS
  TB,ATX,W
  ,ANX,
  ,ATI,C
 C,XTA,TNPBOX-NF.ИПЯ ПEPEДATЧИKA
 TB,WTC,BUFS27
 :,24,
  A,UTC,
  S,ATX,1
  S,UTM,1
  :,24,3
  TB,XTA,W
  C,AEX,BITS
  ,UJ,LIST2
 SNMESS:,ITA,S
  ,AOX,=I0
 TB,WTC,BUFS27
  ,24,
  A,ATX,
  S,UTC,
  A,UTM,1
  S,VTM,
C     CПИCOK OЖИДAЮЩИX ПPИEMHИKOB.
  :,24,3
  ,XTA,CLRECRS
 LIST3:,UZA,SNTRRS.ИCЧEPПAЛИ
  TB,ATX,W
  ,ANX,
  ,ATI,C.ДHЗ.
  C,XTA,TNPBOX-NF.ИПЯ ПPИEMHИKA
  ,AEX,
  C,XTA,NTRRFREC-NF.OT KOГO XOЧET
 TB,WTC,BUFS27
 :,24,
  A,UTC,
  S,ATX,2
  ,YTA,
  A,UTC,
  S,ATX,1
 :,24,3
  S,UTM,2
  TB,XTA,W
  C,AEX,BITS
  ,UJ,LIST3
 SNTRRS:,ITA,S.KOЛ-BO ЭЛEMEHTOB
  ,ASN,64+1.CПИCKA
 LISRET:,AOX,=I0
 TB,WTC,BUFS27
 :,24,
  A,ATX,
 :,24,2003B
  ,UJ,RETURN
C-----------------------------------
C
C       ЗAKPЫTИE TC ИЗ-ЗA OTCYTCTBИЯ PAБOTЫ.
 CLOSETS:,BSS,
 ,XTA,NEWMESTS
 ,AAX,BITJ.ECTЬ HOBЫE
 ,U1A,CLETAB1.COOБЩEHИЯ
 TB,WTC,BUFS27
 :,24,
  A,XTA,
 :,24,3
  ,ATI,S.ДЛИHA CПИCKA
 R,VJM,SEMD
 LMFRTS:S,VZM,CLOTS
 S,UTM,-1
 TB,WTC,BUFS27
 :,24,
  A,XTA,1.ИПЯ ПPИEMHИKA
  ,AEX,
 A,XTA,2.ИПЯ ПEPEДATЧИKA
 :,24,3
  ,ATX,CHTM
  ,YTA,
  ,UZA,ELSCH.ЧYШЬ!
  TB,ATX,W
  C,VTM,-NC1
 LSCHRECR:C,XTA,TNPBOX+NC1
  TB,AEX,W
  ,UZA,RECRIS
  C,VLM,LSCHRECR
C     ПPИEMHИKA HET
  ,XTA,BITJ.B ШKAЛY COOБЩ.
  :,24,2003B
  ,AOX,TSNADMES.K HECYЩECTB.
  ,ATX,TSNADMES.AДPECATAM.
  ,UJ,ELSCH
C     ПPИEMHИK ECTЬ
 RECRIS:,XTA,CLRECRS
 C,AAX,BITS+NC1+NF.ПPИHИMATЬ
  ,UZA,SETMFRTS.ПOKA HE XOЧET
 C,XTA,NTRRFREC+NC1.ПPИHИMAET
  ,UZA,NOTCL.OT ЛЮБOГO.
  ,AEX,CHTM.OT ЖEЛAEMOГO
 ,UZA,NOTCL.ПEPEДATЧИKA
  ,AEX,CHTM
 T,AEX,TNPBOX.OT HAC ПPИMET
  ,UZA,NOTCL.ЛЮБOE COOБЩEHИE.
C     ПPИЗHAK HAЛИЧИЯ COOБЩ-ИЯ OT TC
 SETMFRTS:,BSS,
 :,24,2003B
  ,XTA,BITJ
 C,AOX,MESSFRTS+NC1
 C,ATX,MESSFRTS+NC1
 ELSCH:A,UTM,2
  ,UJ,LMFRTS
C     ЗAKPЫBAEM TPAHCПOPTHYЮ CTAHЦИЮ
  CLOTS:,BSS,
 R,VJM,SEMU
 ,XTA,EVENTSC
 ,AAX,BITJ
 ,UZA,CLOTS1
 TB,XTA,M/Ф
 ,AAX,BETB.ПOKA KPYTИЛИCЬ
 ,U1A,OPENTS.ПPOИЗOШЛO COБЫT
 ,XTA,ЗAKP.ПPИЗHAK
 TB,AOX,M/Ф.OЖИДAHИЯ
 TB,ATX,M/Ф.COБЫTИЯ.
 TB,XTA,ДШ
 ,AOX,БЛOK.PAЗPEШEHИE
 ,AEX,БЛOK.BETBЛEHИЯ
 TB,ATX,ДШ
 CLOTS1:,BSS,
  ,XTA,BITJ
  ,AOX,CLTS
  ,ATX,CLTS
 R,VTM,OPENTS
  ,UJ,CLTASK
 NOTCL:,BSS,
 :,24,2003B
  ,XTA,EVENTSC
  ,AAX,BITJ
  ,UZA,OPENTS
  ,XTA,БИTMПKC
 TB,AOX,ШC
 TB,ATX,ШC
  ,XTA,BETB.COБЫTИE-HAЛИЧИE
 TB,AOX,M/Ф.ПPИEMHИKA BЫPA-
 TB,ATX,M/Ф.БATЫBAEM CAMИ.
 OPENTS:,24,2003B
  C,VTM,-NC1
 CLETABTS:,XTA,ZBITJ
  C,AAX,MESSFRTS+NC1
  C,ATX,MESSFRTS+NC1
  C,VLM,CLETABTS
  ,XTA,ZBITJ
  ,AAX,TSNADMES
 ,ATX,TSNADMES
 CLETAB1:,BSS,
 ,XTA,ZBITJ
 ,AAX,NEWMESTS
 ,ATX,NEWMESTS
 ,XTA,CLTS
  ,AEX,BITJ.TC БЫЛA ЗAKPЫTA
  ,AAX,EVENTSC.ИЛИ БEЗ COБЫTИЙ
 ,AAX,BITJ
 ,UZA,CLT2
C      HE YCПEЛИ ЗAKPЫTЬCЯ,ПOЭTOMY
C      CXOДИM HA BETBЛEHИE
 TB,XTA,ДШ
 ,AOX,БЛOK.PAЗPEШEHИE
 ,AEX,БЛOK.BETBЛEHИЯ
 TB,ATX,ДШ
 R,VTM,CLT2
 R,MTJ,33B
  ,MTJ,27B
 ,UJ,NEWTA
 CLT2:,XTA,ZBITJ
 ,AAX,CLTS
 ,ATX,CLTS
  ,UJ,RETURN
C-----------------------------------
C
C        OTKAЗ OT ПPИEMA.
 REJECT:,BSS,
 R,VJM,SEMD
 TB,WTC,BUFS27
 :,24,
 A,XTA,.ИMЯ
 :,24,3.ПOЧTOBOГO
  TB,ATX,W.ЯЩИKA.
 ,UZA,ERREJ
 T,AEX,TNPBOX.OTKAЗ OT CEБЯ
  ,UZA,ERREJ
 LREJ:C,XTA,TNPBOX+NC1
  TB,AEX,W
 ,UZA,REJPBIS
 C,VLM,LREJ
 ERREJ:C,VTM,CERREJ.ПЛOXOE ИПЯ
  ,UJ,RETERR
C
 REJPBIS:,BSS,
 C,UTM,NC1+NF
 C,XTA,BITS
 T,AOX,BLRECS
 T,ATX,BLRECS
  ,XTA,CLTRNSSC
 T,AAX,MESSAGE
 C,AAX,BITS
  ,UZA,RETURN
C     ПEPEДATЧИK ЗAГOTOBИЛ COOБЩEHИE
 R,VJM,ДAЙ ИПЗ
  ,XTA,COTKAЗ.OTK. ПEPEДATЧИKY
  ,UJ,COPERET
C
C-----------------------------------
C        YHИЧTOЖEHИE ПOЧTOBOГO ЯЩИKA
C          CЮДA И Э74 XOДИT.
 ENDJOB:,BSS,
 R,VJM,SEMD
 CHCLTRN:,24,3
 T,XTA,MESSAGE
 ,UZA,CLETAB
  ,ANX,
 ,ATI,C
 C,XTA,BITS
 T,AEX,MESSAGE
 T,ATX,MESSAGE
 R,VJM,ДAЙ ИПЗ
 R,VTM,CHCLTRN
 C,WTC,*YCЫ
 A,VTM,
 ,XTA,TSTSC
 C,AAX,BITS
 ,U1A,SETFLTRN
 A,XTA,INFW
 ,AAX,B21
  ,UZA,HA ИПЗ
C      PAЗБYДИM TC И ПEPEДATЧИKИ
C      (C B21 B INFW) ЗAKPЫTЫE ПO ПOCЫЛKE
C      K HAM.
 SETFLTRN:,XTA,CRABS
 A,ATX,W
 C,XTA,BITS
  ,AOX,RDSCAL
  ,ATX,RDSCAL
  ,UJ,HA ИПЗ
 CLETAB:,BSS,
 :,24,2003B
 T,ATX,TNPBOX
 T,ATX,NTRRFREC
 T,ATX,MESSFRTS
 T,ATX,BLRECS
  C,VTM,LTAB
 LCLETAB:,XTA,ZBITJ
  C,AAX,ENDTAB
  C,ATX,ENDTAB
  C,VLM,LCLETAB
 R,VTM,RETURN
 ,UJ,SEMU
C-----------------------------------
C
C***   PAБOTA C CEMAФOPOM
 SEMD:,24,2003B
 ,ITA,R
 ,AOX,SEMW
 ,UJ,SEMDOWNS
 SEMU:,24,2003B
 ,ITA,R
 ,AOX,SEMW
 ,UJ,SEMUP
 SEMW:,Z00,SEMPOST
 ,Z00,
C
C***   ПPOBEPKA ДOCTYПHOCTИ ЛИCTA OБMEHA
 PAGESTS:,BSS,
 :,24,2003B
 TB,XTA,INFW
 ,ASN,64+30
 ,AAX,C37
 ,ATI,S.N MAT.ЛИCTA
 TB,UTC,TMATH
 S,XTA,
 ,ASN,64+30
 C,VTM,CERMEM.ЛИCT
  ,UZA,RETERR.HE ЗAKAЗAH
 ,AEX,B18
 R,UZA,.HE ПOTPEБЛЯЛCЯ
 ,AAX,C177.
 R,UZA,.B ПOДKAЧKE
 ,ITA,S
 ,ASN,64-10
 ,ATI,S
 :,24,2000B.ЖДEM
 S,XTA,1.KOHЦA OБMEHA
 :,24,2003B
 R,UJ,
C
C***   AKTИBИЗAЦИЯ TPAHCПOPTHЫX CTAHЦИЙ
C***   ПO ЗAДAHHOЙ ШKAЛE
  OTKPTC:,24,3
  C,XTA,.ШKAЛA
  ,AAX,EVENTSC
  ,UZA,БEЗPEAK
  ,ANX,
  ,ATI,S
  :,24,2003B
  S,XTA,BITS
  C,AEX,
  C,ATX,
  ,ITA,S
  ,AOX,БИTMПKC-24
  S,VTM,OTKPTC-BASE
  ,UJ,ГEHCOБ
 БEЗPEAK:,24,2003B
         C,XTA,.OTKPЫTИE
 ,AAX,CLTS.TC
 ,AOX,RDSCAL.PAБOTAЮЩИX
 ,ATX,RDSCAL.БEЗ COБЫTИЙ
 R,UJ,
C
C***   BЫKAЧИBAHИE ИПЗ B ПAMЯTЬ
 ДAЙ ИПЗ:,BSS,
 :,24,2003B
 ,XTA,Ш/FULL
 C,AAX,BITS
 R,UZA,.CЛYЖ.ЗAДAЧA
  ,ITA,C
  ,ASN,64-9
  ,ATI,S.=15
 S,UTM,50B.ДЛЯ GIVEPAGE
 ,ITA,B
  ,ARX,*+2
 A/Д/ИПЗ:,UJ,SEMDOWNS
  ,Z00,Д/ИПЗ-BASE
 :,Z00,SEM212
  ,Z00,*+1-BASE
C        BPEMEHHЫЙ HAPKOЗ
 :C,XTA,BITS
 ,AOX,YДABЛEHЫ
 ,ATX,YДABЛEHЫ
 ,AEX,FULWOR
 ,AAX,MRDSCAL
 ,ATX,MRDSCAL
 Д/ИПЗ:,ITA,B
 ,ARX,A/Д/ИПЗ
 ,ATI,33B
 C,XTA,*YCЫ
 ,ASN,64+10
 ,AAX,C37
  ,UZA,GIVEPAGE
 ,ATI,15.ИПЗ B ПAMЯTИ.
 15,XTA,TPHYS
 ,AOX,B1
 15,ATX,TPHYS
 R,UJ,
C
C***   OTПYCKAHИE ИПЗ
 HA ИПЗ:,BSS,
 :,24,2003B
 ,XTA,Ш/FULL
 C,AAX,BITS
 R,UZA,.CЛYЖ.ЗAДAЧA
 C,XTA,*YCЫ
 ,ASN,64+10
 ,AAX,C37
 ,ATI,S
 S,XTA,TPHYS
 ,AEX,B1
 S,ATX,TPHYS
 ,XTA,YДABЛEHЫ
 ,AOX,MRDSCAL
 ,ATX,MRDSCAL
 ,XTA,
 ,ATX,YДABЛEHЫ
 ,ITA,R
 ,AOX,BSEM212
 ,UJ,SEMUP
 BSEM212:,Z00,SEM212
 ,Z00,
C
C***   ЗAKPЫTИE ЗAДAЧИ ПPИ ПPИEME/ПEPEДAЧE
C      ПPИ 21P=0 - ЗAKPЫBAETCЯ ДO OБMEHA
C             =1 - HA ЧИCЛO CEK. B PEГ. A
C
  TIMER:R,VJM,SEMU
  S,MTJ,R
  TB,XTA,INFW
  ,AAX,B21
  ,UZA,CLTASK.ПOПPOCTY
  ,RTE,7777B
  ,ATX,SAVSR
  TB,XTA,INFW
  ,ASN,64+24.BPEMЯ
  ,AAX,C77.OЖИДAHИЯ
  ,AOX,=I0
  ,NTR,2
  ,A+X,ABTIME
  ,ASN,64+21
  ,ASN,64-6
  ,AOX,Д H З
  ,ASN,64-15
  ,AOX,P/NEWTA
  R,CALL,SET TIMER
  R,VJM,CLTASK.ЗAKPЫЛИCЬ
  S,MTJ,R
  ,XTA,ДHЗ.ПEPEД
  ,ASN,64-15.YXOДOM - CHИMEM
  ,UJ,DEL TIMER.БYДИЛЬHИK
  P/NEWTA:,Z00,
  ,Z00,NEWTA
C
C***   ЗAKPЫTИE ЗAДAЧИ
 CLTASK:,BSS,
 :,24,2003B
 ,ITA,15
 15,VTM,SAVI15
 ,ITS,14
 ,ITS,13
 R,VTM,RETCLT
 R,MTJ,33B
C      ДЛЯ TC PAБOTAЮЩEЙ C COБЫTИЯMИ
C      27 ИP CДEЛAEM HYЛEBЫM, ЧTOБ SELECT
C      CXOДИЛ HA BETBЛEHИE. ПOДПPOГPAMMA
C      BETBЛEHИЯ ДOЛЖHA ЗAHECTИ DISREG
C      B ПOЛE YПPЯTЫBAHИЯ 27 ИP.
 13,VTM,NEWTA
  ,XTS,DISREG
  ,ATI,27B
  ,XTA,BITJ
 ,AAX,EVENTSC
  ,UZA,NOTEVCLO
  ,AAX,CLTS
  ,UZA,CLOPER
  ,MTJ,27B
  ,UJ,CLOPER
C      PAЗPEШEHИE YKAЧИBAHИЯ ИПЗ
 NOTEVCLO:,WTC,ГYC
  ,XTA,BUFS27
  ,AAX,C14
  ,U1A,CLOPER.HEЛЬЗЯ
  ,XTA,BITJ.MOЖHO
 ,AOX,MOЖHOKAЧ
 ,ATX,MOЖHOKAЧ
 ,UJ,CLOPER
 RETCLT:,WTC,ГYC
 TB,VTM,
 ,XTA,MOЖHOKAЧ
 ,AAX,ZBITJ
 ,ATX,MOЖHOKAЧ
 ,XTA,SCOPER
 ,AAX,ZBITJ
 ,ATX,SCOPER
  ,XTA,ZBITJ
  ,AAX,WAITMT
  ,ATX,WAITMT
 R,UJ,
C
C...   ИHTEPФEЙC ПOЛЬЗOBATEЛЯ C
C      ФAЙЛOBOЙ CИCTEMOЙ.
C      ------------------------
C
C    1-35 PAЗPЯДЫ INFW TPAKTYЮTCЯ ПOЧTOЙ
C    KAK OБЫЧHO.  KPOME TOГO, B 37-39 P.
C    ЗAДAETCЯ HOMEP ФAЙЛOBOЙ CИCTEMЫ;
C    B 40-42 P. : JOB - KOД OПEPAЦИИ;
C    B 43-48 P. : LUN - MAT.HOMEP (30-67B)
C
C    1-15 P. INFW COДEPЖAT A - AДPEC MACCИBA
C    ИЗ 20 CЛOB.  ECЛИ A=0, TO KOPOTKOE CO-
C    OБЩEHИE CЧИTAETCЯ YЖE ПOДГOTOBЛEHHЫM B
C    141-161 CЛOBAX ИПЗ.
C
C    ЗHAЧEHИЯ  JOB :
C    0 - OTKPЫTИE ФAЙЛA C HOMEPOM LUN
C    1 - ЗAKPЫTИE   ---"---
C    2 - ПPOCTO ПEPEДAЧA, ЗATEM ПPИEM
C    6 - BXOД ДЛЯ Э070
C    7 - TOЛЬKO ПEPEДAЧA, БEЗ ПPИEMA
C
C    ПEPEДAЮTCЯ BCEГДA ПEPBЫE 16 CЛOB
C    MACCИBA A, ПPИЧEM B ПEPBOM ИЗ HИX
C    ДOЛЖEH HAXOДИTЬCЯ KOП ФAЙЛOBOЙ CИC-
C    TEMЫ (B 1-6 P.), A B 43-48 P.
C    ЭKCTPAKOД BCTABЛЯET  ДHЗ ЗAДAЧИ.
C    B 42-33 P. BCTABЛЯETCЯ NPASS USER'A
C    ФИKCИPOBAHЫ: KOП=14B - ЗAKAЗ OT Э070
C    (ПPИ ЭTOM 2-E CЛOBO  A COДEPЖИT IW70)
C    И KOП=13B - ЗAKAЗ OT Э074.
C
C    ПOCЛE ПEPEДAЧИ,ECЛИ JOB<7, ПPOИЗBOДИTCЯ
C    ПPИEM OTBETA ФAЙЛOBOЙ CИCTEMЫ B 5-20
C    CЛOBA MACCИBA  A.
C    ПEPBOE CЛOBO OTBETA, T.E. A(5), OБЯЗAHO
C    COДEPЖATЬ B 1-15 P. "0" - ECЛИ BCE
C    HOPMAЛЬHO, ИHAЧE HOMEP OШИБKИ Ф.C.
C    KPOME TOГO, Ф.C. MOЖET CФOPMИPOBATЬ
C    B 2-3 CЛOBAX OTBETA (A(6) И A(7)) TEKCT
C    ДИAГHOCTИKИ ДЛЯ ERRMACRO (KOД ГOCT,
C    12-Й CИMBOЛ = '231'). ПPИЗHAK HAЛИЧИЯ
C    ДИAГHOCTИKИ - "1" 48-ГO P. A(5)
C
C    ПOCЛE BЫДAЧИ ЭKCTPAKOДA CYMMATOP
C    COДEPЖИT 0B, ECЛИ BCE HOPMAЛЬHO,
C    ИHAЧE - БИT OШИБKИ
C    48-35 : БИTЫ OШИБOK ПOЧTЫ
C     34   : CИГHAЛ OШИБKИ OT Ф.C.
C
C----------------------------------------
C
C...   ИCПOЛЬЗYEM ДOПOЛHИTEЛЬHO B BUFS27:
C      48     : ECTЬ BHYTPEHHИЙ BOЗBPAT
C      39-25  : BHYTP.OTHOC.AДPEC BOЗBPATA
C
C...   ECЛИ П/Я HE OTKPЫT, B KAЧECTBE
C      ИMEHИ П/Я ИCПOЛЬЗYEM CBOE ДHЗ
C
  FILE SYST:T,XTA,TNPBOX
  ,U1A,*+2
  ,XTA,ДHЗ
  T,ATX,TNPBOX
  :TB,XTA,INFW
  ,AOX,=:0000 0077 0400.MAKCИM.
  TB,ATX,INFW.BPEMЯ OЖИДAHИЯ
  ,ASN,64+39
  ,AAX,C7
  ,ATI,C.KOП
 ,UZA,CHLUN
 ,AEX,C6
  ,U1A,FHEAD
C
C...  BCTABKA LUN B INFW
C     ПPИ PAБOTE OT Э070
C
  TB,XTA,SHMESS+5
  ,ASN,64+12
  ,ASN,64-42
  TB,AOX,INFW
  TB,ATX,INFW
C
C...  ПOИCK ПO FATA C ЦEЛЬЮ :
C    A) KOHTPOЛЯ LUN ПPИ OPEN
C    Б) OПPEДEЛEHИЯ NFS ПPИ Э070
C
  CHLUN:TB,XTA,INFW
  ,ASN,64+6
  ,AOX,ГYC
  TB,ATX,SHMESS+1
  A,VTM,-47
  R,VTM,-LFATA
  CHFAT:R,XTA,FATA+LFATA
  TB,AEX,SHMESS+1
  ,AAX,MASK12
  ,U1A,ECHFAT
  C,VZM,BADEXCH
  R,XTA,FATA+LFATA
  ,APX,=13 0000 0000.STATUS+NFS
  ,ASN,64+9
  TB,AOX,INFW
  TB,ATX,INFW
  ,UJ,FHEAD
  ECHFAT:R,VLM,CHFAT
  C,VIM,BADEXCH
C
C...  HE ЗAHЯT ЛИ MAT.HOMEP ЛEHTOЙ
C
  CHTMT:A,XTA,TABLEMT+47
  TB,AEX,SHMESS+1
  ,AAX,MASK12
  ,UZA,BADEXCH
  A,VLM,CHTMT
C
C...   ФOPMИPOBAHИE ШAПKИ COOБЩEHИЯ
C
  FHEAD:S,VTM,SHMESS
  TB,J+M,S
    ,XTA,B5.ДЛИHA=16
  ,XTS,."БEЗ TC"
  TB,XTS,INFW.ИMЯ
  ,ASN,64+36.CИCTEMЫ
  ,AAX,C3.***
  ,ATI,A
C
C...   ПPOБA ДOCTYПHOCTИ Ф.C.
C
  ,XTA,USEFS
  A,AAX,B24
  ,UZA,BADEXCH
  ,ITA,A
 ,ARX,=6HFILESD.***
  A,XTS,B15
  TB,AOX,SCNFS.B ШK.HOMEPOB
  TB,ATX,SCNFS.ФAЙЛ.CИCTEM
  ,XTA,
  TB,XTS,INFW
  ,ATI,A
  A,VZM,NOTRMFS
C
C...   ПEPEПИCЬ COOБЩEHИЯ B ИПЗ
C
  R,VTM,-15
  TRMFS:TB,WTC,BUFS27
  ,24,
  R,UTC,15
  A,XTA,
  :,24,3
  S,ATX,.S=15 !
  R,VLM,TRMFS
C
C...   ДHЗ И NPASS B 1-E CЛOBO COOБЩEHИЯ
C
  NOTRMFS:TB,XTA,AUS
  ,AAX,C1777
  ,ASN,64-32
  ,AOX,ГYC
  TB,AEX,SHMESS+4
  ,AAX,=:7777 74
  TB,AEX,SHMESS+4
  TB,ATX,SHMESS+4
C
C...   ПOШЛИ HA ПEPEДAЧY
C
  TB,XTA,BUFS27.BHYTP.BOЗBPAT
  ,AOX,ARETSEND
  TB,ATX,BUFS27.YCTAHOBИM
  ,UJ,SEND MESS
  ARETSEND:8,Z00,AFSEND-BASE
  ,Z00,
  ARETINP:,Z00,AFINP-AFSEND
  ,Z00,
C
C...    ПOCЛE ПEPEДAЧИ
C
  AFSEND:TB,XTA,INFW
  ,ASN,64+39
  ,AAX,C7
  ,ATI,C
  ,AEX,C7
  ,UZA,RESTORE.БEЗ ПPИEMA
  TB,XTA,W.БЫЛA ЛИ ABAPИЯ
  ,UZA,TO INP.HA ПEPEДAЧE
C...   ЧTO ИMEHHO ЗA ABAPИЯ
  ,AEX,CRABS
  ,U1A,AFINP1
C...   OБHAPYЖEHO OTCYTCTBИE Ф.C.
C    ПPИ PAБOTE ДЛЯ Э070 ИЛИ ЗAKPЫTИИ ФAЙЛA
C    ЖДATЬ ПOЯBЛEHИЯ HOBOЙ Ф.C. HE CTOИT
  ,ITA,C
  ,AEX,B1
  ,UZA,AFINP1
  ,AEX,C7.KOП = 6
  ,UZA,TO INP
C...   ИHAЧE ПOДOЖДEM
  ,XTA,FLMAMБ. MAЛO MБ
  ,U1A,AFINP1.-ДA
  ,XTA,Ш/ПYCK
  ,ATX,CHTM
  G/SHI:,24,3
  ,XTA,CHTM
  ,UZA,AFINP1.HET ШИФPA
  ,ANX,
  ,ATI,C.ДHЗ
  C,XTA,BITS
  ,AEX,CHTM
  ,ATX,CHTM
  :,24,2003B
  C,XTA,*YCЫ
  ,UZA,G/SHI
  ,AAX,B30/16
  ,U1A,G/SHI.ШИФP ЗAHЯT
  ,XTA,B47
  ,ATX,NSTAJOB
  ,ITA,C
  ,ATX,MШ
  ,XTA,Д H З
  ,ASN,64-16
  C,ATX,MONO-NF
  ,XTA,B19
  C,ATX,INFBA-NFM
  C,XTA,BITS
  ,AOX,БЛOKAЦПY
  C,XTA,BITS
  ,AOX,ПAPTИЗAH
  ,ATX,ПAPTИЗAH."CЛA"
  ,XTA,DISREG
  ,ATI,27B
  R,VTM,OTЛYП
  R,MTJ,33B
C...  ИMЯ ЗAПYCKAEMOЙ ЗAДAЧИ = ИПЯ Ф.C.
  ,XTA,ZBITJ
  ,AAX,MRDSCAL
  ,ATX,MRDSCAL
C...   ПEPEД ЗAПYCKOM - OCBOБOДИM
C      CEMAФOP  CHEKJOB*-A
  ,XTA,INF/PUSH
  ,UJ,SEMUP
  INF/PUSH:,Z00,SEM/RES
  ,Z00,STARTJOB
C
C...   OPГAHИЗAЦИЯ ЗAДEPЖKИ ДO
C      ПOЯBЛEHИЯ ПOЧT.ЯЩИKA Ф.C.
C      ПPИ BЫЗOBE ИЗ OCCUPYD - ЗAДAЧE
C      COOБЩAETCЯ, ЧTOБЫ OHA CДEЛAЛA
C      ПOBTOPHЫЙ BXOД, OCBOБOДИB
C      ПPEДBAPИTEЛЬHO KPИT.ИHTEPBAЛЫ
C
  OTЛYП:,XTA,SEM/DIS
  ,AEX, Д H З
  ,AAX,C77
  ,U1A,CLTRR.ПOПPOCTY
  ,XTA,=6HOTЛYП
  TB,ATX,W
  ,UJ,RESTORE
C
C...   OPГAHИЗAЦИЯ ПPИEMA OTBETA
C
 TO INP:TB,MTJ,15
  15,UTM,SHMESS+4
  ,XTA,FULWOR
  ,XTS,TNOFS
  ,XTS,TNOFS+1
 TB,XTS,W.ПPOПAЛA Ф.C.
  ,U1A,AFINP1.ПPИ OБMEHE
  ,XTA,B22
 TB,AOX,INFW
 TB,ATX,INFW
  ,XTA,ARETINP
  TB,ARX,BUFS27
  TB,ATX,BUFS27
  TB,XTA,SHMESS+2.ИMЯ Ф.C.
  TB,ATX,NAMTRNSR
  ,UJ,RECVR
C
C...   ПOCЛE ПPИEMA
C
  AFINP:TB,XTA,INFW
  ,ASN,64+39
  ,AAX,C7
  ,ATI,C
  AFINP1:,24,3
 TB,XTA,INFW
  ,ASN,64+42
  ,ATI,R.LUN
  ,ITA,C.ПPИ ЗAKPЫTИИ
  ,AEX,B1.BCEГДA
  ,UZA,S/FATA.ЧИCTИM FATA
  TB,XTA,SHMESS+4
  ,AAX,C77777
  TB,AOX,W
  ,U1A,ANAL.OШИБKИ
  ,ITA,C
  ,U1A,ANAL
C
C...  ЗAГOTOBKA CTPOЧKИ HAШEГO ФAЙЛA
C     B FATA :
C      48:43  - ДHЗ
C      42:37  - LUN
C      36:31  - NMOD=77
C      28:27  - CTATYC OБMEHA
C      26:25  - HOMEP ФAЙЛ.CИCTEMЫ
C      12:1   - PAЗMEP ФAЙЛA - 1
C
  S/FATA:,XTA,ДHЗ
 ,ASN,64-12
  ,AOX,C77
  ,ASN,64-30
  TB,ATX,SHMESS+1
  TB,XTA,INFW
  ,AUX,=:0077 0713 0000 0000
  TB,AOX,SHMESS+1
  TB,ATX,SHMESS+1
  TB,XTA,SHMESS+5
  ,AAX,C77777
  TB,AOX,SHMESS+1
  TB,ATX,SHMESS+1
  TB,XTA,SCNFS
  R,AOX,B48-30B
  R,AEX,B48-30B
  TB,ATX,SCNFS
  A,VTM,-LFATA
  S/F1:,24,2003B
  A,XTA,FATA+LFATA
  C,VIM,S/F2
  ,U1A,S/F3
  R,XTA,B48-30B
  TB,AOX,SCNFS
  TB,ATX,SCNFS
  TB,XTA,SHMESS+1
  ,UJ,PUTFATA
  S/F2:TB,AEX,SHMESS+1
  ,AAX,=:7777 7703
  ,UZA,PUTFATA
  S/F3:,24,3
  A,VLM,S/F1
  C,VIM,BADEXCH
C...   HET MECTA B FATA
  R,VJM,SEMU
  R,VTM,AFINP
  ,XTA,BITJ
  ,AOX,WAITMT
  ,ATX,WAITMT
  ,UJ,CLTASK
  PUTFATA:A,ATX,FATA+LFATA
  ,UJ,ANAL
C------------
  BADEXCH:,XTA,
  TB,ATX,SHMESS+4
  ,XTA,CBADM
  TB,ATX,W
  ANAL:TB,XTA,INFW
  ,ASN,64+30
  ,AAX,C37
  ,ATI,R.MAT.ЛИCT
  ,ITA,C
  ,AEX,C6
  ,U1A,ANAL1
C
C...  COБЫTИE "KOHEЦ OБMEHA" ПO Э070
C
  TB,XTA,ДШ.COБЫTИE
  ,UZA,ANAL1.HE TPEБYETCЯ
  R,AOX,B48.B ШKAЛY
  TB,ATX,ДШ.ЛИCTOB C KO
  S,VTM,ANAL1-BASE
  ,XTA,B48.ДHЗ=0 :
  ,UJ,ГEHCOБ.: CEБE
  ANAL1:TB,XTA,W
  ,U1A,BADANSW
  TB,XTA,SHMESS+4
  ,AAX,C77777
  ,UZA,RESTORE
  ,XTA,NEGRFS
  BADANSW:TB,ATX,W
  C,UTM,-6
  C,VIM,RESTORE
  R,XTA,B48
  TB,AOX,ST/EXCH
  TB,ATX,ST/EXCH
  TB,XTA,INFW
  ,AAX,B39.CTATYC
  ,U1A,RESTORE
C
C...   BЫXOД HA ERRMACRO ПPИ ABAPИИ
C      HA OTPAБOTKE  Э070
C
  TB,XTA,W
  ,ANX,
  :,24,2003B
  ,ATX,SAVI14
  TB,XTA,SHMESS+19
  ,ATX,SAVAC.IW70
  TB,XTA,SHMESS+4
  ,ARX,.ECTЬ ЛИ TEKCT
 :,U1A,*+1.ДИAГHOCTИKИ
 TB,UTC,SHMESS+5-16. - ДA
 :A,VTM,16."ПЛOX.OБMEH"
  ,ITA,A
 :,AEX,*+1
  ,UJ,ERRNRES
 :,Z00,NRPOST
  ,,
C
C***   BOЗBPAT ИЗ ЭKCTPAKOДA
 RETERR:C,UTC,
 RETURN:,XTA,
 TB,ATX,W
  TB,XTA,BUFS27.BHYTPEHHИЙ
  ,ARX,.BOЗBPAT
  ,U1A,RESTORE.- HET
  ,ASN,64+24.- ECTЬ
  ,ATI,R
  ,WTC,ДHЗ
  T,VTM,-NF
  B,UTC,
  R,UJ,
  RESTORE:,BSS,
 R,VJM,SEMU
 TB,XTA,SAVR1
 ,ATI,A
 ,ASN,64+15
 ,ATI,R
 ,ASN,64+15
 ,ATI,S
  ,XTA,ZBITJ
  ,AAX,LIB/BOSS
  ,ATX,LIB/BOSS
 TB,XTA,BUFS27
 ,ATI,27B
 TB,XTA,W
  ,ATX,SAVAC
 TB,XTA,SAVR2
 ,ATI,T
 ,ASN,64+15
  ,ATI,C.ДЛЯ B
 ,ASN,64+15
 ,ATI,TB
  ,XTA,*+2
 :C,MTJ,B
  ,UJ,NRESOFF
 :,Z00,NRPOST
  ,Z00,OUTMACRO
C
C---------------
  TNOFS:,GOST,12HNO FIL.SYST'231'
 CM1:,LOG,7777 7777 7777 7776
 B33/22:,OCT,0000 0777 7
C     MOHOПOЛЬHO ИCПOЛЬЗYEMЫE ЯЧEЙKИ
  WS FILD:,BSS,6
 ,END,
