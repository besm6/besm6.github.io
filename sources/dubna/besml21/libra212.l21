 INP:,BSS,.
 1,VTM,ФATOШ.
 ,CALL,INPUT*.**  BBOД ЗAДAЧИ
 ,XTA,*ER/BIN.OШИБKИ BINARY
 ,AOX,*ER/CM.ИЛИ OШИБ.CM
 ,UIA,ER PRI. - ФAT.OШИБKИ
 ,XTA,*ER/COS.OШИБKИ COSY
 ,UZA,MON RET.
 ,XTA,FL BLER.ЗAБЛOKИPOBAHЫ
 ,UZA,ER PRI. - HET
 1,VTM,БЛOШ.
 ER PRI:,BSS,.
C......   ИTOГOBAЯ ДИAГHOCTИKA ПO BBOДY
 ,ITS,1.
 1,UTM,4.ИTOГOBAЯ
 ,ITS,1.ДИAГHOCTИKA
 14,VTM,5.
 ,ITS,14.
 ,CALL,PRINT8....
 1,UTM,-ФATOШ-4.ФATAЛ.ДИAГHOCT.
 1,VIM,MON RET. - HET
 14,VTM,T/NAM.
 ,ITS,14.ПEЧATЬ NAME
 14,UTM,4.
 ,ITS,14.
 ,XTS,.
 ,CALL,PRINT8....
 ,SJ,
 MON RET:,BSS,.
 ,XTA,*ER/TEX.
 ,AOX,*ER/COS.
 ,AOX,*ER/BIN.
 ,AOX,*ER/CM .
 ,AOX,FLGEX*.
 ,ATX,FLGEX*.
  C CALL:,NTR,6
  ,CALL,CHEKJOB*
C
 ФATOШ:,BSS,.
 ,ISO,14HБЫЛИ ФATAЛЬHЫE
 ,CONT,13H OШИБKИ BBOДA
 БЛ OШ:,BSS,.
 ,ISO,14HБЫЛИ OШИБKИ ,
 ,CONT,13HHO БЛOKИPOBKA
 INFBA:,BSS,1
 WS:,LOG,.
 ,DATA,.
 TNAMD:,ISO,5H
 ,CONT,20H( NAME OTCYTCTBYET )
 :5,SET,TNAMD.
 1,,T/NAM.
 ,END,.
      INTPRT2*   :,NAME,
      FTNPRT*    :,SUBP,
      INTPRT*    :,SUBP,
            14 ,  VJM,  FTNPRT*
            14 ,  VTM,  1
            12 ,  VTM,   *00011
            12 ,  XTA,  2
                 , UJ,  INTPRT*
      INTPRT3*  :,ENTRY,
            14 ,  VJM,  FTNPRT*
            14 ,  VTM,  1
            12 ,  VTM,   *00012
            12 ,  XTA,  2
                 , UJ,  INTPRT*
      INTPRT5*  :,ENTRY,
            14 ,  VJM,  FTNPRT*
            14 ,  VTM,  1
            12 ,  VTM,   *00011
            12 ,  XTA,  4
                 , UJ,  INTPRT*
 *00011    :,     LOG,  00000000 00000040.
 *00012    :,     LOG,  00000000 00000060.
            ,     LOG,  42120000 00000000.
            ,     LOG,  43544000 00000000.
            ,     LOG,  47116100 00000000.
 BSS       :     ,BSS,
      ,END,
 IPCINI:,NAME,
C*
C*************** 06.81.  P.З.ЗAЛЯЛOB
C*          PEДAKЦИЯ OT 06.82
C*
C*    ПAKET ПPOГPAMM ДЛЯ PAБOTЫ C
C*    MEЖПPOГPAMMHЫM KAHAЛOM CBЯЗИ
C*
C*  OTKPЫTИE ПOPTA
C*     SUBROUTINE IPCINI(MYNAME,IREP)
C*   MYNAME - ИMЯ COЗДABAEMOГO ПOPTA
C*   IREP   - OTBET:
C*       =0 - 0'KEY
C*     HE=0 - HOMEP OШИБKИ
C*   ЭTOT ПAPAMETP ИMEET TAKOЙ ЖE CMЫCЛ
C*   ДЛЯ BCEX BXOДOB
C*
C*   ПOДKЛЮЧEHИE TPAHCПOPTHOЙ CTAHЦИИ
C*     SUBROUTINE IPCTSN(TSNAME,IREP)
C*   TSNAME - ИMЯ ПOPTA TC
C*
C*   OTKЛЮЧEHИE TPAHCПOPTHOЙ CTAHЦИИ
C*     SUBROUTINE IPCTSC
C*
C*   YHИЧTOЖEHИE CBOEГO ПЯ
C*     SUBROUTINE IPCKIL
C*
C*   OTKAЗ B ПPИEME COOБЩEHИЙ
C*     SUBROUTINE IPCREJ(NTRNR,IREP)
C*   NTRNR - ИП ,OT KOTOPOГO OTKAЗ
C*
C*--------------------------------------
C*
C*   ПAKET ДЛЯ TPAHCПOPTHOЙ CTAHЦИИ
C*
C*  OTKPЫTИE ПOPTA
C*     SUBROUTINE TSINI(MYNAME,IREP)
C*
C*   ПOЛYЧEHИE CПPABKИ O COCTOЯHИИ ПOPTA
C*     SUBROUTINE TSLSTM(MESADR,IREP)
C*   MESADR - MACCИB:
C*   NW1 - ЧИCЛO ПOCЛEДYЮЩИX CЛOB
C*   ИMEHA П  C COOБЩEHИЯMИ ДЛЯ TC
C*   NW2 - (ЧИCЛO ПOCЛEДYЮЩИX CЛOB)/2
C*   CПИCOK ИЗ ПAP:1-ИMЯ ГOTOBOГO ПPИHЯTЬ
C*                       ПOPTA
C*                 2-OT KOГO XOЧET
C*   BTOPOE CЛOBO MOЖET БЫTЬ ПYCTO
C*
C*   CПPABKA O HAЛИЧИИ ПЯ
C*     SUBROUTINE TSLSTB(MESADR,IREP)
C*   MESADR - MACCИB:
C*    NW
C*    CПИCOK ИMEH ПOPTOB
C*
C*   ЗAKPЫTИE TC ИЗ-ЗA OTCYTCTBИЯ PAБOTЫ
C*     SUBROUTINE TSCLS(MESADR,IREP)
C*   B MESADR ЗAДAETCЯ ИMEЮЩИECЯ COOБЩ-ИЯ:
C*    NW - (ДЛИHA CПИCKA)/2
C*    CПИCOK ИЗ ПAP:ИП  ПPИEMHИKA
C*                  ИП  ПEPEДATЧИKA
C*   TC OTKPЫBAETCЯ ПPИ ПOCTYПЛEHИИ HOBOГO
C*   COOБЩEHИЯ ДЛЯ HEE,ИЛИ ПPИ ПOЯBЛEHИИ
C*   ПPИEMHИKA.
C*
C*   YHИЧTOЖEHИE ПOPTA TC
C*     SUBROUTINE TSKIL
C*
C*   BOЗMOЖHЫE COCTOЯHИЯ IREP:
C*    1 - OБPAЩEHИE ДO OTKPЫTИЯ ПOPTA
C*    2 - CИCTEMHAЯ OШИБKA(HEBEPH.ЭKCTPAK)
C*    3 - ПPИ OTKPЫTИИ П  - HAШE ИMЯ YЖE
C*        ЗAHЯЛИ
C*    4 - CИCTEMHAЯ OШИБKA(ЧYЖOЙ ЛИCT)
C*    5 - ПEPEДAETCЯ ДЛИHHOE COOБЩEHИE
C*    6 - OБЫЧHAЯ ЗAДAЧA ИCПOЛЬЗYET
C*        ПAKET ДЛЯ TC
C*    7 - ПPИEMHИK HE ГOTOB
C*    8 - HET П  ПPИ OTKAЗE
C*    9 - OБPAЩEHИE C ПЛOXИM ИП
C*   10 - HET COOБЩEHИЯ
C*   11 - HET ПPИEMHИKA
C*   12 - OTKAЗ ПPИEMHИKA
C*   13 - BCTPEЧHAЯ ПOCЫЛKA
C*   14 - ПOBTOPHOE OTKPЫTИE ПOPTA
C*
C**********************************
C
 *POST*:,LC,2
 A/I0:,LC,1
C      OTKPЫTИE ПOPTA
 10,VTM,0
 B:8,BASE,*
 ,STI,9.OTBET
 ,AAX,=77777.AДPEC ИHФ.
 10,AOX,.ИHФ.CЛOBO
 ЭKCTP:,*52,2
 ,UZA,RET
C     OШИБKA ИЗ ЭKCTPAKOДA
 ,ANX,
 RET:,BSS,
 ,AOX,A/I0.OTBETHOE
 9,STX,.CЛOBO.
 ,NTR,6
 13,UJ,
C
C      ПOДKЛЮЧEHИE TC
 IPCTSN:,ENTRY,
 ,STI,9.OTBET
 ,ATI,10.ИMЯ ПOPTA TC
 10,XTA,
 ,UTC,*POST*
 ,ATX,
 ,XTA,
 ,UJ,RET
C
C      OTKЛЮЧEHИE TC
 IPCTSC:,ENTRY,
 ,XTA,
 ,UTC,*POST*
 ,ATX,
 13,UJ,
C
C     YHИЧTOЖEHИE CBOEГO ПOPTA
 IPCKIL:,ENTRY,
 IPCKIL:,BSS,
 ,UTC,CKILL
 ,XTA,
 ,*52,2
 13,UJ,
 CKILL:,,
 ,Z05,
C     OTKAЗ B ПPИEME OT YKAЗAHHOГO ПOPTA
 IPCREJ:,ENTRY,
 10,VTM,CREJECT
 ,UJ,B
 CREJECT:,,
 ,Z04,
C
C*    ПAKET ДЛЯ TPAHCПOPTHOЙ CTAHЦИИ
C
C     ЗABEДEHИE ПЯ TC
 TSINI:,ENTRY,
 10,VTM,B21
 ,UJ,B
C
C     ПOЛYЧEHИE CПИCKA ПEPEДATЧИKOB K TC
C     C ГOTOBЫMИ COOБЩEHИЯMИ И
C     ПPИEMHИKOB ГOTOBЫX K ПPИEMY
 TSLSTM:,ENTRY,
 10,VTM,CLSTM
 ,UJ,B
 CLSTM:,,
 1,Z01,
C
C     CПИCOK ПOPTOB
 TSLSTB:,ENTRY,
 10,VTM,CLSTB
 ,UJ,B
 CLSTB:,,
 ,Z01,
C
C     ЗAKPЫTИE TC ИЗ-ЗA OTCYTCTBИЯ PAБOTЫ
 TSCLS:,ENTRY,
 10,VTM,CCLOSE
 ,UJ,B
 CCLOSE:,,
 ,Z06,
C
C      YHИЧTOЖEHИE ПOPTA
 TSKIL:,ENTRY,
 ,UJ,IPCKIL
C
 B21:,LOG,400 0000
 ,END,
 IPCSND:,NAME,
C*
C*   ПAKET ПPOГPAMM OБMEHA COOБЩEHИЯMИ
C*   ЧEPEЗ MEЖПPOГPAMMHЫЙ KAHAЛ CBЯЗИ
C*
C*   ПOCЫЛKA COOБЩEHИЯ
C*     SUBROUTINE IPCSND(NRVR,MESADR,
C*                     MESSZE,ITIME,IREP)
C*   NRVR   - ИMЯ ПOPTA ПOЛYЧATEЛЯ
C*   MESADR - COOБЩEHИE
C*   MESSZE - ДЛИHA COOБЩEHИЯ
C*   ITIME  -BPEMЯ OЖИДAHИЯ ПEPEДAЧИ:
C*         >0 - BPEMЯ OЖИДAHИЯ ПEPEДAЧИ
C*              B CEK. (HE БOЛEE 63 CEK)
C*          =0 - ПEPEДAЧA TOЛЬKO ПPИ
C*              ГOTOBOM ПPИEMHИKE
C*       ИHAЧE - ЗAДAЧA ЗAKPЫBAETCЯ ДO
C*               ГOTOBHOCTИ ПPИEMHИKA
C*
C*   ПEPEДAЧA COOБЩEHИЯ C PEAKЦИEЙ HA
C*   BCTPEЧHYЮ ПOCЫЛKY
C*     SUBROUTINE IPCSCL(NRVR,MESADR,
C*                     MESSZE,ITIME,IREP)
C*
C*   ПPИEM COOБЩEHИЯ
C*     SUBROUTINE IPCRCV(NTRNR,MESADR,
C*                    MESSZE ,ITIME,IREP)
C*   NTRNR  -ИП    ,OTKYДA ПPИШЛO COOБЩ.
C*           ECЛИ OHO ПPИШЛO ЧEPEЗ TC,TO
C*           EE ИП  B COMMON'E /POST/+1
C*   MESADR -KYДA ПPИHЯTЬ COOБЩEHИE
C*   MESSZE -ДЛИHA ПOЛYЧEHHOГO COOБЩEHИЯ
C*   ITIME  -BPEMЯ OЖИДAHИЯ:
C*         >0 - BPEMЯ OЖИДAHИЯ COOБЩEHИЯ
C*              B CEK. (HE БOЛEE 63 CEK)
C*          =0 - ПPИEM TOЛЬKO ГOTOBOГO
C*               COOБЩEHИЯ
C*       ИHAЧE - ЗAДAЧA ЗAKPЫBAETCЯ ДO
C*               ПOЛYЧEHИЯ COOБЩEHИЯ
C*
C*   ПPИEM C YKAЗAHHOГO ПOPTA
C*     SUBROUTINE IPCRFB(NTRNR,MESADR,
C*                    MESSZE,ITIME,IREP)
C*   ИП     YKAЗЫBAETCЯ B NTRNR
C*-------------------------------------
C*   ДЛЯ TPAHCПOPTHOЙ CTAHЦИИ
C*
C*   ПOCЫЛKA COOБЩEHИЯ
C*     SUBROUTINE TSSND(NRVR,NTRNR,MESADR
C*                           ,MESSZE,IREP)
C*   NRVR - KOMY COOБЩEHИE
C*   NTRNR - OT KOГO OHO ПPИШЛO
C*   OCTAЛЬHЫE ПAPAMETPЫ - KAK B IPCSND
C*   ПOCЫЛKA ПPOИЗBOДИTCЯ TOЛЬKO ПPИ ГOTOB
C*   HOCTИ ПPИEMHИKA,ИHAЧE IREP HE=0.
C*
C*   ПPИEM COOБЩEHИЯ
C*     SUBROUTINE TSRCV(NRVR,NTRNR,MESADR
C*                           ,MESSZE,IREP)
C*   NRVR  - KOMY (MOЖET БЫTЬ CAMOЙ TC)
C*   NTRNR - OT KOГO ПPИШЛO
C*   ПPИEM TOЛЬKO ГOTOBЫX COOБЩEHИЙ.
C*
C*   ПPИEM COOБЩEHИЯ C YKAЗAHHOГO ПOPTA
C*     SUBROUTINE TSRFB(NRVR,NTRNR,MESADR
C*                           ,MESSZE,IREP)
C*   NTRNR - OT KOГO ПPИHИMAET
C*
C
 *POST*:,LC,2
 A/I0:,LC,1
 BUF:,PC,1024
 LBUF:,P/P,(BUF)16
C
C     ПOCЫЛKA COOБЩEHИЯ
 B:8,BASE,*
 ,XTS,
 ,STX,NSND
 ,UJ,IPCSEND
C
C     ПOCЫЛKA C PEAKЦИEЙ HA BCTPEЧHYЮ
C     ПOCЫЛKY(ПPИ PAБOTE БEЗ TC).
 IPCSCL:,ENTRY,
 8,BASE,B
 ,XTS,=4
 ,STX,NSND
 IPCSEND:,BSS,
 ,STI,9.OTBET
 ,STI,14.ITIME
 ,STI,10.ДЛИHA
 ,STI,11.COOБЩEHИE
 ,ATI,12.ИП  ПPИEMHИKA
 12,XTA,.ИП
 ,ATX,SHBUF+2.ПPИEMHИKA.
 ,UTC,*POST*
 ,XTA,.ИП
 ,ATX,SHBUF+1.TPAHCП. CTAHЦИИ
 ,XTA,
 CHLMESS:,ATX,TSFL
 ,XTA,NSND.TИП
 ,ASN,64-20.ПEPEДAЧИ.
 ,ATX,W
 ,XTA,TSFL
 ,U1A,TSSEND
 14,XTA,.BPEMЯ OЖИД.
 14,VJM,TIMER
 TSSEND:12,VTM,-1.ЦИKЛ ПEPEПИCИ
 ,NTR,3
 10,XTA,
 ,X-A,SHL
 ,U1A,MSHL
 10,XTA,.TOЛЬKO KOPOTKOE
 ,AAX,=77777
 ,UJ,SETLM
 MSHL:,XTA,B22.ПEPEДAETCЯ
 ,AOX,W.И CTPAHИЦA.
 ,ATX,W
 10,XTA,
 ,X-A,MAXL
 ,U1A,MPAGE
 10,XTA,.TOЛЬKO
 ,ASN,64-15.CTPAHИЦA.
 ,UJ,SETLM
 MPAGE:,A+X,SHL
 ,U1A,ERRL
 ,XTA,MAXL.ПEPEДAEM
 ,ASN,64-15.CTPAHИЦY
 ,ATX,SHBUF.И
 10,XTA,.KOPOTKOE
 ,A-X,MAXL.COOБЩEHИE.
 ,AAX,=77777
 ,AOX,SHBUF
 SETLM:,ATX,SHBUF
 ,ASN,64+15
 ,ATI,14
 10,VTM,BUF
 LRWR:14,VZM,ELRWR
 11,XTA,
 10,ATX,
 11,UTM,1
 10,UTM,1
 14,UTM,-1
 ,UJ,LRWR
 ELRWR:10,VTM,SHBUF+4
 ,XTA,SHBUF
 ,ATI,14
 12,VLM,LRWR
 ,XTA,W
 ,AOX,CSND
 ,*52,2
 ,UZA,RET
 ERRET:,ANX,.N OШИБKИ
 RET:,AOX,A/I0
 9,STX,.OTBET
 ,NTR,6
 13,UJ,
 ERRL:,XTA,B44
 ,UJ,ERRET
 CSND:,Z00,LBUF
 ,Z02,SHBUF
C
C     ПPИEM ЛЮБOГO COOБЩEHИЯ
 IPCRCV:,ENTRY,
 8,BASE,B
 ,XTS,
 ,STX,NRCV
 ,UJ,RECIV
C
C     ПPИEM C YKAЗAHHOГO ПOPTA
 IPCRFB:,ENTRY,
 8,BASE,B
 ,XTS,=2
 ,STX,NRCV
 RECIV:,BSS,
 ,STI,9.OTBET
 ,STI,14.BPEMЯ OЖИДAHИЯ
 ,STI,10.ДЛИHA
 ,STI,11.AДP. ПPИEMA
 ,ATI,12.ИП  ПEPEДATЧИKA
 ,XTA,
 STSFL:,ATX,TSFL.ПPИEMHИK TC/HET
 ,XTA,NRCV.MOДA
 ,ASN,64-20.ПPИEMA
 ,AOX,CRCV
 ,ATX,W
 ,XTA,TSFL
 ,U1A,RECEXTR
 14,XTA,
 14,VJM,TIMER
 RECEXTR:12,XTA,.ДЛЯ BЫЗOBOB
 ,AEX,.IPCRFB И TCRFB
 ,XTA,W
 ,*52,2
 ,U1A,ERRET.HEYДAЧA
 ,XTA,SHBUF
 ,XTS,SHBUF
 ,ASN,64+15
 15,ARX,
 ,AAX,=77777
 ,AOX,A/I0
 10,ATX,.ДЛИHA COOБЩ.
 10,VTM,BUF
 ,XTA,SHBUF.ПEPEПИCЬ
 ,ASN,64+15.C ЛИCTA.
 ,ATI,14
 LRWR1:14,VZM,ELRWR1
 10,XTA,
 11,ATX,
 10,UTM,1
 11,UTM,1
 14,UTM,-1
 ,UJ,LRWR1
 ELRWR1:,XTA,SHBUF
 ,UZA,RETRCV
 ,ATI,14.ПEPEПИCЬ C
 10,VTM,SHBUF+4.KOPOTKOГO БYФEPA
 ,XTA,
 ,ATX,SHBUF
 ,UJ,LRWR1
 RETRCV:,XTA,TSFL
 ,U1A,RETTSRCV
 ,XTA,SHBUF+1
 ,UTC,*POST*.ИП
 ,ATX,1.TC.
 ,XTA,SHBUF+2.ИП
 12,ATX,.ПEPEДATЧИKA
 ,XTA,
 ,UJ,RET
 CRCV:,Z00,LBUF
 ,Z03,SHBUF
C
C     ПOCЫЛKA COOБЩEHИЯ
 TSSND:,ENTRY,
 8,BASE,B
 ,STI,9.OTBET
 ,STI,10.ДЛИHA
 ,STI,11.COOБЩEHИE
 ,STI,12.ИП  ПEPEДATЧИKA
 ,ATI,14.ИП  ПPИEMHИKA
 14,XTA,
 ,ATX,SHBUF+1
 12,XTA,
 ,ATX,SHBUF+2
 ,XTA,
 ,ATX,NSND
 ,XTA,=1
 ,UJ,CHLMESS
C
C     ПPИEM COOБЩEHИЯ
 TSRCV:,ENTRY,
 8,BASE,B
 ,XTS,=1
 ,STX,NRCV
 ,UJ,TSRECIV
C
C     ПPИEM C YKAЗAHHOГO ПOPTA
 TSRFB:,ENTRY,
 8,BASE,B
 ,XTS,=2
 ,STX,NRCV
 TSRECIV:,BSS,
 ,STI,9.OTBET
 ,STI,10.ДЛИHA
 ,STI,11.AДPEC ПPИEMA
 ,STI,12.ИП  ПEPEДATЧИKA
 ,ATX,ARCVR.ИП  ПPИEMHИKA
 ,XTA,=1
 ,UJ,STSFL
 RETTSRCV:,XTA,SHBUF+1
 ,WTC,ARCVR
 ,ATX,
 ,XTA,SHBUF+2
 12,ATX,
 ,XTA,
 ,UJ,RET
C
C      OПPEДEЛEHИE BPEMEHИ OЖИДAHИЯ
 TIMER:,BSS,
 ,NTR,3
 ,A-X,A/I0.ЖДEM ДO
 14,U1A,.OБMEHA
 ,X-A,=I63
 ,U1A,MAXT.T БOЛЬШE 63 CEK
 ,X-A,=I63
 ,AAX,=77
 ,UJ,PACKT
 MAXT:,XTA,=77
 PACKT:,ASN,64-24
 ,AOX,B21
 ,AOX,W
 ,ATX,W
 14,UJ,
 MAXL:,INT,1024
 SHL:,INT,17
 B44:,OCT,02
 B22:,LOG,1000 0000
 B21:,LOG,0400 0000
 W:,BSS,1
 NSND:,BSS,0
 NRCV:,BSS,1
 TSFL:,BSS,1
 ARCVR:,BSS,1
 SHBUF:,BSS,21
 ,END,
 ISOTOA0:,NAME,
 '
 '
CЛYЖИT ДЛЯ ПEPEBOДA OДHOГO CЛOBA "ISO"
 '   B OДHO CЛOBO ABTOKOДA.
 '
 '
 *C:,UTC,BUFISO.
 ,ATX,.
 ,ITA,13.
 ,ITS,.
 13,BASE,*C
 ,ATX,A0.
 14,VTM,48
 *L:,XTA,BUFISO.
 14,ASN,64-8.
 ,AAX,=177.
 ,AOX,=I0.
 ,NTR,2.
 ,E+N,64+3.
 15,ATX,.
 ,A/X,=R48.0
 ,NTR,3.
 ,A+X,=I0
 ,ATX,WDT.
 ,NTR,2.
 ,A*X,=R48.0
 15,A-X,.
 ,NTR,3.
 ,A+X,=I0.
 ,WTC,WDT.
 ,XTS,TABLA0.
 15,WTC,.
 ,ASN,64+40
 ,AAX,=377.
 ,XTS,A0.
 ,ASN,64-8.
 15,AOX,.
 ,ATX,A0.
 14,UTM,-8.
 14,VIM,*L.
 ,NTR,6.
 15,WTC,.
 ,UJ,.BOЗBPAT
C
C
 TABLA0:,BSS,.TAБЛИЦA      ABTOKOДA
  ,GOST,6H
  ,GOST,6H'72'   '140'
  ,GOST,6H  '140''74''54' '64'
  ,GOST,6H    '143''176'
  ,GOST,6H'152'  '377'
  ,GOST,6H'60'   '64''152'
  ,GOST,6H  '71''377''76''51'
 ,GOST,6H'170''061''046''070''047''067'
  ,GOST,6H012345
  ,GOST,6H6789'56''45'
  ,GOST,6H'146''57''147'  '230'
  ,GOST,6H'223''216''222''220''226''213'
  ,GOST,6H'205''214''232''236''211''207'
  ,GOST,6H'206''203''215''235''212''224'
  ,GOST,6H'201''234''217''231''227''225'
  ,GOST,6H'221''053''017''066''050''043'
  ,GOST,6H'334''230''323''316''322''220'
  ,GOST,6H'326''313''227''314''332''236'
  ,GOST,6H'311''207''205''203''315''335'
  ,GOST,6H'215''216''201''225''317''223'
  ,GOST,6H'327''325''321''324''320''301'
  ,GOST,6H'331'
 BUFISO:,BSS,1.
 A0    :,BSS,1.
 WDT   :,BSS,1.
 ,END,ISOTOA0 .
  ITCONB:,NAME,
C*
C***      22.5.87.   A.П.CAПOЖHИKOB
C*
C*       ПOДCИCTEMA  BINARY - OБMEHA
C*   БЭCM-6  <===> TEPMИHAЛЬHЫЙ KOHTPOЛЛEP
C*   -------------------------------------
C*           ПPИKЛAДHOЙ YPOBEHЬ
C*
C* 1. FUNCTION ITCONB(J)  - ПPИBЯЗKA
C*    J = 1,2,...,16  - HOMEP TEPMИHAЛA
C*    J = 0  - ПPИBЯЗKA ПEPBOГO CBOБOДHOГO
C*    J = -1  - ПPИBЯЗKA TOГO TEPMИHAЛA, C
C*              KOTOPOГO ЗAПYЩEHA ЗAДAЧA.
C*    OTBET = 1,2,...,16  - HOMEP TEPMИHAЛA
C*            ИЛИ 0, ECЛИ ПPИBЯЗKY HE ДAЛИ.
C*
C* 2. FUNCTION ITDISB(J)  - OTBЯЗKA
C*    J = 1,2,...,16  - HOMEP TEPMИHAЛA
C*    OTBET = 0.
C*
C* 3. FUNCTION ITOUTB(NT,M,K,T)  - BЫBOД.
C*    NT = 1,2,...,16  - HOMEP TEPMИHAЛA
C*    ИЛИ 0, ECЛИ HA ПEPBЫЙ ПPИBЯЗAHHЫЙ.
C*    M - MACCИB БAЙTOB, YПAKOB.ПO 6 B CЛOBO
C*    K - ЧИCЛO BЫДABAEMЫX БAЙTOB ( <= 300 )
C*    T - BPEMЯ OЖИДAHИЯ B CEKYHДAX
C*    OTBET = 0, ECЛИ ИCTEKЛO BPEMЯ, ИHAЧE
C*        HOMEP TEPMИHAЛA, KYДA БЫЛ BЫBOД.
C*
C* 4. FUNCTION ITINPB( NT, M, K, T )  - BBOД
C*    NT = 1,2,...,16  - HOMEP TEPMИHAЛA
C*    ИЛИ 0, ECЛИ BBOД C ЛЮБOГO ПPИBЯЗAHHOГO
C*    M - MACCИB, KYДA BBOДИTCЯ ИHФOPMAЦИЯ
C*    K - CЮДA ПOПAДET CЧETЧИK BBEД. БAЙTOB
C*    T - BPEMЯ OЖИДAHИЯ B CEKYHДAX
C*    OTBET = 0, ECЛИ BPEMЯ T ИCTEKЛO, ИHAЧE
C*     HOMEP TEPMИHAЛA, C KOTOPOГO БЫЛ BBOД.
C*
C* 5. FUNCTION ITMODB( NT, CHAR )  - BЫДAЧA
C*    B KOHTPOЛЛEP БAЙTA, ЗAДAHHOГO B  1-8
C*    PAЗPЯДAX CHAR.  NT - HOMEP TEPMИHAЛA
C*    ИЛИ 0, ECЛИ HA ПEPBЫЙ ПPИBЯЗAHHЫЙ.
C*    OTBET = HOMEP TEPMИHAЛA ИЛИ 0.
C*
C* ЗAMEЧAHИE: ПPИ ПOПЫTKE PAБOTЫ C HEПPИBЯ-
C*   ЗAHHЫM TEPMИHAЛOM ITOUTB,ITINPB,ITMODB
C*   BOЗBPAЩAЮT  0  B KAЧECTBE PEЗYЛЬTATA.
C*
  *DRIVER*:,PC,
  CON/DIS:,SUBP,
  BIN/EXCH:,SUBP,
  COM/MOD:,SUBP,
C
  11,VTM,
  ,UJ,CON/DIS
C
  ITDISB:,ENTRY,
  11,VTM,1
  ,UJ,CON/DIS
C
  ITINPB:,ENTRY,
  11,VTM,
  ,UJ,BIN/EXCH
C
  ITOUTB:,ENTRY,
  11,VTM,1
  ,UJ,BIN/EXCH
C
  ITMODB:,ENTRY,
  11,VTM,10
  ,UJ,COM/MOD
  ,END,
 ITM/ASS:,NAME,.CAXAPOB
 DATAPR*:,SUBP,.
 LHEAP*:,LC,1.
 *MONCRD*:,LC,12.
 SCEM:,EQU,83.
 KCOUNT*:,LC,4.
 ШИФP:,EQU,114B.
 L:,LC,.
 KOHДЫP:,EQU,4000B
 ДЫPA:,LC,KOHДЫP-L.
 START/ЧK:,SUBP,.
 5,BASE,*
 ,*72,=:11 40 37 00 77
  ,FUN,70100B+SCEM
  ,AOX,=:0011.Э60+Э63
 ,*57,5.
  ,XTA,KCOUNT*+1
  ,AAX,=377 1777
  ,ASN,64-15
  ,AOX,KCOUNT*
  ,FUN,213B
 ,XTA,KCOUNT*+1.
 ,ASN,64+12.
 ,AAX,=77
 ,ATI,14.
 ,XTA,=:004
 14,ASN,64.
 ,XTS,LHEAP*.
 ,ASN,64+6.
 15,AOX,.
 ,AAX,=:41 7777 7777
 ,AEX,=:41 7777 7777
 ,ATX,DMD.
 ,*72,DMD.
 ,XTA,=6
  ,FUN,72100B+ШИФP
 ,*76,.
 ,XTA,.
 13,VJM,DATAPR*.
 ,*64,HIN.
 ,MTJ,10.
 ,CALL,PARAMT*.
 11,VZM,OLD.
 14,VTM,7000B.
 ,CALL,BBOДA0.
 ,UJ,DEB.
 OLD:13,VTM,7000B.
 ,*73,6.
 DEB:,*67,DIN.
 DIN:,Z00,START/ЧK.
 9,,.
 HIN:,,TH.
 ,,TH.
 :,001,.
 11,,.
 TH:,GOST,14HABTOKOД ИTM-BT
 ,CONT,3H'214''200'2
 ,CONT,10H/29.12.77/
 ,CONT,1H'231'
 DMD:,BSS,1.
 ,END,ITM/ASS .
 KILLBLAN:,NAME,.
C
C*****   USER ГAШEHИЯ HOMEPOB
C
 ,STI,12.CTAHД.CEPBИC
 ,ATI,14.AДP.KAPTЫ
 ,UTC,BLAN.
 ,XTA,.
 14,ATX,12.
 14,ATX,13.
 ,ITA,14.
 12,UJ,.HA CEPBИC
 BLAN:,ISO,6H
 ,END,.
  LDSHIFT:,NAME,
  ,XTA,61B
  ,AAX,=7777 0077 7777 7777
  ,AOX,=:0000 03
  ,ATX,C
  ,ARX,=1
  ,ATX,C+1
  ,DRUM,C
  ,XTA,BSHIFT
  ,ATX,7776B
  ,XTA,CSHIFT
  ,ATX,7777B
  ,DRUM,=0000 0300 0007 0036
  ,DRUM,C+1
  ,DRUM,=0000 0300 0007 0037
  ,XTA, =0010 3700 0007 0036
  ,ATX,61B
  13,UJ,
  BSHIFT:,LOG,64000
  CSHIFT:,LOG,70000
  C:,BSS,2
  ,END,
  LFSYST:,NAME,
C*
C***  1.4.83     O.H.ЛOMИДЗE
C*               A.П.CAПOЖHИKOB
C*
C*       ИHTEPФEЙC ФAЙЛOBOЙ CИCTEMЫ
C*       ==========================
C*
C*      A.)  YPOBEHЬ YПPABЛЯЮЩИX KAPT
C*
C*    1. ЗABEДEHИE ФAЙЛA  (MAKEF)
C*
C*   *CALL LFSYST:JOB=MAKEF,MASTER=<ИMЯ>,
C*              FILE=<ИMЯ>,LIMIT=<ЧИCЛO>,
C*              DATE=<ЧИCЛO>
C*
C*    2. OTKPЫTИE ФAЙЛA   (OPENF)
C*
C*   *CALL LFSYST:JOB=OPENF,MASTER=<ИMЯ>,
C*              FILE=<ИMЯ>,UNIT=<ЛOГ.HOM>,
C*              REGIM=R  ИЛИ W
C*
C*    3. ЗAKPЫTИE ФAЙЛA   (CLOSEF)
C*
C*   *CALL LFSYST:JOB=CLOSEF,UNIT=<ЛOГ.N>
C*
C*    4. YHИЧTOЖEHИE ФAЙЛA   (DELETF)
C*
C*   *CALL LFSYST:JOB=DELETF,MASTER=<ИMЯ>,
C*              FILE=<ИMЯ>
C*
C*    5. ЗABEДEHИE FRIEND-A  (FRIEND)
C*
C*   *CALL LFSYST:JOB=FRIEND,MASTER=<ИMЯ>,
C*              NAMFR=<ИMЯ FRIEND-A>,
C*              FILE=<ИMЯ ФAЙЛA>,
C*              REGIM=R  ИЛИ W  ИЛИ EXCLUD
C*    ПPИ REGIM=EXCLUD ПPOИЗBOДИTCЯ ИCKЛЮ-
C*    ЧEHИE ИЗ CПИCKA FRIEND-OB ДAHHOГO
C*    MASTER-A.
C*
C*
C*    BCE KЛЮЧEBЫE CЛOBA MOЖHO COKPAЩATЬ
C*    BПЛOTЬ ДO 1 CИMBOЛA:  J BMECTO JOB
C*    ПOPЯДOK ЗAДAHИЯ ПAPAMETPOB HECYЩE-
C*    CTBEH.  ПO YMOЛЧAHИЮ  DATE=0 .
C*
C*    UNIT - ЛOГИЧECKИЙ HOMEP ФAЙЛA
C*    B CTИЛE MOHИTOPHOЙ CИCTEMЫ "ДYБHA"
C*    T.E.  ЦEЛOE OT 1 ДO 15  ИЛИ
C*    BOCЬMEPИЧHOE OT  30B  ДO  67B
C*
C*    LIMIT - ПPEДEЛЬHOE ЧИCЛO ЗOH ФAЙЛA
C*    BOCЬMEPИЧHOE ЧИCЛO, ПPИЧEM CYФФИKC
C*    "B" MOЖHO OПYCKATЬ.
C*
C*    DATE - ДATA YHИЧTOЖEHИЯ ФAЙЛA
C*    ЗAДAETCЯ B BИДE ЦEЛOГO  ГГMMДД
C*    (ГOД,MECЯЦ,ДEHЬ). ДЛЯ ЛOKAЛЬHЫX
C*    ФAЙЛOB  DATE=0
C*
C*    ЗHAЧEHИЯ BCEX OCTAЛЬHЫX ПAPAMETPOB
C*    TИПA <ИMЯ>  CYTЬ ИДEHTИФИKATOPЫ,
C*    ПPИЧEM CИMBOЛЫ "*" И "/"
C*    CЧИTAЮTCЯ БYKBAMИ.
C*
C*
C*      Б.)  YPOBEHЬ ПOЛЬЗOBATEЛЯ
C*
C*  FUNCTION LFCREF(MASTER,LIMIT,FILE,DATE)
C*  ЗABEДEHИE ФAЙЛA C ИMEHEM  FILE
C*  И XOЗЯИHOM  MASTER.  LIMIT И DATE
C*  ИMEЮT TOT ЖE CMЫCЛ, ЧTO И BЫШE.
C*
C*  FUNCTION LFOPEN(MASTER,FILE,UNIT,REGIM)
C*  OTKPЫTИE ФAЙЛA FILE ПOД ЛOГ.HOMEPOM
C*  UNIT.  REGIM=1HR ИЛИ 1HW
C*
C*  FUNCTION LFCLOS(UNIT)
C*  ЗAKPЫTИE ФAЙЛA C ЛOГ.HOMEPOM UNIT
C*
C*  FUNCTION LFRIEN(MASTER,FILE,FRIEND,REG)
C*  ЗABEДEHИE FRIEND-A  C ПPABOM ДOCTYПA
C*  REG=1HR  ИЛИ  1HW.
C*  OБPAЩEHИE C REG=6HEXCLUD TPAKTYETCЯ
C*  KAK ИCKЛЮЧEHИE FRIEND-A.
C*
C*
C*   BCE ФYHKЦИИ YPOBHЯ ПOЛЬЗOBATEЛЯ
C*   ПPИHИMAЮT ЗHAЧEHИE = 0,  ECЛИ ЗAKAЗ
C*   BЫПOЛHEH HOPMAЛЬHO.  B CЛYЧAE OШИБKИ
C*   PEЗYЛЬTAT = 1, A TEKCT COOБЩEHИЯ OБ
C*   OШИБKE HAXOДИTCЯ B
C*     COMMON /LFDIAG/ MTEXT(3)
C*   ( 18 CИMBOЛOB B KOДE  ISO )
C*
C*
  MONCARD/:LC,BLOCK,CARD
  *LFDIAG*:LC,BLOCK,D(3)
  NUM*FS:LC,BLOCK,NFS
  LOADANGO:,SUBP,
C---
  8,BASE,*
  ,XTA,73B
  15,ATX,
  ,ASN,64-6
  ,AOX,=23
  ,ATX,73B
  ,ITA,13
  15,ATX,
  14,VTM,CARD
  ,ITS,14
  ,XTS,NAMSCAN
  ,CALL,LOADANGO
  15,XTA,
  ,STI,13
  ,ATX,73B
  13,UJ,
  NAMSCAN:,TEXT,8HLFSCAN
C
C
  LFCLOS:,ENTRY,
  15,ATX,
  ,UTC,1
  LFDELF:,ENTRY,
  14,VTM,
  15,ATX,
  15,ATX,
  14,UTC,1
  LFRIEN:,ENTRY,
  ,UTC,1
  LFOPEN:,ENTRY,
  ,UTC,1
  LFCREF:,ENTRY,
  14,VTM,
  8,BASE,*
  ,STI,12
  ,STI,11
  ,STI,10
  ,ATI,9
  14,XTA,TJOB
  ,ASN,64+9
  9,XTS,
 10,XTS,
 11,XTS,
 12,XTS,
 11,XTS,
  ,ASN,64-3
  14,AOX,TJOB
  ,ASN,64-3
  ,UTC,NFS
  ,AOX,
  ,ASN,64-36
  15,MTJ,9.***
  9,UTM,-5
  ,ITS,9
  15,AOX,
  ,AOX,=77 0470 0000.БEЗ OЖИДAHИЯ
  9,XTS,4
  ,AEX,=6HEXCLUD
  :,U1A,*+1
  ,UTC,=1
  :,XTA,
  9,ARX,
  9,STX,
  ,*52,2.***
  :15,VTM,D
  14,VTM,TERPOST-5
  ,ASN,64+34
  ,U1A,ERROR
  9,WTC,4
  14,VTM,
  14,VZM,GOOD
  9,MTJ,14
  ERROR:14,XTA,5
  14,XTS,6
    ,XTS,=6H
  ,XTS,=I1
  9,MTJ,15
  13,UJ,
  GOOD:,XTA,=6H
  ,XTS,=6H
  ,XTS,=6H
  ,XTS,=I0
  9,MTJ,15
  13,UJ,
  TERPOST:,ISO,18HHET CBЯЗИ C Ф.C.
  TJOB:,LOG,2002.CREAT
  ,LOG,04000.OPEN
  ,LOG,11002.FRIEND
  ,LOG,16002.DELET
  ,LOG,03001.CLOSE
  ,END,
 LIBDRU* :, NAME,        . T P O И Ц K
      PERSO:,ENTRY,
C******************************************
C   PEAЛИЗAЦИЯ    *PERSO  ДЛЯ ПPOИЗBOЛЬHOЙ
C           ДЛИHЫ KATAЛOГA.
C   (ДO 8-MИ ЗOH) БИБЛИOTEKA ПИШETCЯ CPAЗY
C   ЗA KATAЛOГOM.            ИCПOPЧEHHЫE B
C   LIBRARY ПOДPOГPAMMЫ B TEMPORARY LIB HE
C   ПOПAДAЮT.
C******************************************
 CBOБOДHO:,EQU,54B
 TEMPORAR:,EQU,47B
 PERMANEN:,EQU,60B.
 PARAMT*:,SUBP,
 *MONCRD*:,LC,12.
 KATAЛOГИ:PC,BLOCK,NEWCAT(8192),OLDCAT(8192)
 WBUF:,PC,1024.
 RBUF:,PC,1024.
 NRBF:,P/P,(RBUF)16
 NWBF:,P/P,(WBUF)16
 NPC:,P/P,(NEWCAT)16
 NPO:,P/P,(OLDCAT)16
 *C:7,BASE,*C.
 ,XTA,.
 ,ATX,FLDIAG.
 14,VTM,1-16384.
 LCC//:14,UTC,KATAЛOГИ+16383
 ,ATX,
 14,VLM,LCC//.
 ,ITA,13.
 ,ATX,RETURN.
 ,ATX,FLCONT.
 ,XTA,=670000
 ,ATX,PLACE.MECTO LIBRARY.
 10,VTM,.
 13,VJM,PARAMT*.
 11,VZM,NO PARAM.HET ПAPAMETPOB
 9,VTM,PLACE.
 10,VTM,4.
 13,VJM,PARAMT*.YKAЗATEЛЬ MЛ
 14,VIM,EXIT
 11,VZM,NO PARAM.
 10,VTM,6.
 13,VJM,PARAMT*.
 ,XTA,*MONCRD*
 ,AEX,=6HCONT
 ,ATX,FLCONT.
 NO PARAM: ,BSS,.ПAPAMETPЫ ПOЛYЧEHЫ
 2,VTM,OLDCAT+2.
 3,VTM,RBUF-1022.
 ,XTA,FLCONT.
 ,UZA,CONT.
 ,XTA,=21 20000.ДЛИHHЫЙ KATAЛOГ
 ,ATX,CBOБOДHO.
 ,UTC,PERMANEN-TEMPORAR.
 CONT:,XTA,TEMPORAR.ДOЗAПИCЬ CM
 ,AOX,=:7773 77
 ,AEX,=:7773 77
 ,ARX,IR*.
 ,ATX,W0001.HAЧAЛO KATAЛOГA
 ,*70,W0001.
 3,XTA,1022.
 ,AAX,=200 0000
 ,UZA,KAПYT.
 3,XTA,1022.
 ,AAX,=7777 7777 7000 0037
 3,AOX,1023.
 ,UIA,KAПYT.
 3,XTA,1022
 ,AAX,=70 0000
 ,UZA,KAПYT.
 LOOPCO:3,XTA,1025.
 ,AEX,=7777 7777 7777 7777
 ,UZA,END CATO
 3,XTA,1024.
 ,UZA,END CATO
 2,ATX,.
 3,XTA,1025.
 2,ATX,1.
 3,UTM,2.
 2,UTM,2.
 2,UTC,-OLDCAT.ПPOBEPKA
 14,VTM,-8182.ПEPEПOЛHEHИЯ
 14,VZM,TO LONG.KATAЛOГA
 3,UTM,-RBUF.
 3,VIM,NOT/EMPT.
 3,VTM,-1024.
 ,XTA,W0001.
 14,VJM,NEXT*TRZ.CЛEД. TPAKT.
 ,ATX,W0001.
 ,*70,W0001.
 NOT/EMPT:3,UTM,RBUF.
 ,UJ,LOOPCO.
 NEXT*TRZ:,ARX,=1.
 15,ATX,.
 ,ARX,=10 0000
 ,AAX,=40 0000
 ,UIA,ML*ZONE.
 15,XTA,.
 ,ARX,=7740
 ,AOX,=7740
 ,AEX,=7740.
 14,UJ,.
 ML*ZONE:15,XTA,.
 14,UJ,.
 END CATO:,ITA,2
 ,ATX,ENDCTLO.
 ,XTA,.
 2,ATX,
 ,XTA,=7777 7777 7777 7777
 2,ATX,1.
C****************************************
C   ЧTEHИE KATAЛOГA PERSONAL LIBRARY
C****************************************
 2,VTM,NEWCAT+2.
 3,VTM,RBUF-1022.
 ,XTA,PLACE.
 ,ARX,IR*.
 ,ATX,W0001.HAЧAЛO KATAЛOГA
 ,*70,W0001.
  3,XTA,1022.
 ,AAX,=200 0000
 ,UZA,KAПYT1.
  3,XTA,1022.
 ,AAX,=7777 7777 7000 0037
 3,AOX,1023.
 ,UIA,KAПYT1.
 3,XTA,1022.
 ,AAX,=70 0000
 ,UZA,KAПYT1.
 3,XTA,1024.
 ,UZA,LIBEMPTY.ПYCTAЯ БИБЛИOTEKA
 LOOPC:3,XTA,1024.
 ,UZA,END CAT.ECЛИ HET PERMANENT
 2,ATX,.
 3,XTA,1025.
 2,ATX,1.
 3,UTM,2.
 2,UTM,2.
 3,UTM,-RBUF.
 3,VIM,NOT EMPT.
 3,VTM,-1024.
 ,XTA,W0001.
 14,VJM,NEXT*TRZ.CЛEД. TPAKT.
 ,ATX,W0001.
 ,*70,W0001.
 NOT EMPT:3,UTM,RBUF.
 ,UJ,LOOPC.
 END CAT:,ITA,2
 ,ATX,ENDCTL.
 ,AAX,=1777.
 ,ATI,13.
 ,XTA,.
 2,ATX, .
 ,XTA,=7777 7777 7777 7777
 2,ATX,1.
 13,UTM,RBUF+2.KOMEHTAPИЙ
 ,ITS,13.  ИЗ
 13,UTM,18.KATAЛOГA
 ,ITS,13.БИБЛИOTEKИ
 ,XTS,=1.
 ,CALL,PRINT8.
 ,XTA,CBOБOДHO.
 ,APX,=77 76000
 ,AUX,=77 0037
 ,AOX,IW*.
 ,AOX,=:001
 ,ATX,W0003.KYДA ПИCATЬ
      ,XTA,CBOБOДHO.
      ,AAX,=1777.
      ,ATI,5.
      5,UTM,-1024.
      ,UZA,NO SWING.C HAЧAЛA TPAKTA
 ,*70,W0003.ПOДKAЧKA
      NO SWING:,BSS,.CЭKOHOMИЛИ OБMEH
 ,XTA,W0003.
 ,AEX,=:001
 ,ATX,W0003.
 LOOPC2:2,UTM,-2.
 2,XTA,.
 ,UZA,FIN/REF.BCЯ PERSONAL
 2,XTA,1.
 ,AAX,=:2.
 ,UZA,LOOPC2.ЭTO BXOД
 2,XTA,1.
 ,APX,=1740 0000 0000 0000
 ,AUX,=1740
 ,ATI,3.
 3,UTM,RBUF.
 2,XTA,1.
 ,APX,=0037 7700 0000 0000
 ,AUX,=0000 0000 0000 3777.
 ,NTR,3
 ,A-X,=1040.
 ,ARX,PLACE.
 ,AOX,IR*.
 ,ATX,W0002.
 ,AEX,W0001.
 ,UZA,NO SWOP.ЗOHA B ПAMЯTИ
 ,*70,W0002.ПOДKAЧAЛИ
 ,XTA,W0002.ЗOHY
 ,ATX,W0001.
 NO SWOP:,XTA,=3.
 ,ATX,LG SM.ДЛИHA CT MACCИBA
 ,XTA,.
 ,ATX,LG SB.ДЛИHA SUBP HA ЗAГP
C*****************************************
C   ПPOBEPKA TPEX CЛOB CTPYKTYPЫ CM.
C*****************************************
 14,VTM,-3.
 3,XTA,.
 CЛOBO 1:15,ATX,.PEЗEPB1
 ,AAX,=7777.PEЗEPB2
 ,ARX,LG SM.OБOЗHAЧEHИЯ
 ,STX,LG SM.ЗAГOЛOBOK
 ,ASN,64+12.
 14,VLM,CЛOBO 1.
 14,VTM,-2.
 3,XTA,1.
 CЛOBO 2:15,ATX,.SET
 ,AAX,=77777. DATA
 ,ARX,LG SM .ИДEHT-PЫ
 ,STX,LG SM.
 ,ASN,64+15.
 14,VLM,CЛOBO 2.
 CЛOBO 3:3,XTA,2.
 15,ATX,.
 ,AAX,=77777
 15,ATX,.
 ,ARX,LG SM.KOMAHДЫ
 ,STX,LG SM.
 ,ARX,LG SB.
 ,STX,LG SB.
 ,ASN,64+15.BSS
 15,ATX,.
 ,AAX,=77777
 ,ARX,LG SB.
 ,STX,LG SB.
 ,ASN,64+15.
 15,ATX,.
 ,ARX,LG SM.KOHCTAHTЫ
 ,STX,LG SM.
 ,ARX,LG SB.
 ,ATX,LG SB.
C*******************************************
C    KOHTPOЛЬ ДЛИHЫ ПPOГPAMMЫ ПO KATAЛOГY
C*******************************************
 2,XTA,1.
 ,ASN,64+15.
 ,AEX,LG SB.
 ,AAX,=77777.
 ,UZA,GOOD.ДЛИHЫ COBПAЛИ
C*******************************************
C   ИCПOPЧEHHAЯ ПOДПPOГPAMMA ДOЛЖHA БЫTЬ
C   ИCKЛЮЧEHA CO BCEMИ CBOИMИ   BXOДAMИ.
C*******************************************
 ,XTA,FLDIAG.
 ,UIA,БЫЛA YЖE.
 13,VTM,ПOPЧA.
 ,PRINT,INFPR.
 ,ITA,13.
 ,ATX,FLDIAG.
 БЫЛA YЖE:,ITA,2.
 ,ATX,A HAЧ.
 10,VTM,-20.
 ECTЬ EЩE:2,XTS,.
 10,UTC,20
 14,VTM,LINE.
 ,ITS,14.
 ,CALL,PT6/G.
 10,UTM,2.
 10,VIM,ISPLASE.
 ,PRINT,IBAD.
 10,VTM,-20.
 ISPLASE:2,UTM,2.
 2,XTA,.
 ,UZA,******.
 2,XTA,1.
 ,AAX,=:2.
 ,UZA,ECTЬ EЩE.
 ******:10,UTM,20.
 10,VZM,NO SHAKE.
 10,UTM,-20.
 ,PRINT,IBAD.
C*************************************
C   ИCKЛЮЧEHИE BXOДOB И KOPPEKTИPOBKA
C         K A T A Л O Г A
C*************************************
 NO SHAKE:,NTR,3.
 ,ITA,2.
 ,A-X,A HAЧ.
 ,ATX,SHIFT.BEЛИЧИHA ПPOДBИЖKИ
 ,ITA,2.
 ,A-X,ENDCTL.ЧИCЛO ПEPECЫЛAEMЫX
 ,ATI,14.KOДOB
 14,UTM,-1.
 ,WTC,A HAЧ.
 10,VTM,.
 L/DEL1:,WTC,SHIFT.
 10,XTA,.
 10,ATX,.
 10,UTM,1.
 14,VLM,L/DEL1.
 ,XTA,A HAЧ.
 ,ATI,2.
 ,XTA,ENDCTL.
 ,A-X,SHIFT.
 ,ATX,ENDCTL.
 ,ATI,10.
 ,WTC,SHIFT.
 14,VTM,.
 ,XTA,.
 L/DEL2:10,ATX,2
 10,UTM,1.
 14,UTM,-1.
 14,VIM,L/DEL2.
 ,UJ,LOOPC2.
 GOOD:,XTA,LG SM.
 ,ARX,=37.
 ,ASN,64+5
 ,ASN,64-5.
 ,ATX,LG SM.
 ,ATI,10.
 3,UTM,-RBUF.!!!!!!
 3,UTM,-1024.!!!!!!!
C**************************************
C   ПEPEПИCЬ CM ИЗ PERSO B TEMPO
C**************************************
 LOOPWRSM:10,VZM,FIN/SM.
 13,VJM,RDWRD.ЧTEHИE CЛOBA CM.
 10,UTM,-1.
 13,VJM,WRWRD.ЗAПИCЬ CЛOBA CM.
 ,UJ,LOOPWRSM.ПEPEПИCЬ CM.
 RDWRD:3,UTM,1.
 3,UTC,RBUF.
 ,XTA,1023.
 13,UTC,.
 3,VIM,.
 3,VTM,-1024.
 ,XTS,W0001.
 14,VJM,NEXT*TRZ.
 ,ATX,W0001.
 ,*70,W0001.
 15,XTA,.
 13,UJ,.
 WRWRD:5,UTM,1.
 5,UTC,WBUF.
 ,ATX,1023.
 13,UTC,.
 5,VIM,.
 5,VTM,-1024.
      ,XTA,W0003.KOHTPOЛЬ HYЖEH
      ,ARX,=10 0000.HE ПPИ ЧTEHИИ,
      ,AAX,=40 0000.KAK Y ББ ,
      ,U1A,OVERFLOW.A ПPИ ЗAПИCИ !!!
 ,*70,W0003.
 ,XTA,W0003.
 14,VJM,NEXT*TRZ.
 ,ATX,W0003.
 13,UJ,.
 FIN/SM:,BSS,.
C***************************************
C  KOPPEKTИPOBKA CTPOKИ KATAЛOГA
C  И ЯЧEЙKИ 54B
C***************************************
 2,XTA,1.
 ,AAX,=2000 0077 7777 7777
 2,ATX,1.
 ,XTA,CBOБOДHO.
 ,APX,=1740.
 ,AUX,=1740 0000 0000 0000
 2,AOX,1.
 2,ATX,1.
 ,XTA,CBOБOДHO.
 ,APX,=77 76000
 ,AUX,=0037 7700 0000 0000
 2,AOX,1.
 2,ATX,1.ИCПPABЛEHO
 ,XTA,LG SM.
 ,ARX,CBOБOДHO
 ,ATX,CBOБOДHO
 ,UJ,LOOPC2.
 FIN/REF:5,UTM,1024.
 5,VZM,DRUMFULL.
      ,XTA,W0003.EЩE PAЗ
      ,ARX,=10 0000.ПPO -
      ,AAX,=40 0000.KOH -
      ,U1A,OVERFLOW.TPOЛИPYEM
 ,*70,W0003.
 DRUMFULL:,BSS,.
C********************************************
C   OБ'EДИHEHИE KATAЛOГOB БИБЛИOTEK
C********************************************
 ,WTC,ENDCTL.
 2,VTM,.
 3,VTM,OLDCAT
 LOOPADD:3,UTM,2.
 3,XTA,.
 ,UZA,FIN/ADD.
 2,MTJ,14
 ПPOBBXOД:14,UTM,-2.
 14,XTA,.
 ,UZA,HET BXOДA.
 3,AEX,.
 ,UIA,ПPOBBXOД.
 3,XTA,1.
 ,AAX,=:2
 ,UZA,LOOPADD.BXOД
 3,XTA,2.
 ,UZA,LOOPADD.BXOД- ПOCЛEДHИЙ
 3,XTA,3.
 ,AAX,=:2
 ,UIA,LOOPADD.HOBЫЙ CM.
 3,XTA,1.
 ,AOX,=77777
 ,AEX,=77777
 3,AOX,3.
 3,ATX,3.
 ,UJ,LOOPADD.
 HET BXOДA:3,XTA,.
 2,ATX,.
 3,XTA,1.
 2,ATX,1.
 2,UTM,2.
 ,UJ,LOOPADD.
 FIN/ADD:,XTA,.
 14,VTM,NEWCAT.
 2,ATX,.
 14,ATX,1.
 ,XTA,=7777 7777 7777 7777
 2,ATX,1.
 ,XTA,CBOБOДHO.
 14,ATX,.
 2,UTM,-NEWCAT.
 ,ITA,2.
 ,ARX,=1777
 ,ASN,64+10
 ,ATI,2.ДЛИHA KATAЛOГA B ЗOHAX
 ,NTR,3
 ,A-X,=11
 ,UZA,TO LONG.
 ,XTA,IWC*
 ,ATX,W0001.
 LOWC:2,VZM,EXIT.
 ,*70,W0001.
 2,UTM,-1
 ,XTA,W0001.
 ,ARX,=:0000 0100
 14,VJM,NEXT*TRZ
 ,ATX,W0001.
 ,UJ,LOWC.
 KAПYT1:,UTC,ПPЧ2-ПYCTO.
 LIBEMPTY:,BSS,.ПYCTAЯ БИБЛИOTEKA
 13,VTM,ПYCTO.
 ,PRINT,INFPR.
 EXIT:,NTR,6
 ,WTC,RETURN
 ,UJ,.
 OVERFLOW:,UTC,ПEPEП-ПЛOXO.
 KAПYT:,UTC,ПЛOXO-БOЛЬШOЙ
 TO LONG:13,VTM,БOЛЬШOЙ
 ,PRINT,INFPR.
 ,*62,   .
 INFPR:13,,.
 13,,.
 :,001,.
 9, ,.
 IR*:,010,NRBF
 ,,.
 IW*:,,NWBF.
 ,,.
 IWC*:,,NPC.
 ,021,.
 IBAD:,,LINE.
 10,Z00,LINE+19.
 :,004,.
 8,,.
 ПYCTO:,GOST,20HБИБЛИOTEKA ПYCTAЯ'133''231'
 БOЛЬШOЙ:,GOST,18HБOЛЬШOЙ KATAЛOГ'133''231'
 ПЛOXO:,GOST,36HИCПOPЧEH KATAЛOГ TEMPORARY LIBRARY'133''231'
 ПOPЧA:,GOST,24HИCПOPЧEHЫ ПOДПPOГPAMMЫ:'231'
 ПEPEП:,GOST,36HПEPEПOЛHEHA BPEMEHHAЯ БИБЛИOTEKA'133''231'
 ПPЧ2 :,GOST,24HБИБЛИOTEKA ИCПOPЧEHA '133''231'
 LINE:,BSS,20
 ,GOST,1H'231'
 FLDIAG:,OCT,.
 OGR:,BSS,1.
 PLACE:,BSS,1.
 LG SM:,BSS,1.
 LG SB:,BSS,1.
 W0001:,BSS,1.
 W0002:,BSS,1.
 W0003:,BSS,1.
 A HAЧ:,BSS,1.
 SHIFT:,BSS,1.
 RETURN:,BSS,1.
 LENCAT:,BSS,1.
 ENDCTL:,BSS,1.
 ENDCTLO:,BSS,1.
 FLCONT:,BSS,1.
 ,END,LIBDRU*.
 LIBRARY/:,NAME,.
C************************************
C  ДИHAMИЧECKИЙ ДOЗAKAЗ И ПEPEЗAKAЗ
C  OБЩИX БИБЛИOTEK       LIBRARY
C            * * *
C  BЫЗOB *NEW LIBRARY:N1,NI-NK...
C     - ПEPEЗAKAЗ,
C A BЫЗOB *LIBRARY:N1,NI-NK......
C     - ДOЗAKAЗ.
C*************************************
 LIBREQ:,EQU,73B.
  *C:,XTS,LIBREQ
  ,UJ,P73/
 NEWLIBR/:,ENTRY,.
  14,VTM,21B.SYSTEM
  ,ITS,14.LIBRARY
  P73/:,BSS,
 ,ATX,LIBREQ.
 ,ITA,13.
 ,ITS,7.
 ,ITS,.
 7,BASE,*C.
 10,VTM,.
 ,CALL,PARAMT*.HAЧAЛO П/K
 11,VZM,ERROR.
 LOOP:9,VTM,NLIBI.
 10,VTM,5.
 ,CALL,PARAMT*.
 14,VIM,ERROR.
 ,UZA,BCE.
 11,UTM,-55B."-"
 11,VZM,ДИAПAЗOH.
 11,UTM,55B.
 11,VIM,NO EXIT.HE ПYCTO
 *1:13,VTM,BCE.
 ,UJ,PUT.
 NO EXIT:11,UTM,-56B."."
 11,VZM,*1.
 13,VTM,LOOP.
 ,UJ,PUT.
 ДИAПAЗOH:,BSS,.
 9,VTM,NLIBO.
 10,VTM,5.
 ,CALL,PARAMT*.
 14,VIM,ERROR.
 ,UZA,ERROR.
 ,ARX,=10
 ,ASN,64+6
 ,UIA,ERROR.
 ,XTA,=1.
 ,ATX,W0002.
 ,XTA,NLIBO.
 ,NTR,3.
 ,A-X,NLIBI.
 ,UZA,GOOD.
 ,XTA,=77
 ,ATX,W0002.
 GOOD:,XTA,NLIBI.
 13,VJM,PUT.
 ,XTA,NLIBI.
 ,AEX,NLIBO.
 ,UZA,ELOOP.
 ,AEX,NLIBO.
 ,ARX,W0002.
 ,AAX,=77
 ,ATX,NLIBI.
 ,UJ,GOOD.
 PUT:,BSS,.
 ,ATX,W0001.
 ,NTR,3
 ,A-X,=70
 ,UZA,ERROR.
 ,XTA,W0001.
 15,ATX,.
 ,ASN,64-6.
 15,AOX,.
 15,ATX,.
 ,ASN,64-12.
 15,AOX,
 15,ATX,.
 ,ASN,64-24.
 15,AOX,.
 ,AEX,LIBREQ.
 ,ATX,W0001.
 ,AAX,C40*.
 ,ATX,W0001+1.
 ,XTA,W0001.
 ,AAX,C37*.
 ,ARX,C37*.
 ,AAX,C40*.
 ,AOX,W0001+1.
 ,ACX,
 ,ASN,64+3.
 13,UZA,.YЖE БЫЛA
 ,XTA,=77
 ,ATX,W0001.
 14,VTM,-7.
 SERP:,XTA,LIBREQ.
 ,AAX,W0001.
 ,UZA,ECTЬ.
 ,XTA,W0001.
 ,ASN,64-6.
 ,ATX,W0001.
 14,VLM,SERP.
 ,UJ,NO PLASE.
 ECTЬ:,BSS,.
 ,XTA,NLIBI.
 ,ASN,64-42.
 ,AUX, W0001.
 ,AOX,LIBREQ.
 ,ATX,LIBREQ.
 13,UJ,.
 ELOOP:11,VZM,BCE.
 ,UJ,LOOP.
 NO PLASE:,UTC,ABST-ERT.
 ERROR:13,VTM,ERT.
 ,*64,INF.
 BCE:,BSS,.
 ,STI,.
 ,STI,7.
 ,STI,13.
 ,NTR,6.
 13,UJ,.
 INF:13,,.
 13,,.
 :,010,.
 8,,
 ERT:,GOST,24HOШИБKA ПPИ ЗAKAЗE OБCП'133''231'
 ABST:,GOST,24HCЛИШKOM MHOГO OБCП '133''231'
 C40*:,OCT,4040 4040 4040 4040
 C37*:,OCT,3737 3737 3737 3737
 W0001:,BSS,2.
 W0002:,BSS,1.
 NLIBI:,BSS,1.
 NLIBO:,BSS,1.
 ,END,LIBRARY*.
 LIBTAP* :, NAME,        . T P O И Ц K
      TO PERSO:,ENTRY,
C******************************************
C   PEAЛИЗAЦИЯ *TO PERSO  ДЛЯ ПPOИЗBOЛЬHOЙ
C           ДЛИHЫ KATAЛOГA.
C   (ДO 8-MИ ЗOH) БИБЛИOTEKA ПИШETCЯ CPAЗY
C   ЗA KATAЛOГOM.  ИCПOPЧEHHЫE B TEMPORARY
C   LIBRARY ПOДPOГPAMMЫ B БИБЛИOTEKY    HE
C   ПOПAДAЮT.  ECЛИ MAЛO MЛ, TO БИБЛИOTEKA
C   HE ПИШETCЯ. БИБЛИOTEKA HYЛEBOЙ ДЛИHЫ -
C   TOЖE HE ПИШETCЯ.
C******************************************
 CBOБOДHO:,EQU,54B
 TEMPORAR:,EQU,47B
 DATA*:,LC,2.
 PARAMT*:,SUBP,
 *MONCRD*:,LC,12.
 KATAЛOГ :PC,BLOCK,NEWCAT(8192)
 WBUF:,PC,1024.
 REFER:,PC,4096
 RBUF:,PC,1024.
 NRBF:,P/P,(RBUF)16
 NWBF:,P/P,(WBUF)16
 NPC:,P/P,(NEWCAT)16
 *C:,XTA,.
 ,UJ,ENTER.
 LIBTAP*S:,ENTRY,.
 ,XTA,=77777
 ENTER:7,BASE,*C.
 ,ATX,ПAPOЛЬ.
 ,ITA,13.
 ,ATX,RETURN.
 ,XTA,=1000.
 ,ATX,OGR.ДЛИHA LIBRARY
 ,XTA,=670000
 ,ATX,PLACE.MECTO LIBRARY.
 10,VTM,.
 13,VJM,PARAMT*.
 11,VZM,NO PARAM.HET ПAPAMETPOB
 9,VTM,PLACE.
 10,VTM,4.
 13,VJM,PARAMT*.YKAЗATEЛЬ MЛ
 14,VIM,EXIT
 11,VZM,NO PARAM.
 10,VTM,5
 9,VTM,OGR.
 13,VJM,PARAMT*.
 14,VIM,EXIT.
 NO PARAM:14,VTM,-11.
 ,XTA,=6H
 LOCOM:14,UTC,*MONCRD*
 ,ATX,11.
 14,VLM,LOCOM.
 11,VZM,NO*PARAM.
 10,VTM,1.KOMEHTAPИЙ-
 13,VJM,PARAMT*.TEKCT C ПPOБEЛAMИ
C********************************************
C      ФOPMИPOBAHИE KATAЛOГA LIBRARY
C********************************************
 NO*PARAM:2,VTM,NEWCAT+2.
 ,XTA,.
 2,ATX,-1.
 2,ATX,-2.
 3,VTM,RBUF-1022.
 ,XTA,TEMPORAR.
 ,AOX,=:7773 77
 ,AEX,=:7773 77
 ,ARX,IR*.
 ,ATX,W0001.HAЧAЛO KATAЛOГA
 ,*70,W0001.
 3,XTA,1022
 ,AAX,=200 0000
 ,UZA,KAПYT.
  3,XTA,1022.
 ,AAX,=7777 7777 7000 0037
  3,AOX,1023.
 ,UIA,KAПYT.
  3,XTA,1022
 ,AAX,=70 0000
 ,UZA,KAПYT.
 LOOPC:3,XTA,1025.
 ,AAX,=:4.
 ,UZA,HET/ПAP.
 ,XTA,ПAPOЛЬ.
 ,UZA,END CAT.
 HET/ПAP:3,XTA,1024.
 ,UZA,END CAT.ECЛИ HET PERMANET
 2,ATX,.
 3,XTA,1025.
 2,ATX,1.
 3,UTM,2.
 2,UTM,2.
 2,UTC,-NEWCAT.ПPOBEPKA
 14,VTM,-8174.ПEPEПOЛHEHИЯ
 14,VZM,TO LONG.KATAЛOГA
 3,UTM,-RBUF.
 3,VIM,NOT EMPT.
 3,VTM,-1024.
 ,XTA,W0001.
 14,VJM,NEXT*TRZ.CЛEД. TPAKT.
 ,ATX,W0001.
 ,*70,W0001.
 NOT EMPT:3,UTM,RBUF.
 ,UJ,LOOPC.
 NEXT*TRZ:,ARX,=1.
 15,ATX,.
 ,ARX,=10 0000
 ,AAX,=40 0000
 ,UIA,ML*ZONE.
 15,XTA,.
   ,ARX,=7740
 ,AOX,=7740
 ,AEX,=7740.
 14,UJ,.
 ML*ZONE:15,XTA,.
 14,UJ,.
 END CAT:,ITA,2
 ,ATX,ENDCTL.
 ,ATX,W0001.
 ,XTA,.
 ,ATX,LENFUL.ДЛИHA BCEX CM.
 2,ATX,.
 ,XTA,=7777 7777 7777 7777
 2,ATX,1.
 4,VTM,REFER.
C********************************************
C   ПEPBЫЙ ПPOXOД ПO TEMPORARY - ПOЛYЧEHИE
C   ДЛИH CM. BCEX ПOДПPOГPAMM  И  ПPOBEPKA
C   ИX      Ц E Л O C T H O C T И.
C********************************************
 LOOPC2:2,UTM,-2.
 2,XTA,.
 ,UZA,FIN/REF.BCE CCЫЛKИ.
 2,XTA,1.
 ,AAX,=:2.
 ,UZA,LOOPC2.ЭTO BXOД
 2,XTA,1.
 ,APX,=1740 0000 0000 0000
 ,AUX,=1740
 ,ATI,3.
 3,UTM,RBUF.
 2,XTA,1.
 ,APX,=4037 7700 0000 0000
 ,AUX,=0004 0000 0077 0037.
 ,AOX,IR*.
 ,ATX,W0002.
 ,AEX,W0001.
 ,UZA,NO SWOP.ЗOHA B ПAMЯTИ
 ,*70,W0002.ПOДKAЧAЛИ
 ,XTA,W0002.ЗOHY
 ,ATX,W0001.
 NO SWOP:,XTA,=3.
 ,ATX,LG SM.ДЛИHA CT MACCИBA
 ,XTA,.
 ,ATX,LG SB.ДЛИHA SUBP HA ЗAГP
C*****************************************
C   ПPOBEPKA TPEX CЛOB CTPYKTYPЫ CM.
C*****************************************
 14,VTM,-3.
 3,XTA,.
 CЛOBO 1:15,ATX,.PEЗEPB1
 ,AAX,=7777.PEЗEPB2
 ,ARX,LG SM.OБOЗHAЧEHИЯ
 ,STX,LG SM.ЗAГOЛOBOK
 ,ASN,64+12.
 14,VLM,CЛOBO 1.
 14,VTM,-2.
 3,XTA,1.
 CЛOBO 2:15,ATX,.SET
 ,AAX,=77777. DATA
 ,ARX,LG SM .ИДEHT-PЫ
 ,STX,LG SM.
 ,ASN,64+15.
 14,VLM,CЛOBO 2.
 CЛOBO 3:3,XTA,2.
 15,ATX,.
 ,AAX,=77777
 15,ATX,.
 ,ARX,LG SM.KOMAHДЫ
 ,STX,LG SM.
 ,ARX,LG SB.
 ,STX,LG SB.
 ,ASN,64+15.BSS
 15,ATX,.
 ,AAX,=77777
 ,ARX,LG SB.
 ,STX,LG SB.
 ,ASN,64+15.
 15,ATX,.
 ,ARX,LG SM.KOHCTAHTЫ
 ,STX,LG SM.
 ,ARX,LG SB.
 ,ATX,LG SB.
C*******************************************
C    KOHTPOЛЬ ДЛИHЫ ПPOГPAMMЫ ПO KATAЛOГY
C*******************************************
 2,XTA,1.
 ,ASN,64+15.
 ,AEX,LG SB.
 ,AAX,=77777.
 ,UZA,GOOD.ДЛИHЫ COBПAЛИ
C*******************************************
C   ИCПOPЧEHHAЯ ПOДПPOГPAMMA ДOЛЖHA БЫTЬ
C   ИCKЛЮЧEHA CO BCEMИ CBOИMИ   BXOДAMИ.
C*******************************************
 ,XTA,FLDIAG.
 ,UIA,БЫЛA YЖE.
 13,VTM,ПOPЧA.
 ,PRINT,INFPR.
 ,ITA,13.
 ,ATX,FLDIAG.
 БЫЛA YЖE:,ITA,2.
 ,ATX,A HAЧ.
 10,VTM,-20.
 ECTЬ EЩE:2,XTS,.
 10,UTC,20
 14,VTM,LINE.
 ,ITS,14.
 ,CALL,PT6/G.
 10,UTM,2.
 10,VIM,ISPLASE.
 ,PRINT,IBAD.
 10,VTM,-20.
 ISPLASE:2,UTM,2.
 2,XTA,.
 ,UZA,******.
 2,XTA,1.
 ,AAX,=:2.
 ,UZA,ECTЬ EЩE.
 ******:10,UTM,20.
 10,VZM,NO SHAKE.
 10,UTM,-20.
 ,PRINT,IBAD.
C*************************************
C   ИCKЛЮЧEHИE BXOДOB И KOPPEKTИPOBKA
C         K A T A Л O Г A
C*************************************
 NO SHAKE:,NTR,3.
 ,ITA,2.
 ,A-X,A HAЧ.
 ,ATX,SHIFT.BEЛИЧИHA ПPOДBИЖKИ
 ,ITA,2.
 ,A-X,ENDCTL.ЧИCЛO ПEPECЫЛAEMЫX
 ,ATI,14.KOДOB
 14,UTM,-1.
 ,WTC,A HAЧ.
 10,VTM,.
 L/DEL1:,WTC,SHIFT.
 10,XTA,.
 10,ATX,.
 10,UTM,1.
 14,VLM,L/DEL1.
 ,XTA,A HAЧ.
 ,ATI,2.
 ,XTA,ENDCTL.
 ,A-X,SHIFT.
 ,ATX,ENDCTL.
 ,ATI,10.
 ,WTC,SHIFT.
 14,VTM,.
 ,XTA,.
 L/DEL2:10,ATX,2
 10,UTM,1.
 14,UTM,-1.
 14,VIM,L/DEL2.
 ,UJ,LOOPC2.
 GOOD:,XTA,LG SM.
 ,ARX,=37.
 ,ASN,64+5
 4,ATX,.ДЛИHA CM B 40-X
 ,ASN,64-5.B CЛOBAX
 ,ARX,LENFUL.
 ,ATX,LENFUL.OБЩ. ДЛИHA
 4,VLM,LOOPC2.
C******************************************
C   ДЛИHЫ BCEX CM. ИЗBECTHЫ, ИЗBECTHA
C   ДЛИHA BCEЙ БИБЛИOTEKИ.
C******************************************
 FIN/REF:,BSS,.
 ,XTA,LENFUL.
 ,UZA,LIBEMPTY.ПYCTAЯ БИБЛИOTEKA
 ,XTA,ENDCTL.
 ,ATI,2.
 ,XTA,.
 2,ATX,
 ,XTA,=7777 7777 7777 7777
 2,ATX,1.
 ,XTA,=6HLIBRAR
 2,ATX,2.
 ,XTA,=6HY OT
 2,ATX,3.
 ,XTA,DATA*.
 2,ATX,4.
 ,XTA,DATA*+1.
 2,ATX,5.
 ,*65,700B
 15,ATX,.
 ,*65,757B.
 15,AOX,.
 ,AEX,=4000 0000 0000 0001
 ,UIA,ДИCПAK.
 ,*50,67B.
 15,ATX,.
 ,APX,=0000 1777 7400 0000
 ,AUX,=6H'17''17''''03''17'''
 ,AOX,=6H00 00.
 2,STX,5.
 ,APX,=0000 0000 0377 7760
 ,AUX,=6H'17''17''''17''17'''
 ,AOX,=6H00.00
 ,UJ,ДYБHA.
 ДИCПAK:,XTA,=6H
 ДYБHA: 2,ATX,6.
 2,UTM,1.
 14,VTM,-9
 L/CMNT:14,UTC,*MONCRD*.
 ,XTA,9.
 14,UTC,9.
 2,ATX,6
 14,VLM,L/CMNT.
 2,UTM,-NEWCAT.
 2,UTM,20.
 ,ITA,2.
 ,ARX,=37
 ,ASN,64+5.
 ,ATX,HAЧ/CM.
 ,ATX,HAЧ*CM.
 ,ASN,64-5.
 ,ATX,LENCAT.
 ,ARX,LENFUL.
 15,ATX,.
 ,ARX,=21 00000.
 ,STX,LENFUL.0-E CЛOBO KATAЛOГA
 ,ARX,=1777
 ,ASN,64+10.
 15,ATX,.
 ,APX,=7777.
 ,AUX,=6H'''''7''7''7''7'.
 ,AOX,DOPZON.
 ,STX,LIBLEN.
 ,NTR,3.
 ,X-A,OGR.
 ,UIA,MAЛO MЛ.
 ,XTA,LENCAT.ЧИCЛO ПOЛHЫX
 ,ASN,64+10.   ЗOH B
 ,ATX,NZKTL.KATAЛOГE
C*******************************************
C   OФOPMЛEHИE KATAЛOГA ДЛЯ EГO ЗAПИCИ
C*******************************************
 4,VTM,REFER.HAЧ CCЫЛOK
 ,WTC,ENDCTL.
 2,VTM,.
 LOOPC3:2,UTM,-2.
 2,XTA,.
 ,UZA,BECЬ.
 2,XTA,1.
 ,AAX,=:2
 ,UZA,LOOPC3.BXOДЫ
 ,XTA,HAЧ/CM.
 ,ASN,64-5.
 ,ARX,=21 00000.
 ,ASN,64+10.
 ,ATX,W0003.
 ,YTA,.
 ,ASN,64+2.
 2,XTS,1.
 ,ATX,W0002.
 ,AOX,=:7777 77
 ,AEX,=:5777 77
 15,AOX,.
 ,XTS,W0003.
 ,APX,=3777.
 ,AUX,=:0037 77
 15,AOX,.
 2,ATX,1.
 4,XTA,.
 15,ATX,.
 ,ARX,HAЧ/CM.
 ,STX,HAЧ/CM.
 ,ASN,64-5.
 ,XTS,W0002.
 ,AOX,=77777
 ,AEX,=77777.
 15,AOX,.
 4,ATX,.
 4,VLM,LOOPC3.
 BECЬ:,XTA,LENFUL.
 ,UTC,NEWCAT.
 ,ATX,.
 ,XTA,.
 ,UTC,NEWCAT.
 ,ATX,1.
 ,XTA,LENCAT
 ,AAX,=1740.
 ,ATI,3.
 3,UTM,-1024.ЧИCЛO ЗAПИCEЙ
 ,XTA,NZKTL.
 ,ATI,11.ЧИCЛO ПOЛHЫX ЗOH
 ,ASN,64-10.
 ,ATI,10.
 10,UTM,NEWCAT.ПEPEПИCЬ
 14,VTM,-1023. OCTATKA
 L/SEND/C:14,UTC,.KATAЛOГA
 10,XTA,1023.HA БYФEPHЫЙ
 14,UTC,WBUF.ЛИCT
 ,ATX,1023.ЗAПИCИ
 14,VLM,L/SEND/C.
C***************************************
C   ПEPEПИCЬ ПOЛHЫX ЗOH KATAЛOГA
C***************************************
 ,XTA,PLACE.
 ,ARX,IWC*.
 ,ATX,PLACE.
 LOOPC4:11,VZM,HET ЗOH.
 ,*70,PLACE.CБPOC
 ,XTA,PLACE.ПOЛHЫX
 14,VJM,NEXT*TRZ.ЗOH
 ,ARX,=:0000 0100
 ,ATX,PLACE.KATAЛOГA
 11,UTM,-1.БИБЛИOTEKИ
 ,UJ,LOOPC4.
C************************************
C    ПEPEПИCЬ CTAHДAPTHЫX MACCИBOB
C    ПOДПPOГPAMM ИЗ TEMPORARY
C************************************
 HET ЗOH:,XTA,
 4,ATX,.OTMETKA KOHЦA CПИCKA
 ,XTA,PLACE
 ,ASN,64-24.
 ,ASN,64+24.
 ,AOX,IW*.
 ,ATX,PLACE.
 4,VTM,REFER.HAЧAЛO CПИCKA
 LOOPWRSM:4,XTA,.
 ,ATI,10.ДЛИHA CM. B CЛOBAX
 10,VZM,FINISH.
 ,APX,=1740 0000 0000 0000
 ,AUX,=1740.YCTAHOBKA
 ,ATI,5.CЛOBA ДЛЯ
 5,UTM,-1024.ЧTEHИЯ CM.
 4,XTA,
 4,UTM,1.
 ,APX,=4037 7700 0000 0000
 ,AUX,=0004 0000 0077 0037
 ,AOX,IR*
 ,ATX,W0002.
 ,AEX,W0001.
 ,UZA,IN MEMOR.
 ,*70,W0002.
 ,XTA,W0002.
 ,ATX,W0001.
 IN MEMOR:10,VZM,LOOPWRSM.
 13,VJM,RDWRD.ЧTEHИE CЛOBA CM.
 10,UTM,-1.
 13,VJM,WRWRD.ЗAПИCЬ CЛOBA CM.
 ,UJ,IN MEMOR.ПEPEПИCЬ CM.
 RDWRD:5,UTM,1.
 5,UTC,RBUF.
 ,XTA,1023.
 13,UTC,.
 5,VIM,.
 5,VTM,-1024.
 15,ATX,.
 ,XTA,W0001.
 14,VJM,NEXT*TRZ.
 ,ATX,W0001.
 ,*70,W0001.
 15,XTA,.
 13,UJ,.
 WRWRD:3,UTM,1.
 3,UTC,WBUF.
 ,ATX,1023.
 13,UTC,.
 3,VIM,.
 3,VTM,-1024.
 ,*70,PLACE.
 ,XTA,PLACE.
 14,VJM,NEXT*TRZ.
 ,ATX,PLACE.
 13,UJ,.
 FINISH:3,UTM,1024.
 3,VZM,TAPEFULL.
 ,*70,PLACE.
 TAPEFULL:,WTC,ENDCTL.
 14,VTM,-NEWCAT.
 14,UTM,-1.
 ,ITA,14.
 ,ASN,64+1.
 ,CALL,A/OCTDEC.
 ,ATX,N BXOДOB.
 13,VTM,ЧИCЛO.
 ,ITS,13.
 13,VTM,N BXOДOB.
 ,ITS,13
 13,VTM,1.
 ,ITS,13.
 ,CALL,PRINT8.
 13,VTM,ДЛИHA.
 ,PRINT,INFPR.
 ,UJ,EXIT.
 MAЛO MЛ:13,VTM,ДЛИHA.
 ,PRINT,INFPR.
   ,UTC,MAЛO-ПYCTO.
 LIBEMPTY:,BSS,.ПYCTAЯ БИБЛИOTEKA
 13,VTM,ПYCTO.
 ,PRINT,INFPR.
 EXIT:,NTR,6
 ,WTC,RETURN
 ,UJ,.
 KAПYT:,UTC,ПЛOXO-БOЛЬШOЙ
 TO LONG:13,VTM,БOЛЬШOЙ
 ,PRINT,INFPR.
 ,*62,   .
 INFPR:13,,.
 13,,.
 :,001,.
 9, ,.
 IR*:,010,NRBF
 ,,.
 IW*:,,NWBF.
 ,,.
 IWC*:,,NPC.
 ,,.
 IBAD:,,LINE.
 10,Z00,LINE+19.
 :,004,.
 8,,.
 DOPZON:,GOST,6HY 0000
 ЧИCЛO:,ISO,27HЧИCЛO ПOДПPOГPAMM И BXOДOB
 N BXOДOB:,OCT,.
 ДЛИHA:,GOST,12HДЛИHA LIBRAR
 LIBLEN:,OCT,.
 ,GOST,6H ЗOH.'231'
 ПYCTO:,GOST,23HБИБЛИOTEKA HE ЗAПИCAHA,
       ,CONT,19H T.K. OHA ПYCTAЯ '133''231'
 MAЛO:,GOST,42HБИБЛИOTEKA HE ЗAПИCAHA, T.K. MAЛO MECTA'133''231'
 БOЛЬШOЙ:,GOST,42HБИБЛИOTEKA HE ЗAПИCAHA - БOЛЬШOЙ KATAЛOГ'133''231'
 ПЛOXO:,GOST,36HИCПOPЧEH KATAЛOГ TEMPORARY LIBRARY'133''231'
 ПOPЧA:,GOST,24HИCПOPЧEHЫ ПOДПPOГPAMMЫ:'231'
 LINE:,BSS,20
 ,GOST,1H'231'
 FLDIAG:,OCT,.
 OGR:,BSS,1.
 PLACE:,BSS,1.
 HAЧ*CM:,BSS,1.
 LENFUL:,BSS,1.
 LG SM:,BSS,1.
 LG SB:,BSS,1.
 W0001:,BSS,1.
 W0002:,BSS,1.
 W0003:,BSS,1.
 A HAЧ:,BSS,1.
 SHIFT:,BSS,1.
 RETURN:,BSS,1.
 NZKTL:,BSS,1.
 HAЧ/CM:,BSS,1.
 LENCAT:,BSS,1.
 ENDCTL:,BSS,1.
 ПAPOЛЬ:,BSS,1.
 ,END,LIBTAP*.
      LINE       :,NAME,
      **         :,PC,  2000B
      *A*        :,LC,  125B
      MONCARD/   :,LC,  14
 *00000    : 9 ,  VTM,   *00000
                 ,ATI,  12
            12 ,  XTA,
                 ,ATI,  12
 *00002    :12 ,  VZM,   *00054
            12 ,   UJ,   *00002
            11 ,  VTM,  MONCARD/
                 , UJ,   *00005
                 ,WTC,   BSS+ 0003B
            11 ,  VTM,      **
 *00005    :     ,WTC,   BSS+ 0002B
             8 ,  VTM,      *A*
                 ,WTC,   BSS+ 0004B
            12 ,  VTM,  77654B
 *00007    :11 ,  XTA,
                 ,UZA,   *00054
 *00010    :15 ,  ATX,
                 ,ASN,  70B
             9 ,  STX,  73B
             9 ,  AAX,  72B
             9 ,  ATX,  74B
                 ,UZA,   *00054
             9 ,  AEX,  60B
                 ,UZA,   *00041
            10 ,  VTM,  1
             9 ,  XTA,  74B
             9 ,  AAX,  64B
                 ,UIA,   *00034
 *00016    :10 ,  J+M,  12
                 ,ITA,  12
             9 ,  AAX,  65B
                 ,UZA,   *00052
             9 ,  XTA,  74B
             9 ,  AOX,  63B
 *00021    : 8 ,  ATX,
             8 ,  UTM,  1
            10 ,  UTM,  77777B
            10 ,  VIM,   *00021
             9 ,  XTA,  73B
                 ,UIA,   *00010
            11 ,  UTM,  1
             9 ,  XTA,  76B
             9 ,  ARX,  61B
             9 ,  ATX,  76B
             9 ,  AAX,  57B
                 ,UZA,   *00007
L            8 ,  UTM,             -    *A*
                 ,ITA,  8
             9 ,  ATX,  75B
            12 ,  UTM,  124B
                 ,ITA,  12
             9 ,  ATX,  77B
 *00032    :     ,XTA,
             9 ,  ATX,  76B
             9 ,  XTA,  70B
            13 ,   UJ,
 *00034    : 9 ,  XTA,  74B
                 ,ASN,  70B
                 ,YTA,
                 ,ATI,  10
            10 ,  UTM,  77600B
            10 ,  VZM,   *00054
             9 ,  XTA,  62B
             9 ,  ATX,  74B
                 , UJ,   *00016
                 ,UTC,
 *00041    :12 ,  UTM,  1
            12 ,  VZM,   *00045
            11 ,  XTA,
             9 ,  AAX,  71B
             9 ,  AEX,  66B
                 ,UIA,   *00054
                 ,UTC,      *A*
                 ,ATX,
 *00045    :     ,XTA,
             9 ,  ATX,  75B
             9 ,  ATX,  77B
             9 ,  XTA,  76B
             9 ,  ARX,  61B
             9 ,  ATX,  76B
             9 ,  AAX,  57B
                 ,UIA,   *00032
             9 ,  XTA,  67B
            13 ,   UJ,
 *00052    : 9 ,  XTA,  70B
                 ,UTC,      *A*
                 ,ATX,
                 ,UTC,
 *00054    :     ,XTA,
             9 ,  ATX,  75B
             9 ,  ATX,  76B
             9 ,  ATX,  77B
            13 ,   UJ,
                 ,UTC,
 *00057    :,     LOG,  00000000 00002000.
            ,     LOG,  02400000 00000000.
            ,     LOG,  00000000 00000001.
            ,     LOG,  10000000 00000000.
            ,     LOG,  00020040 10020040.
            ,     LOG,  40000000 00000000.
            ,     LOG,  00000000 00040000.
            ,     LOG,  00000000 00000012.
            ,     LOG,  10052105 26052040.
            ,     LOG,  64000000 00000001.
            ,     LOG,  00000000 00000377.
            ,     LOG,  77600000 00000000.
 BSS       :     ,BSS,  5
      ,END,
 LINK/IPM:,NAME,.P B C: 3/74
 MONCARD/:LC,BLOCK,CARD(14)
 *REGIM//:LC,BLOCK,REGIM
 NOLISFL*:LC,BLOCK,LISTFL
 RM*     :LC,BLOCK,RM
 MONITOR*:,SUBP,.
 БEMШ/ПAP:,SUBP,.
 БEMШ/ПAP:I,BLOCK,(1),ЗOH/БEMШ
 ПAP/MЛ :LC,BLOCK,MAT/N
 ,CONT,DELTA
 ,CONT,REF/SC.
 GIV/MT:,SUBP,.
 READ* :,SUBP,.
 PRINT8//:,SUBP,.
 DATAPR*:,SUBP,.
C****************************************
C   БЛOK BЫЗOBA PEДAKTOPA BHEШHИX CBЯЗEЙ
C   CИCTEMЫ БEMШ-MAKPOKOД  TPOИЦK 1982
C****************************************
 LINKED:,ENTRY,.ДOП. BXOД
 1,VTM,34000B
 ,UJ,BEGIN.
 RETMON:,BSS,.
C****************************************
C  БЛOK BOЗBPATA B MOHИTOP
C****************************************
 1,VTM,-3
 L/MAG:,XTA,RM+2
 1,AEX,COTK1+3.
 ,UZA,RET/MEM.
 1,VLM,L/MAG.
 CON/RET:,BSS,.
 ,XTA,17B.
 ,ATX,S17.
 ,XTA,RM*+2
 ,ATI,15.
 ,AEX,CIW67
 ,ATX,21B
 ,XTA,=0067 0021 0220 0000
 ,CTX,17B
 ,UJ,17B
 RET/67:,XTA,S17
 ,CTX,17B
 ,UJ,MONITOR*+1.
 RET/MEM:1,*72,COTK2+3.
 ,UJ,CON/RET.
 CIW67:,Z00,RET/67
 9,,1.
C****************************************
C  HAЧAЛЬHЫE ДEЙCTBИЯ ПEPEД BЫЗOBOM
C  PEДAKTOPA   BHEШHИX       CBЯЗEЙ
C****************************************
 BEGIN:,*72,=:11 40 36 77
 ,*67,DEB.
 ,UJ,RETMON.
 DEB:,Z00,*+1
 10,Z00,76000B.
 ,XTA,LISTFL.
 ,UIA,NO PRINT.
 ,CALL,DATAPR*.
 14,VTM,HEAD
 ,ITS,14.
 14,VTM,VERS.
 ,ITS,14.
 ,ITS,
 ,CALL,PRINT8//.
 14,VTM,=6H
 ,ITS,14
 ,ITS,14
 ,ITS,
 ,CALL,PRINT8//.
C****************************************
C  ЧTEHИE KAPT C ЗAДAHИEM ДЛЯ PBC *
C****************************************
 READ/L:14,VTM,MONCARD/
 ,ITS,14.
 ,CALL,READ*.
 ,XTA,LISTFL.
 ,UIA,NO PRINT
 ,XTA,*REGIM//
 ,AAX,=:2
 ,UIA,NO RED.
 ,XTA,MONCARD/+13.
 ,ASN,64+24.
 ,ASN,64-24.
 ,ATX,LINE+1
 ,XTA,MONCARD/+12.
 ,ATX,LINE.
 8,VTM,-8
 L/S:8,UTC,MONCARD/+8
 ,XTA,.
 8,UTC,8.
 ,ATX,LINE+2.
 8,VLM,L/S.
 14,VTM,LINE.
 ,ITS,14.
 14,UTM,10.
 ,ITS,14.
 ,ITS,
 ,CALL,PRINT8//.
 8,VTM,-2.
 L/P:8,XTA,MONCARD/+11.
 ,AEX,=6H
 ,UIA,PRINT/C.
 8,VLM,L/P.
 ,UJ,NO PRINT
 PRINT/C:,BSS,.ДЛИHHAЯ KAPTA
 14,VTM,MONCARD/+9
 ,ITS,14
 14,VTM,MONCARD/+11.
 ,ITS,14
 14,VTM,40
 ,ITS,14.
 ,CALL,PRINT8//.
 ,UJ,NO PRINT.
 NO RED:14,VTM,MONCARD/.
 ,ITS,14.
 14,UTM,13.
 ,ITS,14
 ,ITS,.
 ,CALL,PRINT8//.
 NO PRINT:,BSS,.KOHEЦ ПEЧATИ
 ,XTA,MONCARD/.
C****************************************
C  YПЛOTHEHИE ДИPEKTИBЫ "ЗAM" И
C  ПEPEBOД B ШISO (ISO ИMEHИ B.C.
C            ШTAPKMAHA).
C****************************************
 ,AEX,=6HЗAM
 ,UIA,NO REP.
 ,XTA,MONCARD/.
 ,ASN,64+24.
 ,ASN,64-24.
 ,XTS,MONCARD/+1.
 ,ASN,64-24.
 ,ASN,64+24.
 15,AOX,
 ,ATX,MONCARD/.
 ,XTA,MONCARD/+2
 ,ATX,MONCARD/+1
 ,XTA,MONCARD/+3
 ,ATX,MONCARD/+2.
 NO REP:8,VTM,-2.
 *KODE:8,XTA,MONCARD/+2.
 ,AAX,=6H'100''100''100''100''100''100'
 ,AOX,=6H
 8,ARX,MONCARD/+2.
 1,ATX,.
 1,UTM,1.
 8,VLM,*KODE.
 ,XTA,MONCARD/.
 ,AEX,=6HKOHEЦ
 ,UIA,READ/L.CЛEДYЮЩAЯ KAPTA
 ,XTA,LISTFL.
 ,UIA,TO CALL.
 13,VJM,PRINT8//+1.
 TO CALL:,BSS,.ЗAKAЗ ЛEHTЫ(MOДEЛИ)
 ,CALL,GIV/MT.
 ,XTA,=0010 2000 0000 4000
 ,AOX,MAT/N.
 ,ARX,ЗOH/БEMШ.
 ,NTR,3.
 ,A-X,DELTA.
 ,AAX,=7777 7700 0077 3777
 ,ATX,21B.
 ,AAX,=2000
 ,ASN,64-1.
 ,AOX,21B.
 ,ATX,21B.
 ,*70,21B.
C****************************************
C  OTKAЗ OT HOCИTEЛЯ (ECЛИ HAДO)
C  И YXOД B  P B C  C BOЗBPATOM
C  HA RETMON.
C****************************************
 ,XTA,REF/SC.
 ,*57,4000B.
 10,VTM,RETMON.
 ,ITA,10
 ,UTC,40601B.
 ,ATX,
 ,UJ,40600B.
C****************************************
C     K O H C T A H T Ы
C****************************************
 HEAD:,ISO,24HP B C   БEMШ-MAKPOKOД
 VERS:,ISO,6H 3/74.
 COTK1:,LOG,53401
 ,LOG,55401
 ,LOG,73401
 COTK2:,OCT,00 66 36 77
      :,OCT,00 67 36 77
      :,OCT,00 36 77
 S17:,BSS,1.
 LINE:,BSS,14
 ,END,LINK/IPM.
  LISP:,NAME,
C
C... ИHИЦИATOP CИCTEMЫ   Л И C П - БЭCM/6
C
C    ABTOP BЫPAЖAET ГЛYБOKYЮ БЛAГOДAPHOCTЬ
C    Л.Г.KAMИHCKOMY ЗA KAЧECTBEHHYЮ KPИTИKY,
C    KOTOPAЯ БYДET ПPOИЗHECEHA ПO ПOBOДY
C    ЭTOЙ ПPOГPAMMЫ.      Б.Б.CAXAPOB.
C
  ,XTA,
  ,CALL,DATAPR*
  14,VTM,10 000B.
  ,CALL,BBOДA0.
  1,VTM,-7.
  ,*70,INF70.
  ,XTA,=2000 02000 11000.
  ,ATX,10B.
  ,XTA,INF70.
  ,ATX,25B.
  ,FUN,75B.
  ,*72,=:1140 3700 77.
  ,UJ,12B.
  INF70:,010,.
  ,057,.
  ,END,LISP     .
 LOADI*0:,NAME,.CAXAPOB
 ПYCTO:,LC,
 KOHДЫP:,EQU,2000B
 LENДЫP:,EQU,KOHДЫP-ПYCTO
 ДЫPA:,LC,LENДЫP
 LOADLIBR:,SUBP,.
 12,VTM,-177B.
 ,DRUM,=14 0200 0021 0006
 WRTAB:12,XTA,5777B.
 12,ATX,LOADLIBR+1777B.
 12,VLM,WRTAB
  ,XTA,TABLA*LD.
  ,ATX,LOADLIBR+1667B.HACTP. BBOДA
 ,XTA,TABLA*LD+1.
 ,ATX,LOADLIBR+1670B.KЛЮЧ
 ,*70,=100 0067 0006
 ,*64,ИH0.
 ,*64,ИH1
 ,*64,ИH2
 ,*62,
 ИH0:,,3671B
 ,,3720B.
 :2,,16
 8,022,3
 ИH1:,,3721B
 ,,3747B
 :2,,16
 8,022,3
 ИH2:,,3751B
 ,,3777B
 :2,,16
 8,022,3
 TABLA*LD:,BSS,.HACTPOЙKA LOADLIBR'A
C
C     25  -  ПPИOPИTET YПДK
C    1-3  -  HOMEP (ПO TAБЛ.DECODER-A)
C            OCHOBHOЙ ПOKOЛ.KOДИPOBKИ.
C
         :  , LOG ,        .BBOД B ДYБHE
C        :  , LOG ,0 0000 0003.B ПAXPE
 ,TEXT,8HБCAXAPOB
 ,END,.
 LOADLIBR:,NAME,
   ,SPACE,62
C**************************************************************
C*                                                            *
C*           ПEPEПИCЬ ЗAГPYЗOЧHЫX MOДYЛEЙ ПO CПИCKY           *
C*         ИЗ OБЩИX БИБЛИOTEK BO BPEMEHHYЮ БИБЛИOTEKY         *
C*         ------------------------------------------         *
C*                                                            *
C*                ЗAИKИH H.C.    ДYБHA         0X/71          *
C*                ФИPCOB         MOCKBA,ИПM    03/78          *
C*                ГOHЧAPOB H.C.  HAPA          12/86          *
C*                                                            *
C*                       BXOДHЫE ДAHHЫE                       *
C*                       --------------                       *
C*    CПИCOK ИMEH BXOДOB:                                     *
C*  1. ПPИ OБPAЩEHИИ OT ЗAГPYЗЧИKA  (B I13 - AДPEC OБMEHHOГO  *
C*  ЛИCTA) ЭTOT CПИCOK ЯBЛЯETCЯ ЧACTЬЮ TPП И HAXOДИTCЯ HA MБ  *
C*  2. B ПPOTИBHOM CЛYЧAE  (OБPAЩEHИE OT LIBRARY) CПИCOK ЗA-  *
C*  ДAETCЯ B 4-M ЛИCTE OП (ПPИЗHAK KOHЦA - HYЛEBOЙ KOД)       *
C*    CПИCOK HOMEPOB ЗAKAЗAHHЫX БИБЛИOTEK (ЯЧEЙKA - LTAPES):  *
C*  HAЧИHAETCЯ C MЛAДШИX PAЗPЯДOB.  HA KAЖДYЮ БИБЛИOTEKY OT-  *
C*  BOДИTCЯ ПO 6 PAЗPЯДOB.                                    *
C*  1. ECЛИ HOMEP <30B, ЭTO CИCTEMHAЯ OБCП                    *
C*  2. ИHAЧE, ЭTO MAT.HOMEP ЛEHTЫ/ФAЙЛA HA KOTOPOЙ C HYЛEBOЙ  *
C*  ЗOHЫ ПOMEЩEHA OБCП ПOЛЬЗOBATEЛЯ                           *
C*    ДOПYCTИMЫ CЛEДYЮЩИE ФOPMATЫ БИБЛИOTEK:                  *
C*  1. TPAДИЦИOHHAЯ PERSO - CФOPMИPOBAHHAЯ ПO Y/K             *
C*        *TO PERSO:...                                       *
C*  2. PERSO CAXAPOBA Б.Б. - CФOPMИPOBAHHAЯ ПO Y/K            *
C*        *CALL TO PERSO:...                                  *
C*  KATAЛOГ ДO BOCЬMИ ЗOH, БИБЛИOTEKA ПИШETCЯ CPAЗY ЗA KATA-  *
C*  ЛOГOM                                                     *
C*  3. TPAДИЦИOHHAЯ OБCП - CФOPMИPOBAHHAЯ ПO Y/K              *
C*        *CALL NEWLIB                                        *
C*  4. YПAKOBAHHAЯ OБCП - CФOPMИPOBAHHAЯ ПO Y/K               *
C*        *CALL CRELIB:...                                    *
C*  C ДЛИHOЙ  ПOЛHOГO  KATAЛOГA ДO BOCЬMИ ЗOH, COCTOЯЩEГO ИЗ  *
C*  OCHOBHOГO  KATAЛOГA, ЗA KOTOPЫM BПЛOTHYЮ ПИШETCЯ TAБЛИЦA  *
C*  CCЫЛOK (CПPABKA), A ЗA HEЙ BПЛOTHYЮ CПИCOK CCЫЛOK (CCЫЛ-  *
C*  KИ). B ЭTOM CПИCKE, BMECTO OTHOCИTEЛЬHOГO AДPECA BXOДA B  *
C*  OCHOBHOM KATAЛOГE, ЗAДAETCЯ EГO  ПOPЯДKOBЫЙ HOMEP, KOTO-  *
C*  PЫЙ B ДBA PAЗA MEHЬШE, ЧTO ПOЗBOЛИЛO YЛOЖИTЬCЯ B OTBEДE-  *
C*  HHЫE ДЛЯ CCЫЛKИ 12 PAЗPЯДOB. БИБЛИOTEKA ПИШETCЯ CPAЗY ЗA  *
C*  KATAЛOГOM                                                 *
C*                       OБPAЩEHИE                            *
C*                       ---------                            *
C*    ПPOГPAMMA CЧИTЫBAETCЯ C ФИЗ.MБ 20.06  B ПEPBЫЙ ЛИCT OП  *
C*  И YПPABЛEHИE ПEPEДAETCЯ HA HAЧAЛO ЛИCTA ( 2000B ). AДPEC  *
C*  BOЗBPATA БEЗ EДИHИЦЫ ЗAДAETCЯ B I13                       *
C*                    BЫXOДHЫE ДAHHЫE                         *
C*                    ---------------                         *
C*    ECЛИ HE БЫЛO ФATAЛЬHЫX OШИБOK,  BCE HAЙДEHHЫE ПPOГPAM-  *
C*  MЫ - BO BPEMEHHOЙ БИБЛИOTEKE, ECЛИ HAЙДEHЫ BCE ПPOГPAMMЫ  *
C*  ИЗ CПИCKA, CYMMATOP BЫXOДA HE PABEH HYЛЮ, BЫXOД ПO I13+1  *
C*    ФATAЛЬHЫE OШИБKИ ФИKCИPYЮTCЯ, ECЛИ:                     *
C*  1. ИCПOPЧEH KATAЛOГ BPEMEHHOЙ БИБЛИOTEKИ                  *
C*  2. ПEPEПOЛHEH KATAЛOГ BPEMEHHOЙ БИБЛИOTEKИ                *
C*  3. ПEPEПOЛHEHA BPEMEHHAЯ БИБЛИOTEKA                       *
C*  4. OБHAPYЖEHЫ ИCПOPЧEHHЫE ПPOГPAMMЫ B OДHOЙ ИЗ OБCП       *
C*  B ЭTИX CЛYЧAЯX BЫXOД ПO AДPECY 20B (OVFLJUMP)             *
C*    B ЛЮБOM CЛYЧAE COCTOЯHИE OП, KPOME ПEPBOГO И OБMEHHOГO  *
C*  ЛИCTOB, COXPAHЯETCЯ. ИЗПOЛЬЗYETCЯ MБ 02 TPAKTЫ 16-37      *
C*                                                            *
C**************************************************************
  3,SPACE,
C
C  PACПPEДEЛEHИE ПAMЯTИ
C--------
C      OБЬEKTЫ PEЗИДEHTA
C
 ALF2    :,EQU,17B.45-31P. ДЛ.TPП
 OVFLJUMP:,EQU,20B.ПEPEXB.ABOCTA
 LEX     :,EQU,43B.AДP.OБM.ЛИCTA
 ALFA    :,EQU,44B.48P.=1 БЛOK.ПЧ.
 RCAT    :,EQU,47B.IW ЧT.KAT.TEMPO
 LDRM    :,EQU,54B.CBOБOДHO B TEMPO
 RLOAD   :,EQU,61B.IW ЧT.ЗAГPYЗЧИKA
 LTAPES  :,EQU,73B.CПИCOK LIBRARY
C--------
 *REGIM//:,LC,1.ИCПOЛЬЗ. 48,19P
C--------
C      ЛИCT LOADLIBR (ПEPBЫЙ)
C
 OC/БЭCM6:,SUBP,.CBЯЗЬ C OC
 SAVELIST:,SUBP,.CПACEHИE ЛИCTA
 PT6/G   :,SUBP,.TEXT->GOST[ПЧ.]
 STATSUM :,SUBP,.CБOP CTATИCTИKИ
 TEXISO  :,SUBP,
C--------
 NLIB  :,LC,1.N TEK. LIBRARY
 E70RL :,LC,1.ИHФ.CЛOBO ДЛЯ READZONE
 STACK :,LC,40B.C ЗAПACOM
 ESTACK:,LC,
C--------
C      PAБOЧИE ПOЛЯ
C
 RDBUF:PC,BLOCK,(1023).БYФEP
 ,CONT,RDBUFE.ЧTEHИЯ
 ,CONT,USLIST(1023).CПИCOK
 ,CONT,USLISE.OTC.ПPOГPAMM
 ,CONT,CATEMP(8192)
 ,CONT,CATLIB(8192)
 *76000:B,BLOCK,WRBUF(1023).БYФEP
 ,CONT,WRBUFE.ЗAПИCИ
C--------
C          P E Г И C T P Ы
C
 *1 :,BLOCK,RI,WI,LP,WA,SE
     ,CONT ,SA,EC,SH,(1),LA,LS
 *6 :,BLOCK,UN,UI,CA,(1),LC,ER
 *10:,BLOCK,EA,I
     ,CONT ,R,J,M,S
C--------
C      ЭKOHOMИЯ PAБOЧИX ЯЧEEK
C
 PRBUF:I,BLOCK,(2)
 ,CONT,FLRL,FLPL,FLSR,FLBP
 ,CONT,NAME,LCTL,AEXT,AEXL
 ,CONT,HDSL,CEXT
 ,CONT,LMEM,LDRU,POINT
C
C FL RL - ПPИЗHAK: ГOTOBЫЙ CПИCOK B OП
C FL PL - ПPИЗHAK PERSO
C FL SR - ПPИЗHAK ЧTEHИЯ CПPABKИ
C         И CCЫЛOK
C FL BP - ПPИЗHAK ИCПOPЧ.ПPOГPAMM
C NAME  - ИMЯ BXOДA
C LCTL  - ПPИЗHAK YПAKOBAHHOЙ OБCП
C AEXT  - AДPEC HAЧAЛA CПPABKИ B OП -1
C AEXL  - AДPEC HAЧAЛA  CCЫЛOK B OП -1
C HDSL  - ЗAГOЛ. CПИCKA HAЙДEHHЫX ИMEH
C CEXT  - TEKYЩИЙ AДPEC CПИCKA
C L MEM - ДЛИHA ПPOГP. HA ЗAГPYЗKE
C L DRU - ДЛИHA CTAHД. MACCИBA
C POINT - ИHФ.CЛOBO П/П B KAT. TEMPO
C
C-------------------------------------
C
 LDLBR:,BSS,
   ,XTA,LTAPES
   ,ATX,CTN
C          J, UZA ,1.TAK HE БЫBAET
   ,NTR,3
   ,ITA,S
  S,VTM,STACK
  M,VTM,J+1.CПACAEM
 :M,UTM,-1.ИHДEKC-
  M,ITS,.PEГИCTPЫ
  M,V1M,*-1
   ,ITA,J
   ,AEX,LEX
   ,ATX,FLRL
C
C======== READ CATALOG TEMPO =========
C
C      ЧTEHИE KATAЛOГA TEMPO
C  ::RCT::
C
C LCATT - ДЛИHA KATAЛOГA TEMPO -2
C LCATN - HOBAЯ ДЛИHA KATAЛOГA
C ADRU  - YKAЗCTEЛЬ ЗAПИCИ B TEMPO
C IWC   - ИHФ.CЛOBO ЗAПИCИ B TEMPO
C WI    - ИHДEKC ПO БYФEPY ЗAПИCИ
C
 CA,VTM,CATEMP
   ,CALL,NEW/30
   ,XTA,RCAT.KTO-TO
   ,AAX,=:0004.ИЗ CBOИX
  :,UZA,*+1.PEГYЛЯPHO
C           , XTA ,=21 0000.ПOДCOBЫBAЛ
C           , ATX ,AKAT.ФИЗ.БAPAБAH
   ,32 ,.ДЛЯ CBOИX
   ,XTA,RCAT
   ,AAX,=77 7777
   ,AEX,//RDB
  M,VTM,RDBUF
   ,ITS,M
   ,CALL,SAVELIST
 ER,VTM,BAD CT
  R,VJM,READ CAT
C........
C  OПPEДEЛEHИE CBOБOДHOГO
C  MECTA B TEMPO
C
 CA,UTM,-CATEMP
   ,ITA,CA
   ,ATX,LCATT
   ,ATX,LCATN
C???????? ЭTO BPOДE HE HYЖHO
C          M, VTM ,WRBUF
C           , ITS ,M
C           , CALL,SAVELIST
   ,XTA,LDRM
   ,AAX,=777 7740
   ,ATX,ADRU
   ,AAX,=1777
   ,ATI,WI
   ,XTA,ADRU
   ,ASN,64-27.ФOPMИPOB.
   ,AUX,=77 0037.ИHФ.CЛOBA
   ,AEX,//WRB.ЗП.B TEMPO
   ,ATX,IWC
 WI,VZM,LISTSUB
   ,AOX,=:001.ПOДKAЧKA
   ,ATX,IRC.ЛИCTA
   ,DRUM,IRC
C
C======== LIST OF SUBPROGRAMS ========
C
C  ФOPMИPOBAHИE CПИCKA
C  OTCYTCTBYЮЩИX ПPOГPAMM
C
C UN,NUSE - ДЛИHA CПИCKA
C FL RL   - ПPИЗHAK: CПИCOK YЖE B OП
C
 LISTSUB:,BSS,
 WI,UTM,-2000B.CBOБ.WRBUF
 RI,VTM,-1777B
 UN,VTM,
   ,XTA,FLRL
   ,UZA,LISTSUB1
C-------- CПИCOK YЖE ГOTOB
C  ПPOBEPИM TOЛЬKO, HET ЛИ ПEPEЧИCЛEH-
C  HЫX B HEM ПPOГPAMM B TEMPO
  R,VTM,LSS1
 LSS:,BSS,
 RI,XTA,USLISE
   ,UZA,END LIST.ПPИЗH.KOHЦA
 UN,ATX,USLIST
  J,VJM,IF TEMP.OT ДYPAKA
 UN,UTM,1
 LSS1:,BSS,
 RI,VLM,LSS
   ,UJ ,END LIST.BEЛИKOBAT
C-------- ИЗBЛEЧEHИE CПИCKA ИЗ TPП
C  ЗAOДHO ИCKЛЮЧИM ДYБЛИ
C  (TOЛЬKO ДЛЯ YMEHЬШEHИЯ ДЛИHЫ)
 LISTSUB1:,BSS,
   ,XTA,ALF2
   ,ASN,64+30
   ,ATI,I.ДЛИHA TPП
  M,VTM,USLIST
   ,ITS,M
   ,CALL,SAVELIST
   ,XTA,//RLL
   ,ATX,IRC
   ,DRUM,IRC
 CHECSUB:,BSS,
  I,VZM,END LIST.KOHEЦ TPП
  I,UTM,-2
 RI,UTM,1
 RI,XTA,RDBUFE-1
   ,AEX,ERROR4
   ,U1A,CHECSUB1
 RI,XTA,RDBUFE
 UN,ATX,USLIST
C........
C  ПPOBEPKA, ECTЬ ЛИ BXOД B CПИCKE.
 UN,MTJ,M
 UN,UTM,1
 TABL:,BSS,
  M,VZM,CHECSUB1
  M,UTM,-1
  M,XTA,USLIST
 UN,AEX,USLIST-1
   ,U1A,TABL
 UN,UTM,-1
 CHECSUB1:,BSS,
 RI,VLM,CHECSUB
  R,VTM,CHECSUB
   ,UJ ,RNEXP
C-------- CПИCOK BПOЛHE ГOTOB
 END LIST:,BSS,
   ,ITA,UN
   ,ATX,NUSE
 UN,VZM,ESTS.OH ПYCTOЙ
   ,UJ ,GETLIB
C//////// HET ЗAKAЗAHHOЙ БИБЛИOTEKИ
 ABSLIB:,BSS,
  J,VTM,ALNMES
   ,PRINT,IWMES
C
C======== GET LIBRARY ================
C
C  HACTPOЙKA HA HOBYЮ БИБЛИOTEKY
C
C CTN  - CПИCOK OCTABШИXCЯ БИБЛИOTEK
C NLIB - HOMEP TEKYЩEЙ БИБЛИOTEKИ
C IRI  - ИHФ.CЛOBO HAЧAЛA БИБЛИOTEKИ
C
 GETLIB:,BSS,
   ,XTA,CTN
   ,UZA,RETURN
   ,ASN,64+6
   ,ATX,CTN
   ,YTA,
   ,UZA,GETLIB
  S,ATX,
C........ ФOPMИPOB. TEKCTOB ДИAГHOCTИK
   ,AUX,=2H'7''7'
  S,ATX,
   ,AEX,=3H'''''231'
   ,ATX,ALNUMB
   ,ATX,BCLNUM
   ,ATX,BPLNUM
   ,XTA,TGLIBR.*LIBRA
   ,STX,PRBUF
   ,ASN,64+8
   ,AEX,TGLIBR+1
   ,STX,PRBUF+1
   ,ASN,64+30
   ,ATX,IRI
   ,ASN,64+12
   ,ATX,NLIB
   ,A-X,=30.ЛИЧH.БИБЛ.
   ,UZA,RD CCL.-ДA
C-------- ЗAXBAT CИCTEMHOЙ БИБЛИOTEKИ
   ,XTA,
  M,VTM,LENT*
   ,ITS,M
   ,CALL,ДAЙ ЛEHTY
   ,UZA,ABSLIB.HETY
   ,ATX,IRI
C
C======== READ CATALOG LIBRARY =======
C
C      ЧTEHИE KATAЛOГA LIBRARY
C
C FL PL - ПPИЗHAK PERSONAL
C LCTL  - ДЛЯ YПAK.OБCП ДЛИHA ПOЛHOГO
C         KATAЛOГA -1, ДЛЯ ПPOЧИX =0
C LCATL - ДЛИHA OCHOBHOГO KATAЛOГA
C AEXT  - MECTO ДЛЯ CПPABKИ
C LC    - ДЛИHA CПPABKИ
C AEXL  - MECTO ДЛЯ CCЫЛOK
C
 RD CCL:,BSS,
   ,XTA,//RDB
   ,AEX,IRI
   ,ATX,IRI
 CA,VTM,CATLIB
 ER,VTM,BAD CL
  R,VJM,READ CAT
  M,VTM,CATLIB
C........ ДOПPOC C ПPИCTPACTИEM
  M,XTA,
   ,AAX,MPERS
  M,AOX,1
 ER,U1A,
  M,XTA,
   ,ASN,64+24
   ,ATX,LCTL
   ,YTA,
   ,ASN,64+24
   ,A-X,=21 00000
 ER,U1A,
C........
   ,XTA,
  M,ATX,
   ,ATX,FLPL
   ,ATX,HDSL
   ,ATX,FLSR
 CA,MTJ,M
  M,UTM,1
   ,ITA,M
   ,ATX,AEXT
  M,UTM,1-CATLIB
   ,ITA,M
   ,ATX,LCATL
   ,ASN,64+1
   ,A-X,=2
   ,ATI,LC
   ,ARX,AEXT
   ,ATX,AEXL
  J,VJM,RNEXW.ПPOПYCK
 RI,UTM,1.ДATЫ
C-------- ПPOBEPKA PERSONAL
   ,XTA,LCTL
   ,U1A,CATTOLIS.CRELIB
   ,XTA,LCATL
   ,ATX,FLPL
   ,A-X,=1.ДЛИHA KAT.
   ,ASN,64+11.БOЛЬШE 2-X
   ,U1A,CATTOLIS.ЗOH->PERSO
 :CA,UTM,-2
 CA,XTA,1
   ,ASN,64+30
   ,UZA,*-1
   ,AEX,=20 1045
   ,ATX,FLPL
C
C======== CATALOG TO LIST ============
C
C  ПOИCK B  KATAЛOГE БИБЛИOTEKИ, ПPOГ-
C  PAMM ИЗ CПИCKA OTCYTCTBYЮЩИX.
C  HAЙДEHHЫE ИMEHA  OTMEЧAЮTCЯ B KATA-
C  ЛOГE EДИHИЦEЙ B 48 P. ИX ИHФ.CЛOBA.
C  ДЛЯ  OБCП, KPOME ЭTOГO, ФOPMИPYETCЯ
C  CПИCOK  HAЙДEHHЫX ПPOГPAMM C YЧETOM
C  ДOП. ИHФOPMAЦИИ O CCЫЛKAX.
C  B ЭTOT  CПИCOK  CBЯЗЫBAЮTCЯ  COOTB.
C  ЭЛEMEHTЫ CПPABKИ, B MЛAДШИE PAЗPЯДЫ
C  KOTOPЫX  ПOMEЩAETЯ AДPEC CЛEДYЮЩEГO
C  ЭЛEMEHTA B CПИCKE.
C  ПOЭTOMY ПPИ ЧTEHИИ B ПAMЯTЬ COДEPЖ.
C  ЭЛEMEHTOB CПPABKИ CДBИГAETCЯ BЛEBO.
C
C NUSE,UN - ДЛИHA CПИCKA OTCYT. ПPOГP.
C HDSL    - ЗAГOЛOBOK CПИCKA HAЙДEHHЫX
C           COДEPЖИT AДP. ПEPBOГO ЭЛ.
C SE      - AДP. ПOCЛEДHEГO ЭЛ.
C SA      - AДP. TEKYЩEГO ЭЛ.
C FLSR =0 - HET ПPOГP.B KATAЛOГE
C      =1 - ПPOГPAMMЫ БEЗ CCЫЛOK
C      >1 - ECTЬ CCЫЛKИ
C FLPL    - ПPИЗHAK PERSONAL
C
 CATTOLIS:,BSS,
   ,WTC,NUSE
 UN,VTM,.ДЛ.CПИCKA
 UN,MTJ,UI
 SE,VTM,HDSL
 SLIST:,BSS,
 UI,VZM,SLISE.KOH.CПИCKA
 UI,UTM,-1
 UI,XTA,USLIST
   ,ATX,NAME
C-------- ПOИCK B KATAЛOГE
   ,WTC,LCATL
 CA,VTM,CATLIB-2
 SCATL:,BSS,
 CA,UTM,-2
 CA,XTA,
   ,UZA,SLIST.KOHEЦ KAT.
   ,AEX,NAME
   ,U1A,SCATL
C........ ИCKЛЮЧEHИE ИЗ CПИCKA OTCYT.
 UN,UTM,-1.CПACEHИE
 UN,XTA,USLIST.ПOCЛEДHEГO
 UI,ATX,USLIST.BXOДA
 CA,XTA,1
   ,ARX,
   ,UZA,SLIST
C........
C  ЗAПИCЬ ПPИЗH. ДЛЯ HAЙДEHHOГO BXOДA
   ,AOX,=:4
 CA,ATX,1
   ,XTA,FL PL
   ,U1A,SLIST
   ,XTA,FLSR
   ,U1A,REXTE
C--------
C  ЧTEHИE CПPABOK B ПAMЯTЬ
C
   ,XTA,=1
   ,ATX,FLSR
 WA,UTM,2
   ,ITA,WA
   ,AAX,=1777
   ,ATI,I
  I,UTM,-1777B
   ,XTA,LCTL
   ,U1A,REXTP
   ,XTA,=2
  R,VJM,RBEG
 REXTP:,BSS,
   ,ITS,WA
   ,CALL,SAVELIST
 REXTW:,BSS,
 LC,VZM,REXTE
  J,VJM,RNEXW
 LC,UTM,-1
   ,ASN,64-18
 WA,ATX,
 WA,UTM,1
  I,VLM,REXTW
  I,VTM,-1777B
 LP,VLM,REXTP
   ,UJ ,BAD CL
C........ BKЛЮЧEHИE B XBOCT HAЙДEHHЫX
 REXTE:,BSS,
 CA,UTM,-CATLIB.BЫЧИCЛ.
   ,ITA,CA.AДPECA
   ,ASN,64+1.CПPABKИ
   ,ARX,AEXT
 SE,AEX,
 SE,ATX,
   ,ATI,SE
   ,UJ ,SLIST
C-------- OБPAБOTKA CCЫЛOK
C LA - AДP. B CПИCKE CCЫЛOK
C LS - CДBИГ BПPABO
C EC - ЧИCЛO CCЫЛOK
C
 SLISE:,BSS,
   ,ITA,UN.HET ПPOГP.
   ,AEX,NUSE.ИЗ ЭTOЙ
   ,UZA,RET LIB.LIBRARY
   ,ITA,UN
   ,ATX,NUSE
 SA,VTM,HDSL
 SREF:,BSS,
 SA,XTA,
   ,ATI,SA
 SA,VZM,PRILIB.KOHEЦ
 SA,XTA,
   ,ASN,64+33
   ,ATI,EC
 EC,VZM,SREF
   ,YTA,
   ,ASN,64+33
   ,ARX,=3
   ,XTS,FLSR
   ,AEX,=1
   ,U1A,REXLE
C--------
C  ЧTEHИE CCЫЛOK B ПAMЯTЬ
C
   ,ITA,WA
   ,ATX,FLSR
   ,X-A,LCTL
   ,ATI,LC
 LC,UTM,CATLIB+1
   ,XTA,LCTL
 SH,VTM,
   ,U1A,REXLP
 SH,VTM,1
   ,XTA,=3
  R,VJM,RBEG
 REXLP:,BSS,
   ,ITS,WA
   ,CALL,SAVELIST
 REXLW:,BSS,
 LC,VZM,REXLE
  J,VJM,RNEXW
 LC,UTM,-1
 SH,ASN,64
 WA,ATX,
   ,ASN,64+36
   ,UZA,REXLE
 WA,UTM,1
  I,VLM,REXLW
  I,VTM,-1777B
 LP,VLM,REXLP
  S,XTA,
   ,UJ ,BAD CL
C-------- BKЛЮЧEHИE ИMEH ИЗ CПИCKA
C         CCЫЛOK B CПИCOK HAЙДEHHЫX
 REXLE:,BSS,
  S,XTA,-1
   ,ASN,64+2
   ,ARX,AEXL
   ,STI,LA
   ,AAX,=3
  S,ATX,
   ,ASN,64-1
  S,ARX,
   ,ASN,64-2
   ,ATI,LS
 LS,UTM,-48
  R,VTM,SLIEND
C........ ЦИKЛ ПO CПИCKY CCЫЛOK
 SLIN:,BSS,
 EC,UTM,-1
 LA,XTA,
 LS,ASN,64+48
   ,AAX,=7777
   ,ATI,CA
   ,ARX,AEXT
   ,ATX,CEXT
 CA,J+M,CA
 CA,UTM,CATLIB
C........ ECTЬ ЛИ ИMЯ B HAЙДEHHЫX
 CA,XTA,1
   ,AAX,=:4
   ,U1A,SLIEND
C........ ECTЬ ЛИ ИMЯ B TEMPO
 CA,XTA,
  J,VJM,IF TEMP
C........ BKЛЮЧ. B XBOCT HAЙДEHHЫX
   ,XTA,CEXT
 SE,AEX,
 SE,ATX,
   ,ATI,SE
   ,XTA,=:4
 CA,AOX,1
 CA,ATX,1
 SLIEND:,BSS,
 EC,VZM,SREF
 LS,UTM,12
 LS,V1M,SLIN
 LS,VTM,-48
 LA,VLM,SLIN
C
C : : : : : : : : : : : : : : : : : :
C : : : : : : : : : : : : : : : : : :
C
C  ПEЧATЬ CПИCKA HAЙДEHHЫX ПPOГPAMM
C
 PRILIB:,BSS,
   ,XTA,ALFA
   ,AAX,=:4
   ,U1A,WRITLIBR
   ,ARX,*REGIM//
  :,UZA,*+1
   ,UTC,-5
 LC,VTM,-4
 LC,MTJ,I
  I,UTM,1
 WA,VTM,PRBUF+2
   ,WTC,LCATL
 CA,VTM,CATLIB-2
 PRIN:,BSS,
 CA,UTM,-2
 CA,XTA,
   ,UZA,PRIE
 CA,XTA,1
   ,AAX,=:4
   ,UZA,PRIN
 CA,XTS,
   ,ITS,WA
 WA,UTM,2
   ,CALL,PT6/G
   ,NTR,3
  I,VLM,PRIN
 LC,MTJ,I
   ,PRINT,IWBUF
 WA,VTM,PRBUF
   ,UJ ,PRIN
 PRIE:,BSS,
 WA,MTJ,M
  M,UTM,-PRBUF
  M,VZM,WRITLIBR
   ,PRINT,IWBUF
C
C=====================================
C======== WRITE LIBRARY ==============
C
C  ПEPEПИCЬ HAЙДEHHЫX ПPOГPAMM
C  ИЗ LIBRARY BO BPEMEHHYЮ БИБЛИOTEKY
C
 WRITLIBR:,XTA,.
   ,ATX,FLBP
C
C  ПPOCMOTP KATAЛOГA C KOHЦA, ЧTO
C  COOTBETCTBYET ПOPЯДKY PACПOЛOЖEHИЯ
C  ПPOГPAMM B LIBRARY
C
   ,WTC,LCATL
 CA,VTM,CATLIB-2
 TRANSP:,BSS,
 EC,VTM,1
  M,VTM,
 TRANSE:,BSS,
 CA,UTM,-2
 CA,XTA,
   ,UZA,TREND
 EC,UTM,-1
 CA,XTA,1
   ,ARX,
  :,U1A,*+1
  M,UTM,1
   ,ASN,64+30
   ,AAX,=3777
   ,UZA,TRANSE
  M,VZM,TRANSP.HE HYЖHA
C--------
C  OПPEДEЛEHИE MECTA ПPOГPAMMЫ
C
   ,A-X,=1040.MБ 21.00
C........ HAXOДИM HAЧAЛO ПPOГP.B ЛИCTE
 CA,XTS,1
   ,ASN,64+36
   ,AAX,=1740
   ,STI,RI
  R,VJM,RBEGP
   ,XTA,=42.=3+37B
   ,ATX,LDRU.ДЛИHA CM
C--------
C  PACПAKOBKA 1-ГO CЛOBA CTPYKTYPЫ
C
  M,VTM,-3
 RI,XTA,RDBUFE+1
 STR1:,BSS,
  S,ATX,
   ,AAX,=7777.PEЗEPB1
   ,ARX,LDRU.PEЗEPB2
   ,STX,LDRU.OБOЗHAЧEH.
   ,ASN,64+12.ЗAГOЛOBOK
  M,VLM,STR1
C--------
C  PACПAKOBKA 2-ГO CЛOBA CTPYKTYPЫ
C
  M,VTM,-2
 RI,XTA,RDBUFE+2
 STR2:,BSS,
  S,ATX,
   ,AAX,=77777.SET
   ,ARX,LDRU.DATA
   ,STX,LDRU.ДЛ.ИДEHT.
   ,ASN,64+15
  M,VLM,STR2
C--------
C  PACПAKOBKA 3-ГO CЛOBA CTPYKTYPЫ
C
 RI,XTA,RDBUFE+3
   ,AAX,=77777.KOMAHДЫ
 RI,XTS,RDBUFE+3
   ,ASN,64+30.KOHCTAHTЫ
  S,ARX,
 RI,XTS,RDBUFE+3
   ,ASN,64+15
   ,AAX,=77777.BSS
  S,ARX,-1
   ,ATX,LMEM
C........
C  KOHTPOЛЬ ДЛИHЫ ПPOГPAMMЫ
C
 CA,XTA,1
   ,ASN,64+15
   ,AAX,=77777
   ,AEX,LMEM
C-------------------------------------
C   BPEMEHHO, HEKAЯ ЛИKBИДAЦИЯ ЗAЛEП B
C   KATAЛOГE  LIBRARY, BOЗHИKAЮЩИX ПPИ
C   PAБOTE C OЧEHЬ CTAPЫMИ ЛEHTAMИ.
C-------------------------------------
   ,AAX,=7777.BPEMEHHO !
C--- KOHEЦ BЫHYЖHEHHЫX ПPABOK --------
   ,U1A,BAD PROG
C--------
C  ЗAПИCЬ ИHФ. CЛOBA ГЛABHOГO BXOДA
C
   ,XTA,ADRU
   ,ASN,64-16
   ,AEX,ADRU
   ,ASN,64-5
   ,AAX,=177 7770 0000
   ,AEX,LMEM
   ,ASN,64-15
   ,AEX,=:2
   ,STX,POINT
   ,ARX,LDRU
   ,ASN,64+5
   ,ATI,I.ЧИCЛO PEK.
   ,ASN,64-5
   ,ARX,ADRU
   ,ATX,ADRU
   ,X-A,=30 00000
   ,U1A,LON TL
 CA,MTJ,EA
C........
C  ДЛЯ CБOPA CTATИCTИKИ ПO
C  ИCПOЛЬЗOBAHИЮ БИБЛИOTEЧHЫX ПPOГPAMM
C  П/П  "STATSUM" ЗAПИCЫBAET B DAYFILE
C  HOMEP  PASS'A,  ИMЯ ГOЛOBHOГO BXOДA
C  ПPOГPAMMЫ И HOMEP OБCП.
C
 CA,XTA,
   ,CALL,STATSUM
C--------
C  ЗAПИCЬ BXOДOB B KATAЛOГ.
C
 WRCHECK:,BSS,
 EA,XTA,1
   ,ARX,
   ,UZA,WRENTRY.ПPOBEPEH
C........
C  ECTЬ ЛИ BXOД B TEMPORARY
C
 EA,XTA,
  R,VTM,WRENTR2.B TEMPO
  J,VJM,IF TEMP
C........
C  XBATAET ЛИ MECTA B KATAЛOГE
C
 WRENTRY:,BSS,.
   ,XTA,LCATN
   ,ARX,=2
   ,ATX,LCATN
   ,ATI,WA
   ,ASN,64+13
   ,U1A,LON CT
C........
C  XBATAET ЛИ MECTA B ЛИCTE
C
 WA,UTM,CATEMP
   ,ITA,WA
   ,AAX,=1777
   ,U1A,WRENTR1.ECTЬ MECTO
C........
C  ЗAXBAT CЛEДYЮЩEГO ЛИCTA KATAЛOГA
C
   ,ITS,WA
   ,CALL,SAVELIST
 WRENTR1:,BSS,
C........
C  ЗAПИCЬ BXOДA
C
 EA,XTA,
 WA,ATX,-2
 EA,XTA,1
   ,AAX,=77777
   ,AEX,POINT
 WA,ATX,-1
   ,XTA,
   ,ATX,POINT
 WA,ATX,
   ,XTA,FULW
 WA,ATX,1
 WRENTR2:,BSS,
 EA,UTM,2
 EC,VLM,WRCHECK
C--------
C  ПEPEПИCЬ CTAHДAPTHOГO MACCИBA
C
 ПEPEПИCЬ:,BSS,
  I,UTM,-1
 LC,VTM,-37B
 WI,V1M,RD WR
  R,VJM,WNEXP.CБP.ЛИCTA
 WI,VTM,-2000B
C........
C  ПEPEПИCЬ PEKOPДA
C
 RD WR:,BSS,
 RI,UTM,1
 RI,XTA,RDBUFE
 WI,UTM,1
 WI,ATX,WRBUFE
 LC,VLM,RD WR
  I,VZM,TRANSP.KOHEЦ CM
 RI,V1M,ПEPEПИCЬ
  R,VJM,RNEXP
 RI,VTM,-2000B
   ,UJ ,ПEPEПИCЬ
C////////
C  OШИБKA: ИCПOPЧEHA ПPOГPAMMA
C
 BAD PROG:,BSS,
   ,XTA,FLBP
   ,U1A,BPRI
  J,VTM,BPLMES
   ,PRINT,IWMES
   ,ITA,J
   ,ATX,FLBP
 BPRI:,BSS,.STACK YЖE
 CA,XTA,.ПPOДBИHYT
  M,VTM,20
   ,ITS,M
   ,CALL,PT6/G
   ,NTR,3
   ,UJ ,TRANSP
C--------
C  KOHEЦ PAБOTЫ WRITLIBR
C
 TREND:,BSS,
   ,XTA,FLBP
   ,U1A,ERR RET
C
C======== RETURN LIBRARY =============
C
C  OTKAЗ OT TEKYЩEЙ БИБЛИOTEKИ
C
 RET LIB:,BSS,
   ,XTA,NLIB
   ,A-X,=30.NLIB > 27B
   ,UZA,RET LIB1
  M,VTM,LENT*
   ,ITS,M
   ,CALL,HA ЛEHTY.OTK.OT БOБ
 RET LIB1:,BSS,
   ,XTA,NUSE.KOH.CПИCKA
   ,U1A,GET LIB
C
C======== RETURN =====================
C
C  БЛOK BOЗBPATA
C
 RETURN:,BSS,.
 WI,VTM,-1776B
C........ CБPOC БYФEPA ЗAПИCИ
   ,DRUM,IWC
C........ CБPOC KATAЛOГA TEMPO
   ,XTA,RCAT
   ,AAX,=77 7777
   ,AOX,//WRB
   ,ATX,IWC
 CA,VTM,CATEMP+2
   ,XTA,LCATN
   ,ATI,LC
   ,XTA,ADRU
   ,ATX,LDRM
   ,ATX,WRBUF
   ,XTA,
   ,ATX,WRBUF+1
C
C  ECЛИ 19PP. *REGIM// = 1,TO
C  ПPOГPAMMЫ ИЗ LIBRARY ДOЛЖHЫ
C  ПOПACTЬ B PERSONAL. ДЛЯ ЭTOГO
C  ИX BXOДЫ HYЖHO ЗAПИCЫBATЬ B
C  HAЧAЛO KATAЛOГA.
C
   ,XTA,*REGIM//
   ,AAX,=100 0000
  J,VTM,TO END
   ,UZA,WRIT CAT
   ,XTA,LCATT
   ,ATI,CA
 CA,UTM,CATEMP
   ,X-A,LCATN
   ,ATI,LC
  J,VJM,WRIT CAT
 CA,VTM,CATEMP+2
   ,WTC,LCATT
 LC,VTM,-2
  J,VJM,WRIT CAT
   ,WTC,LCATN
 CA,VTM,CATEMP
 LC,VTM,2
  J,VJM,WRIT CAT
 TO END:,BSS,
   ,DRUM,IWC
C--------
C  BOCCTAHOBЛEHИE ПAMЯTИ
C
 ESTS:,CALL,END STAT.CБPOC CTATИCTИKИ
 ,CALL,TSILEVAS.BOCCT. ЛИCTOB
   ,CALL,OLD/30.BOCCTAHOBЛEHИE
   ,CALL,REFUSE
   ,NTR,2
  M,VTM,-J.BOCCTAHOB.
 :M,STI,J.ИHДEKC-
  M,VLM,*.PEГИCTPOB
   ,ATI,S
   ,DRUM,RLOAD
  M,VTM,7.#0
   ,XTA,NUSE
  :,U1A,*+1
   ,UTC,=7777.#0
   ,XTA,
  J,UJ ,1
C
C/////////////////////////////////////
C
C  PEAKЦИЯ HA OШИБKИ ПPИ PAБOTE
C
 BAD CL:,BSS,
  J,VTM,BCLMES
   ,PRINT,IWMES
   ,UJ ,RET LIB
C//////// ФATAЛЬHЫE OШИБKИ
 BAD CT:,BSS,
   ,UTC,BCTMES-LCTMES
 LON CT:,BSS,
   ,UTC,LCTMES-LTLMES
 LON TL:,BSS,
  J,VTM,LTLMES
   ,PRINT,IWMES
 ERR RET:,BSS,
  J,VTM,OVFLJUMP
   ,UJ ,TSILEVAS
C
C.....................................
C
C  ЧTEHИE KATAЛOГA БИБЛИOTEKИ
C
C LP - CЧ. ЛИCTOB KATAЛOГA (ДO BOCЬMИ)
C
 READ CAT:,BSS,
 LP,VTM,-7
 RI,VTM,-1777B
 RCATP:,BSS,
   ,ITS,CA
   ,CALL,SAVELIST
   ,ATX,IRC
   ,TAPE,IRC
 RCATW:,BSS,
 RI,UTM,1
 RI,XTA,RDBUFE-1
 CA,ATX,
   ,UZA,RCATE
 RI,XTA,RDBUFE
   ,AAX,MCATW
 CA,ATX,1
 CA,UTM,2
 RI,VLM,RCATW
 RI,VTM,-1777B
   ,XTA,=1
   ,ARX,IRC
 LP,VLM,RCATP
 ER,UJ ,
 RCATE:,BSS,
   ,XTA,Z48
   ,ATX,MCATW
   ,XTA,FULW
 CA,ATX,1
 RI,AEX,RDBUFE
 ER,U1A,
 CA,MTJ,WA
  R,UJ ,
C.....................................
C
C  ЗAПИCЬ KATAЛOГA БИБЛИOTEKИ
C
 WCATW:,BSS,
 WI,VLM,*+1
  R,VJM,WNEXP
 CA,XTA,
 WI,ATX,WRBUFE
 CA,UTM,1
 LC,UTM,-1
 WRIT CAT:,BSS,
 LC,V1M,WCATW
  J,UJ ,
C.....................................
C
C  ЧTEHИE ЗAДAHHOЙ ЗOHЫ B БYФEP
C
 RBEG:,BSS,
 RI,VTM,
 RBEGP:,BSS,
   ,ARX,IRI
   ,AEX,IRC
   ,UZA,RSKIP
   ,AEX,IRC
   ,ATX,IRC
   ,TAPE,IRC
 RSKIP:,BSS,
 RI,UTM,-2000B
  R,UJ ,
C.....................................
C
C  ЧTEHИE OЧEPEДHOГO CЛOBA ИЗ БYФEPA
C
 RNEXW:,BSS,
 RI,VLM,REND
  R,VJM,RNEXP
 REND:,BSS,
 RI,XTA,RDBUFE
  J,UJ ,
C.....................................
C
C  ЧTEHИE OЧEPEДHOЙ ЗOHЫ B БYФEP
C
 RNEXP:,BSS,
   ,XTA,=1
   ,ARX,IRC
   ,ATX,IRC
   ,TAPE,IRC
 RI,VTM,-1777B
  R,UJ ,
C.....................................
C
C  ЗAПИCЬ БYФEPA HA OЧEPEДHOЙ TPAKT
C
 WNEXP:,BSS,
 WI,VTM,-1777B
   ,DRUM,IWC
   ,XTA,IWC
   ,ARX,=7741
   ,AAX,=7777 7777 7777 0037
   ,ATX,IWC
  R,UJ ,
C.....................................
C
C  ПPOBEPKA: ECTЬ ЛИ ИMЯ B KATAЛOГE
C  BPEMEHHOЙ БИБЛИOTEKИ; ИMЯ ПOДAETCЯ
C  HA CYMMATOPE. ECЛИ ECTЬ
C  B KATAЛOГE, TO BЫXOД ПO  "R",
C  ИHAЧE ПO  "J"
C
 IF TEMP:,BSS,
   ,ATX,NAME
  M,VTM,CATEMP
 IFT1:,BSS,
  M,UTM,2
  M,XTA,
  J,UZA,
   ,AEX,NAME
   ,U1A,IFT1
  R,UJ ,
C
C:::::::::::::::::::::::::::::::::::::
C:::::::::::::::::::::::::::::::::::::
C
C  ИHФOPMAЦИOHHЫE CЛOBA ПEЧATИ
C
 IWBUF:,Z00,PRBUF
 WA,Z00,-1
   ,006,
  8,   ,
 IWMES:J,   ,
  J,   ,
   ,015,
  8,   ,
C
C:::::::::::::::::::::::::::::::::::::
C
C  ЗAГOTOBKИ ИHФ. CЛOB OБMEHA
C
 //1:,P/P,(RDBUF)16
 //2:,P/P,(WRBUF)16
 //RDB:,010,//1
   ,   ,
 //RLL:,010,//1
   ,020,
 //WRB:,   ,//2
   ,   ,
C
C:::::::::::::::::::::::::::::::::::::
C
C  K O H C T A H T Ы
C
 FULW :,OCT,7777 7777 7777 7777
 Z48  :,OCT,3777 7777 7777 7777
 MPERS:,OCT,7776 0000 7000 0037
 MCATW:,OCT,7777 7777 7777 7777.!PAБ.ЯЧ!
 ERROR4:,TEXT,8H ERROR '4'
 BCTMES:,GOST,17HИCПOPЧEH KATAЛOГ'231'
 LCTMES:,GOST,19HПEPEПOЛHEH KATAЛOГ'231'
 LTLMES:,GOST,23HПEPEПOЛHEHA БИБЛИOTEKA'231'
 ALNMES:,GOST,24HB HAШEM BЦ HET  LIBRARY
 ALNUMB:,OCT,
 BCLMES:,GOST,30HИCПOPЧEH KATAЛOГ БИБЛИOTEKИ -
 BCLNUM:,OCT,
 BPLMES:,GOST,36HИCПOPЧEHЫ ПPOГPAMMЫ ИЗ БИБЛИOTEKИ -
 BPLNUM:,OCT,
 TGLIBR:,GOST,12H*LIBRA:00 =
C
C=====================================
C
C  PAБOЧИE  ЯЧEЙKИ
C
 CTN :,BSS,1.ЗAKAЗAHHЫE LIBRARY
 NUSE:,BSS,1.KOЛИЧ.OTCYT.П/П
 ADRU:,BSS,1.HAЧ.П/П B TEMPO
 LCATT:,BSS,1.ДЛИHA KAT.TEMPO
 LCATN:,BSS,1.HOBAЯ ДЛИHA KAT.
 LCATL:,BSS,1.ДЛИHA KAT.LIBRARY
 IRI:,BSS,1.IW HAЧ.LIBRARY
 IRC:,BSS,1.IW TEK.ЧTEHИЯ
 IWC:,BSS,1.IW ЗП.B TEMPO
 LENT*:,BSS,2.PAБ.ЯЧ.ЗAXBATA БOБИHЫ
 PRBUF:,BSS,20.БYФEP ПEЧATИ
 ,END,LOADLIBR
 LOAD STL:,NAME,
C********* ДAHИЛOB Ю.Л 19/10/83 ЛГЭM
C*
C*   ДЛЯ OTЛAДKИ И/ИЛИ OПЫTHOЙ ЭKCПЛYATAЦИИ
C*      CTATИKO - ДИHAMИЧECKOЙ ЗAГPYЗKИ
C*   ЭTA П/П ЗAПИШET COБPAHHЫЙ HOBЫЙ
C*   CTAT.ЗAГPYЗЧИK HA MAT.MБ 00.37.03,
C*   П/П ПEЧATИ ФP.TPП  -  HA 00.37.02
C*   И ПEPEHACTPOИT KOE-KAKИE LC...
C*
C*   OБP.: *CALL LOADSTL [ :LOADLIST ]
C*
C*   OБPAЩEHИE C ПAPAMETPOM LOADLIST
C*   OЗHAЧAET ЗAKAЗ ПEЧATИ ПOЛHOГO ФPAГMEHTA
C*   TAБЛИЦЫ ЗAГPYЗKИ ДЛЯ KAЖДOГO PAЗДEЛA
C*   (T.E. TAK, KAK ЭTO B ДИHAMИKE), ПPИ
C*   ЭTOM '*NO LO' ДEЙCTBYET ПO-ПPEЖHEMY.
C*
C*******************************************
 INFLOAD*:LC,BLOCK,(1),INFLOA
 RM*:,LC,5
 LHEAP*:,LC,1
 BEGSTL:,SC,1
 STATICLO:,SUBP,
 ESTLO:,LC,
 LSTLO:,EQU,ESTLO-STATICLO
 FREE:,EQU,377B-LSTLO
 ДOBECOK:,LC,FREE
 PRINPART:,SUBP,
C===
 13,MTJ,1
 ,ITS,
 10,VTM,
 ,CALL,PARAMT*
 11,VZM,NOMXLIST
 10,VTM,3
 9,VTM,
 ,CALL,PARAMT*
 ,AEX,LOADLIST
 ,U1A,NOMXLIST
C.....   ПPABИM ПPOГPAMMY ПEЧATИ B STATICLO
 13,VTM,STATICLO+377B
 12,VTM,STATICLO
 ,NTR,3
 SRCPOINT:,BSS,.ПOИCK 'PRINT'
 13,UTM,-1
 13,XTA,.ПOИCK C KOHЦA
 ,AEX,=:2510 7770.5,XTA,-8
 ,ASN,64+24
 ,U1A,SRCPOINT
C.....   HAШЛИ MECTO, BПИCЫBAEM BЫЗЫBAЛKY
 ,ITA,12
 ,ITS,13
 15,A-X,.OTH.AДP.'PRINT'
 ,ARX,=2.AДP.IWR PRINPART
 ,AOX,CALL
 13,CTX,
 ,XTA,CALL+1
 13,CTX,1
 ,XTA,CALL+2
 13,CTX,2
C.....   COБИPAEM IW ЗAПИCИ PRINPART И ПИШEM
 14,VTM,PRINPART
 ,ITA,14
 ,ASN,64-33
 ,AUX,CU1
 ,AOX,W PRPART
 ,ATX,W PRPART
 ,*70,W PRPART
 NOMXLIST:,BSS,.
C.....   OБЩAЯ ЧACTЬ OБOИX PEЖИMOB
C
C-- ФOPMИPOBAHИE ИHФ.CЛOBA ЗAПИCИ ЗAГPYЗЧИKA
 14,VTM,BEGSTL
 ,ITA,14
 ,ASN,64-33
 ,AUX,CU1
 ,AOX,WD00/37
 ,ATX,WD00/37
 ,*70,WD00/37
C-- ФOPMИPOBAHИE ИHФ.CЛOBA ЧTEHИЯ ЗAГPYЗЧИKA
 ,XTA,RM*+2
 ,ASN,64-33
 ,AUX,CU1
 ,AOX,RSTLO
 ,ATX,INFLOA
C--- ПEЧATЬ O PEЗYЛЬTATAX PAБOTЫ
 14,VTM,FREE
 ,ITA,14
 ,ASN,64-39
 ,AUX,CU2
 ,AOX,CG
 ,ATX,CBO
 ,PRINT,READY
C--- ФИKCAЦИЯ MБ 00
 ,XTA,=:4
 ,AOX,LHEAP*
 ,STX,LHEAP*
 1,UJ,
C
 CALL:,BSS,
C=====   BЫЗЫBAЛKA PRINPART ДЛЯ STATICLO
C                                         I
C   EE TEKCT B STATICLO (KOГДA-HИБYДЬ)    I
C   БYДET BЫГЛЯДETЬ ПPИMEPHO TAK:         I
C                                         I
C         R, MTJ ,13                      I
C          , *70 ,IR PRPART               I
C        AP, XTA ,-8      .ИMЯ PAЗДEЛA    I
C          , UJ  ,SYSP                    I
C IRPRPART: 8,010,3700B                   I
C            ,   ,237B                    I
C==========================================
 4,MTJ,13
 1,*70,.AДPEC BЫЧИCЛЯEM
 5,XTA,-8
 ,UJ,76000B
 :8,010,3700B
   ,   , 237B
 READY:,Z00,TREADY
       ,Z00,TREADY
 ,001,
 8,,
 TREADY:,BSS,
 ,GOST,H/ЭKCПEP.CTAT./
 ,CONT,H/ЗAГPYЗЧИK HA /
 ,CONT,H/00.37.03./
 ,CONT,H/ FREE :/
 CBO:,OCT,
 ,GOST,1H'231'
 CU2:,GOST,6H000777
 CG :,GOST,6H   000
 CU1:,OCT,0000 3703
 LOADLIST:,TEXT,8HLOADLIST
 WD00/37:,OCT,4000 0000 0000 0337
 W PRPART:,OCT,4000 0000 0000 0237
 RSTLO:8,010,
 ,,337B
 ,END,LOAD STL
      LTX        :,NAME,
      *A*        :,LC,  125B
      *J*        :,LC,  1
      *M*        :,LC,  1
      FT*571     :,SUBP,
      FT*003     :,SUBP,
      PAS        :,SUBP,
      EDI        :,SUBP,
      CSP        :,SUBP,
      CSF        :,SUBP,
      PAK        :,SUBP,
      LINE       :,SUBP,
            14 ,  VTM,   *00001
                 , UJ,   *00373
 *00001    :     ,UTC,      *M*
                 ,XTA,
                 ,NTR,  3
             7 ,  A-X,  11
                 ,NTR,  22B
                 ,UIA,   *00005
                 , UJ,   *00006
                 ,UTC,
 *00005    :     , UJ,   *00016
                 ,UTC,
 *00006    : 7 ,  XTA,  11
                 ,UTC,      *M*
                 ,ATX,
                 ,NTR,  3
             7 ,  XTA,  35B
             7 ,  A-X,  11
                 ,NTR,  22B
                 ,UZA,   *00013
                 , UJ,   *00016
                 ,UTC,
 *00013    : 7 ,  XTA,  12
                 ,UTC,      *M*
                 ,ATX,
                 ,NTR,  3
                 ,NTR,  22B
                 ,UTC,
 *00016    : 7 ,  XTA,  3
                 ,UTC,      *J*
                 ,ATX,
                 ,NTR,  3
             7 ,  XTA,  32B
             7 ,  ATX,  31B
             7 ,  XTA,  2
             7 ,  ATX,  35B
             7 ,  XTA,  23B
                 ,WTC,   BSS+ 0010B
                 ,ATX,  1
            14 ,  VTM,   *00413
                 ,ITA,  14
                 ,NTR,  22B
            13 ,  VJM,      LINE
             7 ,  ATX,  32B
                 ,NTR,  3
             7 ,  ATX,  37B
             7 ,  XTA,  2
                 ,ITS,
                 ,UTC,      *A*
                 ,XTA,
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00034
                 , UJ,   *00035
                 ,UTC,
 *00034    :     , UJ,   *00107
                 ,UTC,
 *00035    : 7 ,  XTA,
                 ,ITS,
             7 ,  XTA,  32B
            15 ,  AEX,
                 ,UZA,   *00040
                 , UJ,   *00041
 *00040    :     , UJ,   *00076
                 ,UTC,
 *00041    : 7 ,  XTA,  24B
                 ,WTC,   BSS+ 0010B
                 ,ATX,  1
             7 ,  XTA,
                 ,ITS,
                 ,UTC,      *A*
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00046
                 , UJ,   *00047
 *00046    :     , UJ,   *00073
                 ,UTC,
 *00047    : 7 ,  XTA,  21B
                 ,ITS,
                 ,UTC,      *A*
                 ,XTA,
            15 ,  AEX,
                 ,UIA,   *00053
                 , UJ,   *00054
                 ,UTC,
 *00053    :     , UJ,   *00136
                 ,UTC,
 *00054    :14 ,  VTM,   BSS+ 0006B
                 ,ITS,  14
L           14 ,  VTM,      *A*    +1
                 ,ITS,  14
            14 ,  VTM,   *00416
                 ,ITS,  14
            13 ,  VJM,      PAK
                 ,NTR,  3
                 ,NTR,  22B
             7 ,  XTA,  27B
                 ,ITS,
             7 ,  XTA,  36B
            15 ,  AEX,
                 ,UIA,   *00064
                 , UJ,   *00065
 *00064    :     , UJ,   *00353
                 ,UTC,
 *00065    : 7 ,  XTA,  25B
                 ,WTC,   BSS+ 0010B
                 ,ATX,  1
            14 ,  VTM,   *00411
                 ,ITA,  14
            13 ,  VJM,      LINE
             7 ,  ATX,  32B
                 ,NTR,  3
             7 ,  XTA,  2
             7 ,  ATX,  37B
                 ,NTR,  22B
                 ,UTC,
 *00073    : 7 ,  XTA,  10
                 ,UTC,      *J*
                 ,ATX,
                 ,NTR,  3
                 ,NTR,  22B
                 ,UTC,
 *00076    : 7 ,  XTA,  4
             7 ,  ATX,  33B
                 ,NTR,  3
                 ,NTR,  22B
 *00100    : 7 ,  XTA,  23B
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
                 ,WTC,   BSS+ 0010B
             1 ,  ATX,  77777B
             7 ,  XTA,  33B
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  33B
             7 ,  X-A,  10
                 ,NTR,  22B
                 ,UZA,   *00100
                 , UJ,   *00401
                 ,UTC,
 *00107    : 7 ,  XTA,  2
                 ,ITS,
             7 ,  XTA,  31B
            15 ,  AEX,
                 ,UIA,   *00112
                 , UJ,   *00113
 *00112    :     , UJ,   *00076
                 ,UTC,
 *00113    :14 ,  VTM,   *00413
                 ,ITA,  14
            13 ,  VJM,      LINE
             7 ,  ATX,  32B
                 ,NTR,  3
             7 ,  XTA,
                 ,ITS,
             7 ,  XTA,  32B
                 ,NTR,  22B
            15 ,  AEX,
                 ,UZA,   *00122
                 , UJ,   *00123
                 ,UTC,
 *00122    :     , UJ,   *00076
                 ,UTC,
 *00123    :14 ,  VTM,   *00405
                 ,ITS,  14
            13 ,  VJM,  FT*571
            13 ,  VJM,  FT*003
             7 ,  XTA,  15
             7 ,  ATX,  37B
                 ,NTR,  3
            14 ,  VTM,   *00411
                 ,ITA,  14
                 ,NTR,  22B
            13 ,  VJM,      LINE
             7 ,  ATX,  32B
                 ,NTR,  3
             7 ,  XTA,  20B
                 ,WTC,   BSS+ 0010B
                 ,ATX,  1
                 ,NTR,  22B
                 , UJ,   *00073
                 ,UTC,
 *00136    :14 ,  VTM,   BSS+ 0006B
                 ,ITS,  14
            14 ,  VTM,      *A*
                 ,ITS,  14
            14 ,  VTM,   *00416
                 ,ITS,  14
            13 ,  VJM,      PAK
                 ,NTR,  3
                 ,NTR,  22B
             7 ,  XTA,  23B
                 ,ITS,
             7 ,  XTA,  36B
            15 ,  AEX,
                 ,UIA,   *00146
                 , UJ,   *00147
 *00146    :     , UJ,   *00174
                 ,UTC,
 *00147    :14 ,  VTM,   BSS+ 0011B
                 ,ITS,  14
            13 ,  VJM,      CSF
            14 ,  VTM,   BSS+ 0006B
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0011B
                 ,ITS,  14
            14 ,  VTM,   *00415
                 ,ITS,  14
            13 ,  VJM,      PAK
                 ,NTR,  3
                 ,NTR,  22B
             7 ,  XTA,  2
             7 ,  ATX,  35B
                 ,NTR,  3
                 ,NTR,  22B
 *00160    :     ,WTC,   BSS+ 0005B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0064B
                 ,XTA,
                 ,ITS,
             7 ,  XTA,  36B
            15 ,  AEX,
                 ,UZA,   *00165
                 , UJ,   *00166
                 ,UTC,
 *00165    :     , UJ,   *00235
                 ,UTC,
 *00166    : 7 ,  XTA,  35B
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  35B
             7 ,  X-A,  7
                 ,NTR,  22B
                 ,UZA,   *00160
             7 ,  XTA,  3
             7 ,  ATX,  34B
                 ,NTR,  3
                 ,NTR,  22B
                 ,UTC,
 *00174    : 7 ,  XTA,  9
                 ,ITS,
                 ,UTC,      *M*
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00200
                 , UJ,   *00201
                 ,UTC,
 *00200    :     , UJ,   *00260
                 ,UTC,
 *00201    : 7 ,  XTA,  130B
                 ,ITS,
             7 ,  XTA,  36B
            15 ,  AEX,
                 ,UZA,   *00204
                 , UJ,   *00205
 *00204    :     , UJ,   *00353
                 ,UTC,
 *00205    : 7 ,  XTA,  34B
             7 ,  ATX,  33B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00221
                 ,UTC,
 *00210    : 7 ,  XTA,  26B
                 ,ITS,
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0010B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00215
                 , UJ,   *00216
                 ,UTC,
 *00215    :     , UJ,   *00223
                 ,UTC,
 *00216    : 7 ,  XTA,  33B
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  33B
                 ,NTR,  22B
                 ,UTC,
 *00221    : 7 ,  X-A,  13
                 ,UZA,   *00210
                 , UJ,   *00260
                 ,UTC,
 *00223    : 7 ,  XTA,  33B
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  34B
            14 ,  VTM,   BSS+ 0006B
                 ,ITS,  14
                 ,WTC,   BSS+ 0004B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00415
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      PAK
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00201
                 ,UTC,
 *00235    : 7 ,  XTA,  35B
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  5
                 ,NTR,  22B
                 ,UZA,   *00241
                 , UJ,   *00242
                 ,UTC,
 *00241    :     , UJ,   *00353
                 ,UTC,
 *00242    :     ,WTC,   BSS+ 0005B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0103B
                 ,XTA,
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  34B
            14 ,  VTM,   BSS+ 0006B
                 ,ITS,  14
                 ,WTC,   BSS+ 0004B
             2 ,  VTM,
             2 ,  UTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00415
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      PAK
                 ,NTR,  3
                 ,NTR,  22B
             7 ,  XTA,  115B
                 ,ITS,
             7 ,  XTA,  36B
            15 ,  AEX,
                 ,UZA,   *00257
                 , UJ,   *00260
 *00257    :     , UJ,   *00353
                 ,UTC,
 *00260    : 7 ,  XTA,  23B
                 ,ITS,
                 ,UTC,      *A*
                 ,XTA,
            15 ,  AEX,
                 ,UIA,   *00264
                 , UJ,   *00265
                 ,UTC,
 *00264    :     , UJ,   *00345
                 ,UTC,
 *00265    :14 ,  VTM,   BSS+ 0011B
                 ,ITS,  14
            13 ,  VJM,      CSP
             7 ,  XTA,  2
             7 ,  ATX,  33B
                 ,NTR,  3
                 ,NTR,  22B
 *00271    : 7 ,  XTA,  22B
                 ,ITS,
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0010B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00276
                 , UJ,   *00277
                 ,UTC,
 *00276    :     , UJ,   *00303
                 ,UTC,
 *00277    : 7 ,  XTA,  33B
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  33B
             7 ,  X-A,  10
                 ,NTR,  22B
                 ,UZA,   *00271
                 , UJ,   *00345
 *00303    :14 ,  VTM,   BSS+ 0006B
                 ,ITS,  14
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0011B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00414
                 ,ITS,  14
            13 ,  VJM,      PAK
                 ,NTR,  3
                 ,NTR,  22B
             7 ,  XTA,  8
             7 ,  ATX,  35B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00325
                 ,UTC,
 *00314    :     ,WTC,   BSS+ 0005B
             1 ,  VTM,
             1 ,  UTC,   BSS+ 0064B
                 ,XTA,
                 ,ITS,
             7 ,  XTA,  36B
            15 ,  AEX,
                 ,UZA,   *00321
                 , UJ,   *00322
                 ,UTC,
 *00321    :     , UJ,   *00327
                 ,UTC,
 *00322    : 7 ,  XTA,  35B
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  35B
                 ,NTR,  22B
                 ,UTC,
 *00325    :     ,UTC,      *M*
                 ,X-A,
                 ,UZA,   *00314
                 , UJ,   *00345
 *00327    : 7 ,  XTA,  9
                 ,ITS,
             7 ,  XTA,  35B
            15 ,  AEX,
                 ,UIA,   *00332
                 , UJ,   *00333
 *00332    :     , UJ,   *00352
                 ,UTC,
 *00333    :     ,UTC,      *M*
                 ,XTA,
                 ,NTR,  3
             7 ,  A-X,  11
                 ,NTR,  22B
                 ,UZA,   *00337
                 , UJ,   *00340
                 ,UTC,
 *00337    :     , UJ,   *00352
                 ,UTC,
 *00340    : 7 ,  XTA,  33B
                 ,NTR,  3
                 ,X-A,
             7 ,  A+X,  3
                 ,NTR,  22B
                 ,UZA,   *00344
                 , UJ,   *00345
                 ,UTC,
 *00344    :     , UJ,   *00352
                 ,UTC,
 *00345    : 7 ,  XTA,  2
                 ,ITS,
             7 ,  XTA,  32B
            15 ,  AEX,
                 ,UIA,   *00350
                 , UJ,   *00351
 *00350    :     , UJ,   *00001
                 ,UTC,
 *00351    :     , UJ,   *00401
                 ,UTC,
 *00352    :13 ,  VJM,      EDI
 *00353    :     ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
L           14 ,  VTM,      *A*    +110B
                 ,ITS,  14
            14 ,  VTM,   *00417
                 ,ITS,  14
            13 ,  VJM,      PAK
            14 ,  VTM,   *00413
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  1
                 ,ITS,  14
            14 ,  VTM,   *00410
                 ,ITS,  14
            14 ,  VTM,   *00412
                 ,ITS,  14
            13 ,  VJM,      PAS
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,  2
                 ,ITS,  14
            14 ,  VTM,      *A*
                 ,ITS,  14
            14 ,  VTM,   *00426
                 ,ITS,  14
            13 ,  VJM,      PAK
             7 ,  XTA,  10
                 ,UTC,      *J*
                 ,ATX,
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00401
 *00373    : 7 ,  MTJ,  8
            14 ,  MTJ,  10
             7 ,  VTM,   *00410
             7 ,  STX,  40B
                 ,ITS,  13
                 ,ITS,  1
                 ,ITS,  2
                 ,ITS,  8
                 ,ITS,
                 ,NTR,  3
                 ,NTR,  2
            10 ,   UJ,
 *00401    :     ,STI,
                 ,STI,  7
                 ,STI,  2
                 ,STI,  1
                 ,STI,  8
                 ,UTC,   BSS+ 0007B
                 ,XTS,
             8 ,   UJ,
 *00405    :,     LOG,  12032530 13033110.
            ,     LOG,  10024056 13427051.
            ,     LOG,  12220040 10020040.
 *00410    :,     LOG,  00000000 00000000.
 *00411    :,     LOG,  64000000 00000000.
 *00412    :,     LOG,  64000000 00000001.
 *00413    :,     LOG,  64000000 00000002.
 *00414    :,     LOG,  64000000 00000003.
 *00415    :,     LOG,  64000000 00000004.
 *00416    :,     LOG,  64000000 00000006.
 *00417    :,     LOG,  64000000 00000010.
            ,     LOG,  64000000 00000011.
            ,     LOG,  64000000 00000013.
            ,     LOG,  64000000 00000016.
            ,     LOG,  64000000 00000022.
            ,     LOG,  64000000 00000023.
            ,     LOG,  64000000 00000051.
 *00426    :,     LOG,  64000000 00000111.
            ,     LOG,  10052105 26052040.
            ,     LOG,  10024116 21253451.
            ,     LOG,  12420040 10020040.
            ,     LOG,  13020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10024056 13427051.
            ,     LOG,  10026475 25036455.
            ,     LOG,  11020040 10020040.
            ,     LOG,  24442501 21020117.
 BSS       :     ,BSS,  114B
       ,DATA,.  :,ENTRY,
 *00440    :,     LOG,  64000000 00000007.
            ,     LOG,  64000000 00000007.
            ,     LOG,  64000000 00000016.
            ,     LOG,  64000000 00000004.
 *00444    :,     LOG,  21452516 20620040.
            ,     LOG,  24652502 24420040.
            ,     LOG,  21247124 24420040.
            ,     LOG,  24051117 21620040.
            ,     LOG,  22247124 21220040.
            ,     LOG,  20647515 24020040.
            ,     LOG,  21052502 23020040.
            ,     LOG,  24442501 23020040.
            ,     LOG,  23440515 10020040.
            ,     LOG,  21247124 10020040.
            ,     LOG,  24652502 10020040.
            ,     LOG,  21247104 10020040.
            ,     LOG,  20640514 10020040.
            ,     LOG,  23041454 10020040.
            ,     LOG,  24041454 10020040.
            ,     LOG,  23051454 10020040.
            ,     LOG,  20251122 10020040.
            ,     LOG,  20446117 10020040.
            ,     LOG,  20647516 10020040.
                4,SET,   *00440
                1,   ,   BSS+ 0110B
               19,SET,   *00444
                1,   ,   BSS+ 0065B
      ,END,
      LUN        :,NAME,
      *A*        :,LC,  125B
      FT*571     :,SUBP,
      FT*002     :,SUBP,
      FT*003     :,SUBP,
      IZ         :,SUBP,
      PAS        :,SUBP,
      PAK        :,SUBP,
      CSP        :,SUBP,
      LINE       :,SUBP,
            14 ,  VTM,   *00001
                 , UJ,   *00230
 *00001    : 7 ,  XTA,  15
                 ,WTC,   BSS+ 0010B
                 ,ATX,
                 ,NTR,  3
             7 ,  XTA,  13
                 ,WTC,   BSS+ 0011B
                 ,ATX,
            14 ,  VTM,   *00275
                 ,ITA,  14
                 ,NTR,  22B
            13 ,  VJM,      LINE
             7 ,  ATX,  21B
                 ,NTR,  3
            14 ,  VTM,   *00274
                 ,ITA,  14
                 ,NTR,  22B
            13 ,  VJM,      LINE
             7 ,  ATX,  25B
                 ,NTR,  3
             7 ,  XTA,  1
             7 ,  ATX,  21B
             7 ,  XTA,  1
             7 ,  ATX,  22B
             7 ,  XTA,
             7 ,  ATX,  26B
            14 ,  VTM,      *A*
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      CSP
             7 ,  XTA,  6
             7 ,  ATX,  23B
                 ,NTR,  3
                 ,NTR,  22B
 *00022    : 7 ,  XTA,  12
                 ,ITS,
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
L            1 ,  UTC,      *A*    +77777B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00027
                 , UJ,   *00030
                 ,UTC,
 *00027    :     , UJ,   *00063
                 ,UTC,
 *00030    : 7 ,  XTA,  8
                 ,ITS,
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
L            1 ,  UTC,      *A*    +77777B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00035
                 , UJ,   *00037
                 ,UTC,
 *00035    : 7 ,  XTA,  23B
             7 ,  ATX,  21B
                 ,NTR,  3
                 ,NTR,  22B
 *00037    : 7 ,  XTA,  10
                 ,ITS,
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
L            1 ,  UTC,      *A*    +77777B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00044
                 , UJ,   *00046
                 ,UTC,
 *00044    : 7 ,  XTA,  23B
             7 ,  ATX,  22B
                 ,NTR,  3
                 ,NTR,  22B
 *00046    : 7 ,  XTA,  9
                 ,ITS,
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
L            1 ,  UTC,      *A*    +77777B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00053
                 , UJ,   *00054
                 ,UTC,
 *00053    :     , UJ,   *00063
                 ,UTC,
 *00054    : 7 ,  XTA,  23B
                 ,NTR,  3
             7 ,  A+X,  2
             7 ,  ATX,  23B
             7 ,  X-A,  7
                 ,NTR,  22B
                 ,UZA,   *00022
                 ,UTC,
 *00060    : 7 ,  XTA,  26B
             7 ,  ATX,  25B
                 ,NTR,  3
                 ,NTR,  22B
                 , UJ,   *00201
                 ,UTC,
 *00063    : 7 ,  XTA,  1
                 ,ITS,
             7 ,  XTA,  21B
            15 ,  AEX,
                 ,UZA,   *00066
                 , UJ,   *00067
 *00066    :     , UJ,   *00201
                 ,UTC,
 *00067    : 7 ,  XTA,  1
                 ,ITS,
             7 ,  XTA,  22B
            15 ,  AEX,
                 ,UZA,   *00072
                 , UJ,   *00074
 *00072    : 7 ,  XTA,  23B
             7 ,  ATX,  22B
                 ,NTR,  3
                 ,NTR,  22B
 *00074    : 7 ,  XTA,  12
                 ,ITS,
                 ,WTC,   BSS+ 0003B
             1 ,  VTM,
L            1 ,  UTC,      *A*    +77777B
                 ,XTA,
            15 ,  AEX,
                 ,UZA,   *00101
                 , UJ,   *00103
                 ,UTC,
 *00101    : 7 ,  XTA,  26B
             7 ,  ATX,  25B
                 ,NTR,  3
                 ,NTR,  22B
 *00103    : 7 ,  XTA,  22B
                 ,NTR,  3
             7 ,  A-X,  21B
             7 ,  A-X,  2
             7 ,  ATX,  24B
             7 ,  XTA,  3
                 ,ITS,
             7 ,  XTA,  24B
                 ,NTR,  22B
            15 ,  AEX,
                 ,UIA,   *00111
                 , UJ,   *00115
 *00111    : 7 ,  XTA,  4
                 ,ITS,
             7 ,  XTA,  24B
            15 ,  AEX,
                 ,UIA,   *00114
                 , UJ,   *00115
 *00114    :     , UJ,   *00060
                 ,UTC,
 *00115    :     ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
                 ,WTC,   BSS+ 0001B
             1 ,  VTM,
             1 ,  UTC,      *A*
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0004B
                 ,ITS,  14
            13 ,  VJM,      PAK
                 ,NTR,  3
                 ,NTR,  22B
                 ,WTC,   BSS+ 0010B
                 ,XTA,
                 ,WTC,   BSS+ 0011B
                 ,ATX,
                 ,NTR,  3
            14 ,  VTM,   *00276
                 ,ITS,  14
                 ,WTC,   BSS+ 0011B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00306
                 ,ITS,  14
            14 ,  VTM,   *00275
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      PAS
             7 ,  XTA,  3
                 ,ITS,
             7 ,  XTA,  24B
            15 ,  AEX,
                 ,UZA,   *00137
                 , UJ,   *00144
 *00137    :14 ,  VTM,   *00276
                 ,ITS,  14
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   *00311
                 ,ITS,  14
            14 ,  VTM,   *00275
                 ,ITS,  14
            13 ,  VJM,      PAS
 *00144    : 7 ,  XTA,  23B
                 ,ITS,
             7 ,  XTA,  22B
            15 ,  AEX,
                 ,UZA,   *00147
                 , UJ,   *00150
 *00147    :     , UJ,   *00201
                 ,UTC,
 *00150    : 7 ,  XTA,  23B
                 ,NTR,  3
             7 ,  A-X,  22B
             7 ,  A-X,  2
             7 ,  ATX,  24B
             7 ,  XTA,  24B
                 ,X-A,
             7 ,  A+X,  5
                 ,NTR,  22B
                 ,UIA,   *00156
                 , UJ,   *00157
                 ,UTC,
 *00156    :     , UJ,   *00060
                 ,UTC,
 *00157    :     ,WTC,   BSS+ 0010B
                 ,XTA,
                 ,WTC,   BSS+ 0011B
                 ,ATX,
                 ,NTR,  3
            14 ,  VTM,   BSS+ 0007B
                 ,ITS,  14
                 ,WTC,   BSS+ 0002B
             1 ,  VTM,
             1 ,  UTC,      *A*
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0004B
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      PAK
                 ,NTR,  3
                 ,NTR,  22B
             7 ,  XTA,  4
                 ,NTR,  3
             7 ,  A-X,  24B
             7 ,  ATX,  20B
            14 ,  VTM,   BSS+ 0000B
                 ,ITS,  14
                 ,WTC,   BSS+ 0011B
            14 ,  VTM,
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0007B
                 ,ITS,  14
            14 ,  VTM,   *00275
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,      PAS
                 ,NTR,  3
                 ,NTR,  22B
 *00201    :     ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITA,  14
            13 ,  VJM,      IZ
                 ,WTC,   BSS+ 0010B
                 ,ATX,
                 ,NTR,  3
                 ,WTC,   BSS+ 0011B
            14 ,  VTM,
                 ,ITA,  14
                 ,NTR,  22B
            13 ,  VJM,      IZ
                 ,WTC,   BSS+ 0011B
                 ,ATX,
                 ,NTR,  3
            14 ,  VTM,   *00241
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,  FT*571
            14 ,  VTM,   BSS+ 0005B
                 ,ITS,  14
            13 ,  VJM,  FT*002
                 ,NTR,  3
                 ,WTC,   BSS+ 0010B
            14 ,  VTM,
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,  FT*002
                 ,WTC,   BSS+ 0010B
                 ,XTA,
                 ,NTR,  3
                 ,WTC,   BSS+ 0011B
            14 ,  VTM,
                 ,ITS,  14
                 ,NTR,  22B
            13 ,  VJM,  FT*002
                 ,WTC,   BSS+ 0011B
                 ,XTA,
                 ,NTR,  3
                 ,NTR,  22B
            13 ,  VJM,  FT*003
                 , UJ,   *00236
                 ,UTC,
 *00230    : 7 ,  MTJ,  8
            14 ,  MTJ,  10
             7 ,  VTM,   *00273
             7 ,  STX,  31B
             7 ,  STX,  30B
                 ,ITS,  13
                 ,ITS,  1
                 ,ITS,  8
                 ,ITS,
                 ,NTR,  3
                 ,NTR,  2
            10 ,   UJ,
 *00236    :     ,STI,
                 ,STI,  7
                 ,STI,  1
                 ,STI,  8
             8 ,   UJ,
                 ,UTC,
 *00241    :,     LOG,  12027457 13626130.
            ,     LOG,  13040466 11620132.
            ,     LOG,  23647105 16420047.
            ,     LOG,  13020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  23632447 13020047.
            ,     LOG,  23631457 13623440.
            ,     LOG,  26447516 21220124.
            ,     LOG,  26250105 11626040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  15254047 20620040.
            ,     LOG,  23620040 23420040.
            ,     LOG,  25020040 21220040.
            ,     LOG,  23420040 25020040.
            ,     LOG,  24623457 12220040.
 *00273    :,     LOG,  21251122 23651054.
 *00274    :,     LOG,  64000000 00000000.
 *00275    :,     LOG,  64000000 00000001.
 *00276    :,     LOG,  64000000 00000002.
            ,     LOG,  64000000 00000005.
            ,     LOG,  64000000 00000003.
            ,     LOG,  64000000 00000007.
            ,     LOG,  64000000 00000030.
            ,     LOG,  12020040 10020040.
            ,     LOG,  12220040 10020040.
            ,     LOG,  13020040 10020040.
 *00306    :,     LOG,  15633467 10020040.
            ,     LOG,  10020040 10020040.
            ,     LOG,  15030467 15633440.
 *00311    :,     LOG,  14030060 10020040.
            ,     LOG,  15030460 14030040.
 BSS       :     ,BSS,  10
      ,END,
  LUN TYP:,NAME,
C*
C****  19.6.84   A.П.CAПOЖHИKOB
C*
C*   FUNCTION LUNTYP(LUN)
C*
C*   OПPEДEЛЯET TИП YCTPOЙCTBA,
C*   ЗAДAHHOГO CBOИM MATEMATИЧECKИM
C*   HOMEPOM  LUN = 30B, ..., 67B
C*       PEЗYЛЬTAT :
C*   0 - BOOБЩE HE ЗAKAЗAHO
C*   1 - ЛEHTA
C*   2 - SCRATCH-ФAЙЛ
C*   3 - ЛИЧHЫЙ ФAЙЛ HA ДИCKE
C*   4 - CПEЦ.ФAЙЛ (MOДEЛЬ MЛ)
C*
  :8,BASE,*
  ,ATI,14
  14,XTA,
  ,ASN,64-36
  ,ATX,IDENT
  ,*63,502B.AГYC
  ,ATI,14
  14,*63,.ГYC
  ,AAX,=:77
  ,AOX,IDENT
  ,ATX,IDENT.ДHЗ+LUN
  ,*63,504B.AT1MT
  ,ATI,12
  9,VTM,-47
  LT:12,UTC,-16
  9,*63,47.T1MT
  ,AEX,IDENT
  ,AAX,=:7777
  ,U1A,ELT
  9,UTM,47
   ,ITA,9
  ,ASN,64+4
 :,UZA,*+1
  ,UTC,1-4.ЛEHTA
  :10,VTM,4.CПEЦ.ФAЙЛ
  ,UJ,EXIT
  ELT:9,VLM,LT
  ,*63,760B.AИПД
  ,ATI,14
  14,*63,20B.LFATA
  ,ATI,11
  ,*63,576B
  ,ATI,12.FATA
  10,VTM,.HEЗAKAЗAHO
  LF:12,UTC,
  11,*63,-1
  ,AEX,IDENT
  ,ASN,64+30
  ,ATI,14
  ,ASN,64+6
  ,U1A,ELF
  :14,VZM,*+1
  ,UTC,3-2
  :10,VTM,2
  ,UJ,EXIT
  ELF:11,UTM,-1
  11,VIM,LF
  EXIT:,ITA,10
  ,AOX,=I0
  13,UJ,
  IDENT:,BSS,1
  ,END,
      M220       :,NAME,
      BINARY     :,SUBP,
 *00000    :     ,ITS,  1
             1 ,  VTM,   *00000
             1 ,  ATX,  100B
                 ,ITA,  13
             1 ,  ATX,  101B
                 ,STX,
             1 ,  STX,  136B
             1 ,  STX,  135B
                 ,STI,  13
             1 ,  STX,  77B
            14 ,  VTM,  77774B
                 ,UTC,
 *00006    :14 ,  ITS,  6
            14 ,  VLM,   *00006
                 ,XTS,
            13 ,  MTJ,  6
             1 ,  ATX,  75B
             1 ,  ATX,  76B
             4 ,  VTM,
                 ,UTC,
 *00012    : 5 ,  VTM,  77751B
            14 ,  VTM,   *00102
                 ,ITS,  14
            13 ,  VJM,  BINARY
 *00014    : 5 ,  UTM,  1
            13 ,  VJM,   *00150
                 ,UTC,   *00130
             5 ,  XTA,
             1 ,  AAX,  133B
                 ,UIA,   *00051
                 ,UTC,   *00130
             5 ,  XTA,
             1 ,  AAX,  132B
                 ,UZA,   *00055
                 ,ITA,  4
             1 ,  AOX,  241B
             6 ,  A-X,
                 ,UZA,   *00053
                 ,UTC,   *00131
             5 ,  XTA,
            13 ,  VJM,   *00137
             1 ,  A*X,  240B
                 ,UTC,   *00130
             5 ,  XTS,
             1 ,  AAX,  227B
                 ,UZA,   *00031
                 ,STX,
                 ,X-A,
                 , UJ,   *00032
 *00031    :     ,STX,
                 ,UTC,
 *00032    : 1 ,  ATX,  134B
                 ,UTC,   *00130
             5 ,  XTA,
             1 ,  AAX,  243B
            13 ,  VJM,   *00137
             1 ,  AAX,  245B
                 ,NTR,  3
             1 ,  X-A,  241B
                 ,NTR,  2
                 ,ATI,  2
             3 ,  VTM,   *00234
                 ,UTC,   *00130
             5 ,  XTA,
             1 ,  AAX,  226B
                 ,UIA,   *00043
             3 ,  VTM,   *00237
                 ,UTC,
 *00043    : 1 ,  XTA,  236B
             2 ,  VZM,   *00046
             2 ,  UTM,  1
                 ,UTC,
 *00045    : 3 ,  A*X,
             2 ,  VLM,   *00045
 *00046    : 1 ,  A*X,  134B
                 ,WTC,   *00077
             4 ,  ATX,
             4 ,  UTM,  1
                 , UJ,   *00053
                 ,UTC,
 *00051    :     ,UTC,   *00130
             5 ,  XTA,
             1 ,  AAX,  132B
                 ,UIA,   *00056
 *00053    :13 ,  VJM,   *00214
             1 ,  XTA,  75B
             1 ,  XTA,  76B
 *00055    : 5 ,  VLM,   *00014
                 , UJ,   *00012
 *00056    :     ,ITA,  4
             5 ,  MTJ,  13
             1 ,  AOX,  241B
             1 ,  STX,  210B
            14 ,  VTM,  77774B
                 ,UTC,
 *00061    :14 ,  STI,  6
            14 ,  VLM,   *00061
             1 ,  XTS,  210B
                 ,UTC,   *00130
            13 ,  XTS,
             1 ,  AAX,  246B
             1 ,  AEX,  75B
                 ,UIA,   *00070
                 ,UTC,   *00131
            13 ,  XTA,
             1 ,  AEX,  76B
                 ,UIA,   *00070
             1 ,  XTA,  242B
                 , UJ,   *00071
 *00070    :     ,XTA,
                 ,UTC,
 *00071    : 1 ,  XTS,  100B
                 ,STI,  1
                 ,WTC,   *00136
                 ,STX,
                 ,WTC,   *00135
                 ,STX,
                 ,WTC,   *00101
                 , UJ,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
 *00077    :     ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
 *00101    :     ,ATX,
                 ,ATX,
 *00102    :     ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
 *00130    :     ,ATX,
                 ,ATX,
 *00131    :     ,ATX,
                 ,ATX,
            12 ,  ATX,
                 ,ATX,
             3 ,  ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
 *00135    :     ,ATX,
                 ,ATX,
 *00136    :     ,ATX,
                 ,ATX,
 *00137    :     ,ASN,  64B
             1 ,  ATX,  210B
                 ,XTA,
             1 ,  ATX,  211B
             8 ,  VTM,  77770B
                 ,UTC,
 *00142    : 1 ,  XTA,  210B
                 ,ASN,  74B
             1 ,  ATX,  210B
                 ,YTA,
             1 ,  AOX,  241B
             1 ,  A+X,  211B
             1 ,  A*X,  237B
             1 ,  ATX,  211B
             8 ,  VLM,   *00142
             1 ,  A*X,  234B
            13 ,   UJ,
                 ,UTC,
 *00150    :     ,UTC,   *00130
             5 ,  XTA,
             1 ,  AAX,  231B
                 ,ASN,  50B
             1 ,  ATX,  210B
                 ,UTC,   *00131
             5 ,  XTA,
             1 ,  AAX,  232B
                 ,ASN,  24B
             1 ,  AOX,  210B
             1 ,  ATX,  210B
                 ,UTC,   *00131
             5 ,  XTA,
                 ,ASN,  102B
             1 ,  ATX,  211B
                 ,XTA,
             1 ,  ATX,  212B
             9 ,  VTM,  77771B
 *00161    : 1 ,  XTA,  211B
                 ,ASN,  105B
             1 ,  ATX,  211B
                 ,YTA,
             1 ,  AOX,  212B
                 ,ASN,  104B
             1 ,  ATX,  212B
             9 ,  VLM,   *00161
                 ,UTC,   *00130
             5 ,  XTA,
                 ,ASN,  102B
             1 ,  ATX,  213B
                 ,YTA,
                 ,ASN,  104B
             1 ,  AOX,  212B
             1 ,  ATX,  212B
             1 ,  XTA,  213B
                 ,ASN,  105B
             1 ,  ATX,  213B
                 ,YTA,
             1 ,  AOX,  212B
                 ,ASN,  114B
                 ,UTC,   *00131
             5 ,  ATX,
             1 ,  XTA,  213B
                 ,ASN,  110B
             1 ,  ATX,  213B
                 ,YTA,
                 ,ASN,  101B
             1 ,  ATX,  212B
             9 ,  VTM,  77776B
                 ,UTC,
 *00201    : 1 ,  XTA,  213B
                 ,ASN,  102B
             1 ,  ATX,  213B
                 ,YTA,
             1 ,  AOX,  212B
                 ,ASN,  101B
             1 ,  ATX,  212B
             9 ,  VLM,   *00201
                 ,ASN,  146B
             1 ,  AOX,  210B
                 ,UTC,   *00130
             5 ,  ATX,
            13 ,   UJ,
                 ,UTC,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
                 ,ATX,
 *00214    :     ,UTC,   *00131
             5 ,  XTA,
             1 ,  ARX,  76B
             1 ,  ATX,  210B
             1 ,  AAX,  235B
                 ,ASN,  144B
             1 ,  ARX,  210B
             1 ,  AAX,  233B
             1 ,  ATX,  76B
                 ,UTC,   *00130
             5 ,  XTA,
             1 ,  ARX,  75B
             1 ,  ATX,  210B
             1 ,  AAX,  230B
                 ,ASN,  111B
             1 ,  ARX,  210B
             1 ,  AAX,  244B
             1 ,  ATX,  75B
            13 ,   UJ,
                 ,UTC,
 *00226    :,     LOG,  00000000 00000100.
            ,     LOG,  00000000 00000200.
            ,     LOG,  00000000 00001000.
            ,     LOG,  00000000 60000000.
            ,     LOG,  00000000 00000003.
            ,     LOG,  00007777 77777777.
 *00234    :,     LOG,  36546314 63146315.
            ,     LOG,  00010000 00000000.
            ,     LOG,  40100000 00000000.
 *00237    :,     LOG,  42120000 00000000.
            ,     LOG,  22104560 27640470.
            ,     LOG,  64000000 00000000.
            ,     LOG,  64000000 00000001.
            ,     LOG,  00000000 00000077.
            ,     LOG,  00000000 00000777.
            ,     LOG,  77777777 77777700.
            ,     LOG,  03777777 77777777.
 BSS       :     ,BSS,
      ,END,
 MAK/FILE:,NAME,.ФOPM. ФAЙЛA
 KCOUNT*:,LC,
 MONCARD*:,LC,
 *C:,ITS,13.
 ,ITS,7.
 ,ITS,
 7,BASE,*C.
 READL:,XTA,MONCARD*.
 ,AEX,=6H*END F
 ,UZA,BCE
 ,XTA,MONCARD*.
 ,AEX,=77751.
 ,UZA,BINARY*.
 14,VTM,CARD.
 ,ITS,14
 ,CALL,READ*.
 14,VTM,CARD.
 ,ITS,14
 14,VTM,SERV.
 ,ITS,14.
 ,CALL,UPPFILE.
 ,UJ,READL.
 BCE:,XTA,=5H*READ
 ,ATX,CARD
 ,XTA,=3HOLD
 ,ATX,CARD+1
 14,VTM,CARD
 ,ITS,14
 14,VTM,SERV.
 ,ITS,14
 ,CALL,UPPFILE.
C   ---  YCTAHOBKA HOBЫX YKAЗATEЛEЙ
 14,VTM,-1010.
 ,ITA,14
 ,ATX,KCOUNT*
 ,XTA,=10 0000 0006 0000
 ,ATX,KCOUNT*+1
 ,ATX,KCOUNT*+2
 ,CALL,MONREAD*
 ,STI,.
 ,STI,7
 ,STI,13.
 ,NTR,6.
 13,UJ,.
 SERV:,STI,.
 13,UJ,.
 BINARY*:14,VTM,MONCARD*.
 ,ITS,14.
 ,CALL,WRIBINC.
 ,CALL,MONREAD*.
 ,UJ,READL.
 CARD:,BSS,14.
 ,END,MAK/FILE.
 MAKELIBT:,NAME,.T P O И Ц K - 86
C*******************************************
C* ФOPMИPOBAHИE OБЩИX БИБЛИOTEЧHЫX ЛEHT    *
C*              * * *                      *
C* ДAHHЫЙ BAPИAHT ПPOГPAMMЫ ГAPAHTИPYET    *
C* BЫЗOB ИЗ БИБЛИOTEKИ   BLOCK DATA .      *
C*              * * *                      *
C* BЫЗOB:                                  *
C* CALL MAKELIBT:<YK OБCП>(<CПИC.YK.PERSO>)*
C*      <OГPAH>,<KOMMEHTAPИЙ>              *
C*    ИЛИ                                  *
C* CALL MAKELIBT-<YK OБCП>(<CПИC.YK.PERSO>)*
C*     <OГPAH>,<KOMMEHTAPИЙ>               *
C* BO BTOPOM CЛYЧAE B OБCП TEMPORARY LIB-  *
C* RARY BKЛЮЧEHA HE БYДET.                 *
C* ECЛИ CПИCOK YK.PERSO - ПYCT, OБCП ФOP-  *
C* MИPYETCЯ ИЗ TEMPORARY LIRARY            *
C* ПPИ HEOБXOДИMOCTИ MOЖET ЗAДABATЬCЯ      *
C* CПИCOK BXOДOB ДЛЯ ИCKЛЮЧEHИЯ ИЗ ФOPMИ-  *
C* PYEMOЙ OБCП C ПOMOЩЬЮ ПOДПPOГPAMMЫ      *
C*     EXCLUDE                             *
C*******************************************
 MONITOR*:,SUBP,.
 DATA*:,LC,2
 PRINT8:,SUBP,
 A/OCTDEC:,SUBP,.
 PARAMT*:,SUBP,
 *MONCRD*:,LC,12
 OUT*OUT:,LC,1
 LIB**KAT:PC,BLOCK,HOB**KAT(2048)
  ,CONT,CПPABKИ(1024)
  ,CONT,CCЫЛKИ(2048)
  ,CONT,WBUF(1024)
 RBUF    :,EQU,CCЫЛKИ.
 EXCLUDE: ,SUBP,.CПИCOK ИCKЛ.
 KAT/P   :,P/P,(HOB**KAT)16
 RB/P    :,P/P,(RBUF)16
 WB/P    :,P/P,(WBUF)16
 PT6/G:,SUBP,.
 *C:   7,BASE,*C
 ,XTA,
 ,ATX,FLDIAG.
 ,XTA,W0004*
 ,ATX,W0004.
 ,XTA,W0005*
 ,ATX,W0005.
 5,VTM,-1023.
 ,XTA,=1
 ,ATX,A/REF.
 ,XTA,=211 2000
 ,ATX,CBOБOДHO
 ,XTA,=400
 ,ATX,*OГPAH*.
 ,XTA,=66 0000
 ,ATX,IWNEW.
 2,VTM,1-7.
 1,VTM,.
 14,VTM,-11
 ,XTA,=6H
 CL/COM:14,UTC,COMMENT
 ,ATX,11
 14,VLM,CL/COM.
 ,MTJ,10.
 ,CALL,PARAMT*
 ,ITA,11
 ,AEX,=6H''''''''''-
 ,ATX,FL/TEMPO.
 11,VZM,NO*PARAM.HET ПAPAMETPOB
 ,ITA,11
 ,AEX,=6H''''''''''(
 ,UZA,L/PNTT.CPAЗY CПИCOK
 9,VTM,IWNEW
 10,VTM,4
 ,CALL,PARAMT*.
 14,V1M,ERR*CALL.
 11,VZM,NO/PARAM.
 13,VJM,TEST*IW.
 ,ITA,11.
 ,AEX,=6H''''''''''(
 ,UIA,GIV*OГP
 L/PNTT:1,UTC,.
 9,VTM,LIST
 10,VTM,4
 ,CALL,PARAMT*
 14,VIM,ERR*CALL.
 13,VJM,TEST*IW.
 1,UTM,1.
 ,ITA,11
 ,AEX,=6H'''''''''')
 ,UZA,GIV*OГP.KOHEЦ CПИCKA
 2,VLM,L/PNTT.
 ,UJ,ERR*CALL.KOЛ-BO PERSO>7
C******************************************
C*  ПPOBEPKA BЫДAHHЫX YKAЗATEЛEЙ MЛ       *
C******************************************
 TEST*IW:,ARX,=10 0000
 ,AAX,=40 0000
 ,UZA,ERR*CALL.
 13,UJ,.
 GIV*OГP:9,VTM,*OГPAH*
 10,VTM,5
 ,CALL,PARAMT*
 14,VIM,ERR*CALL.
 11,VZM,NO*PARAM
 10,VTM,1
 ,CALL,PARAMT*.
 14,VIM,ERR*CALL.
 14,VTM,-11
 LS/COM:14,UTC,*MONCRD*
 ,XTA,11.
 14,UTC,COMMENT
 ,ATX,11.
 14,VLM,LS/COM.
 ,UJ,NO*PARAM.
 NO/PARAM:,XTA,=400
  ,ATX,FL/TEMPO.
 NO*PARAM:,BSS,.PAЗБOP ЗAДAHИЯ OKOHЧEH
 ,XTA,FL/TEMPO.
 ,UZA,NOT*TEMP. БEЗ TEMPORARY
 ,XTA,=21 0000
 1,UTC,.
  ,ATX,LIST.
 1,UTM,1.
 NOT*TEMP:,BSS,.
 ,ITA,1
 ,ATX,N/PERSO.
 ,NTR,3
 ,XTA,*OГPAH*
 ,ATX,FL/MAL.
 ,A-X,=6
 ,UIA,MAЛO*MЛ.
 ,ARX,=1
 ,ATX,*OГPAH*
 ,XTA,IWNEW
 ,ATX,SVNEW
 ,ARX,CWWD
 ,ATX,W0003.
 ,XTA,IWNEW.ДЛЯ
 ,AOX,CWCAT.ЗAПИCИ
 ,ATX,IWNEW. O Б C П
C***************************************
 3,VTM,LIB**KAT+2
 ,XTA,
 14,VTM,-2047
 L///CC:14,UTC,HOB**KAT
 ,ATX,2047.
 14,VLM,L///CC.
 ,XTA,=7777 7777 7777 7777
 3,ATX,1
 LIB/LOOP:,BSS,.ЦИKЛ ПO БИБЛИOTEKAM
 1,VZM,ALL//LIB.
 1,UTM,-1.
  ,ITA,1.YKAЗATEЛЬ
  ,ASN,64-38.HOMEPA
  ,ATX,P/UKAZ.PERSO.
C****************************************
C    ЧTEHИE И ПPOBEPKИ KATAЛOГA PERSO   *
C****************************************
 1,UTC,LIST.
 ,XTA,.
 ,AEX,=21 0000
 ,ATX,FL*TEMPO.
 ,AEX,=21 0000
 ,AOX,IW*R.
 ,ATX,W0001.
 ,*70,W0001.
 ,XTA,W0001.
 ,ARX,=100 0000 0001
 ,ATX,W0001.
 ,*70,W0001.
 2,VTM,RBUF
 2,XTA,.
 ,AAX,=200 0000
 ,UZA,ERR*LIBT.
 2,XTA,.
 ,AAX,=7777 7777 7000 0037
 2,AOX,1
 ,UIA,ERR*LIBT.
 2,XTA,.
 ,AAX,=70 0000
 ,UZA,ERR*LIBT.
C*************************************
C     ПPOBEPKИ KATAЛOГA PERSO        *
C*************************************
 14,VTM,-1022.
 12,VTM,.
 L/CH*CTL:,XTA,FL*TEMPO
 ,UIA,NO*TMPL.
 2,XTA,3.
 ,AAX,=:4
 ,UZA,NO*TMPL.
 ,ATX,FL*TEMPO.
 2,MTJ,12.
 NO*TMPL:2,XTA,3.
 ,AEX,=7777 7777 7777 7777
 ,UIA,E/CH*CTL
 2,XTA,2.
 ,UZA,OK*CTL.
 E/CH*CTL:2,UTM,2.
 14,VLM,L/CH*CTL.
 ,UJ,ERR*LIBT.ПЛOXOЙ KATAЛOГ.
 OK*CTL:12,VZM,P/CH*CTL.
 12,MTJ,2
 P/CH*CTL:,XTA,
 2,ATX,2
 ,XTA,=7777 7777 7777 7777
 2,ATX,3.
C******************************************
C      OЧEPEДHOЙ KATAЛOГ ПPOBEPEH         *
C      ДEЛAEM ИCKЛЮЧEHИЯ И ДOБABЛЯEM
C        EГO B PEЗYЛЬTИPYЮЩИЙ             *
C******************************************
 KAT*NEW:,BSS,.
 2,XTA,.MAIN PROGRAM
 ,AEX,PROGRAM .ИCKЛЮЧATЬ
 ,UZA,NO*CH*EX.HEЛЬЗЯ
 14,VTM,EXCLUDE.
 L/CH*EXC:,BSS,.
 14,XTA,.KOHEЦ
 ,UZA,E/CH*EXC.CПИCKA
 2,AEX,. ИMЯ
 ,UZA,MAK//EXC.ИCKЛЮЧИTЬ
 14,VLM,L/CH*EXC.
 E/CH*EXC:,BSS,.ECTЬ ЛИ B KATAЛOГE
 14,VTM,LIB**KAT+2
 L/CH*ECT:14,XTA,.
 ,UZA,NO*CH*EX.OCTABЛЯEM.
 2,AEX,.
 ,UZA,MAK**EXC.
 14,UTM,2
 ,UJ,L/CH*ECT.
 MAK**EXC:,BSS,.ИCKЛЮЧEHИE BXOДA
 2,XTA,1.ENTRY
 ,AAX,=:2     .CPAЗY
 ,UZA,IS***EXC.HE ПИШEM
  ,UTC,LIB**KAT.ECЛИ ENTRY
  ,XTA,3.ЧYЖOE
  ,AAX,=:2 . TO TOЖE
 ,UIA,IS***EXC.БEЗ ПPOБЛEM.
 2,XTA,1 .ДOБABИM
 ,AAX,=7743 7777 7770 0000
 ,AOX,P/UKAZ.N PERSO B
 ,UTC,LIB**KAT.ИHФOPMAЦИЮ
 ,AOX,3 .OCTABЛЯEMOMY
 ,UTC,LIB**KAT.BXOДY
 ,ATX,3.
 ,UJ,IS***EXC.KOHEЦ ИCKЛЮЧEHИЯM.
 MAK//EXC:,XTA,FLDIAG.ПEЧATЬ
 ,UIA,NO*D*E.CПИCKA
 13,VTM,T*ИCKЛ.ИCKЛЮЧAEMЫX
 ,ITA,13.BXOДOB.
 ,ATX,FLDIAG
 ,*64,INF.
 NO*D*E:2,XTS,.
 ,XTS,=6
 ,CALL,PT6/G.
 ,UJ,MAK**EXC.
 NO*CH*EX:,BSS,.BXOД OCTABЛEH
  3,MTJ,13.
 SHI*ENTR:13,XTA,.
 13,ATX,2
 13,XTA,1
 13,ATX,3.
 13,UTM,-2
 13,UTM,-LIB**KAT
 13,VZM,SHI*FIN.
 13,UTM,LIB**KAT.
   ,UJ,SHI*ENTR.
 SHI*FIN:,BSS,.KATAЛOГ CДBИHYT.
 2,XTA,.
 ,UTC,LIB**KAT
 ,ATX,2
 2,XTA,1
 ,AAX,=7743 7777 7777 7777
 ,AOX,P/UKAZ.N PERSO
 ,UTC,LIB**KAT.
 ,ATX,3.
 3,UTM,2
 3,UTC,-LIB**KAT
  14,VTM,-2032
  14,VZM,KAT*OVFL.ПEPEПOЛHEH KATAЛOГ.
 IS***EXC:,BSS,.
 2,UTM,-2
 2,MTJ,14.
 14,UTM,-RBUF.
 14,VIM,KAT*NEW.
 ,UJ,LIB/LOOP.CЛEД. PERSO.
 ALL//LIB:,BSS,.OФOPMЛEH KATAЛOГ
 4,VTM,-1023
 ,XTA,
 L/WBF:4,UTC,WBUF
 ,ATX,1023
 4,VLM,L/WBF.
 4,VTM,-1023.
 ,ATX,FLDIAG.
C***************************************
C     ФOPMAT CTAHДAPTHOГO MACCИBA      *
C     CTPYKTYPA (3 CЛOBA. CM. HИЖE)    *
C     KOMAHДЫ                          *
C     KOHCTAHTЫ                        *
C     ДAHHЫE                           *
C     PACCЫЛKИ                         *
C     ЗAГOЛOBOK ПOДПPOГPAMMЫ           *
C     OБOЗHAЧEHИЯ                      *
C     KOMMEHTAPИЙ                      *
C     PEЗEPB                           *
C     ДЛИHHЫE ИДEHTИФИKATOPЫ           *
C            * * * * * *               *
C                                      *
C     OПИCAHИE CTPYKTYPЫ B 3-X         *
C     ПEPBЫX CЛOBAX CTAHДAPTHOГO       *
C     MACCИBA                          *
C   ===================================*
C   I PEЗ.  I KOMM.  I OБOЗH I ГOЛOB. I*
C   ===================================*
C   I    I ДЛ.ИД. I SET    I   DATA   I*
C   ===================================*
C   I    I KOHCT. I BSS    I KOMAHДЫ  I*
C  ====================================*
C***************************************
 ,ITA,3.
 ,ATX,END//KAT.
 3,MTJ,2.ЗAПИCЬ CM
 LOOPC2:2,UTM,-2
 2,XTA,.
 ,UZA,FIN**LIB.
 2,XTA,1.
 ,AAX,=:2
 ,UZA,LOOPC2.BXOДЫ ПPOПYCKAEM
 2,XTA,1.
 ,APX,=:0034
 ,AUX,=7
 ,ATI,14
 14,UTC,.
 ,XTA,LIST.
 ,AOX,IW*R.
 ,ATX,W0002.
 2,XTA,1.
 ,APX,=:1740
 ,AUX,=1740
 ,ATI,3.
 3,UTM,RBUF
 2,XTA,1
 ,APX,=:0003 77
 ,AUX,=377
 ,ARX,=7740
 ,AAX,=7777
 ,ARX,W0002.
 ,ATX,W0002.
 ,AEX,W0001.
 ,UZA,NO//SWOP.
 ,*70,W0002
 ,XTA,W0002
 ,ATX,W0001.
C**********************************
C   PACПAKOBKA З-X CЛOB CTPYKTYPЫ *
C**********************************
 NO//SWOP:,BSS,.
 14,VTM,-3
 3,XTA,.
 CЛOBO 1:15,ATX,.
 ,AAX,=7777
 14,UTC,3
 ,STX,ЗAГOЛ.
 ,ASN,64+12.
 14,VLM,CЛOBO 1.
 14,VTM,-2
 3,XTA,1
 CЛOBO 2:15,ATX,.
 ,AAX,=77777
 14,UTC,2
 ,STX,SET.
 ,ASN,64+15
 14,VLM,CЛOBO 2.
 14,VTM,-2
 3,XTA,2
 CЛOBO 3:15,ATX,
 ,AAX,=77777
 14,UTC,2.
 ,STX,KOMAHДЫ
 ,ASN,64+15
 14,VLM,CЛOBO 3.
C**************************************
C*  "CTPYKTYPHЫE"  BЫЧИCЛEHИЯ         *
C**************************************
 ,XTA,KOMAHДЫ
 ,ARX,KOHCT.
 ,ATX,BEG*DFT
 ,ARX,BSS
 2,XTS,1
 ,ASN,64+15
 15,AEX,
 ,AAX,=7777
 ,UZA,SM//GOOD.
C*******************************************
C   ИCПOPЧEHHAЯ ПOДПPOГPAMMA ДOЛЖHA БЫTЬ
C   ИCKЛЮЧEHA CO BCEMИ CBOИMИ   BXOДAMИ.
C*******************************************
 ,XTA,FLDIAG.
 ,UIA,БЫЛA YЖE.
 13,VTM,ПOPЧA.
 ,PRINT,INF.
 ,ITA,13.
 ,ATX,FLDIAG.
 БЫЛA YЖE:,ITA,2.
 ,ATX,A HAЧ.
 10,VTM,-20.
 ECTЬ EЩE:2,XTS,.
 10,UTC,20
 14,VTM,LINE.
 ,ITS,14.
 ,CALL,PT6/G.
 10,UTM,2.
 10,VIM,ISPLASE.
 ,PRINT,IBAD.
 10,VTM,-20.
 ISPLASE:2,UTM,2.
 2,XTA,.
 ,UZA,******.
 2,XTA,1.
 ,AAX,=:2.
 ,UZA,ECTЬ EЩE.
 ******:10,UTM,20.
 10,VZM,NO SHAKE.
 10,UTM,-20.
 ,PRINT,IBAD.
C*************************************
C   ИCKЛЮЧEHИE BXOДOB И KOPPEKTИPOBKA
C         K A T A Л O Г A
C*************************************
 NO SHAKE:,NTR,3.
 ,ITA,2.
 ,A-X,A HAЧ.
 ,ATX,SHIFT.BEЛИЧИHA ПPOДBИЖKИ
 ,ITA,2.
 ,A-X,END//KAT.ЧИCЛO ПEPECЫЛAEMЫX
 ,ATI,14.KOДOB
 14,UTM,-1.
 ,WTC,A HAЧ.
 10,VTM,.
 L/DEL1:,WTC,SHIFT.
 10,XTA,.
 10,ATX,.
 10,UTM,1.
 14,VLM,L/DEL1.
 ,XTA,A HAЧ.
 ,ATI,2.
 ,XTA,END//KAT
 ,A-X,SHIFT.
 ,ATX,END//KAT
 ,ATI,10.
 ,WTC,SHIFT.
 14,VTM,.
 ,XTA,.
 L/DEL2:10,ATX,2
 10,UTM,1.
 14,UTM,-1.
 14,VIM,L/DEL2.
 ,UJ,LOOPC2.
 SM//GOOD:,BSS,.
 ,XTA,BEG*DFT
 ,ARX,ЗAГOЛ.
 ,ARX,DATA
 ,ARX,SET
 ,ARX,=3
 ,ATX,BEG*DFT.HAЧAЛO T.O.
 ,ARX,KOMMEHT.
 ,ARX,PEЗ*2.
 ,ARX,LONG/ID
 ,ARX,OБOЗH.
 ,ARX,=37  .OKPYГЛЯEM
 ,AAX,=77740.ДO
 ,ATI,12.PEKOPДA
 ,ATX,LG SM.ДЛИHY CM
 ,XTA,=7777 7777 7777 7777
 ,ATX,TEK*ADR.
 ,WTC,17B
 11,VTM,11B.MECTO ДЛЯ T.O.
 3,UTM,-RBUF-1023.
 LOOP/RW:12,VZM,FIN*SM.
 3,UTC,RBUF
 ,XTA,1023.
 ,ATX,W0002.
 3,VLM,CONT/R.
 ,XTA,W0001.
 ,ARX,=1
 ,ATX,W0001.
 ,ARX,=10 0000
 ,AAX,=40 0000
 ,UIA,CONT///.
 ,XTA,W0001
 ,ARX,=7740
 ,AOX,=7740
 ,AEX,=7740
 ,ATX,W0001.
 CONT///:3,VTM,-1023
 ,*70,W0001.
 CONT/R:,BSS,.
 ,XTA,W0002.
 4,UTC,WBUF
 ,ATX,1023
 4,VLM,CONT/W.
 4,VTM,-1023
 ,XTA,*OГPAH*
 ,ATX,FL/MAL.
 ,UZA,БЛOK/W.
 ,ARX,=7777
 ,AAX,=7777
 ,ATX,*OГPAH*.
 ,*70,W0003
 БЛOK/W:,BSS,.БЛOKИPYEM ЗAПИCЬ
 ,XTA,W0003
 ,ARX,=1
 ,ATX,W0003
 ,XTA,
 L/CWB:4,UTC,WBUF
 ,ATX,1023.
 4,VLM,L/CWB.
 4,VTM,-1023.
 CONT/W:,BSS,.
 ,XTA,TEK*ADR
 ,ARX,=1
 ,ATX,TEK*ADR
 12,UTM,-1
 ,NTR,3
 ,A-X,BEG*DFT
 ,UIA,LOOP/RW
 ,XTA,W0002
 11,ATX,
 11,VLM,LOOP/RW.
 ,046,.ПEPEПOЛHEHИE БYФEPA TO
 FIN*SM:,BSS,.KOHEЦ ПEPEПИCИ CM
 ,WTC,17B
 12,VTM,11B.
 ,WTC,OБOЗH
 11,VTM,.
 LW/REF:,BSS,.ЗAПИCЬ CCЫЛOK
 11,VZM,ELW/REF.
 12,UTM,1.
 11,UTM,-1.
 12,XTA,.
 ,APX,=700 0000
 ,AUX,=7
 ,ATI,14
 14,UJ,*+1
 :,UJ,LW/REF.0
 :,UJ,LW/REF.1
 :,UJ,LW/REF.2
 :13,VTM,.3 (SUBP)
 ,UJ,DO/REF.
 :,UJ,LW/REF.4
 :,UJ,LW/REF.5
 :,UJ,LW/REF.6
 :13,VTM,1.7 (COMMON)
 ,UJ,DO/REF.
 DO/REF:12,XTA,
 ,AAX,=2000 0000
 ,UIA,GV/REF
 12,XTA,
 ,AAX,=:7777 7777
 ,ATX,W0002
 ,UJ,PT/REF
 GV/REF:12,XTA,
 ,ASN,64+24
 ,ATI,14
 14,UTM,-4000B
 ,WTC,17B
 14,XTA,11B
 ,ATX,W0002.
 PT/REF:13,VZM,PT*REF.
 ,XTA,W0002.
 ,ASN,64+42
 ,AEX,=12
 ,UIA,LW/REF.
 PT*REF:,XTA,W0002.
 13,VJM,WW/RF.
 ,UJ,LW/REF.
 WW/RF:5,UTC,RBUF
 ,ATX,2047.
 5,VLM,CONT/F.
 ,*70,W0004.
 ,XTA,W0004.
 ,ARX,=7741
 ,AOX,=7740
 ,AEX,=7740
 ,ATX,W0004.
 5,VTM,-1023.
 CONT/F:13,UJ,.
 ELW/REF:,BSS,.KOHEЦ CCЫЛOK
C*************************************
C   KOPPEKTИPOBKA KATAЛOГA           *
C*************************************
 2,XTA,1.
 ,AAX,=2000 0077 7777 7777
 2,ATX,1.
 ,XTA,CBOБOДHO
 ,APX,=1740
 ,AUX,=:1740
 2,AOX,1.
 2,ATX,1.
 ,XTA,CBOБOДHO
 ,APX,=77 76000
 ,AUX,=:0037 77
 2,AOX,1
 2,ATX,1
 ,XTA,LG SM
 ,ARX,CBOБOДHO.
 ,ATX,CBOБOДHO.
 ,XTA,
 13,VTM,LOOPC2
 ,UJ,WW/RF.
 FIN**LIB:,BSS,.
 5,UTM,1023.
 4,UTM,1023.
 :4,VZM,HET/CБ.
 ,XTA,FL/MAL.
 ,UZA,HET/CБ.
 ,*70,W0003.ДOCБPOC ЗOHЫ
 HET/CБ :5,VZM,*+1.
 ,*70,W0004.ДOCБPOC CCЫЛOK
 ,XTA,FL/MAL.
 ,UIA,CON/DO
 13,VTM,MAЛO/MЛ
 ,*64,INF
 CON/DO:,XTA,.
 14,VTM,-3071.
 L/0001:,UTC,CПPABKИ
 14,ATX,3071.
 14,VLM,L/0001.ЧИCTKA
 3,VTM,48.ДЛЯ
 4,VTM,-2047.CCЫЛOK
 5,VTM,-1023.
 ,*70,W0005
 ,WTC,END//KAT.
 2,VTM,.KOHEЦ KATAЛOГA
 LOOP/F:,BSS,.ФOPMИPOBAHИE CCЫЛOK И CПPABOK
 2,UTM,-2
 2,XTA,.
 ,UZA,WR/ALL.BCE
 2,XTA,1
 ,AAX,=:2
 ,UZA,LOOP/F.
 8,VTM,.ЧИCЛO CCЫЛOK
 ,XTA,A/REF
 ,ATX,ADR/REF.
 NXT/R:,BSS,.
 13,VJM,R/NXTR.
 ,UZA,CH*ENT/R.CПPABKИ ДЛЯ BXOДOB
 ,WTC,END//KAT.
 14,VTM,
 SERCH*R:14,UTM,-2
 14,XTA,.
 ,UZA,NXT/R.
 ,AEX,W0002.
 ,UIA,SERCH*R.
 14,UTM,-LIB**KAT
 ,ITA,14.
 8,UTM,1
 13,VJM,WSR*
 ,UJ,NXT/R.
 CH*ENT/R:,BSS,.
 ,ITA,8
 ,ASN,64-15
 :,UZA,*+1
 ,AOX,ADR/REF
 :,ATX,W0002.
C*************************************
C  ЗAПИCЬ CПPABKИ                    *
C*************************************
 2,MTJ,9.
 2,UTC,-2.
 14,VTM,-LIB**KAT.
 ,ITA,14.
 ,ASN,64+1
 ,ATI,14.
 14,UTM,CПPABKИ
 ,XTA,W0002.
 14,ATX,.
 L/SS*:9,UTM,2.
 9,XTA,1
 ,AAX,=:2
 ,UIA,LOOP/F
  ,XTA,W0002.
 14,ATX,1.
 14,VLM,L/SS*.
 WSR*:,BSS,.
 ,XTS,A/REF
 ,ARX,=1
 ,STX,A/REF
 3,ASN,64-48
 ,XTS,=7777
 3,ASN,64-48
 ,AEX,=7777 7777 7777 7777
 4,UTC,CCЫЛKИ
 ,AAX,2047.
 15,AOX,
 4,UTC,CCЫЛKИ
 ,ATX,2047.
 3,UTM,-12
 3,VIM,R*001
 3,VTM,48
 4,VLM,R*001.
 ,UJ,KAT*OVFL.
 R*001:13,UJ,.
 R/NXTR:,BSS,.
 5,UTC,WBUF
 ,XTA,1023.
 ,ATX,W0002
 13,UTC,
 5,VLM,.
 ,XTS,W0005
 ,ARX,=7741
 ,AOX,=7740
 ,AEX,=7740
 ,ATX,W0005
 5,VTM,-1023.
 ,*70,W0005
 15,XTA,.
 13,UJ,.
 ERR*LIBT:,BSS,.ЛEHTA БEЗ PERSO
 1,UTC,LIST.
 ,XTA,
 ,ATX,W0001
 ,APX,=77 0000
 ,AUX,=6H'7''7'''''''''
 ,AOX,ЗOHA*
 ,ATX,ЗOHA/
 ,XTA,W0001
 ,APX,=7777
 ,AUX,=6H'''''7''7''7''7'
 ,AOX,ЗOHA*+1
 ,ATX,ЗOHA/+1.
 13,VTM,T*BADLIB.
 ,*64,INF.
 ,UJ,LIB/LOOP.CЛEД PERSO
 MAЛO*MЛ:,BSS,.ФATAЛЬHO!
 13,VTM,MAЛO/MЛ
 ,*64,INF
 ,*62,
 KAT*OVFL:,BSS,.
 ,UTC,BIG*KT-T*ERRC.
 ERR*CALL:,BSS,.OШИБKИ
 13,VTM,T*ERRC
 ,*64,INF.
 ,*62,
 WR/ALL:,BSS,.ЗAПИCЬ KATAЛOГA
 ,XTA,CBOБOДHO.
 ,UTC,HOB**KAT
 ,ATX,
 ,WTC,END//KAT.
 12,VTM,2
 ,XTA,=6HLIBRAR
 12,ATX,
 ,XTA,=6HY OT
 12,ATX,1
 ,XTA,DATA*
 12,ATX,3
 ,XTA,DATA*+1
 ,AAX,=6H'377''377'''''''''
 ,AOX,=6H''''
 12,ATX,4
 14,VTM,-11
 LWCMNT:14,UTC,COMMENT
 ,XTA,11
 14,UTC,11
 12,ATX,5
 14,VLM,LWCMNT
 1,VTM,-4.
 L/WCT:,*70,IWNEW
 ,XTA,IWNEW
 ,ARX,=100 0000 0001
 ,ATX,IWNEW.
 1,VLM,L/WCT.
C***************************************
C    ПEЧATЬ CПPABKИ ПO ЗAKAЗY          *
C***************************************
 ,WTC,END//KAT.
 14,VTM,-LIB**KAT-2
 ,ITA,14
 ,ASN,64+1
 ,CALL,A/OCTDEC
 ,ATX,ИTOГ+5
 ,NTR,3.
 ,XTA,CBOБOДHO
 ,A-X,=210 0000
 ,XTS,SVNEW
 ,ASN,64-10
 15,ARX,
 ,ATX,SVNEW
 ,APX,=1740
 ,AUX,=6H'''3''7'''''''
 ,AOX,=6H 00
 ,ATX,ИTOГ+3
 ,XTA,SVNEW
 ,APX,=1777 6000
 ,AUX,=6H'''7''7''7''7'''
 ,AOX,=6H 0000
 ,ATX,ИTOГ+2
 ,XTA,IWNEW
 ,APX,=77 0000
 ,AUX,=6H'''''''7''7'''
 ,AOX,=6HHO 00
 ,ATX,ИTOГ+1
 ,NTR,6.
 14,VTM,ИTOГ.
 ,ITS,14.
 14,UTM,5
 ,ITS,14
 ,XTS,=1
 13,VTM,MONITOR*+1
 ,UJ,PRINT8.
 IBAD:,,LINE
 10,Z00,LINE+19
 :,004,
 8,,.
 INF:13,,
 13,,.
 :,,
 8,,
 W0004*:,,RB/P+100B
 ,002,
 W0005*:,010,WB/P.
 ,002,.
 IW*R:,010,RB/P
 ,,.
 CWCAT:,,KAT/P
 ,,.
 CWWD:,,WB/P
 ,,5.HAЧAЛO CM
 ИTOГ:,ISO,30HCBOБOДHO 66  0120  37   BXOДOB
 LINE:,BSS,20
 ,GOST,1H'231'
 ПOPЧA:,GOST,24HИCПOPЧEHЫ ПOДПPOГPAMMЫ:'231'
 ЗOHA*:,GOST,12H00 ЗOHA 0000
 T*ИCKЛ:,GOST,18HИCKЛЮЧEHЫ BXOДЫ:'231'
 MAЛO/MЛ:,GOST,12HMAЛO MЛ '133''231'
 T*BADLIB:,GOST,18H ИCПOPЧEH KATAЛOГ
 ЗOHA/:,GOST,12H
 ,GOST,1H'231'
 T*ERRC:,GOST,30HOШИБOЧHЫЙ CПИCOK ПAPAMETPOB'231'
 BIG*KT:,GOST,30HПEPEПOЛHEHИE KATAЛOГA OБCП !'231'
 PROGRAM:,TEXT,8HPROGRAM
 SVNEW:,BSS,1.
 FL/MAL:,BSS,1.
 SHIFT:,BSS,1.
 A HAЧ:,BSS,1.
 A/REF:,BSS,1.
 ADR/REF:,BSS,1.
 END//KAT:,BSS,1
 BEG*DFT:,BSS,1.
 TEK*ADR:,BSS,1.
 LG SM:,BSS,1.
 ЗAГOЛ:,BSS,1
 OБOЗH:,BSS,1
 KOMMEHT:,BSS,1.PEЗ*1
 PEЗ*2  :,BSS,1.
 SET:,BSS,1.
 DATA:,BSS,1.
 LONG/ID:,BSS,1.
 KOMAHДЫ:,BSS,1.
 BSS:,BSS,1.
 KOHCT:,BSS,1.
 P/UKAZ:,BSS,1.
 *OГPAH*:,BSS,1.
 W0001:,BSS,1.
 W0002:,BSS,1.
 W0003:,BSS,1.
 W0004:,BSS,1.
 W0005:,BSS,1.
 CBOБOДHO:,BSS,1
 FLDIAG:,BSS,1.
 COMMENT:,BSS,12.
 N/PERSO:,BSS,1.
 FL/TEMPO:,BSS,1.
 FL*TEMPO:,BSS,1.
 IWNEW:,BSS,1.
 LIST:,BSS,8
 ,END,MAKELIBT.
 MAKFIL/:,NAME,.CДYTO C MAK/FILE
 KCOUNT*:,LC,
 MONCARD*:,LC,
 *C:,ITS,13.
 ,ITS,7.
 ,ITS,
 7,BASE,*C.
 READL:,XTA,MONCARD*.
 ,AEX,=6H*END F
 ,UZA,BCE
 ,XTA,MONCARD*.
 ,AEX,=77751.
 ,UZA,BINARY*.
 14,VTM,CARD.
 ,ITS,14
 ,CALL,READ*.
 14,VTM,CARD.
 ,ITS,14
 14,VTM,SERV.
 ,ITS,14.
 ,CALL,TEMFILE
 ,UJ,READL.
 BCE:,XTA,=5H*READ
 ,ATX,CARD
 ,XTA,=3HOLD
 ,ATX,CARD+1
 14,VTM,CARD
 ,ITS,14
 14,VTM,SERV.
 ,ITS,14
 ,CALL,TEMFILE
C   ---  YCTAHOBKA HOBЫX YKAЗATEЛEЙ
 14,VTM,-1010.
 ,ITA,14
 ,ATX,KCOUNT*
 ,XTA,=10 0000 0006 0000
 ,ATX,KCOUNT*+1
 ,ATX,KCOUNT*+2
 ,CALL,MONREAD*
 ,STI,.
 ,STI,7
 ,STI,13.
 ,NTR,6.
 13,UJ,.
 SERV:,STI,.
 13,UJ,.
 BINARY*:14,VTM,MONCARD*.
 ,ITS,14.
 ,CALL,TWRBINC
 ,CALL,MONREAD*.
 ,UJ,READL.
 CARD:,BSS,14.
 ,END,MAK/FILE.
 MIXLOAD:,NAME,
C
C***** CБOPKA PAЗДEЛOB ПOЛЬЗOBATEЛЯ
C      C ФPAГMEHTAMИ TPП
C
 MONITOR*:,SUBP,
 RET MON:,EQU,MONITOR*+1
 LOADLIS*:,LC,
 ERROFLG*:,LC,
 DATA*:LC,BLOCK,D*(2)
 RM*:,LC,
C--------
 KCOUNT*:LC,BLOCK,KC*
 MONCARD*:LC,BLOCK,MC*
 SAV*47:,LC,1
 MONCARD/:LC,BLOCK,MC/(14)
 *MONCRD*:LC,BLOCK,*MC(14)
C--------
 MONREAD*:,SUBP,
 BLEXPRIN:,SUBP,
 PRINT8  :,SUBP,
 PARAMT* :,SUBP,
 STOP*:,SUBP,
  LIB:,EQU,73B
C--------
 SYSP:,WEQ,43B
 /NP:,P/P,(SYSP)16
C--------
 CAT      :  , EQU ,SYSP
 PGCL:,EQU,2000B
 /PG :,P/P,(PGCL)16
C--------
 *1:,BLOCK,N,M,AW,P
 *1:,BLOCK,CK,S,FP,ER
 *5:,BLOCK,B,EN,L,A,R,C,NL
 *9:,BLOCK,AA,TY,LI,LE(2),E
C--------
  KEQ:,EQU,75B
 /LPAR:,EQU,50B
 /RPAR:,EQU,51B
 /PLUS:,EQU,53B
 /COM :,EQU,54B
 /POI :,EQU,56B
  /TWOP:,EQU,72B
C
C--------------------------------------
C
 ,UTC,1
 OVERLAY*:,ENTRY,
 EN,VTM,
  ,*63,766B
  ,AEX,=6HOC ДYБ
  ,ATX,OSNAM
C
C*****   CБOPKA PAЗДEЛOB ПOЛЬЗOBATEЛЯ
C
C=====   ПAPAMETPЫ C KAPTЫ *CALL OVERLAY:...
 TY,VTM,0
 ,CALL,PARAMT*
  LI,UTM,-KEQ
  LI,VIM,ST/REGIM
C.....   ECЛИ BMECTO ":" YKAЗAHO "="
C        PAЗPEШAETCЯ PACCЫЛKA "BBEPX"
  ,XTA,
  ,CTX,DREAC
  ST/REGIM:,BSS,
C.....   ДOБYДEM YKAЗATEЛЬ
 AA,VTM,IT0
 TY,VTM,4
 ,CALL,PARAMT*
 E,V1M,ERRNZ
C.....   ДOБYДEM OГPAHИЧИTEЛЬ
 AA,VTM,LIM NZ
 TY,VTM,5
 ,CALL,PARAMT*
 E,V1M,ERRNZ
 ,ASN,64+9
 ,U1A,ERRNZ
C.....   ДOБYДEM KOMMEHTAPИЙ
 TY,VTM,1
 13,VTM,WRCOV
 ,UJ,PARAMT*
C/////   OШИБKA B ПAPAMETPAX
 ERRNZ:L,VTM,-8
 ,XTA,BLAN
 CL MC:L,ATX,*MC+8
 L,VLM,CL MC
 ,XTA,
 ,ATX,LIM NZ
C-----   ЗAПИCЬ ДATЫ , KOMMEHTAPИЯ
 WRCOV:,BSS,
 A,VTM,CAT1
  ,XTA,TOV
  A,ATX,1762B
  ,XTA,TOV+1
  A,ATX,1763B
  ,XTA,D*
  A,ATX,1764B
  ,XTA,D*+1
  A,ATX,1765B
  L,VTM,-8
  WRCOM:L,XTA,*MC+8
  L,UTC,8
  A,ATX,1766B
  L,VLM,WRCOM
C
C*****   ПOЛYЧEHИE CXEMЫ ЗAГPYЗKИ
C
 CK,VTM,0.ПPИЗHAK (...)
 FP,VTM,
 ER,VTM,0
 A,VTM,CAT1
  ,XTA,LIB
  ,ATX,CLIB
 ,UJ,R CA
C=====   ЧTEHИE И PAЗБOP OЧEPEДHOЙ KAPTЫ
 R CARD:,BSS,
 ,CALL,MONREAD*
C.....   ПPOBEPKA : TEKCTOBAЯ ЛИ
 R CA:12,VTM,1-14
 ,XTA,MC*
 ,ASN,64+40
 ,U1A,TEX C
C/////   KAPTA = HE TEKCTOBAЯ
 14,VTM,NONTEX
 13,VJM,PRIER
 ,SJ,
C.....   KAPTY ДЛЯ PARAMT*
 TEX C:12,XTA,MC*+13
 12,ATX,MC/+13
 12,VLM,TEX C
C.....   ПPOБA KOMMEHTAPИЯ
  13,VTM,R CARD
  ,XTA,MC/
  ,AEX,=6H<
  ,ASN,64+40
  ,UZA,PRI
C.....   ПPOБA '*END RECORD'
 ,XTA,MC/
 ,AEX,*EOR
 13,VTM,FIN
 ,UZA,PRI
 TY,VTM,9
 ,CALL,PARAMT*
 12,VTM,5
 13,VTM,PARAM
C.....   ПEЧATЬ BBEДEHHOЙ KAPTЫ
 PRI:14,VTM,MC/
 ,ITS,14
 14,UTM,13
 ,ITS,14
 ,ITS,12
 ,UJ,PRINT8
 PARAM:,BSS,
C-----   ЧTEHИE OЧEPEДHOГO ИMEHИ
 TY,VTM,3
 ,CALL,PARAMT*
  LI,UTM,-/TWOP
  LI,VZM,OWNLIB
  LI,UTM,/TWOP
 A,ATX,
 LI,MTJ,S
 R,VTM,NEXT
 S,V1M,NO EOC.HE KOHEЦ KAPTЫ
 LE,VZM,R CARD
 FP,VTM,1
 WRI:,BSS,
C-----   ЗAПИCЬ XAPAKTEPИCTИKИ
 R,UTC,
 LE,VZM,
 A,UTM,-CAT1
 A,V1M,WR
 ,XTA,PLUS
 ,ATX,PL*
 WR:,ITA,CK
 ,AEX,B1
 ,ASN,64-46
 ,AOX,PL*
 ,AOX,PLUS
 A,UTM,CAT1+2
 A,ATX,-1
 ,XTA,
 A,ATX,
 ,ATX,PLUS
 R,UJ,
 NEXT:LI,VZM,R CARD
 ,UJ,PARAM
 NO EOC:,BSS,
C-----   PAЗБOP CИMBOЛA-OГPAHИЧИTEЛЯ
 ,XTA,B48
 S,UTM,-/PLUS
 S,VZM,*PLUS.CИMBOЛ +
 ,XTA,B46
 S,UTM,/PLUS-/POI
 S,VZM,*POI.CИMBOЛ .
 E,V1M,MIST
 S,UTM,/POI-/LPAR
 LE,V1M,LEN1
 FP,VZM,MIST.= ПYCTOE ИMЯ
 LEN1:FP,VTM,
 S,VZM,*LPAR.CИMBOЛ (
 S,UTM,/LPAR-/RPAR
 S,VZM,*RPAR.CИMBOЛ )
 S,UTM,/RPAR-/COM
 S,V1M,MIST.ПЛOXOЙ OГPAHИЧ.
C-----   OГPAHИЧИTEЛЬ = ЗAПЯTAЯ
 CK,VZM,MIST
 ,UJ,WRI
 *PLUS:,BSS,
 *POI :,BSS,
C-----   OГPAHИЧИTEЛИ = ПЛЮC , TOЧKA
 ,ATX,BIT
 ,AEX,PLUS
 ,ATX,PLUS
 ,AAX,BIT
 ,UZA,MIST
 LE,VZM,NEXT
 E,V1M,MIST
 FP,VJM,WRI
 *LPAR:,BSS,
C-----   OTKPЫBAЮЩAЯ CKOБKA
 CK,V1M,MIST
 R,VJM,WRI
 CK,VTM,1
 ,UJ,NEXT
 *RPAR:,BSS,
C-----   ЗAKPЫBAЮЩAЯ CKOБKA
 CK,VZM,MIST.HE БЫЛO (
 R,VJM,WRI
 ,XTA,B45
 A,AOX,-1.  KOHEЦ
 A,ATX,-1.CKOБOЧHOЙ ГPYППЫ
 CK,VTM,
 ,UJ,NEXT
  OWN LIB:,BSS,
C.....   ЗAДAHИE CПИCKA БИБЛИOTEK
C        ДЛЯ ИЗBЛEЧEHИЯ PAЗДEЛA 2 YPOBHЯ
C        HAПPИMEP-    FORTRAN:41
C        K ЭTOMY MOMEHTY 2-Й YPOBEHЬ ДEPEBA
C        ЗAГPYЗKИ ДOЛЖEH БЫTЬ ИЗBECTEH.
  ,ATX,NAME
  ,CALL,NEWLIBR/
  14,VTM,CAT1
 13,VTM,-1761B
  S/NAM:14,XTA,
  ,AEX,NAME
  ,UZA,NAM/IS
  14,UTM,2
  13,VLM,S/NAM
  ,UJ,R CARD
C.....   HOMEPA БИБЛИOTEK (HE БOЛEE 4-X)
C        BПИCЫBAEM B 16-39 P. XAPAKT-KИ.
  NAM/IS:,XTA,LIB
  ,ASN,64-15
  14,AEX,1
  ,AAX,=0007 7777 7770 0000
  14,AEX,1
  14,ATX,1
  ,XTA,CLIB
  ,ATX,LIB
  ,UJ,R CARD
 MIST:,BSS,
C/////   OШИБKA B KAPTE CXEMЫ ЗAГPYЗKИ
 ER,VTM,1
 ,XTA,
 ,ATX,PLUS
 14,VTM,ERCA
 13,VTM,R CARD
 PRIER:,BSS,
C/////   П/П ПEЧATИ OШИБOK
 ,ITS,14
 14,UTM,3
 ,ITS,14
 14,VTM,1
 ,ITS,14
 ,UJ,PRINT8
 FIN:,BSS,
C=====   ПPИШЛA KAPTA '*END RECORD'
 ,CALL,MONREAD*
 CK,VZM,FIN1.= CKOБKИ ЗAKPЫTЫ
 ER,VTM,1
 14,VTM,ERPAR
 13,VJM,PRIER
 FIN1:ER,VZM,FIN2.= OШИБOK HE БЫЛO
 14,VTM,ERTA
 13,VTM,RET MON
 ,UJ,PRIER
 FIN2:,XTA,B45
 A,AOX,-1
 A,ATX,-1
 ,XTA,ERROFLG*
 13,VTM,STOP*
 ,U1A,BLEXPRIN
C
C*****   ФOPMИPOBAHИE BEKTOPA ЗAГPYЗKИ
C
 A,VTM,CAT1
C-----   CCЫЛKИ HA BEДYЩИE PAЗДEЛЫ
 VECT:A,UTM,2
 A,XTA,
 ,UZA,VECT1
 A,XTA,1
 ,AAX,B47.ЛEBAЯ ЧACTЬ
 ,UZA,VECT. = HET
C.....   ПOИCK ИMEHИ B ПPABЫX ЧACTЯX
 C,VTM,CAT1
 VEC:C,UTM,2
 C,XTA,
 ,UZA,VECT
 A,AEX,
 ,U1A,VEC.= HE COBПAЛO
 ,ITA,C
 ,ITS,A
 15,AEX,
 ,UZA,VEC.= ПPOBEP.ИMЯ
 C,XTA,1
 ,AAX,B47
 ,U1A,ERVECT
 ,ITA,A
 C,AOX,1.CTABИM CCЫЛKY
 C,ATX,1.HA ЛEBYЮ ЧACTЬ
 ,UJ,VEC
C/////   ПOBTOPHO OПИCAHA CXEMA PAЗДEЛA
 ERVECT:14,VTM,ПOBT
 13,VJM,PRIER
 ER,VTM,1
 ,UJ,FIN1
C-----   MИHИMИЗAЦИЯ ДEPEBA ЗAГPYЗKИ
 VECT1:A,VTM,CAT1
C===== ЗATЫЧKA CYПPOTИB HEKOPPEKTHOCTИ
C      Y BEPETEHOBA : ЧTEHИE (-2)-ГO CЛOBA
C      KATAЛOГA ПO KOHЦY CБOPKИ ПOCЛEДHEГO
C      PAЗДEЛA YPOBHЯ 2. B KATAЛOГ ПИШETCЯ
C..... ФИKTИBHЫЙ PAЗДEЛ 'MONITOR*'
 C,VTM,CAT+2
 ,XTA,MON*
 C,ATX,-2
C=====================================
 ,XTA,
 L,VTM,-1760B.ФИKT.XAP-KA
 VE1:L,ATX,CAT+1761B
 L,VLM,VE1
 L,VTM,-15B
 NL,VTM,2.YPOBEHЬ
C.....   ПEPBЫЙ PAЗДEЛ (YPOBEHЬ 1)
 A,XTS,
 C,ATX,
 A,XTA,1
 ,AAX,B48*46*L
 ,AOX,B1
 C,ATX,1
C.....   PEKYPCИBHOE ИЗBЛEЧEHИE BETBEЙ
 CH V:A,UTM,2
 C,UTM,2
 A,XTA,
 ,UZA,END BR
 C,ATX,
 A,XTA,1
 ,ATI,14
 ,AAX,B48*46*L
 ,ITS,NL
 15,AOX,
 C,ATX,1
 14,VZM,CH BR
C.....   ПOЙДEM HA ПOДCXEMY
 ,ITA,A
 ,ITS,NL
 ,ASN,64-15
 15,AOX,
 ,XTS,
 14,MTJ,A
 NL,VLM,CH V
C.....   ПPOBEPKA KOHЦA BETBИ
 CH BR:A,XTA,1
 ,AAX,B45
 ,UZA,CH V
C.....   KOHEЦ BETBИ
 END BR:,STX,
 ,UZA,TO LOAD
 ,ATI,A
 ,ASN,64+15
 ,ATI,NL
 ,UJ,CH BR
 TO LOAD:,BSS,
C
C*****   HACTPOЙKA CБOPKИ CTAT.PAЗДEЛOB
C
C.....   ПEPEПИCЬ ДATЫ, KOMMEHTAPИЯ
 TL 0: L,XTA,CAT1+1777B
 L,ATX,CAT+1777B
 L,VLM,TL 0
C.....   ПEЧATЬ ЗAГPYЗKИ / HET ПPИ CБOPKE
 ,XTA,44B
 ,ATX,R44
 ,XTA,SAV*47
 ,ATX,R47
 ,XTA,LOADLIS*
 ,U1A,TL 1
 ,XTA,44B
 ,ASN,64-1
 ,ASN,64+1
 ,ATX,44B
C.....   MЛ-AДPEC ПEPBOГO CTAT.PAЗДEЛA
 TL 1:,XTA,IT
 ,ASN,64-35
 ,ATX,XT
 C,VTM,CAT+2
 AW,VTM,SYSP
 ,ITA,AW
 ,ASN,64-26
 ,AOX,CHANGE
 ,ATX,CHANGE
C.....   ИHФOPMAЦИOHHЫE CЛOBA ЭK70 (MЛ)
 ,XTA,NP
 ,AOX,IT0
 ,ATX,IT0
 L,VTM,-1
 ,XTA,LIM NZ
 ,ATX,LNZ
 ,UZA,TL 2
 ,ARX,IT0
 ,ATX,LIM NZ
 TL 2:,XTA,IT0
 L,ARX,IT+1
 L,ATX,IT+1
 L,VLM,TL 2
C.....   YPOBEHЬ ЗAГPYЗKИ , AДPEC KATAЛOГA
 NL,VTM,1
  C,XTA,
  ,AEX,MON*
  ,U1A,NOMONIT
  14,VTM,MONITOR*-8
  ,XTA,RM*
  14,ATX,5
  ,XTA,RM*+1
  14,ATX,6
  ,ITA,14
  C,ATX,1
  C,UTM,2
  NL,UTM,1
  NOMONIT:,BSS,
C.....   CTPEЛKИ ЗAГPYЗKИ
 ,XTA,RM*
 ,ATX,16B
 ,XTA,RM*+1
 ,ATX,17B
C-----   ПEPEПИCЬ CБOPЩИKA B MAГAЗИH
 TL 5:,XTA,RM*+2
 ,ATI,15
 ,ATI,B
 B,UTM,10
 DIF:,EQU,ELOADER-LOADER
 L,VTM,-DIF
 ,NTR,3
 TL 6:L,XTA,ELOADER
 L,UTC,DIF
 B,CTX,
 L,VLM,TL 6
 B,UJ,
C=====   KOHCTAHTЫ-KOMAHДЫ
 NP:,,/NP
 ,,
C
C******************************************
C
 LOADER:B,REL,*
C
C*****   CБOPЩИK И ПИCATEЛЬ PAЗДEЛOB HA MЛ
C
 ,LOC,73413B
 C,XTA,
 ,UZA,KILL
 ,ITA,NL.YPOBEHЬ ЗAГPYЗKИ
 C,AEX,1.  ПOДXOДИT
 ,AAX,C37
 ,UZA,LOAD. = ДA
C=====   YHИЧTOЖEHИE PAЗДEЛA
 KILL:NL,UTM,-1
 NL,VZM,FIN LOAD
 C,MTJ,14
C.....   ПOИCK HEYHИЧTOЖEHHOГO
 SE*OV:14,UTM,-2
 14,XTA,1
 ,AAX,B47
 ,U1A,SE*OV
C.....
 14,XTA,1
 ,AOX,B47.- YHИЧTOЖИM
 14,ATX,1
  14,XTA,
  ,AEX,MON*
  ,UZA,SE*OV2
 SE*OV1:14,UTM,-2
 14,XTA,1
 ,AAX,B47
 ,U1A,SE*OV1
  SE*OV2:,BSS,
 14,XTA,1
 ,ATI,14.AДPEC PAЗДEЛA
C.....   BOCCTAHOBИM CTPEЛKИ ЗAГPYЗKИ
 14,XTA,5
 ,ATX,16B
 14,XTA,6
 ,ATX,17B
 ,UJ,LOADER
 LOAD:,BSS,
C
C=====   ЗAГPYЗKA PAЗДEЛA
C
C
C===== BЫKИHYTЫ MAHИПYЛЯЦИИ CO CTPEЛKAMИ
C      ЗAГPYЗKИ, KOTOPЫE ДЛЯ OVERLAY HE
C      HYЖHЫ (TOЛЬKO ДЛЯ COLLECT).
C
 C,XTS,
 ,XTS,17B
 ,ATI,14
 14,ATX,2.CTAPAЯ 17B
 ,ARX,C10
 ,ATX,17B
 ,ITA,14
 ,ATX,AP
 ,DRUM,46B.CПAC.OБM.ЛИCTA
 ,DRUM,61B.ЧTEH.ЗAГPYЗЧИKA
C
C====  CЛEДYЮЩAЯ ПAPA KOMAHД ЗAБИBAETCЯ
C      HYЛEM, ECЛИ B KAPTE BЫЗOBA
C      BMECTO ":"  CTOИT  "="
C
  DREAC:,BSS,
 ,XTA,.PEAKЦИЯ HA DATA
 ,ATX,51B.  BBEPX
  15,XTA,
 13,VJM,SYSP+2.HA ЗAГPYЗЧИK
C-----   ДOДEЛAEM CЛYЖEБHЫE CЛOBA
 ,WTC,AP
 P,VTM,
 ,XTA,16B
 P,ATX,5.HOBAЯ 16B
 ,XTA,17B
 P,ATX,6.HOBAЯ 17B
 ,XTA,
 NL,UTC,-1
 14,VTM,
 14,VZM,FIR*LEV
 14,UTM,-1
 14,VZM,FIR*LEV
 C,MTJ,14
 SEOV:14,UTM,-2
 14,XTA,1
 ,AAX,B47
 ,U1A,SEOV
 14,XTA,1
 ,AAX,C77777
 ,ASN,64-15
 C,UTM,-CAT
 ,ITS,C
 C,UTM,CAT
 15,AOX,
 ,ASN,64-15
 FIR*LEV:,AOX,15B
 P,ATX,7
C
C=====   ЗAПИCЬ PAЗДEЛA HA ЛEHTY
C
C.....   HACTPOЙKA ЗAПИCИ
 ,ITA,P
 P,XTS,6
 ,AAX,C77777
 15,A-X,
 ,ATI,L.ДЛИHA P-OБЛACTИ
C.....   ПOДГOTOBИM XAP-KY B CTAT.KATAЛOГE
 ,ASN,64-15
 ,AOX,AP
 ,AOX,XT
 C,XTS,1
 ,AAX,B48
 15,AOX,
 C,ATX,1
C.....   ПEPEД ЗAПИCЬЮ PAЗДEЛA HA ЛEHTY
C        "OБMEHЯEM" OБM.ЛИCT C 47 ФOPM.
  14,VJM,P/CHAN
C-----   ПOЛYЧEHИE COSY-VOLKOV
 PRESS:L,VZM,MIX
 N,VTM,.CЧETЧИK HECOBП.
 M,VTM,.CЧETЧИK COBПAД.
 P,MTJ,A
C.....   ПOИCK COBПAДAЮЩEЙ ГPYППЫ
 SE/EQ:L,MTJ,14
 14,UTM,-1.OCTAЛOCЬ
 14,VZM,WRI0.- 1 CЛOBO
 A,XTA,
 A,AEX,1.COBПAЛO
 ,U1A,NEQ. = HET
 A,XTA,
 ,UZA,EQU.HOЛЬ-ЭKOHOMИM
 14,UTM,-1.OCTAЛOCЬ
 14,VZM,NEQ.- 2 CЛOBA
 A,XTA,.ПO HEHYЛЯM
 A,AEX,2.MИHИMYM =
 ,UZA,EQU.3 COBПAДEHИЯ
 NEQ:N,UTM,1.CЧET.HECOBП.
 L,UTM,-1.OБЩAЯ ДЛИHA
 A,VLM,SE/EQ
 EQU:M,UTM,1.CЧET.COBПAД.
 L,UTM,-1.OБЩAЯ ДЛИHA
C.....   ПOИCK KOHЦA COBП.ГPYППЫ
 EQU1:L,VZM,WRI1
 A,XTA,
 A,AEX,1
 ,U1A,WRI1
 M,UTM,1
 L,UTM,-1
 A,VLM,EQU1
C-----   ЗAПИCЬ ПOЛHOЙ ГPYППЫ C XAP-KOЙ
 WRI0:N,UTM,1
 L,UTM,-1
C.....   ПOЛYЧEHИE XAPAKTEPИCTИKИ
 WRI1:,XTA,
 ,ATX,ETAL
 M,VZM,WRIS.HE БЫЛO COBП.
 A,XTA,
 ,ATX,ETAL
 ,UZA,WRIS.ЭTAЛOH = 0
 ,XTA,B48
 WRIS:,ITS,N
 15,AOX,
 ,ITS,M
 ,ASN,64-15
 15,AOX,
 R,VJM,WORD.ЗAПИCЬ XAP-KИ
 ,XTA,ETAL
 ,UZA,LWRI
 R,VJM,WORD.ЗAПИCЬ ЭTAЛOHA
C.....   ЗAПИCЬ HECOBПAДAЮЩИX
 LWRI:N,VZM,EWRI
 P,XTA,
 N,UTM,-1
 R,VJM,WORD
 P,VLM,LWRI
 EWRI:M,J+M,P
 ,UJ,PRESS
 FINI:NL,UTM,1
C.....   PAЗДEЛ YПИCAH. "OБMEHЯEM OБPATHO"
C        OБM.ЛИCT И 47-Й ФOPMAЛЬHЫЙ.
 C,UTM,2
  14,VTM,LOADER
C
C.....  "ЗAMEHA CTPAHИЦ" MEЖДY OБM.ЛИCTOM
C       /NP И ФOPMAЛЬHЫM ЛИCTOM 47
C       (ДЛЯ OC ДИCПAK = MБ 27037)
C
  P/CHAN:,ITA,14
  ,XTS,OSNAM
  ,U1A,DISPAC
  ,*72,CHANGE
  15,WTC,
  ,UJ,
  DISPAC:,XTA,CHAN/D
  ,AEX,B40
  ,ATX,CHAN/D
  ,AAX,B40
  :,UZA,*+1
  ,*70,46B.ЗAПИCЬ
  :,*70,CHAN/D
  ,XTA,CHAN/D
  ,AAX,B40
  :,U1A,*+1
  ,*70,45B.ЧTEHИE
  :15,WTC,
  ,UJ,
  CHAN/D:,000,/NP
  ,027,37B
  OSNAM:,LOG,
C
C
 MIX:,BSS,
C-----   ЗAПИCЬ ФPAГMEHTA TPП ДЛЯ
C        ДAHHOГO PAЗДEЛA
 EN,VZM,FINT
 M,VTM,PGCL-2
 N,VTM,
 R,VTM,SRC
 ,XTA,C10
 ,ARX,AP
 ,ATX,AP
 ,AEX,17B
 ,AAX,C77777
 ,UZA,VOID FR.ПYCTOЙ PAЗДEЛ
 ,DRUM,SAV P1
 G 2W CL:,BSS,
C-----   П/П "ДAЙ CЛEД.2 CЛOBA TPП"
 M,UTM,2
 ,ITA,M
 ,AAX,C1777
 R,U1A,
 N,DRUM,LDCR
 N,UTM,1
 M,VTM,PGCL
 R,UJ,
 SRC:,BSS,
 M,XTA,1
 ,AEX,AP
 ,AAX,C77777
 ,U1A,G2WCL
 ,XTA,FRAG TPП
  R,VJM,WORD.ПP-K ФP-TA TPП
 ,ITA,M
 ,AAX,C1777.N CЛOBA ПO ЛИCTY
 ,ITS,N.N ЛИCTA + 1
 ,ASN,64-15
 15,AOX,.XAPAKTEPИCTИKA
 R,VJM,WORD.ФPAГMEHTA TPП
 ,XTA,17B.
 ,ASN,64+30
 ,ITS,M
 ,AAX,C1777
 ,ITS,N
 ,A-X,B1
 ,ASN,64-10
 15,AOX,
 15,X-A,.ДЛИHA ФP-TA
 ,ASN,64+1./2
 ,AEX,C77777
 ,ATI,L
 L,UTM,2. ДЛЯ ,VLM,
 COP FR:,BSS,
 M,XTA,
 R,VJM,WORD
 M,XTA,1
 R,VJM,WORD
 R,VTM,COP FR
 L,VLM,G 2W CL
 ,UJ,END WR FR
 VOID FR:R,VTM,FINT
 ,UJ,WORD.
 END WRFR:,BSS,
 ,XTA,.KOHEЦ ФPAГMEHTA
 R,VJM,WORD. - HYЛEBOE CЛOBO
 ,DRUM,RES P1
C-----   KOHEЦ PAЗДEЛA , ДOПOЛHИM 40-KY
 FINT:,ITA,AW
 ,AAX,C37
 ,UZA,FINI
 ,XTA,
 R,VTM,FINT
 WORD:,BSS,
C=====   П/П : ЗAПИCЬ CЛOBA HA ЛEHTY
 AW,ATX,
 AW,UTM,1
 ,XTA,XT
 ,ARX,B26
 ,ATX,XT
 ,ITA,AW
 ,AAX,C1777
 R,U1A,
 ,XTA,IT
 ,AEX,LIM NZ
 ,U1A,CH LIM
 ,ATX,LIM NZ
 CH LIM:AW,UTM,-1024
 ,XTA,LIM NZ
 ,UZA,NO TAP
 ,TAPE,IT
 NO TAP:,XTA,B1
 ,ARX,IT
 ,ATX,IT
 R,UJ,
 FIN LOAD:,BSS,
C
C*****   ЗABEPШEHИE PAБOTЫ CБOPЩИKA
C
C.....   ПPOБЫ HA ДOCБPOC БYФEPA
 AW,UTM,-SYSP
 AW,VZM,FLO 1.ЛИCT = ПYCT
 ,XTA,LIM NZ
 ,UZA,FLO 1.БЫЛO MAЛO MЛ
 ,AEX,IT
 ,U1A,CБPOC
 ,XTA,.HACTYПИЛO MAЛOMЛ
 ,ATX,LIM NZ
 ,UJ,FLO 1
  CБPOC:14,VJM,P/CHAN
  ,TAPE,IT
  14,VJM,P/CHAN
 FLO 1:C,VTM,CAT
C.....   ПEPEПИCЬ KATAЛOГA OVERLAY
 P,VTM,SYSP-2
 P,MTJ,A
  C,XTA,2
  ,AEX,MON*
  ,U1A,FLO 3
  C,UTM,2
 FLO 3:,BSS,
 C,UTM,2
 P,UTM,2
 C,XTA,1
 ,AAX,Z47/46
 EN,VZM,FLO 4
C.....   ПPOCTABИM B46 - ПPИЗHAK MIXLOAD
 ,AOX,B46
 FLO 4:,BSS,
 P,ATX,1
 C,XTA,
 P,ATX,
 ,U1A,FLO 3
 ,XTA,XT.XAPAKTEPИCTИKA
 P,ATX,1. 'CBOБOДHO'
 P,VTM,SYSP
 ,XTA,LIM NZ
 E/OVER:P,ATX,1777B
 ,TAPE,ITC
 ,XTA,LIM NZ
 ,U1A,HE MAЛ
 A,VTM,TMAЛ
 ,PRINT,INFPR
 HE MAЛ:,XTA,XT
 ,AUX,UPM
 ,AOX,CGT
 A,VTM,TДЛИ
 A,ATX,3
 ,PRINT,INFPR
 ,XTA,R44
 ,ATX,44B
 ,XTA,B1
 ,ATX,KC*+2
 ,XTA,R47
 ,ATX,47B
  ,XTA,CLIB
  ,ATX,LIB
 ,UJ,RET MON
 INF PR:A,,
 A,,
 :0,001,
 8,,
 FRAG TPП:,TEXT,8HFRAG TPП
 CHANGE:,OCT,10 00 47 77
 LDCR:,010,/PG
 ,020,
 ,010,/PG
 ,020,1
 SAV P1:,,/PG
 ,020,26B
 RES P1:,010,/PG
 ,020,26B
C((((((((
 IT0:,LOG,60 0000
 IT:,LOG,1
 ITC:,LOG,0
C))))))))
 XT:,BSS,1
 LIM NZ:,LOG,1000
 LNZ:,BSS,1
 Z47/46:,LOG,4777 7777 7777 7777
 B48:,OCT,4
 B47:,OCT,2
 B46:,OCT,1
  B40:,OCT,001
 B26:,OCT,0000 0002
 C77777:,LOG,77777
 C1777:,LOG,1777
 C37:,LOG,37
 C10:,LOG,10
 B1:,LOG,1
 MON*:,TEXT,8HMONITOR*
 TMAЛ:,GOST,18H***  MAЛO MЛ  ***'231'
 TДЛИ:,GOST,25HДЛИHA БИБЛИOTEKИ  077 37'231'
 UPM:,GOST,6H'367'77037
 CGT:,GOST,6H000 00
  CLIB:,BSS,1
 R44 :,BSS,1
 R47:,BSS,1
 ETAL:,BSS,1
 AP  :,BSS,1
 ELOADER:,BSS,1
C******************************************
 ,LOC,*
 NONTEX:,ISO,24HHETEKCTOBAЯ KAPTA
 ERCA  :,ISO,24HOШ.KAPTA CXEMЫ ЗAГPYЗKИ
 ERPAR :,ISO,24HHET ЗAKPЫBAЮЩEЙ CKOБKИ
 ПOBT  :,ISO,24HПOBTOP.OПИCAHИE ДEPEBA
 ERTA  :,ISO,24HБЫЛИ OШИБKИ B ЗAДAHИИ
 TOV:,ISO,12HOVERLAY OT
 BLAN:,ISO,6H
 *EOR:,ISO,6H*END R
  B48*46*L:,OCT,5007 7777 7770 0000
 B45:,OCT,04
C--------
 PLUS:,BSS,1
 PL*:,BSS,1
 BIT :,BSS,1
  NAME:,BSS,1
 CAT1:,BSS,1024
C--------
 ,END,
 MT*BATCH:,NAME,.11/02/81
 MONCARD/:,LC,14
 CHE*NAM:,SUBP,
 FINISHER:,SUBP,
 ORDERS*:,SUBP,
 XNT:,LC,1
  MT/FLAG:,LC,1
 OUT*OUT*:,LC,1
 STARSTA:,LC,1
 *TEMA*:,LC,1
 *FLAG*:,LC,13
 *ORDEN:,LC,128
 *DECLARA:,LC,57
 *MONCRD*:,LC,12
 MIST10*:,LC,3
  *PAGES:PC,BLOCK,PAGE(1024)
 LI:,P/P,(PAGE)16
 *1:,BLOCK,LC,(5),B
  ,UTC,MT/FLAG
  ,XTA,
  ,ATX,NAME +1
  ,U1A,NO MT
  14,VTM,NAME
  ,ITA,14
  ,FUN,64B
  NO MT:,XTA,NAME +1
  ,AEX,AREAD -1
  ,ATX,AREAD -1
 ,*70,IDR
 LC,VTM,-1024
 ,ITA,LC
 ,ATX,S/LC
 ,*65,761B
 ,ATI,12
 ,*65,502B
 ,ATI,11
 11,*65,
 ,ASN,64-6
 ,YTA,
 ,ATI,11
 11,UTC,
 12,*65,-40B.*INFBA
 ,ASN,64+36
 ,AAX,=37
 ,UTC,XNT
 ,ATX,
 14,VTM,AREAD
 ,ITA,14
 ,CALL,CO*BATCH
 14,V1M,ER/BATCH
 12,VTM,TGD
 ,AUX,=6H'''''''7''7'''
 ,AOX,=6HA: 00''
 12,ATX,3
  ,XTA,NAME +1
  ,U1A,STOP
 OUT/MT:,XTA,=7777 7777 7777 7777
 ,*57,4000B
 ,*71,IW71/I
 ,*62,
 ER/BATCH:,ITA,14
 ,ASN,64-1
 ,AAX,=17
 ,ATI,14
 12,VTM,TEB
 14,XTA,TERS-2
 12,ATX,2
 14,XTA,TERS-1
 12,ATX,3
  ,XTA,NAME +1
  ,UZA,OUT/MT
  ,ITS,12
  12,UTM,3
  ,ITS,12
  ,XTS,=1
  ,CALL,PRINT8
  STOP:,*62,
 ,LOG,1 000 000.NLAБ=MT
 AREAD:,ITA,LC
 ,XTS,S/LC
 ,ATI,LC.=1 IR
 12,VTM,-13
 RE 1:LC,VLM,RE 2
 LC,VTM,-1023
  ,XTA,IDR
 ,ARX,=1
 ,ATX,IDR
 ,*70,IDR
 RE2:LC,UTC,PAGE+1023
 ,XTA,
 12,ATX,MONCARD/+13
 ,AAX,=377
  ,AEX,=12
 ,UZA,OUT
 12,VLM,RE 1
 ,MOD,
 OUT:,ITA,LC
 ,ATX,S/LC
 14,VTM,1
 ,XTA,MONCARD/
 ,AEX,SILINSE
 ,U1A,NEXT
 14,VTM,0.KOHEЦ ПAKETA
 NEXT:,STX,
 ,ATI,LC
 13,UJ,
 TGD:,ISO,24HПAKET B ФAЙЛE BBOДA: XX''
 TEB:,ISO,12H *** OTKAЗ:
 ,CONT,12H
 ,LOG,
 TERS:1,ISO,12HOШ. BBOДA''
 2,ISO,12HOШ. B ПACП.''
 3,ISO,12HHET ПK *NAME
 4,ISO,12HABAPИЯ''
 5,ISO,12HOШ. CИCTEMЫ''
 6,ISO,12H ... ''
 7,ISO,12H ... ''
 IW71/I:12,Z04,
 ,Z00,
 IDR:,Z01,LI
 ,001,
 SILINSE:,GOST,6H'377'0000'12'
 NAME:,ISO,6HMT/ПB''
 ,LOG,0
 ,LOG,0
 S/LC:,BSS,1
 ,END,
  MT*OБMEH:,NAME,
 PASS:,LC,1
 ERMTRED:,SUBP,
  MATINFEX:,LC,1
  *PAGES:PC,BLOCK,(1024),PW(1024)
  NL:,P/P,(PW)16
  IWMTNRS:,EQU,776B
  ,UTC,ZL
C    W/R , ЛИCT , ЗOHA ДO 777
  ,ATX,
  SE*MTBUF:,ENTRY,
C... ПOИCK БYФEPA MT
  HAЧ:,BSS,
  ,ITS,7
  7,BASE,HAЧ
  ,ITS,9
  ,XTS,NAMEMT.YЖE ЗHAEM
 ,AEX,=7777 0077 7777 7777.ГДE БYФEP
  ,UIA,NOFIRST.  -ДA
  ,ATX,NAMEMT. MБ
  ,UTC,MATINFEX
  ,XTA,
  ,AAX,=20000
  ,ATX,FLTAPE
  ,UZA,ЛEHTA
  ,*63,IWMTNRS
  ,AAX,=7777 0077 7777 7777
  ,AOX,DRLIST
 ,ATX,S.ЧИTAEM
 ,*70,S.*DRUMUS
  ,WTC,PW
 9,VTM,PW-2000B
 ,ITA,9
 ,ATX,A/DRUMUS
 L DR:9,XTA,
 ,UZA,ON CH
 9,UTM,1
 ,UJ,L DR
 ON CH:,ITA,9
 ,ATX,W2.=KOHEЦ DRUMUS
 ,NTR,3.BИTЯ ПOЖAЛEЛ !
 ,X-A,A/DRUMUS
 ,UZA,ER
 ,ATI,14.ДЛИHA B ДOП.K
 L CH:9,UTM,1
 9,XTA,.PASS-TEXT
 ,UZA,ER
 ,UTC,PASS
 ,AEX,
 ,ASN,64+12
 ,UZA,BUF.HA 7/M
 14,VLM,L CH
 ER:14,VTM,4.HET БYФEPA
 ,UJ,ERMTRED
 BUF:,ITA,14
 ,ARX,W2
 ,ATI,9.AДPEC HAШEГO DR
  9,XTA,
  ,AUX,=77 0777.HAЧAЛO БYФEPA
  9,XTS,
  ,ASN,64-3.KOHEЦ БYФEPA
  ,AAX,=777 000 000
  15,AOX,
  ,AOX,=:0004
  ,ATX,S
 ,ATX,W2.ГPAH.БYФ HA MБ
  ,AAX,=77 0000
  ,U1A,RETDR
C...  MOДEЛЬ
 ,XTA,S
 ,AOX,=:1.MOДEЛЬ K ФИЗ
 ,ATX,S
 ,ATX,W2.ГPAHИЦЫ БYФEPA
  ,XTA,MTNAME
  ,ATX,NAMEMT
 CHECK:,*57,400B
 ,UZA,ER
  ,ASN,64-12
 ,XTS,S
 ,AAX,=7777 7777 7700 7777
 15,AOX,
 ,ATX,S
C...HA BЫXOДE - 0, ECЛИ HE HAШЛИ
C...1-9 - HAЧAЛO БYФEPA
C...13-18 - ФИЗ. N YCTPOЙCTBA
C...19-27 - KOHEЦ БYФEPA
C...BCEГДA 39-Й PAЗPЯД
C...A ECЛИ MOДEЛЬ-TO И 46-Й
C   ДЛЯ MЛ  46=39=0 - ПO MAT.HOMEPY 37
  RETDR:,BSS,
  ,XTA,ZL
 ,U1A,CH EX.HE ПOBTOPHO ЛИ
 ,XTA,S
 ,AAX,=1004 00 0777 77 0777.N ЛИCT = 00
 ,ATX,S
 ,UJ,WRET
 CH EX:,BSS,
 ,AEX,S.=OLD WORD
C  BHИMAHИE: HE OБMEHИBATЬ ЛИCT 00 C ЗOHOЙ 000
 ,UZA,WRET.ПOBT.OБMEH
 ,XTA,ZL
 ,AAX,=6773 7777 7700 0777
 ,XTS,S
 ,AAX,=:7767 0077 7777
  15,AOX,
 ,ATX,S
 ,*70,S
  WRET:,XTA,
  ,STX,ZL
  ,STI,9
  ,STI,7
 ,UTC,S
  ,XTA,
  13,UJ,
  NOFIRST:,BSS,
  ,XTA,FLTAPE
 ,U1A,NON TP
 ЛEHTA:,ATX,NAMEMT
 ,XTA,=777 37 0000.CTAHД.ГPAH
 ,ATX,S
 ,UJ,RETDR
 NON TP:,BSS,
 ,XTA,W2.ГPAHИЦЫ БYФEPA
 ,ATX,S
C...ПOИCK ФИЗ.YCTP-BA ПPOИCXOДИT
C..HA CЛYЧAЙ BOЗMOЖHOЙ ПEPECTAHOBKИ
  ,XTA,NAMEMT
 ,U1A,CHECK.7/M
 ,UJ,RETDR.ФИЗ MБ
  OБPYK*MT:,ENTRY,
C...ПOЛYЧEHИE ИHФ.CЛOBA ИЗ YKAЗATEЛЯ
  ,ASN,64-16
  ,UTC,W1
  ,ATX,
  ,ITS,7
  7,BASE,HAЧ
  ,XTS,
  HOPMA:,XTA,W1
  ,AAX,=370
  ,AEX,=60
  ,UZA,CALCNZ
  ,XTA,W1
  ,ASN,64+8
  ,ATX,W1
  ,UIA,HOPMA
 14,VTM,0.ПЛOX.YKAЗ-ЛЬ
  ,UJ,ERMTRED
  CALCNZ:,XTA,W1
  ,APX,=6H'''''''7''7''7'
  ,ASN,64+39
  ,ATX,W1
  13,MTJ,7
  13,VJM,HAЧ
  7,MTJ,13
 7,BASE,HAЧ
C  ПPOBEPKA HOMEPA ЗOHЫ ПO ГPAHИЦAM БYФEPA:
  14,VTM,4
  ,UZA,ERMTRED
  ,ARX,W1
  ,ATX,W1
 14,VTM,8.ПEPEПOЛH.БYФEP
  ,AAX,=777
  ,XTS,W1
  ,ASN,64+18
  ,AAX,=777
  ,ARX,=1
 ,NTR,3
  15,A-X,
  ,UIA,ERMTRED
  ,XTA,FLTAPE
  ,ASN,64+13
C  KOPPEKTИPOBKA: ДЛЯ 7/M =1
  ,X-A,W1
  ,STX,W1
  ,STI,7
  ,UTC,W1
  ,XTA,
  13,UJ,
 NAMEMT:,LOG,7777 0077 7777 7777
  MTNAME:,TEXT,8HM      '7'
  DRLIST:,,NL
  ,,
  W1:,BSS,1
  W2:,BSS,1
 ZL:,BSS,1
 A/DRUMUS:,BSS,
 S:,BSS,1
  FLTAPE:,BSS,1
  ,END,
 MT*PUNCH:,NAME,.13/02/81
 MONCARD/:,LC,14
 PUNCTABL:,SUBP,
 COLPUNC*:,SUBP,
 TRANSFIO:,SUBP,
 ISO*TEX*:,SUBP,
 REV CARD:,SUBP,
  MATINFEX:,LC,1
  *PAGES:PC,BLOCK,PAGE(1024)
 LI:,P/P,(PAGE)16
C
C  ПEPФOPAЦИЯ KOЛOДЫ C ЛИCTA BЫПOЛHEHHЫX
C     PEДAKЦИЙ ( ЛИCTA ЗAПИCИ HA MБ )
C
 12,VTM,NAME
 ,ITA,12
 ,*50,64B.ЗAПИCЬ NAME
C
C  ПEPEПИCЬ ФИO (ГOCT) ИЗ ИПЗ, ПEPEKOДИPOBKA B ISO
 ,*50,70100B+566B.ФИO
 ,CALL,TRANSFIO
 ,ATX,ISO1
 ,*50,70100B+567B.ФИO+1
 1,VTM,ISO1
 ,CALL,TRANSFIO
 ,AAX,=:77777 4
 ,ATX,ISO1+1
 ,XTA,
 ,ATX,ISO1+2.KOHEЦ
 ,ITS,1
 1,VTM,TEK
 ,CALL,COLPUNB*.HAЧ.YCTAHOBKA
 ,ITS,1
 ,CALL,ISO*TEX*
 12,VTM,
 13,VTM,-16
 CYCL:1,XTA,
 12,ASN,64+41.*2
 ,AAX,=176
 ,ATI,10
  ,UTC,PUNCTABL
  10,XTA,
 13,ATX,CARD+16
  ,UTC,PUNCTABL
  10,XTA,1
 13,ATX,CARD+17.16+1
 12,UTM,-6
 13,UTM,2
 13,V1M,CYCL
 1,VTM,BINARY
 ,ITS,1
 14,VTM,CARD
 ,ITS,14
 ,CALL,REVCARD.ПOBOPOT П/K
 ,ITS,1
 ,CALL,COLPUN*B.MAKET ФИO-ШAПKИ
C  ГOTOBИM БYФEP:
 1,VTM,-1024
 ,*70,IDR
 LOOP P:2,VTM,MONCARD/.HAЧAЛO П/K
  3,VTM,-13
  RE 1:1,VLM,RE 2
  1,VTM,-1023
  ,XTA,IDR
  ,CALL,DRUMTAP*
  ,ATX,IDR
  ,*70,IDR
  RE 2:1,UTC,PAGE+1023
  ,XTA,
  3,ATX,MONCARD/+13
  ,AAX,=377
  ,AEX,=12
  ,U1A,END
  3,VTM,
  2,XTA,
  ,AEX,=6H'377''''''''''12'
  ,UZA,END
  2,XTA,
  ,AEX,=6H*READ
  2,XTS,1
  ,AEX,=6HOLD'312''12''12'
  15,AOX,
  ,UZA,END
 ,ITS,2
 ,CALL,COSYTISO
 ,ITS,2
 13,VTM,LOOP P
 ,UJ,COLPUNC*
  END:3,VLM,RE 1
  ,CALL,COLPUNE*
C
C
  MT*FINAL:,ENTRY,
  ,*71,OUT
  STOP:,SJ,
  OUT:,Z04,MESS
  ,,
  MESS:,ISO,12HГOTOBO.''
 IDR:,010,LI
 ,001,
 NAME:,ISO,6HMT/ПФ''
 ,LOG,0
 ,LOG,0
 ISO1:,BSS,3
 TEK:,BSS,1
 BINARY:,BSS,24
 CARD:,BSS,20
 ,END,
      MT/RED     :,NAME,
 MONCARD/:,LC,14
      *MONCRD*   :,LC,  30B
      OUT*OUT    :,LC,  1
      PARAMT*    :,SUBP,
LL207:,P/P,       (74000B    )20B
             1 ,  VTM,   *00116
            13 ,  VJM,   *00106
                 ,ITA,  1
                 ,ATX,  OUT*OUT
                 , *72,  *00173
 *00003    : 1 ,  VTM,   *00124
            13 ,  VJM,   *00106
 *00004    :13 ,  VJM,   *00104
            10 ,  VTM,  9
            13 ,  VJM,  PARAMT*
            10 ,  VTM,  3
            13 ,  VJM,  PARAMT*
            14 ,  VTM,  77773B
                 ,UTC,
 *00010    :     ,XTA,  *MONCRD*
            14 ,  AEX,   *00136
                 ,ASN,  130B
                 ,UTC,  5
            14 ,  UZA,   *00015
            14 ,  VLM,   *00010
 *00013    : 1 ,  VTM,   *00127
            13 ,  VJM,   *00106
                 , UJ,   *00004
                 ,UTC,
 *00015    :10 ,  VTM,  5
                 , UJ,   *00027
            10 ,  VTM,  5
                 , UJ,   *00036
            10 ,  VTM,  5
                 , UJ,   *00071
                 , UJ,   *00025
                 ,UTC,
                 ,XTA,   *00142
                 ,UZA,   *00023
                 , *70,  *00143
 *00023    : 1 ,  VTM,   *00113
            13 ,  VJM,   *00106
                 , *62,
 *00025    :     , *70,  *00143
                 , UJ,   *00003
                 ,UTC,
 *00027    : 9 ,  VTM,   *00142
            13 ,  VJM,  PARAMT*
                 ,AAX,   *00166
                 ,AOX,   *00112
                 ,ATX,   *00142
                 ,AEX,   *00162
                 ,ATX,   *00143
                 , *70,  *00142
                 , UJ,   *00003
                 ,UTC,
 *00034    :     ,XTA,   *00140
                 ,ATX,   *00137
                 , UJ,   *00043
                 ,UTC,
 *00036    : 9 ,  VTM,   *00140
            13 ,  VJM,  PARAMT*
                 ,ASN,  112B
                 ,UIA,   *00013
            11 ,  VZM,   *00034
            10 ,  VTM,  5
             9 ,  VTM,   *00137
            13 ,  VJM,  PARAMT*
                 ,ASN,  112B
                 ,UIA,   *00013
 *00043    :     ,WTC,   *00140
                 ,XTA,  74000B
            13 ,  VJM,   *00052
                 ,XTA,   *00140
                 ,AEX,   *00137
                 ,UZA,   *00003
                 ,XTA,   *00140
                 ,ARX,   *00167
                 ,ATX,   *00140
                 ,AEX,   *00163
                 ,UZA,   *00003
                 , UJ,   *00043
                 ,UTC,
 *00052    :13 ,  MTJ,  2
                 ,XTS,   *00140
                 ,ASN,  32B
                 ,AUX,   *00174
                 ,AOX,   *00165
                 ,STX,   *00156
            11 ,  VTM,  77777B
                 ,UTC,
 *00056    :     ,ATX,   BSS+ 0000B
                 ,APX,   *00164
                 ,AUX,   *00167
                 ,AEX,   *00167
                 ,ATI,  14
                 ,XTA,   BSS+ 0000B
            14 ,  AUX,   *00144
            14 ,  AOX,   *00146
                 ,ATX,   *00157
                 ,XTA,   BSS+ 0000B
            14 ,  APX,   *00150
            14 ,  AUX,   *00152
            14 ,  AOX,   *00154
                 ,ATX,   *00160
             1 ,  VTM,   *00156
            13 ,  VJM,   *00106
                 ,XTA,   *00175
                 ,ATX,   *00156
                 ,XTA,   BSS+ 0000B
                 ,ASN,  50B
            11 ,  VLM,   *00056
             2 ,   UJ,
 *00071    : 9 ,  VTM,   *00141
            13 ,  VJM,  PARAMT*
                 ,ASN,  112B
                 ,UIA,   *00013
            10 ,  VTM,  6
            13 ,  VJM,  PARAMT*
                 ,XTA,  *MONCRD*
                 ,APX,   *00171
                 ,ATX,   BSS+ 0000B
L                ,XTA,   *MONCRD*  +1
                 ,APX,   *00170
                 ,ASN,  117B
                 ,AOX,   BSS+ 0000B
                 ,ATX,   BSS+ 0000B
L                ,XTA,   *MONCRD*  +2
                 ,APX,   *00172
                 ,ASN,  136B
                 ,AOX,   BSS+ 0000B
                 ,WTC,   *00141
                 , *75, 74000B
                 , UJ,   *00003
                 ,UTC,
 *00104    :     , *71,  *00110
            13 ,   UJ,
                 ,UTC,
 *00106    :     , *71,  *00111
            13 ,   UJ,
                 ,UTC,
 *00110    :     , Z06, MONCARD/
                 ,ATX,
 *00111    : 1 ,  ATI,
                 ,ATX,
 *00112    :     ,XTA,   L207
                 ,RTE,
 *00113    :,     LOG,  31047440 20641151.
            ,     LOG,  31040510 32270441.
            ,     LOG,  00000000 00000000.
 *00116    :,     LOG,  07645517 24050105.
            ,     LOG,  22652117 24020115.
            ,     LOG,  33005040 13631062.
            ,     LOG,  13430065 13433466.
            ,     LOG,  13600000 00000000.
            ,     LOG,  00000000 00000000.
 *00124    :,     LOG,  34050151 22640572.
            ,     LOG,  10200000 00000000.
            ,     LOG,  00000000 00000000.
 *00127    :,     LOG,  37454573 36020400.
            ,     LOG,  00000000 00000000.
            ,     LOG,  36447510 20220040.
            ,     LOG,  20474544 20252170.
            ,     LOG,  32241560 24040502.
            ,     LOG,  36440560 32241501.
            ,     LOG,  22647510 21261440.
 *00136    :,     LOG,  20441505 10020040.
 *00137    :,     LOG,  00000000 00000000.
 *00140    :,     LOG,  00000000 00000000.
 *00141    :,     LOG,  00000000 00000000.
 *00142    :,     LOG,  00000000 00000000.
 *00143    :,     LOG,  00000000 00000000.
 *00144    :,     LOG,  00203400 00603400.
            ,     LOG,  00203400 00603407.
 *00146    :,     LOG,  14030040 14030040.
            ,     LOG,  14030040 14030060.
 *00150    :,     LOG,  00077777 00000000.
            ,     LOG,  00007777 00000000.
 *00152    :,     LOG,  01603407 01603400.
            ,     LOG,  00003407 01603400.
 *00154    :,     LOG,  14030060 14030040.
            ,     LOG,  10030060 14030040.
 *00156    :,     LOG,  00000000 00000000.
 *00157    :,     LOG,  00000000 00000000.
 *00160    :,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
 *00162    :,     LOG,  00100000 00000000.
 *00163    :,     LOG,  00000000 00002000.
 *00164    :,     LOG,  02000000 00000000.
 *00165    :,     LOG,  10030060 14030040.
 *00166    :,     LOG,  00000000 00007777.
 *00167    :,     LOG,  00000000 00000001.
 *00170    :,     LOG,  01603407 00203403.
 *00171    :,     LOG,  00203403 01603407.
 *00172    :,     LOG,  01603407 01603407.
 *00173    :,     LOG,  11367700 00000000.
 *00174    :,     LOG,  00000407 01603400.
 *00175    :,     LOG,  10020052 12420040.
 BSS       :     ,BSS,  1
      ,END,
 MT/БИБ:,NAME,
 *PAGES: PC,BLOCK,(1024),WPG(1024)
 NPR:,P/P,(*PAGES)16
 NPW:,P/P,(WPG)16
 MATINFEX:,LC,1.
  MT/FLAG:,LC,1
  LEN:,EQU,16.MAX ДЛИHA
C---------
  *C:,ITA,7
 ,ITS,13.
 ,ITS,12.
 ,ITS,11.
 ,ITS,10.
  7,BASE,*C
  ,UTC,MATINFEX
  ,XTS,
  ,ASN,64-6
  ,ASN,64+39
  ,U1A,OWN
C
C...   ЗAKAЗ 9/MONSYS
C
  13,VTM,37B
  TAKT:,XTA,NAMT
  ,*57,2400B
  ,*57,4040B
  ,AAX,=:002
  ,UZA,REPT
  ,XTA,=434.
  ,UJ,OWN
  REPT:,*57,3
  ,UJ,TAKT
  NAMT:,TEXT,8HMONSYS'''11'
C
  OWN:10,VTM,1-LEN
 ,AOX,IR.
 ,ATX,IR.
  ,FUN,70100B+120B
  ,ATX,NAME
  ,FUN,70100B+122B
  :,UZA,*+1
  ,ATX,MASK
 12,VTM,.
 11,VTM,-1024.
  13,VTM,CH *N
  ,UJ,WORD
 SEARCH:13,VJM,WORD.
  :,AEX,=6H*READ
 ,ASN,64+8.
 ,UIA,NO END.
 13,VJM,WORD.
 ,AEX,=6HOLD '311''12'
 ,ASN,64+24.
 ,UZA,ABSEND.HET ИЛИ ИCПOPЧEHO
 NO END:,XTA,WRD.
 ,AEX,=6H*NAME
 ,ASN,64+8.
 ,UIA,SEARCH.
  GET N:,BSS,
 13,VJM,WORD.
 ,AEX,NAME.
 ,AAX,MASK.
 ,UIA,SEARCH.
 ,XTA,MASK.
 ,AEX,=7777 7777 7777 7777
 ,UZA,HAШЛИ.
 15,ATX,.
 ,ASN,64+8.
 15,AEX,.
 15,ATX,2.
 ,AAX,WRD.
 15,ATX,3.
 ,XTA,=6H
 15,AAX,2.
 15,AEX,3.
 ,UZA,HAШЛИ.
 ,XTA,=6H'200''200''200''200''200''200'
 15,AAX,2.
 15,AAX,3.
 ,UIA,HAШЛИ.
 ,UJ,SEARCH.
  CH *N:,BSS,
  ,AEX,=6H*NAME .ПPOBEPKA
  ,ASN,64+8.ПAKETA
  ,U1A,ABSEND. - HE *NAME
  ,XTA,NAME
  ,U1A,GET N
  13,VTM,HAШЛИ.ПEPBЫЙ ПAKET
 WORD:12,VIM,NEXTWD.ЧTEHИE CЛOBA
  ,ITA,13
  ,XTS,IR
  ,CALL,MT*OБMEH
  ,STI,
  ,ATI,13
 ,XTA,IR.
 ,ARX,=1.
 ,ATX,IR.
 12,VTM,-1024.
 :10,VLM,*+1
 ,UJ,ABSEND.
 NEXTWD:,UTC,*PAGES.
 12,XTA,1024.
 ,ATX,WRD.
 13,UTC,
 12,VLM,.
 WRWRD:11,VIM,NEXTT.ЗAПИCЬ.
 15,ATX,.
  ,*70,IW.
 ,XTA,IW.
 ,ARX,=1.
 ,ATX,IW.
 15,XTA,.
 11,VTM,-1024.
 NEXTT:,UTC,WPG.
 11,ATX,1024.
 13,UTC,.
 11,VLM,.
 HAШЛИ:,XTA,=6H*NAME
 13,VJM,WRWRD.
 ,XTA,WRD.
 13,VJM,WRWRD.
 ПEPEПИCЬ:13,VJM,WORD.
 NOTCHK:  13,VJM,WRWRD.
 ,XTA,WRD
 ,AEX,=6H*END F
 ,AAX,=6H'377''377''377''377''''377'
 ,UZA,KOHEЦ
 ,XTA,WRD
 ,AEX,=6H*READ
 ,UIA,ПEPEПИCЬ
 13,VJM,WORD.
 ,AEX,=3HOLD
 ,ASN,64+24.
 ,UZA,ABSEND.
 ,XTA,WRD.
 ,UJ,NOTCHK.
  KOHEЦ:,BSS,
 13,VJM,WORD.
 13,VJM,WRWRD.
 ,XTA,=6H*READ
 13,VJM,WRWRD.
 ,XTA,=6HOLD '311''12'
 13,VJM,WRWRD
 ,XTA,=7760 0000 0000 0012
 13,VJM,WRWRD
 11,VZM,EXIT.
 ,*70,IW.
 EXIT: 15,XTA,.
 ,STI,10.
 ,STI,11
 ,STI,12
 ,STI,13.
 ,ATI,7.
 ,NTR,6
 13,UJ,.
 ABSEND:,XTA,NAME
 ,ATX,NAMEA.
  ,UTC,MATINFEX
  ,XTA,
  ,UZA,TOPRI
  ,UTC,MT/FLAG
  ,XTA,
  ,U1A,TO PRI
 ,XTA,=:7777 7777 776
 ,*57,4000B
 ,*71,INF.
 ,*62,.
  INF:,Z04,TABSE.
 ,Z00,.
  TOPRI:14,VTM,TABSE
  ,ITS,14
  14,UTM,3
  ,ITS,14
  ,XTS,=1
  ,CALL,PRINT8
  ,*62,
 TABSE:,ISO,18HOTCYTCTBYET ПAKET
 NAMEA:,OCT,.
 ,OCT,
 IR:,010,NPR
 ,000,
 IW:,,NPW.
 ,001,.
 WRD:,BSS,1.
  NAME:,BSS,1
  MASK:,LOG,7777 7777 7777 7777
 ,END,MT/БИБ  .
      N8T10S     :,NAME,
 *00000    : 9 ,  VTM,   *00000
                 ,ATI,  10
            10 ,  XTA,
             9 ,  ATX,  50B
                 ,XTA,
             9 ,  ATX,  51B
 *00003    : 9 ,  XTA,  50B
             9 ,  ARX,  41B
             9 ,  AAX,  42B
                 ,UIA,   *00011
             9 ,  XTA,  51B
             9 ,  ARX,  43B
             9 ,  ATX,  51B
             9 ,  XTA,  50B
             9 ,  ARX,  41B
             9 ,  ATX,  50B
                 , UJ,   *00003
                 ,UTC,
 *00011    :     ,XTA,
             9 ,  ATX,  52B
 *00012    : 9 ,  XTA,  50B
             9 ,  ARX,  44B
             9 ,  AAX,  42B
                 ,UIA,   *00020
             9 ,  XTA,  52B
             9 ,  ARX,  43B
             9 ,  ATX,  52B
             9 ,  XTA,  50B
             9 ,  ARX,  44B
             9 ,  ATX,  50B
                 , UJ,   *00012
                 ,UTC,
 *00020    :     ,XTA,
             9 ,  ATX,  53B
 *00021    : 9 ,  XTA,  50B
             9 ,  ARX,  45B
             9 ,  AAX,  42B
                 ,UIA,   *00027
             9 ,  XTA,  53B
             9 ,  ARX,  43B
             9 ,  ATX,  53B
             9 ,  XTA,  50B
             9 ,  ARX,  45B
             9 ,  ATX,  50B
                 , UJ,   *00021
                 ,UTC,
 *00027    : 9 ,  XTA,  50B
             9 ,  AAX,  46B
                 ,ASN,  60B
             9 ,  ARX,  40B
             9 ,  ATX,  47B
             9 ,  XTA,  53B
                 ,ASN,  50B
             9 ,  ARX,  47B
             9 ,  ATX,  47B
             9 ,  XTA,  52B
                 ,ASN,  40B
             9 ,  ARX,  47B
             9 ,  ATX,  47B
             9 ,  XTA,  51B
                 ,ASN,  30B
             9 ,  ARX,  47B
            13 ,   UJ,
                 ,UTC,
 *00040    :,     LOG,  14030060 14020040.
            ,     LOG,  00000000 00776030.
            ,     LOG,  00000000 00700000.
            ,     LOG,  00000000 00000001.
            ,     LOG,  00000000 00777634.
            ,     LOG,  00000000 00777766.
            ,     LOG,  00000000 00000017.
 BSS       :     ,BSS,  5
      ,END,
 NTAPDISC:,NAME,
 MIST10*:LC,BLOCK,MIS,CODE,NUMB
 *MONCRD*:,LC,12
 STARSTA:,LC,1
 TABSIMIS:,SUBP,
 ,ITA,7
 ,ITS,8
 ,ITS,9
 ,ITS,10
 ,ITS,13
 ,XTS,
 ,UTC,STARSTA
 ,ATX,
 7,BASE,*
 14,VTM,TABSIMIS+57B./
 14,XTA,
 ,XTS,=:1
 14,ATX,
 10,VTM,6
 ,CALL,PARAMT*
 ,STX,
 ,UTC,TABSIMIS+57B./
 ,ATX,
 12,VZM,NOCHECK.NO CHECK,DISPD68
 11,UTM,-055B.-
  11,VZM,CC
  11,UTM,55B-57B./
  11,VZM,CC
  14,VTM,*MONCRD*
  14,XTA,
  ,ASN,64+40
  ,ATI,11
  ,UTC,TABSIMIS
  11,XTA,
  ,ASN,64+45
  ,U1A,MIST.HE БYKBA
  ,XTA,=:1
  ,ATX,R
  ,XTA,=6H
  14,ATX,1
  SHIFT:14,XTA,
  ,AEX,=6H
  ,UZA,MIST
  ,AAX,=377
  ,U1A,TOTEX
  14,XTA,
  ,ASN,64+8
  ,AOX,=:1
  14,ATX,
  ,UJ,SHIFT
 CC:,BSS,
 ,ITA,12
 ,ARX,=3
 ,ASN,64+3
 ,U1A,MIST.GR 4
 11,VTM,-8
 14,VTM,-4
 12,J+M,14
 K:11,UTM,8
 14,VLM,K
 14,VTM,*MONCRD*
 14,XTA,
 ,ATX,RR
 L:12,UTM,-1
 14,XTA,
 ,ASN,64-8
 14,ATX,
 ,YTA,
 ,ATI,13
 13,UTC,TABSIMIS
 ,XTA,
 ,AAX,=:2
 ,UZA,MIST.NO DEC
 12,V1M,L
 ,XTA,RR
 11,ASN,64
 ,CALL,MANTO*
 14,V1M,MIST
 ,ATX,R
 CONT:,BSS,
 10,VTM,6
 ,ITA,10
 ,UTC,STARSTA
 ,ATX,
 ,CALL,PARAMT*
 TOTEX:,XTA,
 ,UTC,STARSTA
 ,ATX,
 ,UTC,*MONCRD*
 ,ATX,2
 14,VTM,*MONCRD*
 ,ITS,14
 14,VTM,RI
 ,ITS,14
 ,CALL,ISO*TEX*
 ,XTA,RI
 ,UTC,*MONCRD*
 ,ATX,
 13,VJM,OUT
 ,ITA,12
 ,ASN,64+3
 ,U1A,MIST
 13,VTM,*MONCRD*
 12,UTM,-7
 12,VZM,CONT1
 12,VTM,
 ,XTA,R
 ,UZA,MIST
 13,AOX,
 FIN:,STX,R
 ,STI,13
 ,STI,10
 ,STI,9
 ,STI,8
 ,ATI,7
 ,NTR,2
 ,UTC,R
 ,XTA,
 13,UJ,
 CONT1:13,XTA,
 ,AEX,SCRAT
 ,U1A,CONT2
 12,VTM,2
 ,XTA,R
 ,UZA,MIST
 ,UJ,FIN
 CONT2:13,XTA,
 ,AEX,NO CHE
 ,U1A,CONT3
 12,VTM,1
 ,XTA,NO CHE/
C....MAЛEHЬKAЯ HOBOCTЬ-HOMEP БOБИHЫ
C...ДOБABЛЯETCЯ ДAЖE K ИMEHИ NO CHECK
 ,AAX,=:777777777777
 ,AOX,R
 ,UJ,FIN
 CONT3:13,XTA,
 ,AEX,DISPD
 ,U1A,MIST
 ,XTA,STANDA
 ,UJ,FIN
 NOCHECK:,XTA,
 ,ATX,R
 ,UJ,CONT
 OUT:,WTC,MIS
 14,VTM,
 ,WTC,CODE
 11,VTM,
 ,WTC,NUMB
 12,VTM,
 13,UJ,
 MIST:14,VTM,1
 ,XTA,
 ,UJ,FIN
 NOCHE:,TEXT,8HNOCHECK
 NOCHE/:,TEXT,8HNO CHECK
 SCRAT:,TEXT,8HSCRATCH
 DISPD:,TEXT,8HDISPD68
 STANDA:,OCT,2245 1252 5122 4512
 RI:,BSS,3
 R:,BSS,1
 RR:,BSS,1
 ,END,
 OC/БЭCM6:,NAME,.
C
C---------------------------------------
C
C       БЛOK CBЯЗИ  "LOADLIBR"  C
C     OПEPAЦИOHHOЙ CИCTEMOЙ БЭCM-6
C
C--------------------------------------
C
C
C    ДAHHAЯ BEPCИЯ PACЧИTAHA HA
C    OC " Д Y Б H A " C ABГ 1978 Г.
C
C--------------------------------------
C
C   БЛOK COДEPЖИT CЛEДYЮЩИE ПPOГPAMMЫ:
C
C------
C
C  READZONE - ЧTEHИE ЗOHЫ C БИБЛИOTEЧHOЙ
C     ЛEHTЫ.
C     ПAPAMETPOM ЯBЛЯETCЯ ИHФOPMAЦИOHHOE
C     CЛOBO ЧTEHИЯ, KOTOPOE HAXOДИTCЯ
C     B  COMMON  "E70RL".
C     HOMEP TEKYЩEЙ БИБЛИOTEKИ CИДИT B
C     COMMON  "NLIB".
C         ECЛИ  NLIB = 0, ИЛИ
C       ECЛИ  NLIB > 27B, TO ЧTEHИE BO
C     BCEX BEPCИЯX OC ДOЛЖHO ИДTИ ПO Э70.
C
C------
C
C    NEW/30 - ФOPMИPOBAHИE ШKAЛЫ CBOБOДHЫX
C    MAT. HOMEPOB.  ПOД TAKИMИ HOMEPAMИ
C     БYДYT ПOTOM ЗAXBATЫBATЬCЯ БИБЛИO-
C     TEЧHЫE ЛEHTЫ.
C
C------
C
C    OLD/30 - BOCCTAHOBЛEHИE REGSCAL ЗAДAЧИ
C    ПOCЛE LOADLIBR'A.
C
C------
C
C  ДAЙЛEHTY - ЗAXBAT БИБЛИOTEЧHOЙ ЛEHTЫ.
C     OБPAЩEHИE:
C       ,XTA,TAPE
C     14,VTM,MAC
C       ,ITS,14
C       ,CALL,ДAЙЛEHTY
C       ,ATX,ИHФ
C     TAPE - ИHФOPMAЦИЯ O ЛEHTE B BИДE:
C        31 - 42PP. - HOMEP ЗOHЫ
C       13 - 28PP. - HOMEP БOБ. B 2-10 BИДE
C        12-1 PP.-HOMEP ЗOHЫ ДЛЯ CTATИCTИKИ ПO
C        ДAHHOЙ БИБЛИOTEKE.  ИMЯ  ФAЙЛA CTATИCTИKИ
C        B TAБЛИЦE ИMEH ФAЙЛOB CTATИCTИKИ , EE
C        AДPEC LOADLIBR+1670B
C       48PP. = 1 - HYЖHA ЗAПИCЬ
C      MAC - MACCИB PAБOЧИX ЯЧEEK B KOTOPOM
C            ЗAПOMИHAETCЯ HOMEP БOБ. ДЛЯ
C            ПOCЛEДYЮЩEГO OTKAЗA.
C     OTBET ПOДAETCЯ HA CYMMATOPE B BИДE ИH-
C     ФOPMAЦИOHHOГO CЛOBA ЧTEHИЯ ИЛИ ЗAПИCИ.
C
C-------
C
C  HAЛEHTY - OTKAЗ OT БИБЛИOTEЧHOЙ ЛEHTЫ.
C     OБPAЩEHИE:
C     14,VTM,MAC
C       ,ITS,14
C       ,CALL,HAЛEHTY
C     MAC - MACCИB B KOTOPOM ECTЬ ИHФOPMAЦИЯ
C         O БИБЛИOTEЧHOЙ БOБИHE
C
C---------------------------------------
C
 A/ИПД:,EQU,760B.ПPИBЯЗKИ ПO
 A/TMT:,EQU,504B.OПEPAЦИOHHOЙ
 A/ГYC:,EQU,502B.CИCTEME
 A/FAT:,EQU,576B.
 L/FAT:,EQU, 20B.
 LOADLIBR:,SUBP,.
 T/N STAT:,EQU,LOADLIBR+1671B.
 NAM LIB:,EQU,LOADLIBR+1721B.
 TABNLNB :,EQU,LOADLIBR+1751B.
 REGSCAL:,EQU,100B
 LIB/BOSS:,EQU,72B.BIT'Ы LOADLIBRA
 E70RL:,LC,1.
 NLIB:,LC,1.
C
C-------------------------------------
C
  READZONE:,ENTRY,.
  ,XTS,.
  ,*70,E70RL.
  ,STX,.
  13,UJ,.
C
C---------------------------------------
C
 NEW/30:,ENTRY,.OCBOБOДИ 30
 ,XTS,.
 ,FUN,70100B+REGSCAL.
 ,ASN,64+47.
 ,ATX,SAVSCAL.
 ,UIA,FIS**.
 ,XTA,=3053 4576 1634 0112.
 ,*76,1
 FIS**:,BSS,.
  ,XTA,MEЛШ.BЫЯCHИM
  ,*57,4040B.CBOБOДHЫE
  ,AEX,MEЛШ.MATEMATИЧECKИE
 ,ATX,ШЛEM.
C                           HOMEPA MЛ/MД
 ,*76,UP PRT.
 ,STI,.
 13,UJ,.
 OLD/30:,ENTRY,.BOCCTAHOBЛ. 30
 ,XTS,BIT/LIB.
 ,*76,LO PRT.
 ,XTA,SAVSCAL.CHЯTИE ФИЗ.
 ,UIA,FIS//.
 ,*76,.
 FIS//:,STI,.
 13,UJ,.
C
C-------------------------------------
C
 ДAЙЛEHTY:,ENTRY,.
 *0:,BLOCK,ПACП
 ,CONT,БOБ
 ,STI,12.MAC
 12,ATX,ПACП.
 ,ASN,64+47.
 14,VTM,
   ,UZA,READ
 14,VTM,-30
   ,WTC,N LIB
   ,XTA,T/N STAT-1
 13,UZA,
   ,XTA,=500
 READ:,BSS,
   ,ATX,REGIM
   ,WTC,N LIB
   ,XTA,TABNLNB-1
 13,UZA,
 14,ASN,64+30
   ,AAX,=3777
 12,ATX,БOБ
   ,ITA,13
   ,XTS,ШЛEM
   ,ANX,=27
   ,ATI,13
 ,ASN,64-12
 12,AOX,БOБ
 12,ATX,БOБ.
 ,XTA,N LIB.
 ,ASN,64-42.
 ,AUX,=6H'''''''7''7'''
 ,AOX,=6HCП-00'77'
 ,ATX,CПTEX.
 ,WTC,N LIB.
 ,XTA,NAM LIB-1.
 ,ATX,NAME/LT.
 14,VZM,ДAЙ MЛ
 ,WTC,N LIB.
 ,XTA,T/N STAT-1
 ,ATX,NAME/LT.
 ДAЙMЛ:,BSS,
 ,XTA,NAME/LT.
 ,WTC,REGIM.
 ,*57,2050B.
 ,UZA,ERR LIB.
 ,ATX,RELREG.
 ,AAX,=:1
 ,UIA,ПPOЖДY.
 ,XTA,RELREG.
 ,AAX,=:2
 ,UIA,ERR LIB.
C...   OTMETИM ЗAHЯTOCTЬ HOMEPA
  ,XTA,=:4
  13,ASN,64-30B
  15,ATX,
  ,AOX,ШЛEM
  15,AEX,
  ,ATX,ШЛEM
 12,XTA,БOБ.
 15,WTC,
 ,UJ,
 ПPOЖДY:,BSS,.
C...  ДOПOЛHИTEЛЬHЫЙ AHAЛИЗ CЛYЧAЯ ЗAHЯTOCTИ
  ,*63,A/TMT
  ,ATI,14
  ,WTC,RELREG
  14,*63,-30B
  ,ASN,64-6
  ,ATX,RELREG
  ,YTA,
  ,AEX,ДHЗ
  ,U1A,WAITS.ЧYЖAЯ
  ,XTA,RELREG
  ,ASN,64-6
  ,YTA,
   ,ATI,13
  ,XTA,=:4
 13,ASN,64-30B
  ,AOX,OWNUM.БЛOKИPOBKA
  ,ATX,OWNUM.OTKAЗA
  ,XTA,RELREG
  ,ASN,64+18
  ,AAX,=7777.DELTA
  ,NTR,3
  12,X-A,БOБ
  ,AAX,=7777
   ,ITS,13
  ,ASN,64-12
  15,AOX,
  12,ATX,БOБ
 15,WTC,
  ,UJ,
  WAIT S:,BSS,
  ,*57,3
 ,UJ,ДAЙ MЛ.
 ERR LIB:,XTA,REGIM.
 ,UIA,REFUSE
C                         .CTATИCTИKY
C                         .HE COБИPAEM
 14,VTM,CП TEX.
 ,ITA,14
 ,FUN,76B.
 ,XTA,.
  ,FUN,211B.ПOДOЖДEM MЛ
 ,UJ,ДAЙ MЛ.
 REFUSE:,XTA,=:4
 13,ASN,64-30B
 ,AOX,ШЛEM.
 ,ATX,ШЛEM.
 ,XTA,.
 15,WTC,
 ,UJ,.
C
C-------------------------------------
C  OTKAЗ OT TPAKTOB MБ ИCПOЛЬЗOBAHHЫX
C  ПPИ PAБOTE "LOADLIBR'A"
 REFUSE:,ENTRY,.
      ,*72,=:40 02 5622 0077
C  BOЗBPATИM TPAKTЫ  MБ 02 16-37
 13,UJ,.
C
C-------------------------------------
C
  HA ЛEHTY:,ENTRY,.
 ,ATI,12.
 12,XTA,БOБ.
 ,ASN,64-24.
 ,ASN,64+24.
 ,AOX,=:003
 12,ATX,БOБ.
 ,ASN,64+12
  ,ATI,14
  ,XTA,=:4
  14,ASN,64-30B
 ,ATX,RELREG.
  ,AAX,OWNUM
  ,U1A,HA RET
 12,XTA,ПACП.
 ,ASN,64+47.
 ,UIA,NO/REW.CTAT-KY HE ПOДMATЫBAEM
 ,*65,7
 ,AAX,=:0000 01.BIT31 - БЛOKИPOBKA
C                           .ПOДBOДOB ЛEHT LIBRARY
 ,UIA,NO/REW.
 12,*70,БOБ.ПOДBOД
 NO/REW:,BSS,...............
  ,XTA,REL REG
 15,ATX,
 ,AOX,ШЛEM.
 ,STX,ШЛEM.
 ,*57,4000B.
  HA RET:,BSS,
 ,STX,.
 13,UJ,.
 UP PRT:14,REL,*.
  ,WTC,A/ГYC.
  ,XTA,.
  ,ASN,64+42.
  ,ATX,ДHЗ
  ,WTC,ДHЗ
  ,XTA,677B.
  ,ATX,BIT/LIB.БИT ЗAДAЧИ
 ,WTC,A/ИПД.
 ,AOX,LIB/BOSS.
 M/RET:,WTC,A/ИПД.
 ,ATX,LIB/BOSS.
 ,MTJ,23.
 2,IJ,.
 LO PRT:14,REL,*
 ,WTC,A/ИПД.
 ,AOX,LIB/BOSS.
 ,AEX,BIT/LIB.
 ,UJ,M/RET.
C
C---------------------------------------
C
 CПTEX:,OCT,.
     :,OCT,.
 ,OCT,
C--------------------------------------
C    ШKAЛA CBOБOДHЫX MAT. HOMEPOB
 MEЛШ:,OCT,7777 7777 7777 7400
C--------------------------------------
  ШЛEM:,BSS,1.
  OWNUM:,BSS,1
  ДHЗ  :,BSS,1
 SAVSCAL:,BSS,1.
 REGIM:,BSS,1.
 RELREG:,BSS,1.
 NAME/LT:,BSS,1.
 BIT/LIB:,BSS,1.HAШ BIT
 ,END,OC/БЭCM6
 OCATALOG:,NAME,.CAXAPOB
 INFLOAD*:,LC,1.
 *REGIM//:,LC,1.
 DATAPR*:,SUBP,.17.12.76 Г.
 PT6    :,SUBP,.   ИBTAH
 PRINT8 :,SUBP,
 PARAMT*:,SUBP,
 OUT*OUT:,LC,1
 /1024/:,PC,1024
 N/L:,P/P,(/1024/)16
 *C:,BSS,
 7,BAS,*C
 ,MTJ,9
 14,VJM,ИP
 ,UTC,OUT*OUT
 ,ATX,
 ,MTJ,10
 13,VJM,PARAMT*
 9,VTM,INF
 ,XTA,=60 0000
 9,ATX,
 11,VZM,*99
 10,VTM,4
 13,VJM,PARAMT*
 14,VIM,ERR
 *99:,BSS,
 12,VTM,1
 ,XTA,INF
 BEGIN:,BSS,
 4,VTM,BEG
 ,AOX,INF0
 ,ATX,INF
 ,*70,INF
 6,VTM,/1024/
 12,VZM,COR OLD.
 6,XTA,1762B
 ,AEX,=6HOVERLA
 ,UZA,ПOKOP.
 12,VTM,TOL.
 ,*64,IP.
 ,XTA,*REGIM//
 ,AAX,=2000 0000.
 ,UZA,O KEY+1.
 ПOKOP:,BSS,
 ,XTA,
 13,VJM,DATAPR*
 6,XTA,1764B
  ,AAX,=6H'17''17''16''17''17''16'
 ,ATX,DAT1
 6,XTA,1765B
 ,AAX,=6H'17''17'''''''''
 ,AOX,=6H'''''14''214''214''231'
 ,ATX,DAT2
 12,VTM,HEAD
 ,*64,IP
 5,VTM,-500
 6,VTM,/1024/
 ПEЧKA:6,XTS,
 ,UZA,END
 *111:,BSS,
 14,VTM,LINE
 ,ITS,14
 13,VJM,PT6
 6,XTA,1
 ,ARX,
 ,UIA,HE ПЛЮC
 ,XTS,LINE+1
 ,ASN,64+32
 ,ASN,64-32
 ,AOX,PLS
 ,STX,LINE+1
 HE ПЛЮC:,BSS,
 ,XTA,INF
 ,ARX,=10 0000.
 ,AAX,=40 0000.
 ,UZA,MБ YK
 ,XTA,INF
 ,ASN,64+12
 ,ATX,MЛ
 6,XTA,1
 ,ASN,64+35
 ,ARX,INF.
 ,AAX,=1777
 ,ATX,ZON
 PO MБ:,BSS,
 6,XTA,1
 ,ARX,=10
 ,ATX,BEG
 ,ASN,64+30
 ,AAX,=37
 ,ATX,REC
 6,XTA,1
 ,ASN,64+15
 ,ATX,LEN
 6,UTM,2
 ,*64,IC
 5,VLM,ПEЧKA
 12,VTM,GI
 ,*64,IP
 14,VTM,/1024/+1766B
 ,ITS,14
 14,VTM,/1024/+1776B
 ,ITS,14
 14,VTM,4
 ,ITS,14
 13,VJM,PRINT8
 ,UTC,/1024/+1777B
 ,XTA,
 ,UIA,O KEY
 12,VTM,БЫ MA
 ,*64,IP
 O KEY:,BSS,
 12,VTM,G2
 ,*64,IP
 ,STI,
 ,STI,4
 ,STI,5
 ,STI,6
 ,STI,7
 ,STI,13
 13,UJ,
 ERR:,BSS,
 12,VTM,ETE
 ,*64,IP
 ,UJ,O KEY+1
 COR OLD:,BSS,.CTAPЫЙ
 12,VIM,/X/.
 ,XTA,.
 ,ATX,INF.STATICA
 /X/:,BSS,.
 ,XTA,=6H
 14,VTM,-10B
 SCC:6,UTC,1766B
 14,ATX,10B
 14,VLM,SCC
 12,VIM,ПOKOP.
 6,XTA,376B
 6,ATX,1764B
 6,XTA,377B
 6,ATX,1777B
 6,ATX,1765B
 ,UJ,ПOKOP
 MБ YK:6,XTA,1
 ,ASN,64+35
 ,XTS,INF
 ,APX,=37 0037
 ,ASN,64+38.
 15,ARX,.
 15,ATX,.
 ,AAX,=37
 ,STX,ZON.
 ,ASN,64+5.
 ,AAX,=37 .
 ,ATX,MЛ
 ,UJ,PO MБ
 END:,BSS,
 4,VTM,REC
 5,VTM,
 12,VTM,ZZ
 ,*64,IP
 ,XTA,CBOБOДHO
 ,UJ,*111
 SOVCATAL:,ENTRY,
 14,VTM,BEGIN
 ,UJ,ИP
 ИP:,BSS,
 ,ITS,13
 ,ITS,7
 ,ITS,6
 ,ITS,5
 ,ITS,4
 7,VTM,*C
 ,XTS,INFLOAD*+1.
 ,AAX,=:7777 0000 7777
 ,AOX,=301
 12,VTM,
 14,UJ,
 IP:12,,
 12,,
 :0,001,
 8,,
 IC:,,LINE
 4,,
 :0,010,
 ,,
 :2,025,2
 ,,
 :2,030,4
 ,,
 :2,035,2
 ,,
 :2,042,5
 ,,
 :2,052,5
 8,,.ЭKOHOMИM!
 INF0:,010,N/L
 ,,
 HEAD:,GOST,9HKATAЛOГ
 ,CONT,11HOVERLAY
 ,CONT,4H'214''200'4/
 DAT1:,OCT,
 DAT2:,OCT,
 LINE:,GOST,12H
 ,GOST,1H'231'
 MЛ :,OCT,
 ZON:,OCT,
 REC:,OCT,
 LEN:,OCT,
 BEG:,OCT,
 ZZ:,GOST,5H='265''60''214''231'
 БЫMA:,GOST,18HБЫЛO MAЛO MЛ '133''231'
 GI:,GOST,3H'214''214''231'
 G2:,GOST,4H'214''265'4'231'
 ETE:,GOST,16HOШИБKA ПPИ OБPAЩ
 ,CONT,16HEHИИ K OCATALOG
 ,CONT,2H'133''231'
 CBOБOДHO:,TEXT,8HCBOБOДHO
 TOL:,GOST,17HTAKOГO OVERLAY'32'Я
 ,CONT,12HHE БЫBAET '133''231'
 PLS:,GOST,6H'''' (+)
 INF:,OCT,
 ,END,OVCATAL
 ORDERS*:,NAME,
C
C------   1.03.75 - ШAПИPO
C
C......   ГOЛOBHAЯ ПPOГPAMMA ПPИEMA
C         KAPT ЗAKAЗA И COCTABЛEHИЯ
C         ПACПOPTA ДЛЯ ПЛAHИPOBЩИKA
C
C......   OБPAЩEHИE CALL ORDERS*(ACARD)
C
C......   HA BЫXOДE ФЛAГ OШИБKИ - MER
C         И COMMON ПACПOPTA *DECLARA
C         BЫPAБATЫBAETCЯ ПPИЗHAK:
C         I14=0 - ПACПOPT KOHЧИЛCЯ.
C
C......   BЫЗЫBAЮTCЯ CHE*NAM,FINISHER И
C         TAK*COCA
C         BHYTPEHHИE CBЯЗИ-ЧEPEЗ *ORDEN И
C         *FLAG*
C---------------------------------------
 *DECLARA:LC,BLOCK,TAPEVOL,DISCVOL
 ,CONT,NAME(3),TIPASCRA
 ,CONT,REG/DEN
 ,CONT,VOLUMES(50)
 *ORDEN:LC,BLOCK,TAPES(128)
 *FLAG*:LC,BLOCK,MER,TIM(2),PAS,NACA(6)
 ,CONT,PAGE,(2)
 FINISHER:,SUBP,
 CONCAR:,SUBP,
 LEN:,EQU,CONCAR-1
 OUT*OUT:,LC,1
 *MONCRD*:,LC,12
 MONCARD/:,LC,14
C......   OБOЗHAЧEHИЯ ИHДEKC-PEГИCTPOB
 *1:,BLOCK,IT,T,E,PI,DF
 *10:,BLOCK,C,COD,AD
 BASE:,BSS,
C         ПPИEM ФAKTИЧECKOГO ПAPAMETPA
C         - AДPECA AHAЛИЗИPYEMOЙ KAPTЫ
 ,ATI,AD.
C......   CПACEHИE ИHДEKCHЫX PEГИCTPOB 1-7,13
 ,ITA,13.
 13,VTM,1-7.
 SAVE IR:13,ITS,7.
 13,VLM,SAVE IR.
C......   БAЗИPOBAHИE ПO 7 ИP'Y.
 7,BASE,BASE
C......   AHAЛИЗ TИПA OБPAЩEHИЯ:
C         ПPИ ПEPBOM OБPAЩEHИИ - HAЧAЛЬ-
C         HЫE YCTAHOBKИ И AHAЛИЗ KAPTЫ*NAME
C         ПPИ ПOCЛEДYЮЩИX OБPAЩEHИЯX -
C            AHAЛИЗ KAPT ЗAKAЗA PECYPCOB.
C         ECЛИ ПOШЛИ ДP.YПP.KAPTЫ-ДOOБPAБOT.
 ,XTS,INITFLAG.OБPAЩEHИE
 ,UZA,ASSIGN.-HE ПEPBOE
C         HAЧAЛЬHЫE YCTAHOBKИ
 ,ATX,OUT*OUT.ЗAПPET ПEЧATИ
 ,XTA,
 ,ATX,INITFLAG.CБPOC ФЛAГA
 IT,VTM,TAPES.ГЛOБAЛЬHЫE
 DF,VTM,-56.PEГИCTPЫ
 Z DCL:,UTC,*DECLARA
 DF,ATX,56
 DF,VLM,Z DCL
 DF,VTM,-127
 Z ORD:,UTC,*ORDEN
 DF,ATX,127
 DF,VLM,Z ORD
 DF,VTM,-12
 Z FLG:,UTC,*FLAG*
 DF,ATX,12
 DF,VLM,Z FLG
 ,CALL,CHE*NAM.AHAЛИЗ *NAME
 E,VIM,ERROR.-ECTЬ OШИБKИ
 E,VTM,1-3.ПEPECЫЛKA
 T NAM:E,XTA,NACA+3. NAME
 E,ATX,NAME+2.
 E,VLM,T NAM....
C......   BOЗBPAT ИЗ ПOДПPOГPAMMЫ
 RETURN:,BSS,
 14,VTM,1.- ПPИЗHAK
 ,XTA,INITFLAG.EЩE HET
 ,UZA,RET 1.
 14,VTM,.ПACПOPT CДOX
 RET 1:,BSS,.
 ,ITA,IT.YПPЯTЫBAHИE
 ,ATX,SAVE IT.PEГИCTPOBЫX
 ,ITA,DF.ПEPEMEHHЫX
 ,STX,SAVE DF.ДЛЯ CЛEД.BXOДOB
C......   BOCCTAHOBЛEHИE PEГИCTPOB 1-7,13
 13,VTM,7.
 REST IR:,BSS,.
 13,STI,.
 13,UTM,-1.
 13,VIM,REST IR.
 ,STI,13
 13,UJ,
C---------------------------------------
C      ---ДЛЯ HEПEPBOГO OБPAЩEHИЯ---
C         HAЧИHAEM AHAЛИЗ KAPTЫ ЗAKAЗA
 ASSIGN:,BSS,
 ,XTA,SAVE IT.BOCCTAHOBЛEHИE
 ,ATI,IT.OWN-ИHДEKCHЫX
 ,XTA,SAVE DF.ПEPEMEHHЫX
 ,ATI,DF.
C......   YCTAHOBKA ИP'OB ДЛЯ AHAЛИЗA KAPTЫ
 PI,VTM,.CTAPЫЙ TИП KAPTЫ
 9,VTM,.ДЛЯ PARAMT*
C......   AHAЛИЗ HA NONTEXT CARD
 AD,XTA,
 ,AAX,MB1.ПEPBЫЙ БAЙT
 ,UZA,OUT.HYЛЬ - CTM
C......   ПEPECЫЛKA KAPTЫ ДЛЯ ДAЛЬHEЙШEГO
 T,VTM,1-14.
 SETTLING:,BSS,.ПEPECЫЛKA
 T,UTC,
 AD,XTA,13
 T,ATX,MONCARD/+13
 T,VLM,SETTLING
C......   ПPOБA:ФOPMAT KAPTЫ ПЛABAЮЩEЙ!
 ,ITA,AD
 15,ATX,.
 C,VTM,
 ,CALL,PARAMT*
 ,STX,.
 ,ATI,AD
 COD,UTM,-72B.B KAPTE
 COD,VIM,ASS1.HET ДBOETOЧИЯ
 PI,VTM,1.ПЛABAЮЩИЙ
 AD,VTM,*MONCRD*.
 ASS1:,BSS,
C......   ПOДГOTOBKA ЦИKЛA AHAЛИЗA
 ,UTC,LEN.
 ,XTA,.
 ,ASN,64+24.KAPT ЗAKAЗA
 ,ATI,T.B HYЖHOM BИДE
 LOOP:AD,XTA,
 ,WTC,LEN.HAЧAЛO CПИCKA
 T,AEX,.TEKYЩAЯ CTPEЛKA
 ,UZA,TAKE.-HAШЛИ
 T,VLM,LOOP.
C......   ПOШЛA''HE HAШA''KAPTA,T.E.
C         ЛИБO KAPTA CTM, ЛИБO HE ЗAKAЗ PECYPCOB
 OUT:,BSS,
C......   ПOДГOTOBKA HOBOГO'ПEPBOГO'OБPAЩEHИЯ
C            INITFLAG.NE.O
 ,XTA,MB1
 ,ATX,INITFLAG
 ,XTA,MER.OШИБKИ
 ,UIA,RETURN.-БЫЛИ
 13,VTM,RETURN.ECЛИ HET
 ,UJ,FINISHER.-ДOOБPAБOTKA
C......   KAPTA OПOЗHAHA KAK 'HAШA'
C         BЫЗЫBAEM PEAЛИЗATOP
 TAKE:,BSS,
 PI,VZM,CALL.ДЛЯ CTAPЫX KAPT -CPAЗY
 AD,VTM,MONCARD/.
 CALL:,BSS,
C         CTOИT ЛИ ДAЛЬШE AHAЛИЗИPOBATЬ
 ,XTA,MER.БЫЛИ OШ.
 ,UIA,RETURN. - ДA
 ,CALL,TAK*COCA
 T,VZM,ERROR.
 E,VZM,RETURN
 ERROR:,BSS,
C......   OБPAБOTKA OШИБOЧHЫX KAPT ЗAKAЗA
C            MER.NE.0
 ,XTA,MB1.
 ,ATX,MER.
 ,UJ,RETURN
C
C*****  ИHИЦИAЛИЗAЦИЯ  ORDERS*'A :
C
  ORD INIT:,ENTRY,
  14,BASE,BASE
  ,XTA,MB1
  ,ATX,INITFLAG
  ,XTA,.ЗAKAЗ
  ,ATX,73B.LIBRARY
 14,VTM,-127
  :,UTC,*ORDEN
  14,ATX,127
  14,VLM,*-1
  13,UJ,
 SAVE IT:,BSS,1
 SAVE DF:,BSS,1
 MB1:,OCT,776
 INITFLAG:,OCT,776
 ,END,
 OVERLOAD:,NAME,
   ,SPACE,60
C**************************************************************
C*                                                            *
C*           CБOPKA БИБЛИOTEKИ PAЗДEЛOB ПOЛЬЗOBATEЛЯ          *
C*           ---------------------------------------          *
C*  BAPИAHT ДЛЯ БOЛЬШИX  OVERLAY'EB, OPИEHTИPOBAH HA ИCПOЛЬ-  *
C*  ЗOBAHИE OБCП ПPИ ЗAГPYЗKE PAЗДEЛOB.  ЧTOБЫ ПPEДOTBPATИTЬ  *
C*  ПEPEПOЛHEHИE BPEMEHHOЙ БИБЛИOTEKИ, ПPOИЗBOДИTCЯ EE ЧИCT-  *
C*  KA ПEPEД ЗAГPYЗKOЙ KAЖДOГO PAЗДEЛA BTOPOГO YPOBHЯ.        *
C*  B COЧETAHИИ C ДOЗAKAЗOM OБCП, ЭTO ПOЗBOЛЯET ИCПOЛЬЗOBATЬ  *
C*  B COBOKYПHOCTИ БOЛЬШE CEMИ OБCП, ПPИЧEM OБCП, ИCПOЛЬЗYЮ-  *
C*  ЩИECЯ ПPИ ЗAГPYЗKE PAЗHЫX PAЗДEЛOB,  MOГYT BKЛЮЧATЬ COB-  *
C*  ПAДAЮЩИE ИMEHA.                                           *
C*    OБPAЩEHИE:                                              *
C*  *CALL OVERLOAD<D1><OVL><D2><LEN><D3><COM>                 *
C*  <OПИCAHИE ДEPEBA PAЗДEЛOB>                                *
C*  <ПOCЛEДOBATEЛЬHOCTЬ ЗAKAЗOB OБCП>                         *
C*  *END RECORD                                               *
C*    OVL (60)   - YKAЗATEЛЬ ЗAПИCИ БИБЛИOTEKИ PAЗДEЛOB       *
C*    LEN (1000) - OГPAHИЧИTEЛЬ ДЛИHЫ БИБЛИOTEKИ              *
C*    COM        - KOMMEHTAPИЙ, ПИШETCЯ B KATAЛOГ БИБЛИOTEKИ  *
C*    D1         - PAЗДEЛИTEЛЬ, ECЛИ ЗAДAH '+' , TO C KAЖДЫM  *
C*                 PAЗДEЛOM B БИБЛИOTEKY ЗAПИШETCЯ EГO ФPAГ-  *
C*                 MEHT TPП                                   *
C*    D2         - PAЗДEЛИTEЛЬ, ECЛИ ЗAДAH '+' , TO PAЗPEШA-  *
C*                 ETCЯ PACCЫЛKA ДAHHЫX "BBEPX"               *
C*    D3         - PAЗДEЛИTEЛЬ, ECЛИ ЗAДAH '+' , TO ЧИCTKA    *
C*                 BPEMEHHOЙ БИБЛИOTEKИ ДEЛATЬCЯ HE БYДET     *
C*  B CKOБKAX YKAЗAHЫ ЗHAЧEHИЯ ПAPAMETPOB ПO YMOЛЧAHИЮ.       *
C*    OПИCAHИE ДEPEBA PAЗДEЛOB - B ПPOCTEЙШEM CЛYЧAE ЭTO MO-  *
C*  ЖET БЫTЬ ИMЯ EДИHCTBEHHOГO PAЗДEЛA, A B OБЩEM CЛYЧAE ЭTO  *
C*  ПOCЛEДOBATEЛЬHOCTЬ  OПИCAHИЙ  PAЗДEЛOB,  HAЧИHAЮЩAЯCЯ  C  *
C*  OПИCAHИЯ ГOЛOBHOГO PAЗДEЛA.                               *
C*    OПИCAHИE  PAЗДEЛA  -  ИMЯ  PAЗДEЛA, ЗA KOTOPЫM CЛEДYET  *
C*  CПИCOK  ИMEH  BЫЗЫBAEMЫX PAЗДEЛOB, ЗAKЛЮЧEHHЫЙ B CKOБKИ.  *
C*  OПИCAHИE PAЗДEЛA HYЖHO ЗAДABATЬ  ПOCЛE OПИCAHИЙ BCEX BЫ-  *
C*  ЗЫBAЮЩИX EГO PAЗДEЛOB (ЭTO  TPEБOBAHИE ИCKЛЮЧAET BOЗMOЖ-  *
C*  HOCTЬ  PEKYPCИBHOГO  BЫЗOBA PAЗДEЛOB). ECЛИ ПEPEД ИMEHEM  *
C*  PAЗДEЛA (ЗAKЛЮЧEHHOГO B CKOБKИ) CTOИT ЗHAK '+' , TO ЭTOT  *
C*  PAЗДEЛ HE БYДET ПEPEПИCЫBATЬCЯ BO BPEMEHHYЮ БИБЛИOTEKY И  *
C*  БYДET ЗAГPYЖATЬCЯ  HEПOCPEДCTBEHHO  ИЗ ЛИЧHOЙ БИБЛИOTEKИ  *
C*  PAЗДEЛOB. ЗHAK '+' , CTOЯЩИЙ ПEPEД ИMEHEM ГOЛOBHOГO PAЗ-  *
C*  ДEЛA, YCTAHABЛИBAET TAKOЙ PEЖИM ДЛЯ BCEX PAЗДEЛOB БИБЛИ-  *
C*  OTEKИ.                                                    *
C*    ПOCЛEДOBATEЛЬHOCTЬ ЗAKAЗOB OБCП - MOЖET OTCYTCTBOBATЬ.  *
C*  KAЖДЫЙ ЗAKAЗ  PACПOЛAГAETCЯ HA OTДEЛЬHOЙ KAPTE И COCTOИT  *
C*  ИЗ ИMEHИ  PAЗДEЛA  BTOPOГO  YPOBHЯ,  ЗA KOTOPЫM CЛEДYET,  *
C*  OTДEЛEHHЫЙ OT HEГO  ДBOETOЧИEM,  CПИCOK HOMEPOB OБCП (HE  *
C*  БOЛEE  TPEX),  ИЗ KOTOPЫX  БYДYT ИЗBЛEKATЬCЯ П/П, OTCYT-  *
C*  CTBYЮЩИE  BO  BPEMEHHOЙ  БИБЛИOTEKE, ПPИ CБOPKE ЭTOГO, И  *
C*  BCEX BЫЗЫBAEMЫX ИM PAЗДEЛOB.                              *
C*    ПPИMEP:                                                 *
C*  *CALL OVERLOAD:60,1000,CEMEЙKA                            *
C*  ПAПA(CЫH,+ДOЧЬ) Д O Ч Ь (BHYK1, BHYK2                     *
C*  )CЫH ( +BHYK3,BHYK4,+BHYK5                                *
C*  , BHYЧKA )                                                *
C*  ДOЧЬ:1-3                                                  *
C*  C Ы H : 33,1                                              *
C*  *END RECORD                                               *
C*                                                            *
C**************************************************************
 SECENTRY:,EQU,15B
 ALF1:,EQU,16B
 ALF2:,EQU,17B
 LEX :,EQU,43B
 ALFA:,EQU,44B
 WLEX:,EQU,46B
 RCAT:,EQU,47B
 RETN:,EQU,51B
 LDRM:,EQU,54B
 RLOAD:,EQU,61B
 LTAPES:,EQU,73B
C--------
 MONITOR*:,SUBP,
 MONCARD/:LC,BLOCK,MC/
 DATA*   :LC,BLOCK,D*
 MONCARD*:LC,BLOCK,MC*
 LOADLIS*:,LC,
 ERROFLG*:,LC,
 RM*     :,LC,
 KCOUNT* :LC,BLOCK,KC*
C--------
 STOP*   :,SUBP,
 MONREAD*:,SUBP,
 PRINT8  :,SUBP,
C--------
 SAV*47  :,LC,1
 BLEXPRIN:,SUBP,
C--------
 *MONCRD*:LC,BLOCK,*MC(12)
 LTREE   :,EQU,2020
 TREE    :,LP,LTREE
 PARAMT* :,SUBP,
C--------
 BUFP:,WEQ,LEX
 LCAT:,EQU,1762B
 ECAT:,EQU,BUFP+LCAT
 /NB:,P/P,(BUFP)16
C--------
 LDLP:,EQU,2000B
 /NL :,P/P,(LDLP)16
C--------
 *1:,BLOCK,NN,MM,AW,P
 *1:,BLOCK,CK,SD,FP,ER
 *5:,BLOCK,B,EN,L,A,R,C,NL
 *9:,BLOCK,V,T,D,N,(1),E
 *13:,BLOCK,J,M,S
C--------
 /LPAR:,EQU,50B
 /RPAR:,EQU,51B
 /PLUS:,EQU,53B
 /COM :,EQU,54B
 /TWOP:,EQU,72B
C
C-------------------------------------
C
CC****   ПAPAMETPЫ C YПPABЛЯЮЩEЙ KAPTЫ
C
  T,VTM,
   ,CALL,PARAMT*
  D,MTJ,EN
C.....   ДOБYДEM YKAЗATEЛЬ
  V,VTM,IT0
  T,VTM,4
   ,CALL,PARAMT*
   ,XTA,
 EN,UTM,-/PLUS
 :EN,VZM,*+1.MIXLOAD
   ,ATX,FMIX
  E,MTJ,ER
  D,UTM,-/PLUS
 :D,V1M,*+1
C.....   PAЗPEШAEM PACCЫЛKY "BBEPX"
   ,CTX,LOAD
C.....   ДOБYДEM OГPAHИЧИTEЛЬ
  L,VTM,-8
  V,VTM,LIM NZ
  T,VTM,5
   ,CALL,PARAMT*
  E,J+M,ER
   ,ARX,=777
   ,ASN,64+10
  D,UTM,-/PLUS
  :,UZA,*+1
 ER,UTM,1
   ,ITA,D.ФЛAГ BOCCT.
   ,ATX,FRES.TEMPO
C.....   ДOБYДEM KOMMEHTAPИЙ
  T,VTM,1
   ,CALL,PARAMT*
 :L,XTA,*MC+8
  L,ATX,C*COM+8
  L,VLM,*-1
C
CC****   ПOЛYЧEHИE CXEMЫ ЗAГPYЗKИ
C
 CK,VTM,B47.BHE (...)
 FP,VTM,
  A,VTM,
   ,XTA,LTAPES
   ,ATX,CTN
C===   ЧTEHИE И PAЗБOP OЧEPEДHOЙ KAPTЫ
 R CARD:,BSS,
C.....   ПPOBEPKA : TEKCTOBAЯ ЛИ
   ,XTA,MC*
   ,ASN,64+40
C/////   KAPTA = HE TEKCTOBAЯ
  M,VTM,NONTEX
  J,VTM,STOP*
   ,UZA,PRIER
C.....   KAPTY ДЛЯ PARAMT*
  L,VTM,1-14
 :L,XTA,MC*+13
  L,ATX,MC/+13
  L,VLM,*-1
C.....   KAPTY ПPOЗAПAC
   ,CALL,MONREAD*
C.....   ПPOБA '*END RECORD'
   ,XTA,MC/
   ,AEX,*EOR
  J,VTM,FIN
   ,UZA,PRI
  T,VTM,9
   ,CALL,PARAMT*
  L,VTM,6
  J,VTM,PARAM
C.....   ПEЧATЬ BBEДEHHOЙ KAPTЫ
 PRI:,BSS,
  M,VTM,MC/
   ,ITS,M
  M,UTM,13
   ,ITS,M
   ,ITS,L
   ,UJ ,PRINT8
 PARAM:,BSS,
C-----   ЧTEHИE OЧEPEДHOГO ИMEHИ
  T,VTM,3
   ,CALL,PARAMT*
  E,J+M,ER
  R,VTM,NEXT
  L,VZM,PAR1.B KOHЦE
  N,VZM,PAR1.KAPTЫ
 FP,VZM,PAR1.ЗAПЯTYЮ
 CK,V1M,MIST.MOЖHO
 PAR1:,BSS,.OПYCKATЬ
   ,ATX,NAME
C-----   PAЗБOP CИMBOЛA-OГPAHИЧИTEЛЯ
  D,VZM,*EOC
  D,MTJ,SD
 SD,UTM,-/PLUS
 SD,VZM,*PLUS.CИMBOЛ +
 SD,UTM,/PLUS-/COM
 :N,V1M,*+1
 FP,VZM,MIST.= ПYCTOE ИMЯ
 FP,VTM,
 SD,VZM,*COM.CИMBOЛ ,
 SD,UTM,/COM-/LPAR
 SD,VZM,*LPAR.CИMBOЛ (
 SD,UTM,/LPAR-/RPAR
 SD,VZM,*RPAR.CИMBOЛ )
 SD,UTM,/RPAR-/TWOP
 SD,V1M,MIST.ПЛOXOЙ OГPAHИЧ.
C-----   OГPAHИЧИTEЛЬ = ДBOETOЧИE
C        ЗAДAHИE CПИCKA БИБЛИOTEK
C/////   CПИCOK ДOЛЖEH ЗAДABATЬCЯ
C        HA OTДEЛЬHOЙ KAPTE
  L,VZM,MIST
  A,MTJ,L
   ,CALL,NEWLIBR/
 S/NAM:,BSS,
  L,VZM,MIST.HET PAЗДEЛA
  L,UTM,-2
  L,XTA,TREE
   ,AEX,NAME
   ,U1A,S/NAM
C..... HOMEPA БИБЛИOTEK (HE БOЛEE 4-X)
C      BПИCЫBAEM B 16-39 P. XAPAKT-KИ.
   ,XTA,LTAPES
   ,ASN,64-15
  L,AEX,TREE+1
   ,AAX,=7 7777 7770 0000
  L,AEX,TREE+1
  L,ATX,TREE+1
   ,XTA,CTN
   ,ATX,LTAPES
   ,UJ ,R CARD
 *PLUS:,BSS,
C-----   OГPAHИЧИTEЛЬ = ПЛЮC
   ,XTA,B48
   ,AEX,PLUS
   ,ATX,PLUS
   ,UZA,MIST
 CK,VZM,*EOC
C/////   ПЛЮC BHE CKOБOK MOЖET ПOЯB-
C        ЛЯTЬCЯ TOЛЬKO ПEPEД ИMEHEM
C        ГOЛOBHOГO PAЗДEЛA
  A,V1M,MIST
  N,V1M,MIST
   ,ATX,PL*
 *EOC:,BSS,
  N,VZM,WRI
 FP,VJM,WRI
 *COM:,BSS,
C-----   OГPAHИЧИTEЛЬ = ЗAПЯTAЯ
 CK,V1M,MIST
   ,UJ ,WRI
 *LPAR:,BSS,
C-----   OTKPЫBAЮЩAЯ CKOБKA
 CK,VZM,MIST
  R,VJM,WRI
 CK,VTM,
   ,UJ ,NEXT
 *RPAR:,BSS,
C-----   ЗAKPЫBAЮЩAЯ CKOБKA
 CK,V1M,MIST.HE БЫЛO (
  R,VJM,WRI
   ,XTA,B45
  A,AOX,TREE-1.  KOHEЦ
  A,ATX,TREE-1.CKOБOЧHOЙ ГPYППЫ
 CK,VTM,B47
 NEXT:,BSS,
  D,VZM,R CARD
   ,UJ ,PARAM
 WRI:,BSS,
C-----   ЗAПИCЬ XAPAKTEPИCTИKИ
  N,VZM,WRE
   ,XTA,NAME
  A,ATX,TREE
   ,XTA,PL*
   ,AOX,PLUS
 CK,AOX,
  A,ATX,TREE+1
  A,UTM,2-LTREE
  J,VTM,FIN1
  M,VTM,LONCAT
  A,VZM,PRIER
  A,UTM,LTREE
   ,XTA,
  A,ATX,TREE
   ,ATX,PLUS
 WRE:,BSS,
  L,VTM,
  R,UJ ,
 MIST:,BSS,
C/////   OШИБKA B KAPTE CXEMЫ ЗAГPYЗKИ
   ,XTA,
   ,ATX,PLUS
  M,VTM,ERCA
  J,VTM,NEXT
 PRIER:,BSS,
C/////   П/П ПEЧATИ OШИБOK
 ER,VTM,1
   ,ITS,M
  M,UTM,3
   ,ITS,M
   ,XTS,B1
   ,UJ ,PRINT8
 FIN:,BSS,
C=====   ПPИШЛA KAPTA '*END RECORD'
  J,VTM,FIN1
  M,VTM,EMPCAT.ПYCTOE
  A,VZM,PRIER.ДEPEBO
  M,VTM,ERPAR.CKOБKИ
 CK,VZM,PRIER.HE ЗAKPЫTЫ
  A,UTM,-2.EДИHCTB.
  A,VZM,FIN1.PAЗДEЛ
  A,XTA,TREE+1.EЩE OДИH
   ,AAX,B45.PAЗДEЛ
   ,UZA,PRIER.БEЗ CKOБOK
 FIN1:,BSS,
  M,VTM,ERTA
  J,VTM,STOP*
 ER,V1M,PRIER
   ,XTA,ERROFLG*.= OШИБOK HE БЫЛO
   ,U1A,BLEXPRIN
C
CC****   ФOPMИPOBAHИE BEKTOPA ЗAГPYЗKИ
C
  A,VTM,TREE
  J,VTM,FIN1
C-----   CCЫЛKИ HA BEДYЩИE PAЗДEЛЫ
 VECT:A,UTM,2
 A,XTA,
 ,UZA,VECT1
 A,XTA,1
 ,AAX,B47.ЛEBAЯ ЧACTЬ
 ,UZA,VECT. = HET
C.....   ПOИCK ИMEHИ B ПPABЫX ЧACTЯX
  C,VTM,TREE
  L,VTM,1
 VEC:C,UTM,2
 C,XTA,
 ,UZA,VECT
 A,AEX,
   ,U1A,VEC.= HE COBПAЛO
C/////  OПИCAHИE PAЗДEЛA  ДOЛЖHO ЗAДA-
C       BATЬCЯ ПOCЛE OПИCAHИЙ BCEX BЫ-
C       ЗЫBAЮЩИX  EГO  PAЗДEЛOB, ЧTOБЫ
C       БЫЛO ПPOЩE ПPECEЧЬ PEKYPCИBHЫE
C       BЫЗOBЫ.
  M,VTM,SOONDF
  L,VZM,PRIER
   ,ITA,C
   ,ITS,A
  S,AEX,
   ,ATI,L
  L,VZM,VEC.= ПPOBEP.ИMЯ
  C,XTA,1
   ,AAX,B47
C/////  ПOBTOPHO OПИCAHA CXEMA PAЗДEЛA
  M,VTM,DUPDEF
   ,U1A,PRIER
   ,ITA,A
  C,AOX,1.CTABИM CCЫЛKY
  C,ATX,1.HA ЛEBYЮ ЧACTЬ
   ,UJ ,VEC
C-----   MИHИMИЗAЦИЯ ДEPEBA ЗAГPYЗKИ
 VECT1:,BSS,.БYДEM
   ,XTA,B1.ПOPTИTЬ
   ,ATX,KC*+2.OБM.ЛИCT
  A,VTM,TREE
  C,VTM,BUFP-2
   ,XTA,
  L,VTM,1-LCAT
 :L,ATX,BUFP+LCAT-1
  L,VLM,*
  L,VTM,-10B
 NL,VTM,2.YPOBEHЬ
C.....   ПEPBЫЙ PAЗДEЛ (YPOBEHЬ 1)
  A,XTS,.PAЗДEЛ
   ,AEX,MON*.MONITOR*
   ,UZA,CH V .B KAT.HE ПИШEM
  A,XTA,
  C,UTM,2
  C,ATX,
   ,XTA,B1
  C,ATX,1
C.....   PEKYPCИBHOE ИЗBЛEЧEHИE BETBEЙ
 CH V:,BSS,
  A,UTM,2
  A,XTA,
   ,UZA,END BR.EДИHCTB.PAЗД.
  C,UTM,4-ECAT
  M,VTM,LONCAT
  C,VZM,PRIER
  C,UTM,ECAT-2
  C,ATX,
  A,XTA,1
   ,ATI,M
   ,AAX,B48*L
   ,ITS,NL
  S,AOX,
  C,ATX,1
  M,VZM,CH BR
C.....   ПOЙДEM HA ПOДCXEMY
   ,ITA,A
   ,XTS,
  M,MTJ,A
 NL,VLM,CH V
C.....   ПPOBEPKA KOHЦA BETBИ
 CH BR:,BSS,
  A,XTA,1
   ,AAX,B45
   ,UZA,CH V
C.....   KOHEЦ BETBИ
 NL,UTM,-1
 END BR:,BSS,
   ,STX,
   ,ATI,A
   ,U1A,CH BR
   ,XTA,BUFP
  M,VTM,EMPCAT
   ,UZA,PRIER
C
CC****  HACTPOЙKA CБOPKИ CTAT.PAЗДEЛOB
C
C-----   ЗAПИCЬ ДATЫ , KOMMEHTAPИЯ
   ,XTA,TOV
   ,ATX,ECAT
   ,XTA,TOV+1
   ,ATX,ECAT+1
   ,XTA,D*
   ,ATX,ECAT+2
   ,XTA,D*+1
   ,ATX,ECAT+3
 :L,XTA,C*COM+10B
  L,ATX,ECAT+4+10B
  L,VLM,*-1
 AW,VTM,-2000B
C.....   ПEЧATЬ ЗAГPYЗKИ / HET ПPИ CБOPKE
   ,XTA,ALFA
   ,ATX,CALFA
   ,XTA,SAV*47
   ,ATX,CRCAT
   ,XTA,LOADLIS*
   ,U1A,TL 1
   ,XTA,ALFA
   ,ASN,64-1
   ,ASN,64+1
   ,ATX,ALFA
 TL 1:,BSS,
C.....   ИHФOPMAЦИOHHЫE CЛOBA ЭK70
   ,XTA,IT0
   ,ARX,ITC
   ,ATX,ITC
   ,XTA,LIM NZ
  B,VTM,LOADER.БAЗA
  R,VJM,IWSET
   ,XTA,ITL
   ,ATX,ECAT+15B
   ,ATX,LIM NZ
   ,XTA,B1
  C,VTM,BUFP
  R,VJM,IWSET
C.....   YPOBEHЬ ЗAГPYЗKИ
  C,XTA,1
   ,ATI,NL
C.....   CTPEЛKИ ЗAГPYЗKИ
 ,XTA,RM*
   ,ATX,ALF1
 ,XTA,RM*+1
 ,ATX,ALF2
C-----   ПEPEПИCЬ CБOPЩИKA B MAГAЗИH
   ,XTA,RM*+2
   ,ATI,S
  S,MTJ,B
  B,UTM,12B
 DIF:,EQU,ELOADER-LOADER
 L,VTM,-DIF
 ,NTR,3
 TL 6:L,XTA,ELOADER
 L,UTC,DIF
 B,CTX,
 L,VLM,TL 6
  B,UJ ,
C
CC************************************
C
 LOADER:B,REL,*
C
CC** CБOPЩИK И ПИCATEЛЬ PAЗДEЛOB HA MЛ
C
   ,LOC,73413B
  C,XTA,
   ,ATX,NAME
   ,UZA,FIN LOAD
   ,ITA,NL.YPOBEHЬ ЗAГPYЗKИ
  C,AEX,1.  ПOДXOДИT
   ,AAX,C77777
   ,UZA,LOAD. = ДA
C=====  BOЗBPAT HA ПPEДЫДYЩИЙ YPOBEHЬ
 NL,UTM,-1
   ,XTA,PAP
   ,ATI,M.AДPEC PAЗДEЛA
C        :  , U1A ,*+1
C           , 32  ,.MYPИЩA!
C.....   BOCCTAHOBИM CTPEЛKИ ЗAГPYЗKИ
  M,XTA,1
   ,ATX,ALF1
  M,XTA,2
   ,ATX,ALF2
  M,XTA,7
   ,ASN,64+30
   ,ATX,PAP
   ,UJ ,LOADER
 LOAD:,BSS,
C
C=====   ЗAГPYЗKA PAЗДEЛA
C
C.....   CЛEДYЮЩAЯ ПAPA KOMAHД
C        ЗAБИBAETCЯ HYЛEM, ECЛИ
C        PAЗPEШEHA PACCЫЛKA BBEPX
C
   ,XTA,.PEAKЦИЯ HA DATA
   ,ATX,RETN.  BBEPX
   ,ITA,NL
   ,AEX,B2
   ,U1A,LOAD1
C-----   ДOЗAKAЗ OБCП
  C,XTA,1
   ,ASN,64-9
   ,ASN,64+24
  :,U1A,*+1
   ,XTA,CTN
   ,ATX,LTAPES
C-----  CПACEHИE/BOCCT.COCTOЯHИЯ TEMPO
   ,XTA,FRES
   ,UZA,LOAD1.HE HAДO
   ,*72,ICCT
   ,XTA,CLDRM.YЖE CПACAЛИ
   ,U1A,RES CT. - ДA
C.....   ЗAПOMИHAHИE COCTOЯHИЯ
C        ИЩEM ПOCЛEДHИЙ TPAKT KATAЛOГA
  P,VTM,-7
   ,XTA,RCAT
  J,VJM,RBEGP
 RCTW:,BSS,
  A,XTA,BUFP+1777B
   ,UZA,RCTE
  A,UTM,2
  L,VLM,RCTW
  J,VTM,RCTW
  P,VLM,RNEXP
   ,32 ,.HE HAШЛИ!
 RCTE:,BSS,
   ,XTA,IRD.ИHФ.CЛOBO
   ,AEX,B40.ЗAПИCИ
   ,ATX,IWCT.ПOCЛ.TPAKTA
   ,XTA,LDRM.CBOБOДHO
   ,ATX,CLDRM.B TEMPO
   ,UJ ,END CT
 RES CT:,BSS,
C.....   BOCCTAHOBЛEHИE COCTOЯHИЯ
   ,ATX,LDRM.CBOБOДHO
   ,DRUM,IWCT.ПOCЛ.TPAKT
 END CT:,BSS,.ЛИCTЫ
   ,*72,ICCT.ПO MECTAM
 LOAD1:,BSS,
C-----   ПOXOД HA ДИHAM.ЗAГPYЗЧИK
   ,XTA,ALF2
   ,ATI,P
  P,ATX,2.CTAPAЯ 17B
   ,ARX,C10
   ,ATX,ALF2
   ,ITA,P
   ,ATX,AP
   ,DRUM,WLEX.CПAC.OБM.ЛИCTA
  P,MTJ,A
   ,DRUM,RLOAD.ЧTEH.ЗAГPYЗЧИKA
   ,XTS,NAME
  J,VJM,BUFP+2.HA ЗAГPYЗЧИK
C-----   ДOДEЛAEM CЛYЖEБHЫE CЛOBA
   ,XTA,ALF1
  P,ATX,5.HOBAЯ 16B
   ,XTA,PAP
   ,UZA,FIR*LEV
   ,ASN,64-15
  C,MTJ,M
  M,UTM,2-BUFP
   ,ITS,M
  S,AEX,
   ,ASN,64-15
 FIR*LEV:,BSS,
   ,AOX,SECENTRY
  P,ATX,7
   ,XTA,ALF2
  P,ATX,6.HOBAЯ 17B
C.....   HACTPOЙKA ЗAПИCИ PAЗДEЛA
   ,AAX,C77777
   ,ITS,P
   ,ATX,PAP
  S,X-A,
   ,ATI,L.ДЛИHA P-OБЛACTИ
C.....   ПOДГOTOBИM XAP-KY B KATAЛOГE
   ,ASN,64-15
   ,AOX,AP
   ,AOX,XT
C..... ПPOCTABИM B46 - ПPИЗHAK MIXLOAD
   ,AOX,FMIX
  C,XTS,1
   ,AAX,B48
  S,AOX,
  C,ATX,1
C
C=====   ЗAПИCЬ PAЗДEЛA HA ЛEHTY
C
C.....  ПEPEД ЗAПИCЬЮ PAЗДEЛA HA ЛEHTY
C       "OБMEHЯEM" OБM.ЛИCT C 47 ФOPM.
   ,*72,ICCO
C-----   ПOЛYЧEHИE COSY-VOLKOV
 PRESS:,BSS,
  L,VZM,MIX
 MM,VTM,.CЧETЧИK COBПAД.
 NN,VTM,-1.CЧETЧИK HECOBП.
C.....   ПOИCK COBПAДAЮЩEЙ ГPYППЫ
 SE/EQ:,BSS,
 NN,UTM,1.CЧET.HECOBП.
  L,VZM,WRI1
  A,UTM,1
  L,UTM,-1.OCTAЛOCЬ
  L,VZM,SE/EQ.- 1 CЛOBO
  A,XTA,-1
   ,ATX,ETAL
  A,AEX,.COBПAЛO
   ,U1A,SE/EQ. = HET
   ,XTA,ETAL
   ,UZA,EQU0.HYЛЬ-ЭKOHOMИM
  L,MTJ,M
  M,UTM,-1.OCTAЛOCЬ
  M,VZM,SE/EQ.- 2 CЛOBA
  A,AEX,1.ПO HEHYЛЯM
 EQU0:,BSS,.MИHИMYM =
   ,U1A,SE/EQ.3 COBПAДEHИЯ
 MM,VTM,1
 EQU:,BSS,
C.....   ПOИCK KOHЦA COBП.ГPYППЫ
 MM,UTM,1.CЧET.COBПAД.
  A,UTM,1
  L,UTM,-1.OБЩAЯ ДЛИHA
  L,VZM,WRI1
   ,XTA,ETAL
  A,AEX,
   ,UZA,EQU
C-----  ЗAПИCЬ ПOЛHOЙ ГPYППЫ C XAP-KOЙ
 WRI1:,BSS,
C.....   ПOЛYЧEHИE XAPAKTEPИCTИKИ
   ,ITA,MM
   ,ASN,64-15
  :,U1A,*+1
   ,ATX,ETAL
   ,ITS,NN
   ,XTS,ETAL
  :,UZA,*+1.ЭTAЛOH = 0
   ,XTA,B48
  S,AOX,
  S,AOX,
  R,VJM,WORD.ЗAПИCЬ XAP-KИ
   ,XTA,ETAL
   ,UZA,LWRI
  R,VJM,WORD.ЗAПИCЬ ЭTAЛOHA
C.....   ЗAПИCЬ HECOBПAДAЮЩИX
 LWRI:,BSS,
 NN,VZM,EWRI
  P,XTA,
 NN,UTM,-1
  R,VJM,WORD
  P,VLM,LWRI
 EWRI:MM,J+M,P
 ,UJ,PRESS
 FINI:NL,UTM,1
C.....   PAЗДEЛ YПИCAH. "OБMEHЯEM OБPATHO"
C        OБM.ЛИCT И 47-Й ФOPMAЛЬHЫЙ.
   ,*72,ICCO
  C,UTM,2
   ,UJ ,LOADER
 MIX:,BSS,
C-----   ЗAПИCЬ ФPAГMEHTA TPП ДЛЯ
C        ДAHHOГO PAЗДEЛA
 EN,V1M,FINT
   ,XTA,AP
   ,ATI,P
   ,ARX,C10
   ,AEX,ALF2
   ,AAX,C77777
   ,UZA,VOID FR.ПYCTOЙ PAЗДEЛ
   ,*72,ICLL
  P,XTA,2
   ,ASN,64+30
  S,ATX,
   ,ASN,64+10
   ,ATI,MM
   ,ARX,IRLL
  J,VJM,RBEGP
 MM,UTM,1
   ,XTA,FRAG TPП
  R,VJM,WORD.ПP-K ФP-TA TPП
   ,XTA,ALF2
   ,ASN,64+30
  S,A-X,-1.ДЛИHA
   ,STI,NN.ФP-TA
   ,AAX,C1777.N CЛOBA
   ,ATI,A.ПO ЛИCTY
  A,UTM,-1777B
   ,ITS,MM.N ЛИCTA + 1
   ,ASN,64-15
  S,AOX,.XAPAKTEPИCTИKA
  R,VJM,WORD.ФPAГMEHTA TPП
  J,VTM,COP FR
 COP FR:,BSS,
C.....   ПEPEПИCЬ CЛOBA TPП
 NN,VZM,END FR
 NN,UTM,-1
  A,XTA,LDLP+1777B
  R,VJM,WORD
  A,VLM,COP FR
   ,UJ ,RNEXP
 END FR:,BSS,
   ,*72,ICLL
   ,XTA,
 VOID FR:,BSS,.KOHEЦ ФPAГMEHTA
  R,VJM,WORD. - HYЛEBOE CЛOBO
C-----  KOHEЦ PAЗДEЛA , ДOПOЛHИM 40-KY
 FINT:,ITA,AW
 ,AAX,C37
 ,UZA,FINI
 ,XTA,
 R,VTM,FINT
 WORD:,BSS,
C=====   П/П : ЗAПИCЬ CЛOBA HA ЛEHTY
 AW,UTM,1
 AW,ATX,BUFP+1777B
   ,XTA,B26
   ,ARX,XT
   ,ATX,XT
  R,UTC,
 AW,V1M,
 AW,VTM,-2000B
   ,XTA,ITL
   ,A-X,LIM NZ
  R,UZA,
   ,TAPE,ITL
   ,XTA,B1
   ,UTC,ITL-ITC
 IWSET:,BSS,
   ,ARX,ITC
   ,ATX,ITL
   ,ARX,B16
   ,AAX,B18
  R,U1A,
   ,XTA,ITL
   ,AAX,C3740
   ,ASN,64-7
   ,ARX,ITL
   ,AAX,Z12/6
   ,ATX,ITL
  R,UJ ,
 FIN LOAD:,BSS,
C
CC****   ЗABEPШEHИE PAБOTЫ CБOPЩИKA
C
   ,XTA,XT.XAPAKTEPИCTИKA
  C,ATX,1. 'CBOБOДHO'
   ,AUX,UPM
   ,AOX,CGT
   ,ATX,TДЛИ+3
C.....   ПPOБЫ HA ДOCБPOC БYФEPA
   ,*72,ICCO
 :R,VTM,*
   ,ITA,AW
   ,AAX,C1777
   ,UZA,FLO 1.ЛИCT ЗAПИCAH
   ,XTA,
   ,UJ ,WORD
 FLO 1:,BSS,
   ,*72,ICCO
   ,XTA,LIM NZ
   ,A-X,ITL
  A,VTM,TMAЛ
   ,UZA,HE MAЛ
   ,XTA,
   ,ATX,ECAT+15B
   ,PRINT,IPRI
 HE MAЛ:,BSS,
   ,TAPE,ITC
  A,UTM,TДЛИ-TMAЛ
   ,PRINT,IPRI
   ,XTA,CALFA
   ,ATX,ALFA
   ,XTA,CRCAT
   ,ATX,RCAT
   ,XTA,CTN
   ,ATX,LTAPES
   ,UJ ,MONITOR*+1
C=====   П/П : ЧTEHИE TPAKTA C MБ
 RNEXP:,BSS,
   ,XTA,B1
   ,ARX,IRD
 RBEGP:,BSS,
   ,ATX,IRD
   ,DRUM,IRD
  A,VTM,-1777B
  L,VTM,-777B
  J,UJ ,
C
C-------------------------------------
C
 IPRI:A,   ,
  A,   ,
 :0,001,
  8,   ,
 ICCO:2,047,/NB+77B
   ,   ,
 ICCT:2,043,/NB+77B
   ,   ,
 ICLL:2,042,/NL+77B
   ,   ,
 IRLL:,010,/NL
   ,020,
C((((((((
 ITC:,   ,/NB
   ,   ,
 IT0:,LOG,60 0000
 LIM NZ:,LOG,1000
 XT:,OCT,0000 4
C))))))))
 Z12/6:,OCT,7777 7777 7777 0037
 B48:,OCT,4
 B47:,OCT,2
 B40:,OCT,001
 B26:,OCT,0000 0002
 B18:,LOG,40 0000
 B16:,LOG,10 0000
 C77777:,LOG,77777
 C3740:,LOG,3740
 C1777:,LOG,1777
 C37:,LOG,37
 C10:,LOG,10
 B2:,LOG,2
 B1:,LOG,1
 FRAG TPП:,TEXT,8HFRAG TPП
 TMAЛ:,GOST,18H***  MAЛO MЛ  ***'231'
 TДЛИ:,GOST,25HДЛИHA БИБЛИOTEKИ  077 37'231'
 UPM:,GOST,6H'367'77037
 CGT:,GOST,6H000 00
 CALFA:,BSS,1
 CRCAT:,BSS,1
 CLDRM:,BSS,1
 CTN  :,BSS,1
 FMIX:,OCT,1
 FRES:,BSS,1
 ITL :,BSS,1
 IWCT:,BSS,1
 NAME:,BSS,
 ETAL:,BSS,1
 AP  :,BSS,1
 PAP :,OCT,
 IRD :,BSS,
 ELOADER:,BSS,1
CC************************************
 ,LOC,*
 NONTEX:,ISO,24HHETEKCTOBAЯ KAPTA
 ERCA  :,ISO,24HOШ.KAPTA CXEMЫ ЗAГPYЗKИ
 ERPAR :,ISO,24HHET ЗAKPЫBAЮЩEЙ CKOБKИ
 LONCAT:,ISO,24HCЛИШKOM MHOГO PAЗДEЛOB
 EMPCAT:,ISO,24HПYCTAЯ БИБЛ. PAЗДEЛOB
 SOONDF:,ISO,24HPAHOBATO OПИCAH PAЗДEЛ
 DUPDEF:,ISO,24HПOBTOP.OПИCAHИE ДEPEBA
 ERTA  :,ISO,24HБЫЛИ OШИБKИ B ЗAДAHИИ
 TOV:,ISO,12HOVERLAY OT
 *EOR:,ISO,6H*END R
 MON*:,TEXT,8HMONITOR*
 B48*L:,OCT,4007 7777 7770 0000
 B45:,OCT,04
C--------
 PLUS:,BSS,1
 PL*:,BSS,1
 C*COM:,BSS,9
C--------
 ,END,
 PANNO:,NAME,
C********** ДAHИЛOB Ю.Л. 31/10/87 ЛГЭM
C*
C*    ЗAПYCK PAЗЛИЧHЫX ЗAДAЧ ИЗ БCЗ
C*        B MAT.PEЖИME
C*    1) ЗAПYCK CИCTEMЫ "PANNO" :
C*    *MAIN PANNO
C*    *EXECUTE
C*    2) ЗAПYCK ЗAДAЧИ "APXИBAPИYC" :
C*    - C ПEЧATЬЮ ПPOTOKOЛA
C*    *MAIN ARCHI***
C*    *EXECUTE
C*    - БEЗ ПPOTOKOЛA
C*    *MAIN ARCHIV**
C*    *EXECUTE
C*    3) ЗAПYCK ЗAДAЧИ "ПPOCMOTP MЛ" :
C*    - C ПEЧATЬЮ ПPOTOKOЛA
C*    *MAIN PRINTAPE
C*    *EXECUTE
C*    -БEЗ ПPOTOKOЛA
C*    *MAIN LOOKTAPE
C*    *EXECUTE
C*
C*************************************
C
C     ЗAHИMAET MECTO FICT.
C     BЫПOЛHЯET ФYHKЦИИ SPECMON.
C-------------------------------------
 RM*:,LC,5
 INFLOAD*:LC,BLOCK,ALOAD,INFLOA,(2)
 /VERE/:LC,BLOCK,(2),M/STL,A/CAT,INF0
C---
 BEGIN:,BSS,.= 1000B !!!
 14,VTM,*
 14,UTM,-1000B
 14,VIM,NOTAPE
 ,DRUM,INFLOA.ЧTEHИE STATICLO
 ,XTA,CODE76
 ,*76,1
 REQ:,BSS,
 13,VTM,66B
 ,*57,3
 ,XTA,LIBMT.ЗAXBAT ЛEHTЫ
 ,*57,2040B.C БCЗ
 ,UZA,NOTAPE
 ,AAX,=:3
 ,UIA,REQ.ЗAHЯTA/HEГOT
 ,XTA,RM*+2.БAЗA
 ,ATX,ALOAD.STATICLO
 ,TAPE,/FIZIM.ЧT.KATAЛOГA БCЗ
 ,XTA,=1100.MECTO TASK
 ,ATX,17B
 ,XTA,/FIZIM
 ,ATX,M/STL
 ,ATX,A/CAT
 ,ATX,INF0
C
C-----  ПOCЛE ЗAГPYЗKИ - ПY HA БЛOK
C       OTKAЗA OT ЛEHTЫ C БCЗ.
 ,XTA,TOREF
 ,CTX,1000B.
 ,XTA,
 ,ATX,1077B
 ,XTA,TASK
 ,ATX,1070B
 ,WTC,ALOAD.ПOXOД HA
 13,VJM,   .STATICLO
 NOTAPE:,SJ,
C-----
C
C
C
  PRINTAPE:,ENTRY,
  ,UTC,1
  LOOKTAPE:,ENTRY,
  1,VTM,3
  ,XTA,TASK63
  ,ATX,TASK
  ,UJ,BEGIN
C
  ARCHI***:,ENTRY,
  ,UTC,1
  ARCHIV**:,ENTRY,
  1,VTM,
  ,XTA,TASK41
 ,ATX,TASK
  ,UJ,BEGIN
C
 REFTAP:,BSS,
 ,XTA,BIT66
 ,*57,4000B
 ,WTC,1077B
 ,UJ,
C-------------------------------------------
 TO REF:,UJ,REFTAP
 CODE76:,LOG,3053457616340112
 BIT66:,LOG,40 0000
 /FIZIM:,LOG,10 3700 0066 0000
 LIBMT:,TEXT,8HD73LIB '5'
 TASK:,TEXT,8HTASK47
  TASK41:,TEXT,8HTASK41
  TASK63:,TEXT,8HTASK63
 ,END,
      PAS        :,NAME,
                 ,UTC,  1
                 ,UTC,
      PAK       :,ENTRY,
                 ,UTC,  1
                 ,UTC,
      UNP       :,ENTRY,
            12 ,  VTM,
                 ,ATI,  11
            11 ,  XTA,
                 ,STI,  11
                 ,STI,  10
                 ,ATI,  9
             8 ,  VTM,   *00022
            12 ,  VZM,   *00032
            12 ,  UTM,  77777B
            12 ,  VZM,   *00022
                 ,STX,
                 ,ATI,  12
            12 ,  XTA,
                 ,UZA,   *00041
                 ,ASN,  75B
                 ,ATI,  12
             8 ,  XTA,  23B
            12 ,  ASN,  20B
             9 ,  AAX,
                 ,UTC,
 *00014    : 9 ,  ATX,
            10 ,  XTA,
            12 ,  ASN,  20B
            15 ,  ATX,
                 ,YTA,
             9 ,  AOX,
             9 ,  STX,
             9 ,  UTM,  1
            10 ,  UTM,  1
            11 ,  UTM,  77777B
            11 ,  VIM,   *00014
                 , UJ,   *00041
 *00022    :12 ,  VTM,  77773B
                 ,UTC,
 *00023    :     ,ASN,  70B
             8 ,  XTS,  20B
            11 ,  VZM,   *00027
            11 ,  UTM,  77777B
            10 ,  XTA,
            10 ,  UTM,  1
                 ,ASN,  70B
                 ,YTA,
 *00027    :15 ,  AOX,
            12 ,  VLM,   *00023
             9 ,  ATX,
             9 ,  UTM,  1
            11 ,  VIM,   *00022
                 , UJ,   *00041
 *00032    : 9 ,  XTA,
             9 ,  UTM,  1
                 ,UIA,   *00034
             8 ,  XTA,  22B
 *00034    :     ,UZA,   *00032
            15 ,  ATX,
             8 ,  AAX,  24B
             8 ,  AOX,  21B
            10 ,  STX,
            10 ,  UTM,  1
            11 ,  UTM,  77777B
                 ,ASN,  70B
            11 ,  VIM,   *00034
                 , UJ,   *00041
 *00041    :     ,STX,
            13 ,   UJ,
 *00042    :,     LOG,  00000000 00000040.
            ,     LOG,  00020040 10020040.
            ,     LOG,  11022044 11022044.
            ,     LOG,  77777777 77777777.
            ,     LOG,  77600000 00000000.
 BSS       :     ,BSS,
      ,END,
 PASCAL*:,NAME,.BЫЗOB PASCOMPIL
 NOLISFL*:,LC,.
  ,ITA,13
  ,XTS,NOLISFL*
 ,UIA,GO.
 ,CALL,DATAPR*.
 GO:,BSS,.
  ,CALL,*PASCAL
 15,WTC,
 ,UJ,.
 ,END,PASCAL*.
      PERCOSY     :,NAME,
      REVCARD     :,SUBP,
      BIGBUF      :,LC, 01453B
      BIGPUNCH    :,SUBP,
      RASPAK12    :,SUBP,
      ZAPAK12     :,SUBP,
      CHECKSUM    :,SUBP,
     *00000B:     8     ,VTM,      *00000B
                  8     ,ATX ,00153B
                  14    ,VTM, 77775B
                        ,UTC, 00000B
     *00002B:     14    ,UTC,      *00124B
                        ,XTA ,
                  14    ,UTC,      *00130B
                        ,ATX ,
                  14    ,VLM,      *00002B
                        ,XTA ,
                  8     ,ATX ,00167B
                        ,ITA ,13
                  8     ,ATX ,00170B
                  8     ,XTS ,00153B
                  14    ,VTM,      *00133B
                        ,ITS ,14
                  13    ,VJM, BIGPUNCH
                        ,STI ,11
                  8     ,VTM,      *00000B
                        ,UJ,       *00024B
                        ,UTC, 00000B
                  8     ,VTM,      *00000B
                  8     ,XTA ,00161B
                  8     ,ATX ,00127B
                  8     ,ATX ,00170B
                  8     ,AOX ,00130B
                  8     ,ATX ,00130B
                  13    ,MTJ ,11
                        ,UJ,       *00024B
                  8     ,VTM,      *00000B
                  11    ,VJM,      *00024B
                        ,WTC,      *00125B
                        ,ATX ,
                  8     ,XTA ,00125B
                  8     ,ARX ,00155B
                  8     ,ATX ,00125B
                        ,U1A,      *00106B
                  8     ,ATX ,00170B
                        ,UJ,       *00106B
     *00024B:           ,ITS ,11
                  8     ,ATX ,00171B
                  8     ,XTA ,00170B
                        ,U1A,      *00027B
                        ,STX ,
                  11    ,UJ,  00000B
     *00027B:     9     ,VTM, 77771B
                  8     ,XTA ,00117B
                  8     ,AEX ,00156B
                        ,ASN ,62
                  8     ,ATX ,00157B
                  8     ,XTA ,00120B
                  8     ,AEX ,00156B
                        ,ASN ,62
                  8     ,ATX ,00160B
                        ,ITA ,13
                        ,XTS ,
                        ,UTC, 00000B
     *00035B:     10    ,VTM, 77771B
                        ,UTC, 00000B
     *00036B:     8     ,XTS ,00157B
                  13    ,VJM, RASPAK12
                  8     ,XTS ,00160B
                  13    ,VJM, ZAPAK12
                  8     ,XTA ,00157B
                  8     ,ARX ,00161B
                  8     ,ATX ,00157B
                  8     ,XTA ,00160B
                  8     ,ARX ,00161B
                  8     ,ATX ,00160B
                  10    ,VLM,      *00036B
                        ,XTS ,
                  8     ,XTS ,00160B
                  13    ,VJM, ZAPAK12
                  8     ,XTA ,00160B
                  8     ,ARX ,00161B
                  8     ,ATX ,00160B
                  9     ,VLM,      *00035B
                  14    ,VTM,      *00130B
                        ,ITA ,14
                  13    ,VJM, CHECKSUM
                        ,ASN ,52
                  8     ,AOX ,00130B
                  8     ,ATX ,00130B
                  11    ,VJM,      *00107B
                  8     ,XTS ,00126B
                  14    ,VTM,      *00130B
                        ,ITS ,14
                  13    ,VJM, REVCARD
                        ,WTC,      *00126B
                  14    ,VTM, 00000B
                  14    ,MTJ ,13
                  13    ,UTM, 00026B
                  12    ,VTM, 77773B
                        ,UTC, 00000B
     *00060B:     14    ,XTA ,
                  13    ,XTS ,
                  14    ,STX ,
                  13    ,ATX ,
                  14    ,XTA ,00001B
                  13    ,XTS ,00001B
                  14    ,STX ,00001B
                  13    ,ATX ,00001B
                  14    ,UTM, 00002B
                  13    ,UTM, 77776B
                  12    ,VLM,      *00060B
                  8     ,VTM,      *00000B
                  8     ,XTA ,00130B
                  8     ,ARX ,00162B
                  8     ,AAX ,00163B
                  8     ,ATX ,00130B
                  8     ,XTA ,00127B
                        ,UZA,      *00074B
                  11    ,VTM,      *00103B
                  8     ,XTA ,00126B
                  8     ,ARX ,00164B
                  8     ,ATX ,00126B
                        ,UJ,       *00110B
                        ,UTC, 00000B
     *00074B:     14    ,VTM, 77757B
                        ,XTA ,
     *00075B:     14    ,UTC,      *00152B
                        ,ATX ,
                  14    ,VLM,      *00075B
                  8     ,ATX ,00170B
                  8     ,XTA ,00121B
                  8     ,ATX ,00125B
                  8     ,XTA ,00126B
                  8     ,ARX ,00164B
                  8     ,ATX ,00126B
                        ,U1A,      *00103B
                  8     ,ATX ,00167B
                        ,UTC, 00000B
     *00103B:           ,STX ,
                        ,STI ,13
                        ,WTC,      *00171B
                        ,UJ,  00000B
                        ,STX ,
                        ,ATI ,13
     *00106B:           ,STX ,
                  13    ,UJ,  00000B
     *00107B:     8     ,XTA ,00167B
                  11    ,UZA, 00000B
     *00110B:     9     ,VTM, BIGBUF
                        ,WTC,      *00126B
                  10    ,VTM, 77777B
                        ,XTA ,
                  10    ,ATX ,00001B
                  10    ,ATX ,00002B
                  8     ,*71 ,00165B
                  8     ,XTA ,00122B
                  8     ,ATX ,00126B
                        ,XTA ,
                  8     ,ATX ,00167B
                  11    ,UJ,  00000B
                        ,UTC, 00000B
                  3      ,100,
                        ,UTC,      *00133B
                  3      ,100,
                        ,UTC,      *00131B
                  4     ,ATX ,
                        ,UTC,      *00133B
                        ,ATX ,
                        ,UTC, BIGBUF
CONST
     *00123B:,OCT,0000  0000  0000  0000
     *00124B:,OCT,5000  0000  0000  0000
     *00125B:,OCT,0000  0000  0000  0000
     *00126B:,OCT,0000  0000  0000  0000
     *00127B:,OCT,0000  0000  0000  0000
     *00130B:,OCT,0000  0000  0000  0000
     *00131B:,OCT,0000  0000  0000  0000
     *00132B:,OCT,0000  0000  0000  0000
     *00133B:,OCT,0000  0000  0000  0000
     *00134B:,OCT,0000  0000  0000  0000
     *00135B:,OCT,0000  0000  0000  0000
     *00136B:,OCT,0000  0000  0000  0000
     *00137B:,OCT,0000  0000  0000  0000
     *00140B:,OCT,0000  0000  0000  0000
     *00141B:,OCT,0000  0000  0000  0000
     *00142B:,OCT,0000  0000  0000  0000
     *00143B:,OCT,0000  0000  0000  0000
     *00144B:,OCT,0000  0000  0000  0000
     *00145B:,OCT,0000  0000  0000  0000
     *00146B:,OCT,0000  0000  0000  0000
     *00147B:,OCT,0000  0000  0000  0000
     *00150B:,OCT,0000  0000  0000  0000
     *00151B:,OCT,0000  0000  0000  0000
     *00152B:,OCT,0000  0000  0000  0000
     *00153B:,OCT,0000  0000  0000  0000
     *00154B:,OCT,0000  0000  0000  7777
     *00155B:,OCT,0100  0000  0000  0001
     *00156B:,OCT,0000  0000  0220  0000
     *00157B:,OCT,0000  0000  0000  0000
     *00160B:,OCT,0000  0000  0000  0000
     *00161B:,OCT,0000  0000  0000  0001
     *00162B:,OCT,0000  0001  0000  0000
     *00163B:,OCT,7777  7777  0000  7777
     *00164B:,OCT,0100  0000  0000  0030
     *00165B:,OCT,4410  0000  5010  0000
     *00166B:,OCT,0000  0000  0000  0000
     *00167B:,OCT,0000  0000  0000  0000
     *00170B:,OCT,0000  0000  0000  0000
     *00171B:,OCT,0000  0000  0000  0000
                  ,END,
      PERSTAND    :,NAME,
      BIGBUFER    :,LC, 10000B
      PNCBUFER    :,LC, 11300B
      SPBUFER     :,LC, 00620B
      C           :,EQU,           *00021B
 GAK/7:,EQU,     *00021B  -        *00021B
 GAL/1:,EQU,     *00027B  -        *00021B
 GAL/4:,EQU,     *00022B  -        *00021B
 GAM/4:,EQU,     *00030B  -        *00021B
 GAM/6:,EQU,     *00031B  -        *00021B
 GAN/1:,EQU,PNCBUFER      +   11277B
     *00000B:     14    ,VTM,      *00021B
                  14    ,XTA , GAK/7
                  14    ,STX , GAL/1
                  13    ,UJ,  00000B
     *00002B:           ,WTC,      *00027B
                        ,ATX ,
                  14    ,VTM,      *00021B
                  14    ,XTA , GAL/1
                  14    ,ARX , GAL/4
                  14    ,ATX , GAL/1
                  13    ,MTJ ,10
                        ,U1A,      *00020B
     *00006B:           ,WTC,      *00027B
                  12    ,VTM, 77777B
                  11    ,VTM, BIGBUFER
                  13    ,MTJ ,10
                  13    ,VTM, SPBUFER
                        ,UTC,      *00023B
                        ,LIB ,
                        ,ATX ,00032B
                  10    ,MTJ ,13
                        ,UJ,       *00000B
     *00013B:           ,XTS ,
                        ,UJ,       *00006B
     *00014B:     14    ,VTM,      *00021B
                  14    ,STX , GAM/4
                  14    ,ATX , GAM/6
                  13    ,MTJ ,10
                  13    ,VTM, SPBUFER
                        ,UTC,      *00025B
                        ,LIB ,
                        ,ATX ,00032B
     *00020B:           ,STX ,
                  10    ,UJ,  00000B
     *00021B:           ,ATX ,04000B
                        ,UTC, BIGBUFER
     *00022B:           ,ATX ,04000B
                        ,ATX ,00001B
     *00023B:     11    ,ATX ,
                  12    ,20,  00000B
                        ,UTC, PNCBUFER
                        ,UTC,  GAN/1
     *00025B:           ,20,       *00030B
                        ,20,       *00031B
                        ,UTC, PNCBUFER
                        ,UTC,  GAN/1
CONST
     *00027B:,OCT,0000  0000  0000  0000
     *00030B:,OCT,0000  0000  0000  0000
     *00031B:,OCT,0000  0000  0000  0000
                  ,END,
  POWER1:,NAME,
  R*TO*INT:,SUBP,
  13,MTJ,11
  ,CALL,POWER
  11,MTJ,13
  DENORM:,ENTRY,
  ,UJ,R*TO*INT
  ,END,
 PRI*NEWS:,NAME,
C*
C*  24.4.85.   T.Ф.CAПOЖHИKOBA
C*  ПEЧATЬ HOBOCTEЙ ДЛЯ ЮЗEPA,
C*  HOMEP PASS'A KOTOPOГO ЗAДAH HA
C*  CYMMATOPE (HAЧИHAЯ C 1)
C*
C************************************
C*   YKAЗATEЛЬ MECTA HOBOCTEЙ :
  IW70:,EQU,=0014 0000 0016 0032
C************************************
 BUFFER:PC,BLOCK,LIST1(1024),LIST2(1024)
 NP:,P/P,(LIST1)16
 NP1:,P/P,(LIST2)16
 8,BASE,*
 ,ATI,12.N PASS
 12,UTM,-1
C   ЧИTAEM БИБЛИOTEKY
 ,XTA,IN
 ,AOX,IW70
 ,ATX,INF
 ,AEX,=:001
 ,ATX,IWR
 ,*70,INF
 ,XTA,LIST1
 ,AEX,CODE
 13,U1A,.HET HOBOCTEЙ BOOБЩE
 11,VTM,.HET ИЗMEHEHИЙ
 ,ITA,12.HET ИЗMEHEHИЙ
 ,NTR,3
 ,A*X,=4000 5252 5252 5253.:24
 ,ATX,NWU.HOMEP CЛOBA, CЧИTAЯ C 0
 ,ASN,64-1
 ,ARX,NWU
 ,ASN,64-3
 ,ITS,12
 15,A-X,
 ,ASN,64-1.N ПOЗИЦИИ B 2-X БИTHOЙ ШKAЛE (0,2,4,...46)
 ,ATI,10
 ,XTA,=:6
 10,ASN,64
 ,ATX,MASKA
 ,AEX,=7777 7777 7777 7777
 ,ATX,NOMASK
 ,XTA,=:2
 10,ASN,64
 ,ATX,ADD1
 ,XTA,LIST1+1
 ,AAX,=77777
 13,UZA,
 ,ATX,NNEWS.K-BO COOБЩEHИЙ
 ,XTA,
 ,ATX,NTEKZ
 ,XTA,=3.AДPEC 1-OГO COOБЩEHИЯ
 CICL:,AAX,=777777
 ,ATX,NEWSAD
 ,ASN,64+10
 ,AEX,NTEKZ
 ,UZA,ISZ
 ,AEX,NTEKZ
 ,ATX,NTEKZ
 ,ARX,IW70
 ,AOX,IN
 ,ATX,INF
 :11,VZM,*+1
 ,*70,IWR.CБPOC
 ,*70,INF
 ,XTA,INF
 ,AEX,=:001
 ,ATX,IWR
 11,VTM,.HET ИЗMEHEHИЙ
 ISZ:,XTA,NEWSAD
 ,AAX,=1777
 ,ATX,OTNA.OTH.AДPEC HAЧAЛA COOБЩ.ПO ЗOHE,CЧИTAЯ C 0
 ,ATI,9
 9,ARX,LIST1
 ,ARX,=55
 ,AAX,=76000
 ,UZA,NOZ
 ,XTA,NTEKZ
 ,ARX,=1
 ,ARX,IW70
 ,AOX,IN1
 ,ATX,INF
 ,*70,INF
 NOZ:9,XTA,LIST1+1
 ,UZA,INCEV
 ,ITA,13
 ,ITS,11
 ,ITS,8
 14,VTM,BUF
 ,ITS,14
 ,CALL,DATE
 14,VTM,BUF
 ,ITS,14
 14,VTM,INF
 ,ITS,14
 ,CALL,DTOI
 ,STI,8
 ,STI,11
 ,ATI,13
 ,WTC,OTNA
 9,VTM,
 ,NTR,3
 9,XTA,LIST1+1
 ,A-X,INF
 ,UZA,OK
 ,XTA,
 9,ATX,LIST1+1
 ,UJ,CHANGE
 OK:,WTC,NWU
 9,XTA,LIST1+2
 ,AAX,MASKA
 ,UZA,INCEV
 ,AEX,MASKA
 ,U1A,RADD
 ,WTC,NWU
 9,XTA,LIST1+2
 ,AAX,NOMASK
 ,UJ,WRSC
 RADD:,WTC,NWU
 9,XTA,LIST1+2
 ,ARX,ADD1
 WRSC:,WTC,NWU
 9,ATX,LIST1+2
 9,UTM,LIST1+45
 ,*64,IW64
 ,XTA,NWU
 ,ARX,=1
 CHANGE:,ARX,OTNA
 ,ARX,=1
 11,VTM,1.ECTЬ ИЗMEHEHИЯ
 ,AAX,=76000
 ,UZA,INCEV
 ,XTA,IWR.ИЗMEHEHИЯ HA
 ,ARX,=0000 0100 0000 0001
 ,ATX,IWR.BTOPOM ЛИCTE
 INCEV:,WTC,NNEWS
 12,VTM,-1
 12,VZM,RET
 ,ITA,12
 ,ATX,NNEWS
 ,XTA,NEWSAD
 ,ARX,=55
 ,WTC,OTNA
 ,ARX,LIST1
 ,UJ,CICL
 RET:11,VZM,*+1
 ,*70,IWR
 13,UJ,
 IW64:9,Z00,
 9,Z00,
 ,Z00,
 9,Z00,
 CODE:,ISO,6H NEWS
 IN:,,NP
 ,,
 IN1:,,NP1
 ,,
 BUF:,BSS,3
 OTNA:,BSS,1
 NTEKZ:,BSS,1
 NNEWS:,BSS,1
 NEWSAD:,BSS,1
 NWU:,BSS,1
 INF:,BSS,1
 IWR:,BSS,1
 MASKA:,BSS,1
 NOMASK:,BSS,1
 ADD1:,BSS,1
 ,END,
 PRINPART:,NAME,.ПEЧATЬ TPП
C********* ДAHИЛOB Ю.Л. 19/10/83  ЛГЭM
C*
C*   BCПOMOГATEЛЬHAЯ ПPOГPAMMA ПEЧATИ
C*   ФPAГMEHTA TAБЛИЦЫ ЗAГPYЗKИ (TPП)
C*   ДЛЯ CTATИKO/ДИHAMИЧECKOЙ ЗAГPYЗKИ
C*            ( MIXLOAD )
C*
C*   OБPAЩEHИE COCTOИT ИЗ ЧTEHИЯ CEKTOPA
C*   C ДAHHOЙ ПPOГPAMMOЙ HA OБM.ЛИCT И
C*      ,XTA,ИMЯ PAЗД.C KOTOPOГO ПEЧATATЬ
C*    13,VJM,SYSP    .76000B
C*
C******************************************
 A/I0:,LC,1
 *1:,BLOCK,B,RW,RS,WW,WS,S,PA
 *8:,BLOCK,PC,P5,FA,PS,(1),R,W
 PGCL:,EQU,2000B
 BEG:,BSS,
 ,ATX,21B
 ,WTC,43B
 14,VTM,
 14,REL,BEG
 ,ITA,15
 15,VTM,SAVSPACE
 ,ITS,1
 1,VTM,1-13
 SAVE IN:1,ITS,14
 1,VLM,SAVE IN
 14,MTJ,B
 B,REL,BEG
 ,RTE,177B
 ,XTS,
 ,ATX,PG2
 ,DRUM,SAVP1
 PA,VTM,-2
 ,DRUM,LDCR1
C.....   HYЖEH ЛИ 2-Й ЛИCT ?
 ,XTA,17B
 ,ASN,64+30.31-45 PP.
 ,ATX,END
 ,AAX,C76000
 ,UZA,SRC
 ,DRUM,SAVP2
 ,DRUM,LDCR2
 ,XTA,B2
 ,ATX,PG2
C.....   ПOИCK TEБYEMOГO PAЗДEЛA B TPП
 SRC:PA,UTM,2
 PA,XTA,PGCL
 ,AEX,21B
 ,UZA,FOUND
 ,ITA,PA
 ,AEX,END
 ,U1A,SRC
 ,PRINT,NOT FOUND
 ,UJ,ENDPRINT.HE HAШЛИ PAЗДEЛA
C... CЧИTAEM ШAГ ПO TPП=KOЛ-BY CTPOK ПEЧATИ
 FOUND:,NTR,3
 ,ITA,PA
 ,X-A,END
 ,NTR,6
 ,ARX,B2
 ,AOX,A/I0
 ,A*X,C1/10
 ,A+X,C9/10
 ,FUN,7
 ,NTR,3
 15,ATX,
 ,AMX,A/I0
 15,AVX,
 ,AEX,A/I0
 ,ATI,PC
 ,ASN,64-1.ЭЛEMEHT TPП
 ,ATX,STEP. - 2 CЛOBA
 PA,UTM,PGCL
 W,VTM,PGCL
 ,ITA,W
 ,ARX,END
 ,ATX,END
 ,PRINT,SKIP
C.....   ГЛABHЫЙ ЦИKЛ ПEЧATИ ПO CTPOKAM
 CYCLE:,BSS,
 PS,VTM,T1
 P5,VTM,1-5.KOЛ-BO CTOЛБЦOB
 PA,MTJ,FA.FLOWING ADDRESS
 W,VTM,1-35
 ,XTA,
 NULL:W,ATX,T1+34
 W,VLM,NULL
 CY1:,BSS,
 ,ITA,FA
 ,X-A,END
 ,U1A,ECY 1
 ,NTR,7
 ,UZA,FREE
 FA,XTA,
 PS,ATX,1.ИMЯ B TEXT
 FA,XTA,1
 ,ASN,64-33
 ,AUX,MASC
 ,AOX,T 00000
 PS,ATX,2
 FA,XTA,1
 ,AAX,B48/16
 ,U1A,NOT ENT
 ,XTA,ENTRY
 ,UJ,C/E
 NOT ENT:,AAX,B48/31
 ,U1A,ECY1.NAME
C---  ИHAЧE - COMMON
 ,XTA,COMMON
 C/E:PS,AOX,2
 PS,ATX,2
 ECY 1:,ITA,FA
 ,ARX,STEP
 ,ATI,FA
 PS,UTM,3
 P5,VLM,CY 1
 R,VJM,CODE.TEXT->GOST+PRINT
 PA,UTM,2.ЭЛ-T=2 CЛOBAM
 PC,UTM,-1
 PC,V1M,CYCLE
 ,UJ,END PRINT
 FREE:,XTA,CBOБOДHO
 PS,ATX,1
 ,XTA,17B
 ,ASN,64-33
 ,AUX,MASC
 ,AOX,T 00000
 PS,ATX,2
 ,UJ,ECY 1
 END PRINT:,BSS,
 ,PRINT,SKIP
 ,DRUM,RESP1
 ,XTA,PG2
 ,UZA,RETURN
 ,DRUM,RESP2
  RETURN:,BSS,
 ,XTR,PAY
 15,VTM,PAY
 ,STX,
 14,VTM,13
 RESET:14,STI,
 14,UTM,-1
 ,WTC,43B
 14,V1M,RESET-BEG
 ,ATI,15
 13,UJ,
C.....   ПEPEKOДИPOBKA 'TEXT' B 'GOST'
 CODE:RW,VTM,T1
 RS,VTM,48
 WW,VTM,1-20
 W NEXT W:WS,VTM,-48
C.....   ЧTEHИE CИMBOЛA 'TEXT'
 RTEXT:RW,XTA,
 RS,ASN,64-48.ЭKOHOMИЯ
 ,ASN,64+42.C77
 RS,UTM,-6
 RS,V1M,COD1
 RS,VTM,48
 RW,UTM,1
C.....   ПEPEKOДИPOBKA CИMBOЛA
 COD1:15,ATX,
 ,ASN,64+2
 ,ATI,14
 ,ASN,64-2.ЭKOHOMИЯ
 15,X-A,.C3
 ,ASN,64-3
 ,ATI,S
 14,XTA,TABLE
 S,ASN,64+16
 ,ASN,64-40.ЭKOHOMИЯ C377
C.....   ЗAПИCЬ CИMBOЛA 'GOST'
 WS,ASN,64+48
 WW,AOX,TG+19
 WW,ATX,TG+19
 WS,UTM,8
 WS,V1M,RTEXT
 WW,VLM,W NEXT W
C.....   COБCTBEHHO ПEЧATЬ
 ,PRINT,INF P
 R,UJ,
 INFP:B,Z00,TG-BEG
 B,Z00,TG-BEG
 ,001,
 8,,
 SKIP:B,Z00,SKIP/-BEG
 B,Z00,SKIP/-BEG
 ,,
 8,,
 NOTFOUND:B,Z00,NFND-BEG
 B,Z00,NFND-BEG
 ,001,
 8,,
 TABLE:,BSS,
C... TAБЛИЦA ПEPEBEPHYTA BBИДY ЭKOHOMИИ C3
 00,GOST,6HЦБ,
 04,GOST,6HИГФД
 10,GOST,6HЙ*)(
 14,GOST,6H/ЖЯЛ
 20,GOST,6H3210
 24,GOST,6H7654
 30,GOST,6H:Ь98
 34,GOST,6HЫ+-П
 40,GOST,6HCBAЗ
 44,GOST,6HGFED
 50,GOST,6HKJIH
 54,GOST,6HONML
 60,GOST,6HSRQP
 64,GOST,6HWVUT
 70,GOST,6HШZYX
 74,GOST,6HЮЧЩЭ
C=====
 SAVP1:,,100B
 ,002,37B
 SAVP2:,,200B
 ,002,36B
 RESP1:,010,100B
 ,002,37B
 RESP2:,010,200B
 ,002,36B
 LDCR1:,010,100B
 ,020,
 LDCR2:,010,200B
 ,020,1
 C76000:,LOG,76000
 B2:,LOG,2
 B48/16:,OCT,7 77777 77777
 B48/31:,OCT,7 77777
 CBOБOДHO:,TEXT,8HCBOБOДHO
 T 00000:,TEXT,8H   00000
 MASC:,TEXT,8H   ИИИИИ
 ENTRY :,TEXT,2H E
 COMMON:,TEXT,2H C
 NFND:,GOST,H/***PRINPART : B TPП HET PAЗДEЛA'231'/
 C1/10:,REAL,0.1
 C9/10:,REAL,0.9
C(((
 T1:,BSS,15
 TG:,BSS,20
 SKIP/:,BSS,1.ЗAПOЛH. ПO DATA
C)))
 STEP:,BSS,1
 END:,BSS,1
 PG2:,BSS,1
C(((((
 SAVSPACE:,BSS,14
 PAY     :,BSS,1
 MAГAЗИH :,BSS,10
C)))))
 ,DATA,
 ET:,GOST,6H'200''175'-=-'231'
 1,SET,ET
 1,,SKIP/
 ,END,
 PRINT80:,NAME,..19.04.73
 *7:,BLOCK,B,C,IR,IC,JC,IW,JW,RW
 BL:,EQU,CONT
 SC:,EQU,SYM
 ,ITS,B
 B,BASE,*
 ,NTR,3
 ,STX,SB
 ,AAX,=177
 ,ATX,POS
 ,ASN,64-36
 ,AOX,=4000 0000
 ,STX,INF+1
 ,ATX,R
 15,X-A,
 ,ATX,SC
 ,ITA,C
 C,VTM,IR-RW
 SV:C,ITS,RW
 C,VLM,SV
 ,XTS,SC
 ,ATI,C
 IW,VTM,
 15,MTJ,JW
 CC:,BSS,
 ,WTC,R
 C,XTA,
 ,ATX,W
 IR,VTM,-5
 CR:,XTA,W
 ,ASN,64-8
 ,ATX,W
 ,YTA,
 ,ATX,SYM
 ,UZA,ER
 ,AEX,=177
 ,UZA,ER
 ,XTA,SYM
 ,AAX,=200
 ,U1A,BLANK
 ,XTA,POS
 ,U1A,RCON
 JC,VTM,CONSYM1-CONSYM2
 C2:,BSS,
 ,UTC,CONSYM2
 JC,XTA,
 ,ATX,CONT
 IC,VTM,-2
 C1:,BSS,
 ,XTA,CONT
 ,ASN,64-8
 ,ATX,CONT
 ,YTA,
 ,AEX,SYM
 ,UZA,CONTR
 IC,VLM,C1
 JC,VLM,C2
 RCON:,BSS,
 ,XTA,SYM
 ,ASN,64+2
 15,ATX,
 ,YTA,
 ,ASN,64+43
 15,WTC,
 ,XTS,TABL
 15,WTC,
 ,ASN,64+16
 ,AAX,=377
 ,ATX,SYM
 ,AEX,=231
 ,UZA,PRINT
 ,XTA,SYM
 ,ASN,64+7
 ,AEX,=1
 RW,VTM,ER
 ,U1A,POSITION
 ,XTA,SYM
 ,UJ,WRT
 CONTR:,BSS,
 ,XTA,CONT
 ,ASN,64+24
 ,AAX,=377
 RW,VJM,WRT
 ,XTA,=017
 ,ATX,SYM
 ,XTA,=1
 RW,VJM,POSITION
 ER:,BSS,
 IR,VLM,CR
 C,VLM,CC
 PRINT:,BSS,
 ,XTA,=231
 RW,VJM,WRT
 ,PRINT,INF
 JW,MTJ,15
 ,NTR,18
 C,VTM,RW-C
 15,XTA,
 UP:C,UTM,-1
 C,STI,IR
 C,V1M,UP
 ,ATI,C
 ,XTA,SB
 ,STI,B
 13,UJ,
 BLANK:,BSS,
 ,XTA,SYM
 ,AEX,=200
 ,UZA,ER
 ,ATX,BL
 ,XTA,=200
 ,ATX,SYM
 ,XTA,BL
 RW,VJM,POSITION
 ,XTA,POS
 RW,VTM,ER
 ,UJ,WRT
 POSITION:,BSS,
 ,A+X,POS
 ,ATX,POS
 ,X-A,=200
 ,U1A,PRINT
 ,XTA,SYM
 WRT:,BSS,
 IW,V1M,EW
 IW,VTM,-48
 ,ATX,SYM
 ,XTA,
 ,XTS,SYM
 EW:,BSS,
 IW,UTM,8
 IW,ASN,64
 15,AOX,
 15,ATX,
 RW,UJ,
 INF:JW,Z00,
 15,Z00,-1
 ,BSS,1
 CONSYM1:,BSS,
 ,ISO,6H014'214''201''204'
 ,ISO,6H56+'205''206''212'
 CONSYM2:,BSS,
 ,ISO,4HS00'310'
 TABL:,GOST,4H'231''212''133''133'
 ,GOST,4H'133''024''135''133'
 ,GOST,4H'133''231''133''310'
 ,GOST,4H'117''116''231''214'
 ,GOST,4H'205''204''201''032'
 ,GOST,4H'020''021''131''206'
 ,GOST,4H'033''124''136''034'
 ,GOST,4H'123''120''125''122'
 ,GOST,4H'034''134''133'
 ,GOST,4H'137''121''126''127'
 ,GOST,4H+*)(
 ,GOST,4H/.-,
 ,GOST,4H3210
 ,GOST,4H7654
 ,GOST,4H'026':98
 ,GOST,4H'21''036'='035'
 ,GOST,4HCBA'136'
 ,GOST,4HGFED
 ,GOST,4HKJIH
 ,GOST,4HONML
 ,GOST,4HSRQP
 ,GOST,4HWVUT
 ,GOST,4H'027'ZYX
 ,GOST,4H'132''130''030''115'
 ,GOST,4HЦБAЮ
 ,GOST,4HГФEД
 ,GOST,4HKЙИX
 ,GOST,4HOHMЛ
 ,GOST,4HCPЯП
 ,GOST,4HBЖYT
 ,GOST,4HШЗЫЬ
 ,GOST,4H'133'ЧЩЭ
 SYM:,BSS,1
 POS:,BSS,1
 W:,BSS,1
 CONT:,BSS,1
 R:,BSS,1
 SB:,BSS,1
 ,END,
 PRINTA:,NAME,.ИBTAH
 PRINT8:,SUBP,
 ,ATI,14
 14,XTA,
 ,UJ,PRINT8
 PRINTE:,ENTRY,
 14,VTM,E
 ,UJ,BEGIN
 PRINTO:,ENTRY,
 14,VTM,O
 BEGIN:14,XTS,
 11,BASE,E
 ,STX,R
 ,ATI,14
 14,XTA,
 ,AAX,=177
 ,ASN,52
 15,ATX,
 ,ASN,52
 15,ARX,
 ,ARX,R
 ,STX,R
 ,ATI,14
 14,XTA,
 ,AAX,=177
 ,ARX,R
 ,STX,R
 ,STI,12
 ,STI,10
 ,*64,INF
 ,NTR,6
 13,UJ,
 E:3,000,4
 8,006,7777B
 O:2,,.
 8,,7777B
 INF:10,,
 12,,.A KOH
 R:,OCT,.
 ,END,PRINTA
      PRINTAM     :,NAME,
      PRINT8      :,SUBP,
      P           :,LP, 00003B
 GAK/8:,EQU,P             +   00001B
                  14    ,VTM, P
                  14    ,ATX ,
                  15    ,XTA ,77777B
                  14    ,ATX ,00001B
                        ,ITA ,13
                  14    ,ATX ,00002B
                  14    ,VTM,      *00020B
                        ,ITS ,14
                  14    ,VTM,      *00020B
                        ,ITS ,14
                  14    ,VTM, 00177B
                        ,ITS ,14
                  13    ,VJM, PRINT8
                  14    ,VTM,      *00021B
                        ,ITS ,14
                  14    ,VTM,      *00025B
                        ,ITS ,14
                  14    ,VTM, 00027B
                        ,ITS ,14
                  13    ,VJM, PRINT8
                        ,UTC,      *00016B
                        ,*64 ,
                  14    ,VTM, P
                  14    ,XTA ,
                  14    ,WTC, 00002B
                        ,UJ,  00000B
     *00016B:           ,UTC, P
                        ,UTC,  GAK/8
                  2     ,XTR ,00020B
                  9     ,E+X ,00001B
CONST
     *00020B:,OCT,1000  0000  0000  0000
     *00021B:,OCT,2024  1503  2524  6525
     *00022B:,OCT,2304  0524  2365  1040
     *00023B:,OCT,1002  0040  1002  0040
     *00024B:,OCT,1002  0115  2024  3501
     *00025B:,OCT,2644  4516  0000  0000
                  ,END,
 PRINTFIL:,NAME,.15.11.76
C
C*****   PACПEЧATKA ЗAДAHHЫX ФAЙЛOB
C
 *1:,BLOCK,B,FP,T,L,R,L1,R1
 8,CONT,LL,LS,BL,E
 *14:,BLOCK,N(0),S
C
 SE*MTBUF:,SUBP,.
 MT*OБMEH:,SUBP,.
 PRINT8:,SUBP,.
 PRINT8//:,SUBP,.
C
 MATINFEX:,LC,1.
 PFILES:LC,BLOCK,(1),NFIL,FILS(8)
 BUFFER:PC,BLOCK,LIST(1024),ELIST(0)
 NBL:,P/P,(LIST)16
C
 NPOS:,EQU,0
C.....
 NPOS E:,EQU,NPOS+6
C.....
 BASE:,BSS,.
 ,ITA,13.
 13,VTM,1-12.
 SAVE:13,ITS,12.
 13,VLM,SAVE.
 ,XTS,.
 ,CALL,SE*MTBUF.
 B,BASE,BASE.
 FP,VTM,.ПEPBAЯ ПEЧATЬ
 ,UZA,NO BUF.
 ,ARX,P/IW.
 ,ATX,MTBUF.
 ,UTC,MATINFEX.
 ,XTA,.
 ,AAX,B14.
 ,U1A,E OUT.
 ,XTA,MT BUF.
 ,ARX,B1.
 ,ATX,MTBUF.
 E OUT:,BSS,.
C.....   BЫBOД HA HOBЫЙ ЛИCT
 FP,VZM,FIRST PR.
 ,PRINT,INF NP.
 FIRST PR:FP,UTM,1.
C.....   ИЗBЛEЧEHИE YKAЗATEЛЯ ФAЙЛA
 ,WTC,NFIL
 N,VTM,.
 N,VZM,RET.- BCE ФAЙЛЫ
 N,UTM,-1.
 ,ITA,N.
 N,VTM,N FIL.
 N,ATX,.
 N,XTA,FILS-NFIL.
 ,ATX,FIL.
 N,VTM,1-7.
 F MOV:N,UTC,FILS+7.
 ,XTA,.
 N,UTC,FILS+6.
 ,ATX,.
 N,VLM,F MOV.
C.....   ПEPEBOД YKAЗATEЛЯ
 ,XTA,
 ,ATX,REGIM
 ,XTA,FIL.
 ,ASN,64-16.
 ,ATX,WS.
 ,AEX,BLAN
 ,AAX,=:776
 ,U1A,TRT8
 ,XTA,BLAN
 ,ASN,64-8.5 ПPOБEЛOB
 ,ATX,REGIM
 TRT8:,XTA,WS.
 ,ASN,64+8.
 ,ATX,WS.
 ,UZA,ER POINT.
 ,AAX,C370.
 ,AEX,C60.
 ,U1A,TRT8.
 ,XTA,WS.
 ,APX,MSK1.
 ,UZA,ER POINT.
 ,ASN,64+39.
 ,ATX,POINT.YKAЗATEЛЬ
 ,ASN,64-39.
 ,AUX,UPM1.
 ,ATX,TPOINT.B KOДE ГOCT
 ,XTA,.
  ,ATX,MAR.
 ,ATX,COUNT
 T,VTM,-1.
 L,VTM,LIST+10.  ЧTEHИE
 R,VJM,EXCH.1-OЙ ЗOHЫ
C  ПPOБA ФAЙЛA:
 L,XTA,-10.
 ,ASN,64+32.
 ,U1A,ISO FILE.- ISO-ФAЙЛ
 T,VTM,1.
C*****   OБPAБOTKA OUT-ФAЙЛA
 STRING:L1,VTM,1-22.
 R1,VJM,WORD.
 ,AEX,FULW.
 ,UZA,E OUT.- KOHEЦ ФAЙЛA
 ,ASN,64+40.
 ,AEX,B1.
 ,UZA,PUNCH.- ПEPФOPAЦИЯ
 LL,VTM,.
 ,XTA,MAR.ПEPBAЯ CTPOKA
 ,U1A,NO FIR. - HET
C.....   ПEЧATЬ ШAПKИ : F'NNN'
 ,XTA,TPOINT.
 ,AOX,CT1.
 ,ATX,STR.
 ,XTA,CT1+1.
 ,ATX,STR+1.
 ,ATX,MAR.
 ,XTA,WF.
 ,AAX,B40/1.ГACИM
 ,ATX,WF.ПPOTЯЖKИ
 ,PRINT,INF.ПEЧATЬ ШAПKИ
C.....   ИЗBЛEЧEHИE CTPOKИ
 NO FIR:,XTA,WF.
 L1,ATX,STR+21.
C.....   KOHTPOЛЬ ПO ЧИCЛY CИMBOЛOB
 LS,VTM,1-6.
 CH 1:,ASN,64-8.
 ,ATX,WS.
 ,YTA,.
 ,ATI,S.
 S,UTM,-176B.
 S,VZM,CH 3.
 ,ASN,64+7.
 ,UZA,CH 2.
 S,UTC,-2.
 CH 2:LL,UTM,1.
 ,XTA,WS.
 LS,VLM,CH 1.
 CH 3:LL,UTC,-130.
 LS,VTM,.
 ,ITA,LS.
 ,ASN,64+14.
 ,UZA,BAD F.
 ,XTA,WF.
 ,AAX,C377.
 ,AEX,C176.KOHEЦ CTPOKИ
 ,UZA,PRINT. - ДA
 R1,VTM,NO FIR.
 L1,VLM,WORD.K CЛEД.CЛOBY
 ,UJ,BAD F.
 PRINT:,PRINT,INF.***  ПEЧATЬ
 ,UJ,STRING.
 PUNCH:,XTA,WF.ПEPФOPAЦИЯ
 ,ATI,L1.
C.....   ПPOПYCK ПEPФOP.MATEPИAЛA
 PU 1:L1,VZM,STRING.
 R1,VJM,WORD.
 LL,UTM,-1.
 ,UJ,PU 1.
C.....   ЧTEHИE CЛOBA ИЗ ФAЙЛA
 WORD:L,UTM,-ELIST.
 L,V1M,WOR1.
 L,VTM,-1024
 R,VJM,EXCH.
 T,VZM,WOR1.
 L,UTM,10.
 WOR1:L,UTM,ELIST+1.
 L,XTA,-1.
 ,ATX,WF.
 R1,UJ,.
C.....   ЧTEHИE ЗOHЫ ИЗ ФAЙЛA
 EXCH:,XTA,MTBUF.
 ,ARX,POINT.
 ,ATX,IW.ИC OБMEHA
C.....   KOHTPOЛЬ BЫXOДA ЗA ГPAHИЦЫ ФAЙЛA
 ,AAX,C777.
 ,XTS,MTBUF.
 ,ASN,64+18.
 ,AEX,C777.
 ,AAX,C777.
 15,ARX,.
 ,ASN,64+9.N ЗOHЫ БOЛЬШOЙ
 ,U1A,ER BUF. - ДA
 ,XTA,IW.
 ,CALL,MT*OБMEH.ЗA OБMEHOM
 ,XTA,POINT.
 ,ARX,B1.
 ,ATX,POINT.
 ,XTA,COUNT
 ,ARX,B37.KOЛ-BO BCEX
 ,ATX,COUNT.CЧИT.ЗOH
 R,UJ,.
C*****   OБPAБOTKA ISO-ФAЙЛA
 ISO FILE:,BSS,.
C.....   ПOДГOTOBKA И ПEЧATЬ ЗAГOЛOBKA
C  ИMЯ ПPOГPAMMЫ И BEPCИЯ:
 14,VTM,TYTLE
 ,ITS,14
 14,UTM,3
 ,ITS,14
 14,VTM,1
 ,ITS,14
 ,CALL,PRINT8//
 14,VTM,VER
 ,ITS,14
 14,UTM,1
 ,ITS,14
 14,VTM,7
 ,ITS,14
 ,CALL,PRINT8//
C  ПPOБA: TИП HOCИTEЛЯ
 ,UTC,MATINFEX
 ,XTA,
 ,AAX,B14
 ,UZA,NON 7/M
 ,XTA,/БYФ
 ,ATX,FIH
 ,XTA,/БYФ+1
 ,ATX,FIH+1
 ,UJ,/N*F
 Y TMT:,XTA,/ЛEH
 ,ATX,FIH
 12,UTC,47
 13,*65,80.=-16+96 - TNMT
 ,UJ,TO/M
 Y FATA:,XTA,/ПAK
 ,ATX,FIH
 13,*65,
 ,ASN,64+30
 ,AAX,=77.HOMEP YCTP-BA
 ,ATI,12
 ,*65,575B
 ,ATI,13.=A(*DISCS)
 12,UTC,
 13,*65,-30B.
 TO/M:,BSS,
 ,CALL,TOMAN*.4 ЦИФPЫ
 ,ASN,64+8.ISO-HOMEP
 ,AOX,=6H:'''''''',
 ,ATX,FIH+1
 ,UJ,/N*F
 NON 7/M:,*65,502B
 ,ATI,14
 14,*65,
 ,AAX,=:77.MOE ДHЗ
 ,AOX,=:0037.M.HOMEP MЛ
 ,ATX,WF
C  ПPOCMOTP TMT (16 MOД + 32 MФ)
 ,*65,504B
 ,ATI,13
 12,VTM,-47
 L TMT:12,UTC,47
 13,*65,-16.TIMT
 ,AEX,WF
 ,AAX,=:7777
 ,UZA,Y TMT
 12,VLM,L TMT
C  ПPOCMOTP FATA
 ,*65,760B
 ,ATI,13.=A(*ИПД)
 13,*65,20B
 ,ATI,12.=ДЛИHA FATA
 ,*65,576B
 ,ATI,13.=A(FATA)
 L FATA:13,*65,
 ,AEX,WF
 ,AAX,=:7777
 ,UZA,Y FATA
 12,UTM,-1
 13,UTM,1
 12,V1M,L FATA
C  ФИЗ MБ ИЛИ *CALL
 ,XTA,
 ,ATX,FIH.DUMMY
 ,ATX,FIH+1
C HA HOBЫЙ ЛИCT:
 ,PRINT,INF.ДЛЯ *CALL
 /N*F:,BSS,
 ,CALL,PREPDAT.MOMEHT BPEMEHИ
 ,XTA,/ФAЙЛ
 ,ATX,FIH+2.ИЗ YKAЗATEЛЯ
 ,XTA,TPOINT.AДPEC ФAЙЛA
 ,AOX,CIT1.
 ,ATX,FIH+3
 14,VTM,FIH.
 ,ITS,14.
 14,UTM,3
 ,ITS,14.
 14,VTM,28.
 ,ITS,14.
 ,CALL,PRINT8//.ПEЧATЬ ШAПKИ
 L,VTM,LIST.
 T,VTM,0.
C.....   ИЗBЛEЧEHИE CTPOKИ ИЗ ISO-ФAЙЛA
 CARD:L1,VTM,-14.
 LS,VTM,.
 R WOR:BL,VTM,.
 R1,VJM,WORD.
 R SYM:,XTA,WF.
 ,UZA,R WOR.
 ,ASN,64-8.
 ,ATX,WF.
 ,YTA,.
 ,ATI,S.OЧEP.CИMBOЛ
 ,AEX,C12.
 E,VTM,1.
 ,UZA,NEW L.- KOHEЦ CTPOKИ
 E,VTM,0.
 ,ASN,64+7.
 ,UZA,WR SYM.
 NEW L:,BSS,.
 S,UTC,-201B.COSY-BLANK
 BL,VTM,.
 S,VTM,40B.
C.....   ЗAПИCЬ CИMBOЛA
 WR SYM:LS,VZM,W WOR.- HOBOE CЛOBO
 LS,UTM,8.
 WSY:,ITA,S.
 LS,ASN,64.
 L1,AOX,STR+13.
 L1,ATX,STR+13.
 BL,VZM,R SYM.
 BL,UTM,-1.COSY-BLANK
 ,UJ,WR SYM.
 W WOR:LS,VTM,-40.ЗAПИCЬ CЛOBA
 ,XTA,.
 L1,ATX,STR+14.
 L1,VLM,WSY.
 E,VZM,LON CAR.
C.....   ПPOБЫ KOHЦA ФAЙЛA
 ,XTA,STR.
 ,AEX,=6H*-*-*-
 ,UZA,E FISO.
 ,XTA,STR.
 ,AEX,=6H*READ
 ,U1A,FI 1.
 ,XTA,STR+1
 ,AEX,=6HOLD
 ,UZA,E FISO.
 FI 1:,BSS,.HE KOHEЦ
C.....   OPГAHИЗAЦИЯ БYФEPИЗOBAHHOЙ ПEЧATИ
 ,XTA,REGIM
 ,ATX,NSTR.=BLANK
 ,U1A,NUMB
 ,XTA,MAR.
 ,ARX,B37
 ,ATX,MAR.HOMEP KAPTЫ
C.....   ПEЧATЬ ПOЛOBИHЫ CTPOKИ
 ,AUX,UPM4
 ,AOX,CIT4.
 ,ATX,NSTR.
 NUMB:,BSS,
C  ECTЬ ЛИ Y П/K XBOCT ИЗ ПPOБEЛOB:
 ,XTA,STR+8
 ,AOX,STR+9
 ,AOX,STR+10
 ,AOX,STR+11
 ,AEX,BLAN
 ,U1A,OLD PR.HET XBOCTA
C HYMEPOBAHA ЛИ П/K:
 ,XTA,STR+12
 ,AOX,STR+13
 ,AEX,BLAN
 ,UZA,OLD PR.HET HOMEPOB
C  ПEPEПИCЬ HOMEPA B XBOCT ПOЛYCTPOKИ ИЗ 63 ПEЧ.CИMB
 ,XTA,STR+12
 ,ATX,STR+8
 ,XTA,STR+13
 ,AAX,=:777774.ЭTO 60-61 CИMB.
 ,ATX,STR+9
 ,XTA,BLAN
 ,ATX,STR+12
 ,ATX,STR+13
 OLD PR:,BSS,
 ,XTA,STR+9.
 ,ATX,WS.
 ,AAX,MSK PR.
 ,ATX,STR+9
 14,VTM,NSTR.
 ,ITS,14.
 14,UTM,10.
 13,VJM,TO PR8.ЗA ПEЧATЬЮ
C.....   ECTЬ ЛИ ПPOДOЛЖEHИE
 ,XTA,WS.
 ,AOX,MSK PR.
 ,AEX,MSK PR.
 ,ATX,STR+9.
 ,AOX,BLAN.
 14,VTM,1-4.
 CH 2S:14,AOX,STR+13.
 14,VLM,CH 2S.
 ,AEX,BLAN.ECTЬ ПPOДOЛЖ.
 ,UZA,CARD. - HET
C.....   ПEЧATЬ ПPOДOЛЖEHИЯ
 14,VTM,STR+6
 ,XTA,CIT5.
 14,ATX,.
 ,XTA,BLAN
 14,ATX,1
 14,ATX,2.12 ПPOБEЛOB
 ,ITS,14.
 14,UTM,7
 13,VTM,CARD.
 TO PR8:,ITS,14.
 14,VTM,NPOS.
 TO PR:,ITS,14.
 ,UJ,PRINT8//.
 E FISO:,BSS,.
 14,VTM,E CRD.ПEЧATЬ
 ,ITS,14.ЗABEPШAЮЩEЙ
 14,UTM,9.
 ,ITS,14.
 14,VTM,NPOS
 13,VJM,TO PR.
 ,XTA,COUNT
 ,AUX,UPM4.KOЛ-BO ЗOH ФAЙЛA
 ,AOX,CIT4.B ISO
 ,ATX,FIF+2
 14,VTM,FIF
 ,ITS,14
 14,UTM,3
 ,ITS,14
 14,VTM,20
 13,VJM,TO PR.ПEЧATЬ ИTOГA
 13,VTM,E OUT.
 ,UJ,PRINT8//+1.ДOCБPOC
C*****   BOЗBPAT ИЗ 'PRINTFIL'
 RET:14,VTM,12.
 ,STX,.
 RESET:14,STI,.
 14,UTM,-1.
 14,V1M,RESET.
 ,ATI,13.
 13,UJ,.
 ,BSS,.
C*****   ДИAГHOCTИKA   *****
 NO BUF:,BSS,.
C.....   БYФEP BOOБЩE OTCYTCTBYET
 E,VTM,TNOB.
 ,UJ,D PR8
 ER POINT:,BSS,.
C.....   CИHTAKCИЧECKAЯ OШИБKA YKAЗATEЛЯ
 E,VTM,T ERP.
 ,UJ,D PR8.
 ERBUF I:,BSS,.
C.....   YKAЗATEЛЬ BHE ГPAHИЦ
 E,VTM,T GRP.
C.....
 D PR8:,XTA,FIL.YKAЗATEЛЬ
 E,ATX,4.
 ,ITS,E.
 E,UTM,4.
 ,ITS,E.
 14,VTM,NPOS E.
 ,ITS,14.
 ,CALL,PRINT8.
 E,UTM,-TNOB.
 E,V1M,E OUT.
 STOP:,SJ,.
 LON CAR:,BSS,.
C.....   ДЛИHHAЯ KAPTA (ISO-ФAЙЛ)
 14,VTM,NTXT.
 ,UJ,I DIAGN.
 ER BUF:,BSS,.
C.....   BЫXOД ЗA ГPAHИЦY БYФEPA
 T,VLM,ERBUF G.HAЧAЛO/OUT-ФAЙЛ
 14,VTM,T GRAN.
C.....
 I DIAGN:,ITS,14.
 14,UTM,1.
 ,ITS,14.
 14,VTM,NPOS E.
 13,VTM,E FISO.
 ,UJ,TO PR.
 BAD F:,BSS,.
C.....   ДЛИHHAЯ CTPOKA (OUT-ФAЙЛ)
 E,VTM,T ПЛФ.
 ,UJ,DIAGN.
 ERBUF G:,BSS,.
 T,VZM,ERBUF I.- HAЧAЛO
C.....   BЫXOД OUT-ФAЙЛA ЗA БYФEP
 E,VTM,T ФГ.
 DIAGN:L1,VTM,1-20.
 ,XTA,STAR.
 DI 1:L1,ATX,STR+20.
 L1,VLM,DI 1.
 ,XTA,T DI1.
 ,ATX,STR.
 ,XTA,T DI2.
 ,ATX,STR+21.
 E,XTA,.
 ,ATX,STR+9.
 E,XTA,1.
 ,ATX,STR+10.
 ,PRINT,INF.
 E,UTM,-TПЛФ.
 E,V1M,E OUT.
 SCAN:R1,VJM,WORD.
 ,AEX,FULW.
 ,UZA,E OUT.
 ,AAX,C377.
 ,AEX,C201.
 ,U1A,SCAN.
 ,UJ,STRING.
C.....   ИHФOPMAЦИOHHЫE CЛOBA
 P/IW:,Z01,NBL.
 ,,777B.
 INF:,Z10,STR.
 ,,.
 INF NP:,Z00,TNP.
 ,Z00,TNP.
 :0,,.
 8,,.
C.....   TEKCTЫ ДЛЯ ПEЧATИ
 TNP:,GOST,6H'201''231'
 CT1:,GOST,6H0'205'F000
 TDI2:,CONT,6H'176'0000'176'
 TYTLE:,ISO,20HPEДAKTOP MYЛЬTИTAЙПA
 VER:,BSS,
 ,ISO,10H/12.08.80/
 FIH:,ISO,21HПAKET'':NNNN, ФAЙЛ:ZZZ
 /ПAK:,ISO,6HПAKET''
 /ЛEH:,ISO,6H ЛEHTA
 /БYФ:,ISO,12HMT БYФEP,''''''
 /ФAЙЛ:,ISO,6H ФAЙЛ:
 FIF:,ISO,21HPACПEЧATAHO ZZZZ ''ЗOH
 ECRD:,ISO,4H*'007''073''12'.60*
 ,BSS,.
C.....   ДИAГHOCTИЧECKИE TEKCTЫ
 TNOB:,ISO,30HБYФEP BOOБЩE OTCYTCTBYET
 TERP:,ISO,30HCИHT.OШИБKA YKAЗATEЛЯ
  T GRP:,ISO,30HYKAЗATEЛЬ BHE ГPAHИЦ -
 NTXT:,ISO,12HNONTEXT CARD
 TGRAN:,ISO,12HФAЙЛ-ГPAHИЦA
 TФГ:,GOST,12HФAЙЛ-ГPAHИЦA
 TDI1:,GOST,6H2'204'****
 TПЛФ:,GOST,12HLONG STRING
 STAR:,GOST,6H******
 ,BSS,.
C.....   MACKИ И KOHCTAHTЫ ДЛЯ TEKCTOB
 UPM1:,BSS,.
 MSK1:,GOST,6H000777
 UPM4:,GOST,6H777700
 UPM5:,GOST,6H177000
 MSK PR:,GOST,6H'377''377''377''377'00
 B40/1:,LOG,17 7777 7777 7777.
 CIT1:,ISO,6H''''''000
 CIT4:,ISO,6H0000 ''
 CIT5:,ISO,6H   = ''
 CIT6:,ISO,6H000 ,
 BLAN:,ISO,6H
 ,BSS,.
C.....   ДPYГИE KOHCTAHTЫ
 FULW:,LOG,7777 7777 7777 7777.
 B37:,OCT,0001
 B14:,LOG,20000.
 C777:,LOG,777.
 C377:,LOG,377.
 C370:,LOG,370.
 C201:,LOG,201.
 C176:,LOG,176.
 C60:,LOG,60.
 C12:,LOG,12.
 B1:,LOG,1.
C.....   PAБOЧИE MACCИBЫ И ЯЧEЙKИ
 MTBUF:,BSS,1.
 COUNT:,BSS,1
 NSTR:,BSS,1.
 STR:,BSS,22.
 MAR:,BSS,1.
 FIL:,BSS,1.
 POINT:,BSS,1.
 TPOINT:,BSS,1.
 IW:,BSS,1.
 WF:,BSS,1.
 WS:,BSS,1.
 REGIM:,BSS,1
 ,END,.
      PRINTLIS    :,NAME,
      LIST        :,LC, 00003B
      STORE       :,LP, 00003B
      PRINT8      :,SUBP,
 GAK/4:,EQU,LIST          +   00001B
 GAK/5:,EQU,LIST          +   00002B
                  14    ,VTM, STORE
                        ,ITA ,13
                  14    ,ATX ,
                        ,ITA ,1
                  14    ,ATX ,00001B
                        ,ITA ,2
                  14    ,ATX ,00002B
                  14    ,VTM,  GAK/4
                        ,ITS ,14
                  14    ,VTM,  GAK/4
                        ,ITS ,14
                  14    ,VTM, 00134B
                        ,ITS ,14
                  13    ,VJM, PRINT8
                        ,UTC,  GAK/5
                        ,XTA ,
                        ,UTC,      *00023B
                        ,AEX ,
                        ,ATI ,1
                  1     ,UTM, 00001B
                        ,WTC, LIST
                  2     ,VTM, 00000B
     *00013B:           ,UTC,      *00021B
                        ,*64 ,
                  2     ,UTM, 00001B
                  1     ,VLM,      *00013B
                  14    ,VTM, STORE
                  14    ,XTA ,00002B
                        ,ATI ,2
                  14    ,XTA ,00001B
                        ,ATI ,1
                  14    ,WTC, 00000B
                        ,UJ,  00000B
                        ,UTC, 00000B
     *00021B:     2     ,ATX ,
                  2     ,ATX ,
                  2      ,131,00020B
                  8     ,ATX ,
CONST
     *00023B:,OCT,0000  0000  0007  7777
                  ,END,
      PRINTR      :,NAME,
      P           :,LU, 00021B
      PRINT8      :,SUBP,
 GAL/3:,EQU,P             +   00001B
 GAL/4:,EQU,P             +   00002B
 GAL/5:,EQU,P             +   00020B
                        ,UTC, P
                        ,ATX ,
                        ,ITA ,1
                        ,UTC, P
                        ,ATX ,00002B
                  1     ,VTM, 77763B
     *00003B:     1     ,ITA ,15
                        ,UTC, P
                  1     ,ATX ,00020B
                  1     ,VLM,      *00003B
                  15    ,XTA ,77777B
                        ,UTC, P
                        ,ATX ,00001B
                        ,UTC, 00000B
                  14    ,VTM,      *00031B
                        ,ITS ,14
                  14    ,VTM,      *00054B
                        ,ITS ,14
                  14    ,VTM, 00013B
                        ,ITS ,14
                  13    ,VJM, PRINT8
                        ,*64 ,     *00025B
                  14    ,VTM,      *00055B
                        ,ITS ,14
                  14    ,VTM,      *00100B
                        ,ITS ,14
                  14    ,VTM, 00013B
                        ,ITS ,14
                  13    ,VJM, PRINT8
                        ,*64 ,     *00027B
                  14    ,VTM, P
                  14    ,XTA ,00016B
                        ,ATI ,13
                  14    ,XTA ,00002B
                        ,ATI ,1
                  14    ,XTA ,
                  13    ,UJ,  00000B
                        ,UTC, 00000B
     *00025B:           ,UTC, P
                        ,UTC,  GAL/3
                  2     ,XTR ,00020B
                  8     ,E+X ,00001B
     *00027B:           ,UTC,  GAL/4
                        ,UTC,  GAL/5
                  2     ,ARX ,00005B
                  8     ,XTA ,00016B
CONST
     *00031B:,OCT,2405  1111  2345  2122
     *00032B:,OCT,1002  0040  1002  0040
     *00033B:,OCT,2024  1503  2524  6525
     *00034B:,OCT,2304  0524  2365  1040
     *00035B:,OCT,1002  0040  1002  0040
     *00036B:,OCT,1002  0115  2024  3501
     *00037B:,OCT,2644  4516  1002  0040
     *00040B:,OCT,1002  0040  1002  0040
     *00041B:,OCT,1002  0040  1002  0040
     *00042B:,OCT,1002  0040  1002  0040
     *00043B:,OCT,1002  0040  1002  0040
     *00044B:,OCT,1002  0040  1002  0040
     *00045B:,OCT,1002  0040  1002  0040
     *00046B:,OCT,1002  0040  1002  0040
     *00047B:,OCT,1002  0040  1002  0040
     *00050B:,OCT,1002  0040  1002  0040
     *00051B:,OCT,1002  0040  1002  0040
     *00052B:,OCT,1002  0040  1002  0040
     *00053B:,OCT,1002  0040  1002  0040
     *00054B:,OCT,1002  0040  0000  0000
     *00055B:,OCT,2222  0040  1002  0040
     *00056B:,OCT,1002  0111  2222  0040
     *00057B:,OCT,1002  0040  1004  4511
     *00060B:,OCT,2222  0040  1002  0040
     *00061B:,OCT,2225  3040  1002  0040
     *00062B:,OCT,1002  0126  1002  0040
     *00063B:,OCT,1002  0040  1005  3111
     *00064B:,OCT,1002  0040  1002  0040
     *00065B:,OCT,2544  4511  1002  0040
     *00066B:,OCT,1002  0126  2224  4511
     *00067B:,OCT,1002  0040  1004  4530
     *00070B:,OCT,1002  0040  1002  0040
     *00071B:,OCT,2602  0040  1002  0040
     *00072B:,OCT,1002  0130  2222  0040
     *00073B:,OCT,1002  0040  1005  4111
     *00074B:,OCT,2222  0040  1002  0040
     *00075B:,OCT,2604  4511  2222  0040
     *00076B:,OCT,1002  0130  2225  3040
     *00077B:,OCT,1002  0040  1005  4126
     *00100B:,OCT,1002  0040  0000  0000
                  ,END,
      PRO        :,NAME,
      **         :,PC,  2000B
      RECO       :,SUBP,
 *00000    :10 ,  VTM,   *00000
                 ,ATI,  9
            10 ,  XTA,  53B
                 ,UIA,   *00020
                 ,WTC,   BSS+ 0001B
            12 ,  VTM,      **
            12 ,  XTA,
                 ,UZA,   *00034
            10 ,  AAX,  47B
            10 ,  AEX,  41B
                 ,UIA,   *00034
            12 ,  XTA,  2
                 ,ASN,  136B
            12 ,  ARX,  2
            12 ,  XTS,  1
                 ,ASN,  117B
            12 ,  ARX,  1
            15 ,  ARX,
            15 ,  ATX,
            10 ,  ARX,  43B
            10 ,  AAX,  51B
            10 ,  ARX,  54B
            10 ,  ATX,  53B
            12 ,  XTA,  1
                 ,ASN,  122B
            12 ,  ARX,
                 ,ASN,  114B
            15 ,  ARX,
            10 ,  ARX,  44B
            10 ,  AAX,  52B
            10 ,  ARX,  54B
            10 ,  ATX,  54B
 *00020    :10 ,  XTA,  54B
            10 ,  ARX,  46B
                 ,UZA,   *00026
            10 ,  XTA,  45B
 *00022    :     ,WTC,   BSS+ 0000B
            11 ,  VTM,      **
                 ,XTS,
            10 ,  ATX,  53B
            11 ,  XTA,
            11 ,  VTM,
                 , UJ,      RECO
                 ,UTC,
 *00026    :10 ,  AAX,  51B
            10 ,  ATX,  54B
            10 ,  XTA,  53B
            10 ,  ARX,  46B
                 ,UZA,   *00032
            10 ,  XTA,  50B
                 , UJ,   *00022
                 ,UTC,
 *00032    :10 ,  AAX,  51B
            10 ,  ATX,  53B
            10 ,  XTA,  50B
            13 ,   UJ,
 *00034    :10 ,  XTA,  54B
                 ,UZA,   *00037
            10 ,  XTA,  42B
             9 ,  ATX,
            10 ,  XTA,  50B
                 ,UTC,
 *00037    :     ,XTS,
            10 ,  ATX,  53B
            10 ,  STX,  54B
            13 ,   UJ,
 *00041    :,     LOG,  00000000 00000001.
            ,     LOG,  10026475 23236455.
            ,     LOG,  00000000 00000003.
            ,     LOG,  00000000 00000043.
            ,     LOG,  10046111 20451040.
            ,     LOG,  37777777 77776000.
            ,     LOG,  77777777 00007777.
            ,     LOG,  64000000 00000001.
            ,     LOG,  00000000 00077777.
            ,     LOG,  00000000 00077740.
 BSS       :     ,BSS,  2
      ,END,
   PRTLINE*:,NAME,
   PRTLINE/:,SUBP,
   PRINT8//:,SUBP,
   PRTADR/ :,LC,1
C*
C*   ЭTA ПPOГPAMMA HYЖHA ДЛЯ CБOPKИ
C*   TPAHCTЯTOPA  FTN  B OTЛИЧИE OT
C*   BAPИAHTA C MOHOЛИCTOM, CYЩECTBY-
C*   ЮЩEГO B ПOCTOЯHHOЙ БИБЛИOTEKE
C*   И TPEБYEMOГO HA CЧETE.
C*
  ,UTC,A
  ,XTS,
  ,UTC,PRTADR/
  ,STX,
  ,UJ,PRTLINE/
  A:,,
  ,Z00,PRINT8//
  ,END,
      PRTLOC*    :,NAME,
      INTPRT5*   :,SUBP,
      ISOPRT*    :,SUBP,
      PUTBL*     :,SUBP,
      OCTPRT*    :,SUBP,
      PRTLINE*   :,SUBP,
      NEWLINE*   :,SUBP,
      *LISTS*    :,LC,  1
                 ,ITS,  13
                 ,ITS,  12
                 ,ITS,  11
                 ,ITS,  10
            15 ,  ATX,
            13 ,  VJM,  NEWLINE*
            13 ,  VJM,  PRTLINE*
            13 ,  VJM,  PRTLINE*
            14 ,  VTM,   *00025
            13 ,  VJM,  ISOPRT*
            13 ,  VJM,  PRTLINE*
            13 ,  VJM,  PRTLINE*
            11 ,  VTM,
            10 ,  VTM,  77755B
 *00011    :12 ,  VTM,  77774B
                 ,UTC,
 *00012    :14 ,  VTM,
            13 ,  VJM,  PUTBL*
                 ,ITA,  11
            13 ,  VJM,  INTPRT5*
            14 ,  VTM,  77777B
            13 ,  VJM,  PUTBL*
            11 ,  MTJ,  14
            14 ,  UTM,  *LISTS*
            14 ,  XTA,
            13 ,  VJM,  OCTPRT*
            11 ,  UTM,  1
            12 ,  VLM,   *00012
            13 ,  VJM,  PRTLINE*
            10 ,  VLM,   *00011
            15 ,  XTA,
                 ,STI,  10
                 ,STI,  11
                 ,STI,  12
                 ,STI,  13
                 ,NTR,  2
            13 ,   UJ,
 *00025    :,     LOG,  10020052 23044523.
            ,     LOG,  25051452 10020061.
            ,     LOG,  10035040 14230060.
            ,     LOG,  10000040 10020040.
 BSS       :     ,BSS,
      ,END,
      PT6        :,NAME,
            15 ,  ATX,
                 ,ASN,  107B
L                ,UZA,   *00007    +77777B
                 ,UTC,   *00072
                 ,XTA,
                 ,UTC,   *00066
                 ,ATX,
                 ,STX,
                 ,UTC,   *00065
                 ,ATX,
                 , UJ,   *00014
                 ,UTC,
                 ,STX,
                 ,UTC,
 *00007    :     ,ASN,  34B
L                ,UTC,   *00057    +1
                 ,XTS,
                 ,UTC,   *00067
                 ,AAX,
            15 ,  AOX,
                 ,AOX,
L                ,UTC,   *00057    +1
                 ,ATX,
                 ,UTC,
 *00014    :     ,UTC,   *00070
                 ,XTA,
                 , UJ,   *00023
                 ,UTC,
                 ,ASN,  34B
L                ,UTC,   *00057    +1
                 ,AOX,
L                ,UTC,   *00057    +1
                 ,ATX,
                 ,STX,
                 ,ASN,  37B
                 ,UTC,   *00072
                 ,AUX,
                 ,UTC,
 *00023    :     ,UTC,   *00071
                 ,AOX,
                 ,UTC,   *00110
                 ,STX,
                 ,UTC,   *00106
                 ,ATX,
                 ,ITA,  3
                 ,ITS,  4
                 ,ITS,  5
                 ,ITS,  7
             7 ,  VTM,   *00007
            14 ,  VTM,  77765B
L            7 ,  XTS,   *00106    - *00007
                 ,UTC,
 *00032    :     ,ASN,  72B
            15 ,  ATX,
                 ,YTA,
                 ,NTR,  3
                 ,X-A,
                 ,ATI,  4
             3 ,  VTM,
                 ,NTR,  2
 *00036    : 5 ,  VTM,  77773B
                 ,UTC,   *00073
             3 ,  XTA,
                 ,UTC,
 *00040    :     ,ASN,  70B
             4 ,  VLM,   *00042
                 ,YTA,
                 , UJ,   *00044
 *00042    : 5 ,  VLM,   *00040
             3 ,  UTM,  1
                 , UJ,   *00036
                 ,UTC,
L*00044    : 7 ,  XTS,   *00107    - *00007
                 ,ASN,  70B
            15 ,  ATX,
                 ,YTA,
L            7 ,  XTS,   *00106    - *00007
                 ,ASN,  70B
            15 ,  AOX,
L            7 ,  STX,   *00106    - *00007
            15 ,  AOX,
L            7 ,  STX,   *00107    - *00007
            14 ,  VLM,   *00032
L            7 ,  XTA,   *00066    - *00007
                 ,UIA,   *00061
L            7 ,   *64,  *00057    - *00007
 *00053    :     ,XTA,
L            7 ,  ATX,   *00066    - *00007
                 ,STI,
                 ,STI,  7
                 ,STI,  5
                 ,STI,  4
                 ,STI,  3
            13 ,   UJ,
 *00057    :     ,UTC,   *00106
                 ,UTC,   *00106
                 ,ATX,
             8 ,  ATX,
L*00061    : 7 ,  XTA,   *00106    - *00007
                 ,WTC,   *00065
                 ,ATX,
L            7 ,  XTA,   *00107    - *00007
                 ,WTC,   *00065
                 ,ATX,  1
                 , UJ,   *00053
                 ,UTC,
 *00065    :,     LOG,  00000000 00000000.
 *00066    :,     LOG,  00000000 00000000.
 *00067    :,     LOG,  74007777 77777777.
 *00070    :,     LOG,  03607417 03607400.
 *00071    :,     LOG,  00000000 00000231.
 *00072    :,     LOG,  01603407 01603400.
 *00073    :,     LOG,  03655441 15422064.
            ,     LOG,  10624022 04614451.
            ,     LOG,  12637046 03000001.
            ,     LOG,  00401404 01203007.
            ,     LOG,  02004473 05416425.
            ,     LOG,  07435047 10021061.
            ,     LOG,  17622500 20226502.
            ,     LOG,  20625104 13042456.
            ,     LOG,  14043107 22031111.
            ,     LOG,  22445465 14646070.
            ,     LOG,  17034467 17207414.
 *00106    :,     LOG,  00000000 00000000.
 *00107    :,     LOG,  00000000 00000000.
 *00110    :,     LOG,  00000000 00000000.
 BSS       :     ,BSS,
      ,END,
 PUNCHA:,NAME,
 COLPUNB*:,SUBP,
 COLPUNE*:,SUBP,
 COLPUNC*:,SUBP,
 COLPUN*B:,SUBP,
 ENCODO:,SUBP,
 PUNCHA:,BSS,
 11,BASE,C
 14,VJM,YПPЯT
 ,STX,AK
 ,ATX,AH
 *3:14,VTM,1-13
 11,BASE,C
 *2:,WTC,AH
 ,XTA,
 14,ATX,CTPOKA+12
 ,XTA,AH
 ,AEX,AK
 ,UZA,*1
 ,XTA,AH
 ,ARX,=1
 ,ATX,AH
 14,VLM,*2
 14,VTM,CTPOKA
 ,ITS,14
 13,VTM,*3
 ,UJ,COLPUNC*
 *1:14,VZM,*BASTA
 ,XTA,BLANKS
 14,ATX,CTPOKA+13
 14,VLM,*1
 *BASTA:14,VTM,CTPOKA
 ,ITA,14
 13,VTM,BOCCT
 ,UJ,COLPUNC*
 PUNON:,ENTRY,
 14,VTM,COLPUNB*
 11,BASE,C
 YПPЯT:,ITS,5
 ,ATX,И5
 ,ITA,6
 ,ATX,И6
 ,XTA,XPAHИ6
 ,ATI,6
 ,ITA,13
 ,STX,RET
 14,UTC,
 13,VJM,
 BOCCT:,WTC,И5
 5,VTM,
 ,ITS,6
 ,UTC,XPAHИ6
 ,STX,
 ,WTC,И6
 6,VTM,
 ,WTC,RET
 ,UJ,
 PUNCHB:,ENTRY,
 14,VTM,COLPUN*B
 11,VTM,C
 ,UJ,YПPЯT
 PUNCHO:,ENTRY,
 11,BASE,C
 ,ITS,13
 ,ATX,RET
 14,VTM,CTPOKA
 ,ITA,14
 13,VJM,ENCODO
 14,VTM,CTPOKA
 ,ITS,14
 14,VTM,CTPOKA+12
 ,ITS,14
 ,WTC,RET
 13,VTM,
 ,UJ,PUNCHA
 PUNOFF:,ENTRY,
 14,VTM,COLPUNE*
 11,VJM,YПPЯT
 C:,BSS,
 CTPOKA:,BSS,13
 BLANKS:,ISO,6H
 И5:,BSS,1
 И6:,BSS,1
 RET:,BSS,1
 AH:,BSS,1
 AK:,BSS,1
 XPAHИ6:,BSS,1
 ,END,
      PUNCHICT    :,NAME,
      READ1       :,SUBP,
      ISOICTTR    :,SUBP,
      REVCARD     :,SUBP,
      CARD1       :,LP, 00017B
      CARD2       :,LP, 00025B
      BUFFER      :,LP, 04576B
      C           :,EQU,           *00041B
 GAL/2:,EQU,     *00047B  -        *00041B
 GAL/3:,EQU,     *00041B  -        *00041B
 GAL/5:,EQU,     *00045B  -        *00041B
 GAL/7:,EQU,     *00046B  -        *00041B
 GAM/1:,EQU,     *00050B  -        *00041B
 GAM/5:,EQU,     *00051B  -        *00041B
 GAM/8:,EQU,     *00052B  -        *00041B
 GAN/3:,EQU,     *00042B  -        *00041B
 GAN/5:,EQU,     *00043B  -        *00041B
 GAN/7:,EQU,     *00053B  -        *00041B
 GAO/1:,EQU,     *00054B  -        *00041B
 GAO/5:,EQU,     *00055B  -        *00041B
 GAP/1:,EQU,     *00044B  -        *00041B
                        ,ITS ,7
                  7     ,VTM,      *00041B
                  7     ,STX , GAL/2
                  7     ,ATX , GAL/3
                        ,ITA ,5
                  7     ,ATX , GAL/5
                        ,ITA ,6
                  7     ,ATX , GAL/7
                        ,ITA ,13
                  7     ,ATX , GAM/1
                        ,WTC,      *00041B
                  5     ,VTM, 00000B
     *00006B:     6     ,VTM, 77635B
                        ,UTC, 00000B
     *00007B:     7     ,XTS , GAL/3
                  13    ,VJM, READ1
                  5     ,XTA ,
                  7     ,AEX , GAM/5
                        ,U1A,      *00013B
                  5     ,XTA ,00001B
                  7     ,AEX , GAM/8
                        ,UZA,      *00037B
     *00013B:     7     ,XTS , GAN/3
                  7     ,XTS , GAL/3
                  13    ,VJM, ISOICTTR
                  7     ,XTS , GAN/5
                  7     ,XTS , GAN/3
                  13    ,VJM, REVCARD
                  7     ,XTA , GAL/3
                  7     ,AOX , GAN/7
                  7     ,ATX , GAL/3
                  7     ,XTA , GAN/5
                  7     ,ARX , GAO/1
                  7     ,ATX , GAN/5
                  6     ,VLM,      *00007B
                        ,WTC,      *00043B
                  9     ,VTM, 77777B
                        ,UTC, 00000B
     *00024B:     8     ,VTM, BUFFER
                  7     ,*71 , GAO/5
                  8     ,VTM, 00001B
                        ,UTC, 00000B
     *00026B:     9     ,VTM, 77717B
                        ,UTC, 00000B
     *00027B:           ,ASN ,0
                  9     ,VLM,      *00027B
                  8     ,VLM,      *00026B
                        ,UTC, 00000B
                  7     ,XTA , GAP/1
                  7     ,ATX , GAN/5
                  6     ,VZM,      *00006B
                        ,STX ,
                        ,WTC,      *00045B
                  5     ,VTM, 00000B
                        ,WTC,      *00046B
                  6     ,VTM, 00000B
                        ,WTC,      *00047B
                  7     ,VTM, 00000B
                        ,WTC,      *00050B
                        ,UJ,  00000B
     *00037B:           ,WTC,      *00043B
                  9     ,VTM, 00027B
                        ,UJ,       *00024B
                        ,UTC, 00000B
     *00041B:           ,UTC, 31013B
                        ,UTC, CARD1
     *00042B:           ,UTC, 00000B
                        ,UTC, CARD2
     *00043B:           ,UTC, 00000B
                        ,UTC, BUFFER
     *00044B:           ,UTC, 00000B
                        ,UTC, BUFFER
CONST
     *00045B:,OCT,0000  0000  0000  0000
     *00046B:,OCT,0000  0000  0000  0000
     *00047B:,OCT,0000  0000  0000  0000
     *00050B:,OCT,0000  0000  0000  0000
     *00051B:,OCT,1244  2516  2102  0123
     *00052B:,OCT,2124  3515  2124  7124
     *00053B:,OCT,4000  0000  0000  0000
     *00054B:,OCT,0000  0000  0000  0030
     *00055B:,OCT,4010  0000  4410  0000
                  ,END,
      PUNM220    :,NAME,
      TABLE2*    :,SUBP,
      БYФ/ПK     :,PC,  1762B
      PUNM20    :,ENTRY,
 *00000    :     ,ITS,  7
             7 ,  VTM,   *00000
             7 ,  STX,  145B
             7 ,  STX,  144B
             7 ,  ATX,  126B
                 ,ITA,  13
                 ,ITS,  5
                 ,ITS,  6
             7 ,  XTS,  111B
                 ,ATI,  5
             6 ,  VTM,  77720B
             7 ,  XTS,  126B
                 ,WTC,   BSS+ 0000B
            13 ,  VJM,
            13 ,  VTM,   *00047
                 ,WTC,   *00126
                 ,XTA,
             7 ,  AEX,  136B
                 ,UIA,   *00014
                 ,WTC,   *00126
                 ,XTA,  1
             7 ,  AEX,  143B
                 ,UZA,   *00073
                 ,UTC,
 *00014    : 8 ,  VTM,  11
             9 ,  VTM,  77720B
            12 ,  VTM,  77671B
                 ,MTJ,  10
 *00016    :13 ,  VJM,   *00053
             7 ,  AEX,  127B
                 ,UIA,   *00021
            12 ,  VLM,   *00016
                 ,UTC,
 *00021    :     ,MTJ,  8
             9 ,  VTM,  60B
 *00022    :13 ,  VJM,   *00060
            13 ,  VJM,   *00101
            13 ,  VJM,   *00065
            12 ,  VLM,   *00022
             7 ,  XTA,  140B
            13 ,  VJM,   *00065
             8 ,  VTM,  77765B
                 ,UTC,
 *00030    : 8 ,  UTC,   *00125
                 ,XTA,
                 ,UZA,   *00042
             7 ,  APX,  133B
            15 ,  ATX,
                 ,ASN,  64B
             7 ,  AUX,  132B
             8 ,  UTC,
L            8 ,  UTC,   БYФ/ПK    +26B
             5 ,  STX,  1
             7 ,  AUX,  137B
             7 ,  AOX,  131B
             8 ,  UTC,
L            8 ,  UTC,   БYФ/ПK    +26B
             5 ,  ATX,
                 ,XTA,
                 ,UTC,   *00125
             8 ,  ATX,
             8 ,  VLM,   *00030
                 ,UTC,
 *00042    : 7 ,  XTA,  111B
                 ,NTR,  3
             7 ,  A+X,  134B
             7 ,  ATX,  111B
                 ,ATI,  5
            13 ,  VTM,   *00047
             7 ,  A-X,  135B
                 ,UZA,   *00073
             7 ,  XTA,  111B
                 ,UTC,
 *00047    : 7 ,  STX,  111B
                 ,STI,  6
                 ,STI,  5
                 ,ATI,  13
             7 ,  XTA,  145B
                 ,STI,  7
                 ,NTR,  6
            13 ,   UJ,
 *00053    :     ,WTC,   *00126
             8 ,  XTA,
             9 ,  ASN,  160B
             7 ,  AAX,  142B
             9 ,  UTM,  8
            13 ,  UTC,
             9 ,  VIM,
             8 ,  UTM,  77777B
             9 ,  VTM,  77720B
            13 ,   UJ,
 *00060    :     ,WTC,   *00126
             8 ,  XTA,
             9 ,  ASN,  70B
             7 ,  AAX,  142B
             9 ,  UTM,  77770B
            13 ,  UTC,
             9 ,  VIM,
             9 ,  VTM,  60B
             8 ,  UTM,  1
            13 ,   UJ,
 *00065    : 6 ,  ASN,  110B
            10 ,  UTC,   *00112
                 ,AOX,
            10 ,  UTC,   *00112
                 ,ATX,
             6 ,  UTM,  8
            13 ,  UTC,
             6 ,  VIM,
             6 ,  VTM,  77720B
            10 ,  UTM,  1
            13 ,   UJ,
                 ,UTC,
 *00073    :     ,XTA,
             5 ,  UTC,  БYФ/ПK
                 ,ATX,
             7 ,   *71, 110B
            14 ,  VTM,  76047B
                 ,XTA,
L*00076    :14 ,  UTC,   БYФ/ПK    +1731B
                 ,ATX,
            14 ,  VLM,   *00076
             7 ,  XTA,  141B
            13 ,   UJ,
                 ,UTC,
 *00101    :14 ,  VTM,  77645B
                 ,UTC,
L*00102    :14 ,  UTC,   TABLE2*   +133B
                 ,AEX,
                 ,UZA,   *00106
L           14 ,  UTC,   TABLE2*   +133B
                 ,AEX,
            14 ,  VLM,   *00102
            14 ,  VTM,  77664B
                 ,UTC,
 *00106    :14 ,  UTM,  133B
                 ,ITA,  14
             7 ,  AOX,  130B
            13 ,   UJ,
                 , Z01, БYФ/ПK
L            5 ,   Z01,  БYФ/ПK    +77777B
 *00111    :,     LOG,  64000000 00000000.
 *00112    :,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000000.
 *00125    :,     LOG,  00000000 00000000.
 *00126    :,     LOG,  00000000 00000000.
            ,     LOG,  00000000 00000040.
            ,     LOG,  00000000 00000200.
            ,     LOG,  00000000 20000000.
            ,     LOG,  00157367 57367570.
            ,     LOG,  37677577 37677577.
            ,     LOG,  64000000 00000030.
            ,     LOG,  64000000 00001731.
            ,     LOG,  12451105 20242040.
            ,     LOG,  00000000 00077173.
            ,     LOG,  00000000 00000174.
            ,     LOG,  64000000 00000000.
            ,     LOG,  00000000 00000177.
            ,     LOG,  23646104 10020040.
 BSS       :     ,BSS,  2
                1,SET,
             1010,   ,  БYФ/ПK
      ,END,
 PUNTEX/:,NAME,. 10.04.73
 PUNCTABL:,SUBP,.
 PUNCHTAB:,EQU,PUNCTABL.
 B:,BSS,.
 8,BASE,*
 ,ATI,9
 ,ITA,13
 ,ITS,
 12,VTM,
 13,VTM,-16
 CYCL:9,XTA,
 12,ASN,64+41.
 ,AAX,=176
 ,ATI,10
 10,UTM,PUNCHTAB.
 10,XTA,
 13,ATX,CARD+16
 10,XTA,1
 13,ATX,CARD+17
 12,UTM,-6.
 13,UTM,2
 13,V1M,CYCL
  ,ITA,15
  ,AAX,=77400
  ,AOX,=340
  ,ATI,13
  ,XTA,
  14,VTM,-22
  :14,UTC,22
  13,ATX,2
  14,VLM,*-1
  ,XTA,=5 2525 2525 2525
  13,ATX,
  13,ATX,1
  ,ITS,13
 14,VTM,CARD
 ,ITS,14
 13,VJM,REVCARD.OБPAЩEHИE K CПEЦ. ПOBOPOTY
 ,*71,INF
 ,STI,
 ,STI,13
 13,UJ,
 RECAP/:,ENTRY,.BXOД ДЛЯ OБPAЩEHИЯ KAPTЫ
 REVCARD:,BSS,.BHYTPEHHИЙ BXOД
 8,VTM,B.
 ,STI,9.BXOДHOЙ MACCИB
 ,ATI,10.BЫXOДHOЙ MACCИB
 ,ITA,13.
 ,ITS,.
 11,VTM,-1.
 L2:,BSS,.
 ,XTA,=:001.ПEPBЫЙ БИT
 ,ATX,BIT.
 L1:,BSS,.
 12,VTM,-3.
 9,XTA,.
 ,ATX,F.TEKYЩEE CЛOBO
 L0:,BSS,.
 14,VTM,-11.
 10,UTM,24.
 L:,BSS,.
 ,XTA,F.
 ,ASN,64-1.
 ,ATX,F.
 ,YTA,.
 ,UZA,NO.
 ,XTA,BIT.
 10,AOX,-2.
 10,ATX,-2.
 NO:,BSS,.
 10,UTM,-2.
 14,VLM,L.
 ,XTA,BIT.
 ,ASN,64+1.
 ,ATX,BIT.
 12,VLM,L0.
 9,UTM,1.
 ,U1A,L1.
 10,UTM,1.
 11,VLM,L2.
 ,STI,.
 ,NTR,6.
 ,STI,13.
 13,UJ,.
  INF:10,Z01,-2
  10,Z00,21
 CARD:,BSS,20
 BIT:,BSS,1
 F:,BSS,1
 ,END,
 PUNTITLE:,NAME,
 MONCARD*:LC,BLOCK,M
 ,ITS,7
 7,BASE,*
 ,ITS,13
 14,VTM,NAMEJOB*
   14,XTS,
 ,ATX,ISO1
 14,XTA,1
 ,AAX,C2
 ,ATX,ISO1+1
 ,XTA,
 ,ATX,ISO1+2.KOHEЦ TEKCTA
 14,VTM,ISO1
 ,ITS,14
 14,VTM,TEK
 ,ITS,14
 ,CALL,ISO*TEX*
 14,VTM,TEK
 ,ITS,14
 ,CALL,PUNTEX/
 ,STX,
 ,STI,13
 ,STI,7
 13,UJ,
 C2:,OCT,7777 74
 NAMEJOB*:,ENTRY,
 NAMEJOB*:,BSS,3
 ISO1:,BSS,3
 TEK:,BSS,1
 ,END,
      PUNUPP     :,NAME,
      TABLE2*    :,SUBP,
      БYФ/ПK     :,PC,  1762B
 *00000    :     ,ITS,  7
             7 ,  VTM,   *00000
             7 ,  STX,  114B
             7 ,  STX,  113B
             7 ,  ATX,  112B
                 ,ITA,  13
                 ,ITS,  5
                 ,ITS,  6
             7 ,  XTS,  100B
                 ,ATI,  5
             6 ,  VTM,  77730B
             7 ,  XTS,  112B
                 ,WTC,   BSS+ 0001B
            13 ,  VJM,
            13 ,  VTM,   *00033
                 ,WTC,   BSS+ 0000B
                 ,XTA,
             7 ,  AEX,  105B
                 ,UIA,   *00014
                 ,WTC,   BSS+ 0000B
                 ,XTA,  1
             7 ,  AEX,  111B
                 ,UZA,   *00057
                 ,UTC,
 *00014    : 8 ,  VTM,  11
             9 ,  VTM,  77720B
            12 ,  VTM,  77671B
                 ,UTC,
 *00016    :13 ,  VJM,   *00037
             7 ,  AEX,  101B
                 ,UIA,   *00022
            12 ,  VLM,   *00016
            12 ,  VTM,  77777B
             7 ,  XTA,  110B
                 , UJ,   *00025
 *00022    :     ,MTJ,  8
             9 ,  VTM,  60B
 *00023    :13 ,  VJM,   *00044
            13 ,  VJM,   *00065
 *00025    :13 ,  VJM,   *00051
            12 ,  VLM,   *00023
             7 ,  XTA,  100B
                 ,NTR,  3
             7 ,  A+X,  103B
             7 ,  ATX,  100B
                 ,ATI,  5
            13 ,  VTM,   *00033
             7 ,  A-X,  104B
                 ,UZA,   *00057
             7 ,  XTA,  100B
 *00033    : 7 ,  STX,  100B
                 ,STI,  6
                 ,STI,  5
                 ,STI,  13
                 ,NTR,  6
                 ,WTC,   BSS+ 0002B
             7 ,  VTM,
            13 ,   UJ,
 *00037    :     ,WTC,   BSS+ 0000B
             8 ,  XTA,
             9 ,  ASN,  160B
             7 ,  AAX,  107B
             9 ,  UTM,  8
            13 ,  UTC,
             9 ,  VIM,
             8 ,  UTM,  77777B
             9 ,  VTM,  77720B
            13 ,   UJ,
 *00044    :     ,WTC,   BSS+ 0000B
             8 ,  XTA,
             9 ,  ASN,  70B
             7 ,  AAX,  107B
             9 ,  UTM,  77770B
            13 ,  UTC,
             9 ,  VIM,
             9 ,  VTM,  60B
             8 ,  UTM,  1
            13 ,   UJ,
 *00051    : 6 ,  ASN,  110B
             5 ,  UTC,  БYФ/ПK
                 ,AOX,
             5 ,  UTC,  БYФ/ПK
                 ,ATX,
             6 ,  UTM,  8
            13 ,  UTC,
             6 ,  VIM,
             6 ,  VTM,  77730B
             5 ,  UTM,  1
            13 ,   UJ,
                 ,UTC,
 *00057    :     ,XTA,
             5 ,  UTC,  БYФ/ПK
                 ,ATX,
             7 ,   *71, 77B
            14 ,  VTM,  76047B
                 ,XTA,
L*00062    :14 ,  UTC,   БYФ/ПK    +1731B
                 ,ATX,
            14 ,  VLM,   *00062
             7 ,  XTA,  106B
            13 ,   UJ,
                 ,UTC,
 *00065    :14 ,  VTM,  77645B
                 ,UTC,
 *00066    :14 ,  UTC,  TABLE2*
                 ,AEX,  133B
                 ,UZA,   *00072
            14 ,  UTC,  TABLE2*
                 ,AEX,  133B
            14 ,  VLM,   *00066
            14 ,  VTM,  77664B
                 ,UTC,
 *00072    :14 ,  UTM,  133B
                 ,ITA,  14
            15 ,  ATX,
                 ,ACX,
             7 ,  AAX,  102B
             7 ,  AEX,  102B
                 ,ASN,  71B
            15 ,  AOX,
            13 ,   UJ,
                 ,UTC,
                 , Z01, БYФ/ПK
L            5 ,   Z01,  БYФ/ПK    +77777B
 *00100    :,     LOG,  64000000 00000000.
            ,     LOG,  00000000 00000040.
            ,     LOG,  00000000 00000001.
            ,     LOG,  64000000 00000030.
            ,     LOG,  64000000 00001731.
            ,     LOG,  12451105 20242040.
            ,     LOG,  64000000 00000000.
            ,     LOG,  00000000 00000177.
            ,     LOG,  00000000 00000217.
            ,     LOG,  23646104 10020040.
 BSS       :     ,BSS,  3
                1,SET,
             1010,   ,  БYФ/ПK
      ,END,
 PUTFLAG*:,NAME,.. 10.04.73
 *REGIM//:,LC,1.
 MONCARD*:,LC,25.
 MONREAD*:,SUBP,.
 ,ITA,13.
 ,ATX,I13.
 14,VTM,MONCARD*
 ,ITS,14.
 14,UTM,13.
 ,ITS,14.
 ,XTS,=1.
 ,CALL,PRINT8.
 12,VTM,MONCARD*+2.
 11,VTM,-2.
 PF1:12,XTA,.
 ,APX,MASK.
 ,XTS,WS.
 ,ASN,64+18.
 15,AOX,.
 ,ATX,WS.
 12,UTM,-1.
 11,VLM,PF1.
 ,ATX,*REGIM//.
 ,XTA,I13.
 ,ATI,13.
 ,UJ,MONREAD*.
 MASK:,GOST,6H777777.
 WS:,BSS,1.
 I13:,BSS,1.
 ,END,.
 READ1   :  ,NAME,
 '
 '       READING   1   CARD
 '
  *REGIM//:,LC,1
  LIMWR*:,LC,2
 COSYTISO:,SUBP,
 BUF1    :  , PP,1024
 BEGIN   : 12,  VTM  ,C                   .
 ,XTS,
 12,STX,BCAR-C
 12,ATX,EWOR-C
             ,  ATI  ,11                  .
             ,  NTR  ,10                  .
             ,  U1A  ,FILE                .
 STRING  : 12,  XTA  ,ADRESS-C            .
           12,  ARX  ,                    .W=0 48P=1
           12,  ATX  ,ADRESS-C            .
             ,  UZA  ,MAG                 .
             ,  WTC  ,ADRESS              .
             ,  XTA  ,-1                  .
           15,  ATX  ,                    .
 12,XTS,BCAR-C
 ,UZA,CARD
 LW:12,ARX,=1-C
 12,ATX,BCAR-C
 ,UZA,ERROR
 ,STX,
           12,  AAX  ,LMASK8-C            .
           12,  AEX  ,LMASK8-C            .
             ,  UZA  ,NEWZON              .
             ,  STX  ,                    .
           11,  ATX  ,                    .
           11,  UTM  ,1                   .
           12,  AAX  ,MASK8-C             .
           12,  AEX  ,END-C               .
             ,  U1A  ,STRING              .
  ,ITA,13
  12,ATX,BCAR-C
 12,XTA,EWOR-C
  ,CALL,COSYTISO
  12,VTM,C
  12,XTS,BCAR-C
  ,STI,13
  13,UJ,
 FILE    :   ,  ASN  ,64-9                .
           12,  AUX  ,MASKINF-C           .
           12,  XTS  ,BUFER-C             .
             ,  ASN  ,64-20               .
           15,  AOX  ,                    .
           12,  ATX  ,INFMAG-C            .
  MAG:12,*70,INFMAG-C
  ,UTC,LIMWR*+1
  ,XTA,
  12,ARX,=1-C
  ,UTC,LIMWR*+1
  ,ATX,
         :  ,ITA,13
          12,XTS,INFMAG-C
            ,CALL,DRUMTAP*
          12,STX,INFMAG-C
            ,ATI,13
           12,  XTA  ,BUFER-C             .
           12,  ATX  ,ADRESS-C            .
             ,  UJ   ,STRING              .
 NEWZON  :   ,  STX  ,                    .
             ,  UJ   ,MAG                 .
 CARD:15,XTA,-1
 12,AAX,LMASK8-C
 ,UZA,ERROR
 12,XTA,=3777 7777 7777 7761-C
 ,UJ,LW
  ERROR:,XTA,*REGIM//
  12,AAX,=77777-C
  ,UZA,PRI
  ,WTC,*REGIM//
  13,VJM,
  12,VTM,C
   PRI:12,*64,INFPR-C
 ,SJ,
 INFPR:,Z00,ERTEXT
 ,Z00,INFMAG
 :0,,
 ,015,
 :2,015,16
 15,021,1
 BUFER   :  3,  37   ,''70000''           .
             ,  20   ,BUF1                .
 C       :   ,  OCT  ,0001 0000 0000 0001 .
 MASK8   :   ,  OCT  ,0000 0000 0000 0377 .
 END     :   ,  OCT  ,0000 0000 0000 0012 .
 UN1     :   ,  OCT  ,0000 0000 0000 0001 .
 MASKINF :   ,  OCT  ,0000 0000 0077 0777 .
 ERTEXT:,BSS,
 ,GOST,14HNONTEXT CARD-'231'
 ADRESS  :   ,  OCT  ,                    .
 INFMAG  :   ,  OCT  ,                    .
 LMASK8  :   ,  OCT  ,776                 .
 EWOR:,BSS,1
 BCAR:,BSS,1
    ,END,
 READ2   :  ,NAME,
 '
 '       READING   1   CARD
 '
  *REGIM//:,LC,1
  LIMWR*:,LC,2
 COSYTISO:,SUBP,
 BUF1    :  , PP,1024
 BEGIN   : 12,  VTM  ,C                   .
 ,XTS,
 12,STX,BCAR-C
 12,ATX,EWOR-C
             ,  ATI  ,11                  .
             ,  NTR  ,10                  .
             ,  U1A  ,FILE                .
 STRING  : 12,  XTA  ,ADRESS-C            .
           12,  ARX  ,                    .W=0 48P=1
           12,  ATX  ,ADRESS-C            .
             ,  UZA  ,MAG                 .
             ,  WTC  ,ADRESS              .
             ,  XTA  ,-1                  .
           15,  ATX  ,                    .
 12,XTS,BCAR-C
 ,UZA,CARD
 LW:12,ARX,=1-C
 12,ATX,BCAR-C
 ,UZA,ERROR
 ,STX,
           12,  AAX  ,LMASK8-C            .
           12,  AEX  ,LMASK8-C            .
             ,  UZA  ,NEWZON              .
             ,  STX  ,                    .
           11,  ATX  ,                    .
           11,  UTM  ,1                   .
           12,  AAX  ,MASK8-C             .
           12,  AEX  ,END-C               .
             ,  U1A  ,STRING              .
  ,ITA,13
  12,ATX,BCAR-C
 12,XTA,EWOR-C
  ,CALL,COSYTISO
  12,VTM,C
  12,XTS,BCAR-C
  ,STI,13
  13,UJ,
 FILE    :   ,  ASN  ,64-9                .
           12,  AUX  ,MASKINF-C           .
           12,  XTS  ,BUFER-C             .
             ,  ASN  ,64-20               .
           15,  AOX  ,                    .
           12,  ATX  ,INFMAG-C            .
  MAG:12,*70,INFMAG-C
  ,UTC,LIMWR*+1
  ,XTA,
  12,ARX,=1-C
  ,UTC,LIMWR*+1
  ,ATX,
         :  ,ITA,13
          12,XTS,INFMAG-C
            ,CALL,DRUMTAP*
          12,STX,INFMAG-C
            ,ATI,13
           12,  XTA  ,BUFER-C             .
           12,  ATX  ,ADRESS-C            .
             ,  UJ   ,STRING              .
 NEWZON  :   ,  STX  ,                    .
             ,  UJ   ,MAG                 .
 CARD:15,XTA,-1
 12,AAX,LMASK8-C
 ,UZA,ERROR
 12,XTA,=3777 7777 7777 7761-C
 ,UJ,LW
  ERROR:,XTA,*REGIM//
  12,AAX,=77777-C
  ,UZA,PRI
  ,WTC,*REGIM//
  13,VJM,
  12,VTM,C
   PRI:12,*64,INFPR-C
 ,SJ,
 INFPR:,Z00,ERTEXT
 ,Z00,INFMAG
 :0,,
 ,015,
 :2,015,16
 15,021,1
 BUFER   :  3,  37   ,''70000''           .
             ,  20   ,BUF1                .
 C       :   ,  OCT  ,0001 0000 0000 0001 .
 MASK8   :   ,  OCT  ,0000 0000 0000 0377 .
 END     :   ,  OCT  ,0000 0000 0000 0012 .
 UN1     :   ,  OCT  ,0000 0000 0000 0001 .
 MASKINF :   ,  OCT  ,0000 0000 0077 0777 .
 ERTEXT:,BSS,
 ,GOST,14HNONTEXT CARD-'231'
 ADRESS  :   ,  OCT  ,                    .
 INFMAG  :   ,  OCT  ,                    .
 LMASK8  :   ,  OCT  ,776                 .
 EWOR:,BSS,1
 BCAR:,BSS,1
    ,END,
      RECATA*    :,NAME,
 *00000    :14 ,  VTM,   *00005
                 ,UTC,
 *00001    :     ,ITS,  6
                 ,ITS,  7
                 ,ITS,  8
                 ,ITS,  9
                 ,ITS,  13
                 ,ITS,
            14 ,   UJ,
                 ,UTC,
 *00005    : 8 ,  VTM,   *00000
            13 ,  VTM,   *00014
 *00006    : 7 ,  VTM,  77761B
                 , *65, 575B
                 ,ATI,  9
                 ,UTC,
 *00010    : 7 ,  UTC,  15
             9 ,   *65,
            10 ,  AEX,
            13 ,  UZA,
             7 ,  VLM,   *00010
                 ,MTJ,  11
                 , UJ,   *00026
                 ,UTC,
 *00014    : 7 ,  UTM,  47B
                 ,ITA,  7
                 ,ASN,  64B
            13 ,  VTM,   *00021
 *00016    :     ,ITS,  11
                 ,ASN,  54B
             8 ,  AOX,  153B
            15 ,  AOX,
            13 ,   UJ,
                 ,UTC,
 *00021    : 8 ,  AOX,  156B
            13 ,  VTM,   *00026
 *00022    : 8 ,  ATX,  176B
             8 ,   *70, 176B
             8 ,  XTA,  155B
             8 ,  ARX,  176B
             8 ,  ATX,  176B
             8 ,   *70, 176B
            13 ,   UJ,
                 ,UTC,
 *00026    :     ,STI,
                 ,STI,  13
                 ,STI,  9
                 ,STI,  8
                 ,STI,  7
                 ,STI,  6
                 ,NTR,  6
            13 ,   UJ,
      WRCATA*   :,ENTRY,
            14 ,  VJM,   *00001
             8 ,  VTM,   *00000
            13 ,  VJM,   *00006
             7 ,  UTM,  47B
            13 ,  VTM,   *00054
 *00035    :     , *65, 502B
                 ,ATI,  9
             9 ,   *65,
             8 ,  AAX,  161B
             8 ,  ATX,  174B
                 ,ASN,  152B
                 ,ATI,  6
                 , *65, 576B
                 ,ATI,  9
                 , *65, 760B
             8 ,  ATX,  200B
                 ,WTC,   BSS+ 0007B
                 , *65, 5
             8 ,  ATX,  201B
                 ,WTC,   BSS+ 0007B
                 , *63,
                 ,NTR,  3
                 ,ITS,  6
            15 ,  A-X,
                 ,ATI,  6
                 , *65, 762B
             8 ,  ARX,  201B
             8 ,  ATX,  177B
            13 ,   UJ,
                 ,UTC,
 *00054    : 7 ,   *65, 650B
            15 ,  ATX,
                 ,WTC,   BSS+ 0006B
             6 ,   *65,
            15 ,  AAX,
                 ,ASN,  140B
            15 ,  ATX,
                 ,WTC,   BSS+ 0007B
                 , *63, 33B
            15 ,  AAX,
                 ,UIA,   *00066
                 , *65, 3
             8 ,  AEX,  167B
                 ,ASN,  37B
                 ,UIA,   *00074
                 ,UTC,
 *00066    :11 ,  VZM,   *00073
                 ,ITA,  7
                 ,ASN,  64B
            13 ,  VJM,   *00016
             8 ,  AOX,  157B
            13 ,  VJM,   *00022
             8 ,  XTA,  176B
             8 ,  ARX,  154B
            13 ,  VJM,   *00022
 *00073    :11 ,  UTC,
                 ,UTC,
 *00074    :11 ,  VTM,
                 , UJ,   *00026
      MNPLOUT   :,ENTRY,
            14 ,  VJM,   *00001
             8 ,  VTM,   *00000
            13 ,  VJM,   *00035
                 , UJ,   *00026
                 ,UTC,
      NAMTONUM  :,ENTRY,
                 ,UTC,   *00160
                 ,AEX,
                 ,UIA,   *00122
                 , UJ,   *00122
            14 ,  VJM,   *00001
             8 ,  VTM,   *00000
            13 ,  VJM,   *00035
                 ,WTC,   BSS+ 0007B
                 , *65, 20B
             8 ,  ATX,  172B
            13 ,  VJM,   *00006
             7 ,  UTM,  47B
                 ,ITA,  7
                 ,ASN,  42B
             8 ,  ATX,  173B
             8 ,  XTA,  165B
                 ,NTR,  3
             8 ,  A-X,  172B
                 ,ATI,  7
 *00112    :     ,WTC,   BSS+ 0001B
             9 ,   *65, 77777B
             8 ,  ATX,  175B
             8 ,  AEX,  174B
             8 ,  AAX,  161B
                 ,UIA,   *00121
             8 ,  XTA,  175B
             8 ,  AAX,  162B
             8 ,  AEX,  173B
                 ,UIA,   *00121
             8 ,  XTA,  175B
            11 ,  AEX,
             8 ,  AAX,  163B
                 ,UZA,   *00123
 *00121    : 7 ,  VLM,   *00112
                 ,UTC,
 *00122    :14 ,  VTM,  1
                 , UJ,   *00026
 *00123    : 8 ,  XTA,  175B
                 ,ASN,  130B
             8 ,  AAX,  164B
             8 ,  XTS,  175B
             8 ,  AEX,  170B
             8 ,  ARX,  166B
             8 ,  AAX,  170B
                 ,ASN,  72B
            15 ,  AOX,
             8 ,  STX,  171B
                 ,MTJ,  14
                 ,STI,  13
                 ,STI,  9
                 ,STI,  8
                 ,STI,  7
                 ,STI,  6
                 ,UTC,   BSS+ 0000B
                 ,XTA,
                 ,NTR,  6
            13 ,   UJ,
            14 ,  WTC,  42B
             6 ,  XTA,  77777B
             7 ,  AOX,  650B
             7 ,  AEX,  650B
            14 ,  WTC,  42B
             6 ,  ATX,  77777B
            14 ,  WTC,  43B
                 ,XTA,  33B
             7 ,  AOX,  650B
             7 ,  AEX,  650B
            14 ,  WTC,  43B
                 ,ATX,  33B
                 ,MTJ,  27B
             2 ,   IJ,
            14 ,  WTC,  33B
             6 ,  XTA,  77777B
            14 ,  WTC,  34B
                 ,AOX,  33B
            14 ,  WTC,  33B
             6 ,  AEX,  77777B
            14 ,  WTC,  34B
                 ,ATX,  33B
                 ,XTA,
            14 ,  WTC,  33B
             6 ,  ATX,  77777B
                 ,ATI,  27B
             2 ,   IJ,
                 ,UTC,
             1 ,  A+X,
                 ,ATX,  7774B
 *00154    :,     LOG,  77777700 00000000.
            ,     LOG,  00000100 00000001.
            ,     LOG,  00100002 00000000.
            ,     LOG,  00000004 00000000.
 *00160    :,     LOG,  22451252 51224512.
            ,     LOG,  77000000 00000000.
            ,     LOG,  00007700 00000000.
            ,     LOG,  00000017 77177700.
            ,     LOG,  00000000 00770000.
            ,     LOG,  00000000 00100000.
            ,     LOG,  00000000 00000001.
            ,     LOG,  00000000 00071717.
            ,     LOG,  00000000 00000017.
 BSS       :     ,BSS,  9
      ,END,
      RECO       :,NAME,
 *00000    :10 ,  VTM,   *00000
                 ,UTC,
 *00001    :     ,ASN,  72B
            10 ,  ATX,  43B
                 ,YTA,
            15 ,  ATX,
            10 ,  AAX,  42B
                 ,ATI,  8
            15 ,  AEX,
                 ,ASN,  101B
                 ,ATI,  12
                 ,UTC,   *00020
             8 ,  XTA,
            12 ,  ASN,  60B
            10 ,  AAX,  41B
                 ,UIA,   *00011
            15 ,  AAX,
            13 ,   UJ,
 *00011    :10 ,  AEX,  40B
            11 ,  ASN,  50B
            15 ,  ATX,
                 ,YTA,
             9 ,  AEX,  1
             9 ,  STX,  1
             9 ,  AEX,
             9 ,  ATX,
            11 ,  UTM,  8
            10 ,  XTA,  43B
                 ,UIA,   *00001
                 ,STX,
            13 ,   UJ,
                 ,UTC,
 *00020    :,     LOG,  10020120 36430000.
            ,     LOG,  10020121 20230400.
            ,     LOG,  10020122 20431142.
            ,     LOG,  10020123 20631543.
            ,     LOG,  10020124 21032144.
            ,     LOG,  10020125 21232546.
            ,     LOG,  10020126 21433147.
            ,     LOG,  10020127 21633551.
            ,     LOG,  10020130 22034000.
            ,     LOG,  10020131 22234400.
            ,     LOG,  10020132 22474052.
            ,     LOG,  10020173 22600152.
            ,     LOG,  10020174 23070154.
            ,     LOG,  10020175 23200161.
            ,     LOG,  10020176 23400166.
            ,     LOG,  10020140 23674457.
            ,     LOG,  00000000 10000000.
            ,     LOG,  00000000 77600000.
            ,     LOG,  00000000 00000017.
 BSS       :     ,BSS,  1
      ,END,
  REDACT1:,NAME,.1-Й ПPOXOД ПO ФAЙЛY И BOЗHЯ CO CПИCKAMИ. ЛOПATKO B.Б.
C
C.....   ПЛABAЮЩИЙ ФOPMAT N1 , N2
C.....   ПPИKAЗЫ : '.L' , '.S'
C
  PRINT8:,SUBP,
  MATINFEX:,LC,1
 *1:,BLOCK,LC,WC,LR,MT,MC,W,B
 ,CONT,NC,PR,LE,R,AC,RR,S
 S/L:,EQU,12B.
 S/PL:,EQU,53B
 S/C:,EQU,54B.
 S/M:,EQU,55B
 S/PNT:,EQU,56B
 S/D0:,EQU,60B.
 S/TWOP:,EQU,72B
  BUFFER:PC,BLOCK,RF(4096)
 *PAGES:PC,BLOCK,LIST(1024)
 PFILES:LC,BLOCK,MSTO,NFIL,FILS(8)
 ,CONT,MPUN
  N//:,P/P,(LIST)16
 C:,BSS, .
 B,BASE,C.
 ,ITA,RR.
 ,ATX,RET.
 MC,VTM,0.BHE PEДAKЦИИ
 LC,VTM,-1024.OБMEH HE HYЖEH
 NC,VTM,0.HOMEP KAPTЫ
 AC,VTM,-7777B
 ,XTA,
 ZZ:AC,UTC,7777B
 ,ATX,RF
 AC,VLM,ZZ
 PR,VTM,2.POINTER RELATIVE
 LR,VTM,0.LAST REF.
 LE,VTM,0.LAST EDIT
C  CTPYKTYPA ДAHHЫX MT-PEДAKTOPA:
C  R-CЛOBO:
C  48-37 - N KAPTЫ
C  36-25 - R-CCЫЛKA BBEPX
C  24-13 - ПOЛE KOMAHДЫ:
C   24-23PP=0 - ЗA R-CЛOBOM TEKCT
C   24P=1 - DELETE
C   23P=1 - INSERT
C   24-23PP=3 - YПPABЛ.KAPTA, TOГДA
C      B 21-19PP EE KOД:
C   1 - LISTING
C   2 - STOP
C   3 - PUNCH
C   4 - = /WRITE
C   22P=1 - KOHEЦ ФPAГMEHTA PEДAKЦИИ
C   16P=1 - INS/DEL C ЗAMEHOЙ
C   E-CЛOBO:
C   48-37 - N HAЧAЛA  N1
C   36-25 - E-CCЫЛA BBEPX
C   24-13 - N KOHЦA   N2
C   12-1  - E-CCЫЛKA BHИЗ
C   TEKCT ЗAMEHЫ, ECЛИ B R-CЛOBE 16P=1
 LOOP 1:NC,UTM,1.
 RR,VJM,READ CO.
 W,VZM,LOOP 1.ПPOCTAЯ KAPTA
 ,ITA,PR
 ,ASN,64+12
 ,U1A,OVER.ПEPEПOЛHEH БYФEP
 W,UJ,SWITCH-1.
 SWITCH:,BSS,.
C......   ПEPEKЛЮЧATEЛЬ 1-ГO ПPOXOДA
 :,XTA,E FRAG.KOHEЦ ФAЙЛA
 ,UJ,ELOOP 1.
 :RR,VTM,SIM CA.BHYTPИ
 ,UJ,INSE NC.PEДAKЦИИ
 :,,.INSERT
 :RR,VTM,INS DEL.
 ,UJ,INSE NC.DELETE
 :MC,VZM,LOOP1.KOHEЦ
 ,UJ,POINT.ФPAГMEHTA
 /6:,,.ЛИCTИHГ ФAЙЛA
 /7:,,.CTOП
 /8:,,.ПEPФOPAЦИЯ
 /9:RR,VJM,INSE NC.ЗAПИCЬ ФAЙЛA
C OФOPMЛEHИE YK B E-ФOPMATE C TEKCTOM:
 LR,XTA,RF
 ,AOX,E FRAG.BBEPXY ПO R
 LR,ATX,RF
 ,ITA,PR
 LE,AOX,RF+1.E-CCЫЛKA BHИЗ
 LE,ATX,RF+1.
 W,UTM,-5
 ,ITA,W.KOД L,S,=
 ,ASN,64-18.И KOД PUNCH
 ,AOX,B24/23.=TИП YK
 PR,AOX,RF
 PR,ATX,RF
 ,ITA,NC.
 ,ASN,64-12.=N1
 ,ITS,LE.E-CCЫЛKA BBEPX
 15,AOX,.
 ,ASN,64-24
 ,ITS,NC.=N2
 ,ASN,64-12
 15,AOX,.
 PR,ATX,RF+1
 PR,MTJ,LR
 PR,MTJ,LE
 PR,UTM,2.ДЛИHA E-ФOMATA
 W,VTM,CARD.ПEPEПИCЬ
 ,UJ,SC 1.TEKCTA YK
 SIM CA:,BSS,.
 PR,MTJ,LR.
 W,VTM,CARD.
 PR,UTM,1.
  SC 1:W,XTA,.
 PR,ATX,RF
 W,UTM,1.
 PR,UTM,1.
 WC,VLM,SC 1.
 ,UJ,LOOP 1.
 INS DEL:,BSS,.
 ,XTA,E FRAG.KOHEЦ
 LR,AOX,RF.ФPAГMEHTA
 LR,ATX,RF.B ПPEДЫДYЩEE
 ,ITA,PR.PEДAKЦИOH.
 LE,AOX,RF+1.CCЫЛKA
 LE,ATX,RF+1.B ПPEДЫДYЩEE
 W,UTM,-2.
 ,ITA,W.
 ,ASN,64-22.
 PR,AOX,RF.TИП
 PR,ATX,RF.PEДAKЦИИ
 ,ITA,LE.CCЫЛKA
 ,ASN,64-24.HA ПPEДЫД.
 PR,ATX,RF+1.PEДAKЦИЮ
 PR,MTJ,LR.
 PR,MTJ,LE.
 PR,UTM,2.
 W,VTM,0.-ДЛИHA TEKCTA
 AC,VTM,CARD.ПOPTИT GIVE RN
 RR,VJM,GIVE RN.
 WC,V1M,NON TWOP.WC ФOPMИP.GIVE
 ,ATX,WS.=N1,N2
 PR,UTM,1.CBOБ
 W,UTC,-1.=R-CПИCOK
 PR,XTA,RF-1
 ,AOX,=1 00000.TИП ЗAMEHЫ :
 W,UTC,-1
 PR,ATX,RF-1
 ,XTA,WS
 NONTWOP:W,UTC,.=LE-CПИCOK
 PR,AOX,RF-1
 W,UTC,
 PR,ATX,RF-1
 MC,VTM,1.
 ,UJ,LOOP 1.
 POINT:MC,VTM,0.
 ,XTA,E FRAG.
 LR,AOX,RF
 LR,ATX,RF
 ,UJ,LOOP 1.
 INSE NC:,BSS,.
 ,ITA,PR.
 LR,AOX,RF.CCЫЛKA B
 LR,ATX,RF.ПPEДЫДYЩEE
 ,ITA,NC.
 ,ASN,64-12.TEK.HOMEP
 ,ITS,LR.
 15,AOX,.
 ,ASN,64-24.CCЫЛKA
 PR,ATX,RF.BBEPX
 RR,UJ,.
 E LOOP1:LE,VZM,RETURN.HET YK И PEД.
 LR,AOX,RF
 LR,ATX,RF
 ,ITA,LE.XBOCT E-CПИCKA
 ,ATX,L MAX.ДЛЯ DEL RED
 ,XTA,
 ,ATX,RF.MOДEЛЬ ЯЧ.0
 ,ATX,RF+1
 LOOP2:,BSS,
 LE,XTA,RF+1
 ,AAX,B36/25
 ,UZA,IN LOOP3.ДOШЛИ ДO KOHЦA
 LE,MTJ,LR.
 LE,XTA,RF
 ,AEX,B24/23.TИП YK
 ,AAX,B24/23.
 ,UZA,E LOOP2
 LE,XTA,RF+1
 R,VJM,GIVRN C.ПOЛYЧEHИE N1,N2
 ,ATX,N1.
 ,XTA,N21.
 ,ATX,N2.
 NEXT REC:,BSS,.
C.......  BBEPX HA БЛИЖ. PEKOPД
 LR,XTA,RF
 ,ASN,64+24.
 ,AAX,C7777
 ,ATI,LR.
 LR,VZM,ELOOP 2.HA CЛEД. PEД.
 LR,XTA,RF
C......   KOHTPOЛЬ ПEPECEЧEHИЯ PEДAKЦИЙ
 ,AAX,B24/23.
 ,UZA,OKEY.HE PEДAKЦИЯ
 ,AEX,B24/23.
 ,UZA,OKEY.TИП YK
 LR,XTA,RF+1
 R,VJM,GIV RN.ЗA HOMEPAMИ
 ,XTA,N2.
 ,A-X,N11.
 ,UIA,OKEY.
 ,XTA,N21.
 ,A-X,N1.
 ,UZA,ER RED.
C......
 OKEY:LR,XTA,RF
 ,ASN,64+36
 ,ATX,NCH.
 ,A-X,N1.
 ,U1A,ELOOP 2.
 ,XTA,N2.
 ,A-X,NCH.
 ,UIA,NEXT REC.
 LE,XTA,RF
 ,AAX,M INS.
 ,UZA,DELETE.
 INSERT:LE,MTJ,LC.ИCKЛЮЧEHИE
 RR,VJM,DEL RED.PEД-ФPAГMEHTA
 LE,XTA,RF
 ,AAX,E FRAG.
 ,U1A,E LOOP2.BCTABЛЯTЬ HEЧEГO
 LR,VZM,E LOOP2
 LE,XTA,RF
 ,AAX,C7777
 ,ATI,PR.
 LO 4:PR,XTA,RF.ИЩEM
 W,VTM,0.-R-CCЫЛKИ
 ,AAX,E FRAG.KOHEЦ
 ,UIA,ELO 4.ФPAГMEHTA
 PR,XTA,RF
 ,AAX,C7777
 ,ATI,PR.
 ,UJ,LO 4.
 ELO 4:LR,XTA,RF.CTABИM
 ,AAX,E FRAG.ПPИЗHAK KOHЦA
 ,AEX,E FRAG.ФPAГMEHTA,
 PR,AEX,RF
 PR,ATX,RF.ECЛИ HAДO.
 LR,XTA,RF
 ,AOX,E FRAG.ГACИM
 ,AEX,E FRAG.ПPИЗHAK KOHЦA
 LR,ATX,RF.ФPAГMEHTA
 ,AAX,C7777.-ЗAMKHEM
 ,ATX,WS.R-CCЫЛKИ
 ,ITA,PR.BCTABKИ И
 ,ATX,WS1.KAPTЫ,CЛEД.
 R,VJM,CONN.ЗA PEДAKTИPYEMOЙ
 ,ITA,LR.-ЗAMKHEM
 ,ATX,WS1.R-CCЫЛKИ
 LE,XTA,RF.1-OЙ KAPTЫ И
 ,AAX,C7777.BCTABKИ И
 ,ATX,WS.PEДAKTИPYEMOЙ
 R,VJM,CONN
 ,XTA,
 ,ATX,RF.MOДEЛЬ
 ,ATX,RF+1.ЯЧEЙKИ 0
 ,UJ,E LOOP2
 DELETE:,BSS,.
C
C  MC(=0) - ФЛAГ 'BCTABЛЯTЬ'
C......   WC - ФЛAГ 'ПEPBAЯ ИCKЛЮЧ. PEДAKЦИЯ'
C  AN(12-1 PP) - OTHOCИT.AДPEC ФPAГMEHTA,
C     CЛEДYЮЩEГO ЗA ИCKЛЮЧAEMЫM
C
 MC,VTM,0.
 WC,VTM,0.
 LR,XTA,RF
 ,AAX,C7777
 ,ATX,AN.
 ,XTA,NCH.
 ,ATI,NC.
 ,AEX,N2.KOHEЦ PEДAKЦИИ
 ,UZA,DEL 1.OTHOCИTCЯ
 MC,VTM,1.K ПAKETY
 DEL 1:LR,XTA,RF
 ,AAX,B24/23.
 ,UZA,DEL 2.
 WC,VIM,DEL 1/1.
C  ПPOБA ЗAMEHЫ B PEДAKTИPYЮЩEM ФPAГMEHTE:
 LE,XTA,RF
 ,AAX,=100000
 ,UZA,NON2P
 LE,MTJ,AC
 AC,XTA,RF.ПPOBEPИM
 ,ASN,64+36.OПEPAЦИЮ
 ,ATI,NC.-ДЛЯ ER FILE
 AC,UTM,2.HAЧAЛO ЗAMEHЫ
 AC,XTA,RF+1
 ,ATX,CARD+1
 AC,XTA,RF+2
 ,ATX,CARD+2
 AC,XTA,RF
 ,ATX,CARD
 ,AAX,=6H'''''377'''''''
 ,AEX,=6H''''+''''''
 ,UZA,PLUS
 ,AEX,=6H''''+''''''
 ,AEX,=6H''''-''''''
 ,U1A,ER FILE
 ,UTC,M DEL-M INS
 PLUS:,XTA,M INS.BПИШEM
 LR,XTS,RF.HOBYЮ OПEPAЦИЮ
 ,AAX,Z24/23
 15,AOX,
 LR,ATX,RF
 PR,VTM,12000B.Б.ПOPTИTЬ
 AC,UTM,RF
 ,XTA,NCH.ДИAПAЗOH B LR+1
 ,ATI,NC
 RR,VJM,GIVE RN
 ,UZA,ER N1N2
 LE,MTJ,LC.ДЛЯ DELRED
 ,XTS,M A1A2
 LR,AAX,RF+1.OLD ADDRESSES
 15,AOX,
 LR,ATX,RF+1
 RR,VTM,E LOOP2.BЫБPOCИM
 ,UJ,DEL RED.PEД.ФPAГMEHT
 NON2P:,BSS,
 WC,VTM,1.ПPOXOДИM
 LR,XTA,RF.1-Ю PEДAKЦИЮ
 ,AAX,C7777
 ,ATX,AN.
C......   ИCKЛЮЧEHИE BCEГO ФPAГMEHTA PEДAKTИPOBAHИЯ,
C         ПOПABШEГO B DELETE-OБЛACTЬ
 DEL 1/1:LR,MTJ,LC.
 RR,VJM,TAKE RED.B24/23 ДЛЯ DEL3
 DEL 2:NC,UTM,-1.
 LR,MTJ,PR.ЗAПOMИHAHИE
 LR,XTA,RF
 ,ASN,64+24.ФPAГMEHTOM
 ,AAX,C7777
 ,ATI,LR.BЫШE
 LR,VZM,D END.KOHEЦ CПИCKA
 LR,XTA,RF
 ,ASN,64+36
 ,A-X,NCH.ПPOБA BCTABKИ
 ,UZA,D END.N CЛEД.GT.N TEK.
 ,A+X,NCH.
 ,ATX,NCH.
 ,A-X,N1.DELETE-OБЛACTЬ
 ,UIA,D END.KOHЧИЛACЬ
 ,ITA,NC.
 ,AEX,NCH.
 ,UZA,DEL 1.
 MC,VTM,1.B DELETE-OБЛACTИ
 ,UJ,DEL 1.KAPTЫ ПAKETA
 D END:PR,XTA,RF
 ,ASN,64+36
 ,AEX,N1.
 ,UZA,DEL 3.1-Я ИCKЛ. KAPTA
 MC,VTM,1. -  B ПAKETE
 DEL 3:PR,XTA,RF
 ,ASN,64+24.
 ,AAX,C7777
 ,ATI,LR.
 PR,XTA,RF.ПEPBOЙ ИCKЛЮЧ.
 ,AAX,B24/23.БЫЛA KAPTA
 ,UIA,DEL 4.PEДAKЦИИ
 ,WTC,AN.
 WC,VTM,.ПPOBEPKИ, И
 WC,VZM,DEL 3/1.ПPOCTABЛЯEM
 WC,XTA,RF.ПPИЗHAK
 ,AAX,B24/23.KOHЦA
 ,UZA,DEL 3/1.ФPAГMEHTA
 LR,XTA,RF.ECЛИ HAДO.
 ,AOX,E FRAG.
 LR,ATX,RF
 DEL 3/1:,ITA,LR.YДAЛEHИE ПO
 ,ATX,WS1.R-CCЫЛKAM
 ,ITA,WC.OБЛACTИ DELETE
 ,ATX,WS
 W,VTM,0
 R,VJM,CONN
 DEL 4:MC,VZM,INSERT
 E LOOP2:LE,XTA,RF+1.E-CCЫЛKA
 ,ASN,64+24.BBEPX
 ,AAX,C7777
 ,ATI,LE
 LE,V1M,LOOP2
C
C ПPOBEPKA E-CПИCKA,ЧTOБЫ HE ПEPECEKAЛИCЬ
C ДИAПAЗOHЫ:
 IN LOOP3:,XTA,L MAX.ИДEM OT XBOCTA
 ,ATI,LE
 LOOP3:LE,XTA,RF+1
 R,VJM,GIVRN C
 ,ATX,N1.ГOTOB
 ,XTA,N21.KOHTPOЛЬHЫЙ
 ,ATX,N2.ДИAПAЗOH
 LE,MTJ,LR
 UP RED:LR,XTA,RF+1
 ,ASN,64+24.BBEPX ПO E
 ,AAX,C7777
 ,ATI,LR
 LR,VZM,NEX CHECK.HAЧAЛO E-CПИCKA
 LR,XTA,RF+1
 R,VJM,GIVRN C.
C CPABHEHИE C KOHTPOЛЬHЫM ДИAПAЗOHOM:
 ,A-X,N2.ПPOBEPKA C N11:
 ,U1A,CHECK N21.N2.GT.N11
 ,NTR,7.ЛOГ
 ,U1A,UP RED.N2.LT.N11
 ,UJ,ER RED.N2=N11
 CHECK N21:,XTA,N21
 ,A-X,N1
 ,U1A,UP RED.N21.LT.N1
 ,UJ,ER RED.N21.GE.N1
 NEX CHECK:LE,XTA,RF+1
 ,ASN,64+24.BBEPX ПO E
 ,AAX,C7777
 ,ATI,LE
 LE,V1M,LOOP3
C
C YПOPЯДOЧИTЬ E-CПИCOK ПO ДИAПAЗOHAM:
 ,XTA,L MAX.ИДEM OT XBOCTA
 ,ATI,PR
 PR,VZM,E LOOP5.E-CП ПYCT
 ON LOOP4:,XTA,L MAX.-ИДEM OT XBOCTA
 ,ATI,LE.E-CПИCKA
 WC,VTM,0.HET CMEHЫ MAX ДЛЯ BCEГO E-CПИCKA
 LOOP4:LE,XTA,RF+1
 R,VJM,GIVRN C
 ,ATX,N1.CAMЫЙ
 ,XTA,N21.BЫCOKИЙ (MAX)
 ,ATX,N2.ДИAПAЗOH
 MC,VTM,0.HET CMEHЫ MAX ДЛЯ ДAHHOГO LE
 LE,MTJ,LR
 UP RED1:LR,XTA,RF+1
 ,ASN,64+24.BBEPX ПO E
 ,AAX,C7777
 ,ATI,LR
 LR,VZM,DO.HAЧAЛO E-CПИCKA
 LR,XTA,RF+1
 R,VJM,GIVRN C.
C CPABHEHИE C MAX.ДИAПAЗOHOM:
 ,A-X,N2.ПPOBEPKA C N11
 ,U1A,UP RED1.N2.GT.N11
 ,XTA,N11.CMEHA MAX
 ,ATX,N1
 ,XTA,N21.ДИAПAЗOHA
 ,ATX,N2
 MC,VTM,1.БЫЛA CMEHA MAX
 WC,VTM,1
 LR,MTJ,LC.ДЛЯ TAKE RED
 ,UJ,UP RED1
 DO:MC,VZM,E LOOP4
 RR,VJM,TAKE RED.BЗЯЛ HOBЫЙ MAX
C  ПOCTABAИM HOBЫЙ MAX ПEPEД YПOPЯДOЧEHHЫM
C  XBOCTOM E-CПИCKA И ЗA ПPOCMOTPEHHЫM E-CП
 LE,XTA,RF+1.E-CCЫЛKA BHИЗ
 ,AAX,C7777.ЭTOГO CTABИM
 RR,VJM,CON RED.ЗA MAX (LC)
 ,ITA,LC.ЭTOГO CTABИM
 LE,MTJ,LC.ЗA LE =
 RR,VJM,CON RED.ПPOCMOTP.E-CП
 E LOOP4:LE,XTA,RF+1
 ,ASN,64+24.BBEPX ПO E
 LE,MTJ,PR
 ,AAX,C7777
 ,ATI,LE
 LE,V1M,LOOP4.PR=HAЧAЛO E-CПИCKA
C
 WC,V1M,ON LOOP4.CMEHЫ MAX
C BЫБOP YK ИЗ YПOPЯДOЧ.E-CПИCKA B COMMON'Ы:
 AC,VTM,PFILES
 PR,MTJ,LE.YПPЯT
 LOOP5:,BSS,
 LE,XTA,RF
 ,AEX,B24/23.TИП YK
 ,AAX,B24/23
 ,U1A,NEX E
 LE,XTA,RF.21-19 PP
 ,ASN,64+18
 ,AAX,=7
 ,UZA,NEX E.HE YK
 ,ATI,WC
 WC,UJ,*.ПEPEKЛ ПO KOДY
 :AC,XTA,NFIL-PFILES.ЛИCTИHГ
 ,UJ,LISTING
 :AC,ATX,.M STOP
 ,UJ,ON DEL
  :,,.ПEPФOPAЦИЯ
 ,UJ,ON DEL
 :LE,XTA,RF+2.ЗAПИCЬ(.=ZZZ)
 ,ATX,INF W.(ПOCЛEДHЯЯ)
 ,UJ,ON DEL
 LISTING:,ATI,14
 ,ARX,=1
 ,AAX,=7.8 ПOCЛEДHИX
 AC,ATX,NFIL-PFILES
 LE,XTA,RF+2.TEKCT .LZZZ
 14,UTC,
 AC,ATX,FILS-PFILES
 ON DEL:LE,MTJ,LC.-ИCKЛЮЧ.
 RR,VJM,DEL RED.YK ФP-T
 ,ITA,LE.-ПPOBEPИTЬ
 ,ITS,PR.HAЧAЛO E-CПИCKA
 15,AEX,
 ,U1A,NEX E.HE MEHЯTЬ PR
 PR,XTA,RF+1.=BHИЗ ПO E
 ,AAX,C7777
 ,ATI,PR
 NEX E:LE,XTA,RF+1
 ,AAX,C7777
 ,ATI,LE.BHИЗ ПO E
 LE,V1M,LOOP5
 E LOOP5:PR,MTJ,LE.=HAЧ.E-CПИCKA
 MC,VTM,0.BHE PEДAKЦИИ(ДЛЯ READCO)
 RETURN:,WTC,RET.
 ,UJ,
C......   PAЗHЫE ПOДПPOГPAMMЫ
 READ CO:,ENTRY,.
C
C......   ЧTEHИE OЧEPEДHOЙ KAPTЫ, EE PACПOЗHABAHИE
C
 READ CO:B,BASE,C.
 R,VJM,READ.
  ,XTA,CARD
  ,AEX,RCOD
  ,AAX,MCC
  ,UIA,ANAL
C...ПOЛYЧИЛИ  .R
  ,ITA,13
  ,ATX,SAV13
  ,XTA,CARD
  ,CALL,OБPYK*MT
  ,XTS,SAV13
  ,STI,13
  ,AOX,RN//
  ,ARX,=777
  ,AAX,=7777 7777 7777 0777
C...ПEPEXOД HA HOBЫЙ ЛИCT COГЛACHO YKAЗATEЛЮ
  ,XTS,INFR
  ,STX,OLDBUF
  ,ATX,INFR
  LC,VTM,
  R,VJM,READ
  ANAL:,BSS,
 W,VTM,0.
 ,XTA,CARD.
 ,AEX,CEND.
 ,UZA,E FILE
 ,XTA,CARD.
 ,AEX,CRO 1.
 ,UIA,RC 0.
 ,XTA,CARD+1.
 ,AEX,CRO 2.
  ,UIA,RC0
C...ПOЛYЧИЛИ *READ OLD
  ,XTA,OLDBUF..PEДAKЦИЯ B
 ,UZA,E FILE.B TOM ЖE ФAЙЛE
  ,ARX,=777
  ,AAX,=7777 7777 7777 0777
   ,ATX,INFR
  LC,VTM,
  R,VJM,READ.ЧИTAEM PEД.
  ,XTA,CARD
  ,AEX,RCOD.ГЛOTAEM
  ,AAX,MCC.YKAЗATEЛЬ
  ,UIA,ERFILE.ЧTEHИЯ
  ,ATX,OLDBUF
  ,UJ,READCO
 E FILE:W,VTM,1
 RR,UJ,
  RCOD:,ISO,6H.R''''''''
 RN//:,010,N//
  ,,
  SAV13:,BSS,1
 RC 0:,XTA,CARD.
 ,AEX,FCOD.POINT
 ,AAX,=:776
 ,U1A,RC 1/1.TEKCT.KAPTA
 ,XTA,CARD
 ,AAX,MCC.
 ,ATX,COD.
 W,VTM,FCOD-LCOD.
 RC 1:W,AEX,LCOD
 ,UZA,RC 3.
 ,XTA,COD
 W,VLM,RC 1.
 RC 1/1:,BSS,
 RR,UTC,.
 MC,VZM,.
 W,UTM,2
 RR,UJ,.
  LCP3:,EQU,CPUN+3
  RC3:W,UTM,LCOD-CPUN
  W,VIM,RC4
  ,XTA,CARD
  ,UTC,MPUN
  ,ATX,
  ,XTA,
  RC4:W,UTM,LCP3-FCOD
 RR,UJ,
C......
 READ:,BSS,.
C
C......   ЧTEHИE OЧEPEДHOЙ KAPTЫ ИЗ ФAЙЛA BBOДA
C
 W,VTM,1-14.
 WC,VTM,0.
 RE 1:LC,VLM,RE 2.
 LC,VTM,1-1024.
  ,ITA,13
  ,XTS,INFR
 ,ARX,=1.
  ,AAX,=7777 7777 7777 0777
 ,ATX,INF R.
  ,CALL,MT*OБMEH
  14,VTM,4
  ERMTRED:,SUBP,
  ,UZA,ERMTRED
  ,STI,
  ,ATI,13
 MT,VIM,RE 2.
 MT,VTM,1.
 RE 2:LC,UTC,LIST+1023.
 ,XTA,.
 W,ATX,CARD+13.
 ,AAX,=377.
 ,AEX,=12.
 R,UZA,.
 WC,UTM,-1.
 W,VLM,RE 1.
 AC,VTM,ERT1
 ,*71,OUT
 ,SJ,.
C......
 GIVE RN:,BSS,.
C
C......   ПEPEBOД N1,N2 ИЗ TEKCTA B BOCЬMEPИЧHЫЙ
C  И ФOPMИPOBAHИE ПPИЗHAKA WC = 0 - ECTЬ ':'
C  П/П ПOPTИT PEГИCTPЫ:
C  AC - OTKYДA ЧИTATЬ TEKCT HOMEPOB
C  PR - KYДA ПИCATЬ TEKCT HOMEPOB ПOCЛE ':'
C  -W - ДЛИHA TEKCTA B CЛOBAX
C  R  - PAБOЧИЙ PEГИCTP
C
 R,VTM,-1.
 ,XTA,.
 ,ATX,N1.
 ,ATX,N2.
 ,ATX,N11
 ,ATX,N21
 GN 1:AC,XTA,.
 ,U1A,GN 2.
 AC,MTJ,WC.HET ':'
 AC,VLM,GN 1.
 GN 2:,ASN,64-8.
 AC,ATX,.
 ,YTA,.
 ,ATI,S.
 S,UTM,-S/L.
 S,VZM,END GN.
 S,UTM,S/L-S/TWOP
 S,VZM,END GN
 S,UTM,S/TWOP-S/C
 S,VZM,END N.
 S,UTM,S/C-S/D0.
 ,ITA,S.
C  A ПOKA BOCЬMEPИЧHOE ЧИCЛO:
 ,ASN,64+3.
 ,U1A,GN 1.
 R,XTA,N2.
 ,ASN,64-3.
 ,ITS,S.
 15,AOX,.
 R,ATX,N2.
 R,XTA,N21.=MACKИ
 ,ASN,64-3
 ,AOX,=7
 R,AOX,N21
 R,ATX,N21
 ,UJ,GN 1.
 END N:R,VLM,GN 1.
 END GN:,ATI,WC
 ,ITA,NC
 ,X-A,N1.N1.GE.NC
 ,UZA,ER NUMB. - YES
 ,XTA,N21
 ,UZA,N2Z.
 ,AEX,N11
 ,UZA,N2F
 ,AAX,N1
 ,AOX,N2
 ,ATX,N2
 N2F:,XTA,N2
 ,ITS,NC.
 15,X-A,.N2.GE.NC
 ,UZA,ER NUMB. - YES
 ,XTA,N2.
 ,A-X,N1.N1.GT.N2
 ,U1A,ER NUMB. - YES
 ,UJ,GN 3.
 N2Z:,XTA,N1.
 ,ATX,N2.
 GN3:WC,UTM,-S/TWOP
 WC,V1M,GN 3 LF.WC-HET:
 AC,XTA,.ПOДMEHИM
 ,ASN,64+8.':' HA '.'
 ,AOX,=6H.''''''''''
 AC,ATX,.HAЧAЛO TEKCTA
 GN 30:,BSS,
 W,UTM,-1.-ДЛИHA TEKCTA
 WC,VTM,-5
 GN 31:AC,XTA,
 ,U1A,GN 32
 AC,VLM,GN 31
 GN 32:,ASN,64-8
 AC,ATX,
 ,YTA,
 ,ATI,S
 PR,XTS,RF
 ,ASN,64-8
 15,AOX,
 PR,ATX,RF
 S,UTM,-S/L
 S,VZM,ДOKPYT
 S,UTM,S/L-S/TWOP
 S,VZM,ДOKPYT.AЙ-ЯЙ-ЯЙ !
 WC,VLM,GN 31
 PR,VLM,GN 30.B CЛEД.CЛOBO
 ДOKPYT:WC,VZM,GN 3 LF
 ,ASN,64-8.K ЛEB.KPAЮ
 PR,ATX,RF
 WC,VLM,ДOKPYT.WC=0-ECTЬ :
 GN 3 LF:,XTA,N1
 ,ASN,64-24.
 ,AOX,N2.
 ,ASN,64-12
 RR,UJ,.
 ER NUMB:,XTA,.
 RR,UJ,.
C......
 GIVRN C:,BSS,.
C.....   ПPOBEPKA N1 , N2
 ,AAX,MSK N1N2.
 ,UZA,ER N1N2.
 GIV RN:,BSS,.
C......   ИЗBЛEЧEHИE N1,N2 ИЗ PEД-ФPAГMEHTA
 15,ATX,.
 ,ASN,64+12
 ,AAX,C7777
 ,STX,N21.
 ,ASN,64+36
 ,ATX,N11.
 R,UJ,.
C......
 CONNECT:,BSS,.
C
C......   COEДИHEHИE ПO CBЯЗKAM 2-X ЭЛEMEHTOB
C
 15,ATX,
 ,ASN,64+24
 ,AAX,C7777
 ,STX,WS1
 ,AAX,C7777
 ,ATX,WS
 CONN:,BSS,.CBЯЗKA CCЫЛOK
 ,WTC,WS.
 W,XTA,RF
 ,AAX,Z36/25
 ,XTS,WS1.
 ,ASN,64-24.
 15,AOX,.
 ,WTC,WS.
 W,ATX,RF
 ,WTC,WS1.
 W,XTA,RF
 ,AAX,Z12/1
 ,XTS,WS.
 15,AOX,.
 ,WTC,WS1.
 W,ATX,RF
 R,UJ,.
C......
C П/П BCTABKИ PEДAKЦИИ B R- И E-CПИCOK:
 CON RED:,ATX,WS.ЭTOГO CTABИM
 LC,MTJ,LR.CHAЧAЛA B R-CПИCOK
 L CON:LR,XTA,RF
 ,AAX,E FRAG
 ,U1A,CONN1.ДOБPAЛИCЬ
 LR,XTA,RF
 ,AAX,C7777
 ,ATI,LR.BHИЗ ПO R
 ,UJ,L CON
 CONN 1:,ITA,LR.=CTABИM
 ,ATX,WS1.ЗA ЭTИM
 W,VTM,0.B R-CПИCOK
 R,VJM,CONN
 ,ITA,LC.=A ЗA ЭTИM
 ,ATX,WS1.-B E-CПИCOK
 W,VTM,1
 R,VJM,CONN
 ,XTA,
 ,ATX,RF.MOДEЛЬ
 ,ATX,RF+1.ЯЧEЙKИ 0
 RR,UJ,
C...
 DEL RED:,BSS,.
C
C......   ИCKЛЮЧEHИE PEДAKЦИИ ПO PEД. И ПO ПPO-CCЫЛKAM
C
 LC,XTA,RF
 ,AAX,Z24/23.
 LC,ATX,RF
 TAKE RED:,BSS,.BЗЯTЬ ИЗ CПИCKA
 W,VTM,1.ИCKЛЮЧAEM
 LC,XTA,RF+1.PEД-ФPAГMEHT
 R,VJM,CONNECT.ПO PEД-CCЫЛKAM
 W,VTM,0.R-CCЫЛKИ
 ,ITA,LC.ПPOBEPKA
 ,AEX,L MAX.XBOCTA E-CПИC
 ,U1A,DEL PRO
 LC,XTA,RF+1.CMEHA L MAX
 ,ASN,64+24.HA AДPEC
 ,AAX,C7777
 ,ATX,L MAX.CBEPXY
 DEL PRO:,BSS,
 LC,XTA,RF
 ,ASN,64+24
 ,AAX,C7777
 ,ATX,WS1
 LC,XTA,RF+1.ИCKЛЮЧAEM
 ,AAX,C7777.PEД-ФPAГMEHT
 ,ATX,WS.ПO R-CCЫЛKAM
 R,VJM,CONN
 ,XTA,
 ,ATX,RF.MOДEЛЬ
 ,ATX,RF+1.ЯЧEЙKИ 0
 RR,UJ,
C
C......   ПOДПPOГPAMMЫ ДИAГHOCTИKИ
C
 OVER:AC,VTM,ERT4
  13,VJM,MESS
 ,SJ,
 ERFILE:AC,VTM,ERT2
  13,VJM,MESS
 ,ITA,NC.
 ,ASN,64-36
 ,AUX,=6H'''7''7''7''7'''
 ,AOX,=6H 0000''
 ,ATX,CARD. !!OTЛAДKA!!
 ,XTA,=6HKAPTA:
 ,ATX,CARD-1.
 AC,VTM,CARD-1
  13,VJM,MESS
 ,SJ,.
 ER N1N2:LE,XTA,RF
 ,AUX,UPM1.
 ,AOX,CER1.
 ,ATX,BN1N2.
 AC,VTM,ERT3
  13,VJM,MESS
 ,SJ,.
 ER RED:LR,XTA,RF
 ,AUX,UPM1
 ,AOX,CER1
 ,ATX,BN1.
 LE,XTA,RF
 ,AUX,UPM1
 ,AOX,CER2
 ,ATX,BN2.
 AC,VTM,ERT5
  13,VJM,MESS
 ,SJ,.
  MESS:,UTC,MATINFEX
  ,XTA,
  ,AAX,=14000
  ,UZA,MESS/64
  ,*71,OUT
  13,UJ,
  MESS/64:,ITS,AC
  15,ATX,
  MESS1:AC,XTA,
  ,ARX,=6H'177''177''177''177''177''177'
  ,AAX,=6H'200''200''200''200''200''200'
  ,AEX,=6H'200''200''200''200''200''200'
  :,U1A,*+1
  AC,VLM,MESS1
  :,ITA,AC
  ,XTS,=1
  ,UJ,PRINT8
C......   PAЗHЫE KOHCTAHTOЧKИ
 OUT:AC,Z04,
 ,,
 ERT4:,ISO,18HMHOГO PEДAKЦИЙ''
 ERT5:,ISO,30HПOBTOPHAЯ PEДAKЦИЯ B KAPTAX
 BN1:,BSS,1.
 BN2:,BSS,1.
 ERT1:,ISO,24HИCПOPЧEH TEKCTOBЫЙ ФAЙЛ''
 ERT2:,ISO,30HOШИБOЧHO CФOPMИPOBAH ФAЙЛ''
 ERT3:,ISO,23HOШИБOЧHЫЙ HOMEP B KAPTE
 BN1N2:,BSS,1.
 UPM1:,GOST,6H777700
 CER1:,ISO,6H0000
 CER2:,ISO,6H0000 ''
 MSK N1N2:,OCT,7777 0000 7777
 M A1A2:,LOG,7777 0000 7777
 INF WORD:,ENTRY,.
 INF R :,BSS,1.
 INF W:,BSS,1
 IW2:,,N//+100B.
 ,001,.ФAЙЛ BBOДA
 E FRAG:,LOG,1000 0000.
 :,BSS,1.ДЛЯ HOMEPA
 CARD:,BSS,14.
  OLDBUF:,BSS,1
 B24/23:,LOG,600 00000.
 M DEL:,LOG,400 00000
 M INS:,LOG,200 00000.
 Z24/23:,LOG,777 77777 177 77777.
 CRO 1:,ISO,6H*READ .
 CRO 2:,ISO,6HOLD'312''12''12'
 C END:,ISO,6H*-*-*-.
 C END1:,ISO,6H'315''12'   '12'
 CP:,BSS,1.CTPEЛKA БYФ.ЗAП
 C7777:,LOG,7777
 B36/25:,OCT,0000 7777
 Z12/1:,OCT,7777 7777 7777
 Z36/25:,OCT,7777 0000 7777 7777
 MCC  :,GOST,6H'377''377'0000
 FCOD:,ISO,6H.+''''''''.INSERT
 ,ISO,6H.-''''''''.DELETE
 ,ISO,6H..''''''''.END FRAGMENT
 ,ISO,6H.L''''''''
 ,ISO,6H.S''''''''
 CPUN:,BSS,
 ,ISO,6H.P''''''''.PUNCH
 LCOD:,ISO,6H.=''''''''.WRITE
 RET:,BSS,1.
 COD:,BSS,1.
 N1 :,BSS,1.
 N2 :,BSS,1.
 WS :,BSS,1.
 WS1:,BSS,1.
 NCH:,BSS,1.
 N11:,BSS,1.
 N21:,BSS,1.
 AN:,BSS,1.
 L MAX:,BSS,1
 ,END,.
 REDACT2:,NAME,.2-Й ПPOXOД ПO ФAЙЛY. ЛOПATKO B.Б.
 INFWORD:,SUBP,.
 INF WORD:I,BLOCK,INFR0,INFW1,INFW2
 ,CONT,E FRAG,(1),CARD(14)
 ,CONT,(2),M DEL,(2)
 ,CONT,CRO(2),C END(2)
 ,CONT,CP,C7777
 *1:,BLOCK,LC,P,FY,(2),W,BA,MK
  ,CONT,AK,LE,S,CC,R
 *PAGES:PC,BLOCK,(1024),PW(1024)
 PW1:,P/P,(PW)20B.
  BUFFER:PC,BLOCK,RF(4096)
 PFILES:LC,BLOCK,MSTO,NFIL,FILS(8)
 READCO:,SUBP,.
 BEGIN:BA,BASE,*
 ,ITA,R.
 ,XTS,CSP.YCTAHOBKA
 AK,VTM,INFR0.
 AK,ATX,CP-INFR0.CTPEЛKИ ЛИCTA
 AK,XTA,INFW1-INFR0.
 ,UZA,PHH.PEЗ.HE HYЖEH
  ,CALL,OБPYK*MT.HA OБPAБ.YKAЗ.
  ,AOX,CIPM
 ,ATX,INF1
 PHH:LC,VTM,-1024.OБMEH HE HYЖEH
 CC,VTM,CARD.OTKYДA ПИCATЬ
 P,VTM,PFILES
 FY,VTM,0.BHE PEДAKЦИИ
 LE,VZM,/1.HET PEДAKЦИЙ
 LE,XTA,RF+1.HAЧ.YCTAHOBKA
 ,ASN,64+36.N1
 ,ATX,IW
 /1:,BSS,.
 ,XTA,N.
 ,ARX,=1.
 ,ATX,N.
 R,VJM,READCO.
 BA,VTM,BEGIN
 W,V1M,NOTG.HE ПPOCTAЯ
 FY,V1M,/1.ЭTO ИЗ ФPAГ.
C......   ПPOBEPKA ДИAПAЗOHA
 LE,VZM,/2.ПYCT E-CПИCOK
 AHAЛИЗ:,XTA,N
 ,A-X,IW
 ,UZA,IS IN.N.GE.IW
 /2:R,VTM,/1.
 ,UJ,WRITC.
 NOTG:,BSS,.
 W,UTM,-1.
 W,VZM,ЗA KOH
 W,MTJ,FY.YCTAHOBKA FY
 FY,UTM,1-5.W=1..9(0..8)
 ,UJ,/1.IF..THEN W=5
C  ЗAПИCЬ KOHЦA:
 ЗA KOH:,BSS,
  CC,VTM,CRO
  R,VJM,WRITC
 ,XTA,SILINSE.
 ,WTC,CP.
 ,ATX,.
 AK,DRUM,INFW2-INFR0
 IF WRITE:,XTA,INF1
 ,UZA,RET.
 ,XTA,.
 AK,ATX,INFW2-INFR0
 CC,VTM,C END
 R,VJM,WRITC.
 AK,XTA,CP-INFR0
 ,AAX,=1777.
 ,UZA,RET.
 ,XTA,INF1
  ,CALL,MT*OБMEH
  14,VTM,D2
  ,UZA,ERROR
 RET:15,WTC,..BЫXOД
 ,UJ,.
 IS IN:LE,XTA,RF+1
 ,ASN,64+12
 ,UTC,C7777
 ,AAX,.N2
 ,A-X,N
 ,U1A,DOWN E.N.GT.N2
 ,ATI,MK.ДЛЯ DEL
 ,A+X,N
 ,ATX,JW.=N2
C  BЫПOЛHEHИE PEДAKЦИИ:
 LE,XTA,RF
 ,UTC,M DEL
 ,AAX,
 R,VTM,/7.
 ,UZA,WRITC.ЭTO INSERT
C  INSERT ПOCЛE ЗAПИCИ CAMOЙ KAPTЫ
 ,XTA,JW.
 ,ATX,N
 NEXD:,BSS,.OЧEPEДHOЙ DEL.
 MK,VZM,/7.XBATИT
 R,VJM,READCO.
 BA,VTM,BEGIN
 MK,UTM,-1.
 ,UJ,NEX D
 DOWN E:LE,XTA,RF+1
 ,UTC,C7777
 ,AAX,
 ,ATI,LE.K XBOCTY
 LE,VZM,/2.ПYCT E-CПИCOK
 LE,XTA,RF+1.E-CCЫЛKOЙ HИЖE
 ,ASN,64+36.NEW N1
 ,ATX,IW
 ,UJ,AHAЛИЗ
  ERMTRED:,ENTRY,
  BA,VTM,BEGIN
  14,UTM,D1
 ERROR:,BSS,.
  14,MTJ,W
 ,*71,OUT
 ,SJ,.
 /7:LE,XTA,RF
 AK,AAX,E FRAG-INFR0
 ,U1A,/1.HET TEKCTA
 LE,MTJ,S
 /8:S,XTA,RF.ПO R-CCЫЛKE
 ,UTC,C7777
 ,AAX,
 ,ATI,S.BHИЗ
 S,MTJ,CC.HOBOE CC =
 CC,UTM,RF+1
 R,VJM,WRITC.TEKCT ИЗ ФP-TA
 S,XTA,RF
 AK,AAX,E FRAG-INFR0
 ,UZA,/8.EЩE TEKCT
 CC,VTM,CARD.CTAPOE CC
 ,UJ,/1.
 WRITC:,ITA,13.ЗAПИCЬ CTPOKИ
 CC,XTS,.ПPOBEPKA YK
 ,AEX,=6H.''''''''''
 ,AAX,=:776
 ,UZA,EXWRITC.OTCEЯЛ .YK
 CC,MTJ,W
 L1:W,XTA,.
 ,WTC,CP.
 ,ATX,.
 AK,XTA,CP-INFR0
 ,ARX,=1.
 AK,ATX,CP-INFR0
 ,AAX,=1777.
 ,U1A,EL.
C  ЛИCT ПOЛOH,BOCCTAHOBИM CTPEЛKY ЛИCTA:
 ,XTA,CSP.
 AK,ATX,CP-INFR0
 AK,XTA,INFW2-INFR0
 ,UZA,L2.
 ,ATX,W2.
 ,CALL,DRUMTAP*
 AK,ATX,INFW2-INFR0
 ,TAPE,W2.
 L2:,XTA,INF 1
 ,UZA,EL.
 ,ATX,W2.
 ,ASN,64+18.
 ,AEX,W2.
 ,AAX,=777.
 ,UZA,L3.
 ,XTA,INF1.
 ,ARX,=1.
 ,ATX,INF1.
  L3:,BSS,
  ,XTA,W2
  ,CALL,MT*OБMEH
  14,VTM,D2
  ,UZA,ERROR
 EL:W,XTA,.
 ,AAX,=377.
 ,AEX,=12.
 W,UTM,1.
 ,U1A,L1.
  EXWRITC:,STI,
  ,ATI,13
 R,UJ,.
 CSP:,Z00,
 ,Z00,PW.
 CIPM:, ,PW1
 , ,
 SILINSE:,GOST,6H'377'0000'12'
 OUT:W,Z04,
 ,,
 D1:,ISO,24HПЛOXOЙ ФOPMAT YKAЗATEЛЯ''
 D2:,ISO,24HY BAC HET MT-БYФEPA''
 D3:,ISO,24HBЫ ПPEBЫCИЛИ CBOЙ БYФEP''
 INF1:,BSS,1
 W2:,BSS,1
 N:,BSS,1
 IW:,BSS,1
 JW:,BSS,1
 ,END,
 REDACTRM:,NAME,.
C
C.....   HOBЫE ПPИKAЗЫ : '.L' , '.S'
C
C    ЛOПATKO B.Б.  10/04/82
C   COBMECTHAЯ PAБOTA HA PAЗHЫX
C   CTATИCTИKAX ПO ЗAДAЧAM   USESTA
C   ( ПAXPA - 1980  И  ИBT AH - 1982 )
C
C
  *ПEPФOPA:,SUBP,
 *1:,BLOCK,LC,(2),MT,MC,(1),B,(2),LE
 REDACT1:,SUBP,.
 REDACT2:,SUBP,
 PRINTFIL:,SUBP,.
 PFILES:LC,BLOCK,MSTO,NFIL,FILS(8)
 ,CONT,MPUN
 PASS:,LC,1
 LFSYST  :,SUBP,.ЭKOHOMИЯ
 SE*10/US:,SUBP,.ПAMЯTИ
 MT*OБMEH:,SUBP,.
 MT/БИБ  :,SUBP,.
  MT*BATCH:,SUBP,
  MT*PUNCH:,SUBP,
 INF/BA:,LC,1
  MT/FLAG:,LC,1
  PRINT8:,SUBP,
 MANTO*  :,SUBP,.
 NUM*FS  :,LC,1 .
 *LFDIAG*:,LC,3 .
 *PAGES:PC,BLOCK,LI(1024)
 ,CONT,LO(1024)
 NL:,P/P,(LI)16
 INF WORD:,SUBP,.
 INF WORD:I,BLOCK,IR,INF W1
 RM/:,LC,2
 INFLOAD*:LC,BLOCK,ALOAD,(3)
 STATIC*:,LC,1
  NOLISFL*:,LC,1
 MATINFEX:,LC,1.KOПИЯ INFEX
  *655:B,BLOCK,DISNAM,MASTER,FILNAM,REGRW
C         SAVING REGISTERS.
 ,ITS,13
 14,VTM,12
 SI:14,ITS,.13-1 ИP
 14,UTM,-1
 14,V1M,SI
 ,XTS,
C
 C:B,BASE,*.
 ,UTC,MATINFEX
 ,XTA,
  13,VTM,NO STO
  ,UZA,MT/БИБ
 ,AAX,=1777
 ,UTC,PASS
 ,ATX,
 ,ATI,LC.N PASS=N ФИO
 ,ASN,64-1
 ,ATI,12
 ,*65,564B
 ,ATI,MT.A *USESTA
 MT,*65,2.A T/PASS
  12,UTM,-2
 ,AOX,NLO
 ,ATX,SLE
C  ЗAПИCЬ PASS И HOMEP OTДEЛA:
 ,*70,SLE
 ,UTC,LO
 ,XTA,
 ,AEX,STA*CODE
 ,ATX,CONTROL
 ,UZA,ПAXPA
 ,CALL,SE*10/US
 :,UZA,HET CTAT
 ,AOX,NLM0
 ,ATX,SLE
  ,*70,SLE
 :,UTC,LO
 ,XTA,
 ,AEX,STA/CODE
 ,U1A,HET CTAT
 ,UTC,LO
 LC,XTA,
 ,UTC,PASS
 ,ATX,.TEXT,N TEMЫ(12-1)
 ,ITA,LC
 ,*50,72100B+117B.N PASS
 ,UJ,TO FIO
 ПAXPA:,BSS,
 ,UTC,LO
 LC,XTA,
 ,UTC,PASS
 ,ATX,
 ,ASN,64-36.N OTД.
 ,ITS,LC.N PASS
 15,AOX,
 ,*50,72100B+117B
 TO FIO:,BSS,
C  ГДE ЖE HAXOДTCЯ ФИO-:
 ,ITA,12
 ,ASN,64+10
 ,UZA,TP1
 12,UTM,-2000B
 ,XTA,=1
 TP1:,ARX,=1
 ,ARX,SLE
 ,ATX,SLE
 ,XTA,CONTROL
 ,UZA,*70
 ,XTA,SLE
 ,ARX,=2.ФИO=1+2
 ,ATX,SLE
 *70:,BSS,
  MT,VTM,LI
 ,*70,SLE
 ,UTC,LO
 12,XTA,
 ,*50,72100B+566B.ЗAПИCЬ ФИO
 ,UTC,LO
 12,XTA,1
 ,*50,72100B+567B.ЗAПИCЬ ФИO+1
  14,VTM,PASS
  ,ITS,14
  ,ITS,MT
  ,CALL,TEXISO
  MT,XTA,
  ,FUN,72100B+114B.ЗAПИCЬ PASS
 HET CTAT:,BSS,
 ,UTC,INF/BA
 ,XTA,
 ,U1A,RESREG
C
C...  ПPOБA: HAДO ЛИ ЗAKAЗЫBATЬ БYФEP
C
  ,FUN,70100B+DISNAM
  ,UZA,ISBUF.
  ,ASN,64+12.ПOCЛEДHИE
  ,AAX,=3.2 БИTA "ИMEHИ ДП"
  ,UTC,NUM*FS.TPAKTYEM KAK
  ,ATX,.HOMEP ФAЙЛ.CИCTEMЫ
  15,MTJ,MT
  ,FUN,70100B+MASTER
  15,ATX,
  ,FUN,70100B+FILNAM
  15,ATX,
  ,FUN,70100B+REGRW
  MT,MTJ,14
  ,ITS,14.MASTER
  14,UTM,1
  ,ITS,14.FILE
  13,VTM,=37
  ,ITS,13.LUN
  14,UTM,1
  ,ITS,14.REGIM
  ,CALL,LFOPEN
  MT,MTJ,15
  ,ATI,14
  14,VZM,ISBUF.O'KEY
  MT,VTM,*LFDIAG*
  ,UTC,MT/FLAG
  ,XTA,
  ,U1A,TO PRI
  MT,XTA,2
  ,ASN,64+8
  ,ASN,64-8
  MT,ATX,2
  ,*71,OUT
  STOP:,*62,
  TO PRI:,BSS,
  ,ITS,MT
  MT,UTM,2
  ,ITS,MT
  ,XTS,=1
  13,VTM,STOP
  ,UJ,PRINT8
  OUT:MT,Z04,
  ,,
C-------
  ISBUF:,BSS,
  ,UTC,MT/FLAG
  ,XTA,
  ,U1A,TO БИБ
  ,FUN,70100B+120B
  ,ATX,FL/БИБ
  ,UZA,GET NAME
  ,UTC,MATINFEX
  ,XTA,
  ,ASN,64+33
  ,U1A,OWN NAME
  TO БИБ:,BSS,
  13,VTM,IF BATCH
  ,UJ,MT/БИБ
  GET NAME:,BSS,
  14,VTM,NAME
  ,ITA,14
  ,FUN,64B
  OWN NAME:,BSS,
 ,UTC,MATINFEX
 ,XTA,
  ,ASN,64-6
  ,ASN,64+39
 ,AOX,INF R0.
 ,ATX,INF R1.
 13,VTM,IR.
 13,ATX,.
  ,NTR,7
  ,CALL,MT*OБMEH
 MT,VTM,0.HE БЫЛO OБMEHA
 ,CALL,REDACT1.
 B,BASE,C.
 MT,VZM,NO RE.
 13,VTM,IR.
 ,XTA,INF R1.
 13,ATX,.
  ,CALL,MT*OБMEH
 NO RE:,BSS,
C  CAMO PEДAKTИPOBAHИE И ЗAПИCЬ ФAЙЛA HA MБ
 ,CALL,REDACT2
  B,BASE,C
  ,XTA,FL/БИБ
  ,U1A,TO БИБ
 ,UTC,NFIL
 ,XTA,.
 ,UZA,IF PUN
 ,CALL,PRINTFIL.
 IF PUN:B,BASE,C
 ,UTC,MPUN
 ,XTA,
 ,UZA, IF STO
C  BЫЗOB MT*PUNCH
  ,AEX,=6H.P:IBM
  ,U1A,PCDC
  14,VTM,-31
  CHNG:,UTC,KOД*IBM
  14,XTA,31
  ,UTC,*ПEPФOPA
  14,ATX,32
  14,VLM,CHNG
  PCDC:,BSS,
  ,CALL,MT*PUNCH
 IF STO:,UTC,MSTO
 ,XTA,
 ,UZA, IF BATCH
  ,CALL,MT*FINAL
 IF BATCH:,UTC,MATINFEX
 ,XTA,
 ,AAX,=1 4000
  ,UZA,MT*BATCH
  NO STO:,BSS,
  ,XTA,=:002.OTKAЗ OT
  ,*57,4000B.БYФEPA
  RESREG:,BSS,
C         RESETTING REGISTERS
 ,STX,
 14,VTM,-12
 RI:14,STI,13
 14,VLM,RI
 13,UJ,
 INF R0:,010,NL.ЧT И ЛИCT
 ,,
 INF R1:,BSS,1.
 STA*CODE:,TEXT,8HOC ДYБHA
 STA/CODE:,ISO,6HДYБ HA
 NLM0:,010,NL+100B.ЧT
 ,,
 NLO:,014,NL+100B.ЧT,ФИЗ
 ,,
 NAME:,ISO,12HMT/ПYCK''''''''''
  FL/БИБ:,LOG,
C
C---  TAБЛ.KOДOB IBM ДЛЯ ПEPФOPAЦИИ
C
  KOД*IBM:,BSS,
 SPBL:,OCT,1202
 ,OCT,0000 4000 7004 0000.'TЗ' И 'YMH'
 ,OCT,.
 ,OCT,5201 5401 0000 0000.'LE' И 'GE'
    ,OCT,0006 0000 0000 0000.
 ,OCT,1006 0042 5003 0000.
 ,OCT,0022 5011 4402 0102.
 ,OCT,2006 5101 5005 5021.
 ,OCT,0102 0006 4006 0000.
 ,OCT,0022 5041 1042 2102.
 50,OCT,4012 2042 2022 4022.+*)(
 54,OCT,1400 4102 2000 1102./.-,
 60,OCT,0100 0200 0400 1000.3210
 64,OCT,0004 0010 0020 0040.7654
 70,OCT,2012 0202 0001 0002.):98
 74,OCT,1006 1012 0012 4042.  =
 100,OCT,4100 4200 4400 0042.CBA
 104,OCT,4004 4010 4020 4040.GFED
 110,OCT,2200 2400 4001 4002.KJIH
 114,OCT,2010 2020 2040 2100.ONML
 120,OCT,1200 2001 2002 2004.SRQP
 124,OCT,1010 1020 1040 1100.WVUT
 130,OCT,4202 1001 1002 1004.[ZYX
 134,OCT,1022 6000 2202 1202.  ]
 140,OCT,7102 7202 4400 7002.ЦБAЮ
 144,OCT,7006 7012 4020 7042.ГФEД
 150,OCT,2200 5043 5103 1004.KЙИX
 154,OCT,2010 4002 2040 5013.OHMЛ
 160,OCT,4100 2004 6023 6043.CPЯП
 164,OCT,4200 3043 1002 1100.BЖYT
 170,OCT,7103 7203 3007 3013.ШЗЫЬ
 174,OCT,0000 7013 7023 7043. ЧЩЭ
 CONTROL:,BSS,1
 SLE:,BSS,1.
 ,END,.
         :,SUBP ,SAVE*
 'DECLARATION'
         :,ARRAY,KCOUNT*
          ,LC   ,4
         :,ARRAY,MONCARD*
          ,LC   ,25
 'INSTRUCTION'
          14,VTM,COUNT
          12,VTM,KCOUNT*
            ,U1A,RESET
          12,XTA,
          14,ATX,
          12,XTA,1
          14,ATX,1
          14,VTM,-24
         :14,XTA,MONCARD*+24
          14,UTC,CARD+24
            ,ATX,
          14,VLM,*-1
          13,UJ ,
 RESET   :14,XTA,
          12,ATX,
          14,XTA,1
          12,AEX,1
          12,ATX,2
          14,XTA,1
          12,ATX,1
          14,VTM,-24
         :14,UTC,CARD+24
            ,XTA,
          14,ATX,MONCARD*+24
          14,VLM,*-1
          13,UJ ,
 'CONST'
 CARD    :  ,BSS,25
 COUNT   :  ,OCT,
         :  ,OCT,
            ,END,
 SAVELIST:,NAME,.CПACEHИE ЛИCTOB
  ,AAX,=76 000 .ДBИГAЯCЬ
  ,ASN,64-20   .OT TPAKTA 37
  ,ATX, LST    .HAЗAД
  ,XTA,E70.
  ,U1A,C1.
 ,XTA,=02 0037.
  ,ATX,E70.
 C1:,STX,.
  ,ITS,1.
  1,VTM,LISTS.
  ,XTS,.
 C2:1,XTA,.
  ,UZA,C3.
  ,AEX,LST.
  ,AAX,=:0000 37.
  ,UZA,RET.
  1,VLM,C2.
 C3:,XTA,LST.ЗAПИCЬ ЛИCTA
  ,AOX,E70.
 1,ATX,
  1,*70,.
  1,UTM,1.
  ,XTA,.
  1,ATX,.
 ,XTA,E70.
 ,ARX,=37 .-1
 ,AAX,=77 0037.
 ,ATX,E70.
 1,XTA,-1.
 ,AOX,=:001.CЛOBO ЗAПИCИ
 1,ATX,-1.
 RET:,STX,.
 ,STI,1.
 13,UJ,.
 TSILEVAS:,ENTRY,.
 ,ITS,1.
 ,XTS,.
 1,VTM,LISTS.
 C4:1,XTA,.
 ,UZA,C5.
 1,*70,.
 1,VLM,C4.
 C5:,XTA,.
 ,ATX,E70.
 ,ATX,LISTS.
 ,UJ,RET.
 LISTS:,OCT,.
 ,BSS,20.
 E70:,OCT,.
 LST:,BSS,1.
 ,END,
      SDEC        :,NAME,
 GAK/3:,EQU,     *00034B  -        *00000B
 GAK/5:,EQU,     *00037B  -        *00000B
 GAK/7:,EQU,     *00033B  -        *00000B
 GAL/1:,EQU,     *00035B  -        *00000B
 SDEC*:,ENTRY,
     *00000B:           ,ITS ,7
                  7     ,VTM,      *00000B
                  7     ,STX , GAK/3
                        ,NTR ,1
                  7     ,AAX , GAK/5
                  7     ,ATX , GAK/7
                        ,ITA ,11
                        ,ITS ,10
                        ,ITS ,9
                        ,ITS ,8
                  7     ,XTS , GAK/7
                  11    ,VTM, 00000B
                  10    ,VTM, 00000B
                  8     ,VTM, 00000B
                        ,ATI ,9
                        ,ITA ,0
                        ,ITS ,9
                  7     ,A-X , GAL/1
                        ,U1A,      *00015B
                        ,UTC, 00000B
     *00012B:     9     ,VZM,      *00015B
                  9     ,UTM, 77766B
                  10    ,UTM, 00001B
                        ,ITA ,9
                  7     ,A-X , GAL/1
                        ,UZA,      *00012B
     *00015B:     9     ,UTM, 00060B
                        ,ITA ,9
                  8     ,ASN ,64
                  8     ,UTM, 77770B
                  11    ,UTM, 00010B
                  15    ,AOX ,
                  10    ,VZM,      *00024B
                  15    ,ATX ,
                        ,ITA ,10
                  10    ,MTJ ,9
                  10    ,VTM, 00000B
                  7     ,A-X , GAL/1
                        ,U1A,      *00015B
                        ,UJ,       *00012B
     *00024B:     11    ,ASN ,16
                  9     ,VTM,      *00036B
                  9     ,XTS ,
                  11    ,ASN ,64
                  15    ,AOX ,
                  7     ,STX , GAK/7
                        ,STI ,8
                        ,STI ,9
                        ,STI ,10
                        ,ATI ,11
                  7     ,XTA , GAK/7
                  7     ,XTS , GAK/3
                        ,STI ,7
                  13    ,UJ,  00000B
CONST
     *00033B:,OCT,0000  0000  0000  0000
     *00034B:,OCT,0000  0000  0000  0000
     *00035B:,OCT,0000  0000  0000  0012
     *00036B:,OCT,1002  0040  1002  0040
     *00037B:,OCT,0037  7777  7777  7777
                  ,END,
 SE*10/US:,NAME,ЛOПATKO B.Б. 5/4/82 ИBTAH
 ,ITA,7
 7,BASE,*
 ,ATX,R7
 SE*MT:,*63,7
 ,AAX,B30
 ,UZA,RET
 ,XTA,ИMЯ MЛ
 ,*57,150B
 ,ATX,WS
 ,UZA,HET MЛ
 ,ASN,64+45
 ,UZA,ECTЬ
 HET MЛ:,XTA,=77777
 ,*50,211B.ЖДEM MЛ
 ,UJ,SE*MT
 ECTЬ: ,XTA,WS
 ,ASN,64-12
 ,AOX,=:1004.MOД,ФИЗ
 RET:,WTC,R7
 7,VTM,
 13,UJ,
 ИMЯ MЛ:,TEXT,8HUSESTA '20'./10
 B30:,OCT,000 004
 WS:,BSS,1
 R7:,BSS,1
 ,END,
      SERWISM    :,NAME,
      DATAPR*    :,SUBP,
      PRINT8//   :,SUBP,
      A/OCTDEC   :,SUBP,
C
C---   ДЛИHA CTPAHИЦЫ
C
 PL:,EQU,64
                 ,STX,
                 ,UTC,   BSS+ 0015B
                 ,ATX,
            14 ,  VTM,  77764B
 *00002    :14 ,  ITA,  13
            14 ,  UTC,   BSS+ 0014B
                 ,ATX,
            14 ,  VLM,   *00002
                 ,WTC,   BSS+ 0015B
             7 ,  VTM,
                 ,WTC,   *00112
             5 ,  VTM,
             3 ,  VTM,  1
             4 ,  VTM,  10
 *00007    : 1 ,  VTM,   *00007
                 ,XTA,
            13 ,  VJM,  DATAPR*
             6 ,  VJM,   *00072
                 ,XTA,
             1 ,   *75, 2
             1 ,   *75, 1
             7 ,  XTA,
             1 ,  AAX,  116B
             1 ,  AEX,  114B
                 ,UZA,   *00105
             7 ,  XTA,
             1 ,  AAX,  117B
             1 ,  AEX,  110B
                 ,UIA,   *00026
             2 ,  VJM,   *00050
             7 ,  XTA,
             1 ,  AEX,  104B
             7 ,  ATX,
             4 ,  VTM,  8
             3 ,  VTM,  10
             2 ,  VJM,   *00056
             2 ,  VJM,   *00050
                 , UJ,   *00043
                 ,UTC,
 *00026    : 7 ,  XTA,
             1 ,  AAX,  117B
             1 ,  AEX,  111B
                 ,UIA,   *00034
             7 ,  XTA,
             1 ,  AEX,  105B
             7 ,  ATX,
             3 ,  VTM,  24B
             4 ,  VTM,  6
             2 ,  VJM,   *00056
                 , UJ,   *00043
                 ,UTC,
 *00034    : 7 ,  XTA,
             1 ,  AAX,  117B
             1 ,  AEX,  113B
                 ,UIA,   *00042
             7 ,  XTA,
             1 ,  AEX,  107B
             7 ,  ATX,
             2 ,  VJM,   *00050
             2 ,  VJM,   *00056
                 , UJ,   *00043
                 ,UTC,
 *00042    : 2 ,  VJM,   *00056
 *00043    :14 ,  VTM,  77764B
                 ,ITA,  5
             1 ,  ATX,  103B
                 ,UTC,
 *00045    :14 ,  UTC,   BSS+ 0014B
                 ,XTA,
            14 ,  ATI,  13
            14 ,  VLM,   *00045
                 ,STX,
            13 ,   UJ,
 *00050    : 6 ,  VJM,   *00065
 *00051    :14 ,  VTM,   *00111
                 ,ITS,  14
            14 ,  VTM,   *00111
                 ,ITS,  14
            14 ,  VTM,  1
                 ,ITS,  14
            13 ,  VJM,  PRINT8//
             2 ,   UJ,
                 ,UTC,
 *00056    : 6 ,  VJM,   *00065
             7 ,  XTA,  10
             1 ,  AAX,  120B
             7 ,  ATX,  10
             1 ,  XTS,  136B
                 ,WTC,   BSS+ 0015B
             4 ,  UTC,
            14 ,  VTM,
                 ,ITS,  14
                 ,ITS,  3
            13 ,  VJM,  PRINT8//
             2 ,   UJ,
                 ,UTC,
 *00065    : 5 ,  UTM,  1
             5 ,  MTJ,  14
            14 ,  UTM,  -PL-1
            14 ,  VIM,   *00104
                 ,WTC,   *00124
            14 ,  VTM,
                 ,XTA,
             1 ,  ATX,  115B
            14 ,  UTC,
                 ,UTC,
 *00072    : 5 ,  VTM,  1
             1 ,  XTA,  137B
             1 ,  ARX,  106B
             1 ,  ATX,  137B
            13 ,  VJM,  A/OCTDEC
                 ,ASN,  70B
             1 ,  ARX,  112B
             1 ,  ATX,  140B
            14 ,  VTM,   BSS+ 0017B
                 ,ITS,  14
            14 ,  VTM,   BSS+ 0017B
                 ,ITS,  14
            14 ,  VTM,  31B
                 ,ITS,  14
            13 ,  VJM,  PRINT8//
             2 ,  MTJ,  8
             2 ,  VJM,   *00051
             8 ,  MTJ,  2
                 ,UTC,
 *00104    : 6 ,   UJ,
                 ,UTC,
 *00105    : 5 ,  MTJ,  14
            14 ,  UTM,  -PL
            14 ,  VZM,   *00043
             5 ,  UTM,  1
             2 ,  VJM,   *00051
                 , UJ,   *00105
                 ,UTC,
 *00111    :,     LOG,  10020040 10020040.
 *00112    :,     ,
 ,Z00,PL
            ,     LOG,  03400000 00000000.
            ,     LOG,  03600000 00000000.
            ,     LOG,  00000000 00000001.
            ,     LOG,  06400000 00000000.
            ,     LOG,  13400000 00000000.
            ,     LOG,  13600000 00000000.
            ,     LOG,  00006400 00000055.
            ,     LOG,  16400000 00000000.
            ,     LOG,  13427000 00000000.
 *00124    :,     LOG,  64000000 00000001.
            ,     LOG,  77777400 00000000.
            ,     LOG,  77600000 00000000.
            ,     LOG,  77777777 77600000.
 BSS       :     ,BSS,  20B
      ,END,
 SETTRC:,NAME,
 TRFLG*:,LC,1
        ,UTC,=1
 CLRTRC:,ENTRY,
        ,XTS,
        ,UTC,TRFLG*
        ,STX,
      13,UJ,
  SHIMT:,ENTRY,
  ,ATI,14
  14,XTA,
  ,*50,112B
  ,NTR,6
  ,STI,
  13,UJ,
  LONGCTL:,ENTRY,
  ,UTC,=212 0000
  ,XTA,
  ,ATX,54B
  13,UJ,
        ,END,
 STA*R:,NAME,.ДЛЯ CTAPOГO PEДAKTOPA
 MONCARD/:,LC,12.
 LOADCALL:,SUBP,.
 ,XTA,MONCARD/+2.
 ,AEX,=6H
 ,UZA,STANDA.
 ,APX,=6H'7''7''7''7''7'''
 ,XTS,MONCARD/+1.
 ,AEX,=6HDRUM
 ,UZA,PDRUM.
 ,STX,.
 ,ASN,64+33.
 ,ATI,14.
 ,UJ,CALL.
 PDRUM:,STX,.
 14,VTM,5 000B.
 ,AEX,=:2
 ,UZA,CALL.
 SDRUM:14,VTM,3 000B.
 ,UJ,CALL.
 STANDA:14,VTM,31 001B.
 ,XTA,MONCARD/+1.
 ,AEX,=6HDRUM
 ,UZA,SDRUM.
 CALL:,XTS,=32 001
 ,ITS,14
 ,XTS,EDIT*
 ,XTS,
 ,UJ,LOADCALL.
 EDIT*:,TEXT,8HREDACT**
 ,END,STA*R.
 START/ЧK:,NAME,.CAXAPOB
C------ ЗAИMCTBOBAHO ИЗ CП100 TЮPИHA ---------
 *C:13,BASE,*C.
 ,FUN,75B
 1,VTM,-1015.
 ,*70,ИHФAИ.
 AИT1:1,XTA,2047.
 1,CTX,1023.
 1,VLM,AИT1.
 1,VTM,-511.
 ,*70,ИHФAИ3.
 AИT2:1,XTA,511+1024.
 1,CTX,6777B.
 1,VLM,AИT2.
 ,*70,ИHФAИ1.
 ,XTA,ИHФOAИ.
 ,CTX,4.
 ,XTA,KATM.
 ,CTX,5.
 ,XTA,KATM2.
 ,CTX,6
 ,XTA,KATM1.
 ,CTX,7.
 ,MTJ,15
 ,UJ,5
 KATM :,*70,ИHФAИ2.
 KATM1:,XTA,3
 KATM2:,*72,4.
 ИHФOAИ:,OCT,20 57 77.
 ИHФ AИ:,LOG,10 0100 0057 0000.
 ИHФAИ1:,LOG,10 0100 0057 0001.
 ИHФAИ2:,LOG,10 0200 0057 0002.
 ИHФAИ3:,LOG,10 0100 0057 0003.
 ,END,START/ЧK.
 STATICLO:,NAME,.20.10.79
C
C*****  YHИBEPCAЛЬHЫЙ CTATИKO-ДИHAMИЧECKИЙ
C                  ЗAГPYЗЧИK
C
C-----   BHEШHEE YПPABЛEHИE PAБOTOЙ :
C
C...  M/STL - ПPИЗHAK : PAБOTA ДЛЯ БCЗ
C...  A/CAT - AДPEC (ДЛЯ ЭK70) KATAЛOГA
C          ECЛИ = 0 , TO 4014 0000 0021 0301
C...  INF0  - YKAЗATEЛЬ KATAЛOГA HA MЛ
C          AДPECA ИHФOPM.-OTHOCИT.KATAЛOГA
C
C-----   CTPYKTYPA KATAЛOГA БИБЛИOTEKИ :
C        ( HA PAЗДEЛ - 2 CЛOBA )
C
C-----   0-CЛOBO = ИMЯ PAЗДEЛA B KOДE TEXT
C                  ( = 0 - KOHEЦ KATAЛOГA )
C
C-----   1-CЛOBO = XAPAKTEPИCTИKA
C               Y ПAPЫ CЛOB, COOTBETCTB.
C               KOHЦY KATAЛOГA ,
C               XAPAKTEPИCTИKA = 'CBOБOДHO'
C
C...  PP.15/01 - AДPEC ПO ЗAГPYЗKE
C...  PP.30/16 - ДЛИHA ПO ЗAГPYЗKE
C...  PP.45/31 - HOMEP 40-KИ HA BY
C...  P.46 = 1 - PAЗДEЛ MIXLOAD (C ФP.TPП)
C...  P.48 = 1 - PAЗДEЛ HA MЛ
C         PP.45/36 - N ЗOHЫ OT KATAЛOГA
C         PP.35/31 - N 40-KИ ПO ЛИCTY
C...  P.48 = 0 - PAЗДEЛ HA MБ
C         P.47=0 - ФИЗИЧECKИЙ MБ
C             =1 - MATEMATИЧECKИЙ MБ
C         PP.45/41 - HOMEP MБ
C         PP.40/36 - HOMEP TPAKTA
C         PP.35/31 - N 40-KИ ПO ЛИCTY
C
C-----   CTPYKTYPA ЗAПИCИ HA BHEШ.HOCИTEЛE
C
C   ПYCTЬ ИMEETCЯ N HEПOBTOP.CЛOB И
C   CЛEДOM M ПOBTOP.CЛOB ( =0, ЛИБO #0 ) ,
C   TOГДA ЭTA ГPYППA COПPOBOЖДAETCЯ
C   CЛYЖEБHЫM CЛOBOM ПEPEД HEЙ :
C   PP.15/01 - N ,
C   PP.30/16 - M ,
C   P.48=1 - CЛEДOM ЗA CЛYЖ.CЛOBOM
C            PACПOЛ. ЭTAЛOH ПOBTOPEHИЯ
C       =0 - ПOBTOPЯЮTCЯ HYЛИ
C            TOГДA HEПOCPEД. ЗA CЛYЖ.CЛOBOM
C            ИДET ГPYППA B N CЛOB
C
C   B CЛYЧAE MIXLOAD BCЛEД ЗA ПOCЛEДHEЙ
C   ГPYППOЙ HAXOДИTCЯ COOTBETCTBYЮЩИЙ ДAH-
C   HOMY PAЗДEЛY ФPAГMEHT TPП CO CЛEДYЮЩEЙ
C   CTPYKTYPOЙ:
C
C       , TEXT,8HFRAG TPП.ПPИЗHAK ФP-TA TPП
C       , LOG ,N 0AAAA   .AДPEC HAЧAЛA B TPП
C     <  C O Б C T B E H H O  ФPAГMEHT TPП >
C       , LOG ,          .ПP-K KOHЦA ФPAГM.
C
C   B CЛYЧAE, ECЛИ PAЗДEЛ "BЫPOЖДEHHЫЙ"
C   (TOЛЬKO ПACПOPT PAЗДEЛA), ПPИCYTCTBYET
C   TOЛЬKO ПPИЗHAK KOHЦA (HYЛEBOE CЛOBO).
C-----
C.....   CBЯЗЬ C PEЗИДEHTOM MOHИTOPA
 INFLOAD*:LC,BLOCK,ALOAD(3),INFDM
  /VERE/:LC,BLOCK,(2),M/STL,A/CAT,INF0
 SYS P:,EQU,76000B
 NP:,P/P,(SYSP)16
 PGCL:,EQU,2000B
 /PG :,P/P,(PGCL)16
C
C.....   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 *1:,BLOCK,B,AC,W,R,AP
 ,CONT,LP,LL,MT,N,M,L1
 ,CONT,MX
 LP:I,BLOCK,RW,RS,WW,WS,S
C.....
 ,LOC,3401B   .PAБOЧEE MECTO
 BAS:,BSS,
C.....   ПOЛE CПACEHИЯ PEГИCTPOB
 ,BSS,1.И15
 ,BSS,12.И1-И12
 И13:,BSS,1
 PAY:,BSS,1.PEЖИM AY
C====  OБЛACTЬ,OTBOДИMAЯ ПOД MAГAЗИH  ====
C      ЭTA ЧACTЬ ПPOГPAMMЫ PAБOTAET
C        T O Л Ь K O   B  HAЧAЛE.
C.....   YПPЯTЫBAHИE COCTOЯHИЯ
 ,WTC,ALOAD
 14,VTM,
 14,REL,BAS
 ,ITA,15
 14,MTJ,15
 ,ITS,1
 1,VTM,1-13
 SAVE IN:1,ITS,14
 1,VLM,SAVE IN
 14,MTJ,B
 B,REL,BAS
 ,RTE,177B
 ,XTS,INF0
C.....   ПOЛYЧEHИE ИC KATAЛOГA
 ,ATX,INF00
 ,WTC,17B
 AP,VTM,-8
 ,UJ,CH L
C==========  KOHEЦ OБЛACTИ MAГAЗИHA  =====
 CH LIBR:,XTA,M/STL
 ,U1A,RETURN
 ,XTA,INF00
 ,UZA,ABS NAM
 ,XTA,
 ,ATX,INF00
 ,XTA,INF0
 ,AEX,B19
 CH L:,AAX,B19
 ,UZA,CH AC
 ,XTA,INF0
 ,UJ,DEF C
 CH AC:,NTR,3
 ,XTA,A/CAT.KATAЛOГ ЗAДAH
 ,U1A,DEF C. = ДA
 ,XTA,CAT/PH.CTAHД.CИCTEMA
 DEF C:,BSS,
 ,AOX,/NP
 ,ATX,INF
 AC,VTM,SYSP-2
  ,XTA,M/STL
  ,U1A,SE/NAM.OT БCЗ
 ,*70,INF
C.....   YCTAHOBИM ПPИЗHAK TИПA ЗAГPYЗKИ
C        B ИHДEKC-PEГИCTPE MX :
C           MX = 0  - CTATИЧECKAЯ
C           MX = 1  - CTATИKO-ДИHAMИЧECKAЯ
 AC,XTA,3
 ,ASN,64+45
 ,AAX,B1
 ,ATI,MX
C.....   ПOИCK PAЗДEЛA B KATAЛOГE
 SE/NAM:AC,UTM,2
 AC,XTA,
 ,UZA,CH LIBR.KOHEЦ KATAЛOГA
 AP,AEX,
 ,U1A,SE/NAM
 ,ITA,AP
 AC,AEX,1
 ,ASN,64-33
 ,U1A,SE/NAM
C
C*****   ЗAГPYЗKA PAЗДEЛA
C
 AP,MTJ,W
 AP,XTA,3
 ,ATX,P3
 AP,XTA,4
 ,ATX,P4
C.....   HACTPOЙKA HA ЧTEHИE PAЗДEЛA
 AC,XTA,1
 ,ATI,L1.A ПO ЗAГPYЗKE
 ,ASN,64+15
 ,ATI,LL.L ПO ЗAГPYЗKE
 LL,J+M,L1.HOBOE "CBOБOДHO"
 ,ASN,64+15
 ,AAX,C37.HOMEP 40-KИ
 ,ASN,64-5
 ,ATI,AP
 AP,UTM,SYS P.AДPEC ПO ЛИCTY
 ,ATI,LP
 LP,UTM,-1023.ЦИKЛ ПO ЛИCTY
C.....   XBATИT ЛИ MECTA B ПAMЯTИ
 L1,UTM,8+2.ПACПOPT+2 CЛOBA
 ,ITA,L1
 ,X-A,ALOAD
 ,U1A,NO PLACE
C.....   ЗAГOTOBKA ИC ЧTEHИЯ PAЗДEЛA
 AC,XTA,1
 ,AAX,B48
 ,AOX,M/STL
 MT,VTM,0.ПPИЗHAK MБ
 ,UZA,MБ
 AC,XTA,1
 ,ASN,64-3
 ,ASN,64+38
 ,ARX,INF0
 MT,VTM,1.ПPИЗHAK MЛ
 ,UJ,EXCH
 MБ:AC,XTA,1
 ,AAX,M/IW
 ,AEX,B47
 ,AUX,C370037
 EXCH:,BSS,
 ,AOX,/NP
C.....   ЧTEHИE 1-OЙ ЗOHЫ PAЗДEЛA
 ,ATX,INF
 ,NTR,3
 ,*70,INF
 ,XTA,.KOMAHДHAЯ
 ,CTX,. CBEPTKA
C.....   ЗAMEHA KOMAHДЫ 'ATX' HA ЭK75
 ,XTA,72B
 ,U1A,LOAD/.- HE HAДO
 ,XTA,C/CTX
 ,CTX,WRIT1
 ,CTX,WRIT2
C-----   COБCTBEHHO ПEPEПИCЬ PAЗДEЛA
 LOAD/:LL,VZM,END LOAD
 R,VJM,WORD.ЗA CПEЦCЛOBOM
 ,ATI,N.N HEПOBTOP.
 ,ASN,64+15
 ,ATI,M.N ПOBTOP.
 ,ASN,64+32
 ,UZA,LOA 1.ПOBTOP HYЛEЙ
 R,VJM,WORD.KOД ПOBTOPA
C.....   KOPPEKЦИЯ ДЛИHЫ ПO ЗAГPYЗKE
 LOA 1:,ITS,N
 ,ITS,M
 15,ARX,
 ,ITS,LL
 15,A-X,
 ,ATI,LL
C.....   HACTPOЙKA ЦИKЛA HEПOBTOP.KOДOB
 PUT LR:N,VZM,CHE LP
 ,MTJ,L1
 ,ITA,AP
 15,ATX,
 ,ITS,N
 15,ARX,. AP + LR
 ,A-X,B1.BЫЙДEM ЗA
 15,AEX,.ПPOЧИTAHHЫЙ
 ,ASN,64+10.  ЛИCT
 ,U1A,NEXT P. = ДA
C.....   HEПOBTOP.KOДЫ B ПPEДEЛAX ЛИCTA
 '  БЫЛO :  N, UTC ,
 '         LP, UTM ,
 N,J+M,LP.TAK ПPOЩE
 ,ITA,N
 ,X-A,B1. ЦИKЛ HA
 ,ATI,N.  (1-N)
 ,UJ,READ 1
C.....   HEПOBTOP.KOДЫ BЫXOДЯT ЗA ЛИCT
 NEXT P:N,UTC,
 LP,UTC,-1
 L1,VTM,.OCTATOK ЦИKЛA
 LP,MTJ,N
C
C==========================
C=====  ЦИKЛ HEПOBTOP.KOДOB
C
 READ 1:AP,XTA,
 AP,UTM,1
 WRIT 1:W,UTM,1
 W,ATX,-1
 N,VLM,READ 1
C==========================
C
 L1,VZM,CHE LP
 R,VJM,READ P
 L1,MTJ,N
 ,UJ,PUT LR
 CHE LP:R,VTM,PUT 2
 LP,UTM,-1
 LP,VZM,READ P
 LP,UTM,1
C.....   HACTPOЙKA ЦИKЛA ПOBTOP.KOДOB
 PUT 2:M,VZM,TO LOAD
 ,ITA,M
 ,X-A,B1
 ,STI,M
 ,UJ,WRIT 2
 TO LOAD:,STX,
 ,UJ,LOAD/
 ,BSS,
C
C==========================
C=====    ЦИKЛ ПOBTOP.KOДOB
C
 WRIT 2:W,UTM,1
 W,ATX,-1
 M,VLM,WRIT 2
C==========================
 ,UJ,LOAD/
C
C*****   ЧTEHИE CЛOBA C MБ/MЛ
C
 WORD:AP,XTA,
 AP,UTM,1
 R,UTC,
 LP,VLM,
C.....   ЧTEHИE ЗOHЫ/TPAKTA
 READ P:AP,UTM,-1024
 LP,VTM,1-1024
 ,XTS,INF
 ,ARX,B1
 MT,V1M,TAPE
 ,ARX,B12/6
 ,AOX,B12/6
 ,AEX,B12/6
 TAPE:,ATX,INF
 ,*70,INF
 ,STX,
 R,UJ,
C
C*****   ЗAKOHЧИЛИ ЗAГPYЗKY
C
 END LOAD:,BSS,
C         MX, VZM ,ENDLOAD/.HE MIXLOAD
 R,VJM,WORD.
C , UZA ,ENDLOAD/.ПYCT PAЗДEЛ ИЛИ ФAЛЬШИBЫЙ B46
 ,AEX,FRAG TPП.
 ,U1A,ENDLOAD/.TOЧHO ФAЛЬШИBЫЙ B46
 ,DRUM,SAV P1.
 R,VJM,WORD.XAP-KA ФPAГMEHTA
 ,ATI,M.HAЧAЛO ПO ЛИCTY
 ,ASN,64+15.
 ,ATI,N.N ЛИCTA + 1
 M,UTM,-1777B.ДЛЯ VLM
 N,DRUM,LDCR-1.
 COR CL:,BSS,
 R,VJM,WORD
 ,UZA,END COR
 M,ATX,PGCL+1777B
 M,VLM,COR CL
 R,VTM,COR CL
 CL TO DR:,BSS,
  N,XTA,LDCR-1.ЗAMEHA
  ,AEX,B40.ЧTEHИЯ
  15,ATX,1.HA ЗAПИCЬ
  N,UTM,1
  15,DRUM,1
 M,VTM,-1777B
 R,UJ,
 END COR:,BSS,
 R,VJM,CLTODR.CБPOC TPП
 ,DRUM,RES P1
 ENDLOAD/:,BSS,
C.....   CЛYЖ.CЛOBA CЛEДYЮЩEГO PAЗДEЛA
 ,XTA,
 W,ATX,
 ,WTC,17B
 AP,VTM,-8
 ,ITA,AP
 ,ASN,64-30
 W,ATX,7
 ,CTX,1.ЧИCЛ.CBEPTKA
C.....   CЛYЖ.CЛOBA ЗAГPYЖEHHOГO PAЗДEЛA
 ,XTA,P3
 AP,CTX,3
 ,XTA,P4
 AP,CTX,4
 ,XTA,16B
 AP,ATX,1
 AP,ATX,5
 AP,XTA,6
 ,ATX,17B
 AP,XTA,7
 ,ATX,15B
 ,XTA,M/STL.PAБOTA OT БCЗ
  13,VTM,1000B. = ДA
  ,U1A,NEW RET
 R,VJM,PRINT L.ПEЧ.ЗAГPYЗKИ
 ,DRUM,45B.PRINTL MOЖET    ИCПOPTИTЬ SYSP
C.....   BOЗBPAT ИЗ ЗAГPYЗЧИKA
 RETURN:,XTR,PAY
 15,VTM,И13+1
 ,STX,
 14,VTM,13
C.....   BOCCTAHOBЛEHИE PEГИCTPOB
 RESET:14,STI,
 14,UTM,-1
 ,WTC,ALOAD
 14,V1M,RESET-BAS
 ,ATI,15
 13,UJ,
 C/CTX:W,UTM,1
 W,CTX,-1
C
C*****   HEXBATKA MECTA ПOД PAЗДEЛ
C
 NO PLACE:,BSS,
 ,WTC,17B
 AP,VTM,-8
 ,XTA,TPLACE.MECTA :
 ,UJ,DIAGNOST
C
C*****   OTCYTCTBYET ЗAПPOШEHHЫЙ PAЗДEЛ
C
 ABS NAM:,BSS,
 ,XTA,ERT+1.PAЗДEЛA:
 MX,VZM,ABS/ST
 ,DRUM,61B.ДИH.ЗAГPYЗЧИK
 ,XTA,20B
 ,ATX,SAV20
 ,XTA,K CEБE.ПEPEXBAT OШИБOK
 ,CTX,20B.ПPИ ДИH.ЗAГPYЗKE
 AP,XTS,.ИMЯ PAЗДEЛA
 13,VJM,SYSP+2.HA ДИH.ЗAГPYЗЧИK
 13,VTM,.O'KEY
 ,UJ,EXIT*
 K CEБE:13,VTM,51B.ПPИЗHAK OШИБKИ
 ,UJ,EXIT*
 GO 20:,BSS,
 ,ATX,53B
 ,DRUM,INFDM
 ,XTA,53B
 ,UJ,20B
 EXIT*:,XTA,SAV20
 ,CTX,20B
 13,VZM,RETURN
 TO 51:,BSS,
 ,XTA,GO20
 ,CTX,51B
 ,XTA,GO20+1
 ,CTX,52B
 NEW RET:,ITA,13
 ,ATX,И13
 ,UJ,RETURN
 ABS/ST:,BSS,
 DIAGNOST:,BSS,
 ,ATX,T1+1
 ,XTA,ERT.*** HET
 ,ATX,T1
 AP,UTM,8
 ,ITA,AP
 AP,ATX,-1
 R,VJM,PRINT
 13,VTM,51B
 ,UJ,TO 51
C
C*****   ПEЧATЬ O ЗAГPYЗKE PAЗДEЛA
C
 PRINT L:,XTA,44B
 ,AAX,B48
 R,U1A,.= БЛOKИPOBAHA
 AP,UTM,8
 ,ATX,T1+1
 ,BSS,
C
C*****   OБЩAЯ ПOДПPOГPAMMA ПEЧATИ
C
C.....   ФOPMИPOBAHИE TEKCTA B KOДE 'TEXT'
 PRINT:AP,XTA,-8
 ,ATX,T1+2
 ,ITA,AP
 15,ATX,
 ,ASN,64-33
 ,AUX,CUNP
 ,AOX,CADR
 ,STX,T1+3
 AP,AEX,-1
 ,ASN,64-33
 ,UZA,CODE
 ,XTA,TENT.,  ENTRY
 ,ATX,T1+4
 AP,XTA,-1
 ,ASN,64-33
 ,AUX,CUNP
 ,AOX,CADR
 ,ATX,T1+5
C.....   ПEPEKOДИPOBKA 'TEXT' B 'GOST'
 CODE:RW,VTM,T1
 RS,VTM,48
 WW,VTM,1-8
 W NEXT W:WS,VTM,-48
C.....   ЧTEHИE CИMBOЛA 'TEXT'
 RTEXT:RW,XTA,
 RS,ASN,64-48.ЭKOHOMИЯ
 ,ASN,64+42.C77
 RS,UTM,-6
 RS,V1M,COD1
 RS,VTM,48
 RW,UTM,1
C.....   ПEPEKOДИPOBKA CИMBOЛA
 COD1:15,ATX,
 ,ASN,64+2
 ,ATI,14
 ,ASN,64-2.ЭKOHOMИЯ
 15,X-A,.C3
 ,ASN,64-3
 ,ATI,S
 14,XTA,TABLE
 S,ASN,64+16
 ,ASN,64-40.ЭKOHOMИЯ C377
C.....   ЗAПИCЬ CИMBOЛA 'GOST'
 WS,ASN,64+48
 WW,AOX,TG+7
 WW,ATX,TG+7
 WS,UTM,8
 WS,V1M,RTEXT
 WW,VLM,W NEXT W
C.....   COБCTBEHHO ПEЧATЬ
 ,PRINT,INF P
 R,UJ,
 ,BSS,
C=====
 FRAG TPП:,TEXT,8HFRAG TPП
 LDCR:,010,/PG
 ,020,
 ,010,/PG
 ,020,1
 SAV P1:,,/PG
 ,020,26B
 RES P1:,010,/PG
 ,020,26B
 CAT/PH:,OCT,4014 0000 0021 0301
 M/IW:,OCT,2 77777
 C370037:,LOG,16 0000 0037 0037
C=====
 B48:,OCT,4
 B47:,OCT,2
  B40:,OCT,001
 B19:,LOG,100 0000
 B1 :,LOG,1
 B12/6:,LOG,7740
 C37 :,LOG, 37
C=====
 INF P:B,Z00,TG-BAS
 B,Z00,TG-BAS
 :0,001,
 8,,
 /NP:,010,NP
 ,,
 TG:,BSS,8
  ,GOST,1H'231'
 CUNP:,TEXT,8H ИИИИИ
 CADR:,TEXT,8H'35'00000
 ERT :,TEXT,16H*** HET PAЗДEЛA'33'
 TPLACE:,TEXT,8HMECTA '33'
 TENT:,TEXT,8H'1'  ENTRY
 TABLE:,BSS,
C... TAБЛИЦA ПEPEBEPHYTA BBИДY ЭKOHOMИИ C3
 00,GOST,6HЦБ,
 04,GOST,6HИГФД
 10,GOST,6HЙ*)(
 14,GOST,6H/ЖЯЛ
 20,GOST,6H3210
 24,GOST,6H7654
 30,GOST,6H:Ь98
 34,GOST,6HЫ+-П
 40,GOST,6HCBAЗ
 44,GOST,6HGFED
 50,GOST,6HKJIH
 54,GOST,6HONML
 60,GOST,6HSRQP
 64,GOST,6HWVUT
 70,GOST,6HШZYX
 74,GOST,6HЮЧЩЭ
 ,BSS,
 T1:,BSS,6
C.....   B ЦEЛЯX ЭKOHOMИИ PAБ.ПAMЯTИ OЧEHЬ
C     TЩATEЛЬHO BЫБPAHO ПOЛOЖEHИE PAБ.ЯЧEEK
 T1:I,BLOCK,(1),INF00(0),P3
 ,CONT,P4,INF(0),SAV20
C=====
 ,END,
