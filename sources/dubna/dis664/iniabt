*NАМЕ 1:INIABT
*            ПЛАТЫ БМПУ,УПРО,ПРОСЕК
*       БМПУ+МПС+СУСС+БОПП+ПЗУ+РГ/ТГ+СДВИГАТЕЛЬ
*            ПЛАТА УПРО
*       ПОИСК ЛЕВОЙ ЕДИНИЦЫ
*       РНГ, ОЗУ МОДИФИКАТОРОВ (КРОМЕ MNSA=IRA)
*       РНП+АИСП+РФС+РП+ОЗУ БББ+ПС
*       БОИ ТЕГА
*       РЕГИСТР КОП АРБИТРА
*                           ЧАСЫ,ТАЙМЕР СВ - ПОКА НЕТ
*             ПЛАТА БОИ
*       БОИ ДАННЫХ, СТАНДАРТИЗАТОР
*       ОЗУ МОДИФИКАТОРОВ С MNSA=IRA
*       ПРОВЕРКА ИЗМЕНЕНИЯ КОП АРБИТРА ПОСЛЕ ФИЗ.АДРЕСА
*       ФИЗ.АДРЕС, ПРОВЕРКА ИЗМЕНЕНИЯ РФС И БОБР,БИЗМ ПОСЛЕ ФА
*TIME:01.00
*DISC:664/SYSTEM,microb
*FILE:arc,30,W
*file:lib,67,r
*LIBRA:23,25
*NО LIST
*CALL ficMEMORY
*PERSO:67
*CALL MICROB
;
;СПИСОК ВОЗМОЖНЫХ ЗНАЧЕНИЙ ПОЛЕЙ:
;--------------------------------
;
FLIST SQI=JZ,CJS,JМАР,CJP,PUSH,JSRP,CJV,JRP,RFCT,RРСТ,CRTN,CJPP,LDCT,LООР,
      CONT,TWB
FLIST МАР=РЕ,GRP,МЕ
FLIST ALUD=Q,NО,ВА,В,RSBQ,RSB,LSBQ,LSB
FLIST FUNC=ADD,SUBR,SUBS,OR,AND,NOTRS,EXOR,EXNOR
FLIST ALUS=AQ,АВ,ZQ,ZВ,ZА,DА,DQ,DZ
FLIST RА=А,У,INTR,РС,РССОРУ,DADR,HALF,ВУТЕ,EXPN,MANT,WR6,WR5,WR4,WR3,WR2,WR1
FLIST RВ=А,У,INTR,РС,РССОРУ,DADR,HALF,ВУТЕ,EXPN,MANT,WR6,WR5,WR4,WR3,WR2,WR1
FLIST CI=CI0,CI1,CIX,CIC
FLIST SHMUX=LSLSL,NSNSL,ASLLS,NDNS,CDLDL,ADNDL,LDLD,LDLND,RSLRSL,RSSRSS,
      RSRS,IDCS,RDSRDS,RDLRDL,VDCD,RDRD
FLIST SТОРС=NС,NN,NZ,NV,/NС,/NN,/NZ,/NV,МС,MN,MZ,MV,/МС,/MN,/MZ,/MV,
      IС,IN,IZ,IV,/IС,/IN,/IZ,/IV,SETNC,SETNN,SETNZ,SETNV,
      УТОМ,MTON,SЕТМ,SETN,MCN,NСМ,CLRM,CLRN,INVM,CLRNC,CLRNN,CLRNZ,CLRNV
FLIST MNSA=U,IRA,МР
FLIST MODNM=М0,М1,М2,М3,М4,М5,М6,М7,М8,М9,М10,М11,М12,М13,М14,SР,С,RR,
      RRR,SPRADR,СТТ,ACL,ACR,YCL,YCR,РСС,РССС,CTL,CTR,SVFA,PROCNC,MREZ
FLIST DSRC=MODGN,PROCN,CNT,PHYSPG,ARBOPC,MULRZ1,MULRZ2,СОМА,SHIFT,ОРС,
      LOS,PROM
FLIST RTIME=RТ
FLIST WTIME=WТ
FLIST YDST=MODGN,PROCN,CNT,PHYSPG,ARBOPC,MUL1,MUL2,ADRREG,PSHIFT,CCLR,BTRCLR
FLIST SHF=CICL,LOG,ARIPH,EMULF
FLIST ARBI=CCRD,CCWR,DCRD,DCWR,FЕТСН,DRD,DWR,RDMWR,BTRWR,BTRRD,BICLR,BIRD
FLIST CYSTR=NТ3,NТ4,NТ5,NТ6,NТ7,NТ8,NТ9,NТ10
FLIST BRA=RG0,RG1,RG2,RG3
FLIST ARA=RG0,RG1,RG2,RG3
FLIST YDEV=PHYSAD,RADRR,PSMEM,МРМЕМ,SТОРМ0,SТОРМ1
FLIST YDEVT=ECBTAG
FLIST DDEV=ВВ,MODB,CLRCD,STATUS,РРМЕМ0,РРМЕМ1
FLIST YDTIM=CTIME
FLIST FFCNT=LOGGRP,MULGRP,ADDGRP,SЕТС,CLRRCB,SETRCB,CLRJMP,SETJMP,
      SETEI,CLREI,CLRTR0,SETTR0,CLRTR1,SETTR1,CLRCT,CLRCTT,CLRTKK,SЕТТКК,
      STRTLD,СНТКК,SETHLT,CLRINT,CLRRUN,LDCPMP,PRGINT,EXTINT,SETNR,SETER
FLIST MPADR=ADRB1,ADRB2,ADRB3,ADRB4,DАТАВ1,DАТАВ2,DАТАВ3,DАТАВ4,
      DАТАВ5,DАТАВ6,DАТАВ7,DАТАВ8,INFB1,INFB2,FМР,FСР
FLIST COND=YES,NORMB,RNDB,OVRIB,BNB,OVRFTB,DRG,EMLRG,RСВ,СВ,CEMLRG,
      СТ,TR1,INTSTP,RUN,NMLRDY,INT,FULMEM,ARBRDY,СРМР,IR15,ТККВ
;
;СПИСОК ОШИБОЧНЫХ КОМБИНАЦИЙ ПОЛЕЙ
;---------------------------------
;
;ШИНА D:
;-------
;
;ИСТОЧНИКИ: DSRC
;           CSM-WЕМ
;           ЕСА-WRA
;           DDEV-WRD
;
СНЕСК DSRC+CSM-WЕМ
СНЕСК DSRC+ЕСА-WRA
СНЕСК DSRC+DDEV-WRD
СНЕСК CSM-WЕМ+ЕСА-WRA
СНЕСК CSM-WЕМ+DDEV-WRD
СНЕСК ЕСА-WRA+DDEV-WRD
;
;ШИНА У:
;-------
;
;ИСТОЧНИКИ: YDEVT-WRB
;           ALU
;           ЕСВ-WRB
;           YDEV-WRY
;           YDTIM+RTIME
;
СНЕСК YDEVT-WRB+ALU
СНЕСК YDEVT-WRB+ЕСВ-WRB
СНЕСК YDEVT-WRB+YDEV-WRY
СНЕСК YDEVT-WRB+YDTIM+RTIME
СНЕСК ALU+ЕСВ-WRB
СНЕСК ALU+YDEV-WRY
СНЕСК ALU+YDTIM+RTIME
СНЕСК ЕСВ-WRB+YDEV-WRY
СНЕСК ЕСВ-WRB+YDTIM+RTIME
СНЕСК YDEV-WRY+YDTIM+RTIME
;
;
;     ============================================
;     МАКРОСЫ ДЛЯ ОБ'ЕДИНЕНИЯ МЕЛКИХ ТЕСТОВ В ОДИН
;     ============================================
;
;ВАРИАНТ ДЛЯ ОДНОГО БОЛЬШОГО
MACRO J CONT
MACRO S CONT
;ВАРИАНТ ДЛЯ ОТДЕЛЬНЫХ ТЕСТОВ
;MACRO J CJP
;MACRO S CJS
;
;     ==================
;     МАКРОСЫ ДЛЯ КОМАНД
;     ==================
;
MACRO МА CSM,MNSA=IRA,ALUS=DQ,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=ADRREG
MACRO MAWF CSM,MNSA=МР,MODNM=SР,ALUS=DZ,ALUD=В,RВ=DADR,ALU,YDST=ADRREG
MACRO ARF CSM,MNSA=МР,MODNM=SР,ALUS=DZ,FUNC=SUBS,ALUD=В,RВ=DADR,ALU,YDST=ADRREG
MACRO SSPRG ЕСВ,WRB,BRA=RG3
MACRO PHAW YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
MACRO PHAR YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DRD
MACRO RСА DSRC=СОМА,ALUS=DZ,ALUD=Q
MACRO WА МАР=РЕ,COND=ARBRDY,IСС
MACRO SPRG ЕСВ,BRA=RG3,CSM,WЕМ,MNSA=МР,MODNM=SР
MACRO АС CSM,MNSA=МР,MODNM=С,ALUS=DQ,FUNC=ADD,ALUD=Q
MACRO TRSH DSRC=SHIFT,MPS,PSHF=SН0,SHF=LOG
MACRO R МАР=РЕ,COND=RСВ
MACRO М МАР=МЕ,COND=ТККВ,DDEV=CLRCD,WRD,ISE
MACRO MED МАР=МЕ,COND=ТККВ,LЕТС,ISE
MACRO ML МАР=МЕ,DDEV=CLRCD,WRD,ISE
MACRO МЕ МАР=МЕ,LЕТС
MACRO MI МАР=МЕ,COND=ТККВ,DDEV=CLRCD,WRD
MACRO TODR1 ECB,WRB,BRA=RG1,ECA,ARA=RG1
MACRO TODR2 ECB,WRB,BRA=RG2,ECA,ARA=RG2
MACRO TODR3 ECB,WRB,BRA=RG3,ECA,ARA=RG3
MACRO TOYR1 ECA,WRA,ARA=RG1,ECB,BRA=RG1
MACRO TOYR2 ECA,WRA,ARA=RG2,ECB,BRA=RG2
MACRO TOYR3 ECA,WRA,ARA=RG3,ECB,BRA=RG3
;
;     ==================
;     МАКРОСЫ ДЛЯ ТЕСТОВ
;     ==================
;
MACRO TN DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=EXPN,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=0
MACRO Т DSRC=PROM,ALUS=DZ,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=0
MACRO TIK ALUS=ZВ,RВ=MANT,Н,CI,ALUD=В,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=3
MACRO TIK3 ALUS=ZВ,RВ=WR3,Н,CI,ALUD=В,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=3
MACRO CLRTYP ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=INTR,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=1
MACRO ТУРЕ ALUS=ZВ,RВ=INTR,Н,CI,ALUD=В,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=1
MACRO С3 ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR3,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=3
;
;
*FULL LIST
INIABT:PROG;
;
;     РАСПРЕДЕЛЕНИЕ РЕГИСТРОВ БОПП ДЛЯ ТЕСТОВ:
;
;    АДРЕСА РЕГИСТРОВ БОПП:
;    0   1   2   3   4   5   6   7   8   9   А   В   С   D   Е   F
;  I-------------------------------I--------------------------------I
;  I   I   I   I   I          ДОПОЛНИТЕЛЬНАЯ  ИНФОРМАЦИЯ            I
;  I-------------------------------I--------------------------------I
;
;  0 РГ.БОПП: НОМЕР ТЕСТА
;  1 РГ.БОПП: ТИП ПРОВЕРКИ В ТЕСТЕ, ЕСЛИ ИХ НЕСКОЛЬКО; МЛ.БАЙТ РГ.INTR
;  2 РГ.БОПП: ТИП ОБРАЩЕНИЯ К БОПП:
;             00 - ЦИКЛ;
;             FF - ПРИЗНАК ОШИБКИ;
;             ХХ = "ЗАПРОС" = ТИП ПРОВЕРКИ (РГ.INTR).
;  3 РГ.БОПП: НОМЕР ЦИКЛА, МЛ.БАЙТ РГ.MANT
;
EXTERNAL INITST,ERRTST,ERRINF,ERRINH,ERRINQ,OUT8/F,RD8/F,ERR8/F
EXTERNAL RD8/В,OUTC/F,RD4/7,OUTAYH,OUT4/7
;
;     ==================================================================
;     АВТОМАТИЧЕСКИЕ ТЕСТЫ C ИСПОЛЬЗОВАНИЕМ МПС,СУСС,СДВИГАТЕЛЯ,БОПП,ПЗУ
;     ==================================================================
;
;     ========================
;     ПРОВЕРКА КОМАНД  Б М П У
;     ========================
;
БМПУ1:ENTRY
;===== КОМАНДЫ CONT + CJP
;   ТИП ПРОВЕРКИ (МЛ. БАЙТ INTR И 1 РГ.БОПП) = 1 (CONT); = 2 (CJP)
;   ЕСЛИ ОШИБКА, 2 РГ.БОПП = FF
;
CJP А=PSMPU1,МАР=РЕ
PSMPU1:CONT А=Н1,%T%
CJS А=INITST,МАР=РЕ
CMPU1:CONT %CLRTYP%
;ПРОВЕРЯЕМ КОМАНДЫ
;INTR=1 (ТИП ПРОВЕРКИ)
CONT А=ERRTST,МАР=РЕ,%ТУРЕ%
CONT А=ERRTST,МАР=РЕ,IСС
CJP А=MPU1,МАР=РЕ,%ТУРЕ%
CJP А=ERRTST,МАР=РЕ
MPU1:%J% А=CMPU1,МАР=РЕ,%TIK%
;
;
БМПУ2:ENTRY
;===== LDCT + RРСТ; INTR = 0-5
;
CJP А=PSMPU2,МАР=РЕ
PSMPU2:CONT А=Н2,%T%
%S% А=INITST,МАР=РЕ
CMPU2:CONT %CLRTYP%
;ПРОВЕРЯЕМ КОМАНДЫ
;INTR=1
LDCT А=$F0,МАР=РЕ,%ТУРЕ%
RPD2:RРСТ А=RPD2,МАР=РЕ,IСС
;INTR=2
RРСТ А=ERRTST,МАР=РЕ,IСС,%ТУРЕ%
;INTR=3
LDCT А=ERRTST,МАР=РЕ,%ТУРЕ%
LDCT А=$F0,МАР=РЕ,IСС
RPDI2:RРСТ А=RPDI2,МАР=РЕ
;INTR=4
LDCT А=0,МАР=РЕ,%ТУРЕ%
RРСТ А=ERRTST,МАР=РЕ
LDCT А=$F,МАР=РЕ
;INTR=5
RРСТ А=LABL2,МАР=РЕ,%ТУРЕ%
CJP А=ERRTST,МАР=РЕ
LABL2:%J% A=CMPU2,MAP=PE,%TIK%
;
;
БМПУ3:ENTRY
;===== JRP; INTR = 0-4
;
CJP А=PSMPU3,МАР=РЕ
PSMPU3:CONT А=Н3,%T%
%S% А=INITST,МАР=РЕ
CMPU3:CONT %CLRTYP%
;INTR=1
CONT %ТУРЕ%
;УСТАНАВЛИВАЕМ НР
LDCT А=ERRTST,МАР=РЕ,FFCNT=SETNR
JRP А=NЕХ3,МАР=РЕ
;INTR=2
NЕХ3:JRP А=NЕХТ3,МАР=РЕ,COND=EMLRG,IСС,%ТУРЕ%
NЕХТ3:LDCT А=NЕХТС3,МАР=РЕ
;INTR=3
JRP А=ERRTST,МАР=РЕ,COND=EMLRG,%ТУРЕ%
CJP А=ERRTST,МАР=РЕ
;INTR=4
NЕХТС3:LDCT A=ERRTST,MAP=PE
JRP А=LABL3,МАР=РЕ,%ТУРЕ%
JRP А=ERRTST,МАР=РЕ
LABL3:%J% A=CMPU3,MAP=PE,%TIK%
;
;
БМПУ4:ENTRY
;===== CJS + CRTN
;   INTR = 00,01,02,03,04,05,06, ЕСЛИ ЧЕРЕЗ ВСЕ П/П ПРОХОДИМ НОРМАЛЬНО!
;
CJP А=PSMPU4,МАР=РЕ
PSMPU4:CONT А=Н4,%T%
%S% А=INITST,МАР=РЕ
CMPU4:CONT %CLRTYP%
;INTR=1
CJS А=ERRTST,МАР=РЕ,IСС,%ТУРЕ%
;УСТАНАВЛИВАЕМ НР
CONT FFCNT=SETNR
;INTR=2
CJS А=ERRTST,МАР=РЕ,COND=EMLRG,%ТУРЕ%
;1-Я ЗАГРУЗКА АДРЕСА В СТЕК
CJS А=SUBR1,МАР=РЕ
%J% А=CMPU4,МАР=РЕ,%TIK%
;
;
БМПУ5:ENTRY
;===== CJPP; ТИП ПРОВЕРКИ (РГ.INTR) = 0-25 (19 Н)
;
CJP А=PSMPU5,МАР=РЕ
PSMPU5:CONT А=Н5,%T%
%S% А=INITST,МАР=РЕ
CMPU5:CONT %CLRTYP%
LDCT А=20,МАР=РЕ,FFCNT=SETNR
JS:CJS А=SUB1,МАР=РЕ
RРСТ А=JS,МАР=РЕ
;1 ЗАГРУЗКА СТЕКА
CJS А=SUBE1,МАР=РЕ
%J% А=CMPU5,МАР=РЕ,%TIK%
;
;
БМПУ6:ENTRY
;===== PUSH; ТИП ПРОВЕРКИ (РГ.INTR) = 01,02
;
CJP А=PSPU6,МАР=РЕ
PSPU6:CONT А=Н6,%T%
%S% А=INITST,МАР=РЕ
CMPU6:CONT %CLRTYP%
LDCT А=ERRTST,МАР=РЕ,FFCNT=SETNR
;INTR=1
PUSH А=NС2,МАР=РЕ,%ТУРЕ%
CJPP А=NС1,МАР=РЕ
CJP A=ERRTST,MAP=PE
NС1:JRP А=ERRTST,МАР=РЕ,IСС
CJP A=ERRTST,MAP=PE
NС2:LDCT А=LABL6,МАР=РЕ
;INTR=2
PUSH А=ERRTST,МАР=РЕ,COND=EMLRG,%ТУРЕ%
CJPP А=NС3,МАР=РЕ
NС3:JRP А=ERRTST,МАР=РЕ,COND=EMLRG
LABL6:%J% A=CMPU6,MAP=PE,%TIK%
;
;
БМПУ7:ENTRY
;===== PUSH + LООР;  1 РГ.БОПП = РГ.INTR = 0-64
;
CJP А=PSPU7,МАР=РЕ
PSPU7:CONT А=Н7,%T%
%S% А=INITST,МАР=РЕ
CMPU7:CONT %CLRTYP%
PUSH А=ERRTST,МАР=РЕ,FFCNT=SETNR
;INTR=1
LООР COND=EMLRG,IСС,%ТУРЕ%
LООР
PUSH А=100,МАР=РЕ
RРСТ А=LР,МАР=РЕ
CJPP А=LABL7,МАР=РЕ
;INTR=2
LР:LООР COND=EMLRG,%ТУРЕ%
CJP А=ERRTST,МАР=РЕ
LABL7:%J% A=CMPU7,MAP=PE,%TIK%
;
;
БМПУ8:ENTRY
;===== RFCT;  INTR = 0,1,2 (2 - ОЧЕНЬ РЕДКО)
;
CJP А=PSPU8,МАР=РЕ
PSPU8:CONT А=Н8,%T%
%S% А=INITST,МАР=РЕ
CMPU8:CONT %CLRTYP%
CONT FFCNT=SETNR
;INTR=1
PUSH А=100,МАР=РЕ,%ТУРЕ%
RFCT
PUSH А=ERRTST,МАР=РЕ,IСС
;INTR=2
RFCT COND=EMLRG,%ТУРЕ%
%J% А=CMPU8,МАР=РЕ,%TIK%
;
;
БMПУ9:ENTRY
;===== JSRP
;
CJP А=PSPU9,МАР=РЕ
PSPU9:CONT А=H9,%T%
%S% А=INITST,МАР=РЕ
CMPU9:CONT %CLRTYP%
CONT ALUS=DZ,FUNC=AND,ALU,YDST=CNT,FFCNT=SETNR
;INTR=1
LDCT А=SВ1,МАР=РЕ,%ТУРЕ%
JSRP А=ERRTST,МАР=РЕ,IСС
LDCT А=ERRTST,МАР=РЕ
;INTR=2
JSRP А=SВ2,МАР=РЕ,COND=EMLRG,IСС,%ТУРЕ%
CJP А=ERRTST,МАР=РЕ
SВ1:CRTN
SВ2:CJPP А=LABL9,МАР=РЕ
CJS A=ERRTST,MAP=PE
LABL9:%J% A=CMPU9,MAP=PE,%TIK%
;
;
БМПУA:ENTRY
;===== TWB; ТИП ПРОВЕРКИ (РГ.INTR) = 00-06
;
CJP А=PSPUA,МАР=РЕ
PSPUA:CONT А=НA,%T%
%S% А=INITST,МАР=РЕ
CMPUA:CONT %CLRTYP%
CONT ALUS=DZ,FUNC=AND,ALU,YDST=CNT,FFCNT=SETNR
;INTR=1
PUSH А=100,МАР=РЕ,%ТУРЕ%
TWB А=NСОМ,МАР=РЕ,COND=EMLRG
;INTR=2
CJP А=ERRTST,МАР=РЕ
NСОМ:PUSH А=ERRTST,МАР=РЕ,%ТУРЕ%
TWB А=ERRTST,COND=EMLRG,IСС
;1-Я ЗАГРУЗКА СТЕКА
CJS А=SU1,МАР=РЕ
%J% А=CMPUA,МАР=РЕ,%TIK%
;
;     ============================
;     УСЛОВНЫЕ ПЕРЕХОДЫ ПО СТ СУСС
;     ============================
;
CTCCB:ENTRY
;===== ЗАГРУЗКА 0 В N, УСЛОВНЫЙ ПЕРЕХОД  CJP  ПО СТ СУСС; INTR = 0-1
;     ПРИ ОШИБКЕ 8-15 РГ.БОПП = РГ.Y, В КОТОРЫЙ ПРОЧИТАН РГ.N СУСС
;     10P.- Z(0), 9P.- N(0), 8P.- C(0), 7P.- OVR(0)
;
CJP А=PSCTB,МАР=РЕ
PSCTB:CONT А=HB,%T%
%S% А=INITST,МАР=РЕ
;1 - В РГ.N
CCTB:CONT SТОРС=SETN,CEN,%CLRTYP%
;0 - В N
CONT SТОРС=CLRN,CEN
;П/У НА НАЧАЛО, ЕСЛИ /NZ=1 (Т.К. NZ Д.БЫТЬ = 0, КОТОРЫЙ ЗАГРУЗИЛИ!)
CJP А=LABLB,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;ОШИБКА; ЧИТАЕМ N В РГ.У
CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=Y
CJS А=ERRINF,МАР=РЕ,SТОРС=1,DDEV=STATUS,ALUS=DA,RA=Y,FUNC=AND,H,ALUD=В,RВ=У
LABLB:%J% A=CCTB,MAP=PE,%TIK%
;
;
СТССC:ENTRY
;===== ЗАГРУЗКА 0 В N, КОМАНДА JRP
;     ПРИ ОШИБКЕ 8-15 РГ.БОПП = РГ.Y, В КОТОРЫЙ ПРОЧИТАН РГ.N СУСС
;     10P.- Z(0), 9P.- N(0), 8P.- C(0), 7P.- OVR(0)
;
CJP А=PSCTC,МАР=РЕ
PSCTC:CONT А=НC,%T%
%S% А=INITST,МАР=РЕ
;1 - В РГ.N
ССТC:CONT SТОРС=SETN,CEN
;0 - В N
LDCT А=LABC,МАР=РЕ,SТОРС=CLRN,CEN
;П/У НА ERR, ЕСЛИ NZ=1
JRP А=ERCTC,МАР=РЕ,COND=СТ,SТОРС=NZ
;ОШИБКА; ЧИТАЕМ N В РГ.У
ERCTC:CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=Y
CJS А=ERRINF,МАР=РЕ,SТОРС=1,DDEV=STATUS,ALUS=DA,RA=Y,FUNC=AND,H,ALUD=В,RВ=У
LABC:%J% А=ССТC,МАР=РЕ,%TIK%
;
;
СТССD:ENTRY
;===== УСТАНОВКА N ПО РЕЗ-ТУ ИЗ ПРЦР + КОМАНДА CJP
;     ПРИ ОШИБКЕ 8-15 РГ.БОПП = РГ.Y, В КОТОРЫЙ ПРОЧИТАН РГ.N СУСС
;     10P.- Z(0), 9P.- N(1), 8P.- C(0), 7P.- OVR(0)
;
CJP А=PSCTD,МАР=РЕ
PSCTD:CONT А=НD,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А ПРЦР, NZ=1
ССТD:CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,CEN
;F...F - В РГ.А ПРЦР, NZ=0
CONT ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,CEN
;П/У НА НАЧАЛО, ЕСЛИ NZ=0 (/NZ=1), ЕСЛИ НЕ 0-Й РЕЗУЛЬТАТ
CJP А=LABLD,МАР=РЕ,COND=СТ,SТОРС=/NZ
;ОШИБКА; ЧИТАЕМ N В РГ.У
CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=Y
CJS А=ERRINF,МАР=РЕ,SТОРС=1,DDEV=STATUS,ALUS=DA,RA=Y,FUNC=AND,H,ALUD=В,RВ=У
LABLD:%J% А=ССТD,МАР=РЕ,%TIK%
;
;
СТССE:ENTRY
;===== УСТАНОВКА N ПО РЕЗ-ТУ ИЗ ПРЦР + КОМАНДА JRP
;     ПРИ ОШИБКЕ 8-15 РГ.БОПП = РГ.Y, В КОТОРЫЙ ПРОЧИТАН РГ.N СУСС
;     10P.- Z(0), 9P.- N(1), 8P.- C(0), 7P.- OVR(0)
;
CJP А=PSCTE,МАР=РЕ
PSCTE:CONT А=НE,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А ПРЦР, NZ=1
ССТE:CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,CEN
;F...F - В РГ.А ПРЦР, NZ=0
LDCT А=LABLE,МАР=РЕ,ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,CEN
;П/У НА НАЧАЛО, ЕСЛИ NZ=0
JRP А=ERCTE,МАР=РЕ,COND=СТ,SТОРС=NZ
;ОШИБКА; ЧИТАЕМ N В РГ.У
ERCTE:CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=Y
CJS А=ERRINF,МАР=РЕ,SТОРС=1,DDEV=STATUS,ALUS=DA,RA=Y,FUNC=AND,H,ALUD=В,RВ=У
LABLE:%J% А=ССТE,МАР=РЕ,%TIK%
;
;
СТССF:ENTRY
;===== ПРОВЕРКА СИГНАЛОВ СЕМ И CEN
;     ПРИ ОШИБКЕ 8-15 РГ.БОПП = РГ.Y, В КОТОРЫЙ ПРОЧИТАН РГ. N ИЛИ М CУСС
;     10P.- Z(1), 9P.- N(0), 8P.- C(0), 7P.- OVR(0)
;
CJP А=PSCTF,МАР=РЕ
PSCTF:CONT А=НF,%T%
%S% А=INITST,МАР=РЕ
ССТF:CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
;0 - В РГ.А ПРЦР, NZ=MZ=1
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,CEN,СЕМ
;ПЫТАЕМСЯ ЗАГРУЗИТЬ 0 В NZ И MZ БЕЗ CEN И СЕМ
CONT SТОРС=CLRM,%CLRTYP%
;INTR = 0: П/У НА ОШИБКУ, ЕСЛИ NZ=0 (/NZ=1); N - В РГ.У
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND
>,H,ALUD=В,RВ=У
LDCT А=LABLF,МАР=РЕ,%ТУРЕ%
;INTR = 1: П/У НА НАЧАЛО, ЕСЛИ MZ=1; ИЛИ НА ОШИБКУ, ЕСЛИ MZ=0; М - В РГ.У
JRP А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/MZ,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND
>,H,ALUD=В,RВ=У
LABLF:%J% A=CCTF,MAP=PE,%TIK%
;
;
СТСС10:ENTRY
;===== ЗАГРУЗКА 0 В М; INTR=1-4
;     ПРИ ОШИБКЕ 8-15 РГ.БОПП = РГ.Y, В КОТОРЫЙ ПРОЧИТАН РГ. М CУСС
;     10P.- Z(0), 9P.- N(0), 8P.- C(0), 7P.- OVR(0)
;
CJP А=PSCT10,МАР=РЕ
PSCT10:CONT А=Н10,%T%
%S% А=INITST,МАР=РЕ
;1 - В РГ.М
CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
ССТ10:CONT SТОРС=SETM,СЕМ,%CLRTYP%
;0 - В М (MZ=0)
LDCT А=ERRINF,МАР=РЕ,SТОРС=CLRM,СЕМ,%TYPE%
;П/У НА НАЧАЛО, ЕСЛИ M=0; ИЛИ НА ОШИБКУ, ЕСЛИ M=1
JRP А=L141,МАР=РЕ,COND=СТ,SТОРС=/MZ,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
L141:JRP А=L142,МАР=РЕ,COND=СТ,SТОРС=/MN,%TYPE%
L142:JRP А=L143,МАР=РЕ,COND=СТ,SТОРС=/MC,%TYPE%
L143:JRP А=L144,МАР=РЕ,COND=СТ,SТОРС=/MV,%TYPE%
L144:%J% A=CCT10,MAP=PE,%TIK%
;
;
СТСС11:ENTRY
;===== УСТАНОВКА М ПО РЕЗ-ТУ ИЗ ПРЦР
;     ПРИ ОШИБКЕ 8-15 РГ.БОПП = РГ.Y, В КОТОРЫЙ ПРОЧИТАН РГ. М CУСС
;     10P.- Z(0), 9P.- N(0), 8P.- C(0), 7P.- OVR(0)
;
CJP А=PSCT11,МАР=РЕ
PSCT11:CONT А=Н11,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А ПРЦР, MZ=1
CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
ССТ11:CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,СЕМ
;1 - В РГ.А ПРЦР, MZ=0
LDCT А=ERRINF,МАР=РЕ,ALUS=ZА,RА=А,FUNC=ADD,Н,CI,ALUD=В,RВ=А,СЕМ
;П/У НА НАЧАЛО, ЕСЛИ MZ=0; ИЛИ НА ОШИБКУ, ЕСЛИ MZ=1
JRP А=LABL11,МАР=РЕ,COND=СТ,SТОРС=/MZ,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
LABL11:%J% A=CCT11,MAP=PE,%TIK%
;
;
СТСС12:ENTRY
;===== ОБМЕН МЕЖДУ М И N
;     ПРИ ОШИБКЕ 8-15 РГ.БОПП = РГ.Y, В КОТОРЫЙ ПРОЧИТАН РГ. М ИЛИ N CУCС
;     10P.- Z(1,0), 9P.- N(0), 8P.- C(0), 7P.- OVR(0)
;
CJP А=PSCT12,МАР=РЕ
PSCT12:CONT А=Н12,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А ПРЦР, MZ=1
ССТ12:CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,СЕМ
CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
;1 - В РГ.А ПРЦР, NZ=0
CONT ALUS=ZА,RА=А,FUNC=ADD,Н,CI,ALUD=В,RВ=А,CEN
;ОБМЕН М И N, NZ=1, MZ=0
CONT SТОРС=MCN,СЕМ,CEN,%CLRTYP%
;INTR=0; П/У НА ОШИБКУ, ЕСЛИ NZ=0 (/NZ=1)
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
LDCT А=LABL12,МАР=РЕ,%ТУРЕ%
;INTR=1; П/У НА НАЧАЛО, ЕСЛИ MZ=0; ИЛИ НА ОШИБКУ, ЕСЛИ MZ=1
JRP А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=MZ,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
LABL12:%J% A=CCT12,MAP=PE,%TIK%
;
;
СТСС13:ENTRY
;===== ЗАПИСЬ 0,F С ШИНЫ У В РГ.М СУСС, ЧТЕНИЕ РГ.М, СРАВНЕНИЕ В МП
;     ПРИ ОШИБКЕ 8-11 РГ.= РГ.A (ЧТО ПИСАЛИ), 12-15 = РГ.Y (ЧТО ПРОЧИТАЛИ)
;     10 PАЗРЯД - Z, 9P.- N, 8P.- C, 7P.- OVR
;
CJP А=PSCT13,МАР=РЕ
PSCT13:CONT А=Н13,%T%
%S% А=INITST,МАР=РЕ
CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
;0 - В РГ.А ПРЦР, В РГ.N  СУСС
CONT ALUS=ZА,FUNC=AND,Н,ALUD=В,RВ=А
;/А - В А, В РГ.М СУСС ЧЕРЕЗ ШИНУ У, СТАРОЕ М - В N
ССТ13:CONT ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,ALU,DDEV=STATUS,WRD
>,SТОРС=YTOM,СЕМ
;РГ.М СУСС - НА ШИНУ D, В РГ.У, СРАВНИВАЕМ С РГ.А
CONT SТОРС=32,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,Н,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
;П/У НА ОШИБКУ, ЕСЛИ /NZ=1 (NZ=0)
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% A=CCT13,MAP=PE,STOPC=CLRN,CEN,%TIK%
;
;
СТСС14:ENTRY
;===== ПОРАЗРЯДНОЕ ИЗМЕНЕНИЕ РГ.N;  INTR = 0-1
;     ПРИ ОШИБКЕ 8-11 РГ.= РГ.A (ЧТО Д.БЫТЬ), 12-15 = РГ.Y (ЧТО ПРОЧИТАЛИ)
;     10 PАЗРЯД - Z, 9P.- N, 8P.- C, 7P.- OVR
;
CJP А=PSCT14,МАР=РЕ
PSCT14:CONT А=Н14,%T%
%S% А=INITST,МАР=РЕ
ССТ14:CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
;0 - В РГ.А ПРЦР, В РГ.N  СУСС
CONT ALUS=ZА,FUNC=AND,Н,ALUD=В,RВ=А,SТОРС=CLRN,CEN
;УСТАНАВЛИВАЕМ В 1 ОТДЕЛЬНЫЕ РАЗРЯДЫ РГ.N: 1 - В NZ
CONT SТОРС=SETNZ,CEN
;1 - В NС
CONT SТОРС=SETNC,CEN
;1 - В NN
CONT SТОРС=SETNN,CEN
;1 - В NV, F...F - В РГ.А
CONT SТОРС=SETNV,CEN,ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А
;ЧИТАЕМ РГ.N СУСС - В РГ.У МПС, СРАВНИВАЕМ С РГ.А
CONT SТОРС=1,DDEV=STATUS,ALUS=DА,RA=BYTE,FUNC=AND,H,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,Н,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEM
;INTR=0; П/У НА ОШИБКУ, ЕСЛИ N НЕ РАВЕН РГ.А
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/MZ,%CLRTYP%
;УСТАНАВЛИВАЕМ В 0 ОТДЕЛЬНЫЕ РАЗРЯДЫ РГ.N: 0 - В NZ,NС,NN,NV
CONT SТОРС=CLRNZ,CEN
CONT SТОРС=CLRNC,CEN
CONT SТОРС=CLRNN,CEN
;А ТАКЖЕ 0 - В РГ.А
CONT SТОРС=CLRNV,CEN,ALUS=ZА,FUNC=AND,Н,ALUD=В,RВ=А
;СРАВНИВАЕМ А И N
CONT SТОРС=1,DDEV=STATUS,ALUS=DА,RA=BYTE,FUNC=AND,H,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,Н,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEM
;INTR=1; П/У НА ОШИБКУ, ЕСЛИ /MZ=1 (MZ=0)
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/MZ,%ТУРЕ%
%J% A=CCT14,MAP=PE,%TIK%
;
;     ==============================================
;     ПОВЕРКА МИКРОПРОЦЕССОРНЫХ СЕКЦИЙ   +   С У С С
;     ==============================================
;
МПС15:ENTRY
;===== КОМАНДЫ ADD, EOR
;     ПРИ ОШ. 8-11 РГ.БОПП = МЛАДШИЕ 32 РАЗРЯДА РГ.A, 12-15 - РГ.Y
;
CJP А=PSMP15,МАР=РЕ
PSMP15:CONT А=Н15,%T%
%S% А=INITST,МАР=РЕ
;CONST ИЗ ПЗУ - В РГ.А МПС И В РГ.Y
CONT A=B32,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT A=B32,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=Y
;А + 1 -> В РГ.А
CMPS15:CONT ALUS=ZА,RА=А,Н,CI,ALUD=В,RВ=А
;Y + 1 -> В РГ.Y
CONT ALUS=ZА,RА=Y,Н,CI,ALUD=В,RВ=Y
;СРАВНИВАЕМ А И Y, РЕЗ-Т СРАВНЕНИЯ - В РГ.Q
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% A=CMPS15,MAP=PE,%TIK%
;
;
МПС16:ENTRY
;===== КОМАНДЫ ADD И SUBR
;     ПРИ ОШ. 8-11 РГ.= МЛ.32Р.РГ.A (ЧТО Д.БЫТЬ), 12-15 = РГ.Y (ЧТО ПОЛУЧИЛОСЬ)
;
CJP А=PSMP16,МАР=РЕ
PSMP16:CONT А=Н16,%T%
%S% А=INITST,МАР=РЕ
;CONST ИЗ ПЗУ - В РГ.А, ТО ЖЕ - В РГ.Y
CMPS16:CONT A=С55FF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=A,H,ALUD=B,RB=Y
PUSH А=30,МАР=РЕ
;А + 1 - В РГ.А, 31 РАЗ
RFCT ALUS=ZВ,RВ=А,Н,CI,ALUD=В
PUSH А=30,МАР=РЕ
;А - 1 - В РГ.А, 31 РАЗ (СТОЛЬКО ЖЕ РАЗ ВЫЧИТАЕМ)
RFCT ALUS=ZА,RА=А,FUNC=SUBR,Н,ALUD=В,RВ=А
;СРАВНИВАЕМ С РГ.Y
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% A=CMPS16,MAP=PE,%TIK%
;
;
МПС17:ENTRY
;===== УСТАНОВКА РЕГИСТРОВ  М,N  СУСС ПО РЕЗУЛЬТАТУ ИЗ МПС
;   INTR = 0,1 - ПРОВЕРЯЕМ NZ,MZ; 2,3 - NN,MN; 4,5 - NС,МС; 7,8 - NV,MV
;   ПРИ ОШИБКЕ 8-15 РГ.БОПП = РГ.У = РГ.N ИЛИ М.
;
CJP А=PSMP17,МАР=РЕ
PSMP17:CONT А=Н17,%T%
%S% А=INITST,МАР=РЕ
CMPS17:CONT A=MIND,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
;0 - В РГ.А, NZ=MZ=1; INTR=0,1
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,CEN,СЕМ
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
CONT %ТУРЕ%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/MZ,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
;ИНВЕРТИРУЕМ РГ.А, NN=MN=1; INTR=2,3
CONT ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,CEN,СЕМ
CONT %ТУРЕ%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NN,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
CONT %ТУРЕ%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/MN,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
;ДОБАВЛЯЕМ 1 К FFF...FFF, NС=МС=1, INTR=4,5
CONT ALUS=ZВ,RВ=А,Н,CI,ALUD=В,CEN,СЕМ
CONT %ТУРЕ%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NC,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
CONT %ТУРЕ%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/MC,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
;СДВИГАЕМ 0 ВПРАВО С ЗАГРУЗКОЙ "1" = 80...00
CONT ALUS=ZА,RА=А,Н,ALUD=RSB,RВ=А,SHMUX=NSNSL
;К 80...00 ДОБАВЛЯЕМ СТОЛЬКО ЖЕ: NV=MV=1; INTR=7,8
CONT ALUS=АВ,RА=А,RВ=А,FUNC=ADD,Н,ALUD=В,CEN,СЕМ
CONT %ТУРЕ%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NV,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
CONT %ТУРЕ%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/MV,DDEV=STATUS,ALUS=DA,RA=BYTE,FUNC=AND,H
>,ALUD=В,RВ=У
%J% А=CMPS17,МАР=РЕ,%TIK%
;
;
МПС18:ENTRY
;===== ЗАПИСЬ, ЧТЕНИЕ РЕГИСТРОВ МПС: РГ.Q
;     ПРИ ОШИБКЕ: 7-15 РГ.БОПП = Q
;
CJP А=PSMP18,МАР=РЕ
PSMP18:CONT А=Н18,%T%
%S% А=INITST,МАР=РЕ
;ИЗ ПЗУ - В РГ.Q
CMPS18:CONT A=CF530,DSRC=PROM,ALUS=DZ,FUNC=ADD,Н,ALUD=Q
;СНОВА ЧИТАЕМ ИЗ ПЗУ, СРАВНИВАЕМ С РГ.Q
CONT YDEV=МРМЕМ,IОМР,MPADR=4,DSRC=SHIFT,MPS,PSHF=SН0-56,SHF=LOG
CONT A=CF530,DSRC=PROM,ALUS=DQ,FUNC=EXOR,Н,ALUD=B,RB=Y,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% A=CMPS18,MAP=PE,%TIK%
;
;
MПC19:ENTRY
;===== ПЕРЕСЫЛКА РГ.А->WR1-WR5->Y
;     ПРИ ОШИБКЕ: 7-15 РГ.БОПП = Y (ПОСЛЕДНЯЯ ПЕРЕСЫЛКА)
;
CJP А=PSMP19,МАР=РЕ
PSMP19:CONT А=H19,%T%
%S% А=INITST,МАР=РЕ
;CONST ИЗ ПЗУ - В РГ.А
CMPS19:CONT A=С55FF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
;А -> WR1 -> WR2 -> WR3 -> WR4 -> WR5 -> У
CONT ALUS=ZА,RА=А,Н,ALUD=В,RВ=WR1
CONT ALUS=ZА,RА=WR1,Н,ALUD=В,RВ=WR2
CONT ALUS=ZА,RА=WR2,Н,ALUD=В,RВ=WR3
CONT ALUS=ZА,RА=WR3,Н,ALUD=В,RВ=WR4
CONT ALUS=ZА,RА=WR4,Н,ALUD=В,RВ=WR5
CONT ALUS=ZА,RА=WR5,Н,ALUD=В,RВ=У
;СНОВА ЧИТАЕМ ИЗ ПЗУ, СРАВНИВАЕМ С РГ.У
CONT A=С55FF,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% A=CMPS19,MAP=PE,%TIK%
;
;
МПС1A:ENTRY
;===== СРАВНИВАЕМ ОДИН И ТОТ ЖЕ РЕГИСТР ПО ВХОДАМ А И В
;     ПРИ ОШИБКЕ: 7-15 РГ.БОПП = Q (РЕЗУЛЬТАТ СРАВНЕИЯ)
;     INTR: 1 - RG.A; 2 - Y; 3,4,5,6,7 - WR1,2,3,4,5
;
CJP А=PSMP1A,МАР=РЕ
PSMP1A:CONT А=Н1A,%T%
%S% А=INITST,МАР=РЕ
CMPS1A:CONT %CLRTYP%
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=A,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=АВ,RА=У,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=АВ,RА=WR1,RВ=WR1,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=АВ,RА=WR2,RВ=WR2,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=АВ,RА=WR3,RВ=WR3,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=АВ,RА=WR4,RВ=WR4,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=АВ,RА=WR5,RВ=WR5,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% A=CMPS1A,MAP=PE,%TIK%
;
;
MПC1B:ENTRY
;===== ЛОГИЧЕСКИЕ, АРИФМЕТИЧЕСКИЕ КОМАНДЫ: AND
;   AND С "0" (INTR=00); AND С F...F" (01); AND С ДОПОЛНЕНИЕМ (INTR=02)
;   ПРИ ОШ. 8-15 РГ.БОПП = РГ.Q, ГДЕ РЕЗУЛЬТАТ ФУНКЦИИ "AND"
;
CJP А=PSMP1B,МАР=РЕ
PSMP1B:CONT А=H1B,%T%
%S% А=INITST,МАР=РЕ
;0 - В А, FF...FF - В РГ.WR1
CONT A=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT A=CFFF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1
;CONST = "F...F0...0" - В РГ.WR2, ОБРАТНЫЙ КОД - В WR3
CONT A=MH,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR2
CONT A=MNH,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3
;INTR=0; "FF...FF" AND С "0"
CMPS1B:CONT ALUS=АВ,RА=А,RВ=WR1,FUNC=AND,Н,ALUD=Q,ALU,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;INTR=1; CONST (F...F0...0) AND С "F...F" = CONST
CONT ALUS=АВ,RА=WR1,RВ=WR2,FUNC=AND,Н,ALUD=Q,ALU
;СРАВНИВАЕМ С CONST
CONT ALUS=AQ,RА=WR2,FUNC=EXOR,Н,ALUD=B,RB=Y,CEN
CJP А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=2; AND С ДОПОЛНЕНИЕМ
CONT ALUS=АВ,RА=WR2,RВ=WR3,FUNC=AND,Н,ALUD=Q,ALU,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% A=CMPS1B,MAP=PE,%TIK%
;
;
МПС1C:ENTRY
;===== OR С "0" (INTR=00), С ДОПОЛНЕНИЕМ (01), C FFFF (02), C CONST (03)
;     ПРИ ОШ. 8-15 РГ. БОПП = РГ.Q = РЕЗУЛЬТАТ Ф-ИИ "OR"
;
CJP А=PSMP1C,МАР=РЕ
PSMP1C:CONT А=Н1C,%T%
%S% А=INITST,МАР=РЕ
;0 - В WR1, FF...FF - В WR2
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR1
CONT A=CFFF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR2
;CONST = "FFFF00...00" - В WR3, ОБРАТНУЮ CONST - В WR4
CONT A=MNQ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3
CONT A=MQ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR4
;INTR=0; OR С "0" = CONST
CMPS1C:CONT ALUS=АВ,RА=WR1,RВ=WR3,FUNC=OR,Н,ALUD=Q,ALU
CONT ALUS=AQ,RА=WR3,FUNC=EXOR,Н,ALUD=B,RB=Y,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=1; OR С ДОПОЛНЕНИЕМ = FFFF
CONT ALUS=АВ,RА=WR3,RВ=WR4,FUNC=OR,Н,ALUD=Q,ALU
CONT ALUS=AQ,RА=WR2,FUNC=EXOR,Н,ALUD=B,RB=Y,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;INTR=2; OR С FFFF = FFFF
CONT ALUS=АВ,RА=WR3,RВ=WR2,FUNC=OR,Н,ALUD=Q,ALU
CONT ALUS=AQ,RА=WR2,FUNC=EXOR,Н,ALUD=B,RB=Y,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;INTR=3; OR С CONST = CONST
CONT ALUS=АВ,RА=WR3,RВ=WR3,FUNC=OR,Н,ALUD=Q,ALU
CONT ALUS=AQ,RА=WR3,FUNC=EXOR,Н,ALUD=B,RB=Y,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% A=CMPS1C,MAP=PE,%TIK%
;
;
МПС1D:ENTRY
;===== NOTRS, R=S=CONST
;     ПРИ ОШ. 8-15 РГ. БОПП = РГ.Q = РЕЗУЛЬТАТ Ф-ИИ "NOTRS" (Д.Б.= 0)
;
CJP А=PSMP1D,МАР=РЕ
PSMP1D:CONT А=Н1D,%T%
%S% А=INITST,МАР=РЕ
;CONST (ЛЮБУЮ) - В WR1
CONT A=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1
;ИЗМЕНЯЕМ CONST (УВЕЛИЧИВАЕМ НА 0001000100010001)
CMPS1D:CONT A=C0001,DSRC=PROM,ALUS=DA,RA=WR1,FUNC=ADD,Н,ALUD=В,RВ=WR1
;(.NОТ.R).AND.S
CONT ALUS=АВ,RА=WR1,RВ=WR1,FUNC=NOTRS,Н,ALUD=Q,CEN,ALU
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% A=CMPS1D,MAP=PE,%TIK%
;
;
МПС1E:ENTRY
;===== NOTRS, S=0; S=F...F;  INTR = 0-1
;     ПРИ ОШ. 8-15 РГ. БОПП = РГ.Q = РЕЗУЛЬТАТ Ф-ИИ "NOTRS" (Д.Б.= 0 ИЛИ FFFF)
;
CJP А=PSMP1E,МАР=РЕ
PSMP1E:CONT А=Н1E,%T%
%S% А=INITST,МАР=РЕ
;0 - В WR1
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR1
;CONST (F530) - В WR2
CONT A=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR2
;ИЗМЕНЯЕМ CONST (УВЕЛИЧИВАЕМ НА 0001000100010001)
CMPS1E:CONT A=C0001,DSRC=PROM,ALUS=DA,RA=WR2,FUNC=ADD,Н,ALUD=В,RВ=WR2
;INTR=0; NOTRS: AND С 0
CONT ALUS=АВ,RА=WR2,RВ=WR1,FUNC=NOTRS,Н,ALUD=Q,CEN,ALU
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=1; NOTRS: AND С "F...F"
CONT ALUS=АВ,RА=WR1,RВ=WR2,FUNC=NOTRS,Н,ALUD=Q,ALU
CONT ALUS=AQ,RА=WR2,FUNC=EXOR,Н,ALUD=Q,СЕМ
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/MZ,%TYPE%
%J% A=CMPS1E,MAP=PE,%TIK%
;
;
МПС1F:ENTRY
;===== ALUS=DQ
;     ПРИ ОШ. 8-15 РГ. БОПП = РГ.Y = РЕЗУЛЬТАТ Ф-ИИ "EXOR" (Д.Б.= 0)
;
CJP А=PSMP1F,МАР=РЕ
PSMP1F:CONT А=Н1F,%T%
%S% А=INITST,МАР=РЕ
;CONST - В Q
CMPS1F:CONT A=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=Q
;СРАВНИВАЕМ ЕЕ С НЕЙ ЖЕ
CONT A=CF530,DSRC=PROM,ALUS=DQ,FUNC=EXOR,Н,ALUD=В,RВ=У,CEN,ALU
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% A=CMPS1F,MAP=PE,%TIK%
;
;
МПС20:ENTRY
;===== ALUS=ZВ
;   ПРИ ОШ. 8-15 РГ. БОПП = РГ.Y = РЕЗУЛЬТАТ СРАВНЕНИЯ ПОСЛЕ КОМАНДЫ C ALUS=ZB
;
CJP А=PSMP20,МАР=РЕ
PSMP20:CONT А=Н20,%T%
%S% А=INITST,МАР=РЕ
;CONST - В WR1
CONT A=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=B,RB=WR1
;ИЗМЕНЯЕМ CONST (УВЕЛИЧИВАЕМ НА 0001000100010001)
CMPS20:CONT A=C0001,DSRC=PROM,ALUS=DA,RA=WR1,FUNC=ADD,Н,ALUD=В,RВ=WR1,ALU
;ПЕРЕСЫЛАЕМ В Q
CONT ALUS=ZВ,RВ=WR1,Н,ALUD=Q,ALU
;СРАВНИВАЕМ
CONT ALUS=AQ,RA=WR1,FUNC=EXOR,Н,ALUD=В,RВ=Y,CEN,ALU
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% A=CMPS20,MAP=PE,%TIK%
;
;     ===
;      Н
;     ===
;
НМПС21:ENTRY
;===== Н: ПЕРЕСЫЛКА 32 РАЗРЯДОВ; INTR = 0-1
;     ПРИ ОШ. 8-15 РГ. БОПП = РГ.Q = РЕЗУЛЬТАТ ПЕРЕСЫЛКИ 32 РАЗРЯДОВ
;
CJP А=PSH21,МАР=РЕ
PSH21:CONT А=Н21,%T%
%S% А=INITST,МАР=РЕ
;0 - В WR1
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR1
;F...F - В WR2
CONT ALUS=ZА,RА=WR1,FUNC=EXNOR,Н,ALUD=В,RВ=WR2
;0...0F...F - B WR3
CONT A=MH,DSRC=PROM,ALUS=DZ,Н,ALUD=B,RB=WR3
;0 - В Q (64 Р.)
СН21:CONT ALUS=ZА,RА=WR1,Н,ALUD=Q,ALU
;F...F - В Q (32 Р.)
CONT ALUS=ZА,RА=WR2,ALUD=Q,ALU
;INTR=0; СРАВНИВАЕМ Q И WR3
CONT ALUS=AQ,RА=WR3,FUNC=EXOR,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=1; ПЕРЕСЫЛАЕМ 0 (32 Р.)
CONT ALUS=ZА,RА=WR1,ALUD=Q,ALU
CONT ALUS=ZQ,Н,СЕМ,ALU
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/MZ,%ТУРЕ%
%J% A=CH21,MAP=PE,%TIK%
;
;
НМПС22:ENTRY
;===== ЛОГИЧЕСКИЕ ОПЕРАЦИИ С 32 Р.
;     РГ.INTR = 1 РГ.БОПП: OR - 01; EXNOR - 02; AND - 03; EOR - 04.
;     ПРИ ОШ. 8-15 РГ. БОПП = РГ.Q = РЕЗУЛЬТАТ ОПЕРАЦИИ НА 32 РАЗРЯДА
;
CJP А=PSH22,МАР=РЕ
PSH22:CONT А=Н22,%T%
%S% А=INITST,МАР=РЕ
;0 - В WR1, F...F - В WR2
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR1
CONT ALUS=ZА,RА=WR1,FUNC=EXNOR,Н,ALUD=В,RВ=WR2
;0...0F...F - В WR3, F...F0...0 - В WR4
CONT A=MH,DSRC=PROM,ALUS=DZ,Н,ALUD=B,RB=WR3
CONT A=MNH,DSRC=PROM,ALUS=DZ,Н,ALUD=B,RB=WR4
СН22:CONT %CLRTYP%
;0 - В Q (64 Р.)
CONT ALUS=ZА,RА=WR1,Н,ALUD=Q
;INTR=1; OR С F...F (32 Р.); СРАВНИВАЕМ Q И WR3
CONT ALUS=AQ,RА=WR2,FUNC=OR,ALUD=Q
CONT ALUS=AQ,RА=WR3,FUNC=EXOR,Н,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;INTR=2; ИНВЕРТИРУЕМ МЛ. 32Р. РГ.Q
CONT ALUS=ZQ,FUNC=EXNOR,ALUD=Q
CONT ALUS=ZQ,Н,СЕМ
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/MZ,%TYPE%
;F...F - В РГ.Q
CONT ALUS=ZА,RА=WR2,Н,ALUD=Q
;INTR=3; AND С "0" (32 Р.) = F...F0...0, СРАВНИВАЕМ
CONT ALUS=ZQ,FUNC=AND,ALUD=Q
CONT ALUS=AQ,RА=WR4,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;INTR=4; EOR НА 32 РАЗР.
CONT ALUS=AQ,RА=WR4,FUNC=EXOR,СЕМ
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/MZ,%TYPE%
%J% A=CH22,MAP=PE,%TIK%
;
;
НМПС23:ENTRY
;===== ОТСУТСТВИЕ ПЕРЕНОСА В 33 РАЗРЯД ПРИ СЛОЖЕНИИ 32 РАЗРЯДОВ; INTR = 0-2
;  ПРИ ОШ.: 8-15 РГ. БОПП = РГ.Y ИЛИ Q = РЕЗУЛЬТАТ СРАВНЕНИЯ ИЛИ МАСКИ; Д.Б.= 0
;
CJP А=PSH23,МАР=РЕ
PSH23:CONT А=Н23,%T%
%S% А=INITST,МАР=РЕ
;0 - В WR1, 0...0F...F - В WR2, F...F0...0 - В BYTE (МАСКА)
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR1
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR2
CONT ALUS=ZА,RА=WR1,FUNC=EXNOR,ALUD=В,RВ=WR2
CONT ALUS=ZА,RА=WR2,FUNC=EXNOR,Н,ALUD=B,RB=BYTE
СН23:CONT %CLRTYP%
;0...0F...F - В Y
CONT ALUS=ZА,RА=WR2,Н,ALUD=В,RВ=Y
;0...0F...F  + 1  НА 32 РАЗР.
CONT ALUS=ZВ,RВ=Y,CI,ALUD=В,ALU
;INTR=1; ПРОВЕРЯЕМ ОТСУТСТВИЕ ПЕРЕНОСА (ВСЕ 64Р. Д.Б. = 0)
CONT ALUS=ZА,RА=Y,Н,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=2; WR1 + CONST - В WR1 НА 32 Р.; ПРОВЕРЯЕМ СТ.РАЗРЯДЫ WR1 (Д.Б.= 0)
CONT A=MNB23,DSRC=PROM,ALUS=ZA,RA=WR1,ALUD=В,RB=WR1,ALU
CONT ALUS=AB,RА=WR1,RB=BYTE,FUNC=AND,Н,ALUD=Q,СЕМ
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/MZ,%TYPE%
%J% A=CH23,MAP=PE,%TIK%
;
;
НМПС24:ENTRY
;===== ОТСУТСТВИЕ ЗАЕМА В 33Р.ПРИ ВЫЧИТАНИИ 32 РАЗРЯДОВ; INTR = 0-2
;  ПРИ ОШ.: 8-15 РГ. БОПП = РГ.Q = РЕЗУЛЬТАТ СРАВНЕНИЯ ИЛИ МАСКИ; Д.Б.= 0
;
CJP A=PSH24,МАР=РЕ
PSH24:CONT А=Н24,%T%
%S% А=INITST,МАР=РЕ
;0 - В WR1, 0...0F...F - В WR2, F...F0...0 - В BYTE (MАСКА)
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR1
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR2
CONT ALUS=ZА,RА=WR1,FUNC=EXNOR,ALUD=В,RВ=WR2
CONT ALUS=ZА,RА=WR2,FUNC=EXNOR,Н,ALUD=B,RB=BYTE
СН24:CONT %CLRTYP%
;0 - В A, ВЫЧИТАЕМ 1 В 32 РАЗР.
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=A
CONT ALUS=ZB,RВ=A,FUNC=SUBR,ALUD=В,ALU
;INTR=1; ПРОВЕРЯЕМ ОТСУТСТВИЕ ЗАЕМА (СТ.ПОЛОВИНА Д.Б. = 0, МЛ.ПОЛОВИНА = -1)
CONT ALUS=АВ,RА=WR2,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;WR1 - 1 - В WR1 НА 32 Р.
CONT A=B31,DSRC=PROM,ALUS=DA,RA=WR1,FUNC=SUBR,CI,ALUD=В,RB=WR1,ALU
;INTR=2; ПРОВЕРЯЕМ СТ.РАЗРЯДЫ WR1 (Д.Б.=0)
CONT ALUS=AB,RА=WR1,RB=BYTE,FUNC=AND,Н,ALUD=Q,СЕМ
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/MZ,%ТУРЕ%
%J% A=CH24,MAP=PE,%TIK%
;
;
НМПС25:ENTRY
;===== ПРОВЕРКА ПРИЗНАКОВ (IZ) НА 32 И 64 РАЗР.; INTR = 0-2
;  ПРИ ОШ.: 8-15 РГ. БОПП = РЕЗУЛЬТАТУ ПЕРЕСЫЛКИ (Q ИЛИ Y);  Д.Б.= 0
;
CJP А=PSH25,МАР=РЕ
PSH25:CONT А=Н25,%T%
%S% А=INITST,МАР=РЕ
;0 - В Q, 0...0F...F - В Y, F...F0...0 - В WR2
CONT ALUS=DZ,FUNC=AND,Н,ALUD=Q
CONT ALUS=ZQ,FUNC=EXNOR,ALUD=В,RВ=Y
CONT ALUS=ZА,RА=Y,FUNC=EXNOR,Н,ALUD=В,RВ=WR2
СН25:CONT STOPC=CLRM,CEM,CEN,%CLRTYP%
;INTR=1; ПЕРЕСЫЛАЕМ F...F0...0, 64 РАЗРЯДА, Д.Б.NZ=0
CONT ALUS=ZА,RА=WR2,Н,ALUD=Q,ALU,CEN
CJP А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
;INTR=2; ПЕРЕСЫЛАЕМ 32 РАЗРЯДА, Д.Б. MZ=1
CONT ALUS=ZА,RА=WR2,ALUD=B,RB=Y,СЕМ
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/MZ,%ТУРЕ%
%J% A=CH25,MAP=PE,%TIK%
;
;
МПС26:ENTRY
;===== КОМАНДА RРСТ + RLD
;  ПРИ ОШ.: 8-15 РГ. БОПП = РЕЗУЛЬТАТУ ВЫЧИТАНИЯ (РГ.Y);  Д.Б.= 0
;
CJP А=PSMP26,МАР=РЕ
PSMP26:CONT А=Н26,%T%
%S% А=INITST,МАР=РЕ
;RРСТ: CONST (FF) - В РГ/СЧ СУАМ, CONST+1 - В РГ.У
CMPS26:CONT A=MB,DSRC=PROM,ALUS=DZ,Н,ALUD=B,RB=У
CONT ALUS=ZА,RА=У,Н,CI,ALUD=ВА,RВ=У,ALU,RLD
;ЦИКЛ: ВЫЧИТАЕМ ПО 1 ИЗ CONST
RР26:RРСТ А=RР26,МАР=РЕ,ALUS=ZВ,RВ=У,FUNC=SUBR,ALUD=В,CEN
;ЕСЛИ НЕ 0 - ОШИБКА
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMPS26,МАР=РЕ,%TIK%
;
;
МПС27:ENTRY
;===== ПРОВЕРКА ALUD=ВА; ИСПОЛЬЗУЕТСЯ 4 РГ. БОПП
;  ПРИ ОШ.: 11,15 РГ. БОПП Д.Б.= B1 ИЛИ 4 РГ66БОПП, T.E. ЧТО ПИСАЛИ ПО ALUD=BA
;
CJP А=PSMP27,МАР=РЕ
PSMP27:CONT А=Н27,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ B1 В РГ.А ДЛЯ СДВИГА, FF - МАСКА
CMPS27:CONT A=MB,DSRC=PROM,ALUS=DZ,Н,ALUD=B,RB=BYTE
CONT A=B1,DSRC=PROM,ALUS=DZ,Н,ALUD=B,RB=A
;ПИШЕМ В 4РГ. БОПП НЕ СДВИНУТОЕ, СДВИГАЕМ
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=Y,ALU,IOMP,YDEV=MPMEM,WRY,MPADR=4,DSRC=SHIFT
>,MPS,PSHF=SН0-1,SHF=LOG
;ПРОВЕРЯЕМ, ЧТО ЗАПИСАЛОСЬ В БОПП (Д.Б. НЕ СДВИНУТОЕ!)
CONT IOMP,YDEV=MPMEM,MPADR=4,%TRSH%,ALUS=DA,RA=BYTE,FUNC=AND,H,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMPS27,МАР=РЕ,%TIK%
;
;
МПС28:ENTRY
;===== ОТНОШЕНИЕ ЧИСЕЛ
;  ПРИ ОШ.: 8-15 РГ. РАЗНИЦА МЕЖДУ РГ. Y И A, Д.Б.= 1
;
CJP А=PSMP28,МАР=РЕ
PSMP28:CONT А=Н28,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=A
;УВЕЛИЧИВАЕМ РГ.A
CMPS28:CONT ALUS=ZВ,RВ=A,Н,CI,ALUD=В
;A + 1 - В РГ.Y
CONT ALUS=ZА,RА=A,Н,CI,ALUD=В,RВ=Y
;СРАВНИВАЕМ: Y - A
CONT ALUS=АВ,RА=Y,RВ=A,FUNC=SUBS,Н,CI,ALUD=Q,СЕМ
;КТО БОЛЬШЕ? ЕСЛИ Y МЕНЬШЕ ИЛИ РАВЕН A - ОШИБКА
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=48
%J% А=CMPS28,МАР=РЕ,%TIK%
;
;    ========================
;    ДОПОЛНИТЕЛЬНЫЕ ТЕСТЫ МПС
;    ========================
;
CPU29:ENTRY
;===== ЗАПИСЬ HOME-АДРЕСА В РEГИСТРЫ МПС
;   ПИШЕМ CONST=N РЕГИСТРА ИЗ ПЗУ В РЕГИСТРЫ МПС, СРАВНИВАЕМ С CONST ИЗ ПЗУ.
;   N ПРОВЕРЯЕМОГО РЕГИСТРА - В 1 РГ.БОПП, Q - РЕЗ-Т СРАВНЕНИЯ.
;   ПРИ ОШ.: 8-15 РГ.БОПП - СОДЕРЖИМОЕ СРАВНИВАЕМОГО РЕГИСТРА.
;   ТЕСТ НЕ "ТИКАЕТ", Т.К. НЕТ СВОБОДНЫХ РЕГИСТРОВ.
;
CJP А=CCPU29,МАР=РЕ
CCPU29:CONT А=Н29,%Т%
%S% А=INITST,МАР=РЕ
;ПИШЕМ В РГ.МПС HOME-АДРЕС
CC29:CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=0
CONT A=H1,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=1
CONT A=H2,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=2
CONT A=H3,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=3
CONT A=H4,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=4
CONT A=H5,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=5
CONT A=H6,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=6
CONT A=H7,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=7
CONT A=H8,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=8
CONT A=H9,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=9
CONT A=HA,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=10
CONT A=HB,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=11
CONT A=HC,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=12
CONT A=HD,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=13
CONT A=HE,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=14
CONT A=HF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=15
;СРАВНИВАЕМ РГ.МПС С CONST ИЗ ПЗУ, 1-Й РГ.БОПП = N РЕГИСТРА!
;0A: CНАЧАЛА ПРОВЕРЯЕМ WR6=A,ЧТОБ ЕГО М.БЫЛО ИСПОЛЬЗОВАТЬ ДЛЯ ВЫДАЧИ ИНФ.В БОПП
CONT A=HA,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=HA,DSRC=PROM,ALUS=DA,RA=10,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;00
CONT A=ZER,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=ZER,DSRC=PROM,ALUS=DA,RA=0,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;01
CONT A=H1,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=H1,DSRC=PROM,ALUS=DA,RA=1,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;02
CONT A=H2,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=H2,DSRC=PROM,ALUS=DA,RA=2,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;03
CONT A=H3,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=H3,DSRC=PROM,ALUS=DA,RA=3,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;04
CONT A=H4,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=H4,DSRC=PROM,ALUS=DA,RA=4,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;05
CONT A=H5,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=H5,DSRC=PROM,ALUS=DA,RA=5,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;06
CONT A=H6,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=H6,DSRC=PROM,ALUS=DA,RA=6,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;05
CONT A=H7,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=H7,DSRC=PROM,ALUS=DA,RA=7,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;08
CONT A=H8,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=H8,DSRC=PROM,ALUS=DA,RA=8,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;09
CONT A=H9,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=H9,DSRC=PROM,ALUS=DA,RA=9,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;0B
CONT A=HB,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=HB,DSRC=PROM,ALUS=DA,RA=11,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;0C
CONT A=HC,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=HC,DSRC=PROM,ALUS=DA,RA=12,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;0D
CONT A=HD,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=HD,DSRC=PROM,ALUS=DA,RA=13,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;0E
CONT A=HE,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=HE,DSRC=PROM,ALUS=DA,RA=14,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
;0F
CONT A=HF,DSRC=PROM,ALUS=DZ,ALU,YDEV=MPMEM,WRY,IOMP,MPADR=1
CONT A=HF,DSRC=PROM,ALUS=DA,RA=15,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERR8/F,MAP=PE,COND=CT,STOPC=/NZ
%J% А=СC29,МАР=РЕ
;
;
CPU2A:ENTRY
;===== СРАВНЕНИЕ ОДНИХ И ТЕХ ЖЕ РЕГИСТРОВ ПО ВХОДАМ А И В
;   ПРИ ОШ.: 8-15 РГ.БОПП - СОДЕРЖИМОЕ РЕГИСТРА Y, Q - РЕЗ-Т СРАВНЕНИЯ.
;
CJP А=CCPU2A,МАР=РЕ
CCPU2A:CONT А=Н2A,%Т%
%S% А=INITST,МАР=РЕ
;0 - B РЕГИСТРЫ A,Y; F...F - B DADR
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=A,FUNC=EXNOR,H,ALUD=B,RB=DADR
CONT ALUS=ZA,RA=DADR,FUNC=EXNOR,H,ALUD=B,RB=Y
;00: СРАВНИВАЕМ A=Y
CC2A:CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERRINF,MAP=PE,COND=CT,STOPC=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ Y=A
CONT ALUS=AB,RA=Y,RB=A,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERRINF,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;02: СРАВНИВАЕМ НЕРАВНЫЕ Y,DADR
CONT ALUS=AB,RA=Y,RB=DADR,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERRINF,MAP=PE,COND=CT,STOPC=NZ,%TYPE%
;03: СРАВНИВАЕМ НЕРАВНЫЕ DADR,Y
CONT ALUS=AB,RA=DADR,RB=Y,FUNC=EXOR,H,ALUD=Q,CEN
CJS A=ERRINF,MAP=PE,COND=CT,STOPC=NZ,%TYPE%
;УВЕЛИЧИВАЕМ A,Y,DADR.  DADR > A И Y HA 1
CONT ALUS=ZA,RA=A,H,CI,ALUD=B,RB=A
CONT ALUS=ZA,RA=Y,H,CI,ALUD=B,RB=Y
CONT ALUS=ZA,RA=A,H,CI,ALUD=B,RB=DADR
%J% А=СC2A,МАР=РЕ,%TIK%
;
;     ==================================
;     ПРОВЕРКА РГ/ТГ ПРИЗНАКОВ И УСЛОВИЙ
;     ==================================
;
TГ2B:ENTRY
;===== ПРОВЕРКА УСЛОВИЙ РЕГИСТРА РЕЖИМОВ
;   В СЛУЧАЕ ОШИБКИ НЕ СБРАСЫВАЮТСЯ:
;   БНОР(01),БОКР(02),БПП(03),ББЧ(04),БППУ(05),РД(06),РЭ(07),
;   ППК(08),ПИА(09),РЭС(0А),ПОП(0В)
;
CJP А=PSTG2B,МАР=РЕ
PSTG2B:CONT А=H2B,%T%
%S% А=INITST,МАР=РЕ
;0 ИЗ МПС - В РГ/ТГ ПРИЗНАКОВ
CONT ALUS=DZ,FUNC=AND,ALU,YDST=CNT,FFCNT=SETNR
CTG2B:CONT %CLRTYP%
;ПРОВЕРЯЕМ УСЛОВИЯ: INTR=1
CJS А=ERRTST,МАР=РЕ,COND=NORMB,%ТУРЕ%
;2
CJS А=ERRTST,МАР=РЕ,COND=RNDB,%ТУРЕ%
;3
CJS А=ERRTST,МАР=РЕ,COND=OVRIB,%ТУРЕ%
;4
CJS А=ERRTST,МАР=РЕ,COND=BNB,%ТУРЕ%
;5
CJS А=ERRTST,МАР=РЕ,COND=OVRFTB,%ТУРЕ%
;6
CJS А=ERRTST,МАР=РЕ,COND=DRG,%ТУРЕ%
;7
CJS А=ERRTST,МАР=РЕ,COND=EMLRG,%ТУРЕ%
;8
CJS А=ERRTST,МАР=РЕ,COND=RСВ,%ТУРЕ%
;9
CJS А=ERRTST,МАР=РЕ,COND=СВ,%ТУРЕ%
;А
CJS А=ERRTST,МАР=РЕ,COND=CEMLRG,%ТУРЕ%
;В
CJS А=ERRTST,МАР=РЕ,COND=INTSTP,%ТУРЕ%
%J% А=CTG2B,МАР=РЕ,%TIK%
;
;
ТГ2C:ENTRY
;===== ПРОВЕРКА УСЛОВИЙ РЕГИСТРА РЕЖИМОВ
;   НЕ УСТАНАВЛИВАЮТСЯ:
;   БНОР(01),БОКР(02),БПП(03),ББЧ(04),БППУ(05),РД(06),
;   ППК(07),ПИА(08),РЭС(09),ПОП(0А)
;
CJP А=PSTG2C,МАР=РЕ
PSTG2C:CONT А=Н2C,%T%
%S% А=INITST,МАР=РЕ
;FF..FF ИЗ МПС - В РГ,ТГ ПРИЗНАКОВ
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,YDST=CNT
CTG2C:CONT %CLRTYP%
;ПРОВЕРЯЕМ УСЛОВИЯ, INTR=1
CJS А=ERRTST,МАР=РЕ,COND=NORMB,IСС,%ТУРЕ%
;2
CJS А=ERRTST,МАР=РЕ,COND=RNDB,IСС,%ТУРЕ%
;3
CJS А=ERRTST,МАР=РЕ,COND=OVRIB,IСС,%ТУРЕ%
;4
CJS А=ERRTST,МАР=РЕ,COND=BNB,IСС,%ТУРЕ%
;5
CJS А=ERRTST,МАР=РЕ,COND=OVRFTB,IСС,%ТУРЕ%
;6
CJS А=ERRTST,МАР=РЕ,COND=DRG,IСС,%ТУРЕ%
;7
CJS А=ERRTST,МАР=РЕ,COND=RСВ,IСС,%ТУРЕ%
;8
CJS А=ERRTST,МАР=РЕ,COND=СВ,IСС,%ТУРЕ%
;9
CJS А=ERRTST,МАР=РЕ,COND=CEMLRG,IСС,%ТУРЕ%
;А
CJS А=ERRTST,МАР=РЕ,COND=INTSTP,IСС,%ТУРЕ%
%J% А=CTG2C,МАР=РЕ,%TIK%
;
;
TГ2D:ENTRY
;===== УСТАНОВКА ТГ. ПОЛЕМ FFCNT + ПРОВЕРКА НА УСЛОВИЯХ
; ОШ.: ПИА = 0 ПОСЛЕ ЕГО УСТАНОВКИ ИЗ FFCNT (INTR = 01); ППК (02); СЛЕД1 (03);
;      РЭ (04); НР (05)
;
CJP А=PSTG2D,МАР=РЕ
PSTG2D:CONT А=H2D,%T%
%S% А=INITST,МАР=РЕ
;0 ИЗ МПС - В РГ,ТГ ПРИЗНАКОВ
CTG2D:CONT ALUS=DZ,FUNC=AND,ALU,YDST=CNT,FFCNT=SETNR
CONT %CLRTYP%
;1: УСТАНОВКА ПИА
CONT FFCNT=SЕТС
CJS А=ERRTST,МАР=РЕ,COND=СВ,IСС,%ТУРЕ%
;2: ППК
CONT FFCNT=SETRCB
CJS А=ERRTST,МАР=РЕ,COND=RСВ,IСС,%ТУРЕ%
;3: СЛЕД1
CONT FFCNT=SETTR1
CJS А=ERRTST,МАР=РЕ,COND=TR1,IСС,%ТУРЕ%
;4: РЕЖИМ ЭМУЛЯЦИИ
CONT FFCNT=SETER
CJS A=ERRTST,MAP=PE,COND=EMLRG,ICC,%TYPE%
;5: НОВЫЙ РЕЖИМ
CONT FFCNT=SETNR
CJS A=ERRTST,MAP=PE,COND=EMLRG,%TYPE%
%J% А=CTG2D,МАР=РЕ,%TIK%
;
;
ТГ2E:ENTRY
;===== СБРОС ТГ. ПОЛЕМ FFCNT + ПРОВЕРКА НА УСЛОВИЯХ
;   ПИА = 1 ПОСЛЕ ЕГО СБРОСА ПОЛЕМ FFCNT (INTR = 01); ППК (02); СЛЕД1 (03)
;
CJP А=PSTG2E,МАР=РЕ
PSTG2E:CONT А=Н2E,%T%
%S% А=INITST,МАР=РЕ
;FF..FF ИЗ МПС - В РГ/ТГ ПРИЗНАКОВ
CTG2E:CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,YDST=CNT
CONT %CLRTYP%
;1: СБРОС ПИА
CONT DDEV=CLRCD
CJS А=ERRTST,МАР=РЕ,COND=СВ,%ТУРЕ%
;2: ППК
CONT FFCNT=CLRRCB
CJS А=ERRTST,МАР=РЕ,COND=RСВ,%ТУРЕ%
;3: СЛЕД1
CONT FFCNT=CLRTR1
CJS А=ERRTST,МАР=РЕ,COND=TR1,%ТУРЕ%
%J% А=CTG2E,МАР=РЕ,%TIK%
;
;
ТГ2F:ENTRY
;===== "0" - В РГ,ТГ ПРИЗНАКОВ, УСТ/СБРОС ТКК, ISE, ПРОВЕРКА ППК ПО УСЛОВИЮ
;   INTR = 1: УСТАНОВКА ТКК; = 2: СБРОС ТКК
;
CJP А=PSTG2F,МАР=РЕ
PSTG2F:CONT А=Н2F,%T%
%S% А=INITST,МАР=РЕ
;"0" - В РГ/ТГ ПРИЗНАКОВ
CTG2F:CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT
;УСТАНОВКА ТКК
CONT FFCNT=SЕТТКК
;ПРИЗНАК ПМИ, ПО КОТОРОМУ ТКК ПЕРЕПИСЫВАЕТСЯ В ППК
CONT ISE,%CLRTYP%
CJS А=ERRTST,МАР=РЕ,COND=RСВ,IСС,%TYPE%
;СБРАСЫВАЕМ ППК ЧЕРЕЗ ТКК
CONT FFCNT=CLRTKK
CONT ISE
;П/У НА ОШИБКУ, ЕСЛИ ППК УСТАНОВЛЕН
CJS А=ERRTST,МАР=РЕ,COND=RСВ,%TYPE%
%J% A=CTG2F,MAP=PE,%TIK%
;
;
ТГ30:ENTRY
;===== "1" - В РГ,ТГ ПРИЗНАКОВ, СБРОС/УСТАНОВКА ТКК, ISE, ПРОВЕРКА ППК ПО УСЛ.
;   INTR = 1: СБРОС ТКК; = 2: УСТАНОВКА ТКК
;
CJP А=PSTG30,МАР=РЕ
PSTG30:CONT А=Н30,%T%
%S% А=INITST,МАР=РЕ
;"FF" - В РГ,ТГ ПРИЗНАКОВ
CTG30:CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,YDST=CNT
;СБРОС ТКК
CONT FFCNT=CLRTKK
CONT ISE,%CLRTYP%
CJS А=ERRTST,МАР=РЕ,COND=RСВ,%TYPE%
;УСТАНАВЛИВАЕМ ППК ЧЕРЕЗ ТКК
CONT FFCNT=SЕТТКК
CONT ISE
;П/У НА ОШИБКУ, ЕСЛИ ППК СБРОШЕН
CJS А=ERRTST,МАР=РЕ,COND=RСВ,IСС,%TYPE%
%J% A=CTG30,MAP=PE,%TIK%
;
;
ТГ31:ENTRY
;===== "0","F"-В РГ/ТГ ПРИЗНАКОВ,СМЕНА ТКК,ISE,ПРОВЕРКА ППК ПО УСЛОВИЮ; INTR=0-4
;
CJP А=PSTG31,МАР=РЕ
PSTG31:CONT А=Н31,%T%
%S% А=INITST,МАР=РЕ
;"0" - В РГ,ТГ ПРИЗНАКОВ; ТКК=ППК=ЛК=0
CTG31:CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT,FFCNT=CLRTKK
;ИЗМЕНЕНИЕ ППК ЧЕРЕЗ ТКК: ТКК=ПК (1)
CONT FFCNT=СНТКК
;INTR=1; ПРИЗНАК ПМИ, ПО КОТОРОМУ ТКК ПЕРЕПИСЫВАЕТСЯ В ППК
CONT ISE,%CLRTYP%
CJS А=ERRTST,МАР=РЕ,COND=RСВ,IСС,%ТУРЕ%
;ИЗМЕНЯЕМ ППК ЧЕРЕЗ ТКК
CONT FFCNT=СНТКК
CONT ISE
;INTR=2; П/У НА ОШИБКУ, ЕСЛИ ППК УСТАНОВЛЕН
CJS А=ERRTST,МАР=РЕ,COND=RСВ,%ТУРЕ%
;"FF" - В РГ,ТГ ПРИЗНАКОВ, ТКК=ППК=ПК=1
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,YDST=CNT,FFCNT=SЕТТКК
;INTR=3; ИЗМЕНЕНИЕ ППК: ТКК=ЛК=0
CONT FFCNT=СНТКК
CONT ISE
CJS А=ERRTST,МАР=РЕ,COND=RСВ,%ТУРЕ%
;УСТАНАВЛИВАЕМ ППК ЧЕРЕЗ ТКК
CONT FFCNT=СНТКК
CONT ISE
;INTR=4; П/У НА ОШИБКУ, ЕСЛИ ППК СБРОШЕН
CJS А=ERRTST,МАР=РЕ,COND=RСВ,IСС,%ТУРЕ%
%J% A=CTG31,MAP=PE,%TIK%
;
;
ТГ32:ENTRY
;===== ПРОВЕРКА ПРИЗНАКОВ ГРУПП
;   ЧИТАЕМ РГ.ПРИЗНАКОВ, СРАВНИВАЕМ C CONST ИЗ ПЗУ
;   ЗАПИСЬ 0 (РГ.INTR = 01); ЛОГ.ГРУППА ПОСЛЕ ЗАПИСИ 0 (02);
;   ЗАПИСЬ 1 (03); ГРУППА УМНОЖЕНИЯ ПОСЛЕ ЗАПИСИ 1 (04);
;   ЛОГ.ГРУППА (05); УМНОЖЕНИЯ (06); СЛОЖЕНИЯ (07)
;
CJP А=PSTG32,МАР=РЕ
PSTG32:CONT А=Н32,%T%
%S% А=INITST,МАР=РЕ
CONT A=H1C,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
;INTR = 1: "0" - В РГ/ТГ ПРИЗНАКОВ
CTG32:CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT
CONT %CLRTYP%
;ЧИТАЕМ ТГ.ПРИЗНАКОВ, МАСКА НА 5-3 РАЗРЯДЫ, ПРОВЕРЯЕМ НА "0"
CONT DSRC=CNT,ALUS=DA,RA=BYTE,FUNC=AND,H,ALUD=В,RВ=Y,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;2: ЛОГИЧЕСКАЯ ГРУППА
CONT FFCNT=LOGGRP
CONT DSRC=CNT,ALUS=DA,RA=BYTE,FUNC=AND,H,ALUD=В,RВ=Y
CONT А=В3,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;3: "FF" - В РГ/ТГ ПРИЗНАКОВ
CONT A=H1C,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
;ЧИТАЕМ ТГ.ПРИЗНАКОВ, МАСКА НА 5-3 РАЗРЯДЫ, СРАВНИВАЕМ С ТЕМ ЖЕ (1С)
CONT DSRC=CNT,ALUS=DA,RA=BYTE,FUNC=AND,H,ALUD=В,RВ=Y
CONT А=H1C,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;4: ГРУППА УМНОЖЕНИЯ
CONT FFCNT=MULGRP
CONT DSRC=CNT,ALUS=DA,RA=BYTE,FUNC=AND,H,ALUD=В,RВ=Y
CONT А=B4,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;5: ЛОГИЧЕСКАЯ ГРУППА
CONT FFCNT=LOGGRP
CONT DSRC=CNT,ALUS=DA,RA=BYTE,FUNC=AND,H,ALUD=В,RВ=Y
CONT А=B3,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;6: ГРУППА УМНОЖЕНИЯ
CONT FFCNT=MULGRP
CONT DSRC=CNT,ALUS=DA,RA=BYTE,FUNC=AND,H,ALUD=В,RВ=Y
CONT А=B4,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;7: ГРУППА СЛОЖЕНИЯ
CONT FFCNT=ADDGRP
CONT DSRC=CNT,ALUS=DA,RA=BYTE,FUNC=AND,H,ALUD=В,RВ=Y
CONT А=B5,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=CTG32,МАР=РЕ,%TIK%
;
БОПП33:ENTRY
;===== ИЗ РГ.А ПИШЕМ ЧИСЛА ОТ 0 ДО FF В 4-15 РГ.БОПП, ЧИТАЕМ, ПРОВЕРЯЕМ
;   INTR = N РЕГИСТРА: 4-15 ПРИ ПРОВЕРКЕ 4-15 РГ.БОПП СООТВЕТСТВЕННО
;   ПРИ ОШИБКЕ 8-11РГ.БОПП = ЧТО ПИСАЛИ, 12-15 = ЧТО ПРОЧИТАЛИ (1 БАЙТ)
;
CJP А=PSMP33,МАР=РЕ
PSMP33:CONT А=Н33,%T%
%S% А=INITST,МАР=РЕ
CONT А=MB,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
CONT ALUS=DZ,FUNC=AND,H,ALUD=B,RB=A
LABL33:CONT ALUS=ZА,RА=А,CI,ALUD=B,RB=A,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=4
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=5
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=6
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=7
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=8
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=9
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=10
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=11
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=12
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=13
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=14
CONT ALUS=ZА,RА=А,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=15
CONT A=C3,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=INTR
;INTR=4
CONT YDEV=MPMEM,IOMP,MPADR=4,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;5
CONT YDEV=MPMEM,IOMP,MPADR=5,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;6
CONT YDEV=MPMEM,IOMP,MPADR=6,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;7
CONT YDEV=MPMEM,IOMP,MPADR=7,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;8
CONT YDEV=MPMEM,IOMP,MPADR=8,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;9
CONT YDEV=MPMEM,IOMP,MPADR=9,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;10
CONT YDEV=MPMEM,IOMP,MPADR=10,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;11
CONT YDEV=MPMEM,IOMP,MPADR=11,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;12
CONT YDEV=MPMEM,IOMP,MPADR=12,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;13
CONT YDEV=MPMEM,IOMP,MPADR=13,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;14
CONT YDEV=MPMEM,IOMP,MPADR=14,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
;15
CONT YDEV=MPMEM,IOMP,MPADR=15,%TRSH%,ALUS=DZ,H,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,H,ALUD=Q,CEN
CJS A=ERRINH,MAP=PE,COND=CT,STOPC=/NZ,%TYPE%
%J% А=LABL33,МАР=РЕ,%TIK%
;
;     ================
;     П З У   КОНСТАНТ
;     ================
;
ПЗУ34:ENTRY
;===== ЧТЕНИЕ ИЗ ПЗУ В РЕГИСТРЫ МПС, ПРОВЕРКА
;  ПРИ ОШИБКЕ 8-15 РГ.БОПП = РЕЗУЛЬТАТУ СРАВНЕНИЯ CONST ИЗ ПЗУ И СОДЕРЖ.РЕГИСТРА
;  АДРЕС ПЗУ   НОМЕР РЕГИСТРА МПС     ОШИБКА
;        0          WR1                 01
;        1          WR2                 02
;        2          WR3                 03
;        3          WR4                 04
;        4          WR5                 05
;        5          WR6                 06
;        6           А                  07
;        7           У                  08
;
CJP А=PROM34,МАР=РЕ
PROM34:CONT А=Н34,%T%
%S% А=INITST,МАР=РЕ
CONT А=0,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1
CONT А=1,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR2
CONT А=2,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3
CONT А=3,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR4
CONT А=4,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR5
CONT А=5,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR6
CONT А=6,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT А=7,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=У
;INTR=1; ПРОВЕРЯЕМ CONST ПО АДРЕСУ ПЗУ 0:
CROM34:CONT %CLRTYP%
CONT А=0,DSRC=PROM,ALUS=DА,RА=WR1,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=2, АДРЕС ПЗУ 1:
CONT А=1,DSRC=PROM,ALUS=DА,RА=WR2,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=3; АДРЕС 2:
CONT А=2,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=4, АДРЕС 3:
CONT А=3,DSRC=PROM,ALUS=DА,RА=WR4,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=5, АДРЕС 4:
CONT А=4,DSRC=PROM,ALUS=DА,RА=WR5,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=6, АДРЕС 5:
CONT А=5,DSRC=PROM,ALUS=DА,RА=WR6,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=7, АДРЕС 6:
CONT А=6,DSRC=PROM,ALUS=DА,RА=А,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=8, АДРЕС 7:
CONT А=7,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CROM34,МАР=РЕ,%TIK%
;
;
ПЗУ35:ENTRY
;===== ПРОВЕРКА ОТДЕЛЬНЫХ АДРЕСОВ ПЗУ
;  ЧИТАЕМ CONST ИЗ ПЗУ, ДЕЛАЕМ ЛОГИЧЕСКИЕ ОПЕРАЦИИ С ДРУГИМИ CONST, СРАВНИВАЕМ
;  INTR = 0 - 3, 8-15 РГ. БОПП = РГ.Q, Д.Б. РАВЕН 0
;
CJP А=PROM35,МАР=РЕ
PROM35:CONT А=Н35,%T%
%S% А=INITST,МАР=РЕ
CROM35:CONT %CLRTYP%
;INTR = 01: ЧИТАЕМ FF..FF, ИНВЕРТИРУЕМ, СРАВНИВАЕМ С 0
CONT А=CFFF,DSRC=PROM,ALUS=DZ,FUNC=EXNOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR = 02: ЧИТАЕМ 00...FF, ИНВЕРТИРУЕМ МЛ.32 РАЗРЯДА, СРАВНИВАЕМ ВСЕ С 0
CONT А=МН,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=ZА,RА=У,FUNC=EXNOR,ALUD=В,RВ=У
CONT ALUS=ZА,RА=У,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR = 03: ВЫПОЛНЯЕМ РАЗЛИЧНЫЕ ЛОГИЧЕСКИЕ ОПЕРАЦИИ, СРАВНИВАЕМ РЕЗУЛЬТАТ С 0
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=У
;FF...FF
CONT А=С555,DSRC=PROM,ALUS=ZА,RА=У,FUNC=OR,Н,ALUD=В,RВ=У
;FF...FF
CONT А=ZER,DSRC=PROM,ALUS=ZА,RА=У,FUNC=OR,Н,ALUD=В,RВ=У
;FFFF...00
CONT А=MNQ,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,Н,ALUD=В,RВ=У
;00...00
CONT А=MQ,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,Н,ALUD=В,RВ=У
;00...00FF
CONT А=МВ,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,Н,ALUD=В,RВ=У
;FF...FF
CONT А=MNB,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,Н,ALUD=В,RВ=У
;00...00
CONT А=С1,DSRC=PROM,ALUS=DА,RА=У,FUNC=ADD,Н,ALUD=В,RВ=У
;00...0.FFF
CONT А=MADR,DSRC=PROM,ALUS=DА,RА=У,FUNC=OR,Н,ALUD=В,RВ=У
;FF...FF
CONT А=MNADR,DSRC=PROM,ALUS=DА,RА=У,FUNC=OR,Н,ALUD=В,RВ=У
;4
CONT А=С5,DSRC=PROM,ALUS=DА,RА=У,FUNC=ADD,Н,ALUD=В,RВ=У
;0...0
CONT А=В3,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CROM35,МАР=РЕ,%TIK%
;
;     ================================
;     СДВИГИ В СДВИГАТЕЛЕ И МПС + СУСС
;     ================================
;
ДВИГ36:ENTRY
;===== СДВИГ ЛОГИЧЕСКИЙ ВЛЕВО 64Р. В МПС И СДВИГАТЕЛЕ; ПАРАМЕТР СДВИГА - В МП
;   DADR - CONST ДЛЯ СДВИГА ИЗ ПЗУ; А - СДВИНУТОЕ В МПС; У - В СДВИГАТЕЛЕ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH36,МАР=РЕ
PSSH36:CONT А=Н36,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.DADR МПС
CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;DADR - B РГ.A, СДВИГ A В МПС 3 РАЗА
CSH36:PUSH A=2,MAP=PE,ALUS=ZА,RА=DADR,Н,ALUD=B,RВ=А
RFCT ALUS=ZА,RА=А,Н,ALUD=LSB,RВ=А,SHMUX=ASLLS
;СДВИГАЕМ НА 3 В СДВИГАТЕЛЕ
CONT ALUS=DZ,Н,ALUD=ВА,RА=DADR,RВ=У,ALU,DSRC=SHIFT,MPS,PSHF=SН0-3,SHF=LOG
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CSH36,МАР=РЕ,%TIK%
;
;
ДВИГ37:ENTRY
;===== СДВИГ ЦИКЛИЧЕСКИЙ ВЛЕВО 64Р. В МПС И СДВИГАТЕЛЕ, ПАРАМЕТР СДВИГА - В МП
;   А - ЧИСЛО ИЗ ПЗУ, СДВИГАЕМОЕ В СДВИГАТЕЛЕ; У - ТО ЖЕ, НО СДВИГАЕМОЕ В МПС
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В МПС
;
CJP А=PSSH37,МАР=РЕ
PSSH37:CONT А=Н37,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH37:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=22,МАР=РЕ
;А - СДВИГ В МПС 3 РАЗА - В У
CONT ALUS=ZА,RА=А,Н,ALUD=LSB,RВ=У,SHMUX=RSRS
CONT ALUS=ZА,RА=У,Н,ALUD=LSB,RВ=У,SHMUX=RSRS
CONT ALUS=ZА,RА=У,Н,ALUD=LSB,RВ=У,SHMUX=RSRS
;СДВИГАЕМ НА 3 В СДВИГАТЕЛЕ
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0-3,SHF=CICL
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH37,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH37:%J% А=CSH37,МАР=РЕ
;
;
ДВИГ38:ENTRY
;===== СДВИГ АРИФМЕТИЧЕСКИЙ ВЛЕВО 64 Р. В МПС И СДВИГАТЕЛЕ; ПАР-Р СДВИГА - В МП
;   У - РЕЗУЛЬТАТ СДВИГА В МПС; А - В СДВИГАТЕЛЕ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В МПС
;
CJP А=PSSH38,МАР=РЕ
PSSH38:CONT А=Н38,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH38:CONT А=MNQ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=22,МАР=РЕ
;А - СДВИГ В МПС 4 РАЗА ВЛЕВО + 1 ВПРАВО ДЛЯ ВОССТАНОВЛЕНИЯ ЗНАКА - В У
;ЗАПОМИНАЕМ ЗНАК В МС
CONT ALUS=ZА,RА=А,Н,ALUD=LSB,RВ=У,SHMUX=LSLSL,СЕМ
;ПРОСТО СДВИГАЕМ:
CONT ALUS=ZА,RА=У,Н,ALUD=LSB,RВ=У,SHMUX=ASLLS
CONT ALUS=ZА,RА=У,Н,ALUD=LSB,RВ=У,SHMUX=ASLLS
CONT ALUS=ZА,RА=У,Н,ALUD=LSB,RВ=У,SHMUX=ASLLS
;ВОССТАНАВЛИВАЕМ ЗНАК: СДВИГАЕМ ВПРАВО ВМЕСТЕ С МС
CONT ALUS=ZА,RА=У,Н,ALUD=RSB,RВ=У,SHMUX=RDSRDS
;СДВИГАЕМ НА 3 В СДВИГАТЕЛЕ
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0-3
>,SHF=ARIPH
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH38,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH38:%J% А=CSH38,МАР=РЕ
;
;
ДВИГ39:ENTRY
;===== СДВИГ ЛОГИЧЕСКИЙ ВПРАВО 64Р. В МПС И СДВИГАТЕЛЕ, ПАР-Р СДВИГА - В МП
;   А - СДВИНУТОЕ В СДВИГАТЕЛЕ; У - В МПС
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В МПС
;
CJP А=PSSH39,МАР=РЕ
PSSH39:CONT А=Н39,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH39:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=22,МАР=РЕ
;А - СДВИГ В МПС 3 РАЗА - В У
CONT ALUS=ZА,RА=А,Н,ALUD=RSB,RВ=У,SHMUX=LSLSL
CONT ALUS=ZА,RА=У,Н,ALUD=RSB,RВ=У,SHMUX=LSLSL
CONT ALUS=ZА,RА=У,Н,ALUD=RSB,RВ=У,SHMUX=LSLSL
;СДВИГАЕМ НА 3 В СДВИГАТЕЛЕ
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+3,SHF=LOG
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH39,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH39:%J% А=CSH39,МАР=РЕ
;
;
ДВИГ3A:ENTRY
;===== СДВИГ ЦИКЛИЧЕСКИЙ ВПРАВО 64Р. В МПС И СДВИГАТЕЛЕ, ПАРАМЕТР СДВИГА - В МП
;   А - СДВИНУТОЕ В СДВИГАТЕЛЕ; У - В МПС
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В МПС
;
CJP А=PSSH3A,МАР=РЕ
PSSH3A:CONT А=Н3A,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH3A:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=22,МАР=РЕ
;А - СДВИГ В МПС 3 РАЗА - В У
CONT ALUS=ZА,RА=А,Н,ALUD=RSB,RВ=У,SHMUX=RSRS
CONT ALUS=ZА,RА=У,Н,ALUD=RSB,RВ=У,SHMUX=RSRS
CONT ALUS=ZА,RА=У,Н,ALUD=RSB,RВ=У,SHMUX=RSRS
;СДВИГАЕМ НА 3 В СДВИГАТЕЛЕ
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+3,SHF=CICL
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH3A,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH3A:%J% А=CSH3A,МАР=РЕ
;
;
ДВИГ3B:ENTRY
;===== СДВИГ АРИФМЕТИЧЕСКИЙ ВПРАВО 64Р.В МПС И СДВИГАТЕЛЕ; ПАР-Р СДВИГА - В МП
;   А - СДВИНУТОЕ В СДВИГАТЕЛЕ; У - В МПС
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В МПС
;
CJP А=PSSH3B,МАР=РЕ
PSSH3B:CONT А=Н3B,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH3B:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=22,МАР=РЕ
;А - СДВИГ В МПС (В РГ.Q) 3 РАЗА ВПРАВО  - В У
;ПЕРЕСЫЛАЕМ В РГ.Q, ЗАПОМИНАЕМ ЗНАК
CONT ALUS=ZА,RА=А,Н,ALUD=Q,SТОРС=20,СЕМ
;СДВИГАЕМ С ЗАГРУЗКОЙ MN НА ОСВОБОЖД. МЕСТО
CONT ALUS=ZQ,Н,ALUD=RSBQ,RВ=У,SHMUX=ASLLS
CONT ALUS=ZQ,Н,ALUD=RSBQ,RВ=У,SHMUX=ASLLS
CONT ALUS=ZQ,Н,ALUD=RSBQ,RВ=У,SHMUX=ASLLS
;ПЕРЕПИСЫВАЕМ В РГ.Y
CONT ALUS=ZQ,Н,ALUD=В,RВ=У
;СДВИГАЕМ НА 3 В СДВИГАТЕЛЕ
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+3
>,SHF=ARIPH
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH3B,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH3B:%J% А=CSH3B,МАР=РЕ
;
;
ДВИГ3C:ENTRY
;===== СДВИГ ЛОГИЧЕСКИЙ ВЛЕВО 64Р. В МПС И СДВИГАТЕЛЕ; ПАРАМЕТР СДВИГА - В РПС
;   DADR - ПАРАМЕТР СДВИГА; HALF - CONST; А - СДВИГАЕМОЕ В МПС; У - В СДВИГАТЕЛЕ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH3C,МАР=РЕ
PSSH3C:CONT А=Н3C,%T%
%S% А=INITST,МАР=РЕ
;ПАРАМЕТР СДВИГА НА 0 - В РГ.DADR
CSH3C:CONT А=S0,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В А,HALF
CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=72,МАР=РЕ,ALUS=ZА,RА=А,Н,ALUD=В,RВ=HALF
;ПАРАМЕТР СДВИГА - 1 - В РПС
CONT ALUS=ZА,RА=DADR,FUNC=SUBR,Н,ALUD=В,RВ=DADR,ALU,YDST=PSHIFT
;СДВИГАЕМ ИСХОДНОЕ ЗНАЧЕНИЕ CONST ИЗ РГ.HALF В СДВИГАТЕЛЕ - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,SHF=LOG
;СДВИГАЕМ В МПС (КАЖДЫЙ ЦИКЛ - ЕЩЕ НА 1 РАЗРЯД)
CONT ALUS=ZВ,RВ=А,Н,ALUD=LSB,SHMUX=ASLLS
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH3C,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH3C:%J% А=CSH3C,МАР=РЕ
;
;
ДВИГ3D:ENTRY
;===== СДВИГ ЦИКЛИЧЕСКИЙ ВЛЕВО 64Р. В МПС И СДВИГАТЕЛЕ; ПАРАМЕТР СДВИГА - В РПС
;   DADR - ПАРАМЕТР СДВИГА; HALF - CONST; А - СДВИГАЕМОЕ В МПС; У - В СДВИГАТЕЛЕ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH3D,МАР=РЕ
PSSH3D:CONT А=Н3D,%T%
%S% А=INITST,МАР=РЕ
;ПАРАМЕТР СДВИГА НА 0 - В РГ.DADR
CSH3D:CONT А=S0,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В HALF И А
CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
PUSH А=72,МАР=РЕ,ALUS=ZА,RА=HALF,Н,ALUD=В,RВ=А
;ПАР-Р СДВИГА - 1 - В РПС
CONT ALUS=ZА,RА=DADR,FUNC=SUBR,Н,ALUD=В,RВ=DADR,ALU,YDST=PSHIFT
;СДВИГАЕМ CONST В СДВИГАТЕЛЕ - В У (КАЖДЫЙ ЦИКЛ - НА 1 РАЗРЯД БОЛЬШЕ)
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,SHF=CICL
;СДВИГАЕМ В МПС (КАЖДЫЙ ЦИКЛ - ЕЩЕ НА 1 РАЗРЯД)
CONT ALUS=ZВ,RВ=А,Н,ALUD=LSB,SHMUX=RSRS
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH3D,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH3D:%J% А=CSH3D,МАР=РЕ
;
;
ДBИГ3E:ENTRY
;===== СДВИГ АРИФМЕТИЧЕСКИЙ ВЛЕВО 64 Р. В СДВИГАТЕЛЕ И МПС, ПАР-Р СДВИГА - В РПС
;   DADR - ПАРАМЕТР СДВИГА; HALF - CONST; А - СДВИГАЕМОЕ В МПС; У - В СДВИГАТЕЛЕ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH3E,МАР=РЕ
PSSH3E:CONT А=H3E,%T%
%S% А=INITST,МАР=РЕ
;ПАРАМЕТР СДВИГА НА 0 - В РГ.DADR
CSH3E:CONT А=S0,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В HALF,А
CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=72,МАР=РЕ,ALUS=ZА,RА=А,Н,ALUD=В,RВ=HALF
;ПАРАМЕТР СДВИГА - 1 -> В РПС
CONT ALUS=ZВ,RВ=DADR,FUNC=SUBR,Н,ALUD=В,ALU,YDST=PSHIFT
;ДВИГАЕМ В СДВИГАТЕЛЕ - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,SHF=ARIPH
;СДВИГАЕМ АРИФМЕТИЧЕСКИ В МПС: СНАЧАЛА ЗАПОМИНАЕМ ЗНАК
CONT ALUS=ZВ,RВ=А,Н,ALUD=LSB,SHMUX=LSLSL,SТОРС=20,СЕМ
;ПОТОМ ПРОСТО СДВИГ
CONT ALUS=ZВ,RВ=А,Н,ALUD=LSB,SHMUX=ASLLS
;ВОССТАНАВЛИВАЕМ ЗНАК: СДВИГ ВПРАВО (ОБРАТНО) ВМЕСТЕ С МС
CONT ALUS=ZВ,RВ=А,Н,ALUD=RSB,SHMUX=CDLDL
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH3E,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH3E:%J% А=CSH3E,МАР=РЕ
;
;
ДВИГ3F:ENTRY
;===== СДВИГ ЛОГИЧЕСКИЙ ВПРАВО 64Р.В МПС И СДВИГАТЕЛЕ; ПАРАМЕТР СДВИГА - В РПС
;   DADR - ПАРАМЕТР СДВИГА; HALF - CONST; А - СДВИГАЕМОЕ В МПС; У - В СДВИГАТЕЛЕ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH3F,МАР=РЕ
PSSH3F:CONT А=Н3F,%T%
%S% А=INITST,МАР=РЕ
;ПАРАМЕТР СДВИГА НА 0 - В РГ.DADR
CSH3F:CONT А=S0,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В HALF,А
CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
PUSH А=72,МАР=РЕ,ALUS=ZА,RА=HALF,Н,ALUD=В,RВ=А
;ПАР-Р СДВИГА + 1 - В РПС
CONT ALUS=ZВ,RВ=DADR,Н,CI,ALUD=В,ALU,YDST=PSHIFT
;ДВИГАЕМ В СДВИГАТЕЛЕ - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,SHF=LOG
;СДВИГАЕМ В МПС
CONT ALUS=ZВ,RВ=А,Н,ALUD=RSB,SHMUX=LSLSL
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH3F,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH3F:%J% А=CSH3F,МАР=РЕ
;
;
ДBИГ40:ENTRY
;===== СДВИГ ЦИКЛИЧЕСКИЙ ВПРАВО 64Р. В МПС И СДВИГАТЕЛЕ; ПАРАМЕТР СДВИГА - В РПС
;   DADR - ПАРАМЕТР СДВИГА; HALF - CONST; А - СДВИГАЕМОЕ В МПС; У - В СДВИГАТЕЛЕ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH40,МАР=РЕ
PSSH40:CONT А=H40,%T%
%S% А=INITST,МАР=РЕ
;ПАРАМЕТР СДВИГА НА 0 - В РГ.DADR
CSH40:CONT А=S0,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В HALF,А
CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
PUSH А=72,МАР=РЕ,ALUS=ZА,RА=HALF,Н,ALUD=В,RВ=А
;ПАР-Р СДВИГА + 1 - В РПС
CONT ALUS=ZВ,RВ=DADR,Н,CI,ALUD=В,ALU,YDST=PSHIFT
;ДВИГАЕМ В СДВИГАТЕЛЕ - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,SHF=CICL
;СДВИГАЕМ В МПС
CONT ALUS=ZВ,RВ=А,Н,ALUD=RSB,SHMUX=RSRS
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH40,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH40:%J% А=CSH40,МАР=РЕ
;
;
СДВИ41:ENTRY
;===== СДВИГ АРИФМЕТИЧЕСКИЙ ВПРАВО 64Р.В МПС И СДВИГАТЕЛЕ; ПАР-Р СДВИГА - В РПС
;   DADR - ПАРАМЕТР СДВИГА; HALF - CONST; А - СДВИГАЕМОЕ В МПС; У - В СДВИГАТЕЛЕ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH41,МАР=РЕ
PSSH41:CONT А=Н41,%T%
%S% А=INITST,МАР=РЕ
;ПАРАМЕТР СДВИГА НА 0 - В РГ.DADR
CSH41:CONT А=S0,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В HALF, В А; ЗАПОМИНАЕМ ЗНАК
CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF,SТОРС=20,СЕМ
PUSH А=72,МАР=РЕ,ALUS=ZА,RА=HALF,Н,ALUD=В,RВ=А
;ПАР-Р СДВИГА + 1 - В РПС
CONT ALUS=ZВ,RВ=DADR,Н,CI,ALUD=В,ALU,YDST=PSHIFT
;ДВИГАЕМ В СДВИГАТЕЛЕ - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,SHF=ARIPH
;СДВИГАЕМ АРИФМЕТИЧЕСКИ В МПС С РАЗМНОЖЕНИЕМ ЗНАКА ИЗ MN
CONT ALUS=ZВ,RВ=А,Н,ALUD=RSB,SHMUX=ADNDL
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH41,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH41:%J% А=CSH41,МАР=РЕ
;
;
СДВИ42:ENTRY
;===== СДВИГ ЛОГИЧЕСКИЙ ДВОЙНОГО СЛОВА В МПС И СДВИГАТЕЛЕ НА 37 РАЗРЯДОВ
;   А,Q - СДВИГАЕМ В МПС;
;   HALF(А) СДВИГАЕМ В СДВИГАТЕЛЕ, ПИШЕМ В У (ЛЕВАЯ ПОЛОВИНА РЕЗ-ТА);
;   ПРАВУЮ ПОЛОВИНУ РЕЗУЛЬТАТА ПОЛУЧАЕМ ЗА 2 ПРИЕМА В DADR
;   ОШИБКИ: 01 - НЕСОВПАДЕНИЕ ЛЕВОЙ ПОЛОВИНЫ; 02 - ПРАВОЙ.
;   ПРИ ОШ. 8-15 РГ. БОПП = Y,DADR, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH42,МАР=РЕ
PSSH42:CONT А=Н42,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА В HALF И Q
CSH42:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
CONT А=MNH,DSRC=PROM,ALUS=DZ,Н,ALUD=Q
PUSH А=36,МАР=РЕ,ALUS=ZА,RА=HALF,Н,ALUD=В,RВ=А
;СДВИГАЕМ В МПС ДВОЙНОЕ СЛОВО: А(КОПИЯ HALF) И Q
RFCT ALUS=ZВ,RВ=А,Н,ALUD=RSBQ,SHMUX=LDLD
;СДВИГАЕМ В СДВИГАТЕЛЕ ДВОЙНОЕ СЛОВО (ПО ЧАСТЯМ); СНАЧАЛА HALF ВПРАВО НА 37
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,MPS,PSHF=SН0+37
>,SHF=LOG
;СРАВНИВАЕМ ЛЕВУЮ ПОЛОВИНУ РЕЗ-ТА
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СДВИГАЕМ HALF ВЛЕВО НА 64-37=27 (ПОЛУЧАЕМ ТО, ЧТО ВЫДВИНУЛОСЬ ИЗ А В Q)
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=DADR,ALU,DSRC=SHIFT,MPS
>,PSHF=SН0-27,SHF=LOG
;ЧИТАЕМ ПРАВЫЕ 64 РАЗРЯДА CONST, ЧТО БЫЛИ В Q
CONT А=MNH,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1
;СДВИГАЕМ ВПРАВО НА 37
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR1,ALU
>,DSRC=SHIFT,MPS,PSHF=SН0+37,SHF=LOG
;ОБ'ЕДИНЯЕМ
CONT ALUS=АВ,RА=WR1,RВ=DADR,FUNC=OR,Н,ALUD=В
;СРАВНИВАЕМ
CONT ALUS=AQ,RА=DADR,FUNC=EXOR,Н,CEN
CONT %ТУРЕ%
CJS А=ERR8/F,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=DADR,H,ALUD=B,RB=WR6
%J% А=CSH42,МАР=РЕ,%TIK%
;
;
СДВИ43:ENTRY
;===== СДВИГ ЛОГИЧЕСКИЙ ДВОЙНОГО СЛОВА ВЛЕВО В МПС И СДВИГАТЕЛЕ (НА 12 РАЗРЯДОВ)
;   А (КОПИЯ HALF) + Q - СДВИГАЕМ В МПС;
;   HALF СДВИГАЕМ ВЛЕВО В СДВИГАТЕЛЕ = ЛЕВАЯ ПОЛОВИНА РЕЗУЛЬТАТА - В РГ.У;
;   ПРАВУЮ ПОЛОВИНУ РЕЗУЛЬТАТА ПОЛУЧАЕМ ЗА 2 СДВИГА В СДВИГАТЕЛЕ - В РГ.DADR
;   ОШИБКИ: 01 - НЕСОВПАДЕНИЕ ПРАВОЙ ПОЛОВИНЫ РЕЗУЛЬТАТА; 02 - ЛЕВОЙ.
;   ПРИ ОШ. 8-15 РГ. БОПП = Y,DADR, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH43,МАР=РЕ
PSSH43:CONT А=Н43,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА В А (КОПИЯ А - В WR1); И Q (КОПИЯ Q - В HALF)
CSH43:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,Н,ALUD=В,RВ=WR1
CONT А=MNH,DSRC=PROM,ALUS=DZ,Н,ALUD=Q
PUSH А=11,МАР=РЕ,ALUS=ZQ,Н,ALUD=В,RВ=HALF
;СДВИГАЕМ В МПС ДВОЙНОЕ СЛОВО А,Q
RFCT ALUS=ZВ,RВ=А,Н,ALUD=LSBQ,SHMUX=LDLD
;СДВИГАЕМ В СДВИГАТЕЛЕ (ПО ЧАСТЯМ): ПРАВУЮ ПОЛОВИНУ ДВОЙНОГО СЛОВА ВЛЕВО НА 12
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,MPS,PSHF=SН0-12
>,SHF=LOG
;СРАВНИВАЕМ ПРАВУЮ ПОЛОВИНУ РЕЗ-ТА
CONT ALUS=AQ,RА=У,FUNC=EXOR,Н,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СДВИГАЕМ HALF ВПРАВО НА 64-12=52 (ПОЛУЧАЕМ ТО, ЧТО ПОПАЛО В ЛЕВУЮ ПОЛОВИНУ)
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=DADR,ALU,DSRC=SHIFT,MPS
>,PSHF=SН0+52,SHF=LOG
;СДВИГАЕМ ЛЕВУЮ ПОЛОВИНУ ДВОЙНОЙ CONST ВЛЕВО НА 12
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR1,ALU
>,DSRC=SHIFT,MPS,PSHF=SН0-12,SHF=LOG
;ОБ'ЕДИНЯЕМ
CONT ALUS=АВ,RА=WR1,RВ=DADR,FUNC=OR,Н,ALUD=В
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=DADR,FUNC=EXOR,Н,CEN
CONT %ТУРЕ%
CJS А=ERR8/F,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=DADR,H,ALUD=B,RB=WR6
%J% А=CSH43,МАР=РЕ,%TIK%
;
;
СДВИ44:ENTRY
;===== ДВОЙНОЙ СДВИГ ВПРАВО ЛОГИЧЕСКИЙ РЗУ+Q  БОЛЬШЕ 64 РАЗРЯДОВ (НА 96=64+32)
;   А,Q - РЕЗУЛЬТАТ СДВИГА CONST (HALF) В МПС; У - В СДВИГАТЕЛЕ;
;   DADR - ПАРАМЕТР СДВИГА (ПИШЕМ В РПС);
;   ОШИБКИ: 01 - НЕСОВПАДЕНИЕ МЛ.64 РАЗРЯДОВ РЕЗУЛЬТАТА; 02 - СТАРШИХ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH44,МАР=РЕ
PSSH44:CONT А=Н44,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА (МОЖНО 2 ВАРИАНТА: ПОЛОЖИТ. И ОТРИЦАТ. CONST)
CSH44:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;КОПИРУЕМ ЕЕ
PUSH А=95,МАР=РЕ,ALUS=ZА,RА=HALF,Н,ALUD=В,RВ=А,СЕМ
;СДВИГ В МПС ЛОГИЧЕСКИЙ ВПРАВО А+Q (96 РАЗ = 64 + 32)
RFCT ALUS=ZВ,Н,ALUD=RSBQ,RВ=А,SHMUX=LDLD
;СДВИГ В СДВИГАТЕЛЕ В 2 ЭТАПА: ПАРАМЕТР СДВИГА НА 32 РАЗРЯДА - В DADR, В РПС
CONT А=SR32,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,YDST=PSHIFT
;СДВИГАЕМ, ПОЛУЧАЕМ МЛАДШИЕ 64 РАЗРЯДА
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,SHF=LOG
;СРАВНИВАЕМ
CONT ALUS=AQ,RА=У,FUNC=EXOR,Н,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ПАР-Р СДВИГА НА 32+64=96 РАЗРЯДОВ - В РПС
CONT А=В7,DSRC=PROM,ALUS=DА,RА=DADR,Н,ALU,YDST=PSHIFT
;СДВИГАЕМ, ПОЛУЧАЕМ СТАРШИЕ 64 РАЗРЯДА
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У
>,ALU,DSRC=SHIFT,SHF=LOG
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSH44,МАР=РЕ,%TIK%
;
;
СДВИ45:ENTRY
;===== ДВОЙНОЙ СДВИГ ВПРАВО АРИФМЕТИЧЕСКИЙ РЗУ+Q  БОЛЬШЕ 64 РАЗРЯДОВ (НА 96)
;   А,Q - РЕЗУЛЬТАТ СДВИГА CONST (HALF) В МПС; У - В СДВИГАТЕЛЕ;
;   DADR - ПАРАМЕТР СДВИГА (ПИШЕМ В РПС);
;   ОШИБКИ: 01 - НЕСОВПАДЕНИЕ МЛ.64 РАЗРЯДОВ РЕЗУЛЬТАТА; 02 - СТАРШИХ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т СДВИГА В СДВИГАТЕЛЕ
;
CJP А=PSSH45,МАР=РЕ
PSSH45:CONT А=Н45,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА (МОЖНО 2 ВАРИАНТА: ПОЛОЖИТ. И ОТРИЦАТ. CONST)
CSH45:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;КОПИРУЕМ ЕЕ, ЗАПОМИНАЕМ ЗНАК (ДЛЯ АРИФМ.СДВИГА)
PUSH А=95,МАР=РЕ,ALUS=ZА,RА=HALF,Н,ALUD=В,RВ=А,СЕМ
;СДВИГ В МПС АРИФМЕТИЧЕСКИЙ ВПРАВО А+Q (96 РАЗ = 64 + 32)
RFCT ALUS=ZВ,Н,ALUD=RSBQ,RВ=А,SHMUX=ADNDL
;СДВИГ В СДВИГАТЕЛЕ В 2 ЭТАПА: ПАРАМЕТР СДВИГА НА 32 РАЗРЯДА - В DADR, В РПС
CONT А=SR32,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,YDST=PSHIFT
;СДВИГАЕМ, ПОЛУЧАЕМ МЛАДШИЕ 64 РАЗРЯДА
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У,ALU,DSRC=SHIFT,SHF=ARIPH
;СРАВНИВАЕМ
CONT ALUS=AQ,RА=У,FUNC=EXOR,Н,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ПАР-Р СДВИГА НА 32+64=96 РАЗРЯДОВ - В РПС
CONT А=В7,DSRC=PROM,ALUS=DА,RА=DADR,Н,ALU,YDST=PSHIFT
;СДВИГАЕМ, ПОЛУЧАЕМ СТАРШИЕ 64 РАЗРЯДА
CONT ALUS=DZ,Н,ALUD=ВА,RА=HALF,RВ=У
>,ALU,DSRC=SHIFT,SHF=ARIPH
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSH45,МАР=РЕ,%TIK%
;
;
СДВИ46:ENTRY
;===== ЗАГРУЗКА 0/1 ИЗ СУСС ПРИ ДВОЙНОМ СДВИГЕ В МПС ВПРАВО
;   Y,Q = 0101...01; ПРИ СДВИГЕ С ЗАГРУЗКОЙ 0/1 ИЗ СУСС  Y,Q НЕ МЕНЯЮТСЯ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y (INTR=1) ИЛИ Q (INTR=2), ГДЕ РЕЗ-Т СДВИГА В МПС
;
CJP А=PSSH46,МАР=РЕ
PSSH46:CONT А=Н46,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST=АА...АА (1010...10) - В У,Q
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=ZА,RА=У,Н,ALUD=Q
;СДВИГ ДВОЙНОЙ ВПРАВО С ЗАГРУЗКОЙ 0
CSH46:CONT %CLRTYP%
CONT ALUS=ZВ,RВ=У,Н,ALUD=RSBQ,SHMUX=LDLD
;СДВИГ ДВОЙНОЙ ВПРАВО С ЗАГРУЗКОЙ 1
CONT ALUS=ZВ,RВ=У,Н,ALUD=RSBQ,SHMUX=NDNS
;СРАВНИВАЕМ
CONT А=СААА,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,Н,CEN
CONT А=СААА,DSRC=PROM,ALUS=DQ,FUNC=EXOR,Н,СЕМ
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/MZ,%ТУРЕ%
%J% А=CSH46,МАР=РЕ,%TIK%
;
;
СДВИ47:ENTRY
;===== ЗАГРУЗКА 0/1 ИЗ СУСС ПРИ ДВОЙНОМ СДВИГЕ В МПС ВЛЕВО(!)
;   У,Q = 0101...01; ПРИ СДВИГЕ С ЗАГРУЗКОЙ 0/1 ИЗ СУСС  У,Q НЕ МЕНЯЮТСЯ
;   ПРИ ОШ. 8-15 РГ. БОПП = Y (INTR=1) ИЛИ Q (INTR=2), ГДЕ РЕЗ-Т СДВИГА В МПС
;
CJP А=PSSH47,МАР=РЕ
PSSH47:CONT А=Н47,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST=55...55 (010...101) - В У,Q
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=ZА,RА=У,Н,ALUD=Q
;СДВИГ ДВОЙНОЙ ВЛЕВО С ЗАГРУЗКОЙ 0
CSH47:CONT %CLRTYP%
CONT ALUS=ZВ,RВ=У,Н,ALUD=LSBQ,SHMUX=LDLD
;СДВИГ ДВОЙНОЙ ВЛЕВО С ЗАГРУЗКОЙ 1
CONT ALUS=ZВ,RВ=У,Н,ALUD=LSBQ,SHMUX=LDLND
;СРАВНИВАЕМ
CONT А=С555,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,Н,CEN
CONT А=С555,DSRC=PROM,ALUS=DQ,FUNC=EXOR,Н,СЕМ
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
CJS А=ERRINQ,МАР=РЕ,COND=СТ,SТОРС=/MZ,%ТУРЕ%
%J% А=CSH47,МАР=РЕ,%TIK%
;
;
СДВИ48:ENTRY
;===== СДВИГ ЛОГИЧЕСКИЙ И АРИФМЕТИЧЕСКИЙ ВПРАВО ПОЛОЖИТЕЛЬНЫХ ЧИСЕЛ В СДВИГАТЕЛЕ
;   А - СДВИНУТОЕ ЛОГЧИЕСКИ; У - АРИФМЕТИЧЕСКИ
;   ДЛЯ ПОЛОЖИТЕЛЬНЫХ ЧИСЕЛ РЕЗУЛЬТАТ Д.БЫТЬ ОДИНАКОВЫЙ!
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т ЛОГИЧЕСКОГО СДВИГА
;
CJP А=PSSH48,МАР=РЕ
PSSH48:CONT А=Н48,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH48:CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=22,МАР=РЕ
;А - СДВИГ В ЛОГИЧЕСКИЙ НА 3 - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=У,ALU,DSRC=SHIFT,MPS,PSHF=SН0+3,SHF=LOG
;СДВИГАЕМ НА 3 АРИФМЕТИЧЕСКИ - В РГ.А
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+3,SHF=ARIPH
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH48,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH48:%J% А=CSH48,МАР=РЕ
;
;
СДВИ49:ENTRY
;===== СДВИГ ЛОГИЧЕСКИЙ,АРИФМЕТИЧЕСКИЙ ВЛЕВО(!) ПОЛОЖИТЕЛЬНЫХ ЧИСЕЛ В СДВИГАТЕЛЕ
;   А - СДВИНУТОЕ ЛОГЧИЕСКИ; У - АРИФМЕТИЧЕСКИ
;   ДЛЯ ПОЛОЖИТЕЛЬНЫХ ЧИСЕЛ РЕЗУЛЬТАТ Д.БЫТЬ ОДИНАКОВЫЙ,
;   ПОКА НЕ СДВИНУЛИ ДО ЗНАЧАЩИХ РАЗРЯДОВ!
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т ЛОГИЧЕСКОГО СДВИГА
;
CJP А=PSSH49,МАР=РЕ
PSSH49:CONT А=Н49,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH49:CONT А=В4,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=10,МАР=РЕ
;А - СДВИГ В ЛОГИЧЕСКИЙ НА 3 - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=У,ALU,DSRC=SHIFT,MPS,PSHF=SН0-3,SHF=LOG
;СДВИГАЕМ НА 3 АРИФМЕТИЧЕСКИ - В РГ.А
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0-3,SHF=ARIPH
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH49,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH49:%J% А=CSH49,МАР=РЕ
;
;
СДВИ4A:ENTRY
;===== СДВИГ ЛОГИЧЕСКИЙ,АРИФМЕТИЧЕСКИЙ ВЛЕВО ОТРИЦАТЕЛЬНЫХ(!) ЧИСЕЛ В СДВИГАТЕЛЕ
;   А - СДВИНУТОЕ ЛОГЧИЕСКИ; У - АРИФМЕТИЧЕСКИ
;   К РЕЗУЛЬТАТУ ЛОГИЧЕСКОГО СДВИГА ДОБАВЛЯЕМ ЗНАК ПРИ СРАВНЕНИИ.
;   ПРИ ОШ. 8-15 РГ. БОПП = Y, ГДЕ РЕЗ-Т ЛОГИЧЕСКОГО СДВИГА + ЗНАК
;
CJP А=PSSH4A,МАР=РЕ
PSSH4A:CONT А=Н4A,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH4A:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=22,МАР=РЕ
;А - СДВИГ В ЛОГИЧЕСКИЙ НА 3 - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=У,ALU,DSRC=SHIFT,MPS,PSHF=SН0-3,SHF=LOG
;ДОБАВЛЯЕМ ЗНАК
CONT А=В64,DSRC=PROM,ALUS=DА,RА=У,FUNC=OR,Н,ALUD=В,RВ=У
;СДВИГАЕМ НА 3 АРИФМЕТИЧЕСКИ - В РГ.А
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0-3,SHF=ARIPH
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH4A,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERRINF,МАР=РЕ
ESH4A:%J% А=CSH4A,МАР=РЕ
;
;
СДВИ4B:ENTRY
;===== ПЕРЕХОД К ФОРМАТУ БЭСМ-6, ПОЛОЖИТЕЛЬНЫЕ ЧИСЛА
;   У - ЧТО ДОЛЖНО БЫТЬ (ВЫЧИСЛЕННОЕ); А - "РАСХЛОПНУТОЕ"
;   ДЛЯ КОНТРОЛЯ "РАСХЛАПЫВАНИЯ" ТО ЖЕ САМОЕ СДВИГАЕМ ЛОГИЧЕСКИ ВПРАВО
;   И ДОБАВЛЯЕМ РЕЗУЛЬТАТ СДВИГА 64-ОГО РАЗРЯДА АРИФМЕТИЧЕСКИ БЕЗ 64-ОГО РАЗРЯДА
;   ПРИ ОШ. 8-15 РГ. БОПП = WR6, КУДА СКОПИРОВАН "РАСХЛОПНУТЫЙ" РЕЗУЛЬТАТ
;
CJP А=PSSH4B,МАР=РЕ
PSSH4B:CONT А=Н4B,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH4B:CONT А=С0001,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT А=В64,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
PUSH А=22,МАР=РЕ
;А - СДВИГ В ЛОГИЧЕСКИЙ НА 4 - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=У,ALU,DSRC=SHIFT,MPS,PSHF=SН0+4,SHF=LOG
;СДВИГАЕМ АРИФМЕТИЧЕСКИ НА СТОЛЬКО ЖЕ ЗНАК
CONT ALUS=DZ,Н,ALUD=ВА,RА=DADR,RВ=DADR,ALU,DSRC=SHIFT,MPS,PSHF=SН0+4,SHF=ARIPH
;УБИРАЕМ 64 РАЗРЯД, ДОБАВЛЯЕМ ОСТАВШЕЕСЯ К РЕЗУЛЬТАТУ ЛОГИЧЕСКОГО СДВИГА
CONT А=В64,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=EXOR,Н,ALUD=В,RВ=HALF
CONT ALUS=АВ,RА=HALF,RВ=У,FUNC=OR,Н,ALUD=В
;"РАСХЛАПЫВАЕМ" НА 4 - В РГ.А
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+4,SHF=EMULF
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH4B,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERR8/F,МАР=РЕ,ALUS=ZA,RA=A,H,ALUD=B,RB=WR6
ESH4B:%J% А=CSH4B,МАР=РЕ
;
;
СДВИ4C:ENTRY
;===== ПЕРЕХОД К ФОРМАТУ БЭСМ-6, ОТРИЦАТЕЛЬНЫЕ(!) ЧИСЛА
;   У - ЧТО ДОЛЖНО БЫТЬ (ВЫЧИСЛЕННОЕ); А - "РАСХЛОПНУТОЕ"
;   ДЛЯ КОНТРОЛЯ "РАСХЛАПЫВАНИЯ" ТО ЖЕ САМОЕ СДВИГАЕМ АРИФМЕТИЧЕСКИ ВПРАВО
;   И ОБНУЛЯЕМ РАСДВИНУТЫЕ РАЗРЯДЫ ("ДЫРУ")
;   ПРИ ОШ. 8-15 РГ. БОПП = WR6, КУДА СКОПИРОВАН "РАСХЛОПНУТЫЙ" РЕЗУЛЬТАТ
;
CJP А=PSSH4C,МАР=РЕ
PSSH4C:CONT А=Н4C,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ДЛЯ СДВИГА - В РГ.А МПС
CSH4C:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT А=В64,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
PUSH А=22,МАР=РЕ
;А - СДВИГ В АРИФМЕТИЧЕСКИЙ НА 4 - В У
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=У,ALU,DSRC=SHIFT,MPS,PSHF=SН0+4,SHF=ARIPH
;СДВИГАЕМ АРИФМЕТИЧЕСКИ НА СТОЛЬКО ЖЕ ЗНАК
CONT ALUS=DZ,Н,ALUD=ВА,RА=DADR,RВ=DADR,ALU,DSRC=SHIFT,MPS,PSHF=SН0+4,SHF=ARIPH
;УБИРАЕМ 64 РАЗРЯД, ИНВЕРТИРУЕМ, ПОЛУЧАЕМ МАСКУ НА "ДЫРУ"
CONT А=В64,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=EXOR,Н,ALUD=В,RВ=HALF
CONT ALUS=ZВ,RВ=HALF,FUNC=EXNOR,Н,ALUD=В
;ОБНУЛЯЕМ "ДЫРУ"
CONT ALUS=АВ,RА=HALF,RВ=У,FUNC=AND,Н,ALUD=В
;"РАСХЛАПЫВАЕМ" НА 4 - В РГ.А
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+4,SHF=EMULF
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
TWB А=ESH4C,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
CJS А=ERR8/F,МАР=РЕ,ALUS=ZA,RA=A,H,ALUD=B,RB=WR6
ESH4C:%J% А=CSH4C,МАР=РЕ
;
;
СДВИ4D:ENTRY
;===== СДВИГ ПОЛОВИНЫ(!) CONST ВПРАВО ЛОГИЧ. В МПС НА 16 РАЗР.+ СИГНАЛ RLD(!)
;   А - CONST; У - РЕЗУЛЬТАТ.
;   ОШИБКИ: 01: НЕ ТО В 33-64 РАЗРЯДАХ; 02: В 1-16 Р.; 03: В 17-32 Р.
;   ПРИ ОШ. 8-15 РГ.БОПП = Y, ГДЕ СТ.ПОЛОВИНА = CONST, МЛ. СДВИНУТА ВПРАВО НА 16
;
CJP А=PSSH4D,МАР=РЕ
PSSH4D:CONT А=Н4D,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ В РГ.А,Y
CSH4D:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,Н,ALUD=В,RВ=У
;15 - В РГ/СЧЕТЧИК СУАМ
CONT А=С15,DSRC=PROM,ALUS=DZ,ALU,RLD
S1А:RРСТ А=S1А,МАР=РЕ,ALUS=ZВ,RВ=У,ALUD=RSB,SHMUX=LSLSL
;ПРОВЕРЯЕМ СТАРШИЕ 32 РАЗРЯДА
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=MNH,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ВЫЧИСЛЯЕМ МЛАДШИЕ 16 РАЗРЯДОВ (СДВИГАЕМ В СДВИГАТЕЛЕ), СРАВНИВАЕМ
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=DADR,ALU,DSRC=SHIFT,MPS,PSHF=SН0+16
>,SHF=LOG
CONT ALUS=АВ,RА=У,RВ=DADR,FUNC=EXOR,Н,ALUD=Q
CONT А=MQ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ПРОВЕРЯЕМ 17-32 РАЗРЯДЫ; Д.Б.= 0, Т.К.СДВИГ ЛОГИЧЕСКИЙ
CONT А=MQ2,DSRC=PROM,ALUS=DА,RА=У,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSH4D,МАР=РЕ,%TIK%
;
;
CДBИ4E:ENTRY
;===== СДВИГ ПОЛОВИНЫ CONST>0 ВПРАВО АРИФМЕТИЧЕСКИЙ(!)  НА 32 РАЗРЯДА + RLD
;   А - CONST; У - РЕЗУЛЬТАТ, МЛАДШИЕ 32 РАЗРЯДА = РАЗМНОЖЕННОМУ ЗНАКУ!
;   ОШИБКИ: 01 - ТЕ ТО В СРТАРШЕЙ ПОЛОВИНЕ; 02 - НЕ ТО В МЛАДШЕЙ
;   ПРИ ОШ. 8-15 РГ.БОПП = Y, ГДЕ СТ.ПОЛОВИНА = CONST, МЛ. СДВИНУТА ВПРАВО НА 32
;
CJP А=PSSH4E,МАР=РЕ
PSSH4E:CONT А=H4E,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ В РГ.А
CSH4E:CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
;ЗАПОМИНАЕМ ЗНАК
;А - В У, 31 - В РГ/СЧЕТЧИК СУАМ
CONT А=С31,DSRC=PROM,ЕСА,WRA,ARA=RG3,ЕСВ,BRA=RG3,RLD,ALUS=ZА,RА=А,Н
>,ALUD=В,RВ=У
;ЗАПОМИНАЕМ ЗНАК У МЛАДШИХ 32 РАЗРЯДОВ
CONT ALUS=ZA,RA=Y,CEM
;СДВИГ
S1D:RРСТ А=S1D,МАР=РЕ,ALUS=ZВ,RВ=У,ALUD=RSB,SHMUX=ADNDL
;ПРОВЕРЯЕМ СТАРШИЕ 32 РАЗРЯДА
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=MNH,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ПРОВЕРЯЕМ МЛАДШИЕ 32 РАЗРЯДА, Д.Б.РАВНЫ РАЗМНОЖЕННОМУ ЗНАКУ, Т.Е. 0
CONT ALUS=ZА,RА=У,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSH4E,МАР=РЕ,%TIK%
;
;
СДВИ4F:ENTRY
;===== СДВИГ ПОЛОВИНЫ CONST<0 (!) ВПРАВО АРИФМЕТИЧЕСКИЙ(!)  НА 32 РАЗРЯДА + RLD
;   А - CONST; У - РЕЗУЛЬТАТ, МЛАДШИЕ 32 РАЗРЯДА = ЗНАКУ!
;   ОШИБКИ: 01 - НЕ ТЕ 33-64 РАЗРЯДЫ; 02 - 1-32 РАЗРЯДЫ
;   ПРИ ОШ. 8-15 РГ.БОПП = Y, ГДЕ СТ.ПОЛОВИНА = CONST, МЛ. СДВИНУТА ВПРАВО НА 32
;
CJP А=PSSH4F,МАР=РЕ
PSSH4F:CONT А=Н4F,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ В РГ.А,Y
CSH4F:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,СЕМ
CONT ALUS=ZА,RА=А,Н,ALUD=В,RВ=У
;31 - В РГ/СЧЕТЧИК СУАМ
PUSH А=С31,DSRC=PROM,ALUS=DZ,ALU,RLD
;СДВИГ
RFCT ALUS=ZВ,RВ=У,ALUD=RSB,SHMUX=ADNDL
;ПРОВЕРЯЕМ СТАРШИЕ 32 РАЗРЯДА
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=MNH,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ПРОВЕРЯЕМ МЛАДШИЕ 32 РАЗРЯДА, Д.Б.РАВНЫ ЗНАКУ: ЗНАК = 1, СРАВНИВАЕМ С FF..FF
CONT А=МН,DSRC=PROM,ALUS=DА,RА=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSH4F,МАР=РЕ,%TIK%
;
;
CДBИ50:ENTRY
;===== СДВИГ ПОЛОВИНЫ CONST ВПРАВО ЦИКЛИЧЕСКИЙ 2 РАЗА НА 15 И 17 РАЗРЯДОВ + RLD
;   А - CONST; У - РЕЗУЛЬТАТ
;   ОШИБКИ: 01,02 - НЕ ТЕ ДАННЫЕ ПРИ 1 И 2 СРАВНЕНИИ
;   ПРИ ОШ. 8-15 РГ.БОПП = Y, ГДЕ СТ.ПОЛОВИНА = CONST, МЛ. = 5...5 ИЛИ A...A
;
CJP А=PSSH50,МАР=РЕ
PSSH50:CONT А=H50,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ В РГ.А,Y
CSH50:CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
;14 - В РГ/СЧЕТЧИК СУАМ
CONT А=С14,DSRC=PROM,ALUS=DZ,ALU,RLD
CONT ALUS=ZА,RА=А,Н,ALUD=В,RВ=У
S1F:RРСТ А=S1F,МАР=РЕ,ALUS=ZВ,RВ=У,ALUD=RSB,SHMUX=RSLRSL
;ПРОВЕРЯЕМ МЛАДШИЕ 32 РАЗРЯДА НА НЕСОВПАДЕНИЕ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
CONT А=С16,DSRC=PROM,ALUS=DZ,ALU,RLD
;СДВИГАЕМ ЕЩЕ НА 17 РАЗРЯДОВ ЦИКЛИЧЕСКИ
SH1F:RРСТ А=SH1F,МАР=РЕ,ALUS=ZВ,RВ=У,ALUD=RSB,SHMUX=RSLRSL
;ПРОВЕРЯЕМ МЛАДШИЕ 32 РАЗРЯДА НА СОВПАДЕНИЕ!
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSH50,МАР=РЕ,%TIK%
;
;
СДВИ51:ENTRY
;===== СДВИГ ПОЛОВИНЫ CONST ВЛЕВО ЛОГИЧЕСКИЙ НА 16 РАЗРЯДОВ + RLD
;   А - CONST; У - РЕЗУЛЬТАТ.
;   ОШИБКИ: 01,02 - НЕСОВПАДЕНИЕ В СТАРШИХ, МЛАДШИХ РАЗРЯДАХ
;   ПРИ ОШ. 8-15 РГ.БОПП = Y, ГДЕ СТ.ПОЛОВИНА = CONST, МЛ. СДВИНУТА ВЛЕВО НА 16
;
CJP А=PSSH51,МАР=РЕ
PSSH51:CONT А=Н51,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ В РГ.А,Y
CSH51:CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,Н,ALUD=В,RВ=У
;15 - В РГ/СЧЕТЧИК СУАМ
CONT А=С15,DSRC=PROM,ALUS=DZ,ALU,RLD
SН20:RРСТ А=SН20,МАР=РЕ,ALUS=ZВ,RВ=У,ALUD=LSB,SHMUX=LSLSL
;ПРОВЕРЯЕМ СТАРШИЕ 32 РАЗРЯДА
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=MNH,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ВЫЧИСЛЯЕМ 1-32 РАЗРЯДЫ (СДВИГАЕМ В СДВИГАТЕЛЕ), СРАВНИВАЕМ
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=DADR,ALU,DSRC=SHIFT,MPS,PSHF=SН0-16
>,SHF=LOG
CONT ALUS=АВ,RА=У,RВ=DADR,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSH51,МАР=РЕ,%TIK%
;
;
СДВИ52:ENTRY
;===== СДВИГ ПОЛОВИНЫ CONST ВЛЕВО АРИФМЕТИЧЕСКИЙ НА 32 РАЗРЯДА + RLD
;   А - CONST; У - РЕЗУЛЬТАТ, ОСТАЕТСЯ ТОЛЬКО ЗНАКОВЫЙ РАЗРЯД!
;   ВНИМАНИЕ! ПРОВЕРКА АРИФМЕТИЧЕСКОГО СДВИГА ВЛЕВО В МПС
;   НЕ ИМЕЕТ СМЫСЛА, Т.К. ЗНАК ДОБАВЛАЕТСЯ ДОПОЛНИТЕЛЬНЫМ
;   СДВИГОМ ВПРАВО! ДОСТАТОЧНО ПРОВЕРКИ ЛОГИЧЕСКОГО СДВИГА.
;   ОШИБКИ: 01,02 - НЕСОВПАДЕНИЕ В СТАРШЕЙ, МЛАДШЕЙ ПОЛОВИНЕ
;   ПРИ ОШ. 8-15 РГ.БОПП = Y, ГДЕ СТ.ПОЛОВИНА = CONST, МЛ. СДВИНУТА ВЛЕВО НА 32
;
CJP А=PSSH52,МАР=РЕ
PSSH52:CONT А=Н52,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ В РГ.А,Y
CSH52:CONT А=CF530,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,Н,ALUD=В,RВ=У
;ЗАПОМИНАЕМ ЗНАК
CONT А=В32,DSRC=PROM,ALUS=DА,RА=А,FUNC=AND,CEN,СЕМ
;32 - В РГ/СЧЕТЧИК СУАМ
CONT А=С32,DSRC=PROM,ALUS=DZ,ALU,RLD
SН21:RРСТ А=SН21,МАР=РЕ,ALUS=ZВ,RВ=У,ALUD=LSB,SHMUX=LSLSL
;ЗАДВИГАЕМ ОБРАТНО ЗНАК
CONT ALUS=ZВ,RВ=У,ALUD=RSB,SHMUX=ADNDL
;ПРОВЕРЯЕМ СТАРШИЕ 32 РАЗРЯДА
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=MNH,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,СЕМ
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/MZ,%ТУРЕ%
;ПРОВЕРЯЕМ МЛАДШИЕ 32 РАЗРЯДА: СТАРШИЙ РАЗРЯД Д.Б.РАВЕН ЗНАКУ, ОСТАЛЬНЫЕ = 0
CONT А=В32,DSRC=PROM,ALUS=DА,RА=А,FUNC=AND,ALUD=В,RВ=DADR
CONT ALUS=АВ,RА=DADR,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSH52,МАР=РЕ,%TIK%
;
;
СДВИ53:ENTRY
;===== СДВИГ ПОЛОВИНЫ CONST ВЛЕВО ЦИКЛИЧЕСКИЙ 2 РАЗА НА 15 И 17 РАЗРЯДОВ + RLD
;   А - CONST; У - РЕЗУЛЬТАТ
;   ОШИБКИ: 01,02 - НЕ ТОТ РЕЗУЛЬТАТ ПОСЛЕ 1,2 СДВИГОВ
;   ПРИ ОШ. 8-15 РГ.БОПП = Y, ГДЕ СТ.ПОЛОВИНА = CONST, МЛ. = 5...5 ИЛИ A...A
;
CJP А=PSSH53,МАР=РЕ
PSSH53:CONT А=Н53,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ В РГ.А,Y
CSH53:CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,Н,ALUD=В,RВ=У
;14 - В РГ/СЧЕТЧИК СУАМ
CONT А=С14,DSRC=PROM,ALUS=DZ,ALU,RLD
SНAA:RРСТ А=SНAA,МАР=РЕ,ALUS=ZВ,RВ=У,ALUD=LSB,SHMUX=RSLRSL
;ПРОВЕРЯЕМ МЛАДШИЕ 32 РАЗРЯДА НА НЕСОВПАДЕНИЕ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CONT %CLRTYP%
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
CONT А=С16,DSRC=PROM,ALUS=DZ,ALU,RLD
;СДВИГАЕМ ЕЩЕ НА 17 РАЗРЯДОВ ЦИКЛИЧЕСКИ
SBB:RРСТ А=SBB,МАР=РЕ,ALUS=ZВ,RВ=У,ALUD=LSB,SHMUX=RSLRSL
;ПРОВЕРЯЕМ МЛАДШИЕ 32 РАЗРЯДА НА СОВПАДЕНИЕ!
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSH53,МАР=РЕ,%TIK%
;
;     ===================
;     ПОИСК ЛЕВОЙ ЕДИНИЦЫ
;     ===================
;
ПЛЕ60:ENTRY
;===== ПОИСК ЛЕВОЙ ЕДИНИЦЫ; "1" СДВИГАЕТСЯ ОТ СТАРШЕГО РАЗРЯДА К МЛАДШЕМУ
;   А - ВЫЧИСЛЯЕМЫЙ НОМЕР ЕДИНИЦЫ; У - ПРОЧИТАННЫЙ ИЗ ПЛЕ;
;   Q - МАСКА НА 6 МЛ.РАЗРЯДОВ (N ЕДИНИЦЫ) И ФЛАГ (7-Й РАЗРЯД!!!)
;   DADR - ЧИСЛО, У КОТОРОГО ОПРЕДЕЛЯЕМ НОМЕР ЕДИНИЦЫ
;   01 - НЕВЕРНЫЙ N ЕДИНИЦЫ У ЧИСЛА С ЕДИНИЦАМИ, 02 - У ЧИСЛА = "0"
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ВЫЧИСЛЕННЫЙ N ЕД.), 12-15 = Y (ПРОЧИТАННЫЙ N ЕД.)
;
CJP А=PSLO60,МАР=РЕ
PSLO60:CONT А=Н60,%T%
%S% А=INITST,МАР=РЕ
;МАСКА НА 7 МЛАДШИХ РАЗРЯДОВ (6 ИНФОРМАЦИОННЫХ + ФЛАГ) - В РГ.Q
CONT А=H7F,DSRC=PROM,ALUS=DZ,Н,ALUD=Q
;ЧИТАЕМ ЧИСЛО С "1" В 64 РАЗРЯДЕ, КОТОРУЮ БУДЕМ СДВИГАТЬ
CLO60:CONT А=В64,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;"0" - В А
CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=63,МАР=РЕ,%CLRTYP%
;ЧИТАЕМ N ЛЕВОЙ ЕДИНИЦЫ
CONT ALUS=DQ,FUNC=AND,Н,ALUD=ВА,RА=DADR,RВ=У,ALU,DSRC=LOS
;СРАВНИВАЕМ (7-Й РАЗРЯД - ФЛАГ = 0)
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;+1 К ВЫЧИСЛЯЕМОМУ НОМЕРУ ЕДИНИЦЫ (ОТ 0 ДО 63)
CONT ALUS=ZВ,RВ=А,Н,CI,ALUD=В
;СДВИГАЕМ "1" НА 1 РАЗРЯД ВПРАВО
RFCT ALUS=ZВ,RВ=DADR,Н,ALUD=RSB,SHMUX=LSLSL
;ПРОВЕРЯЕМ ПЛЕ С "0":
CONT ALUS=DQ,FUNC=AND,Н,ALUD=ВА,RА=DADR,RВ=У,ALU,DSRC=LOS
;Д.Б.ВСЕ 7 РАЗРЯДОВ = 1, Т.Е. 6 МЛАДШИХ И 7-Й (ФЛАГ); СРАВНИВАЕМ С МАСКОЙ
CONT ALUS=ZQ,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CLO60,МАР=РЕ,%TIK%
;
;
ПЛЕ61:ENTRY
;===== ПОИСК ЛЕВОЙ ЕДИНИЦЫ; "1" СДВИГАЕТСЯ ОТ МЛАДШЕГО РАЗРЯДА К СТАРШЕМУ
;   А - ВЫЧИСЛЯЕМЫЙ НОМЕР ЕДИНИЦЫ; У - ПРОЧИТАННЫЙ ИЗ БЛОКА ПЛЕ;
;   Q - МАСКА НА 6 МЛ.РАЗРЯДОВ (N ЕДИНИЦЫ) И ФЛАГ (7-Й РАЗРЯД!!!)
;   DADR - ЧИСЛО, У КОТОРОГО ОПРЕДЕЛЯЕМ НОМЕР ЕДИНИЦЫ
;   01 - НЕВЕРНЫЙ N ЕДИНИЦЫ У ЧИСЛА = "0", 02 - У ЧИСЛА С ЕДИНИЦАМИ
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ВЫЧИСЛЕННЫЙ N ЕД.), 12-15 = Y (ПРОЧИТАННЫЙ N ЕД.)
;
CJP А=PSLO61,МАР=РЕ
PSLO61:CONT А=Н61,%T%
%S% А=INITST,МАР=РЕ
;МАСКА НА 7 МЛАДШИХ РАЗРЯДОВ - В РГ. Q
CLO61:CONT А=H7F,DSRC=PROM,ALUS=DZ,Н,ALUD=Q
;"0" В DADR
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=DADR
;ОПРЕДЕЛЯЕМ N СТАРШЕЙ ЕД.
CONT ALUS=DQ,FUNC=AND,Н,ALUD=ВА,RА=DADR,RВ=У,ALU,DSRC=LOS
;СРАВНИВАЕМ (6 МЛАДШИХ И 7-Й - ФЛАГ)
CONT ALUS=ZQ,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,CEN
CONT %CLRTYP%
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
CONT А=М6В,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
;ПИШЕМ "1" В DADR
PUSH А=63,МАР=РЕ,ALUS=ZВ,RВ=DADR,Н,CI,ALUD=В
;ОПРЕДЕЛЯЕМ N ЛЕВОЙ ЕДИНИЦЫ, НАЧИНАЯ С "1" В МЛ. РАЗРЯДЕ
CONT ALUS=DQ,FUNC=AND,Н,ALUD=ВА,RА=DADR,RВ=У,ALU,DSRC=LOS
;СРАВНИВАЕМ
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;-1 ОТ ВЫЧИСЛЯЕМОГО N ЕДИНИЦЫ
CONT ALUS=ZВ,RВ=А,FUNC=SUBR,Н,ALUD=В
;СДВИГАЕМ "1" НА 1 РАЗРЯД ВЛЕВО С ЗАГРУЗКОЙ "1"
RFCT ALUS=ZВ,RВ=DADR,Н,ALUD=LSB,SHMUX=NDNS
%J% A=CLO61,MAP=PE,%TIK%
;
;     ===========================
;     Р Н Г  +  ОЗУ МОДИФИКАТОРОВ
;     ===========================
;
РНГ62:ENTRY
;===== РНГ: ПИШЕМ CONST И /CONST (00 ИЛИ FF) В РНГ; ЧТЕНИЕ В МПС; СРАВНЕНИЕ
;   В РНГ ПИШЕМ С 6-10 РАЗР.ШИНЫ У; ЧИТАЕМ 6-11 РАЗР.ШИНЫ D.
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; DADR = РГ.A C 1 B 11 РАЗРЯДЕ
;   ПРИ ОШ. 10-11 РГ.БОПП = A (ЧТО ПИШЕМ), 14-15 = Y (ЧТО ПРОЧИТАЛИ);
;   РГ.A Д.Б. РАВЕН РГ.Y С ТОЧНОСТЬЮ ДО "1" B 11 РАЗРЯДЕ!
;
CJP А=PSMD62,МАР=РЕ
PSMD62:CONT А=Н62,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А, BYTE = МАСКА
CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=B,RB=A
;ЦИКЛ: ПИШЕМ В РНГ 0 ИЛИ FF ПОПЕРЕМЕННО
CMOD62:CONT ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,ALU,YDST=MODGN
;ЧИТАЕМ РНГ
CONT DSRC=MODGN,ALUS=DZ,ALUD=В,RВ=У
;ДОБАВЛЯЕМ В РГ.А ДЛЯ СРАВНЕНИЯ "1" В 11 РАЗРЯДЕ; СРАВНИВАЕМ
CONT А=B11,DSRC=PROM,ALUS=DA,RA=A,FUNC=OR,Н,ALUD=B,RB=DADR
CONT ALUS=АВ,RА=DADR,RВ=Y,FUNC=EXOR,Н,ALUD=Q
CONT A=MGN,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD62,МАР=РЕ,%TIK%
;
;
РНГ63:ENTRY
;===== РНГ: ПИШЕМ ПЕРЕМЕННОЕ ЧИСЛО В РНГ; ЧТЕНИЕ В МПС; СРАВНЕНИЕ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; DADR = РГ.A C 1 B 11 РАЗРЯДЕ
;   ПРИ ОШ. 10-11 РГ.БОПП = A (ЧТО ПИШЕМ), 14-15 = Y (ЧТО ПРОЧИТАЛИ);
;   РГ.A Д.Б. РАВЕН РГ.Y С ТОЧНОСТЬЮ ДО "1" B 11 РАЗРЯДЕ!
;
CJP А=PSMD63,МАР=РЕ
PSMD63:CONT А=Н63,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А, BYTE = МАСКА
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ В РНГ ПЕРЕМННОЕ ЧИСЛО ( + "1" В 6-ОМ РАЗРЯДЕ)
CMOD63:CONT A=B6,DSRC=PROM,ALUS=DА,RА=А,FUNC=ADD,H,ALUD=B,RB=A,ALU,YDST=MODGN
;ЧИТАЕМ РНГ
CONT DSRC=MODGN,ALUS=DZ,ALUD=В,RВ=У
;ДОБАВЛЯЕМ В РГ.А ДЛЯ СРАВНЕНИЯ "1" В 11 РАЗРЯДЕ; СРАВНИВАЕМ
CONT А=B11,DSRC=PROM,ALUS=DA,RA=A,FUNC=OR,Н,ALUD=B,RB=DADR
CONT ALUS=АВ,RА=DADR,RВ=Y,FUNC=EXOR,Н,ALUD=Q
CONT A=MGN,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD63,МАР=РЕ,%TIK%
;
;
МОД64:ENTRY
;===== ПРОВЕРЯЕМ МОДИФИКАТОРЫ КАК РЕГИСТР: ПИШЕМ, ЧИТАЕМ ПО ФИКСИР.АДРЕСУ.
;
;===== ПИШЕМ 0/F(!) - В 0-Й МОДИФИКАТОР; АДРЕС МОДИФИКАТОРА - В МП; ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD64,МАР=РЕ
PSMD64:CONT А=Н64,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;ЦИКЛ: ИНВЕРТИРУЕМ РГ.А, ПИШЕМ В 0-Й МОДИФИКТОР
CMOD64:CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALUD=В,RB=A,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=МР,MODNM=М0,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD64,МАР=РЕ,%TIK%
;
;
МОД65:ENTRY
;===== ПИШЕМ 0/F - В 5-Й(!) МОДИФИКАТОР; АДРЕС МОДИФИКАТОРА - В МП; ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD65,МАР=РЕ
PSMD65:CONT А=Н65,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ 0/F В 5-Й МОДИФИКТОР
CMOD65:CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALUD=В,RB=A,ALU,CSM,WЕМ,MNSA=МР,MODNM=М5
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=МР,MODNM=М5,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD65,МАР=РЕ,%TIK%
;
;
МОД66:ENTRY
;===== ПИШЕМ 0/F - В RRR(!) (НОМЕР > 16); АДРЕС МОДИФИКАТОРА - В МП; ЧИТАЕМ
;   А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD66,МАР=РЕ
PSMD66:CONT А=Н66,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ В РРР (СПЕЦ.РЕГИСТР!)
CMOD66:CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALUD=В,RB=A,ALU,CSM,WЕМ,MNSA=МР,MODNM=RRR
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=МР,MODNM=RRR,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD66,МАР=РЕ,%TIK%
;
;
MOД67:ENTRY
;===== ПИШЕМ 0/F - В 1-Й МОДИФИКАТОР; АДРЕС МОДИФИКАТОРА - В АИСП.(!); ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD67,МАР=РЕ
PSMD67:CONT А=H67,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;1 - В АИСП. (НОМЕР РЕГИСТРА)
CONT ALUS=ZА,RА=А,CI,ALU,YDST=ADRREG
;ЦИКЛ: ПИШЕМ В 1-Й МОДИФИКТОР (ПО АИСП.), БЕЗ MOD!
CMOD67:CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALUD=В,RВ=А,ALU,CSM,WЕМ,MNSA=U
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=U,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD67,МАР=РЕ,%TIK%
;
;
МОД68:ENTRY
;===== ПИШЕМ 0/F В МОДИФ.С БОЛЬШИМ N (=12) + ПРИЗНАК MOD; АДРЕС МОДИФ.- В АИСП.
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; DADR - N РЕГИСТРА
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD68,МАР=РЕ
PSMD68:CONT А=Н68,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;18 - В АИСП. (НОМЕР РЕГИСТРА)
CONT А=H12,DSRC=PROM,ALUS=DZ,ALUD=B,RB=DADR,ALU,YDST=ADRREG
;ЦИКЛ: ПИШЕМ В МОДИФИКТОР ПО U
CMOD68:CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALUD=В,RВ=А,ALU,CSM,WЕМ,MNSA=U,MOD
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=U,MOD,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD68,МАР=РЕ,%TIK%
;
;
МОД69:ENTRY
;===== ПИШЕМ ПЕРЕМЕННУЮ (!) - В 0-Й МОДИФИКАТОР; АДРЕС МОДИФ.- В МП; ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD69,МАР=РЕ
PSMD69:CONT А=Н69,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;ЦИКЛ: УВЕЛИЧИВАЕМ РГ.А НА "1", ПИШЕМ В 0-Й МОДИФИКТОР
CMOD69:CONT ALUS=ZB,RB=А,FUNC=ADD,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=МР,MODNM=М0,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD69,МАР=РЕ,%TIK%
;
;
МОД6A:ENTRY
;===== ПИШЕМ ПЕРЕМЕННУЮ - В 3-Й(!) МОДИФИКАТОР; АДРЕС МОДИФ. - В МП; ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD6A,МАР=РЕ
PSMD6A:CONT А=Н6A,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ В 3-Й МОДИФИКТОР
CMOD6A:CONT ALUS=ZВ,RВ=А,FUNC=ADD,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М3
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=МР,MODNM=М3,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD6A,МАР=РЕ,%TIK%
;
;
МОД6B:ENTRY
;===== ПИШЕМ ПЕРЕМЕНУЮ -  В SVFA(!) (НОМЕР > 16); АДРЕС МОД.- В МП; ЧИТАЕМ
;   А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;
CJP А=PSMD6B,МАР=РЕ
PSMD6B:CONT А=Н6B,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ В SVFA (СПЕЦ.РЕГИСТР!)
CMOD6B:CONT ALUS=ZВ,RВ=А,FUNC=ADD,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=SVFA
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=МР,MODNM=SVFA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD6B,МАР=РЕ,%TIK%
;
;
МОД6C:ENTRY
;===== ПИШЕМ ПЕРЕМЕННУЮ - В 1-Й МОДИФИКАТОР; АДРЕС МОДИФ.- В АИСП.(!); ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD6C,МАР=РЕ
PSMD6C:CONT А=Н6C,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;1 - В АИСП. (НОМЕР РЕГИСТРА)
CONT ALUS=ZА,RА=А,CI,ALU,YDST=ADRREG
;ЦИКЛ: ПИШЕМ В 1-Й МОДИФИКТОР
CMOD6C:CONT ALUS=ZВ,RВ=А,FUNC=ADD,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=U,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD6C,МАР=РЕ,%TIK%
;
;
МОД6D:ENTRY
;===== ПИШЕМ ПЕРЕМ.В 19-Й(!) МОД.С ПРИЗНАКОМ MOD; АДРЕС МОД.- В АИСП.;ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; DADR - N РЕГИСТРА
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD6D,МАР=РЕ
PSMD6D:CONT А=Н6D,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;19 - В АИСП. (НОМЕР РЕГИСТРА)
CONT А=H13,DSRC=PROM,ALUS=DZ,ALUD=B,RB=DADR,ALU,YDST=ADRREG
;ЦИКЛ: ПИШЕМ В МОДИФИКТОР ПО U
CMOD6D:CONT ALUS=ZВ,RВ=А,FUNC=ADD,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U,MOD
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=U,MOD,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD6D,МАР=РЕ,%TIK%
;
;
МОД6E:ENTRY
;===== ПРОВЕРЯЕМ МОДИФИКАТОРЫ КАК ПАМЯТЬ: ПИШЕМ, ЧИТАЕМ ПО ВСЕМ АДРЕСАМ ОЗУ
;
;===== ПИШЕМ ПЕРЕМЕННУЮ ПО ВСЕМ АДРЕСАМ ПАМЯТИ(!); АДРЕС МОДИФИКАТОРА - В МП
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; DADR - N МОДИФИКАТОРА
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD6E,МАР=РЕ
PSMD6E:CONT А=Н6E,%T%
%S% А=INITST,МАР=РЕ
;"-1" - В РГ.DADR (НОМЕР ГРУППЫ); 0 - В РГ.А
CONT A=MH,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=DADR
;ЦИКЛ ПО ГРУППАМ:
PUSH А=15,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ - И В РНГ
CONT A=B6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=B,RB=DADR,ALU,YDST=MODGN
;ПИШЕМ ПЕРЕМЕННУЮ В РЕГИСТРЫ; АДРЕС - В МП; РЕГИСТРЫ НЕ ПО ПОРЯДКУ (ЧЕРЕЗ 1)
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=MREZ
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=SVFA
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=CTL
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=РСС
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=YCL
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=ACL
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=SPRADR
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=RR
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М13
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М11
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М9
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М7
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М5
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М3
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М1
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=PROCNC
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=CTR
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=РССС
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=YCR
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=ACR
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=СТТ
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=RRR
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=С
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М14
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М12
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М10
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М8
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М6
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М4
CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М2
RFCT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ЧТЕНИЕ: 0 - В РГ.DADR (НОМЕР ГРУППЫ), В РГ.А
CMOD6E:CONT A=MH,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=DADR
;ЦИКЛ ПО ГРУППАМ:
PUSH А=15,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;НОМЕР ГРУППЫ - В РНГ
CONT A=B6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=B,RB=DADR,ALU,YDST=MODGN
;ЧИТАЕМ ПЕРЕМЕННУЮ ИЗ ОЗУ МОД., СРАВНИВАЕМ; ПОРЯДОК РЕГИСТРОВ - ТОТ ЖЕ
;ОШИБКА - 00
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=MREZ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=SVFA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;02
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=CTL,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;03
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=РСС,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;04
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=YCL,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;05
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=ACL,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;06
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=SPRADR,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;07
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=RR,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;08
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=SР,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;09
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М13,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0А
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М11,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0В
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М9,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0С
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М7,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0D
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М5,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0Е
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М3,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0F
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М1,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;10
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=PROCNC,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;11
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=CTR,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;12
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=РССС,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;13
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=YCR,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;14
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=ACR,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;15
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=СТТ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;16
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=RRR,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;17
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=С,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;18
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М14,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;19
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М12,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;1А
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М10,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;1В
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М8,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;1С
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М6,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;1D
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М4,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;1Е
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М2,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;1F
CONT ALUS=ZВ,RВ=А,CI,ALUD=В
CONT CSM,MNSA=МР,MODNM=М0,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
RFCT %TIK%
%J% А=CMOD6E,МАР=РЕ,%TIK%
;
;
МОД6F:ENTRY
;===== ПИШЕМ 00/FF(!) ПО ВСЕМ АДРЕСАМ ПАМЯТИ; АДРЕС МОДИФИКАТОРА - В АИСП.(!)
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РС - N РЕГИСТРА (АИСП)
;   DADR - НОМЕР ГРУППЫ; 0-Й МОДИФИКАТОР НЕ ПРОВЕРЯЕМ.
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD6F,МАР=РЕ
PSMD6F:CONT А=Н6F,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;1 - В РС: НОМЕР РЕГИСТРА В ГРУППЕ
CONT A=C1,DSRC=PROM,ALUS=DZ,ALUD=В,RB=PC,ALU,YDST=ADRREG
;ПИШЕМ CONST В РЕГИСТРЫ; АДРЕС - ИЗ АИСП.
LС6F:CONT ALUS=ZВ,RВ=А,ALU,CSM,WЕМ,MNSA=U,MOD
;СРАВНИВАЕМ С 31 (MAX N РЕГИСТРА В ГРУППЕ), УВЕЛИЧИВАЕМ N РЕГ.
CONT A=H1F,DSRC=PROM,ALUS=DA,RА=РС,FUNC=EXOR,CEN
CJP А=LС6F,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZB,RB=PC,CI,ALUD=B,ALU,YDST=ADRREG
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT A=B6,DSRC=PROM,ALUS=DA,RА=DADR,FUNC=ADD,ALUD=В,RB=DADR,ALU,YDST=MODGN
;
;ЧТЕНИЕ
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
МС6F:PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;АИСП.
CONT A=C1,DSRC=PROM,ALUS=DZ,ALUD=В,RB=PC,ALU,YDST=ADRREG
;ЧИТАЕМ ПЕРЕМЕННУЮ ИЗ ОЗУ МОД.,СРАВНИВАЕМ
NNC6F:CONT CSM,MNSA=U,MOD,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ПИШЕМ В ТОТ ЖЕ РЕГИСТР ИНВЕРТРОВАННУЮ CONST (0 ИЛИ F)
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,CSM,WЕМ,MNSA=U,MOD
;СРАВНИВАЕМ С 31 (MAX N РЕГИСТРА В ГРУППЕ), УВЕЛИЧИВАЕМ N РЕГ.
CONT A=H1F,DSRC=PROM,ALUS=DA,RА=РС,FUNC=EXOR,CEN
CJP А=NNC6F,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZB,RB=PC,CI,ALUD=B,ALU,YDST=ADRREG
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT A=B6,DSRC=PROM,ALUS=DA,RА=DADR,FUNC=ADD,ALUD=В,RB=DADR,ALU,YDST=MODGN
;ИНВЕРТИРУЕМ CONST В РГ.А, СНОВА ИДЕМ НА ПРОВЕРКУ
%J% А=МС6F,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В
;
;
МОД70:ENTRY
;===== ПИШЕМ ДАННЫЕ=АДРЕСУ(!) ПО ВСЕМ АДРЕСАМ ПАМЯТИ; АДРЕС МОДИФ.- В АИСП.
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD70,МАР=РЕ
PSMD70:CONT А=Н70,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А (ДАННЫЕ=АДРЕСУ), В РНГ
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=А,ALU,YDST=MODGN
;НОМЕР РЕГИСТРА - В АИСП.
CONT ALUS=ZА,RA=А,ALU,YDST=ADRREG
;ПИШЕМ АДРЕС В РЕГИСТРЫ
CONT ALUS=ZВ,RВ=А,ALU,CSM,WЕМ,MNSA=U,MOD
;ЕСЛИ МЛ.5 РАЗРЯДОВ АДРЕСА РЕГИСТРА = 0, ПИШЕМ ПО MNSA=МР (0-Й РГ.!)
CONT A=H1F,DSRC=PROM,ALUS=DA,RА=А,FUNC=AND,CEN
CJP А=ECW70,МАР=РЕ,COND=СТ,SТОРС=/NZ
CONT ALUS=ZА,RА=А,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;УВЕЛИЧИВАЕМ ПОЛНЫЙ АДРЕС, ПИШЕМ В РНГ
ECW70:RFCT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,YDST=MODGN
;ЧТЕНИЕ
;0 - В РГ.А (ПОЛНЫЙ АДРЕС РЕГИСТРА), ПИШЕМ В РНГ
МС70:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=А,ALU,YDST=MODGN
;НОМЕР РГ.- В АИСП.
CONT ALUS=ZА,RА=А,ALU,YDST=ADRREG
;ЧИТАЕМ ДАННЫЕ=АДРЕСУ ИЗ ОЗУ МОД.,СРАВНИВАЕМ
CONT CSM,MNSA=U,MOD,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
;УВЕЛИЧИВАЕМ ПОЛНЫЙ АДРЕС, ПИШЕМ В РНГ
RFCT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,YDST=MODGN
%J% А=МС70,МАР=РЕ,%TIK%
;
;
МОД71:ENTRY
;===== ПРОВЕРЯЕМ 0-Й МОДИФИКАТОР
;
;===== ПИШЕМ 0/F - В 0-Й МОДИФИКАТОР (АДР.- В МП); ЧИТАЕМ (АДР.- В АИСП.!!)
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD71,МАР=РЕ
PSMD71:CONT А=Н71,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А, В АИСП.!
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А,ALU,YDST=ADRREG
;ЦИКЛ: ПИШЕМ В 0-Й МОДИФИКТОР
CMOD71:CONT ALUS=ZА,RА=А,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В АИСП.!
CONT CSM,MNSA=U,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ИНВЕРТИРУЕМ РГ.А
%J% А=CMOD71,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В
;
;
МОД72:ENTRY
;===== ПРОВЕРЯЕМ ЗАПРЕТ ЗАПИСИ В 0-Й МОДИФИКАТОР ПО АДРЕСУ ИЗ АИСП.
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ
;   ОШИБКИ: 00 - НЕТ ЗАПИСИ В 0 МОД.ИЗ МП;
;   01 - ЕСТЬ ЗАПИСЬ В 0-Й МОДИФИКАТОР ПО АДРЕСУ ИЗ АИСП., ЧИТАЕМ ИЗ МП.
;   02 -    -   "   -   С ПРИЗНАКОМ MOD, ЧИТАЕМ ПО АДРЕСУ ИЗ МП.
;   03 -    -   "   -   , ЧИТАЕМ ПО АДРЕСУ ИЗ АИСП.
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD72,МАР=РЕ
PSMD72:CONT А=Н72,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А, В АИСП.!
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А,ALU,YDST=ADRREG
;ЦИКЛ: ПИШЕМ В 0-Й МОДИФИКТОР
CMOD72:CONT ALUS=ZА,RА=А,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;INTR = 00: ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В АИСП.!
CONT CSM,MNSA=U,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;ИНВЕРТИРУЕМ РГ.А, ПИШЕМ ПО АИСП.! НЕ Д.БЫТЬ ЗАПИСИ!
CONT ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В,ALU,CSM,WЕМ,MNSA=U
;01: ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В МП.!
CONT CSM,MNSA=МР,MODNM=М0,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ СОВПАДЕНИЕ!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
;ЕЩЕ РАЗ ПИШЕМ ПО АИСП.С ПРИЗНАКОМ MOD! НЕ Д.БЫТЬ ЗАПИСИ!
CONT ALUS=ZA,RA=А,ALU,CSM,WЕМ,MNSA=U,MOD
;02: ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В МП.!
CONT CSM,MNSA=МР,MODNM=М0,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ СОВПАДЕНИЕ!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
;03: ЧИТАЕМ ЕЩЕ РАЗ; АДРЕС МОДИФИКАТОРА - В АИСП.!
CONT CSM,MNSA=U,MOD,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ СОВПАДЕНИЕ!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
%J% А=CMOD72,МАР=РЕ,%TIK%
;
;
МОД73:ENTRY
;===== ПРОВЕРЯЕМ ЗАПРЕТ ЧТЕНИЯ/ЗАПИСИ В МОДИФИКАТОР С N>16 ИЗ АИСП.БЕЗ ПР.MOD
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ
;   ОШИБКИ:
;   00 - НЕТ ЗАПИСИ В 16 МОД.ИЗ МП ИЛИ НЕТ ЧТЕНИЯ ПО АИСП.С ПРИЗНАКОМ MOD;
;   01 - ЕСТЬ ЗАПИСЬ В 16 МОДИФ.ПО АДРЕСУ ИЗ АИСП.БЕЗ MOD, ЧИТАЕМ ИЗ МП;
;   02 - НЕТ ЗАПИСИ В 16 МОДИФ.ПО АДР.ИЗ АИСП.С MOD, ЧИТАЕМ ИЗ МП;
;   03 - ЕСТЬ ЧТЕНИЕ ИЗ 16 МОДИФ.ПО АДР.ИЗ АИСП.БЕЗ ПРИЗНАКА MOD;
;   04 - НЕТ ЧТЕНИЯ ИЗ 16 МОДИФ.ПО АДР.ИЗ АИСП.С ПРИЗНАКОМ MOD.
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD73,МАР=РЕ
PSMD73:CONT А=Н73,%T%
%S% А=INITST,МАР=РЕ
;1 - В РГ.А; 16 - В РГ.DADR, АИСП.
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
CONT ALUS=ZА,RА=А,CI,ALUD=В,RВ=А
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=DADR,ALU,DSRC=SHIFT,MPS,PSHF=SН0-4
>,SHF=LOG
CONT ALUS=ZА,RА=DADR,ALU,YDST=ADRREG
;00:
;ЦИКЛ: ПИШЕМ В 16-Й МОДИФИКТОР (C)
CMOD73:CONT ALUS=ZА,RА=А,ALU,CSM,WЕМ,MNSA=МР,MODNM=C
;ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В АИСП.С ПРИЗНАКОМ MOD!
CONT CSM,MNSA=U,MOD,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01:
;ИНВЕРТИРУЕМ РГ.А, ПИШЕМ ПО АИСП.БЕЗ ПРИЗНАКА MOD! НЕ Д.БЫТЬ ЗАПИСИ!
CONT ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В,ALU,CSM,WЕМ,MNSA=U
;ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В МП.!
CONT CSM,MNSA=МР,MODNM=C,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ СОВПАДЕНИЕ!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
;02:
;ПИШЕМ ЕЩЕ РАЗ ПО АИСП.С ПРИЗНАКОМ MOD! ЗАПИСЬ ДОЛЖНА ПРОЙТИ!
CONT ALUS=ZА,RА=А,ALU,CSM,WЕМ,MNSA=U,MOD
;ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В МП.!
CONT CSM,MNSA=МР,MODNM=C,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ НЕ ЗАПИСАЛОСЬ!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;03:
;ИНВЕРТИРУЕМ  РГ.А, ПИШЕМ ИЗ МП
CONT ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=C
;ЧИТАЕМ, АДРЕС МОДИФИКАТОРА - В АИСП.БЕЗ MOD! НЕ Д.СОВПАСТЬ!
CONT CSM,MNSA=U,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ СОВПАЛО!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
;04:
;ЧИТАЕМ ЕЩЕ РАЗ; АДРЕС МОДИФИКАТОРА - В АИСП.С ПРИЗНАКОМ MOD
CONT CSM,MNSA=U,MOD,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ НЕ ТО!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CMOD73,МАР=РЕ,%TIK%
;
;      =======
;      Р  Н  П
;      =======
;
РНП74:ENTRY
;===== ПИШЕМ 00 ИЛИ FF В РНП; ЧТЕНИЕ В МПС; СРАВНЕНИЕ
;   РГ.А - ЧТО ПИШЕМ; Y - ЧТО ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSDR74,МАР=РЕ
PSDR74:CONT А=Н74,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ В РНП 0 ИЛИ FF ПОПЕРЕМЕННО
CADR74:CONT ALUS=ZB,RB=А,FUNC=EXNOR,H,ALUD=B,ALU,YDST=PROCN
;ЧИТАЕМ РНП, СРАВНИВАЕМ
CONT DSRC=PROCN,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CADR74,МАР=РЕ,%TIK%
;
;
РНП75:ENTRY
;===== ПИШЕМ ПЕРЕМЕННОЕ ЧИСЛО В РНП; ЧТЕНИЕ В МПС; СРАВНЕНИЕ
;   А - ЗАПИСЫВАЕМОЕ ЧИСЛО; Y - ПРОЧИТАННОЕ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSDR75,МАР=РЕ
PSDR75:CONT А=Н75,%T%
%S% А=INITST,МАР=РЕ
;0 - В А;
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ В РНП ПЕРЕМННОЕ ЧИСЛО
CADR75:CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,YDST=PROCN
;ЧИТАЕМ РНП, СРАВНИВАЕМ
CONT DSRC=PROCN,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CADR75,МАР=РЕ,%TIK%
;
;     ==========================
;     РГ. ИСПОЛНИТЕЛЬНОГО АДРЕСА
;     ==========================
;
АИСП76:ENTRY
;===== ПИШЕМ 00 ИЛИ FF В АИСП.; ЧТЕНИЕ В МПС; СРАВНЕНИЕ
;   РГ.А - ЧТО ПИШЕМ; Y - ЧТО ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ.
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSDR76,МАР=РЕ
PSDR76:CONT А=Н76,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ В АИСП. 0 ИЛИ FFFFF ПОПЕРЕМЕННО
CADR76:CONT ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,ALU,YDST=ADRREG
;ЧИТАЕМ АИСП. - В РГ.Y, СРАВНИВАЕМ
CONT YDEV=RADRR,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CADR76,МАР=РЕ,%TIK%
;
;
АИСП77:ENTRY
;===== ПИШЕМ ПЕРЕМЕННОЕ ЧИСЛО В АИСП; ЧТЕНИЕ В МПС; СРАВНЕНИЕ
;   А - ЧТО ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ.
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSDR77,МАР=РЕ
PSDR77:CONT А=Н77,%T%
%S% А=INITST,МАР=РЕ
;0 - В А
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ В АИСП. ПЕРЕМННОЕ ЧИСЛО
CADR77:CONT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,YDST=ADRREG
;ЧИТАЕМ АИСП., СРАВНИВАЕМ
CONT YDEV=RADRR,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CADR77,МАР=РЕ,%TIK%
;
;     =====
;     Р Ф С
;     =====
;
РФС78:ENTRY
;===== ПИШЕМ 00 ИЛИ FF В РФС; ЧТЕНИЕ В МПС; СРАВНЕНИЕ
;   В РФС ПИШЕМ С 11-20 РАЗР.ШИНЫ У; ЧИТАЕМ 11-20 РАЗР.ШИНЫ D.
;   РГ.А - ЧТО ПИШЕМ; Y - ЧТО ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSDR78,МАР=РЕ
PSDR78:CONT А=Н78,%T%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ В РФС 0 ИЛИ FF ПОПЕРЕМЕННО
CADR78:CONT ALUS=ZB,RB=А,FUNC=EXNOR,Н,ALUD=В,ALU,YDST=PHYSPG
;ЧИТАЕМ РФС, СРАВНИВАЕМ
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CADR78,МАР=РЕ,%TIK%
;
;
РФС79:ENTRY
;===== ПИШЕМ ПЕРЕМЕННОЕ ЧИСЛО В РФС; ЧТЕНИЕ В МПС; СРАВНЕНИЕ
;   В РГ.А - ЗАПИСЫВАЕМОЕ ЧИСЛО; Y - ПРОЧИТАННОЕ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSDR79,МАР=РЕ
PSDR79:CONT А=Н79,%T%
%S% А=INITST,МАР=РЕ
;ЦИКЛ: ПИШЕМ В РФС ПЕРЕМННОЕ ЧИСЛО
CADR79:CONT A=B11,DSRC=PROM,ALUS=DА,RА=А,FUNC=ADD,ALUD=B,RB=A,ALU,YDST=PHYSPG
;ЧИТАЕМ РФС, СРАВНИВАЕМ
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CADR79,МАР=РЕ,%TIK%
;
;     =================
;     РЕГИСТРЫ ПРИПИСКИ
;     =================
;
ПРИП7A:ENTRY
;===== ПИШЕМ 0/F(!) В РЕГИСТРЫ ПРИПИСКИ ПО 1 АДРЕСУ, ЧИТАЕМ, СРАВНИВАЕМ
;   РГ.А - ЧТО ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ
;   АДРЕС В АИСП. = CONST ИЗ ПЗУ. = 4-7 РГ.БОПП
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSDR7A,МАР=РЕ
PSDR7A:CONT А=Н7A,%T%
%S% А=INITST,МАР=РЕ
CONT A=H1,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=PC,ALU,YDST=ADRREG
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ РГ.А В РЕГИСТРЫ ПРИПИСКИ
CADR7A:CONT ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В,ALU,YDEV=PSMEM,WRY
;ПИШЕМ АДРЕС В БОПП
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ, СРАВНИВАЕМ
CONT YDEV=PSMEM,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CADR7A,МАР=РЕ,%TIK%
;
;
ПРИП7B:ENTRY
;===== ЗАПИСЬ CONST1,CONST2 В РП ПО 2 АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   1 АДР.- В РС; 2 АДР.- РССОРУ; CONST1-DADR, CONST2-HALF, ПЕРЕПИСЫВАЮТСЯ В А;
;   Y - ЧТЕНИЕ ПО 1 АДРЕСУ И ПО 2-ОМУ. Q - РЕЗ-Т СРАВНЕНИЯ;
;   ОШ.: 00 - НЕСОВПАДЕНИЕ ПО 1-ОМУ АДРЕСУ; 01 - ПО 2-ОМУ; АДРЕС = 4-7 РГ.БОПП
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 20 РАЗР.)
;
CJP А=PSDR7B,МАР=РЕ
PSDR7B:CONT А=Н7B,%T%
%S% А=INITST,МАР=РЕ
;ПИШЕМ: 1-Й АДРЕС ИЗ ПЗУ - В РГ.РС МПС, В АИСП.
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG
;CONST1 - В DADR, В РП
CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,YDEV=PSMEM,WRY
;2-Й АДРЕС - В РССОРУ, В АИСП.
CONT А=В13,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,ALU,YDST=ADRREG
;CONST2 - В HALF, В РП
CONT А=CFFF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF,ALU,YDEV=PSMEM,WRY
;ЧИТАЕМ: 1-Й АДРЕС - В АИСП., В БОПП
CADR7B:CONT ALUS=ZА,RА=РС,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
;ЧИТАЕМ ИЗ РП - ЧЕРЕЗ СДВИГАТЕЛЬ - В РГ.Y МПС, СРАВНИВАЕМ
CONT YDEV=PSMEM,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;АНАЛОГИЧНО СО 2 АДРЕСОМ
CONT ALUS=ZА,RА=РССОРУ,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=HALF,H,ALUD=B,RB=A
CONT YDEV=PSMEM,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CADR7B,МАР=РЕ,%TIK%
;
;
ПPИП7C:ENTRY
;===== ЗАПИСЬ CONST,/CONST В РП ПО ВСЕМ АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   А - ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ; РС = АДРЕС РП = 4-7 РГ.БОПП
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 20 РАЗР.)
;
CJP А=PSDR7C,МАР=РЕ
PSDR7C:CONT А=H7C,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ
CONT A=ZER,ALUS=DZ,H,ALUD=B,RB=A
;"0" - В РГ.РС, В АИСП.
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG
;ПИШЕМ "CONST" ИЗ РГ.А - В РП
CONT ALUS=ZА,RА=А,ALU,YDEV=PSMEM,WRY
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=ADRREG
;ЦИКЛ НА ЧТЕНИЕ И НОВУЮ ЗАПИСЬ ИНВЕРТИРОВАННОЙ CONST: НАЧ.АДРЕС - В РС, АИСП
CADR7C:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG
;ПИШЕМ АДРЕС В БОПП
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ РП, СРАВНИВАЕМ
CONT YDEV=PSMEM,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ПИШЕМ ПО ТОМУ ЖЕ АДРЕСУ ИНВЕРТИРОВАННУЮ CONST, УВЕЛИЧИВАЕМ АДРЕС
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,YDEV=PSMEM,WRY
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=ADRREG
;ИНВЕРТИРУЕМ CONST, ИДЕМ НА НОВУЮ ПРОВЕРКУ
%J% А=CADR7C,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,Н,ALUD=В
;
;
ПРИП7D:ENTRY
;===== ЗАПИСЬ ДАННЫХ=АДРЕСУ В РП ПО ВСЕМ АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   А - АДРЕС РП = ЧТО ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   4-7 РГ.БОПП = АДРЕС БОПП;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 20 РАЗР.)
;
CJP А=PSDR7D,МАР=РЕ
PSDR7D:CONT А=Н7D,%T%
%S% А=INITST,МАР=РЕ
;"0" - В РГ.А, В АИСП.
PUSH A=1023,MAP=PE,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,ALU,YDST=ADRREG
;ДАННЫЕ = АДРЕСУ - В РП
CONT ALUS=ZА,RА=А,ALU,YDEV=PSMEM,WRY
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=А,FUNC=ADD,ALUD=В,RB=A,ALU,YDST=ADRREG
;0 - B РГ.А (АДРЕС И ДАННЫЕ)
CADR7D:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,ALU,YDST=ADRREG
;ПИШЕМ АДРЕС В БОПП
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=A,H,ALUD=B,RB=WR6
;ЧИТАЕМ РП, СРАВНИВАЕМ
CONT YDEV=PSMEM,DSRC=SHIFT,MPS,PSHF=SН0,SHF=LOG,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=А,FUNC=ADD,ALUD=В,RB=A,ALU,YDST=ADRREG
%J% А=CADR7D,МАР=РЕ
;
;
ПPИП7E:ENTRY
;===== ЗАПИСЬ ДАННЫХ=ИНВЕРТИР.АДРЕСУ В РП ПО ВСЕМ АДРЕСАМ В ОБРАТНОМ НАПРАВЛЕНИИ
;   А - ЧТО ПИСАЛИ (=/РС); Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   РС - АДРЕС РП = 4-7 РГ.БОПП
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 20 РАЗР.)
;
CJP А=PSDR7E,МАР=РЕ
PSDR7E:CONT А=H7E,%T%
%S% А=INITST,МАР=РЕ
;"FF..FF" - В РГ.РС, В АИСП (НАЧАЛЬНЫЙ АДРЕС ДЛЯ ЗАПИСИ В ОБРАТНОМ НАПРАВЛЕНИИ)
CONT A=CFFF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG
PUSH А=1023,МАР=РЕ
;ДАННЫЕ = ИНВЕРТИРОВАННОМУ АДРЕСУ - В РП
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,YDEV=PSMEM,WRY
;УМЕНЬШАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=ADRREG
;"FF..FF" - В РС
CADR7E:CONT A=CFFF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG
PUSH А=1023,МАР=РЕ
;ПИШЕМ АДРЕС В БОПП
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ВЫЧИСЛЯЕМ ИНВЕРТИР.АДРЕС, КОТОРЫЙ = ДАННЫМ
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALUD=В,RВ=А
;ЧИТАЕМ РП, СРАВНИВАЕМ
CONT YDEV=PSMEM,DSRC=SHIFT,MPS,PSHF=SН0,SHF=LOG,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=ADRREG
%J% А=CADR7E,МАР=РЕ
;
;     =================
;     Б О Б Р,  Б И З М
;     =================
;
БОБИ7F:ENTRY
;===== ПИШЕМ 0/F В БОБР,БИЗМ ПО 1 АДРЕСУ, ЧИТАЕМ, СРАВНИВАЕМ
;   РГ.А - ЧТО ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; AДРЕС В РФС = 4/7 РГ.БОПП
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 2,3 РАЗР.)
;
CJP А=PSAD7F,МАР=РЕ
PSAD7F:CONT А=Н7F,%T%
%S% А=INITST,МАР=РЕ
;CONST - В РГ.А
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=В,RВ=А
;АДРЕС ИЗ ПЗУ - В РГ.РС МПС, В РФС, В 4-7 РГ.БОПП
CONT А=B11,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ПИШЕМ РГ.А В БОБР,БИЗМ
CADR7F:CONT ALUS=ZА,RА=А,ALU,%TRSH%,DDEV=ВВ,WRD
;ЧИТАЕМ, СРАВНИВАЕМ
CONT DDEV=ВВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H6,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ИНВЕРТИРУЕМ РГ.А
%J% А=CADR7F,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В
;
;
БОБИ80:ENTRY
;===== ЗАПИСЬ CONST1,CONST2 В БОБР,БИЗМ ПО 2 АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   1 АДР.- В РС; 2 АДР.- РССОРУ; CONST1-DADR,CONST2-HALF, ПЕРЕПИСЫВАЮТСЯ В А;
;   Y - ЧТЕНИЕ ПО 1 АДРЕСУ И ПО 2-ОМУ. Q - РЕЗ-Т СРАВНЕНИЯ
;   ОШИБКИ: 00 - ОШИБОЧНОЕ ЧТЕНИЕ ПО 1-ОМУ АДРЕСУ; 01 - ПО 2-ОМУ;
;   11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 2,3 РАЗР.), 4-7 = АДРЕС.
;
CJP А=PSAD80,МАР=РЕ
PSAD80:CONT А=Н80,%T%
%S% А=INITST,МАР=РЕ
;ПИШЕМ: 1-Й АДРЕС ИЗ ПЗУ - В РГ.РС МПС, В РФС
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;CONST1 - В DADR, В БОБР,БИЗМ
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD,ALUS=DZ,Н,ALUD=В,RВ=DADR
;2-Й АДРЕС - В РССОРУ, В РФС
CONT А=В13,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,ALU,YDST=PHYSPG
;CONST2 - В HALF, В БОБР,БИЗМ
CONT А=CFFF,DSRC=PROM,DDEV=ВВ,WRD,ALUS=DZ,Н,ALUD=В,RВ=HALF
;ЧИТАЕМ: 1-Й АДРЕС - В РФС, В БОПП
CADR80:CONT ALUS=ZА,RА=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=DADR,ALUD=B,RB=A
;ЧИТАЕМ БОБР,БИЗМ В РГ.Y МПС, СРАВНИВАЕМ
CONT DDEV=ВВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H6,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;АНАЛОГИЧНО СО 2 АДРЕСОМ
CONT ALUS=ZА,RА=РССОРУ,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=HALF,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H6,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CADR80,МАР=РЕ,%TIK%
;
;
БОБИ81:ENTRY
;===== ЗАПИСЬ CONST,/CONST В БОБР,БИЗМ ПО ВСЕМ АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   А - ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ; РС - АДРЕС = 4-7 РГ.БОПП.
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 2,3 РАЗР.)
;
CJP А=PSAD81,МАР=РЕ
PSAD81:CONT А=Н81,%T%
%S% А=INITST,МАР=РЕ
;CONST - B РГ.A, "0" - В РГ. РС, РФС
CONT A=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;ПИШЕМ "CONST" ИЗ РГ.А - В БОБР,БИЗМ
CONT ALUS=ZА,RА=А,ALU,%TRSH%,DDEV=ВВ,WRD
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЦИКЛ НА ЧТЕНИЕ И НОВУЮ ЗАПИСЬ ИНВЕРТИРОВАННОЙ CONST
;НАЧАЛЬНЫЙ АДРЕС - В РС, В РФС, В БОПП
CADR81:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ БОБР,БИЗМ, СРАВНИВАЕМ
CONT DDEV=ВВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H6,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ПИШЕМ ПО ТОМУ ЖЕ АДРЕСУ ИНВЕРТИРОВАННУЮ CONST, УВЕЛИЧИВАЕМ АДРЕС
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,%TRSH%,DDEV=ВВ,WRD
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ИНВЕРТИРУЕМ CONST, ИДЕМ НА НОВУЮ ПРОВЕРКУ
%J% А=CADR81,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,Н,ALUD=В
;
;
БОБИ82:ENTRY
;===== ЗАПИСЬ ДАННЫХ=СДВИНУТОМУ АДРЕСУ В БОБР,БИЗМ ПО ВСЕМ АДРЕСАМ, ПРОВЕРКА
;   РС - АДРЕС БОБР,БИЗМ = РФС = 4-7 РГ.БОПП;
;   А = ЧТО ПИШЕМ = РС, СДВИНУТОМУ В МЛ.РАЗРЯДЫ; Y - ЧТО ЧИТАЕМ;
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 2,3 РАЗР.)
;
CJP А=PSAD82,МАР=РЕ
PSAD82:CONT А=Н82,%T%
%S% А=INITST,МАР=РЕ
;"0" - В РГ.РС, В РФС
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;ДАННЫЕ = СДВИНУТОМУ АДРЕСУ - В БОБР,БИЗМ
CONT ALUS=ZА,RА=РС,ALU,DSRC=SHIFT,MPS,PSHF=SН0+10,SHF=LOG,DDEV=ВВ,WRD
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЧИТАЕМ; 0 - B РС, B БОПП
CADR82:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ВЫЧИСЛЯЕМ СДВИНУТЫЙ АДРЕС - В РГ.А
CONT ALUS=DZ,Н,ALUD=ВА,RА=РС,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+10,SHF=LOG
;ЧИТАЕМ БОБР,БИЗМ, СРАВНИВАЕМ
CONT DDEV=ВВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H6,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
%J% А=CADR82,МАР=РЕ
;
;
БОБИ83:ENTRY
;===== ЗАПИСЬ ДАННЫХ=ИНВЕРТИР.АДРЕСУ В БОБР,БИЗМ В ОБРАТНОМ НАПРАВЛЕНИИ
;   А - ЧТО ПИСАЛИ (=/РС, СДВИНУТОМУ В МЛ.РАЗРЯДЫ); Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   Y - ЧИТАЕМ; РС - АДРЕС БОБР,БИЗМ = 4-7 РГ.БОПП;
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 2,3 РАЗР.)
;
CJP А=PSAD83,МАР=РЕ
PSAD83:CONT А=Н83,%T%
%S% А=INITST,МАР=РЕ
;"FF..FF" - В РГ.РС, В РФС (НАЧАЛЬНЫЙ АДРЕС ДЛЯ ЗАПИСИ В ОБРАТНОМ НАПРАВЛЕНИИ)
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=В,RB=PC,ALU,YDST=PHYSPG
PUSH А=1023,МАР=РЕ
;ДАННЫЕ = ИНВЕРТИРОВАННОМУ АДРЕСУ, СДВИНУТОМУ В МЛ.РАЗРЯДЫ - В БОБР,БИЗМ
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,DSRC=SHIFT,MPS,PSHF=SН0+10,SHF=LOG,DDEV=ВВ,WRD
;УМЕНЬШАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЧИТАЕМ. "FF..FF" - В РС
CADR83:CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=В,RB=PC,ALU,YDST=PHYSPG
PUSH А=1023,МАР=РЕ
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ВЫЧИСЛЯЕМ ИНВЕРТИР.АДРЕС, СДВИГАЕМ В МЛАДШИЕ РАЗРЯДЫ
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALUD=В,RВ=А
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+10,SHF=LOG
;ЧИТАЕМ БОБР,БИЗМ, СРАВНИВАЕМ
CONT DDEV=ВВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H6,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=PHYSPG
%J% А=CADR83,МАР=РЕ
;
;     =======
;     Б М С П
;     =======
;
БМСП84:ENTRY
;===== ПИШЕМ 0/1 В БМСП ПО 1 АДРЕСУ, ЧИТАЕМ, СРАВНИВАЕМ
;   РГ.А - ЧТО ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   АДРЕС В РФС = CONST ИЗ ПЗУ = 4/7 РГ.БОПП;
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 1-Й РАЗРЯД)
;
CJP А=PSAD84,МАР=РЕ
PSAD84:CONT А=Н84,%T%
%S% А=INITST,МАР=РЕ
;АДРЕС ИЗ ПЗУ - В РГ.РС МПС, В РФС, В 4-7 РГ.БОПП
CONT А=B12,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ РГ.А В БМСП
CADR84:CONT ALUS=ZА,RА=А,ALU,%TRSH%,DDEV=MODB,WRD
;ЧИТАЕМ, СРАВНИВАЕМ
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ИНВЕРТИРУЕМ РГ.А
%J% А=CADR84,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В
;
;
БМСП85:ENTRY
;===== ЗАПИСЬ CONST1,CONST2 В БМСП ПО 2 АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   1 АДР.- В РС; 2 АДР.- РССОРУ; CONST1-DADR; CONST2-HALF, ПЕРЕПИСЫВАЮТСЯ В А!
;   Y - ЧТЕНИЕ ПО 1 АДРЕСУ И ПО 2-ОМУ. Q - РЕЗ-Т СРАВНЕНИЯ.
;   ОШИБКИ: 00 - НЕСОВПАДЕНИЕ ПО 1-ОМУ АДРЕСУ; 01 - ПО 2-ОМУ; АДР.= 4-7 РГ.БОПП;
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 1-Й РАЗРЯД)
;
CJP А=PSAD85,МАР=РЕ
PSAD85:CONT А=Н85,%T%
%S% А=INITST,МАР=РЕ
;ПИШЕМ: 1-Й АДРЕС ИЗ ПЗУ - В РГ.РС МПС, В РФС
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;CONST1 - В DADR, В БМСП
CONT А=ZER,DSRC=PROM,DDEV=MODB,WRD,ALUS=DZ,Н,ALUD=В,RВ=DADR
;2-Й АДРЕС - В РССОРУ, В РФС
CONT А=В13,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,ALU,YDST=PHYSPG
;CONST2 - В HALF, В БМСП
CONT А=CFFF,DSRC=PROM,DDEV=MODB,WRD,ALUS=DZ,Н,ALUD=В,RВ=HALF
;ЧИТАЕМ: 1-Й АДРЕС - В РФС, В БОПП
CADR85:CONT ALUS=ZА,RА=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
;ЧИТАЕМ БМСП В РГ.Y МПС, СРАВНИВАЕМ
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;АНАЛОГИЧНО СО 2 АДРЕСОМ
CONT ALUS=ZА,RА=РССОРУ,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=HALF,H,ALUD=B,RB=A
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CADR85,МАР=РЕ,%TIK%
;
;
БМСП86:ENTRY
;===== ЗАПИСЬ 0/F В БМСП ПО ВСЕМ АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   А - ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ; РС - АДРЕС = 4-7 РГ.БОПП;
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 1-Й РАЗРЯД)
;
CJP А=PSAD86,МАР=РЕ
PSAD86:CONT А=Н86,%T%
%S% А=INITST,МАР=РЕ
;"0" - В РГ.А, РС, РФС
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;ПИШЕМ ИЗ РГ.А - В БМСП
CONT ALUS=ZА,RА=А,ALU,%TRSH%,DDEV=MODB,WRD
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЦИКЛ НА ЧТЕНИЕ И НОВУЮ ЗАПИСЬ ИНВЕРТИРОВАННОЙ CONST
CADR86:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ БМСП В РГ.Y МПС, СРАВНИВАЕМ
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ПИШЕМ ПО ТОМУ ЖЕ АДРЕСУ ИНВЕРТИРОВАННУЮ CONST
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,%TRSH%,DDEV=MODB,WRD
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ИНВЕРТИРУЕМ CONST, ИДЕМ НА НОВУЮ ПРОВЕРКУ
%J% А=CADR86,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,Н,ALUD=В
;
;
БМСП87:ENTRY
;===== ЗАПИСЬ ДАННЫХ=СДВИНУТОМУ АДРЕСУ В БМСП ПО ВСЕМ АДРЕСАМ, ПРОВЕРКА
;   РС - АДРЕС БМСП; А = ЧТО ПИШЕМ = РС, СДВИНУТОМУ В МЛ.РАЗР.= 4-7 РГ.БОПП;
;   Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 1-Й РАЗРЯД)
;
CJP А=PSAD87,МАР=РЕ
PSAD87:CONT А=Н87,%T%
%S% А=INITST,МАР=РЕ
;"0" - В РГ.РС, В РФС
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
PUSH А=1023,МАР=РЕ
;ДАННЫЕ = СДВИНУТОМУ АДРЕСУ - В БМСП
CONT ALUS=ZА,RА=РС,ALU,DSRC=SHIFT,MPS,PSHF=SН0+10,SHF=LOG,DDEV=MODB,WRD
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЧИТАЕМ. 0 - B РС, В БОПП
CADR87:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ВЫЧИСЛЯЕМ СДВИНУТЫЙ АДРЕС - В РГ.А
CONT ALUS=DZ,Н,ALUD=ВА,RА=РС,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+10,SHF=LOG
;ЧИТАЕМ БМСП, СРАВНИВАЕМ
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
%J% А=CADR87,МАР=РЕ
;
;
БМСП88:ENTRY
;===== ЗАПИСЬ ДАННЫХ=ИНВЕРТИР.АДРЕСУ В БМСП В ОБРАТНОМ НАПРАВЛЕНИИ
;   А - ЧТО ПИСАЛИ (=/РС, СДВИНУТОМУ В МЛ.РАЗРЯДЫ); Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   Y - ЧИТАЕМ; РС - АДРЕС БМСП = 4-7 РГ.БОПП;
;   ПРИ ОШ. 11 РГ.БОПП = A (ЧТО ПИШЕМ), 15 = Y (ЧТО ПРОЧИТАЛИ, 1-Й РАЗРЯД)
;
CJP А=PSAD88,МАР=РЕ
PSAD88:CONT А=Н88,%T%
%S% А=INITST,МАР=РЕ
;"FF..FF" - В РГ.РС, В РФС (НАЧАЛЬНЫЙ АДРЕС ДЛЯ ЗАПИСИ В ОБРАТНОМ НАПРАВЛЕНИИ)
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=В,RB=PC,ALU,YDST=PHYSPG
PUSH А=1023,МАР=РЕ
;ДАННЫЕ = ИНВЕРТИРОВАННОМУ АДРЕСУ, СДВИНУТОМУ В МЛ.РАЗРЯДЫ - В БМСП
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,DSRC=SHIFT,MPS,PSHF=SН0+10,SHF=LOG,DDEV=MODB
>,WRD
;УМЕНЬШАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЧИТАЕМ. "FF..FF" - В РС
CADR88:CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=В,RB=PC,ALU,YDST=PHYSPG
PUSH А=1023,МАР=РЕ
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ВЫЧИСЛЯЕМ ИНВЕРТИР.АДРЕС, СДВИГАЕМ В МЛАДШИЕ РАЗРЯДЫ
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALUD=В,RВ=А
CONT ALUS=DZ,Н,ALUD=ВА,RА=А,RВ=А,ALU,DSRC=SHIFT,MPS,PSHF=SН0+10,SHF=LOG
;ЧИТАЕМ БМСП, СРАВНИВАЕМ
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=PHYSPG
%J% А=CADR88,МАР=РЕ
;
;     ============================
;     О З У  ПРИОРИТЕТОВ СТРАНИЦ 0
;     ============================
;
ПC089:ENTRY
;===== ПИШЕМ 0/F В ОЗУ ПРИОРИТЕТОВ СТРАНИЦ 0 ПО 1 АДРЕСУ, ЧИТАЕМ, СРАВНИВАЕМ
;   РГ.А - ЧТО ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ, СРАВНИВАЕМ 12 РАЗРЯДОВ.
;   АДРЕС В РФС = CONST ИЗ ПЗУ = 4/7 РГ.БОПП;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD89,МАР=РЕ
PSAD89:CONT А=H89,%T%
%S% А=INITST,МАР=РЕ
;АДРЕС ИЗ ПЗУ - В РГ.РС МПС, В РФС, В 4-7 РГ.БОПП
CONT А=B12,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ РГ.А В ОЗУ ПС0
CADR89:CONT ALUS=ZА,RА=А,ALU,DDEV=РРМЕМ0,WRD
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ, СРАВНИВАЕМ
CONT DDEV=PPMEM0,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ИНВЕРТИРУЕМ РГ.А
%J% А=CADR89,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В
;
;
ПС08A:ENTRY
;===== ЗАПИСЬ CONST1,CONST2 В ОЗУ ПС0 ПО 2 АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   1 АДР.- РС; 2 АДР.- РССОРУ; CONST1-DADR; CONST2-HALF; ПЕРЕПИСЫВАЮТСЯ В РГ.A
;   Y - ЧТЕНИЕ ПО 1 АДРЕСУ И ПО 2-ОМУ. Q - РЕЗ-Т СРАВНЕНИЯ.
;   ОШИБКИ: 0 - НЕСОВПАДЕНИЕ ПО 1-ОМУ АДРЕСУ; 1 - ПО 2-ОМУ; АДРЕС = 4-7 РГ.БОПП
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD8A,МАР=РЕ
PSAD8A:CONT А=Н8A,%T%
%S% А=INITST,МАР=РЕ
;ПИШЕМ: 1-Й АДРЕС ИЗ ПЗУ - В РГ.РС МПС, В РФС
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;CONST1 - В DADR, В ОЗУ ПС0
CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,DDEV=РРМЕМ0,WRD
;2-Й АДРЕС - В РССОРУ, В РФС
CONT А=В13,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,ALU,YDST=PHYSPG
;CONST2 - В HALF, В ОЗУ ПС0
CONT А=CFFF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF,ALU,DDEV=РРМЕМ0,WRD
;ЧИТАЕМ: 1-Й АДРЕС - В РФС, В БОПП
CADR8A:CONT ALUS=ZА,RА=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
;ЧИТАЕМ ИЗ ОЗУ ПС0 - В РГ.Y МПС, СРАВНИВАЕМ
CONT DDEV=PPMEM0,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;АНАЛОГИЧНО СО 2 АДРЕСОМ
CONT ALUS=ZА,RА=РССОРУ,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=HALF,H,ALUD=B,RB=A
CONT DDEV=PPMEM0,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CADR8A,МАР=РЕ,%TIK%
;
;
ПC08B:ENTRY
;===== ЗАПИСЬ 0/F В ОЗУ ПС0 ПО ВСЕМ АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   А - ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ; РС - АДРЕС ОЗУ = 4-7 РГ.БОПП
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD8B,МАР=РЕ
PSAD8B:CONT А=H8B,%T%
%S% А=INITST,МАР=РЕ
;"0" - В РГ.А, РС, РФС
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;ПИШЕМ "0" ИЗ РГ.А - В ОЗУ ПС0
CONT ALUS=ZА,RА=А,ALU,DDEV=РРМЕМ0,WRD
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЦИКЛ НА ЧТЕНИЕ И НОВУЮ ЗАПИСЬ ИНВЕРТИРОВАННОЙ CONST
CADR8B:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ ОЗУ ПС0, СРАВНИВАЕМ
CONT DDEV=PPMEM0,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ПИШЕМ ПО ТОМУ ЖЕ АДРЕСУ ИНВЕРТИРОВАННУЮ CONST, УВЕЛИЧИВАЕМ АДРЕС
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,DDEV=РРМЕМ0,WRD
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ИНВЕРТИРУЕМ CONST, ИДЕМ НА НОВУЮ ПРОВЕРКУ
%J% А=CADR8B,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,Н,ALUD=В
;
;
ПС08C:ENTRY
;===== ЗАПИСЬ ДАННЫХ=АДРЕСУ В ОЗУ ПС0 ПО ВСЕМ АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   А - АДРЕС ОЗУ = 4-7 РГ.БОПП = ЧТО ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD8C,МАР=РЕ
PSAD8C:CONT А=Н8C,%T%
%S% А=INITST,МАР=РЕ
;"0" - В РГ.А, В РФС.
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,ALU,YDST=PHYSPG
;ПИШЕМ ДАННЫЕ = АДРЕСУ
CONT ALUS=ZА,RА=А,ALU,DDEV=РРМЕМ0,WRD
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЧИТАЕМ; 0 - В РГ.А, В 4-7 РГ.БОПП
CADR8C:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=A,H,ALUD=B,RB=WR6
;ЧИТАЕМ ОЗУ ПС0, СРАВНИВАЕМ
CONT DDEV=PPMEM0,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
%J% А=CADR8C,МАР=РЕ
;
;
ПС08D:ENTRY
;===== ЗАПИСЬ ДАННЫХ=ИНВЕРТ.АДРЕСУ В ОЗУ ПС0 ПО ВСЕМ АДРЕСАМ В ОБРАТНОМ НАПРАВЛ.
;   А - ЧТО ПИСАЛИ (=/РС); Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   РС - АДРЕС ОЗУ = 4-7 РГ.БОПП;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD8D,МАР=РЕ
PSAD8D:CONT А=Н8D,%T%
%S% А=INITST,МАР=РЕ
;"FF..FF" - В РГ.РС, В РФС (НАЧАЛЬНЫЙ АДРЕС ДЛЯ ЗАПИСИ В ОБРАТНОМ НАПРАВЛЕНИИ)
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=В,RB=PC,ALU,YDST=PHYSPG
PUSH А=1023,МАР=РЕ
;ДАННЫЕ = ИНВЕРТИРОВАННОМУ АДРЕСУ - В ОЗУ ПС0
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,DDEV=РРМЕМ0,WRD
;УМЕНЬШАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЧИТАЕМ. "FF..FF" - В РС
CADR8D:CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
PUSH А=1023,МАР=РЕ
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ВЫЧИСЛЯЕМ ИНВЕРТИР.АДРЕС
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALUD=В,RВ=А
;ЧИТАЕМ ОЗУ ПС0, СРАВНИВАЕМ
CONT DDEV=PPMEM0,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=PHYSPG
%J% А=CADR8D,МАР=РЕ
;
;     ============================
;     О З У  ПРИОРИТЕТОВ СТРАНИЦ 1
;     ============================
;
ПС18E:ENTRY
;===== ПИШЕМ CONST,/CONST В ОЗУ ПРИОРИТЕТОВ СТРАНИЦ 1 ПО 1 АДРЕСУ
;   РГ.А - ЧТО ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ, СРАВНИВАЕМ 12 РАЗРЯДОВ.
;   АДРЕС В РФС = CONST ИЗ ПЗУ = 4/7 РГ.БОПП;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD8E,МАР=РЕ
PSAD8E:CONT А=Н8E,%T%
%S% А=INITST,МАР=РЕ
;АДРЕС ИЗ ПЗУ - В РГ.РС МПС, В РФС, В 4-7 РГ.БОПП
CONT А=B12,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;CONST - В РГ.А
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=В,RВ=А
;ЦИКЛ: ПИШЕМ РГ.А В ОЗУ ПС1
CADR8E:CONT ALUS=ZА,RА=А,ALU,DDEV=РРМЕМ1,WRD
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ, СРАВНИВАЕМ
CONT DDEV=PPMEM1,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ИНВЕРТИРУЕМ РГ.А
%J% А=CADR8E,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В
;
;
ПС18F:ENTRY
;===== ЗАПИСЬ CONST1,CONST2 В ОЗУ ПС1 ПО 2 АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   1 АДР.- РС; 2 АДР.- РССОРУ; CONST1-DADR, CONST2-HALF, ПЕРЕПИСЫВАЮТСЯ В А.
;   Y - ЧТЕНИЕ ПО 1 АДРЕСУ И ПО 2-ОМУ. Q - РЕЗ=Т СРАВНЕНИЯ.
;   ОШИБКИ: 0 - НЕСОВПАДЕНИЕ ПО 1-ОМУ АДРЕСУ; 1 - ПО 2-ОМУ; АДРЕС = 4-7 РГ.БОПП
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD8F,МАР=РЕ
PSAD8F:CONT А=Н8F,%T%
%S% А=INITST,МАР=РЕ
;ПИШЕМ: 1-Й АДРЕС ИЗ ПЗУ - В РГ.РС МПС, В РФС
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;CONST1 - В DADR, В ОЗУ ПС1
CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,DDEV=РРМЕМ1,WRD
;2-Й АДРЕС - В РССОРУ, В РФС
CONT А=В13,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,ALU,YDST=PHYSPG
;CONST2 - В HALF, В ОЗУ ПС1
CONT А=CFFF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF,ALU,DDEV=РРМЕМ1,WRD
;ЧИТАЕМ: 1-Й АДРЕС - В РФС
CADR8F:CONT ALUS=ZА,RА=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
;ЧИТАЕМ ИЗ ОЗУ ПС1 - В РГ.Y МПС, СРАВНИВАЕМ
CONT DDEV=PPMEM1,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;АНАЛОГИЧНО СО 2 АДРЕСОМ
CONT ALUS=ZА,RА=РССОРУ,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=WR6
CONT ALUS=ZA,RA=HALF,H,ALUD=B,RB=A
CONT DDEV=PPMEM1,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CADR8F,МАР=РЕ,%TIK%
;
;
ПС190:ENTRY
;===== ЗАПИСЬ CONST,/CONST В ОЗУ ПС1 ПО ВСЕМ АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   А - ПИШЕМ; Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ; РС - АДРЕС ОЗУ = 4-7 РГ.БОПП
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD90,МАР=РЕ
PSAD90:CONT А=Н90,%T%
%S% А=INITST,МАР=РЕ
;CONST - В РГ.А; "0" - В РГ.РС, В РФС
CONT A=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;ПИШЕМ CONST ИЗ РГ.А - В ОЗУ ПС1
CONT ALUS=ZА,RА=А,ALU,DDEV=РРМЕМ1,WRD
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЦИКЛ НА ЧТЕНИЕ И НОВУЮ ЗАПИСЬ ИНВЕРТИРОВАННОЙ CONST
CADR90:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ ОЗУ ПС1, СРАВНИВАЕМ
CONT DDEV=PPMEM1,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ПИШЕМ ПО ТОМУ ЖЕ АДРЕСУ ИНВЕРТИРОВАННУЮ CONST, УВЕЛИЧИВАЕМ АДРЕС
CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALU,DDEV=РРМЕМ1,WRD
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ИНВЕРТИРУЕМ CONST, ИДЕМ НА НОВУЮ ПРОВЕРКУ
%J% А=CADR90,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,Н,ALUD=В
;
;
ПС191:ENTRY
;===== ЗАПИСЬ ДАННЫХ=АДРЕСУ В ОЗУ ПС1 ПО ВСЕМ АДРЕСАМ, ЧТЕНИЕ, СРАВНЕНИЕ
;   А - АДРЕС ОЗУ ПС1 = ЧТО ПИШЕМ; Y - ЧТО ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   РС - АДРЕС ОЗУ = 4-7 РГ.БОПП;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD91,МАР=РЕ
PSAD91:CONT А=Н91,%T%
%S% А=INITST,МАР=РЕ
;"0" - В РГ.А, В РФС
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,ALU,YDST=PHYSPG
;ДАННЫЕ = АДРЕСУ - В ОЗУ ПС1
CONT ALUS=ZА,RА=А,ALU,DDEV=РРМЕМ1,WRD
;УВЕЛИЧИВАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЧИТАЕМ. 0 - В РГ.А
CADR91:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=A,H,ALUD=B,RB=WR6
;ЧИТАЕМ ОЗУ ПС1, СРАВНИВАЕМ
CONT DDEV=PPMEM1,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
%J% А=CADR91,МАР=РЕ
;
;
ПС192:ENTRY
;===== ЗАПИСЬ ДАННЫХ=ИНВЕРТ.АДРЕСУ В ОЗУ ПС1 ПО ВСЕМ АДРЕСАМ В ОБРАТНОМ НАПРАВЛ.
;   А - ЧТО ПИСАЛИ (=/РС); Y - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   РС - АДРЕС ОЗУ = 4-7 РГ.БОПП;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ, 11-20 PАЗР.)
;
CJP А=PSAD92,МАР=РЕ
PSAD92:CONT А=Н92,%T%
%S% А=INITST,МАР=РЕ
;"FF..FF" - В РГ.РС, В РФС (НАЧАЛЬНЫЙ АДРЕС ДЛЯ ЗАПИСИ В ОБРАТНОМ НАПРАВЛЕНИИ)
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=В,RB=PC,ALU,YDST=PHYSPG
PUSH А=1023,МАР=РЕ
;ДАННЫЕ = ИНВЕРТИРОВАННОМУ АДРЕСУ - В ОЗУ ПС1
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,DDEV=РРМЕМ1,WRD
;УМЕНЬШАЕМ АДРЕС
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЧИТАЕМ. "FF..FF" - В РС
CADR92:CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=В,RB=PC,ALU,YDST=PHYSPG
PUSH А=1023,МАР=РЕ
;ВЫЧИСЛЯЕМ ИНВЕРТИР.АДРЕС
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALUD=В,RВ=А
;ЧИТАЕМ ОЗУ ПС1, СРАВНИВАЕМ
CONT DDEV=PPMEM1,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RА=РС,FUNC=SUBR,CI,ALUD=В,RB=PC,ALU,YDST=PHYSPG
%J% А=CADR92,МАР=РЕ
;
;
LD93:ENTRY
;===== ПРОВЕРКА АВТОМАТИЧЕСКОЙ ЗАГРУЗКИ ОЗУ БМСП "1", НАЧИНАЯ С 0-ОГО АДРЕСА
;   A - ЧТО Д.БЫТЬ; У - ПРОЧИТАННОЕ ИЗ БМСП; ПРОВЕРЯЕМ АДРЕСА, = ОБ'ЕМУ ПАМЯТИ
;   PC - АДРЕС = АДРЕС В 11-20 РАЗРЯДАХ, = 4-7 РГ.БОПП
;   ПРИ ОШ. 11 РГ.БОПП = ЧТО Д.БЫТЬ; 15РГ., МЛ.РАЗРЯД = ЧТО ПРОЧИТАЛИ;
;   INTR = 00 - ПРОВЕРЯЕМ ЗАПИСЬ "0" В ОЗУ; 01: ЖДЕМ КОНЦА ЗАГРУЗКИ;
;          02 - ПРОВЕРЯЕМ ЗАГРУЗКУ "1" В ОЗУ.
;
CJP А=PSAD93,МАР=РЕ
PSAD93:CONT А=Н93,%T%
%S% А=INITST,МАР=РЕ
;ЗАПИСЫВАЕМ В ОЗУ БМСП 0:
CAD93:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,H,ALUD=В,RВ=PC,ALU,YDST=PHYSPG
CONT А=ZER,DSRC=PROM,DDEV=MODB,WRD,ALUS=DZ,ALUD=B,RB=A
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=PC,FUNC=ADD,ALUD=В,RВ=PC,ALU,YDST=PHYSPG
;00: ПРОВЕРЯЕМ ЗАПИСАННЫЙ 0
CONT %CLRTYP%
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ БМСП В РГ.Y МПС, СРАВНИВАЕМ
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЗАПИСЫВАЕМ В РФС "0"
CONT А=ZER,DSRC=PROM,ALUS=DZ,ALU,YDST=PHYSPG
;ЗАПУСКАЕМ ЗАГРУЗКУ
CONT FFCNT=STRTLD
;01: ЖДЕМ КОНЦА ЗАГРУЗКИ
CONT %TYPE%
WЕ93:CJP А=WЕ93,МАР=РЕ,COND=FULMEM,IСС
;02: ПРОВЕРЯЕМ ЗАГРУЖЕННУЮ "1"
CONT %TYPE%
CONT А=С1,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=A
PUSH А=127,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=PC,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=PC,FUNC=ADD,ALUD=В,RВ=PC,ALU,YDST=PHYSPG
%J% А=CAD93,МАР=РЕ
;
;
LD94:ENTRY
;===== ПРОВЕРКА АВТОМАТИЧЕСКОЙ ЗАГРУЗКИ ОЗУ БМСП "1",НАЧИНАЯ С НЕНУЛЕВОГО АДРЕСА
;   A - ЧТО Д.БЫТЬ; У - ПРОЧИТАННОЕ ИЗ БМСП; ПРОВЕРЯЕМ АДРЕСА, = ОБ'ЕМУ ПАМЯТИ
;   PC - АДРЕС В 11-20 РАЗРЯДАХ, = 4-7 РГ.БОПП
;   ПРИ ОШ. 11 РГ.БОПП = ЧТО Д.БЫТЬ; 15РГ., МЛ.РАЗРЯД = ЧТО ПРОЧИТАЛИ;
;   INTR = 00 - ПРОВЕРЯЕМ ЗАПИСЬ "0" В ОЗУ; 01: ЖДЕМ КОНЦА ЗАГРУЗКИ;
;          02 - ПРОВЕРЯЕМ "0" В 1-Й ПОЛОВИНЕ ПАМЯТИ; 03 - "1" ВО 2-Й ПОЛОВИНЕ.
;
CJP А=PSAD94,МАР=РЕ
PSAD94:CONT А=H94,%T%
%S% А=INITST,МАР=РЕ
;ЗАПИСЫВАЕМ В ОЗУ БМСП 0:
CAD94:PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,H,ALUD=В,RВ=PC,ALU,YDST=PHYSPG
CONT А=ZER,DSRC=PROM,DDEV=MODB,WRD,ALUS=DZ,ALUD=B,RB=A
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=PC,FUNC=ADD,ALUD=В,RВ=PC,ALU,YDST=PHYSPG
;00: ПРОВЕРЯЕМ ЗАПИСАННЫЙ 0
CONT %CLRTYP%
PUSH А=1023,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ЧИТАЕМ БМСП В РГ.Y МПС, СРАВНИВАЕМ
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
;УБИРАЕМ МУСОР, ПРОВЕРЯЕМ НА 0
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT A=B11,DSRC=PROM,ALUS=DA,RA=РС,FUNC=ADD,ALUD=В,RB=PC,ALU,YDST=PHYSPG
;ЗАПИСЫВАЕМ В РФС НЕ РАВНЫЙ 0 АДРЕС:
CONT А=В17,DSRC=PROM,ALUS=DZ,ALU,YDST=PHYSPG
;ЗАПУСКАЕМ ЗАГРУЗКУ
CONT FFCNT=STRTLD
;01: ЖДЕМ КОНЦА ЗАГРУЗКИ
CONT %ТУРЕ%
WE94:CJP А=WE94,МАР=РЕ,COND=FULMEM,IСС
;02: ПРОВЕРЯЕМ 1-Ю ПОЛОВИНУ ПАМЯТИ НА 0
;НАЧИНАЕМ С "1", Т.К. ПОКА СРАБОТАЕТ АППАРАТНЫЙ ОСТАНОВ ЗАГРУЗКИ,
;УСПЕВАЕТ ЗАГРУЗИТЬСЯ "1" ПО ЛИШНЕМУ АДРЕСУ, В ЧАСТНОСТИ, ПО 0-ОМУ!!!
CONT A=C1,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=PC,ALU,YDST=PHYSPG
PUSH А=62,МАР=РЕ,%ТУРЕ%
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=PC,FUNC=ADD,ALUD=В,RВ=PC,ALU,YDST=PHYSPG
;03: ПРОВЕРЯЕМ 2-Ю ПОЛОВИНУ ПАМЯТИ НА 1 (В РФС - ТО, ЧТО НАДО!)
CONT А=С1,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=A
PUSH А=63,МАР=РЕ,%ТУРЕ%
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
CONT DDEV=MODВ,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=H1,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=PC,FUNC=ADD,ALUD=В,RВ=PC,ALU,YDST=PHYSPG
%J% А=CAD94,МАР=РЕ
;
;     ===========
;     Б О И  ТЕГА
;     ===========
;
ТЕГ95:ENTRY
;===== ЗАПИСЬ РАЗНЫХ CONST В RG1-3 БОИ ТЕГА, ЧТЕНИЕ, ПРОВЕРКА
;   11 РГ.БОПП - ЧТО ПИСАЛИ, 15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   TYPE = 1,2,3 - СООТВЕТСТВУЕТ НОМЕРУ РЕГИСТРА БОИ ТЕГА
;
CJP А=PSTG95,МАР=РЕ
PSTG95:CONT А=Н95,%T%
CJS А=INITST,МАР=РЕ
;CONST ИЗ ПЗУ - В РЕГИСТРЫ МПС И В RG1-3 ТЕГА
OCTCKL:CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,ALU,YDEVT=ECBTAG,WRB,BRA=RG1
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=DADR,ALU,YDEVT=ECBTAG,WRB,BRA=RG2
CONT A=CAAA,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=HALF,ALU,YDEVT=ECBTAG,WRB,BRA=RG3
;ЧИТАЕМ ЧЕРЕЗ СДВИГАТЕЛЬ В РГ.У МПС
CTAG95: CONT %CLRTYP%
;1 - RG1
CONT YDEVT=ECBTAG,BRA=RG1,%TRSH%,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=ZА,RА=У,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=15
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=BA,RA=A,RB=WR6,ALU,YDEV=MPMEM
>,WRY,IOMP,MPADR=11,CEN
CJS А=ERRTST,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;2 - RG2
CONT YDEVT=ECBTAG,BRA=RG2,%TRSH%,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=ZА,RА=У,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=15
CONT ALUS=AB,RA=DADR,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=BA,RA=DADR,RB=WR6,ALU,YDEV=MPMEM
>,WRY,IOMP,MPADR=11,CEN
CJS А=ERRTST,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;3 - RG3
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=ZА,RА=У,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=15
CONT ALUS=AB,RA=HALF,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=BA,RA=HALF,RB=WR6,ALU,YDEV=MPMEM
>,WRY,IOMP,MPADR=11,CEN
CJS А=ERRTST,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=CTAG95,МАР=РЕ,%TIK%
;
;
ТЕГ96:ENTRY
;===== ПИШЕМ 0/F В RG1-3 БОИ ТЕГА
;   А - ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ
;   ПРИ ОШ. 11 РГ.БОПП - ЧТО ПИСАЛИ, 15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   TYPE = 1,2,3 - СООТВЕТСТВУЕТ НОМЕРУ РЕГИСТРА БОИ ТЕГА
;
CJP А=PSBI96,МАР=РЕ
PSBI96:CONT А=H96,%T%
%S% А=INITST,МАР=РЕ
;0 - В А
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
;ПИШЕМ
CBOI96:CONT %CLRTYP%
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,YDEVT=ECBTAG,WRB,BRA=RG1
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,YDEVT=ECBTAG,WRB,BRA=RG2
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,YDEVT=ECBTAG,WRB,BRA=RG3
;ЧИТАЕМ, СРАВНИВАЕМ
;TYPE = 1
CONT YDEVT=ECBTAG,BRA=RG1,%TRSH%,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
;TYPE = 2
CONT YDEVT=ECBTAG,BRA=RG2,%TRSH%,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
;TYPE = 3
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
%J% А=CBOI96,МАР=РЕ,%TIK%
;
;
ТЕГ97:ENTRY
;===== ПИШЕМ ПЕРЕМЕННУЮ В RG1-3 ТЕГА
;   А - ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ
;   ПРИ ОШ. 11 РГ.БОПП - ЧТО ПИСАЛИ, 15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   TYPE = 1,2,3 - СООТВЕТСТВУЕТ НОМЕРУ РЕГИСТРА БОИ ТЕГА
;
CJP А=PSBI97,МАР=РЕ
PSBI97:CONT А=Н97,%T%
%S% А=INITST,МАР=РЕ
;0 - В А
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
;ПИШЕМ
CBOI97:CONT %CLRTYP%
CONT ALUS=ZВ,RВ=А,Н,CI,ALUD=В,ALU,YDEVT=ECBTAG,WRB,BRA=RG1
;1: ЧИТАЕМ RG1, СРАВНИВАЕМ
CONT YDEVT=ECBTAG,BRA=RG1,%TRSH%,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=ZВ,RВ=А,Н,CI,ALUD=В,ALU,YDEVT=ECBTAG,WRB,BRA=RG2
;2: ЧИТАЕМ RG2, СРАВНИВАЕМ
CONT YDEVT=ECBTAG,BRA=RG2,%TRSH%,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=ZВ,RВ=А,Н,CI,ALUD=В,ALU,YDEVT=ECBTAG,WRB,BRA=RG3
;3: ЧИТАЕМ RG3, СРАВНИВАЕМ
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=CBOI97,МАР=РЕ,%TIK%
;
;     ===================
;     РГ.  К О П  АРБИТРА
;     ===================
;
КОПА98:ENTRY
;===== ЗАПИСЬ 0/F В РГ.КОП АРБИТРА, ЧТЕНИЕ, СРАВНЕНИЕ
;   А = ЗАПИСЫВАЕМОЕ; У = ПРОЧИТАННОЕ; ВУТЕ - МАСКА НА 4 РАЗРЯДА
;   ПРИ ОШ.: 11 РГ.БОПП - ЗАПИСЫВАЕМОЕ; 15 РГ.БОПП - ПРОЧИТАННОЕ
;
CJP А=CONT98,МАР=РЕ
CONT98:CONT А=Н98,%Т%
%S% А=INITST,МАР=РЕ
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А
;ПИШЕМ 0/F В РГ.КОП АРБИТРА
СА98:CONT ALUS=ZA,RA=A,FUNC=EXNOR,H,ALUD=B,RB=A,ALU,YDST=ARBOPC
;ЧИТАЕМ
CONT DSRC=ARBOPC,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q
CONT A=HF,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=СА98,МАР=РЕ,%TIK%
;
;
КОПА99:ENTRY
;===== ЗАПИСЬ ПЕРЕМЕННОЙ В РГ.КОП АРБИТРА, ЧТЕНИЕ, СРАВНЕНИЕ
;   А = ЗАПИСЫВАЕМОЕ; У = ПРОЧИТАННОЕ; ВУТЕ - МАСКА НА 4 РАЗРЯДА
;   ПРИ ОШ.: 11 РГ.БОПП - ЗАПИСЫВАЕМОЕ; 15 РГ.БОПП - ПРОЧИТАННОЕ
;
CJP А=CONT99,МАР=РЕ
CONT99:CONT А=Н99,%Т%
%S% А=INITST,МАР=РЕ
CONT А=HF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ
;0 - В РГ.А, В ЦИКЛЕ ПИШЕМ 0-15 В РГ.КОП АРБИТРА
СА99:PUSH А=15,МАР=РЕ,ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=А,ALU,YDST=ARBOPC
;ЧИТАЕМ
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
RFCT ALUS=ZВ,RВ=А,CI,ALUD=В,ALU,YDST=ARBOPC
%J% А=СА99,МАР=РЕ,%TIK%
;
;    ==============================
;    ЧАСЫ И ТАЙМЕР СЧЕТНОГО ВРЕМЕНИ
;    ==============================
;
;     =============
;     Б О И  ДАННЫХ
;     =============
;
БОИB0:ENTRY
;===== ЗАПИСЬ РАЗНЫХ CONST В RG0-3 БОИ ДАННЫХ, ЧТЕНИЕ, СРАВНЕНИЕ
;   ПРИ ОШ. 8-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   TYPE = 0,1,2,3 - СООТВЕТСТВУЕТ НОМЕРУ РЕГИСТРА БОИ ДАННЫХ
;
CJP А=PSBIB0,МАР=РЕ
PSBIB0:CONT А=НB0,%T%
%S% А=INITST,МАР=РЕ
;CONST ИЗ ПЗУ - В РЕГИСТРЫ МПС И В RG0-3
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,ALU,ECB,WRB,BRA=RG0
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=DADR,ALU,ECB,WRB,BRA=RG1
CONT A=C555,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=HALF,ALU,ECB,WRB,BRA=RG2
CONT A=CAAA,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE,ALU,ECB,WRB,BRA=RG3
;TYPE = 0 - RG0, ЧИТАЕМ В РГ.Y МПС
CBOIB0:CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1 - RG1
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=DАDR,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;2 - RG2
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=HALF,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;3 - RG3
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=BYTE,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=CBOIB0,МАР=РЕ,%TIK%
;
;
БОИB1:ENTRY
;===== ПИШЕМ 0/FFFF В RG0-3 БОИ ДАННЫХ
;   ПРИ ОШ. 8-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   TYPE = 0,1,2,3 - СООТВЕТСТВУЕТ НОМЕРУ РЕГИСТРА БОИ ДАННЫХ
;
CJP А=PSBIB1,МАР=РЕ
PSBIB1:CONT А=НB1,%T%
%S% А=INITST,МАР=РЕ
;CONST (0) - В А
CONT A=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
;ПИШЕМ
CBOIB1:CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,ECB,WRB,BRA=RG0
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,ECB,WRB,BRA=RG1
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,ECB,WRB,BRA=RG2
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,ECB,WRB,BRA=RG3
;ЧИТАЕМ, СРАВНИВАЕМ
;0 - RG0
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=А,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1 - RG1
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=А,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;2 - RG2
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=А,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;3 - RG3
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=А,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
%J% А=CBOIB1,МАР=РЕ,%TIK%
;
;
БОИB2:ENTRY
;===== ПИШЕМ РАЗНЫЕ ПЕРЕМЕННЫЕ В RG0-3 БОИ ДАННЫХ
;   ПРИ ОШ. 8-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   TYPE = 0,1,2,3 - СООТВЕТСТВУЕТ НОМЕРУ РЕГИСТРА БОИ ДАННЫХ
;
CJP А=PSBIB2,МАР=РЕ
PSBIB2:CONT А=НB2,%T%
%S% А=INITST,МАР=РЕ
;НАЧАЛЬНЫЕ CONST ИЗ ПЗУ - В РЕГИСТРЫ МПС
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=DADR
CONT A=C555,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=HALF
CONT A=CAAA,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
;ПЕРЕМЕННЫЕ - В RG0-3
CBOIB2:CONT ALUS=ZA,RA=A,FUNC=ADD,H,CI,ALUD=B,RB=A,ALU,ECB,WRB,BRA=RG0
CONT ALUS=ZA,RA=DADR,FUNC=ADD,H,CI,ALUD=B,RB=DADR,ALU,ECB,WRB,BRA=RG1
CONT ALUS=ZA,RA=HALF,FUNC=ADD,H,CI,ALUD=B,RB=HALF,ALU,ECB,WRB,BRA=RG2
CONT ALUS=ZA,RA=BYTE,FUNC=ADD,H,CI,ALUD=B,RB=BYTE,ALU,ECB,WRB,BRA=RG3
;TYPE = 0 - RG0, ЧИТАЕМ В РГ.Y МПС
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1 - RG1
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=DАDR,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;2 - RG2
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=HALF,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;3 - RG3
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=BYTE,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=CBOIB2,МАР=РЕ,%TIK%
;
;
БОИB3:ENTRY
;===== ЗАПИСЬ CONST В ЧЕРЕЗ RG0-3 БОИ ДАННЫХ В АИСП., ЧТЕНИЕ, СРАВНЕНИЕ
;   ПРИ ОШ. 8-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ; ЛИБО 8-11 = ЧТО ПИСАЛИ, 12-15 = ЧИТАЕМ
;   ОШ. = 0-5 - СООТВЕТСТВУЮТ РАЗНЫМ ПЕРЕСЫЛКАМ ЧЕРЕЗ БОИ ДАННЫХ
;
CJP А=PSBIB3,МАР=РЕ
PSBIB3:CONT А=НB3,%T%
%S% А=INITST,МАР=РЕ
;CONST ИЗ ПЗУ - В РЕГИСТР A МПС, В RG1, В АИСП.
CBOIB3:CONT A=CAAA,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,ECA,WRA,ARA=RG1,ECB
>,BRA=RG1,YDST=ADRREG
;00: ЧИТАЕМ RG1
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: ЧИТАЕМ АИСП. ЧЕРЕЗ RG2
CONT YDEV=RADRR,ECB,WRB,BRA=RG2,ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;02: ЧИТАЕМ RG2
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;CONST ИЗ ПЗУ - В РЕГИСТР A МПС, В RG0, В АИСП.
CONT A=C555,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,ECA,WRA,ARA=RG0,ECB
>,BRA=RG0,YDST=ADRREG
;03: ЧИТАЕМ RG0
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;04: ЧИТАЕМ АИСП. ЧЕРЕЗ RG3
CONT YDEV=RADRR,ECB,WRB,BRA=RG3,ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;05: ЧИТАЕМ RG3
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=CBOIB3,МАР=РЕ,%TIK%
;
;     ====================
;     Б О И  ДАННЫХ И ТЕГА
;     ====================
;
БОИB4:ENTRY
;===== ЗАПИСЬ CONST В RG0 БОИ ДАННЫХ (ПО А) И RG3 БОИ ТЕГА (ЧЕРЕЗ МПС)
;   А - ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   ОШИБКИ: 0 - БОИ ДАННЫХ, 8-15 РГ.БОПП = ПРОЧИТАННОМУ ИЗ RG0 БОИ ДАННЫХ;
;           1 - БОИ ТЕГА, 15 РГ. БОПП = ПРОЧИТАННОМУ ИЗ RG3 БОИ ТЕГА
;
CJP А=PSBIB4,МАР=РЕ
PSBIB4:CONT А=НB4,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ, ПИШЕМ В РГ.А, RG0 ДАННЫХ (ПО А) И RG3 ТЕГА (ЧЕРЕЗ МПС)
CONT А=СААА,DSRC=PROM,ЕСА,WRA,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=А,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG3
;0: ЧИТАЕМ БОИ ДАННЫХ, СРАВНИВАЕМ
CBOIB4:CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1: ЧИТАЕМ БОИ ТЕГА ЧЕРЕЗ СДВИГАТЕЛЬ, СРАВНИВАЕМ
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOIB4,МАР=РЕ,%TIK%
;
;
БОИB5:ENTRY
;===== ЗАПИСЬ CONST В RG3 БОИ ДАННЫХ И ТЕГА (В ОБА - ПО КАНАЛУ В ЧЕРЕЗ МПС)
;   А - ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   ОШИБКИ: 0 - БОИ ДАННЫХ, 8-15 РГ.БОПП = ПРОЧИТАННОМУ ИЗ RG0 БОИ ДАННЫХ;
;           1 - БОИ ТЕГА, 15 РГ. БОПП = ПРОЧИТАННОМУ ИЗ RG3 БОИ ТЕГА
;
CJP А=PSBIB5,МАР=РЕ
PSBIB5:CONT А=НB5,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ, ПИШЕМ В РГ.А, RG3 ДАННЫХ И ТЕГА (ЧЕРЕЗ МПС)
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,ALU,YDEVT=ECBTAG,ЕСВ,WRB,BRA=RG3
;0: ЧИТАЕМ БОИ ДАННЫХ, СРАВНИВАЕМ
CBOIB5:CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1: ЧИТАЕМ БОИ ТЕГА, СРАВНИВАЕМ
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOIB5,МАР=РЕ,%TIK%
;
;
БОИB6:ENTRY
;===== ЗАПИСЬ РАЗНЫХ CONST ВО ВСЕ РЕГИСТРЫ БОИ ДАННЫХ И ТЕГА
;   Y - ПРОЧИТАННОЕ; КОД ОШИБКИ - В СКОБКАХ, ПРИ ОШ. 8-15 РГ.БОПП = ПРОЧИТАННОЕ.
;   WR1 - ЗАПИСАННОЕ В RG0 ДАННЫХ (0), RG3 ТЕГА (6)
;   WR2 - RG1 ДАННЫХ (1), RG2 ТЕГА (5)
;   WR3 - RG2 ДАННЫХ (2), RG1 ТЕГА (4)
;   WR4 - RG3 ДАННЫХ (3) (В RG0 ТЕГА НЕ ПИШЕМ!)
;
CJP А=PSBIB6,МАР=РЕ
PSBIB6:CONT А=НB6,%T%
%S% А=INITST,МАР=РЕ
;ПИШЕМ ИЗ ПЗУ В БОИ ДАННЫХ ПО А, В РГ. МПС, ЧЕРЕЗ МПС - В БОИ ТЕГА
;В WR1, RG0 ДАННЫХ, RG3 ТЕГА
CONT А=СААА,DSRC=PROM,ЕСА,WRA,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=WR1,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG3
;В WR2, RG1 ДАННЫХ, RG2 ТЕГА
CONT А=С555,DSRC=PROM,ЕСА,WRA,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=WR2,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG2
;В WR3, RG2 ДАННЫХ, RG1 ТЕГА
CONT А=МН,DSRC=PROM,ЕСА,WRA,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=WR3,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG1
;В WR4, RG3 ДАННЫХ
CONT А=MNH,DSRC=PROM,ЕСА,WRA,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=WR4
;INTR=0: ЧИТАЕМ RG0 БОИ ДАННЫХ, СРАВНИВАЕМ
CBOIB6:CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=WR1,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=1: RG1 ДАННЫХ
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=WR2,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=2: RG2 ДАННЫХ
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=WR3,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=3: RG3 ДАННЫХ
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=WR4,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=4: RG1 БОИ ТЕГА, ЧИТАЕМ ЧЕРЕЗ СДВИГАТЕЛЬ
CONT YDEVT=ECBTAG,BRA=RG1,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR3,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=5: RG2 ТЕГА
CONT YDEVT=ECBTAG,BRA=RG2,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR2,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=6: RG3 ТЕГА
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR1,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOIB6,МАР=РЕ,%TIK%
;
;
БOИB7:ENTRY
;===== ПИШЕМ В РЕГИСТРЫ БОИ ДАННЫХ И ТЕГА РАЗНЫЕ ЧИСЛА, ЧИТАЕМ, СРАВНИВАЕМ
;   ПИШЕМ: WR4 - В RG0 ДАННЫХ, ОШИБКИ: 00
;          WR3 - В RG1 ДАННЫХ, ТЕГА:   01    04
;          WR2 - В RG2 ДАННЫХ, ТЕГА:   02    05
;          WR1 - В RG3 ДАННЫХ, ТЕГА:   03    06
;
CJP А=PSBIB7,МАР=РЕ
PSBIB7:CONT А=HB7,%T%
%S% А=INITST,МАР=РЕ
;УСТАНАВЛИВАЕМ НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ПЕРЕМЕННЫХ (ЧИТАЕМ ИЗ ПЗУ)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR4
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3
CONT А=МН,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR2
CONT А=MNH,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1
;ПИШЕМ ИЗ МПС В БОИ ДАННЫХ И В БОИ ТЕГА: RG0
CBOIB7:CONT ALUS=ZВ,Н,CI,ALUD=В,RВ=WR4,ALU,ЕСВ,WRB,BRA=RG0
;В RG1
CONT ALUS=ZВ,Н,CI,ALUD=В,RВ=WR3,ALU,YDEVT=ECBTAG,BRA=RG1,ЕСВ,WRB
;В RG2
CONT ALUS=ZВ,Н,CI,ALUD=В,RВ=WR2,ALU,YDEVT=ECBTAG,BRA=RG2,ЕСВ,WRB
;В RG3
CONT ALUS=ZВ,Н,CI,ALUD=В,RВ=WR1,ALU,YDEVT=ECBTAG,BRA=RG3,ЕСВ,WRB
;0: ЧИТАЕМ RG0 БОИ ДАННЫХ, СРАВНИВАЕМ
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR4,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1: RG1 ДАННЫХ
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR3,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;2: RG2 ДАННЫХ
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR2,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;3: RG3 ДАННЫХ
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR1,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;4: ПРОВЕРЯЕМ RG1 БОИ ТЕГА, ЧИТАЕМ ЧЕРЕЗ СДВИГАТЕЛЬ
CONT YDEVT=ECBTAG,BRA=RG1,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=Y,RB=WR3,FUNC=EXOR,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;5: RG2 ТЕГА
CONT YDEVT=ECBTAG,BRA=RG2,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=WR2,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;6: RG3 ТЕГА
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=WR1,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOIB7,МАР=РЕ,%TIK%
;
;
БOИB8:ENTRY
;===== ПИШЕМ 0/F В РЕГИСТРЫ БОИ ДАННЫХ И ТЕГА, ЧИТАЕМ, СРАВНИВАЕМ
;   ПИШЕМ: В RG0 ДАННЫХ, ОШИБКИ: 00
;          В RG1 ДАННЫХ, ТЕГА:   01    04
;          В RG2 ДАННЫХ, ТЕГА:   02    05
;          В RG3 ДАННЫХ, ТЕГА:   03    06
;
CJP А=PSBIB8,МАР=РЕ
PSBIB8:CONT А=HB8,%T%
%S% А=INITST,МАР=РЕ
;ПИШЕМ ИЗ ПЗУ В БОИ ДАННЫХ ПО А, В РГ. МПС, ЧЕРЕЗ МПС - В БОИ ТЕГА
;FFFF - B RG0 ДАННЫХ, 0 - B RG3 ТЕГА
CONT А=СFFF,DSRC=PROM,ЕСА,WRA,ARA=RG0,ALUS=DZ,FUNC=EXNOR,Н,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG3
;РАЗДЕЛЯЕМ ЗАПИСЬ В РЕГИСТРЫ ПУСТЫМИ КОМАНДАМИ
CONT
;0 - В RG1 ДАННЫХ, FFFF - B RG1 ТЕГА
CONT А=ZER,DSRC=PROM,ЕСА,WRA,ARA=RG1,ALUS=DZ,FUNC=EXNOR,Н,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG1
CONT
;FFFF - B RG2 ДАННЫХ, RG2 ТЕГА
CONT А=ZER,DSRC=PROM,ALUS=DZ,FUNC=EXNOR,H,ALU,ECB,YDEVT=ECBTAG,WRB,BRA=RG2
CONT
;0 - B RG3 ДАННЫХ
CONT А=CFFF,DSRC=PROM,ALUS=DZ,FUNC=EXNOR,Н,ALU,ECB,WRB,BRA=RG3
;INTR=0: ЧИТАЕМ RG0 БОИ ДАННЫХ, СРАВНИВАЕМ
CBOIB8:CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=1: RG1 ДАННЫХ
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=2: RG2 ДАННЫХ
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=3: RG3 ДАННЫХ
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=4: RG1 БОИ ТЕГА, ЧИТАЕМ ЧЕРЕЗ СДВИГАТЕЛЬ
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT YDEVT=ECBTAG,BRA=RG1,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=5: RG2 ТЕГА
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT YDEVT=ECBTAG,BRA=RG2,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=6: RG3 ТЕГА
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOIB8,МАР=РЕ,%TIK%
;
;     =====================
;     СТАНДАРТИЗАТОР КОМАНД
;     =====================
;
СТНДB9:ENTRY
;===== КОМАНДНОЕ СЛОВО ЗАДАЕМ В БОПП;  АК,КОП,МОД.ПО АДР.IRA - ПИШЕМ В БОПП
;   ВХОДНАЯ ИНФОРМАЦИЯ В РГ.БОПП ПРИ ЗАПУСКЕ ТЕСТА:
;   8-15 - КОМАНДНОЕ СЛОВО;
;   7 = 0 - НОВЫЙ РЕЖИМ; НЕ РАВЕН 0 - РЕЖИМ ЭМУЛЯЦИИ;
;   ВЫХОДНАЯ ИНФОРМАЦИЯ В РГ.БОПП:             ИСПОЛЬЗУЕМЫЕ РЕГИСТРЫ:
;   4     - МОДИФИКАТОР ПО АДРЕСУ IRA ЛК       А   - КОМАНДНОЕ СЛОВО
;   5     - КОП ЛК                             У   - АК ЛК;   WR3 - АК ПК
;   6-9   - АИСП.ЛК                            WR5 - КОП ЛК;  WR2 - КОП ПК
;   10    - МОДИФИКАТОР ПО АДРЕСУ IRA ПК       WR4 - ИР ЛК;   WR1 - ИР ПК
;   11    - КОП ПК                             В 0-Й МОДИФИКАТОР ЗАПИСАНО 0!
;   12-15 - АИСП.ПК
;
CJP А=PSSTB9,МАР=РЕ
PSSTB9:CONT А=НB9,%T%
CJS А=INITST,МАР=РЕ
;0 - РГ/ТГ, 5 - В РНГ, FFFFFFFF - В М0
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT
CONT А=С5,DSRC=PROM,ALUS=DZ,ALU,YDST=MODGN
CONT А=ZER,DSRC=PROM,ALUS=DZ,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ЧИТАЕМ 7 РГ.БОПП (ПРИЗНАК РЕЖИМА); ИДЕМ НА П/П ЧТЕНИЯ КОМАНДНОГО СЛОВА ИЗ БОПП
CJS А=RD8/F,МАР=РЕ,YDEV=МРМЕМ,IОМР,MPADR=7,DSRC=SHIFT,MPS,PSHF=SН0-56,SHF=LOG
>,ALUS=DZ,Н,ALUD=В,RВ=WR2,CEN
CJP А=ССF,МАР=РЕ,COND=СТ,SТОРС=NZ,FFCNT=SETNR
;
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
CONT FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;БП,БПТЗ = 1  (19,27 РАЗРЯДЫ РР)
;CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
;3 - В АИСП, RG3 TEГА (ПРИЗНАК КОМАНДЫ + РЭ)
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,ЕСВ,WRB,BRA=RG3
;ФИЗ.АДРЕС - В RG0
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAWF:CJP А=WAWF,%WА%
;ЧИТАЕМ ПО ТОМУ ЖЕ АДРЕСУ
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WARF:CJP А=WARF,%WА%
;
;ЗАПОМИНАЕМ КОМ.СЛОВО
ССF:CONT ALUS=ZА,RА=WR6,Н,ALUD=В,RВ=А
;
;ПИШЕМ КОМАНДНОЕ СЛОВО ИЗ РЕГИСТРА МПС В БОИ В РЕГИСТР КОМАНД
CICTB9:CONT ALUS=ZA,RA=A,H,ALU,ЕСВ,WRB,BRA=RG1
CONT ALUS=ZA,RA=A,H,ALUD=B,RB=WR1,FFCNT=CLRTKK
;ЧИТАЕМ КОП, ПИШЕМ В 5 РГ.БОПП
CJP А=NRF,МАР=РЕ,COND=СТ,SТОРС=NZ,DSRC=ОРС,ALUS=DZ,ALUD=В,RВ=WR5,ALU
>,YDEV=МРМЕМ,WRY,IОМР,MPADR=5
;
;ВЫДЕЛЯЕМ ИР ЛК, ПИШЕМ В АИСП, ПИШЕМ В ОЗУ МОД.ПО U, ЧИТАЕМ ПО IRA
;ДЛЯ РЭ СДВИГАЕМ КОМ.СЛОВО ВЛЕВО НА 4 РАЗРЯДА АРИФМЕТИЧЕСКИ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR1,ALU,DSRC=SHIFT,MPS,PSHF=SН0-4,SHF=ARIPH
;СДВИГАЕМ IRA ЛК В МЛ.РАЗРЯДЫ
NRF:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60
>,SHF=LOG
;ПИШЕМ В АИСП
CONT ALUS=ZА,RА=WR2,ALU,YDST=ADRREG
;ПИШЕМ ТО ЖЕ В ОЗУ МОД. ПО U
;ЕСЛИ IRA=0, ЗАПИСИ НЕ Д.БЫТЬ, ЧИТАЕТСЯ 0, Т.Е. ТО ЧТО ЗАПИСАНО В М0 РАНЬШЕ
CONT ALUS=ZА,RА=WR2,ALU,CSM,WЕМ,MNSA=U
;ЧИТАЕМ ПО IRA НОМЕР ИНДЕКС-РЕГИСТРА, ПИШЕМ В БОПП
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=WR4,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=4
;
;ЧИТАЕМ АК ЛК, ПИШЕМ В 6-9 РГ.БОПП; МЛ.БАЙТЫ - В СТАРШИХ ПО НОМЕРУ РЕГИСТРАХ!
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=DZ,Н,ALUD=ВА,RА=У,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=9
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=8
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=7
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=ZА,RА=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=6
;
;ЧИТАЕМ КОП ПК, ПИШЕМ В 11 РГ.БОПП
CONT FFCNT=SЕТТКК
CJP А=NRMF,МАР=РЕ,COND=СТ,SТОРС=NZ
>,DSRC=ОРС,ALUS=DZ,ALUD=В,RВ=WR2,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=11
;
;ВЫДЕЛЯЕМ ИР ПК, ПИШЕМ В АИСП, ПИШЕМ В ОЗУ МОД.ПО U, ЧИТАЕМ ПО IRA
;ДЛЯ РЭ СДВИГАЕМ КОМ.СЛОВО ВПРАВО НА 8 (Т.К.НА 4 ВЛЕВО В РЭ УЖЕ СДВИНУТО!)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR1,ALU,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
;СДВИГАЕМ IRA ПК В МЛ.РАЗРЯДЫ
NRMF:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR1,ALU,DSRC=SHIFT,MPS,PSHF=SН0+28
>,SHF=LOG
CONT А=HF,DSRC=PROM,ALUS=DА,RА=WR1,FUNC=AND,ALUD=В,RВ=WR1,ALU,YDST=ADRREG
;ПИШЕМ ТО ЖЕ В ОЗУ МОД. ПО U
CONT ALUS=ZА,RА=WR1,ALU,CSM,WЕМ,MNSA=U
;ЧИТАЕМ ПО IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=WR1,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=10
;
;ЧИТАЕМ АК ПК, ПИШЕМ В 12-15 РГ.БОПП
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=WR3
CONT ALUS=DZ,ALUD=ВА,RА=WR3,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=15
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=DZ,ALUD=ВА,RА=WR6,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=14
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=DZ,ALUD=ВА,RА=WR6,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=13
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=ZА,RА=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=12
CJP А=CICTB9,МАР=РЕ,%TIK%
;
;
СТНДBA:ENTRY
;===== КОМАНДНОЕ СЛОВО = "0", НОВЫЙ РЕЖИМ
;   РГ.У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ = 12-15 РГ.БОПП; A - ЧТО Д.БЫТЬ = 8-11 РГ.БОПП
;   Q - РЕЗ-Т СРАВНЕНИЯ, DADR - ЗАПИСАННОЕ В ИР0; ВУТЕ - МАСКА НА БАЙТ.
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК ЛК (ПК), 12-15 РГ.БОПП = ПРОЧИТАННОМУ АК (Д.Б.0)
;           01 (05): - " -  КОП ЛК (ПК), 15 РГ.БОПП = ПРОЧИТАННОМУ КОП (Д.Б.0)
;           02 (06): ЕСТЬ ПРИЗНАК ИР15, 8-15 РГ.БОПП НЕ ИЗМЕНЯЮТСЯ
;           03 (07): - " -  МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК); (Д.Б.CONST=AAAA)
;
CJP А=PSSTBA,МАР=РЕ
PSSTBA:CONT А=НBA,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В RG1 БОИ ДАННЫХ, В РГ/ТГ
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT,ЕСВ,WRB,BRA=RG1
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС DADR, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;
;00: ЧИTАЕМ ЛК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CSTBA:CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=CLRTKK
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
;П/У НА ВЫДАЧУ РЕГИСТРОВ В БОПП, ЕСЛИ ОШИБКА
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ ОТСУТСТВИЕ ПРИЗНАКА ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;03: ЧИТАЕМ ПО АДРЕСУ IRA
CONT ALUS=ZA,RA=DADR,Н,ALUD=В,RВ=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ЧИТАЕМ ПК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ПРОВЕРЯЕМ ОТСУТСТВИЕ ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA
CONT ALUS=ZA,RA=DADR,Н,ALUD=В,RВ=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSTBA,МАР=РЕ,%TIK%
;
;
СТНДBB:ENTRY
;===== КОМАНДНОЕ СЛОВО = FF...FF, НОВЫЙ РЕЖИМ
;   РГ.У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ, DADR - ЗАПИСАННОЕ В ИР15
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК ЛК (ПК)
;           01 (05): - " -  КОП ЛК (ПК)
;           02 (06): НЕТ ПРИЗНАКА ИР15 НА УСЛОВИЯХ
;           03 (07): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК)
;
CJP А=PSSTBB,МАР=РЕ
PSSTBB:CONT А=НBB,%T%
CJS А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=HALF,ALU,YDST=CNT
;CONST - В РГ.МПС DADR, В 15 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA), РНГ - КАКОЙ ЕСТЬ
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;FF...FF - В RG1 БОИ
CONT А=CFFF,DSRC=PROM,ЕСА,WRA,ARA=RG1
;
;00: ЧИТАЕМ ЛК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT FFCNT=CLRTKK
CSTBB:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT A=MH,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П (МАСКА И СРАВНЕНИЕ)
CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT A=MB,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ИР15 НА УСЛОВИЯХ
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;03: ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ЧИТАЕМ ПК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT A=MH,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT A=MB,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ИР15 НА УСЛОВИЯХ
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSTBB,МАР=РЕ,%TIK%
;
;
СТНДBC:ENTRY
;===== КОМАНДНОЕ СЛОВО = 0...0F...F (ИЛИ F...F0...0), НОВЫЙ РЕЖИМ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК = 0 (АК = F..F)
;           01 (05): - " -  КОП = 0 (КОП = FF)
;           02 (06): ЕСТЬ ИР15 НА УСЛОВИЯХ У КОМАНДЫ = 0 (НЕТ ИР15 У F...F)
;           03 (07): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = 0 (IRA = F);
;  ВУТЕ - МАСКА НА 8 Р.; HALF - МАСКА НА 32 Р.; DADR - М0; РС - ЗАПИСАННОЕ В SР
;
CJP А=PSSTBC,МАР=РЕ
PSSTBC:CONT А=НBC,%T%
CJS А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ И ТКК (НАЧИНАЕМ С ЛЕВОЙ КОМАНДЫ)
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС DADR, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA = 0)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ДРУГУЮ CONST - В РГ.МПС РС И ПО АДРЕСУ IRA = F
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;ЧИТАЕМ CONST 00...FF - В РГ.HALF
CONT А=МН,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;ПИШЕМ КОМАНДНОЕ СЛОВО (0...0F...F) - В RG1, В РГ.А
CONT А=МН,DSRC=PROM,ЕСА,WRA,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=А
;
;ПРОВЕРЯЕМ КОМАНДУ (0...0):
;00: ЧИТАЕМ АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CSTBC:CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ ОТСУТСТВИЕ ПРИЗНАКА ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;03: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = 0
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ЧИТАЕМ КОМАНДУ (F...F): АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT FFCNT=СНТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=HALF,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=BYTE,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ПРОВЕРЯЕМ ПРИЗНАК ИР15 НА УСЛОВИЯХ
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA = F
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT ALUS=AB,RA=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ИНВЕРТИРУЕМ КОМАНДНОЕ СЛОВО, НЕ МЕНЯЯ ТКК (НАЧИНАЕМ С ДРУГОЙ ПОЛОВИНЫ)
CONT ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,ALU,ЕСВ,WRB,BRA=RG1
%J% А=CSTBC,МАР=РЕ,%TIK%
;
;
СТНДBD:ENTRY
;===== КОМАНДНОЕ СЛОВО = 00...00/FF...FF, НОВЫЙ РЕЖИМ
;   A - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 01 (05): ЧИТАЕМ АК = 0 ЛК (ПК)
;           02 (06): - " -  КОП = 0 ЛК (ПК)
;           03 (07): ЕСТЬ ИР15 НА УСЛОВИЯХ У ЛЕВОЙ КОМАНДЫ = 0 (ПК)
;           04 (08): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = 0 У ЛК (ПК)
;           09 (0D): ЧИТАЕМ АК = F...F ЛК (ПК)
;           0A (0E): - " -  КОП = FF ЛК (ПК)
;           0B (0F): НЕТ ИР15 НА УСЛОВИЯХ У ЛЕВОЙ КОМАНДЫ = F..F (ПК)
;           0C (10): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = F У ЛК (ПК)
;  ВУТЕ - МАСКА НА 8 Р.; HALF - МАСКА НА 32 Р.; DADR - М0; РС - ЗАПИСАННОЕ В SР
;
CJP А=PSSTBD,МАР=РЕ
PSSTBD:CONT А=НBD,%T%
CJS А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ И ТКК (НАЧИНАЕМ С ЛЕВОЙ КОМАНДЫ)
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС DADR, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA = 0)
CONT А=СFFF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ДРУГУЮ CONST - В РГ.МПС РС И ПО АДРЕСУ IRA = F
CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;ПИШЕМ КОМАНДНОЕ СЛОВО (00...00) - В RG1, В РГ.А
CONT А=ZER,DSRC=PROM,ЕСА,WRA,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=А
;
CSTBD:PUSH A=1,MAP=PE,%CLRTYP%
;ПРОВЕРЯЕМ КОМАНДУ (0...0):
;01,05: ЧИТАЕМ АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;02,06: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;03,07: ПРОВЕРЯЕМ ОТСУТСТВИЕ ПРИЗНАКА ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;04,08: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = 0
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
RFCT FFCNT=CHTKK
;
;ИНВЕРТИРУЕМ КОМАНДНОЕ СЛОВО (FF...FF)
PUSH A=1,MAP=PE,ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,ALU,ЕСВ,WRB,BRA=RG1
;09,0D: ЧИТАЕМ КОМАНДУ (F...F): АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=HALF,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;0A,0E: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=BYTE,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;0B,0F: ПРОВЕРЯЕМ ПРИЗНАК ИР15 НА УСЛОВИЯХ
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;0C,10: ЧИТАЕМ ПО АДРЕСУ IRA = F
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT ALUS=AB,RA=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
RFCT FFCNT=CHTKK
;ИНВЕРТИРУЕМ КОМАНДНОЕ СЛОВО
CONT ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,ALU,ЕСВ,WRB,BRA=RG1
%J% А=CSTBD,МАР=РЕ,%TIK%
;
;
СТНДBE:ENTRY
;===== КОМАНДНОЕ СЛОВО = 0...0Х...Х (КОП,АК,ИР ПК - ПЕРЕМЕННЫЕ), НОВЫЙ РЕЖИМ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (03): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК);
;           01 (04): - " -  КОП ЛК (ПК ОСНОВНОГО ФОРМАТА)
;           02 (05): - " -  АК ЛК (ПК ОСНОВНОГО ФОРМАТА)
;               06:  - " -  КОП ПК ДОПОЛНИТЕЛЬНОГО ФОРМАТА
;               07:  - " -  АК ПК ДОПОЛНИТЕЛЬНОГО ФОРМАТА
;   ВУТЕ - МАСКА НА БАЙТ; HALF - НА 32Р.;DADR - НА 4Р.;РССОРУ - М0; РС - ПО IRA
;   WR6  - АК; WR5 - КОП; WR4 - ИР; WR2,A - РАБОЧИЕ
;   WR3 - "СБОРНАЯ" ПРАВАЯ КОМАНДА, ЗАПИСАННАЯ В СТ.РАЗРЯДАХ
;
CJP А=PSSTBE,МАР=РЕ
PSSTBE:CONT А=НBE,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ И ТКК: НОВЫЙ РЕЖИМ, ЛЕВАЯ КОМАНДА
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА (ДЛЯ IRA) - В DADR
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;МАСКУ НА 32 РАЗРЯДА - В РГ. HALF
CONT А=МН,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ПЕРЕМЕННЫМ ДЛЯ ЗАПИСИ В 0 МОДИФ. И ПО АДРЕСУ IRA
CONT А=MWN,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ
CONT А=В11,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;ЗАДАЕМ НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ПЕРЕМЕННЫМ ДЛЯ АК,КОП,ИР (В СТАРШИХ РАЗРЯДАХ)
;АДРЕС КОМАНДЫ - WR6 (В 44-64 РАЗРЯДАХ)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR6
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=WR6,ALU,DSRC=SHIFT,MPS,PSHF=SН0-44,SHF=LOG
;КОП - В WR5 (В 57-64 РАЗРЯДАХ)
CONT ALUS=DZ,Н,ALUD=ВА,RА=DADR,RВ=WR5,ALU,DSRC=SHIFT,MPS,PSHF=SН0-56,SHF=LOG
;ИР - В WR4 (В 61-64 РАЗРЯДАХ)
CONT А=В62,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR4,СЕМ
;
;"СОБИРАЕМ" ПРАВУЮ КОМАНДУ
;АК - СДВИГ ВПРАВО НА 8 - В WR3
CSTBE:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=WR3,ALU,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
;+ КОП
CONT ALUS=АВ,RА=WR5,RВ=WR3,FUNC=OR,Н,ALUD=В
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR3,ALU,DSRC=SHIFT,MPS,PSHF=SН0+4,SHF=LOG
;+ ИР, СДВИГАЕМ НА МЕСТО ПК, ПИШЕМ В RG1 ПО КАНАЛУ А
CONT ALUS=АВ,RА=WR4,RВ=WR3,FUNC=OR,Н,ALUD=В,ALU,DSRC=SHIFT,MPS,PSHF=SН0+32
>,SHF=LOG,ЕСА,WRA,ARA=RG1
;ПИШЕМ В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA ЛК)
CONT ALUS=ZВ,RВ=РССОРУ,Н,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ПИШЕМ В МОДИФИКАТОР ПО IRA ПК (IRA СДВИГАЕМ В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП.)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR4,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=ZА,RА=WR2,ALU,YDST=ADRREG
;ЕСЛИ N МОДИФ.=0, ЗАПИСИ НЕ ПРОИСХОДИТ
CONT ALUS=ZВ,RВ=РС,Н,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
;
;ЧИТАЕМ ЛЕВУЮ КОМАНДУ (0...0)
;00: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (М0)
CONT ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ЧИТАЕМ ПРАВУЮ КОМАНДУ (Х...Х)
CONT FFCNT=SЕТТКК
;03: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA, СРАВНИВАЕМ С ЗАПИСАННЫМ ПО U
;ЕСЛИ IRA=0, ЗАПИСИ НЕ БЫЛО, НАДО СРАВНИВАТЬ С РССОРУ
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;П/У, ЕСЛИ N МОДИФИКАТОРА (IRA) НЕ РАВЕН 0 (РГ.М СУСС СООТВЕТСТВУЕТ IRA B WR6)
CJP А=IRA0,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РС,H,ALUD=B,RB=A
;СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=A
IRA0:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;04,06: К О П ОСНОВНОГО (04) ИЛИ ДОПОЛНИТЕЛЬНОГО (06) ФОРМАТА
;ПРОВЕРЯЕМ КОП НА ДОП. ФОРМАТ (3F)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR5,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+56,SHF=LOG
CONT A=H3F,DSRC=PROM,ALUS=DA,RA=WR2,FUNC=EXOR,ALUD=Q,CEM
CJP A=DFC14,MAP=PE,COND=CT,STOPC=/MZ
;ЕСЛИ ДОП.ФОРМАТ, КОП = СТАРШИЕ 8 РАЗРЯДОВ АДРЕСА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR4,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+56,SHF=LOG
;УВЕЛИЧИВАЕМ TYPE НА 2, ЧТОБ ОТЛИЧИТЬ ЭТОТ СЛУЧАЙ
CONT %TYPE%
CONT %TYPE%
DFC14:CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ЗАПИСАННЫЙ АК СДВИГАЕМ АРИФМЕТИЧЕСКИ В МЛ. РАЗРЯДЫ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
;05,07: АДРЕС КОМАНДЫ (32Р.) ОСНОВНОГО (05) ИЛИ ДОПОЛНИТЕЛЬНОГО (07) ФОРМАТА
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CJP A=DFA14,MAP=PE,COND=CT,STOPC=/MZ,ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
;ЕСЛИ ДОП.ФОРМАТ, СРАВНИВАЕМ ТОЛЬКО МЛАДШИЕ 12 РАЗРЯДОВ
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
DFA14:CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ИЗМЕНЯЕМ АК,КОП,ИР; ТКК = ЛК
CONT А=В45,DSRC=PROM,ALUS=DА,RА=WR6,Н,ALUD=В,RВ=WR6,FFCNT=CLRTKK
CONT А=В57,DSRC=PROM,ALUS=DА,RА=WR5,Н,ALUD=В,RВ=WR5
CONT А=В61,DSRC=PROM,ALUS=DА,RА=WR4,Н,ALUD=В,RВ=WR4,СЕМ
%J% А=CSTBE,МАР=РЕ,%TIK%
;
;
СТНДBF:ENTRY
;===== ПЕРЕМЕННОЕ КОМАНДНОЕ СЛОВО В НОВОМ РЕЖИМЕ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ВУТЕ   - МАСКА НА 8 РАЗРЯДОВ
;   DADR   - МАСКА НА 4 РАЗРЯДА, ЧИСЛО ДЛЯ ЗАПИСИ В М0
;   РС     - МАСКА НА 20 РАЗРЯДОВ
;   WR3    - КОМАНДНОЕ СЛОВО
;   РССОРУ - ЧИСЛО ДЛЯ ЗАПИСИ ПО АДРЕСУ IRA
;   WR1    - ДОБАВКА К КОМ.СЛОВУ
;   WR2    - РАБОЧИЙ РЕГИСТР
;
;    64  61 60   53 52       33 32  29 28    21 20        1
;   I-----I--------I-----------I------I--------I-----------I
;   IИР ЛKI КОП ЛК I   АК ЛК   IИР ЛК I КОП ЛК I   АК ЛК   I
;   I-----I--------I-----------I------I--------I-----------I
;
CJP А=PSSTBF,МАР=РЕ
PSSTBF:CONT А=НBF,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА - В РГ. DADR, В 0-Й МОДИФИКАТОР
CONT А=HF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;МАСКУ НА 20 РАЗРЯДОВ - В РГ. РС
CONT А=MADR,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ДЛЯ КОМАНДНОГО СЛОВА - В WR3, В RG1
CONT А=NTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3,ALU,ЕСВ,WRB,BRA=RG1
;ДЛЯ ЗАПИСИ В МОДИФИКАТОР
CONT А=CTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ
;ФОРМИРУЕМ CONST: ИР ЛК = КОП ЛК = АК ЛК = 2; ИР ПК = КОП ПК = АК ПК = 1
;(ЧТОБ ШАГ ИЗМЕНЕНИЯ ЛК И ПК БЫЛ РАЗНЫЙ)
CONT А=В29,DSRC=PROM,ALUS=DZ,Н,CI,ALUD=В,RВ=WR1
CONT А=В21,DSRC=PROM,ALUS=DА,RА=WR1,Н,ALUD=В,RВ=WR2
CONT ALUS=DА,FUNC=OR,Н,ALUD=ВА,RА=WR2,RВ=WR1,ALU,DSRC=SHIFT,MPS,PSHF=SН0-33
>,SHF=LOG,FFCNT=SЕТТКК
;
;ЧИТАЕМ ПРАВУЮ КОМАНДУ
;00: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CSTBF:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+28
>,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=WR2,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CJP А=MZ15,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZА,RА=РССОРУ,ALUD=В,RВ=A
;ЕСЛИ N МОД. = 0, ЗАПИСИ НЕ Д.БЫТЬ, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZА,RА=DADR,ALUD=В,RВ=A
MZ15:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
;КОП ПК - В МЛ.РАЗРЯДЫ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+20,SHF=LOG
;ПРОВЕРЯЕМ КОП НА ДОП. ФОРМАТ (3F)
CONT A=H3F,DSRC=PROM,ALUS=DA,RA=A,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,ALUD=Q,CEM
CJP A=DFC15R,MAP=PE,COND=CT,STOPC=/MZ
;ЕСЛИ ДОП.ФОРМАТ, КОП = 13-20 РАЗРЯДАМ АДРЕСА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+12,SHF=LOG
;ЧИТАЕМ, СРАВНИВАЕМ
DFC15R:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ВЫЧИСЛЯЕМ АДРЕС КОМАНДЫ, РАЗМНОЖАЕМ 20 РАЗРЯД, СРАВНИВАЕМ
;СДВИГАЕМ ЛОГ. ВЛЕВО, ЗАТЕМ АРИФМ.ВПРАВО НА 44, EOR 32 РАЗРЯДА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-44,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ ДОП.ФОРМАТ, ОСТАВЛЯЕМ У АК ТОЛЬКО 12 РАЗРЯДОВ
CJP A=DFA15R,MAP=PE,COND=CT,STOPC=/MZ,ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
DFA15R:CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ЧИТАЕМ ЛЕВУЮ КОМАНДУ
CONT FFCNT=CLRTKK
;03: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=WR2,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CJP А=MDZ15,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZА,RА=РССОРУ,ALUD=В,RВ=A
;ЕСЛИ N МОД. = 0, ЗАПИСИ НЕ Д.БЫТЬ, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZА,RА=DADR,ALUD=В,RВ=A
MDZ15:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;04: К О П
;КОП ЛК - В МЛ.РАЗРЯДЫ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+52,SHF=LOG
;ПРОВЕРЯЕМ КОП НА ДОП. ФОРМАТ (3F)
CONT A=H3F,DSRC=PROM,ALUS=DA,RA=A,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,ALUD=Q,CEM
CJP A=DFC15L,MAP=PE,COND=CT,STOPC=/MZ
;ЕСЛИ ДОП.ФОРМАТ, КОП = 13-20 РАЗРЯДАМ АДРЕСА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=LOG
;ЧИТАЕМ, СРАВНИВАЕМ
DFC15L:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=BYTE,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ВЫЧИСЛЯЕМ АДРЕС КОМАНДЫ, РАЗМНОЖАЕМ 20 РАЗРЯД, СРАВНИВАЕМ
;СДВИГАЕМ ЛОГ. ВЛЕВО, ЗАТЕМ АРИФМ.ВПРАВО НА 44, EOR БЕЗ Н
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-12,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ ДОП.ФОРМАТ, ОСТАВЛЯЕМ У АК ТОЛЬКО 12 РАЗРЯДОВ
CJP A=DFA15R,MAP=PE,COND=CT,STOPC=/MZ,ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;МЕНЯЕМ КОМАНДНОЕ СЛОВО
CONT ALUS=АВ,RА=WR1,RВ=WR3,Н,ALUD=В,ALU,ЕСВ,WRB,BRA=RG1,FFCNT=SЕТТКК
%J% А=CSTBF,МАР=РЕ,%TIK%
;
;
СТНДC0:ENTRY
;===== КОМАНДНОЕ СЛОВО C "БЕГУЩЕЙ" ЕДИНИЦЕЙ В НОВОМ РЕЖИМЕ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ВУТЕ   - МАСКА НА 8 РАЗРЯДОВ
;   DADR   - МАСКА НА 4 РАЗРЯДА, ЧИСЛО ДЛЯ ЗАПИСИ В М0
;   РС     - МАСКА НА 20 РАЗРЯДОВ
;   WR3    - КОМАНДНОЕ СЛОВО
;   РССОРУ - ЧИСЛО ДЛЯ ЗАПИСИ ПО АДРЕСУ IRA
;   WR2    - РАБОЧИЙ РЕГИСТР
;
;    64  61 60   53 52       33 32  29 28    21 20        1
;   I-----I--------I-----------I------I--------I-----------I
;   IИР ЛKI КОП ЛК I   АК ЛК   IИР ЛК I КОП ЛК I   АК ЛК   I
;   I-----I--------I-----------I------I--------I-----------I
;
CJP А=PSSTC0,МАР=РЕ
PSSTC0:CONT А=НC0,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА - В РГ. DADR, В 0-Й МОДИФИКАТОР
CONT А=HF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;МАСКУ НА 20 РАЗРЯДОВ - В РГ. РС
CONT А=MADR,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ДЛЯ КОМАНДНОГО СЛОВА - В WR3, В RG1
CONT А=B1,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3,ALU,ЕСВ,WRB,BRA=RG1
;ДЛЯ ЗАПИСИ В МОДИФИКАТОР
CONT А=CTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,FFCNT=SЕТТКК
;
;ПРАВАЯ КОМАНДА:
;00: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CSTC0:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+28
>,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=WR2,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CJP А=MZ25,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZА,RА=РССОРУ,ALUD=В,RВ=A
;ЕСЛИ N МОД. = 0, ЗАПИСИ НЕ Д.БЫТЬ, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZА,RА=DADR,ALUD=В,RВ=A
MZ25:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
;КОП ПК - В МЛ.РАЗРЯДЫ; ЧИТАЕМ, СРАВНИВАЕМ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+20,SHF=LOG
;У "БЕГУЩЕЙ" ЕДИНИЦЫ ДОП. ФОРМАТА (3F) НЕ М.БЫТЬ, НЕ ПРОВЕРЯЕМ
CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ВЫЧИСЛЯЕМ АДРЕС КОМАНДЫ, РАЗМНОЖАЕМ 20 РАЗРЯД, СРАВНИВАЕМ
;СДВИГАЕМ ЛОГ. ВЛЕВО, ЗАТЕМ АРИФМ.ВПРАВО НА 44, EOR 32 РАЗРЯДА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-44,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ЧИТАЕМ ЛЕВУЮ КОМАНДУ
CONT FFCNT=CLRTKK
;03: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=WR2,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CJP А=MDZ25,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZА,RА=РССОРУ,ALUD=В,RВ=A
;ЕСЛИ N МОД. = 0, ЗАПИСИ НЕ Д.БЫТЬ, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZА,RА=DADR,ALUD=В,RВ=A
MDZ25:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;04: К О П
;КОП ЛК - В МЛ.РАЗРЯДЫ (НА ДОП. ФОРМАТ (3F) НЕ ПРОВЕРЯЕМ)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+52,SHF=LOG
CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=BYTE,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ВЫЧИСЛЯЕМ АДРЕС КОМАНДЫ, РАЗМНОЖАЕМ 20 РАЗРЯД, СРАВНИВАЕМ
;СДВИГАЕМ ЛОГ. ВЛЕВО, ЗАТЕМ АРИФМ.ВПРАВО НА 44, EOR БЕЗ Н
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-12,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СДВИГАЕМ ЦИКЛИЧЕСКИ КОМАНДНОЕ СЛОВО
CONT ALUS=DZ,H,ALUD=ВA,RA=WR3,RB=WR3,ALU,DSRC=SHIFT,MPS,PSHF=SH0-1,SHF=CICL
>,ЕСA,WRA,ARA=RG1,FFCNT=SЕТТКК
%J% А=CSTC0,МАР=РЕ,%TIK%
;
;   ==========================================================
;   ПРИ ЗАПУСКЕ ТЕСТОВ СТАНДАРТИЗАТОРА В РЭ РЭ УСТАНАВЛИВАЕТСЯ
;       ПОЛЕМ FFCNT ИЛИ ПРИ ЧТЕНИИ КОМАНДЫ ИЗ ПАМЯТИ !!!!!
;   ==========================================================
;          ПРИ ЧТЕНИИ КОП В КОРОТКОАДРЕСНЫХ КОМАНДАХ
;      7-Й РАЗРЯД КОП НЕ ОБНУЛЯЕТСЯ В СТАНДАРТИЗАТОРЕ !!!!!
;   ==========================================================
;
СТНДC1:ENTRY
;===== РАЗНЫЕ ФОРМАТЫ КОМАНДНОГО СЛОВА В РЕЖИМЕ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ВУТЕ - МАСКА НА БАЙТ
;   WR1  - 7000 - ДОПОЛНЕНИЕ К КОРОТКОМУ АДРЕСУ
;   HALF - МАСКА НА 15 Р.
;   РС   - М0
;   DADR - С0 (ДЛЯ СРАВНЕНИЯ КОП)
;
;ДЛИННОАДРЕСНЫЙ КОП:
;   64 63 60 59 57 56(1) 52 51       37 36 33 32(1) 28 27       13 12  1
;   I--I-----I-----I--------I-----------I-----I--------I-----------I-----I
;   IИPI/////IИР ЛKI КОП ЛК I   АК ЛК   IИР ПKI КОП ПК I   АК ПК   I/////I
;   I--I-----I-----I--------I-----------I-----I--------I-----------I-----I
;   64 63 60 59 57 56(0) 49 48       37 36 33 32(0) 25 24       13 12  1
;КОРОТКОАДРЕСНЫЙ КОП:
;
CJP А=PSSTC1,МАР=РЕ
PSSTC1:CONT А=НC1,%T%
%S% А=INITST,МАР=РЕ
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС РС, В 0 МОДИФ.
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА КОРОТКИЙ АДРЕС С ДОБАВЛ."1" (7000) - В WR1
CONT А=САК,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1
;
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;3 - В АИСП, RG3 TEGA
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;>,ЕСА,WRA,ARA=RG3
;ФИЗ.АДРЕС - В RG0
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAW16:CJP А=WAW16,МАР=РЕ,COND=ARBRDY,IСС
;ЧИТАЕМ ПО ТОМУ ЖЕ АДРЕСУ
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR16:CJP А=WAR16,МАР=РЕ,COND=ARBRDY,IСС
;
;===== ДЛИННОАДРЕСНЫЙ КОП
;КОМ.СЛОВО: "1" В 56 И В 32 РАЗРЯДЕ
CSTC1:CONT А=В56,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR6
CONT А=В32,DSRC=PROM,ALUS=DА,RА=WR6,FUNC=OR,Н,ALUD=В,RВ=WR6,ALU,ЕСВ,WRB
>,BRA=RG1,FFCNT=CLRTKK
;
;INTR=0; ЛК: АДРЕС КОМАНДЫ (ЕСЛИ 32 Р.=0, 16-32 РАЗРЯДЫ ЗАПОЛНЯЮТСЯ 0)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=1; К О П: СРАВНИВАЕМ С 1 В 8 РАЗРЯДЕ
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT А=В8,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=АB,RА=У,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=2; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;INTR=3; ПК: АДРЕС КОМАНДЫ (32 РАЗРЯДА = 0)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=4; К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT А=В8,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=5; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ФОРМИРУЕМ КОМ.СЛОВО С 1 В 56,55; 32,31; 1-15 РАЗРЯДАХ
CONT ALUS=DА,FUNC=OR,Н,ALUD=ВА,RА=WR6,RВ=WR6,ALU,DSRC=SHIFT,MPS,PSHF=SН0+1
>,SHF=LOG,FFCNT=CLRTKK
CONT ALUS=АВ,RА=HALF,RВ=WR6,FUNC=OR,Н,ALUD=В,ALU,ЕСВ,WRB,BRA=RG1
;ЧИТАЕМ "1" В 7-8 РАЗРЯДАХ ДЛЯ СРАВНЕНИЯ КОП'А (С0)
CONT А=НС0,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;
;INTR=6; ЧИТАЕМ ЛК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=7; К О П: СРАВНИВАЕМ С 1 В 8,7 РАЗРЯДАХ
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=8; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;INTR=9; ПК: АДРЕС КОМАНДЫ (32 РАЗРЯДА, 1-3 Р. = 1, ОСТАЛЬНЫЕ "1" - МИМО)
CONT A=C7,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=У,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=A; К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=B; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;===== КОРОТКОАДРЕСНЫЙ КОП
;КОМ.СЛОВО: "1" В 55 И В 31 РАЗРЯДЕ
CONT А=В55,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR6,FFCNT=CLRTKK
CONT А=В31,DSRC=PROM,ALUS=DА,RА=WR6,Н,ALUD=В,RВ=WR6,ALU,ЕСВ,WRB,BRA=RG1
;
;INTR=C; ЛК: АДРЕС КОМАНДЫ = 7000, 13-15 РАЗРЯДЫ = 1
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=WR1,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=D; К О П, 7-Й РАЗРЯД НЕ ОБНУЛЯЕТСЯ В СТАНДАРТИЗАТОРЕ !!!!!
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT A=B7,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=E; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;INTR=F; ПК: АДРЕС КОМАНДЫ, 13-15 РАЗРЯДЫ = 1
CONT ALUS=ZA,RA=WR1,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=10; К О П, 7-Й РАЗРЯД НЕ ОБНУЛЯЕТСЯ В СТАНДАРТИЗАТОРЕ !!!!!
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT A=B7,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=11; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSTC1,МАР=РЕ,%TIK%
;
СТНДC2:ENTRY
;===== КОМАНДНОЕ СЛОВО = "0",  РЕЖИМ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК ЛК (ПК)
;           01 (05): - " -  КОП ЛК (ПК)
;           02 (06): ЕСТЬ ПРИЗНАК ИР15 В ЛК (ПК)
;           03 (07): СИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК);
;   ВУТЕ - МАСКА НА БАЙТ, РС - ЗАПИСАННОЕ В М0
;
CJP А=PSSTC2,МАР=РЕ
PSSTC2:CONT А=НC2,%T%
%S% А=INITST,МАР=РЕ
;БП,БПТЗ = 1
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС РС, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
;0 - В RG1 (КОМАНДНОЕ СЛОВО)
CONT ALUS=ZА,FUNC=AND,Н,ALU,ЕСВ,WRB,BRA=RG1,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;МАТ.АДРЕС - В АИСП, РЭ (1,2Р.=1) - В ТЕГ
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WА17:CJP А=WА17,МАР=РЕ,COND=ARBRDY,IСС
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR17:CJP А=WAR17,МАР=РЕ,COND=ARBRDY,IСС
;
;00: ЧИТАЕМ ЛК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CSTC2:CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=CLRTKK
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ ОТСУТСТВИЕ ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;03: ЧИТАЕМ ПО АДРЕСУ IRA
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ПРОВЕРЯЕМ ПК: ЧИТАЕМ АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ПРИЗНАК ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSTC2,МАР=РЕ,%TIK%
;
;
СТНДC3:ENTRY
;===== КОМАНДНОЕ СЛОВО = FF...FF, РЕЖИМ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК ЛК (ПК)
;           01 (05): - " -  КОП ЛК (ПК)
;           02 (06): НЕТ ПРИЗНАКА ИР15 В ЛК (ПК)
;           03 (07): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК)
;  ВУТЕ - МАСКА НА БАЙТ; HALF - НА 15Р.; DADR = F8 - НА КОРОТКИЙ КОП; РС - SР
;
CJS А=PSSTC3,МАР=РЕ
PSSTC3:CONT А=НC3,%T%
%S% А=INITST,МАР=РЕ
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
;МАСКУ НА 15 РАЗР.- В РГ.HALF
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА КОРОТКИЙ КОП (F8) - DADR
CONT А=HF8,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;CONST - В РГ.МПС РС, В 15 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA)
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ, FF...FF - В RG1 БОИ
CONT А=CFFF,DSRC=PROM,ЕСА,WRA,ARA=RG1,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAW18:CJP А=WAW18,МАР=РЕ,COND=ARBRDY,IСС
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR18:CJP А=WAR18,МАР=РЕ,COND=ARBRDY,IСС
;
;00: ПРОВЕРЯЕМ ЛК: ЧИТАЕМ АДРЕС КОМАНДЫ (32Р.), 15 РАЗРЯДОВ = 7FFF, ОСТАЛЬН.= 0
CSTC3:CONT A=M15,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=CLRTKK
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П (МАСКА И СРАВНЕНИЕ С F8)
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;03: ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ПРОВЕРЯЕМ ПК: ЧИТАЕМ АДРЕС КОМАНДЫ (32 РАЗРЯДА), МЛ.15 = 1...1
CONT A=M15,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CSTC3,МАР=РЕ,%TIK%
;
;
СТНДC4:ENTRY
;===== КОМАНДНОЕ СЛОВО = 0...0(ЛК) F...F(ПК) И НАОБОРОТ; РЕЖИМ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК КОМАНДЫ 0 (F...F)
;           01 (05): - " -  КОП КОМАНДЫ 0 ((F...F)
;           02 (06): НЕ ТОТ ПРИЗНАК ИР15 В КОМАНДЕ 0 (F...F)
;           03 (07): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA КОМАНДЫ 0 (F...F)
;   ВУТЕ - МАСКА НА БАЙТ; WR1 = F8 - НА КОРОТКИЙ КОП; HALF - НА 15Р.;
;   РС - ЗАПИСАННОЕ В М0; РССОРУ - В ИР15; WR3 - ТЕКУЩЕЕ КОМАНДНОЕ СЛОВО
;
CJP А=PSSTC4,МАР=РЕ
PSSTC4:CONT А=НC4,%T%
%S% А=INITST,МАР=РЕ
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА КОРОТКИЙ КОП В РЭ (F8) - В РГ. WR1
CONT А=С7,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,Н,ALUD=В,RВ=WR1
;CONST - В РГ.МПС РС, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA ЛК)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ДРУГУЮ CONST - В РГ.МПС РССОРУ И ПО АДРЕСУ IRA ПК
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;ПИШЕМ КОМАНДНОЕ СЛОВО (0...0F...F) - В RG1, ВОДОРАЗДЕЛ - МЕЖДУ 37,36 РАЗРЯДАМИ
CONT А=В37,DSRC=PROM,ALUS=DZ,FUNC=SUBS,Н,ALUD=В,RВ=WR3,ALU,ЕСВ,WRB,BRA=RG1
;
;ФОРМИРУЕМ РЭ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ, МАСКУ НА АДРЕС - В HALF
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAW19:CJP А=WAW19,МАР=РЕ,COND=ARBRDY,IСС
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR19:CJP А=WAR19,МАР=РЕ,COND=ARBRDY,IСС
;
;00: ЧИТАЕМ КОМАНДУ 0...0: АДРЕС КОМАНДЫ (32 РАЗРЯДА = 0)
CSTC4:CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;03: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA (М0)
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ПК, F...F: АДРЕС КОМАНДЫ (32 РАЗРЯДА, ИЗ КОТОРЫХ 1-15 = F...F)
CONT A=M15,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=СНТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П, СРАВНИВАЕМ С F8:
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=WR1,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;07: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA (SР)
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ИНВЕРТИРУЕМ КОМАНДНОЕ СЛОВО, НЕ МЕНЯЯ ТКК; ИДЕМ НА ЦИКЛ
CONT ALUS=ZА,RА=WR3,FUNC=EXNOR,Н,ALUD=В,RВ=WR3,ALU,ЕСВ,WRB,BRA=RG1
%J% А=CSTC4,МАР=РЕ,%TIK%
;
;
СТНДC5:ENTRY
;===== ПЕРЕМЕННОЕ КОМАНДНОЕ СЛОВО В РЕЖИМЕ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (03): ЧИТАЕМ АК ЛК (ПК)
;           01 (04): - " -  КОП ЛК (ПК)
;           02 (05): - " -  МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК);
;   ВУТЕ - МАСКА НА БАЙТ; HALF - НА 13-15Р.; DADR - НА 4Р. И М0; РС - НА 15Р.
;   WR3 - КОМАНДНОЕ СЛОВО; РССОРУ - IRA; WR1 - ДОБАВКА К КОМ.СЛОВУ; WR2 - РАБ.
;
CJP А=PSSTC5,МАР=РЕ
PSSTC5:CONT А=НC5,%T%
%S% А=INITST,МАР=РЕ
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAW:CJP А=WAW,МАР=РЕ,COND=ARBRDY,IСС
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR:CJP А=WAR,МАР=РЕ,COND=ARBRDY,IСС
;
;МАСКУ НА 13-15 РАЗР.ДЛЯ АК - В HALF
CONT А=САК,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;МАСКУ НА 15 РАЗР.- В РС
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА - В РГ. DADR, В М0
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ДЛЯ КОМАНДНОГО СЛОВА - В WR3, В КОМ.СЛОВО
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3,ЕСА,WRA,ARA=RG1
;ДЛЯ ЗАПИСИ В МОДИФИКАТОР
CONT А=CTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ
;ЧИТАЕМ CONST С "1" В РАЗНЫХ РАЗРЯДАХ (ДОБАВКА К КОМ.СЛОВУ)
CONT А=СОРС,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1,FFCNT=SЕТТКК
;
;00: ПК, АДРЕС КОМАНДЫ
;"ВЫЧИСЛЯЕМ" АК ПО КОМ.СЛОВУ; СНАЧАЛА ПРОВЕРЯЕМ СТ.РАЗРЯД КОП
CSTC5:CONT А=В32,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,СЕМ
;И СЛЕДУЮЩИЙ
CONT А=В31,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,CEN
;АДРЕС КОМАНДЫ - В МЛ.РАЗРЯДЫ, П/У, ЕСЛИ СТ.РАЗРЯД КОП = 1
CJP А=LONG,МАР=РЕ,COND=СТ,SТОРС=/MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+12,SHF=LOG
;СТ.РАЗРЯД КОП=0, АДРЕС = КОРОТКИЙ, НАДО ВПРАВЛЯТЬ 13-15 РАЗРЯДЫ
;ПОДСТАВЛЯЕМ 1, ЕСЛИ 7 РАЗРЯД КОП = 1
CJP А=LONG,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=АВ,RА=HALF,RВ=A,FUNC=OR,ALUD=В
;ИНАЧЕ ПОДСТАВЛЯЕМ 0
CONT ALUS=АВ,RА=HALF,RВ=A,FUNC=EXOR,ALUD=В
;СРАВНИВАЕМ 15 РАЗРЯДОВ
LONG:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П, 7-Й РАЗРЯД НЕ ОБНУЛЯЕМ !!!!!
;КОП ПК - В МЛ.РАЗРЯДЫ; ПРОВЕРЯЕМ, ДЛИННЫЙ ЛИ КОП
CJP А=RОРСR,МАР=РЕ,COND=СТ,SТОРС=MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+24,SHF=LOG
;КОП = 5 РАЗРЯДОВ, ОБНУЛЯЕМ МЛ.3 РАЗРЯДА КОП (ТАМ ДЛИННЫЙ АДРЕС)
CONT А=С7,DSRC=PROM,ALUS=DА,RА=A,FUNC=NOTRS,ALUD=В,RВ=A
;CJP A=ROPCR,MAP=PE
;КОП = 8 РАЗРЯДОВ, ЧТО С 7 РАЗРЯДОМ ?
;OPCB7:CONT A=B7,DSRC=PROM,ALUS=DA,RA=A,FUNC=NOTRS,ALUD=B,RB=A
;ЧИТАЕМ, СРАВНИВАЕМ
ROPCR:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+32,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=A,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ N МОД. = 0, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0 РАНЬШЕ
CJP А=MD0,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РССОРУ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
MD0:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;03: ЛК, АДРЕС КОМАНДЫ
;"ВЫЧИСЛЯЕМ" АК ПО КОМ.СЛОВУ; СНАЧАЛА ПРОВЕРЯЕМ СТ.РАЗРЯД КОП
CONT А=В56,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,СЕМ,FFCNT=CLRTKK
;И СЛЕДУЮЩИЙ
CONT А=В55,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,CEN
;АДРЕС КОМАНДЫ - В МЛ.РАЗРЯДЫ
CJP А=LONGR,МАР=РЕ,COND=СТ,SТОРС=/MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+36,SHF=LOG
;СТ.РАЗРЯД КОП=0, АДРЕС = КОРОТКИЙ, НАДО ВПРАВЛЯТЬ 13-15 РАЗРЯДЫ
;ПОДСТАВЛЯЕМ 1, ЕСЛИ 7 РАЗРЯД КОП = 1
CJP А=LONGR,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=АВ,RА=HALF,RВ=A,FUNC=OR,ALUD=В
;ИНАЧЕ ПОДСТАВЛЯЕМ 0
CONT ALUS=АВ,RА=HALF,RВ=A,FUNC=EXOR,ALUD=В
;СРАВНИВАЕМ 15 РАЗРЯДОВ
LONGR:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=РС,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;04: К О П
;КОП ЛК - В МЛ.РАЗРЯДЫ, ПРОВЕРЯЕМ, ДЛИННЫЙ ЛИ КОП
CJP А=RDOPCL,МАР=РЕ,COND=СТ,SТОРС=MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+48,SHF=LOG
;ОБНУЛЯЕМ МЛ.3 РАЗРЯДА КОП, ЕСЛИ ОН КОРОТКИЙ
CONT А=С7,DSRC=PROM,ALUS=DА,RА=A,FUNC=NOTRS,ALUD=В,RВ=A
;CJP A=RDOPCL,MAP=PE
;УБИРАЕМ 7-Й РАЗРЯД КОП
;ОРСLNG:CONT A=B7,DSRC=PROM,ALUS=DA,RA=A,FUNC=NOTRS,ALUD=B,RB=A
;ЧИТАЕМ, СРАВНИВАЕМ
RDOPCL:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
;СНАЧАЛА УБИРАЕМ "ДЫРУ" В ПОРЯДКЕ (СДВИГ АРИФМ.ВЛЕВО НА 4)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-4,SHF=ARIPH
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=A,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ N МОД. = 0, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CJP А=MDR0,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РССОРУ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
MDR0:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;МЕНЯЕМ КОМАНДНОЕ СЛОВО
CONT ALUS=АВ,RА=WR1,RВ=WR3,Н,ALUD=В,ALU,ЕСВ,WRB,BRA=RG1,FFCNT=SЕТТКК
%J% А=CSTC5,МАР=РЕ,%TIK%
;
;
СТНДC6:ENTRY
;===== КОМАНДНОЕ СЛОВО С "БЕГУЩЕЙ" ЕДИНИЦЕЙ В РЕЖИМЕ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (03): ЧИТАЕМ АК ЛК (ПК)
;           01 (04): - " -  КОП ЛК (ПК)
;           02 (05): - " -  МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК);
;   ВУТЕ - МАСКА НА БАЙТ; HALF - НА 13-15Р.; DADR - НА 4Р. И М0; РС - НА 15Р.
;   WR3 - КОМАНДНОЕ СЛОВО; РССОРУ - IRA; WR2 - РАБОЧИЙ.
;
CJP А=PSSTC6,МАР=РЕ
PSSTC6:CONT А=НC6,%T%
%S% А=INITST,МАР=РЕ
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT,FFCNT=SETER
;МАСКУ НА 13-15 РАЗР.ДЛЯ АК - В HALF
CONT А=САК,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;МАСКУ НА 15 РАЗР.- В РС
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА - В РГ. DADR, В М0
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ДЛЯ КОМАНДНОГО СЛОВА - В WR3, В КОМ.СЛОВО
CONT А=B1,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3,ЕСА,WRA,ARA=RG1
;ДЛЯ ЗАПИСИ В МОДИФИКАТОР
CONT А=CTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,FFCNT=SЕТТКК
;
;00: ПК, АДРЕС КОМАНДЫ
;"ВЫЧИСЛЯЕМ" АК ПО КОМ.СЛОВУ; СНАЧАЛА ПРОВЕРЯЕМ СТ.РАЗРЯД КОП
CSTC6:CONT А=В32,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,СЕМ
;И СЛЕДУЮЩИЙ
CONT А=В31,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,CEN
;АДРЕС КОМАНДЫ - В МЛ.РАЗРЯДЫ, П/У, ЕСЛИ СТ.РАЗРЯД КОП = 1
CJP А=LONGB,МАР=РЕ,COND=СТ,SТОРС=/MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+12,SHF=LOG
;СТ.РАЗРЯД КОП=0, АДРЕС = КОРОТКИЙ, НАДО ВПРАВЛЯТЬ 13-15 РАЗРЯДЫ
;ПОДСТАВЛЯЕМ 1, ЕСЛИ 7 РАЗРЯД КОП = 1
CJP А=LONGB,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=АВ,RА=HALF,RВ=A,FUNC=OR,ALUD=В
;ИНАЧЕ ПОДСТАВЛЯЕМ 0
CONT ALUS=АВ,RА=HALF,RВ=A,FUNC=EXOR,ALUD=В
;СРАВНИВАЕМ 15 РАЗРЯДОВ
LONGB:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П, 7-Й РАЗРЯД НЕ ОБНУЛЯЕМ !!!!!
;КОП ПК - В МЛ.РАЗРЯДЫ; ПРОВЕРЯЕМ, ДЛИННЫЙ ЛИ КОП
CJP А=RОРСRB,МАР=РЕ,COND=СТ,SТОРС=MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+24,SHF=LOG
;КОП = 5 РАЗРЯДОВ, ОБНУЛЯЕМ МЛ.3 РАЗРЯДА КОП (ТАМ ДЛИННЫЙ АДРЕС)
CONT А=С7,DSRC=PROM,ALUS=DА,RА=A,FUNC=NOTRS,ALUD=В,RВ=A
;CJP A=ROPCRB,MAP=PE
;КОП = 8 РАЗРЯДОВ, ЧТО С 7 РАЗРЯДОМ ?
;OPCB7B:CONT A=B7,DSRC=PROM,ALUS=DA,RA=A,FUNC=NOTRS,ALUD=B,RB=A
;ЧИТАЕМ, СРАВНИВАЕМ
ROPCRB:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+32,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=A,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ N МОД. = 0, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0 РАНЬШЕ
CJP А=MD0B,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РССОРУ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
MD0B:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;03: ЛК, АДРЕС КОМАНДЫ
;"ВЫЧИСЛЯЕМ" АК ПО КОМ.СЛОВУ; СНАЧАЛА ПРОВЕРЯЕМ СТ.РАЗРЯД КОП
CONT А=В56,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,СЕМ,FFCNT=CLRTKK
;И СЛЕДУЮЩИЙ
CONT А=В55,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,CEN
;АДРЕС КОМАНДЫ - В МЛ.РАЗРЯДЫ
CJP А=LONGRB,МАР=РЕ,COND=СТ,SТОРС=/MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+36,SHF=LOG
;СТ.РАЗРЯД КОП=0, АДРЕС = КОРОТКИЙ, НАДО ВПРАВЛЯТЬ 13-15 РАЗРЯДЫ
;ПОДСТАВЛЯЕМ 1, ЕСЛИ 7 РАЗРЯД КОП = 1
CJP А=LONGRB,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=АВ,RА=HALF,RВ=A,FUNC=OR,ALUD=В
;ИНАЧЕ ПОДСТАВЛЯЕМ 0
CONT ALUS=АВ,RА=HALF,RВ=A,FUNC=EXOR,ALUD=В
;СРАВНИВАЕМ 15 РАЗРЯДОВ
LONGRB:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=РС,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;04: К О П
;КОП ЛК - В МЛ.РАЗРЯДЫ, ПРОВЕРЯЕМ, ДЛИННЫЙ ЛИ КОП
CJP А=RDLB,МАР=РЕ,COND=СТ,SТОРС=MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+48,SHF=LOG
;ОБНУЛЯЕМ МЛ.3 РАЗРЯДА КОП, ЕСЛИ ОН КОРОТКИЙ
CONT А=С7,DSRC=PROM,ALUS=DА,RА=A,FUNC=NOTRS,ALUD=В,RВ=A
;CJP A=RDLB,MAP=PE
;УБИРАЕМ 7-Й РАЗРЯД КОП
;LNGB:CONT A=B7,DSRC=PROM,ALUS=DA,RA=A,FUNC=NOTRS,ALUD=B,RB=A
;ЧИТАЕМ, СРАВНИВАЕМ
RDLB:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
;СНАЧАЛА УБИРАЕМ "ДЫРУ" В ПОРЯДКЕ (СДВИГ АРИФМ.ВЛЕВО НА 4)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-4,SHF=ARIPH
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=A,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ N МОД. = 0, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CJP А=MDR0B,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РССОРУ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
MDR0B:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СДВИГАЕМ КОМАНДНОЕ СЛОВО
CONT ALUS=DZ,Н,ALUD=ВA,RA=WR3,RB=WR3,ALU,DSRC=SHIFT,MPS,PSHF=SH0-1,SHF=CICL
>,ЕСA,WRA,ARA=RG1,FFCNT=SЕТТКК
%J% А=CSTC6,МАР=РЕ,%TIK%
;
;     =======================================
;     ОЗУ МОДИФИКАТОРОВ С БОИ  ( MNSA = IRA )
;     =======================================
;
MOДC7:ENTRY
;===== ПИШЕМ 0/F - В 4-Й МОДИФИКАТОР; АДРЕС МОДИФ.- B IRA, В RG1(!); ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMDC7,МАР=РЕ
PSMDC7:CONT А=HC7,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;КОМАНДУ С НОМЕРОМ ИР = 4 В ПРАВОЙ КОМАНДЕ -> В РЕГИСТР КОМАНД, ТКК = ПК
CONT А=В31,DSRC=PROM,ЕСА,WRA,ARA=RG1,FFCNT=SЕТТКК
;ЦИКЛ: ПИШЕМ В 4-Й МОДИФИКТОР
CMODC7:CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALUD=В,RВ=А,ALU,CSM,WЕМ,MNSA=IRA
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMODC7,МАР=РЕ,%TIK%
;
;
МОДC8:ENTRY
;===== ПИШЕМ ПЕРЕМЕННУЮ - ВО 2-Й МОД.; АДРЕС МОДИФ.- В RG1(!); ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMDC8,МАР=РЕ
PSMDC8:CONT А=НC8,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;КОМАНДУ С НОМЕРОМ ИР = 2 В ПРАВОЙ КОМАНДЕ -> В РЕГИСТР КОМАНД, ТКК = ПК
CONT А=В30,DSRC=PROM,ЕСА,WRA,ARA=RG1,FFCNT=SЕТТКК
;ЦИКЛ: ПИШЕМ ВО 2-Й МОДИФИКТОР
CMODC8:CONT ALUS=ZВ,RВ=А,FUNC=ADD,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=IRA
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMODC8,МАР=РЕ,%TIK%
;
;
МОДC9:ENTRY
;===== ПИШЕМ ИНВЕРТ.АДРЕС РГ. В МЛ.15 РГ.КАЖДОЙ ГРУППЫ;АДРЕС МОД.- В RG1, НР!
;   РС = N РЕГИСТРА ПК В КОМ.СЛОВЕ; А = ИНВЕРТИРОВАННЫЙ РС - ЧТО ЗАПИСАЛИ;
;   У - ЧТО ЧИТАЕМ; DADR - НОМЕР ГРУППЫ;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMDC9,МАР=РЕ
PSMDC9:CONT А=НC9,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN,FFCNT=SЕТТКК
;IRA = 1 - В РС: НОМЕР РЕГИСТРА В ГРУППЕ
CONT А=В29,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ПИШЕМ ИНВЕРТИР.КОМ.СЛОВО В РЕГИСТРЫ; АДРЕС - ИЗ РГ.КОМАНД
LСC9:CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,CSM,WЕМ,MNSA=IRA
;УВЕЛИЧИВАЕМ N РЕГ., СРАВНИВАЕМ С IRA=17 ("1" В 33 РАЗРЯДЕ)
CONT А=В29,DSRC=PROM,ALUS=DА,RА=РС,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CONT А=В33,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,Н,CEN
CJP А=LСC9,МАР=РЕ,COND=СТ,SТОРС=/NZ
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;ЧТЕНИЕ
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
МСC9:PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;IRA = 1 РГ.
CONT А=В29,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ВЫЧИСЛЯЕМ ИНВЕРТИРОВАННЫЙ НОМЕР РЕГИСТРА
NNC19:CONT ALUS=ZА,RА=РС,FUNC=EXNOR,Н,ALUD=В,RВ=А
;ЧИТАЕМ ПЕРЕМЕННУЮ ИЗ ОЗУ МОД.,СРАВНИВАЕМ
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
;УВЕЛИЧИВАЕМ НОМЕР РЕГИСТРА
CONT А=В29,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,Н,ALUD=В,RВ=РС,ALU
>,ЕСВ,WRB,BRA=RG1
CONT А=В33,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,Н,CEN
CJP А=NNC19,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
%J% А=МСC9,МАР=РЕ
;
;
МОДCA:ENTRY
;===== ПИШЕМ ПЕРЕМЕННЫЙ КОД В МЛ.15 РГ.КАЖДОЙ ГРУППЫ;АДРЕС МОД.- В RG1,ПК,РЭ!!
;   РС = N РЕГИСТРА ПК В КОМ.СЛОВЕ; А = КОД, КОТОРЫЙ ПИШЕМ;
;   У - ЧТО ЧИТАЕМ; DADR - НОМЕР ГРУППЫ;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMDCA,МАР=РЕ
PSMDCA:CONT А=НCA,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETER
CONT A=ZER,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN,FFCNT=SЕТТКК
;IRA = 1 - В РС: НОМЕР РЕГИСТРА В ГРУППЕ
CONT А=В33,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ПИШЕМ ПЕРЕМЕННЫЙ КОД ИЗ РГ.A; АДРЕС МОД.- B РГ.КОМАНД
LСCA:CONT ALUS=ZА,RА=A,ALU,CSM,WЕМ,MNSA=IRA
;УВЕЛИЧИВАЕМ N РЕГ., СРАВНИВАЕМ С IRA=17 ("1" В 37 РАЗРЯДЕ)
CONT А=В33,DSRC=PROM,ALUS=DА,RА=РС,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CONT А=В37,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,Н,CEN
CJP А=LСCA,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=A,FUNC=ADD,CI,ALUD=B,RB=A
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;ЧТЕНИЕ
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
МCCA:CONT A=ZER,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;IRA = 1 РГ.
CONT А=В33,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ЧИТАЕМ ПЕРЕМЕННУЮ ИЗ ОЗУ МОД.,СРАВНИВАЕМ
NNCCA:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;УВЕЛИЧИВАЕМ НОМЕР РЕГИСТРА
CONT А=В33,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,Н,ALUD=В,RВ=РС,ALU
>,ЕСВ,WRB,BRA=RG1
CONT А=В37,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,Н,CEN
CJP А=NNСCA,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=A,FUNC=ADD,CI,ALUD=B,RB=A
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
%J% А=МСCA,МАР=РЕ
;
;
МОДCB:ENTRY
;===== ПИШЕМ ПЕРЕМЕННЫЙ КОД В МЛ.15 РГ.КАЖДОЙ ГРУППЫ;АДРЕС МОД.- В RG1,ЛК!!,РЭ
;   РС = N РЕГИСТРА ЛК В КОМ.СЛОВЕ; А = КОД, КОТОРЫЙ ПИШЕМ;
;   У - ЧТО ЧИТАЕМ; DADR - НОМЕР ГРУППЫ;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMDCB,МАР=РЕ
PSMDCB:CONT А=НCB,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETER
CONT A=ZER,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN,FFCNT=CLRТКК
;IRA = 1 - В РС: НОМЕР РЕГИСТРА В ГРУППЕ
CONT А=В57,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ПИШЕМ ПЕРЕМЕННЫЙ КОД ИЗ РГ.A; АДРЕС МОД.- B РГ.КОМАНД
LСCB:CONT ALUS=ZА,RА=A,ALU,CSM,WЕМ,MNSA=IRA
;УВЕЛИЧИВАЕМ N РЕГ., СРАВНИВАЕМ С IRA=8 (ЧТОБ "ОБОЙТИ" ДЫРУ В ПОРЯДКЕ)
CONT А=В57,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CONT А=В60,DSRC=PROM,ALUS=DА,RА=РС,FUNC=AND,Н,ALUD=B,RB=Y
CONT А=В60,DSRC=PROM,ALUS=DА,RА=Y,FUNC=EXOR,Н,CEN
CJP А=LСCB,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=A,FUNC=ADD,CI,ALUD=B,RB=A
CONT А=В64,DSRC=PROM,ALUS=DА,RА=PC,FUNC=AND,Н,ALUD=B,RB=Y
CONT А=В64,DSRC=PROM,ALUS=DА,RА=Y,FUNC=EXOR,Н,CEN
CONT А=В64,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CJP A=LCCB,MAP=PE,COND=CT,STOPC=NZ
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;ЧТЕНИЕ
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
МCCB:CONT A=ZER,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;IRA = 1 РГ.
CONT А=В57,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ЧИТАЕМ ПЕРЕМЕННУЮ ИЗ ОЗУ МОД.,СРАВНИВАЕМ
NNCCB:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;УВЕЛИЧИВАЕМ НОМЕР РЕГИСТРА
CONT А=В57,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CONT А=В60,DSRC=PROM,ALUS=DА,RА=РС,FUNC=AND,Н,ALUD=B,RB=Y
CONT А=В60,DSRC=PROM,ALUS=DА,RА=Y,FUNC=EXOR,Н,CEN
CJP А=NNСCB,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=A,FUNC=ADD,CI,ALUD=B,RB=A
CONT А=В64,DSRC=PROM,ALUS=DА,RА=PC,FUNC=AND,Н,ALUD=B,RB=Y
CONT А=В64,DSRC=PROM,ALUS=DА,RА=Y,FUNC=EXOR,Н,CEN
CONT А=В64,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CJP A=NNCCB,MAP=PE,COND=CT,STOPC=NZ
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
%J% А=МСCB,МАР=РЕ
;
;
МОДCC:ENTRY
;===== ПИШЕМ АА/55 - В 0-Й МОДИФИКАТОР (АДР.- В МП); ЧИТАЕМ (АДР.- В RG1!!)
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMDCC,МАР=РЕ
PSMDCC:CONT А=НCC,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;CONST - В РГ.А
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
;0 - В РЕГИСТР КОМАНД (RG1); ТКК И РЕЖИМ - ЛЮБЫЕ!
CONT ALUS=DZ,FUNC=AND,Н,ALU,ЕСВ,WRB,BRA=RG1
;ЦИКЛ: ПИШЕМ В 0-Й МОДИФИКТОР
CMODCC:CONT ALUS=ZА,RА=А,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В РГ.КОМАНД!
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ИНВЕРТИРУЕМ РГ.А
%J% А=CMODCC,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В
;
;
MOДCD:ENTRY
;===== ПРОВЕРЯЕМ ЗАПРЕТ ЗАПИСИ В 0-Й МОДИФИКАТОР ПО АДРЕСУ ИЗ РГ.КОМАНД(!)
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ
;   ОШИБКИ: 00 - НЕТ ЗАПИСИ В 0 МОД.ИЗ МП;
;   01 - ЕСТЬ ЗАПИСЬ В 0-Й МОДИФИКАТОР ПО АДРЕСУ IRA, ЧИТАЕМ ИЗ МП.
;   02 -    -   "   -   , ЧИТАЕМ ПО АДРЕСУ IRA.
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMDCD,МАР=РЕ
PSMDCD:CONT А=HCD,%T%
%S% А=INITST,МАР=РЕ
;CONST - В РГ.А
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
;0 - В РЕГИСТР КОМАНД (RG1); ТКК И РЕЖИМ - ЛЮБЫЕ!
CONT ALUS=DZ,FUNC=AND,Н,ALU,ЕСВ,WRB,BRA=RG1
;ЦИКЛ: ПИШЕМ В 0-Й МОДИФИКТОР
CMODCD:CONT ALUS=ZА,RА=А,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;INTR = 00: ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В РГ.КОМАНД!
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;ПИШЕМ ИНВЕРТИР.CONST В 0-Й МОДИФИКТОР ПО IRA! ЗАПИСИ НЕ Д.БЫТЬ!
CONT ALUS=ZВ,RВ=А,FUNC=EXNOR,Н,ALUD=В,ALU,CSM,WЕМ,MNSA=IRA
;01: ЧИТАЕМ, АДРЕС МОДИФИКАТОРА - В МП
CONT CSM,MNSA=МР,MODNM=М0,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ СОВПАЛО!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
;02: ЧИТАЕМ, АДРЕС МОДИФИКАТОРА - В РГ.КОМАНД!
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ СОВПАЛО!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
%J% А=CMODCD,МАР=РЕ,%TIK%
;
;     =============================================
;     ИЗМЕНЕНИЕ РГ. К О П  АРБИТРА ПОСЛЕ ФИЗ.АДРЕСА
;     =============================================
;
КОПACE:ENTRY
;===== ЗАПИСЬ ФИЗ.АДРЕСОМ ИЗ МИКРОПРОГРАММЫ - В РГ.КОП АРБИТРА;ЧТЕНИЕ;СРАВНЕНИЕ
;   РГ.А - CONST, СООТВЕТСТВУЮЩАЯ КОП АРБИТРА; РГ.У - ЧТО ПРОЧИТАЛИ
;   ПРИ ОШ.: 11 РГ.БОПП - ЧТО ДОЛЖНО БЫТЬ; 15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;
CJP А=CONTCE,МАР=РЕ
CONTCE:CONT А=НCE,%Т%
%S% А=INITST,МАР=РЕ
CONT А=CTEST,ALUS=DZ,ALU,YDST=CNT,FFCNT=SETNR
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ
;ПИШЕМ ЧЕГО-НИБУДЬ В АИСП. И В RG0, ЧТОБ НЕ БЫЛО, НАПР. "0 МАТ.АДРЕСА" И Т.Д.
CONT А=С1,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,ЕСВ,WRB,BRA=RG0
;00: ПРОВЕРЯЕМ КОП АРБИТРА = 0, ЧИТАЕМ СООТВЕТСТВУЮЩУЮ CONST ИЗ ПЗУ ДЛЯ СРАВНЕНИЯ
ССАCE:CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=0
WА0:CJP А=WА0,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: КОП АРБИТРА = 1
CONT А=С1,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=CCRD
WА1:CJP А=WА1,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;02: КОП АРБИТРА = 2
CONT А=С2,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=CCWR
WА2:CJP А=WА2,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;03: КОП АРБИТРА = 3
CONT А=С3,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=DCRD
WА3:CJP А=WА3,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;04: КОП АРБИТРА = 4
CONT А=С4,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=DCWR
WА4:CJP А=WА4,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;05: КОП АРБИТРА = 8
CONT А=С8,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=FЕТСН
WА8:CJP А=WА8,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;06: КОП АРБИТРА = 9
CONT А=С9,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=DRD
WА9:CJP А=WА9,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;07: КОП АРБИТРА = 10
CONT А=С10,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=DWR
WА10:CJP А=WА10,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;08: КОП АРБИТРА = 11
CONT А=С11,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=RDMWR
WА11:CJP А=WА11,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;09: КОП АРБИТРА = 12
CONT А=С12,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=BTRWR
WА12:CJP А=WА12,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0A: КОП АРБИТРА = 13
CONT А=С13,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=BTRRD
WА13:CJP А=WА13,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0B: КОП АРБИТРА = 14
CONT А=С14,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=BICLR
WА14:CJP А=WА14,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0C: КОП АРБИТРА = 15
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=BIRD
WА15:CJP А=WА15,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=ССАCE,МАР=РЕ,%TIK%
;
;     =========================================================
;     ФИЗ.АДРЕС + ЗАПИСЬ N СТРАНИЦЫ В РФС + ИЗМЕНЕНИЕ БОБР,БИЗМ
;     =========================================================
;
ФИЗАCF:ENTRY
;===== Ф.А.+ N СТРАНИЦЫ В РФС + ИЗМЕНЕНИЕ БОБР,БИЗМ ПО 1 АДРЕСУ С БП=0,1
;   DADR - МАТ.АДРЕС; РС - ПРИПИСКА; HALF - ВЫЧИСЛЕННЫЙ ФИЗ.АДРЕС С БП=0;
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ; ВУТЕ = РР С БП=1;
;   ЧТОБ ИЗМЕНИЛИСЬ БОБР,БИЗМ, МАТ.АДРЕС НЕ ДОЛЖЕН ВЫЗЫВАТЬ ПРЕРЫВАНИЙ!
;   ОШИБКИ:
;   00 - НЕ ТОТ ФИЗ.АДРЕС С БП=1;              03 - ТО ЖЕ С БП=0;
;   01 - НЕ ТОТ НОМЕР СТРАНИЦЫ В РФС С БП=1;   04 - ТО ЖЕ С БП=0;
;   02 - НЕ ТЕ ЗНАЧЕНИЯ В БОБР,БИЗМ С БП=1;    05 - ТО ЖЕ С БП=0.
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;
CJP А=PSADCF,МАР=РЕ
PSADCF:CONT А=НCF,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;МАТ.АДРЕС ИЗ ПЗУ - В РГ.DADR, АИСП., В БОПП
CONT А=В3,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=DADR,H,ALUD=B,RB=WR6
;ПРИПИСКУ - В РС, В РП
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDEV=PSMEM,WRY
;ВЫЧИСЛЯЕМ ФИЗ.АДРЕС (КОТОРЫЙ Д.БЫТЬ С ПРИПИСКОЙ): N СТРАНИЦЫ (11-20 РАЗРЯДЫ)
CONT А=MPG,DSRC=PROM,ALUS=DА,RА=РС,FUNC=AND,Н,ALUD=В,RВ=HALF
;+ N СЛОВА В СТРАНИЦЕ (МЛАДШИЕ 10 РАЗРЯДОВ) - В РГ.HALF
CONT А=MWN,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=AND,Н,ALUD=Q
CONT ALUS=AQ,RА=HALF,FUNC=OR,Н,ALUD=В,RВ=HALF
;БП = 1
CADRCF:CONT А=CTEST,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=CNT
;ОБНУЛЯЕМ БОБР,БИЗМ ПО ОБОИМ ФИЗ.АДРЕСАМ:
CONT ALUS=ZА,RА=DADR,ALUD=B,RB=A,ALU,YDST=PHYSPG
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD,ALUS=ZА,RА=HALF,ALU,YDST=PHYSPG
;00: ЧИТАЕМ ФИЗ.АДРЕС, СРАВНИВАЕМ С МАТ.АДРЕСОМ
CONT YDEV=PHYSAD,ARBI=DRD,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР (2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 0)
CONT A=B2,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ТО ЖЕ САМОЕ С БП = 0
CONT А=В27,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,ALU,YDST=CNT
;03: ФИЗ.АДРЕС С ЗАМЕНОЙ N СТРАНИЦЫ
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=ZA,RA=HALF,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;04: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ПРОВЕРЯЕМ БОБР(2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CADRCF,МАР=РЕ,%TIK%
;
;
ФИЗАD0:ENTRY
;===== ФИЗ.АДРЕС С БП=1 ( = МАТ.АДРЕСУ); ЦИКЛ ПО ВСЕМ АДРЕСАМ СТРАНИЦ
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРОВЕРЯЕМ УСТАНОВКУ БИЗМ=1.
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ;
;
CJP А=PSADD0,МАР=РЕ
PSADD0:CONT А=НD0,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;АДР."-1"-ОЙ СТРАНИЦЫ С РАЗМНОЖЕНИЕМ 20Р.В 21-32 - В РС, В WR1; БП=1
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1
;УСТАНАВЛИВАЕМ БОБР=1
CONT А=В2,DSRC=PROM,DDEV=ВВ,WRD,ALUS=ZА,RА=РС,ALU,YDST=ADRREG
;CONST - В РП (НЕ ВОСТРЕБУЕМАЯ ПРИПИСКА)
CONT А=С555,DSRC=PROM,ALUS=DZ,ALU,YDEV=PSMEM,WRY
;АДРЕС РП - В РФС (Т.К.С БП=1) ДЛЯ НОВОГО ЦИКЛА
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;
CADRD0:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,ALUD=В,RВ=РС,ALU,YDST=ADRREG,CEN
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ОБХОД, ЕСЛИ М.А.= 0
CJP А=INCR29,МАР=РЕ,COND=СТ,SТОРС=NZ
;00: ЧИТАЕМ ФИЗ.АДРЕС, СРАВНИВАЕМ С МАТ.АДРЕСОМ (БП = 1)
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=ZA,RA=PC,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=А,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР (2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ ТОЛЬКО БОБР В 1 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=В2,DSRC=PROM,DDEV=ВВ,WRD
INCR29:RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG,CEN
%J% А=CADRD0,МАР=РЕ,%TIK%
;
;
ФИЗАD1:ENTRY
;===== ЧТЕНИЕ ФИЗ.АДРЕСА С ПРИПИСКОЙ (БП = 0); ЦИКЛ ПО ВСЕМ АДРЕСАМ СТРАНИЦ
;   РС - МАТ.АДРЕС; DADR - ЗАПИСАННОЕ В РП, 11-20Р.= Ф.А, Т.К.1-10Р.М.А.= 0;
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ;
;
CJP А=PSADD1,МАР=РЕ
PSADD1:CONT А=НD1,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;АДР.НАЧАЛА БЕЗ 1 СТР.- ПИШЕМ В РС,WR1; БП = 0
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=ВУТЕ
CONT А=В27,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,ALU,YDST=CNT
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1,ALU,YDST=ADRREG
;CONST - В РП (ПРИПИСКА)
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,YDEV=PSMEM,WRY,YDST=PHYSPG
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG
;РП = CONST, ФИЗ.АДРЕС БУДЕТ ОДИН И ТОТ ЖЕ, ПИШЕМ ПО ЭТОМУ АДРЕСУ БОБР=БИЗМ=0
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
;ВЫЧИСЛЯЕМ ФИЗ.АДРЕС
CONT А=MPG,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=AND,Н,ALUD=В,RВ=DADR
CADRD1:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG,CEN
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ОБХОДИМ МАТ.АДРЕС = 0
CJP А=INCR2A,МАР=РЕ,COND=СТ,SТОРС=NZ
;00: ЧИТАЕМ ФИЗ.АДРЕС, СРАВНИВАЕМ
CONT YDEV=PHYSAD,ARBI=FЕТСН,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=ZA,RA=DADR,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР (2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 0)
CONT A=B2,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ БОБР,БИЗМ В 0 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
INCR2A:RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG,CEN
%J% А=CADRD1,МАР=РЕ,%TIK%
;
;
ФИЗАD2:ENTRY
;===== ФИЗ.АДРЕС С БП=0; ЦИКЛ ПО ВСЕМ МАТ.АДРЕСАМ И ФИЗ.АДРЕСАМ СТРАНИЦЫ И СЛОВА
;   РС - МАТ.АДРЕС; РП - ИНВЕРТИРОВАННЫЙ МАТ.АДРЕС.
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ
;
CJP А=PSADD2,МАР=РЕ
PSADD2:CONT А=НD2,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС,ALU,YDST=ADRREG
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1
;ПИШЕМ ИНВЕРТИРОВАННЫЙ АДРЕС - В РП; 0 - В БОБР,БИЗМ
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,YDEV=PSMEM,WRY,YDST=PHYSPG
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG
;БП = 0
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=ВУТЕ
CONT А=В27,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,ALU,YDST=CNT
;МАТ. АДРЕС - В АИСП., НАЧИНАЯ С "-1"-ОЙ СТР., 0 СЛОВА (ЗДЕСЬ М.А.=0 НЕТ!)
CADRD2:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ВЫЧИСЛЯЕМ ФИЗ.АДРЕС:ИНВЕРТИРУЕМ НОМЕР СТРАНИЦЫ У МАТ.АДРЕСА (ТАК ЗАПИСАНО В РП)
CONT А=MPG,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,ALUD=В,RВ=A
;00: ЧИТАЕМ  ФИЗ.АДРЕС, СРАВНИВАЕМ
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG2,ЕСА,ARA=RG2,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР(2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=РССОРУ
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ БОБР,БИЗМ В 0 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
RFCT А=PG1W1,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,ALUD=В,RВ=РС,ALU,YDST=ADRREG
%J% А=CADRD2,МАР=РЕ,%TIK%
;
;
ФИЗАD3:ENTRY
;===== ФИЗ.АДРЕС С БП=1 В РЭ!!! ( = МАТ.АДРЕСУ); ЦИКЛ ПО ВСЕМ АДРЕСАМ СТРАНИЦ
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРОВЕРЯЕМ УСТАНОВКУ БИЗМ=1.
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ;
;
CJP А=PSADD3,МАР=РЕ
PSADD3:CONT А=НD3:%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETER
;АДР."-1"-ОЙ СТРАНИЦЫ С РАЗМНОЖЕНИЕМ 20Р.В 21-32 - В РС, В WR1; БП=1
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1
;УСТАНАВЛИВАЕМ БОБР=1
CONT А=В2,DSRC=PROM,DDEV=ВВ,WRD,ALUS=ZА,RА=РС,ALU,YDST=ADRREG
;CONST - В РП (НЕ ВОСТРЕБУЕМАЯ ПРИПИСКА)
CONT А=С555,DSRC=PROM,ALUS=DZ,ALU,YDEV=PSMEM,WRY
;АДРЕС РП - В РФС (Т.К.С БП=1) ДЛЯ НОВОГО ЦИКЛА
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;
CADRD3:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,ALUD=В,RВ=РС,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ОБХОД, ЕСЛИ МЛАДШИЕ 15 РАЗРЯДОВ МАТ.АДРЕСА В РЭ = 0
CONT A=MADR,DSRC=PROM,ALUS=DA,RA=PC,FUNC=AND,CEN
CJP А=INCR2C,МАР=РЕ,COND=СТ,SТОРС=NZ
;00: ЧИТАЕМ ФИЗ.АДРЕС, СРАВНИВАЕМ С МАТ.АДРЕСОМ (БП = 1)
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=ZA,RA=PC,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=А,FUNC=EXOR,ALUD=Q
;В РЭ СРАВНИВАЕМ ТОЛЬКО 15 РАЗРЯДОВ!!!
CONT А=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
;В РЭ ОСТАВЛЯЕМ ТОЛЬКО 5 МЛАДШИХ РАЗРЯДОВ У НОМЕРА СТРАНИЦЫ!!!
CONT A=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР (2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ ТОЛЬКО БОБР В 1 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=В2,DSRC=PROM,DDEV=ВВ,WRD
INCR2C:RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG
%J% А=CADRD3,МАР=РЕ,%TIK%
;
;
ФИЗАD4:ENTRY
;===== ФИЗ.АДРЕС С БП=0 В РЭ!!! ЦИКЛ ПО ВСЕМ МАТ.АДР. И ФИЗ.АДР.СТРАНИЦЫ И СЛОВА
;   РС - МАТ.АДРЕС; РП - ИНВЕРТИРОВАННЫЙ МАТ.АДРЕС.
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ
;
CJP А=PSADD4,МАР=РЕ
PSADD4:CONT А=НD4,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETER
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС,ALU,YDST=ADRREG
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1
;ПИШЕМ ИНВЕРТИРОВАННЫЙ АДРЕС - В РП; 0 - В БОБР,БИЗМ
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,YDEV=PSMEM,WRY,YDST=PHYSPG
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG
;БП = 0
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=ВУТЕ
CONT А=В27,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,ALU,YDST=CNT
;МАТ. АДРЕС - В АИСП., НАЧИНАЯ С "-1"-ОЙ СТР., 0 СЛОВА (ЗДЕСЬ М.А.=0 НЕТ!)
CADRD4:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ОБХОД, ЕСЛИ МЛ.15 РАЗРЯДОВ АДРЕСА = 0
CONT A=M15,DSRC=PROM,ALUS=DA,RA=PC,FUNC=AND,CEN
CJP A=INCR2D,MAP=PE,COND=CT,STOPC=NZ
;ВЫЧИСЛЯЕМ ФИЗ.АДРЕС:ИНВЕРТИРУЕМ НОМЕР СТРАНИЦЫ У МАТ.АДРЕСА (ТАК ЗАПИСАНО В РП)
CONT А=MPG,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,ALUD=В,RВ=A
;00: ЧИТАЕМ  ФИЗ.АДРЕС, СРАВНИВАЕМ
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG2,ЕСА,ARA=RG2,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
;ОСТАВЛЯЕМ ТОЛЬКО МЛАДШИЕ 15 РАЗРЯДОВ АДРЕСА В РЭ
CONT А=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
;ОСТАВЛЯЕМ ТОЛЬКО МЛ.5 НОМЕРОВ СТРАНИЦ В РЭ
CONT A=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР(2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=РССОРУ
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ БОБР,БИЗМ В 0 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
INCR2D:RFCT А=PG1W1,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,ALUD=В,RВ=РС,ALU
>,YDST=ADRREG
%J% А=CADRD4,МАР=РЕ,%TIK%
;
;===== ПОСЛЕДНЯЯ КОМАНДА БОЛЬШОГО ТЕСТА
;
CJP A=CMPU1,MAP=PE
;
;     П/П ДЛЯ ТЕСТОВ
;     ==============
;
;===== К БМПУ4
;2-Я, INTR=3
SUBR1:CJS А=SUBR2,МАР=РЕ,%ТУРЕ%
CRTN
CJP А=ERRTST,МАР=РЕ
;3-Я, INTR=4
SUBR2:CRTN COND=EMLRG,%ТУРЕ%
CRTN IСС
CJS А=SUBR3,МАР=РЕ
CRTN
CJP А=ERRTST,МАР=РЕ
;4-Я, INTR=5
SUBR3:CJS А=SUBR4,МАР=РЕ,%ТУРЕ%
CRTN
CJP А=ERRTST,МАР=РЕ
;5-Я, INTR=6
SUBR4:CJS А=SUBR5,МАР=РЕ,%ТУРЕ%
CRTN IСС
CRTN
CJP А=ERRTST,МАР=РЕ
SUBR5:CRTN
CJP А=ERRTST,МАР=РЕ
;
;===== К БМПУ5
SUB1:CJS А=SUB2,МАР=РЕ
CJP А=ERRTST,МАР=РЕ
;ОБХОДИМ АДРЕС ВОЗВРАТА, INTR=1-20
SUB2:CJPP А=S2,МАР=РЕ,%ТУРЕ%
CJP А=ERRTST,МАР=РЕ
S2:CRTN
;2
SUBE1:CJS А=SUBE2,МАР=РЕ
CJP А=ERRTST,МАР=РЕ
;3
SUBE2:CJS А=SUBE3,МАР=РЕ
CJP А=ERRTST,МАР=РЕ
;4
SUBE3:CJS А=SUBE4,МАР=РЕ
CJS А=ERRTST,МАР=РЕ
;5
SUBE4:CJS А=SUBE5,МАР=РЕ
CJS А=ERRTST,МАР=РЕ
;ВОЗВРАТ, INTR=21-25
SUBE5:CJPP А=R1,МАР=РЕ,%ТУРЕ%
CJS А=ERRTST,МАР=РЕ
R1:CJPP А=R2,МАР=РЕ,%ТУРЕ%
CJS А=ERRTST,МАР=РЕ
R2:CJPP А=R3,МАР=РЕ,%ТУРЕ%
CJS А=ERRTST,МАР=РЕ
R3:CJPP А=R4,МАР=РЕ,%ТУРЕ%
CJS А=ERRTST,МАР=РЕ
R4:CJPP А=ERRTST,МАР=РЕ,COND=EMLRG
CJPP А=ERRTST,МАР=РЕ,IСС
CRTN
;
;===== K БМПУA
;2
SU1:CJS А=SU2,МАР=РЕ
CJP А=ERRTST,МАР=РЕ
;3
SU2:CJS А=SU3,МАР=РЕ
CJP А=ERRTST,МАР=РЕ
;4
SU3:CJS А=SU4,МАР=РЕ
CJP А=ERRTST,МАР=РЕ
;5
SU4:CJS А=SU5,МАР=РЕ
CJP А=ERRTST,МАР=РЕ
SU5:LDCT А=0,МАР=РЕ
;5; INTR=3
TWB А=RR1,МАР=РЕ,COND=EMLRG,%ТУРЕ%
CJP А=ERRTST,МАР=РЕ
;4; INTR=4
RR1:TWB А=RR2,МАР=РЕ,IСС,%ТУРЕ%
CJP А=ERRTST,МАР=РЕ
;3; INTR=5
RR2:TWB А=ERRTST,МАР=РЕ,%ТУРЕ%
;2; INTR=6
TWB А=ERRTST,МАР=РЕ,COND=EMLRG,IСС,%ТУРЕ%
;1
CRTN
END
*END
*NO LIST
*CALL MICLOA:INIABT
*END F
*END FILE
