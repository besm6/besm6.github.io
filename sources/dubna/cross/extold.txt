*NАМЕ N
*TIME:24.00
*EXPRESS
*PAGE:99,LIST
*DISC:705/SYSTEM,WORKIN
*FILE:EXTOLD,55,W
*        0 - ЗАГРУЖЕННЫЕ ЭКСТРАКОДЫ
*        2 - ТЕСТ АУ/УУ,   4 - PERSO,  16 - ТЕСТ
*       20,50 - ТЕКСТЫ ЭКСТРАКОДОВ
*PERSO:55004
*CALL FICMEMOR
*MADLEN,L=0.
  PROGRAM:,NАМЕ,
  АА:,РС,27000
  ВВ:,РС,0
С        ВСЕ ЭТО ГРУЗИТСЯ С 70000
С    А LDSHIFT НАСТРАИВАЕТ АДРЕСА НА 74000
С    АДРЕСА 74000-77777 ИЗОБРАЖАЮТ ИЗ СЕБЯ
С    ФИЗ.АДРЕСА 0-3777
С      0-32  : ПЕРЕКЛЮЧАТЕЛЬ ЭКСТРАКОДОВ
С     33-357 : "ИПЗ" ЗАДАЧИ
С      360   : " И П Д "     - 20
С      400   : " И П К "     - 40
С      440   : " И П К 1 "   - 30
С      502   : ССЫЛКА НА "ГУС"
С      504   : ССЫЛКА НА "Т1МТ"+16
С      505   : ССЫЛКА НА ТАБЛ.ИМЕН ЛЕНТ+16
С      575   : ССЫЛКА НА ТАБЛ.ИМЕН ДИСКОВ
С      576   : ССЫЛКА НА ТАБЛИЦУ ФАЙЛОВ
С      577   : " Г У С "
С    700-777 : БИТЫ И ВЕРСИЯ СИСТЕМЫ
С     3500   : "Т1МТ"
С     3560   : "Т2МТ"
С     3640   : "ТАБЛ.ИМЕН ЛЕНТ"
С     3720   : "DNAM"
С     3740   : "FАТА"
С---------------------------------
С    В РАБОЧЕМ СОСТОЯНИИ ИНТЕРПРЕТАТОР ЭКСТРАКОДОВ
С    ЗАНИМАЕТ 512 И 513 ЛИСТЫ.  ПЕРЕД ОТРАБОТКОЙ
С    ЭКСТРАКОДА ДЕЛАЕТСЯ ЗАМЕНА 512<=>30, 513<=>31.
С---------------------------------
  MAIN:,SUBP,
   ИПЗ:LС,BLOCK,СТ. "ВРЕМЯ"
  ,CONT,АС(5).НАЧ.ИПЗ=МАГАЗИН!
  ,CONT,WS64(27).РАБ.ЯЧ. Э064
  ,CONT,SMASAV(18)
  ,CONT,(14). РЕЗЕРВ
  ,CONT,REGSCAL(22).ЧАСТЬ СТАРОГО ИПЗ
  ,CONT,BBUF.НАЧ.БУФЕРА Э64
  ,CONT,EBUF.КОН.БУФЕРА Э64
  ,CONT,ТЕ.ТЕК.УК.ПО БУФЕРУ
  ,CONT,OLDBLS.ПРОТЯЖКИ
  ,CONT,NSTRI.СЧ-К СТРОК
  ,CONT,(2). РЕЗЕРВ
  ,CONT,NRCW(3)."NRESCODE"
  ,CONT,BUF(100).COSY-БУФЕР Э64
  ,CONT,ЕВ.ЕГО КОНЕЦ
С------------
  LДЫР:,EQU,ЕВ-MAIN
  ЕЕЕЕ:,LС,1000В-LДЫР
  CONST:LС,BLOCK,FULWOR,В24/1,С77777,С7777,С777,С377,С77,С37,С17,С7,С3
  WSM50:,LС,6.РАБ.ЯЧ. Э050
  MACRO64:,SUBP,
  NRESCODE:,SUBP,
  MACRO50:,SUBP,
  STARTJOB:,SUBP,
С---
С
  12,VТМ,700В-777В
  11,VТМ,-277В
 :12,*63,777В
  12,АТХ,70777В
  12,VLM,*-1
  12,VТМ,470В-677В
  ,ХТА,
  :12,АТХ,70677В
  12,VLM,*
  :11,АТХ,73777В
  11,VLM,*
  ,ХТА,=577
  ,АТХ,70502В. АГУС
  14,VТМ,СТ+1
  ,IТА,14
  ,ААХ,=3777
  ,АОХ,=4000 0000 0200 0000
  ,АТХ,70577В. Г У С
С ,*63,505В
С ,ATI,11
С 12,VТМ,-15
С :11,UТС,
С 12,*63,-1
С 12,АТХ,73657В.ИМЕНА МОДЕЛЕЙ
С 12,VLM,*-1
  ,ХТА,=3720
  ,АТХ,70575В."DNAM"
  ,ХТА,=3740
  ,АТХ,70576В."FАТА"
  ,ХТА,=3500
  ,АТХ,70504В."Т1МТ"
  ,ХТА,=3640
  ,АТХ,70505В.ИМЕНА МЛ
  ,*63,760В
  ,ATI,1
  ,*63,761В
  ,ATI,2
  ,*63,762В
  ,ATI,3
  4,VТМ,-15
  :4,UТС,15
  1,*63,
  4,АТХ,70377В. И П Д
  4,VLM,*-1
  ,ХТА,=360
  ,АТХ,70760В
  4,VТМ,-31
  5,VТМ,-23
  :4,UТС,31
  2,*63,
  4,АТХ,70437В
  4,VLM,*-1. И П К
  ,ХТА,=1 000000. "МТ"
  ,АТХ,70400В. INFBA(ШИФР-20)
  ,ХТА,=400
  ,АТХ,70761В
  :5,UТС,23
  3,*63,
  5,АТХ,70467В. И П К 1
  5,VLM,*-1
  ,ХТА,=440
  ,АТХ,70762В
С
  12,VТМ,-4000В
  ,ХТА,=7777 7777 7777 7777
  12,АТХ,FULWOR
  ,ASN,64+24
  12,АТХ,В24/1
  ,ХТА,=77777
  12,АТХ,С77777
  ,ХТА,=7777
  12,АТХ,С7777
  ,ХТА,=777
  12,АТХ,С777
  ,ХТА,=377
  12,АТХ,С377
  ,ХТА,=77
  12,АТХ,С77
  ,ХТА,=37
  12,АТХ,С37
  ,ХТА,=17
  12,АТХ,С17
  ,ХТА,=7
  12,АТХ,С7
  ,ХТА,=3
  12,АТХ,С3
  ,ХТА,=7300 0000 0000 0010
  12,АТХ,REGSCAL
  14,VТМ,BUF
  ,IТА,14
  ,АТХ,70564В. ДЛЯ RETROS !!!
  12,АТХ,BBUF
  12,АТХ,ТЕ
  14,VТМ,ЕВ
  ,IТА,14
  12,АТХ,EBUF
  ,ХТА,=110.ДЛЯ ПРОГОНА
  12,АТХ,OLDBLS.ПЕРВОГО ЛИСТА
  ,*70,=0000 3400 0055 0000
  ,*70,=0000 3500 0055 0001
  ,*70,=0010 3600 0055 0000
  ,*70,=0010 3700 0055 0001
  1,VТМ,
  ,*67,GО
  GО:,UJ,STARTJOB
  1,Z00,
  ,END,
  MAIN:,NАМЕ,
  INFLOAD*:LС,BLOCK,ALOAD,INFLOA
  KCOUNT*:,LС,4
  MACRO50:,SUBP,
  MACRO51:,SUBP,
  MACRO52:,SUBP,
  MACRO53:,SUBP,
  MACRO54:,SUBP,
  MACRO55:,SUBP,
  MACRO56:,SUBP,
  MACRO57:,SUBP,
  MACRO64:,SUBP,
  STARTJOB:,SUBP,
С---
   ИПЗ:LС,BLOCK,(33),SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13(13)
С-------
   ,LОС,74000В. <<< 7800 Н >>>
  :,UJ,MACRO50.74000
  ,Z00,ИПЗ+1
С-------
  :,UJ,MACRO51.74001
  ,Z00,STARTJOB
С-------
  :,UJ,MACRO52.74002
  :,UJ,MACRO53.74003
  :,UJ,MACRO54.74004
  :,UJ,MACRO55.74005
  :,UJ,MACRO56
  :,UJ,MACRO57
С--------
  END*:,ENTRY,
  END*:14,*77, . НОРМ.ВЫХОД
  ERREXTR:,ENTRY,
  ,WТС,SAVI15
  15,VТМ,
  ,WТС,SAVI13
  13,VТМ,
  ERREXT:,ENTRY,
 :14,*76, . ВЫХОД ПО ОШИБКЕ
С--------
  :,UJ,MACRO64
С--------
  SAVEMOD:,ENTRY,
  ,АТХ,SAVAR
  ,RТЕ,7777В
  ,АТХ,SAVSR
  ,IТА,15
  15,VТМ,SAVI15
  ,ITS,14
  14,VТМ,14
  ,NTR,7
  :14,UТМ,-1
  14,ITS,
  14,VIM,*-1
  ,WТС,SAVI14
  14,VТМ,
  ,WТС,SAVAR
  ,UJ,
С---
  OUTMACRO:,ENTRY,
  15,VТМ,SAVI13+13
  ,SТХ,SAVAC
  ,XTR,SAVSR
  14,VТМ,-12
  :14,STI,13
  14,VLM,*
  ,STI,14
  ,ATI,15
  ,ХТА,SAVAR
  ,АЕХ,
  ,ХТА,SAVAC
  ,UJ,END*
  ,END,
*MADLEN,L=0.
  STARTJOB:,NАМЕ,
С
С       ЗАПУСК "СТАРЫХ" ЗАДАЧ БЭСМ-6
С     "КОЛОДА" УЖЕ ПОДГОТОВЛЕНА НА МБ 01
С
  KCOUNT*:,LС,4
  INFLOAD*:LС,BLOCK,ALOAD,INFLOA
С
  ,LОС,77101В. <<< 7Е41 Н >>>
  :8,VТМ,3777В
  1,VZM,TEST. "DEBUG"
  :1,VТМ,L70-Е70
  ,*70,В70. ИНИЦИАТОР
  ,ХТА,377В. ТРАКТ, ГДЕ
  ,АТХ,Е70. MONITOR* + /MONTRAN
  ,ХТА,363В
  ,АТХ,100В. ЯЧ.ИЗ ТРП
  :15,VТМ,53401В
  1,*70,Е70
  1,VLM,*-1
  ,IТА,15
  ,АТХ,ALOAD
  ,*70,INFLOA.СТ.ЗАГР.
  ,ХТА,17В
  ,ATI,14
  14,АТХ,2
  ,ARX,=10
  ,АТХ,17В
С    ,ХТА,=0010 0000 0076 7777
С    ,АТХ,KCOUNT*+1
  ,ХТА,NАМЕ
  14,АТХ,
  13,VТМ,1673В. "CHEKJOB*"
  15,UJ,.СТАТ.ЗАГРУЗЧИК.
  NАМЕ:,ТЕХТ,8HINPUTCAL
  В70:,LOG,4014 0000 0021 0201.ИНИЦИАТОР
  L70:,LOG,0000 0000 0020 0000. Т Р П
     :,LOG,0014 0000 0021 0007.КАТАЛОГИ
     :,LOG,0000 0000 0021 0000.ВРЕМЕННОЙ
     :,LOG,0014 0000 0021 0010.БИБЛИОТЕКИ
     :,LOG,0000 0000 0021 0001.(ФИЗ. И МАТ.)
  Е70:,LOG,0014 0000 0021 0035./MONTRAN
С----------------
  TEST:8,ХТА,74000В
 8,СТХ,
 8,UТМ,-1
 8,VIM,TEST
 8,VТМ,TEST-74000В
 8,REL,TEST
  1,VТМ,HEAD
  ,*71,LINE
 ,UJ,HELP
  LINE:1,Z04,
  ,Z00,
  QUEST:8,Z05,Q-TEST
  ,Z00,
  HEAD:,ISO,24НМОНИТОР КОМАНД БЭСМ-6. ''
  HELP1:,ISO,42НАСС=<КОД>           - УСТАНОВКА СУММАТОРА''
  HELP2:,ISO,42HREG=<КОД>           - УСТАНОВКА РЕЖИМА АУ''
  HELP3:,ISO,42Н<КОМ.>,<ОПЕРАНД>    - ИСПОЛНЕНИЕ КОМАНДЫ.''
  IWOCT:8,Z27,АС-TEST
  8,Z04,OCTAL-TEST
  IWDEC:8,Z27,АС-TEST
  8,Z14,Q-TEST
  РАУ:,LOG,
  АС:,LOG,
  PAR:,BSS,2
  RESULT:,ISO,12HREG:00, АСС:
  OCTAL:,BSS,4
  :,ISO,6Н DЕС:
  Q:,BSS,14
С---------
  HELP:1,VТМ,HELP1
  ,*71,LINE
  1,UТМ,HELP2-HELP1
  ,*71,LINE
  1,UТМ,HELP3-HELP2
  ,*71,LINE
  RESOUT:,ХТА,РАУ
  ,ASN,64-1
  ,AUX,=6Н'''''''''7''7'
  ,АОХ,=6HREG:00
  ,АТХ,RESULT
  ,ХТА,IWOCT
  ,FUN,14
  ,ХТА,IWDEC
  ,FUN,15
  1,VТМ,RESULT
  ,*71,LINE
  ,ХТА,
  14,VТМ,-13
  :14,АТХ,Q+13
  14,VLM,*-1
  ,ХТА,=6Н JОВ>'22'
  ,АТХ,Q
  ,*71,QUEST
  1,VТМ,Q
  ,IТА,1
  ,FUN,12.ЗАГОЛОВОК
  ,ХТА,=400000
  ,FUN,12.КОП(8)
  ,АТХ,PAR
  14,MTJ,12
  ,ХТА,=100000
  ,FUN,12.ОПЕРАНД
  ,АТХ,PAR+1
  12,UТМ,-1
  12,VZM,СОМ
  12,UТМ,1-4
  12,VIM,HELP
  ,ХТА,PAR
  ,АЕХ,=6HREG
  ,ASN,64+40
  ,UZA,SETREG
  ,ХТА,PAR+1
  ,АТХ,АС
  ,UJ,RESOUT
  SETREG:,ХТА,PAR+1
  ,ASN,64-41
  ,АТХ,РАУ
  ,UJ,RESOUT
  СОМ:,ХТА,PAR
  ,ATI,11
  ,ASN,64-36
  ,АОХ,=I0
  13,VТМ,PAR+1
  ,СТХ,JОВ
  ,ХТА,=:4
  11,ASN,64-50В
  ,UZA,СОМ1.ОБЫЧН.КОМАНДЫ
  ,ААХ,=:0000 4740
  11,UТМ,-64В
  13,VТМ,IW64
  11,VZM,СОМ1
  ,WТС,PAR+1
  13,VТМ,
  ,UZA,СОМ1.ЭК.СУММАТОРНЫЙ
  13,VТМ,АС.С ИНФ.СЛОВОМ
  СОМ1:,ХТА,АС
  ,XTR,РАУ
  JОВ:,LOG,
  :,АТХ,АС
  ,RТЕ,7777В
  ,АТХ,РАУ
  ,UJ,RESOUT
  IW64:8,Z00,Т64-TEST
  ,Z00,
  ,001,
  8,,
  Т64:,GOST,12НПРИВЕТ !'231'
  ,END,
*MADLEN,L=0.
          MACRO50:,NАМЕ,
СОСТАВЛЕНА А.И.САЛТЫКОВЫМ (ОИЯИ)
С УЧАСТИЕМ Л.Г.КАМИНСКОГО (ИФВЭ)
С ВЕРСИЯ 15.01.1975
С  КОЭФФИЦИЕНТЫ ПОЛИНОМОВ ВЗЯТЫ
С  КНИГИ 'COMPUTER APPROXIMATIONS'
С  (АВТОРЫ J.F.HART И ДР., ИЗД-ВО
С  JOHN WILEY AND SONS,NEW YORK,1968)
 ERREXT:,SUBP,
 *ERRMAC:,EQU,ERREXT
 END*:,SUBP,
 NRESCODE:,SUBP,
 *27:,BLOCK,INFSQRT,INFASIN,INFALOG,INFEXP,INFERR
           ИПЗ:LС,BLOCK,(33)
          ,CONT,SAVAC,SAVSR,SAVAR
  *74677:В,BLOCK,BITS
          BIT48:,EQU,BITS+1
          REAL1:,EQU,ЕХР0
          Х:,EQU,SAVAC
          ARCSIN:,EQU,SAVAC
          NTR:,EQU,SAVSR
  INT0:,EQU,=I0
  WSM50:LС,BLOCK,У,Z,Z**2,R,ARG
С
С---
С
  ,LОС,76614В. <<< 7D8C Н >>>
          ,АТХ,SAVAC
          ,IТА,14
          ,ASN,64+3
          ,U1А,NRESCODE
          ,ХТА,SAVAC
          14,UJ,*BEGIN
          MACRO51:,ENTRY,
          14,VZM,SIN*
          ,UJ,COS*
          *BEGIN:,BSS,
          14,VТМ,*SQRT
          ,UJ,*SAV
          SIN*:,BSS,
          14,VТМ,*SIN
          ,UJ,*SAV
          MACRO52:,ENTRY,
          COS*:,BSS,
          14,VТМ,*COS
          ,UJ,*SAV
          MACRO53:,ENTRY,
          14,VТМ,*ATAN
          ,UJ,*SAV
          MACRO54:,ENTRY,
          14,VТМ,*ASIN
          ,UJ,*SAV
          MACRO55:,ENTRY,
          14,VТМ,*ALOG
          ,UJ,*SAV
          MACRO56:,ENTRY,
         :14,VТМ,*ЕХР
          ,UJ,*SAV
          MACRO57:,ENTRY,
         :14,VТМ,*ENTIER.,*50,7
С---
          *SAV:,BSS,
          ,АТХ,Х
          ,RТЕ,77В
          ,АТХ,NTR
          ,NTR,
          ,ХТА,Х
          14,UJ,
С ВЫЧИСЛЕНИЕ SQRT(Х)
С СРЕДНЕЕ ВРЕМЯ СЧЕТА = 60 МКСЕК.
С МАКС. ОТН. ПОГР. =1.5Е-12
С КОРЕНЬ ИЗВЛЕКАЕТСЯ ТОЧНО ИЗ ВСЕХ
С Х=N**2,ГДЕ 1.GЕ.N.LЕ.2**20
          *SQRT:,BSS,
          14,VТМ,*END
          ,Е+N,64
          *SQR:,BSS,
          ,АТХ,Х
          ,NTR,4
          14,UZA,
          ,NTR,16
          ,U1А,*ERRSQRT
          ,ХТА,Х
          ,Е-Х,Х
          ,АТХ,У
          ,А*Х,SQ2
          ,А+Х,SQ1
          ,А*Х,У
          ,А+Х,SQ0
          ,Е+N,64+32
          ,АТХ,R
          ,ХТА,Х
          ,ASN,64+1
          ,АТХ,Z
          ,ХТА,R
          ,Е+Х,Z
          ,АТХ,У
          ,ХТА,Z
          ,NTR,18
          ,UZA,*SQ1
          ,ХТА,У
          ,А*Х,SQRT2
          ,АТХ,У
          *SQ1:,ХТА,Х
          ,А/Х,У
          ,А+Х,У
          ,Е+N,64-1
          ,АТХ,У
          ,ХТА,Х
          ,А/Х,У
          ,А+Х,У
          ,Е+N,64-1
          14,UJ,
          *ERRSQRT:,BSS,
          14,VТМ,INFSQRT
          ,UJ,*ERRMAC
С ВЫЧИСЛЕНИЕ  SIN(Х)
С СРЕДНЕЕ ВРЕМЯ СЧЕТА = 55 МКСЕК.
С МАКС. ОТН. ПОГР. = 4.Е-12
С ВСЕГДА ABS(SIN(Х)).LЕ.1
С ВСЕГДА SIN(Х)**2+COS(Х)**2.LЕ.1.
          *SIN:,BSS,
          ,AVX,Х
          ,А*Х,*1/PI
          ,NTR,10
          ,U1А,*S3
          *S1:,BSS,
          ,NTR,3
          ,А+Х,INT0
 ,NTR,18
          ,АТХ,У
          ,УТА,64-40
          ,АТХ,Z
          ,ХТА,У
          ,ASN,64+8
          ,УТА,
          ,АТХ,У
          ,ХТА,Z
          ,NTR,10
          14,V1М,*S4
          ,Х-А,=R.5
          ,UJ,*S2
          *S4:,BSS,
          ,U1А,*S2
          ,Х-А,REAL1
          *S2:,BSS,
          ,AVX,У
          *S3:,BSS,
          ,Е+N,64+1
          ,АТХ,Z
          ,А*Х,Z
          ,АТХ,Z**2
          14,VТМ,-5
          ,ХТА,SIN6
          *SINL:,А*Х,Z**2
          14,А+Х,SIN0
          14,VLM,*SINL
          ,А*Х,Z
          ,AVX,Х
          ,UJ,*END
С ВЫЧИСЛЕНИЕ  COS(Х)
С СРЕДНЕЕ ВРЕМЯ СЧЕТА = 55 МКСЕК.
С МАКС. ОТН. ПОГР. = 4.Е-12
С ВСЕГДА ABS(COS(Х)).LЕ.1
          *COS:,BSS,
          ,AVX,Х
          ,АТХ,Х
          ,А*Х,*1/PI
          14,VТМ,
          ,UJ,*S1
С ВЫЧИСЛЕНИЕ ATAN(Х)
С СРЕДНЕЕ ВРЕМЯ СЧЕТА = 90 МКСЕК.
С МАКС. ОТН. ПОГР. = 7.Е-12
          *ATAN:,BSS,
          ,AVX,Х
          ,АТХ,Z
          ,ХТА,
          ,АТХ,У
          ,ХТА,Z
          ,Е+N,64-1
          ,U1А,*АТ1
          ,ХТА,REAL1
          ,А/Х,Z
          ,АТХ,Z
          ,ХТА,PI/2
          ,АТХ,У
          *АТ1:,ХТА,Z
          ,А*Х,Z
          ,АТХ,Z**2
      14,VТМ,-2
      *QАТ:,BSS,
      14,А+Х,QATAN1
      ,А*Х,Z**2
      14,VLM,*QАТ
      ,А+Х,QATAN0
          ,АТХ,R
      14,VТМ,-3
          ,ХТА,PATAN4
      *РАТ:,BSS,
      ,А*Х,Z**2
      14,А+Х,PATAN0
      14,VLM,*РАТ
          ,А/Х,R
          ,А*Х,Z
          ,А-Х,У
          ,АМХ,
          ,AVX,Х
          ,UJ,*END
С ВЫЧИСЛЕНИЕ ASIN(Х)
С СРЕДНЕЕ ВРЕМЯ СЧЕТА = 80 МКСЕК.
С МАКС. ОТН. ПОГР. = 7.Е-12
          *ASIN:,BSS,
          ,АТХ,ARG
          ,AVX,Х
          ,АТХ,Z
          14,VТМ,BIT48
          ,NTR,8
          ,U1А,*AS1
          ,Х-А,REAL1
          ,U1А,*ERRASIN
          ,Е+N,64-1
          14,VJM,*SQR
          ,АТХ,Z
          14,VТМ,PI/2
          *AS1:,BSS,
          14,ХТА,
          ,АТХ,ARCSIN
          ,ХТА,Z
          ,А*Х,Z
          ,АТХ,Z**2
      14,VТМ,-2
      *QAS:,BSS,
      14,А+Х,QASIN1
          ,А*Х,Z**2
      14,VLM,*QAS
          ,А+Х,QASIN0
          ,АТХ,R
      14,VТМ,-2
          ,ХТА,PASIN3
      *PAS:,BSS,
          ,А*Х,Z**2
      14,А+Х,PASIN0
      14,VLM,*PAS
          ,А/Х,R
          ,А*Х,Z
          ,Е+Х,ARCSIN
          ,А-Х,ARCSIN
          ,АМХ,
          ,AVX,ARG
          ,UJ,*END
          *ERRASIN:,BSS,
          14,VТМ,INFASIN
          ,UJ,*ERRMAC
С ВЫЧИСЛЕНИЕ ALOG(Х)
С СРЕДНЕЕ ВРЕМЯ СЧЕТА = 60 МКСЕК.
С МАКС. ОТН. ПОГР. = 3.Е-12
С ALOG(1.) В ТОЧНОСТИ РАВЕН 0.
          *ALOG:,BSS,
          ,AVX,SIN1
          ,UZA,*ERRLOG
          ,АТХ,Х
          ,Е-Х,Х
          ,АТХ,У
          ,А-Х,SQRT2/2
          ,АТХ,Z
          ,А+Х,SQRT2
          ,А/Х,Z
          ,АТХ,Z
          ,А*Х,Z
          ,АТХ,Z**2
          14,VТМ,-4
          ,ХТА,ALOG5
          ,NTR,2
          *ALOGL:,BSS,
          ,А*Х,Z**2
          14,А+Х,ALOG0
          14,VLM,*ALOGL
          ,А*Х,Z
          ,А-Х,LN2/2
          ,АТХ,R
          ,ХТА,Х
          ,ААХ,=7740 0000 0000 0000
          ,ASN,64+7
          ,АЕХ,=4320 0000 0000 0000
          ,А*Х,LN2
          ,А+Х,R
          ,UJ,*END
          *ERRLOG:,BSS,
          14,VТМ,INFALOG
          ,UJ,*ERRMAC
С ВЫЧИСЛЕНИЕ  ЕХР(Х)
С СРЕДНЕЕ ВРЕМЯ СЧЕТА = 65 МКСЕК.
С МАКС. ОТН. ПОГР. = 5.Е-12
          *ЕХР:,BSS,
          ,А*Х,*1/LN2
          ,АТХ,Х
          ,А-Х,=R63.
          ,UZA,*ERREXP
          ,А+Х,=R127.
          ,U1А,*CZERO
          ,ХТА,Х
          ,NTR,3
          ,А+Х,INT0
          ,АТХ,Z
          ,NTR,8. БЫЛО: ,NTR,0
          ,УТА,64-41
          ,Е+N,64
          ,АТХ,У
          ,ХТА,Z
          ,ASN,64+7
          ,УТА,
          ,АЕХ,BIT48
          ,АТХ,Z
          14,VТМ,-6
          ,ХТА,ЕХР7
          *EXPL:,А*Х,У
          14,А+Х,ЕХР0
          14,VLM,*EXPL
          ,АТХ,R
          ,А*Х,R
          ,Е+Х,Z
          ,UJ,*END
          *CZERO:,ХТА,
          ,UJ,*END
          *ERREXP:,BSS,
          14,VТМ,INFEXP
          ,UJ,*ERRMAC
С ВЫЧИСЛЕНИЕ ЦЕЛОЙ ЧАСТИ Х
С СРЕДНЕЕ ВРЕМЯ СЧЕТА = 25 МКСЕК.
          *ENTIER:,BSS,
          ,NTR,3
          ,А+Х,INT0
          ,NTR,
          ,Е+N,64
 *END:,XTR,NTR
 ,UJ,END*
С
С   ,*50,8 - ЮЗЕРУ ВЫДАЕТСЯ ПЕРЕСЕЧЕНИЕ
С            ПУЛЬТОВОГО СЛОВА С МАСКОЙ,
С   ЗАДАННОЙ НА СУММАТОРЕ. МЛАДШИЕ БИТЫ
С   РЕЗУЛЬТАТА КОПИРУЮТСЯ НА 14 РЕГИСТР.
С   РАЗРЯДЫ ПУЛЬТОВОГО СЛОВА,СООТВЕТС-
С   ТВУЮЩИЕ МАСКЕ,ГАСЯТСЯ.
С
С---------------------
          SQRT2:,LOG,4053 2404 7463 1772
          SQRT2/2:,LOG,4013 2404 7463 1772
          LN2:,LOG,4013 0562 0577 3722
С  LN2/2 ПОДПРАВЛЕНА,ЧТОБЫ ALOG(1.)=0.
      LN2/2:,LOG,3753 0562 0577 3721
          *1/LN2:,LOG,4053 4252 1662 4534
          *1/PI:,LOG,3752 1371 4066 7117
С  КОЭФФ. ДЛЯ SQRT(С.APPROX.,ТАБЛ. 130)
  SQ2:,LOG,3722 7260 1675 0030
  SQ1:,LOG,4016 1743 6052 7114
  SQ0:,LOG,3752 0213 6707 6726
С  КОЭФФ. ДЛЯ  SIN(С.APPROX.,ТАБЛ.3343)
  SIN6:,LOG,2416 5166 1513 5220
  SIN5:,LOG,2720 7264 0601 3034
  SIN4:,LOG,3212 4073 3764 7661
  SIN3:,LOG,3466 3226 4664 4717
  SIN2:,LOG,3652 1465 7063 3344
  SIN1:,LOG,4025 5242 0614 7334
          SIN0:,BSS,
          PI/2:,LOG,4054 4417 6652 1041
С  КОЭФФ. ДЛЯ ATAN(С.APPROX.,ТАБЛ.5096)
  PATAN4:,LOG,3710 7122 3773 3234
  PATAN3:,LOG,4157 0706 2006 5256
  PATAN2:,LOG,4315 6767 6144 3655
  PATAN1:,LOG,4356 6662 3433 5452
  PATAN0:,LOG,4351 2633 7131 4703
  QATAN3:,LOG,4251 3705 3401 4651
  QATAN2:,LOG,4353 0352 7361 3334
  QATAN1:,LOG,4410 7710 4234 6022
  QATAN0:,LOG,4351 2633 7131 4705
С  КОЭФФ. ДЛЯ ASIN(С.APPROX.,ТАБЛ.4696)
  PASIN3:,LOG,4262 0677 6731 1156
  PASIN2:,LOG,4417 1167 0356 4207
  PASIN1:,LOG,4527 5105 1307 5667
  PASIN0:,LOG,4452 4054 0673 1770
  QASIN3:,LOG,4323 1635 5347 6645
  QASIN2:,LOG,4451 6736 0762 2544
  QASIN1:,LOG,4526 6101 3770 1013
  QASIN0:,LOG,4452 4054 0673 1770
С  КОЭФФ. ДЛЯ ALOG(С.APPROX.,ТАБЛ.2664)
  ALOG5:,LOG,3714 5022 4042 0440
  ALOG4:,LOG,3716 1365 6574 3216
  ALOG3:,LOG,3751 1112 4004 6421
  ALOG2:,LOG,3754 6314 6234 5725
  ALOG1:,LOG,4012 5252 5252 6026
  ALOG0:,LOG,4110 0000 0000 0000
С  КОЭФФ. ДЛЯ ЕХР (С.APPROX.,ТАБЛ.1024)
  ЕХР7:,LOG,3051 4007 7760 5675
  ЕХР6:,LOG,3211 7406 7125 7531
  ЕХР5:,LOG,3352 7345 6034 3024
  ЕХР4:,LOG,3511 6624 3002 3033
  ЕХР3:,LOG,3616 1530 2351 5710
  ЕХР2:,LOG,3717 2775 7375 6445
  ЕХР1:,LOG,4013 0562 0577 4000
  ЕХР0:,LOG,4050 0000 0000 0000
С         У:,BSS,1
С         Z:,BSS,1
С         Z**2:,BSS,1
С         R:,BSS,1
С        ARG:,BSS,1
С
          ,END,
 NRESCODE:,NАМЕ,
С*
С*************** А.П.САПОЖНИКОВ 22/12/80
С*
С*   ,*50,12 - РАСПОЗНАВАТЕЛЬ ТЕКСТОВОЙ
С*              СТРОКИ ( DECODER ).
С*   СТРОКА ПОДАЕТСЯ В ISO ИЛИ В COSY .
С*   ПРИЗНАК КОНЦА - БАЙТ '000' ИЛИ '012'.
С*   ИНФОРМАЦИЯ ДЛЯ ЭКСТРАКОДА НА СУММА-
С*   ТОРЕ :
С*   1-15,21-24 Р. - ИНДЕКСИРОВАННЫЙ АДРЕС
С*   НАЧАЛА СТРОКИ ИЛИ  0,  ЕСЛИ РАБОТА С
С*   ТЕКУЩЕГО МЕСТА СТРОКИ.
С*   16 - ПРИЗНАК ПОГЛОЩЕНИЯ ПРОБЕЛОВ
С*   17 - СИМВОЛЫ '*' И '/' СУТЬ БУКВЫ.
С*   18 - ВОСЬМЕРИЧНЫЕ ЧИСЛА ЗАДАЮТСЯ
С*        БЕЗ СУФФИКСА "В"
С*   19 - ПОСИМВОЛЬНОЕ СКАНИРОВАНИЕ
С*   РЕЗУЛЬТАТОМ РАБОТЫ ЯВЛЯЕТСЯ ТИП ФРАГ-
С*   МЕНТА В И.Р.14  И САМ ФРАГМЕНТ. ПРО-
С*   БЕЛЫ В НАЧАЛЕ ФРАГМЕНТА ТИПА "ЧИСЛО"
С*   ВСЕГДА СГЛАТЫВАЮТСЯ. ЕСЛИ ФРАГМЕНТ -
С*   ЧИСЛО, ТО ЭТО ЧИСЛО ВЫДАЕТСЯ НА СУМ-
С*   МАТОРЕ, А В  РМР  ВЫДАЕТСЯ (1-8Р.)
С*   КОД ОГРАНИЧИТЕЛЯ И (25-33Р.) ПОЗИЦИЯ
С*   ЭТОГО ОГРАНИЧИТЕЛЯ ВО ВХОДНОЙ СТРОКЕ.
С*   ЕСЛИ ФРАГМЕНТ - ИДЕНТИФИКАТОР ИЛИ
С*   ТЕКСТ, ЗАКЛЮЧЕННЫЙ В АПОСТРОФЫ, ТО
С*   ОН ВЫДАЕТСЯ НА СУММАТОРЕ (НАЧАЛО) И
С*   В  РМР (ПРОДОЛЖЕНИЕ). ХВОСТ ТЕКСТА
С*   ЗАПОЛНЯЕТСЯ ПРОБЕЛАМИ. ЕСЛИ ТЕКСТ
С*   БОЛЕЕ 12 СИМВОЛОВ, ТО ЭТОТ ФАКТ ЗАПО-
С*   МИНАЕТСЯ, И ОСТАТОК ТЕКСТА БУДЕТ
С*   ВЫДАН ПРИ СЛЕДУЮЩЕМ ОБРАЩЕНИИ.
С*   ВОЗМОЖНЫЕ ЗНАЧЕНИЯ И.Р.14 :
С*    0 - ОШИБКА, ФРАГМЕНТ НЕ РАСПОЗНАН
С*    1 - ВОСЬМЕРИЧНОЕ (123В, 99D, -10В)
С*    2 - ЦЕЛОЕ ( 8000, -999 )
С*    3 - ВЕЩЕСТВЕННОЕ (3.62, -3.141Е-3)
С*    4 - ИДЕНТ. ИЛИ ТЕКСТ В АПОСТРОФАХ
С*    5 - ТО ЖЕ, НО ДЛИНОЙ > 12 СИМВОЛОВ
С*    6 - ПУСТОЙ ФРАГМЕНТ
С*   В РЕЖИМЕ ПОСИМВОЛЬНОГО СКАНИРОВАНИЯ
С*   ТЕКУЩИЙ СИМВОЛ СТРОКИ ВЫДАЕТСЯ НА
С*   СУММАТОРЕ (ПРИЖАТ ВЛЕВО И ДОПОЛНЕН
С*   ПРОБЕЛАМИ) И В 1-8 РР. РМР.
С*   В 25-33 РР. РМР ВЫДАЕТСЯ НОМЕР ПОЗИЦИИ
С*   СИМВОЛА В СТРОКЕ. ПРОБЕЛЫ ПРИ НЕОБХО-
С*   ДИМОСТИ ПОГЛОЩАЮТСЯ.
С*   ТИП СИМВОЛА ВЫДАЕТСЯ В И.Р.14:
С*    0 - КОНЕЦ СТРОКИ ('000','012')
С*    1 - ЦИФРА ( 0 - 9 )
С*    2 - БУКВА ( А-Z-Я, ПО ЗАКАЗУ: / , * )
С*    3 - РАЗДЕЛИТЕЛЬ (НЕ ЦИФРА И НЕ БУКВА)
С*
С*
С*
С*   ,*50,К , ГДЕ К = 13,14,15 - ENCODER
С*            ФОРМАТНЫЕ ПРЕОБРАЗОВАНИЯ
С*            ИЗ ДВОИЧНОГО КОДА В ISO.
С*   ИНФОРМАЦИЯ НА СУММАТОРЕ :
С*   25-39,45-48 - ИНДЕКСИР.АДРЕС BINARY
С*    1-15,21-24 - ИНДЕКСИР.АДРЕС ВЫХОД-
С*    НОЙ СТРОКИ ИЛИ  0, ЕСЛИ РЕЗУЛЬТАТ
С*    ПИШЕТСЯ С ТЕКУЩЕЙ ПОЗИЦИИ ВЫХОДНОЙ
С*    СТРОКИ.
С*   40-44 - N : ЧИСЛО ПОЗИЦИЙ ДЛЯ РАЗ-
С*    МЕЩЕНИЯ ПОЛУЧЕННОГО ТЕКСТОВОГО
С*    ФРАГМЕНТА.
С*   16-19 - М : ЧИСЛО ЦИФР МАНТИССЫ.
С*   20 - Т : ТИП НОРМАЛИЗАЦИИ ТЕКСТА
С*    ЧИСЛА ВНУТРИ СВОЕГО  N-ПОЛЯ :
С*    ( 1 - ВПРАВО, 0 - ВЛЕВО ).
С*
С*   К=13 - СПЕЦИФИКАЦИЯ Н : ПЕРЕНОС В
С*   ВЫХОДНУЮ СТРОКУ N СИМВОЛОВ ВХОДНОЙ
С*   СТРОКИ BINARY. Т НЕСУЩЕСТВЕННО.
С*   ПРИ М=0 СИМВОЛЫ С КОДАМИ <40В
С*   ЗАМЕНЯЮТСЯ НА ПРОБЕЛЫ.
С*
С*   К=14 - СПЕЦИФИКАЦИЯ О : ПРЕОБРА-
С*   ЗОВАНИЕ BINARY ПО ФОРМАТУ  О<N>
С*   СО ВСТАВКОЙ ОДНОГО ПРОБЕЛА ПОСЛЕ
С*   КАЖДЫХ М ВОСЬМЕРИЧНЫХ ЦИФР.
С*
С*   К=15 - СПЕЦИФИКАЦИЯ G : ПРЕОБРА-
С*   ЗОВАНИЕ ПО ФОРМАТУ  I<N> ЕСЛИ М=0,
С*   ИНАЧЕ ПО ФОРМАТУ  F<N>.<М> , А
С*   ЕСЛИ НЕ ВЛЕЗАЕМ В РАЗМЕР ПОЛЯ, ТО
С*   ПО ФОРМАТУ  Е<N>.<М> .
С*   ЕСЛИ ЗАДАНО М>12, ЧИСЛО БЕЗУСЛОВНО
С*   ВЫДАЕТСЯ ПО Е-ФОРМАТУ.
С*
С*   РЕЗУЛЬТАТ РАБОТЫ ДЛЯ ВСЕХ ТРЕХ
С*   ЭКСТРАКОДОВ: СУММАТОР - ДЛИНА
С*   ВЫХОДНОЙ СТРОКИ В СИМВОЛАХ, И.Р.14
С*   = 1, ЕСЛИ ПРЕВЫШЕН РАЗМЕР ПОЛЯ,
С*   ИНАЧЕ И.Р.14 = 0 .
С*   В КАЖДЫЙ МОМЕНТ ВРЕМЕНИ ПОСЛЕДНЕЕ
С*   СЛОВО ВЫХОДНОЙ СТРОКИ ДОПОЛНЕНО ДО
С*   КОНЦА ПРОБЕЛАМИ.
С*
С***************************************
С*
  ИПЗ:LС,BLOCK,(33)
 ,CONT,SAVAC,SAVSR,SAVAR,SAVI15,SAVI14,SAVI13(13)
  С5:,EQU,=5
 С14:,EQU,=14
  С50:,EQU,=50
  С60:,EQU,=60
  С6:,EQU,=6
  ERREXTR:,SUBP,
  SAVEMOD:,SUBP,
  OUTMACRO:,SUBP,
  *74677:В,BLOCK,BITS
  ,CONT,BIT48,BIT47,BIT46,BIT45
  ,CONT,BIT44,BIT43,BIT42,BIT41
  ,CONT,BIT40,BIT39,BIT38,BIT37
  ,CONT,BIT36,BIT35,BIT34,BIT33
  ,CONT,BIT32,BIT31,BIT30,BIT29
  ,CONT,BIT28,BIT27,BIT26,BIT25
  ,CONT,BIT24,BIT23,BIT22,BIT21
  ,CONT,BIT20,BIT19,BIT18,BIT17
  ,CONT,BIT16,BIT15,BIT14,BIT13
  ,CONT,BIT12,BIT11,BIT10,BIT9
  ,CONT,BIT8, BIT7, BIT6, BIT5
  ,CONT,BIT4, BIT3, BIT2, BIT1
  CONST:LС,BLOCK,FULWOR,В24/1
  ,CONT,С77777,С7777,С777,С377,С77,С37,С17,С7,С3
С---
  *135:В,BLOCK,S*COUNT,SУМ,CONTI
  *5:В,BLOCK,REZAC,FILD,R14
  ,CONT,АСС,BIN
  ,CONT,W1,W2,W3,W4,W5,W6,W7,W8
  ,CONT,COSY
  COUNT:,EQU,W8
  SТАТ:,EQU,R14
  CHAR:,EQU,W4
  CMAN:,EQU,W5
  ОСТ:,EQU,W6
С---
  STAR:,EQU,52В
  MINUS:,EQU,55В
  PLAS :,EQU,53В
  POIN :,EQU,56В
  APOS :,EQU,47В
  LF   :,EQU,12В
  KILBL :,EQU,BIT40
  LЕТ*/ :,EQU,BIT41
  SBABS:,EQU,BIT42
  WORS:,EQU,BIT43
  TABS1:,EQU,TABS-1
С
С---
С
  ,LОС,75674В. <<< 7ВВС Н >>>
  START:,ХТА,*+1
  ,UJ,SAVEMOD
 :,Z00,
  ,Z00,*+1
 :,IТА,14
  11,VТМ,
  15,VТМ,ИПЗ+1
  ,ASN,64+4
  ,U1А,EMULATOR
 15,АТХ,REZAC
  ,ХТА,SAVAC
  14,UJ,*-7
 :,UJ,PULT
 :,UJ,ERREXTR
 :,UJ,ERREXTR
 :,UJ,ERREXTR
  :,ASN,64-24
  ,UJ,MAKADR
  :11,VТМ,Н/ENCOD-DECOD
  ,UJ,MAKADR
  :11,VТМ,В/ENCOD-DECOD
  ,UJ,MAKADR
  :11,VТМ,G/ENCOD-DECOD
  ,UJ,MAKADR
С---
  PULT:15,ААХ,113В
  15,АЕХ,113В
  15,АТХ,113В
  ,УТА,
  ,АТХ,SAVI14
  ,UJ,OUTMACRO
С
С---   РАЗБОРКА ИНФ. СЛОВА:
С
  MAKADR:,BSS,
  15,АТХ,АСС
  15,ХТА,S*COUNT
  14,VТМ,-1
  MADR:,BSS,
  ,ASN,64-24
  15,АТХ,COUNT
  ,УТА,
  15,АЕХ,COUNT
  15,АТХ,COUNT
  15,ХТА,АСС
  ,ASN,64-24
  15,АТХ,АСС
  ,УТА,
  15,АЕХ,АСС
  15,АТХ,АСС
  ,ASN,64+15
  ,ААХ,С37
  14,UТС,1
  15,АТХ,FILD
  15,ХТА,АСС
  ,ASN,64+20
  ,ААХ,С17
  ,UZA,MODIF
  ,АЕХ,С17
  ,ATI,12
  12,ХТА,SAVI15
  MODIF:15,ARX,АСС
  ,ААХ,С77777
  ,UZA,CONT
  15,АЕХ,COUNT
  15,АТХ,W1
  ,IТА,11
  :,U1А,*+1
  15,АТХ,CONTI
  :15,ХТА,W1
  ,ААХ,В24/1
  CONT:,BSS,
  15,АЕХ,COUNT
  14,VLM,MADR
  15,АТХ,COUNT
  11,VZM,DECOD
  ,ASN,64+24
  ,ATI,14
  15,ХТА,FILD+1
  ,ААХ,С17
  15,АТХ,FILD+1
  14,ХТА,
  15,АТХ,BIN
  ,ХТА,
  15,АТХ,COSY
  15,АТХ,W4
  11,UJ,DECOD
С
С  PUTS: ЗАСЫЛКА СИМВОЛА В ВЫХ.СТРОКУ
С        ОБРАЩЕНИЕ ПО 11 РЕГ. СИМВОЛ
С        ПОДАЕТСЯ В МЛ.РАЗР.СУММАТОРА
С        ПОРТЯТСЯ SУМ,W1,W2,W3,12,14 РЕГ.
С  GETS: ВЫБОРКА СИМВОЛА ИЗ ВХОДНОЙ СТРОКИ
С        ПОРТЯТСЯ COSY,W1,W2,W3,12,14 РЕГ.
С        СИМВОЛ - В SУМ И НА СУММАТОРЕ.
С        ТЕКУЩЕЕ СЛОВО ВХ.СТРОКИ - В BIN.
С
  GETS:15,ХТА,COSY
  ,UZA,GETS1
  ,NTR,3
  ,А-Х,BIT1
  GBL1:15,АТХ,COSY
  ,ХТА,BIT6
  15,АТХ,SУМ
  11,UJ,
  SPUT:,IТА,14
  ,UJ,PUTS
  PUTDIG:11,VТМ,DIGIT
  PUTS:15,АТХ,SУМ
  ,UТС,1
  GETS1:,ХТА,GWOR
  15,АТХ,W1
  15,ХТА,COUNT
  15,ASX,W1
  15,АТХ,W2
  ,ASN,64+15
  ,ААХ,С777
  15,АТХ,W3
  ,NTR,3
  ,А*Х,С1/6
  ,ATI,14
  15,WТС,W2
  14,UТМ,.АДРЕС
  ,ASN,64-1
  15,АТХ,W2
  ,ASN,64-1
  15,ARX,W2
  15,А-Х,W3
 :,ASN,64-3
  15,АТХ,W3.СДВИГ=0,8,16...
  15,WТС,W1
  12,VТМ,-BIT40
  12,ХТА, BIT40
  15,ARX,COUNT
  15,АТХ,COUNT
  14,ХТА,
  12,VIM,PUT
  :15,WТС,W3
  ,ASN,64+40
  ,ААХ,С377
  15,АТХ,SУМ
  ,ААХ,BIT8
  ,UZA,GETS2
  15,АЕХ,SУМ
  ,UJ,GBL1
  GETS2:15,ХТА,SУМ
  11,UJ,
  PUT:15,АТХ,W1
  15,ХТА,W3
  ,Х-А,. БЫЛО: ,AVX,BIT41
  15,АТХ,W3
  ,АЕХ,
  ,U1А,PUT1
  ,ХТА,BL
  15,АТХ,W1
  PUT1:15,ХТА,SУМ
  ,АЕХ,BIT6
  15,WТС,W3
  ,ASN,64-40
  15,АЕХ,W1
  14,АТХ,
  11,UJ,
  GWOR:11,Z00,
  ,Z00,BIT40
  :8,Z00,
  ,Z00,BIT16
  DECOD:,BSS,
  15,ХТА,CONTI
  ,ААХ,BIT46
  15,АТХ,CHAR
  ,U1А,TEXTID
  15,АТХ,REZAC
  15,АТХ,SУМ
  15,АТХ,COSY
  15,ХТА,CONTI
  ,ААХ,С6
  15,АТХ,SТАТ
  ,U1А,EXIT
  15,АТХ,ОСТ
  15,АТХ,CMAN
  15,АТХ,CONTI
  15,ХТА,АСС
  ,ААХ,WORS
  ,U1А,ALONE
  15,АТХ,W7
  11,VJM,GETS
  СН BL:,BSS,
  ,АЕХ,BIT6.ЛЕВЫЕ
  ,UZA,GETS.ПРОБЕЛЫ
  11,UТМ,ANAL-CHBL
  ,UJ,AN1
  TEXTID:,BSS,
  15,АЕХ,CONTI
  15,АТХ,CONTI
  ,АОХ,BIT3.IDENT
  15,АТХ,SТАТ
  ,ХТА,BL
  15,АТХ,REZAC
  15,АТХ,FILD
  ALONE:11,VJM,GETS
  ANAL:,BSS,
  15,АОХ,CONTI
  ,АЕХ,BIT6
  ,U1А,AN1
  15,ХТА,АСС
  ,ААХ,KILBL
  ,U1А,GETS
  AN 1:,BSS,
  14,VТМ,TABS-1
  15,ХТА,SУМ
  ,UZA,IS LF
  ,АЕХ,=12
  ,U1А,AN/*
  IS LF:14,UТМ,KLF-TABS1
  ,ХТА,С6.ПРИЗНАК:
  15,АТХ,CONTI.КОНЕЦ СТРОКИ
  ,UJ,ANAL W
  AN/*:,BSS,
  15,ХТА,АСС
  ,ААХ,LЕТ*/
  ,U1А,AN2
  14,UТМ,2
  AN 2:,BSS,
  AN 3:14,UТМ,1
  14,ХТА,
  ,ААХ,С377
  15,А-Х,SУМ
  ,U1А,AN3
  14,ХТА,
  ,ASN,64+8
  ,ААХ,С377
  15,Х-А,SУМ
  ,U1А,AN3
  ANAL W:15,ХТА,АСС
  ,ААХ,WORS
  ,UZA,ENTAB
  14,ХТА,
  ,ASN,64+16
  ,ААХ,С3
  15,АТХ,SТАТ
  15,ХТА,SУМ
  ,ASN,64-40
  ,АЕХ,BL
  ,АЕХ,BIT46
  ,UJ,ЕХ/REZ
  ENTAB:15,WТС,SТАТ
  ,ХТА,TSS
  14,ASX,
  ,ААХ,С77
  ,UZA,ERRN
  ,АЕХ,С77
  ,U1А,ENT1
  15,ХТА,W7
  ,UZA,SЕТ О.OCTAL
  ,UJ,ЕТЕХ2.КОНЕЦ ТЕХТ
  ENT1:,АЕХ,С77.НОРМАЛЬНО
  ,ASN,64+3
  15,АТХ,SТАТ
  ,УТА,
  ,ASN,64+45
  ,ATI,12
  15,ХТА,SУМ
  ,ATI,14
  12,UJ,SWIST
  TABS:,BSS,
  ,ISO,6Н'200'**'2'**
  ,ISO,6Н'200'//'2'//
  ,ISO,6Н'244'ЕЕ'2'ЕЕ
  ,ISO,6Н'200'БУ'2'AZ
  ,ISO,6Н'200'БУ'2''137''176'
  ,ISO,6Н'214'ЦИ'1'09
  ,ISO,6Н'260'ТЧ'3'..
  ,ISO,6Н'274'++'3'++
  ,ISO,6Н'274'--'3'--
  ,ISO,6Н'310'АР'3''47''47'
  ,ISO,6Н'230'ОГ'3''''377'
  KLF:,ISO,6Н'324'LF''''''
  TSS:,BSS,
С
С    ПО ВЕРТИКАЛИ - СОСТОЯНИЯ
С    ПО ГОРИЗОНТАЛИ - СИМВОЛЫ
С
С                  LF '  +- .  Е  ОГ ЦИ БУ
С            -----:--:--:--:--:--:--:--:--:
  0,LOG,67 54 60 67 44 67 11 44 .ПУСТО
L  1,LOG, 37 00 37 20 73 37 11 17 .ЦЕЛОЕ
L  2,LOG, 27 00 27 00 73 27 21 00 .F-ФОРМАТ
L  3,LOG, 57 00 57 00 00 57 36 00 .Е-ФОРМАТ
L  4,LOG, 47 00 47 47 45 47 45 45 .IDENT
L  5,LOG, 00 47 55 55 55 55 55 55 .ТЕХТ
L  6,LOG, 07 07 07 00 07 07 11 07 .ЗНАК ЧИСЛА
L  7,LOG, 00 00 30 00 00 00 36 00 .ЗНАК ЕХР
L  10,LOG,77 00 77 77 00 77 00 00. ФИНИШ
С
С    НА ПЕРЕСЕЧЕНИИ:
С    STN (6-4) - НОВОЕ СОСТОЯНИЕ
С    SW  (3-1) - ПЕРЕКЛЮЧАТЕЛЬ
С                ИЛИ 00, ЕСЛИ ОШИБКА
С
  SWIST:,BSS,
  :,UJ,*0
  ,Z06,ВАСК
  :,UJ,*1
  ,Z10,CHBD
  :,UJ,*2
  ,Z03,SETSR
  :,UJ,*3
  ,Z02,SETSI
  :,UJ,*4
  ,Z10,ЕТЕХ
  :,UJ,*5
  ,Z03,SЕТЕ
  :,UJ,*6
  ,Z06,EXIT
  :15,WТС,SТАТ
  ,ХТА,SWIST
  ,ATI,12
  ,ASN,64+15
  ,ААХ,С17
  15,АТХ,SТАТ
  12,UJ,
С---  КОНЕЦ ТЕКСТА
  ЕТЕХ:14,UТМ,-APOS
  ,ХТА,BIT3
  14,V1М,ЕТЕХ2.IDENT
  15,АТХ,W7.'ТЕХТ'
  ,ХТА,."ANLAST"
  ТО CON:15,АТХ,CONTI
  ,UJ,GETS
С---  О Ш И Б К А :
  ERRN:,ХТА,
  15,АТХ,SТАТ
  ЕХ/REZ:15,АТХ,REZAC
  ,UJ,EXIT
  ВАСК:15,ХТА,COUNT.ДВА
  ,ААХ,=:7777 7777.СИМВОЛА
  ,ARX,=:776.НАЗАД
  15,АТХ,COUNT.И ОДИН
  11,VJM,GETS.ВПЕРЕД
  ,АЕХ,BIT6.ПОКА
  ,UZA,ВАСК.ПРОБЕЛЫ
С---  ФОРМИРОВАНИЕ ВЫХОДНОГО РМР
  EXIT:15,ХТА,COUNT
  ,ASN,64+39
  ,ASN,64-24
  15,АЕХ,SУМ
  15,АТХ,FILD
  EXITD:14,VТМ,=:7777 7777
  EXITS:15,ХТА,COUNT
  15,АЕХ,S*COUNT
  14,ААХ,
  15,АЕХ,S*COUNT
  15,АТХ,S*COUNT
  15,ХТА,R14
  ,АТХ,SAVI14
  15,ХТА,FILD
  ,АТХ,SAVAR
  15,ХТА,REZAC
  ,UJ,OUTMACRO
С
С
С---  УЧЕТ ЗНАКА ЧИСЛА
  SETSI:,BSS,
  15,ХТА,АСС
  ,ААХ,SBABS
  ,UZA,SETSR
  ,ХТА,
  SЕТ О:,BSS,
  15,ARX,CHAR
  ,UZA,DЕС
  ,ААХ,BIT4
  ,U1А,ERRN
  15,ХТА,ОСТ
  15,АТХ,REZAC
  DЕС:,BSS,
  ,ХТА,BIT1
  15,АТХ,SТАТ
  15,ХТА,CHAR
  ,ААХ,BIT41
  ,UZA,EXIT
  15,ХТА,REZAC
  ,UZA,EXIT
  ,АЕХ,FULWOR
  ,ARX,BIT1
  ,UJ,ЕХ/REZ
  SETSR:15,ХТА,REZAC
  ,АОХ,=I0
  15,AVX,CHAR
  15,АТХ,REZAC
  15,АТХ,FILD
  15,ХТА,CHAR
  ,ААХ,BIT40
  ,UZA,EXIT
  ,ХТА,
  15,АТХ,REZAC
С---  УЧЕТ ЭКСПОНЕНТЫ
  SЕТ Е:,BSS,
  15,ХТА,REZAC
  ,NTR,13В. ,ARX,
  ,UZA,ERRN
  15,AVX,CHAR
  15,АТХ,REZAC
  15,ХТА,CMAN
  ,ААХ,С377
  15,А+Х,REZAC
  :,UZA,*+1
  ,Х-А,
  :,А-Х,=22
  ,UZA,ERRN.ПЕРЕП.АУ
  15,ХТА,CMAN
  ,ASN,64+39
  15,Х-А,REZAC
 14,VJM,С10**N
  15,А*Х,FILD
  ,UJ,ЕХ/REZ
С---  ЦЕЛОЕ КОНЧИЛОСЬ БУКВОЙ
  CHBD:,BSS,
  14,UТМ,-102В
  ,IТА,14
  ,UZA,GETS
  ,АЕХ,BIT2
  ,U1А,ERRN
  ,UТС,44В
С---  РЕГИСТРАЦИЯ ЗНАКА ЧИСЛА И ТОЧКИ
  *2:,BSS,
  *0:14,ХТА,BIT48-46В
  15,АОХ,CHAR
  15,АТХ,CHAR
  ,UJ,GETS
С---  СБОРКА ЦЕЛОГО И ВОСЬМЕР.
  *1:15,АОХ,CHAR
     15,АТХ,CHAR
  15,ХТА,ОСТ
  ,ASN,64-3
  15,АЕХ,SУМ
  ,АЕХ,С60
  15,АТХ,ОСТ
  15,ХТА,REZAC
  ,ASN,64+36.БОЛЬШЕ
  ,U1А,GETS.12 ЦИФР
  15,ХТА,CHAR
  ,ААХ,BIT40.ТЧК
  ,U1А,INT
  ,ХТА,BIT1
  INT:,BSS,
  15,ARX,CMAN
  15,АТХ,CMAN
С---  СБОРКА ЭКСПОНЕНТЫ
  *6:,BSS,
  15,ХТА,АСС
  ,АОХ,LЕТ*/
  ,АЕХ,LЕТ*/
  15,АТХ,АСС
  15,ХТА,REZAC
  ,ASN,64-1
  15,АТХ,W1
  ,ASN,64-2
  15,ARX,W1.*10
  15,ARX,SУМ
  ,А-Х,С60
  ,UJ,G*REZ
С---  ПОЛУЧЕН СИМВОЛ "Е"
  *3:,BSS,
  15,ХТА,REZAC
  ,АОХ,=I0
  15,AVX,CHAR
  15,АТХ,FILD
  ,ХТА,BIT48
  15,АТХ,CHAR
  G*REZ:,BSS,
  15,АТХ,REZAC
  ,UJ,GETS
С---  ПЕРВЫЙ СИМВОЛ - БУКВА ИЛИ АПОСТРОФ
  *4:,ХТА,BL
  15,АТХ,REZAC
  15,АТХ,FILD
  ,ХТА,BIT46
  15,АТХ,CHAR.-48
  ,ХТА,BIT1
  14,UТМ,-APOS
  14,VZM,ТО CON
  15,ХТА,SУМ
С---  СБОРКА ТЕКСТА
  *5:,АЕХ,BIT6
  15,АТХ,W1
  15,ХТА,CHAR
  ,ATI,14
  15,J+М,14
  ,ASN,64+41
  ,ATI,12
  15,ХТА,W1
  12,ASN,8
  14,АЕХ,REZAC
  14,АТХ,REZAC
  15,ХТА,CHAR
  ТЕХ1:,BSS,
  ,ARX,BIT45
  15,АТХ,CHAR
  ,U1А,GETS
  ,ААХ,С77
  ,U1А,ЕТЕХ1
  ,ХТА,BIT45
  ,АОХ,BIT1.==> FILD !
  ,UJ,ТЕХ1
  ЕТЕХ1:,BSS,
  15,ХТА,CONTI
  ,АОХ,BIT46
  15,АТХ,CONTI
  ,ХТА,С5
  ЕТЕХ2:15,АТХ,SТАТ
  ,UJ,EXITD
  G/ENCOD:,BSS,
  15,АТХ,W5.ХВОСТ.ПРОБ.
  15,АТХ,W7.ЛЕВЫЕ НУЛИ
  11,VТМ,.БЕЗ ТОЧКИ
  15,ХТА,FILD+1
  ,UZA,CHSIG
  11,VТМ,20000В.ТОЧКА
  ,Х-А,С14
  ,UZA,CHSIG
  ,ХТА,COEF+1.ПРИЗНАК:
  15,АТХ,W4. Е-ФОРМАТ
  ,ХТА,BIT1
  15,АТХ,FILD+1
  CHSIG:15,ХТА,BIN
  ,ААХ,=:774
  ,U1А,ISEXP
  ,ХТА,=I0
  ISEXP:15,АОХ,BIN
  ,NTR,6
  ,А+Х,
  ,UZA,POZ
  11,UТМ,40000В.МИНУС
  15,AVX,BIN
  POZ:15,АТХ,BIN
  ,IТА,11
  15,АТХ,REZAC
  15,АСХ,FILD+1
  ,NTR,3
  15,А-Х,FILD
  ,UZA,OVFL
  ,AVX,BIT41.ПОЛЕ ЦЕЛОГО
  14,VJM,С10**N
  15,АТХ,W6.10**I
  15,Х-А,BIN
  ,UZA,EPOZ
  15,ХТА,BIN.ЧИСТЫЙ
  ,UZA,ZERO.НОЛЬ
  15,ХТА,W4
  ,U1А,EPOZ0.Е-ФОРМАТ
  15,ХТА,FILD+1
  ,UZA,ТО DIG.I-ФОРМАТ
  14,VJM,С1/10**N
  15,Х-А,BIN
  ,U1А,EPOZ1
  15,Х-А,BIN
  ,UJ,ROUND
  EPOZ:15,ХТА,BIN
  ,А-Х,COEF+1
  ,U1А,MCALC
  15,ХТА,BIN
  ,А/Х,COEF+1
  15,АТХ,BIN
  15,ХТА,W4
  ,ARX,BIT1
  15,АТХ,W4
  ,UJ,EPOZ
  EPOZ0:15,Х-А,BIN
  ,UZA,EPOZ
  EPOZ1:15,ХТА,BIN
  ,А-Х,ONE
  ,UZA,MCALC
  15,ХТА,BIN
  ,А*Х,COEF+1
  15,АТХ,BIN
  15,ХТА,W4
  ,ARX,С377
  15,АТХ,W4
  ,UJ,EPOZ1
  ZERO:15,АТХ,W4.F-ФОРМАТ
  ,UJ,DIGIT
С
С---   ВЫЧИСЛЕНИЕ ДЛИНЫ МАНТИССЫ
С
  MCALC:,NTR,3
  ,ХТА,COEF+1
  15,АТХ,W6
  15,ХТА,REZAC
  ,ASN,64+14.ЗНАК
  ,ARX,С5.IЕ-NN
  15,Х-А,FILD
  ,U1А,OVFL.КРАНТЫ
  ,ATI,14
  14,VZM,MCALC1
  14,UТМ,-1
  14,V1М,MCALC1
  ,ХТА,=R100.0
  15,АТХ,W6
  MCALC1:,IТА,14
  15,АТХ,FILD+1
С
С---   ПОЛУЧЕНИЕ ЦИФР ЧИСЛА
С
  ТО DIG:,BSS,
 14,VJM,С1/10**N
  ROUND:,BSS,
 ,Е-N,64+1./2
 15,А+Х,BIN.ОКРУГЛЕНИЕ
 15,АТХ,BIN
  15,А-Х,W6
  ,UZA,EPOZ.НЕ ЛЕЗЕМ В ПОЛЕ
  15,ХТА,W4
  ,UZA,DIGIT.НЕ Е-FORM.
  ,NTR,3
  ,ААХ,BIT8
  ,ASN,64-33
  NЕХР1:15,АТХ,W1
  15,ХТА,W4
  15,AVX,W1
  ,ААХ,С377
  ,UZA,NЕХР3.ПОРЯДОК:0
  15,АТХ,W4
  ,А-Х,=12
  ,U1А,NЕХР2
  ,АЕХ,BIT9
  15,АТХ,W4
  NЕХР2:15,ХТА,W1
  ,ASN,64+23
  15,АЕХ,W4
  ,ASN,64-16
  NЕХР3:,ARX,ТЕХР
  15,АТХ,W4
  DIGIT:,NTR,6
  15,ХТА,W6
  ,А*Х,COEF
  15,АТХ,W6
  ,U1А,ENUM
  15,ХТА,BIN
  15,А/Х,W6
  ,NTR,3
  ,А+Х,=I0
  ,ATI,14.ЦИФРА
  ,NTR,6
  15,А*Х,W6
  15,Х-А,BIN
  15,АТХ,BIN.ОСТАТОК
  ,IТА,14
  15,АЕХ,W7
  ,U1А,NOTZER
  15,ХТА,W6
  ,А-Х,COEF+1
  ,U1А,NOTZER
  15,ХТА,АСС
  ,ААХ,BIT20
  ,ASN,64+14.ЗАМЕНА
  ,U1А,PUTDIG.ЛЕВЫХ
  15,ХТА,W5.НУЛЕЙ
  ,ARX,BIT1.ПРОБЕЛАМИ
  15,АТХ,W5
  ,UJ,DIGIT
  NOTZER:14,UТМ,60В
  15,ХТА,REZAC
  ,ААХ,BIT15
  ,UZA,NOTSIG
  ,IТА,14
  15,АТХ,REZAC
  14,VТМ,MINUS
  ,IТА,14
  11,VJM,PUTS
  15,ХТА,REZAC
  ,ATI,14
  NOTSIG:,ХТА,ONE
  15,АТХ,W7
  ,IТА,14
  ,UJ,PUTDIG
  ENUM:15,ХТА,FILD+1
  ,UZA,PUTEX
  14,VJM,С10**N
  15,АТХ,W6.ПЕРЕХОД
  15,А*Х,BIN.К
  15,АТХ,BIN.МАНТИССЕ
  14,VТМ,POIN
  ,ХТА,
  15,АТХ,FILD+1
  ,UJ,NOTSIG
  PUTEX:11,VТМ,*+1
  :15,ХТА,W4
  ,ASN,64-8
  15,АТХ,W4
  ,УТА,
  ,U1А,PUTS
  ,NTR,3
  11,VТМ,*+1
  :15,ХТА,W5
  ,UZA,GRENC
  ,А-Х,BIT1
  15,АТХ,W5
  PUT BL:,BSS,
  ,ХТА,BIT6
  ,UJ,PUTS
  OVFL:,BSS,
  ,ХТА,BIT1
  15,АТХ,R14
  11,VТМ,*+1
  :15,ХТА,FILD
  ,UZA,BRENC
  ,А-Х,BIT1
  15,АТХ,FILD
  14,VТМ,STAR
  ,UJ,SPUT
  Н/ENCOD:,BSS,
  15,ХТА,FILD
  ,UZA,GRENC
  ,А-Х,BIT1
  15,АТХ,FILD
  11,VJM,GETS
  11,UТМ,Н/ENCOD-*
  ,ASN,64+5
  15,АОХ,FILD+1
  ,UZA,PUT BL.БРЕД ЗАМЕНЯЕТСЯ
  15,ХТА,SУМ
  ,UJ,PUTS
  В/ENCOD:,BSS,
  15,ХТА,FILD
  ,UZA,GRENC
  ,ААХ,BIT5
  ,UZA,BENC1
  15,АТХ,FILD
  BENC1:15,ХТА,FILD
  ,А-Х,BIT1
  15,АТХ,FILD
  ,ATI,14
  15,ХТА,BIN
  14,ASN,64
  14,ASN,64
  14,ASN,64
  ,ААХ,С7
  ,АЕХ,С60
  11,VJM,PUTS
  BENC2:,BSS,
  15,ХТА,FILD
  ,UZA,GRENC
  15,ХТА,W4
  ,ARX,BIT1
  15,АТХ,W4
  15,АЕХ,FILD+1
  ,U1А,BENC1
  15,АТХ,W4
  11,UТМ,BENC1-BENC2
  ,UJ,PUT BL
  GRENC:,ХТА,
  15,АТХ,R14
  BRENC:,BSS,
  15,ХТА,COUNT
  ,ASN,64+15
  ,ААХ,С777
  15,АТХ,REZAC
  14,VТМ,В24/1
  ,UJ,EXITS
С
С...  ВЫЧИСЛЕНИЕ  10.**N
С     N - В МЛ.РАЗР.СУММАТОРА
С     РЕЗУЛЬТАТ НА СУММАТОРЕ
С     ПОРТЯТСЯ  W1  И 12 РЕГ.
С     ВЫХОД ПО 14 РЕГ. С ,NTR,6
  С10**N:,BSS,
  11,VТМ,0
  ,NTR,23В
  ,UZA,Р/Е
  ,AVX,BIT41
  С1/10**N:,BSS,
  ,ATI,11
  ,NTR,3
  Р/Е:,BSS,
  ,ATI,12
  ,А-Х,=22
  ,U1А,S/Е
  12,VТМ,18
  S/Е:,NTR,6
  ,ХТА,ONE
  14,UТС,
  12,VZM,
  С/Е:,А*Х,COEF+1
  12,UТМ,-1
  12,V1М,С/Е
  15,АТХ,W1
  14,UТС,
  11,VZM,
  ,ХТА,ONE
  15,А/Х,W1
  14,UJ,
С---
С
С      ******  ЭКСТРАКОДЫ: ,*50,А   А > 15
С
С             " И П З   З А Д А Ч И "
С             =======================
  TUNIT:,EQU,32.ТАБЛ.МАТ.НОМ.
  NАМЕ:,EQU,120В
С
С
  EMULATOR:,BSS,
  ,IТА,14
  ,А-Х,С50
  ,U1А,ERREXTR
  ,А-Х,С60
  ,UZA,AGT127
  14,ХТА,BIT48-50В
  ,АРХ,М50/127
  ,UZA,OUTMACRO.ПУСТОЙ
  ,ANX,С77777
  ,ATI,13
  ,ХТА,SAVAC
  13,UJ,SW50/127
С...   64,65,66,67,112
  М50/127:,ISO,6Н'''017''000''000''040'''
 SW50/127:,BSS,
  :,ATI,12. 64
  ,UJ,WRNAME
  :12,VТМ,TAPES. 65
  ,UJ,DELTA
  :,,
  :,,
  :12,VТМ,OUTMACRO. 112
  ,UJ,DELTA
С--------------------
  AGT127:14,UТМ,-200В
  14,VZM,Р/STATUS
  14,UТМ,200В-201В
  14,VZM,ОСТ210
  14,UТМ,201В-202В
  14,VZM,NBTOISO
  14,UТМ,202В-203В
  14,VZM,NBTOBIN
  ,ХТА,SAVI14
  ,ААХ,=70000
  ,АЕХ,=70000
  ,U1А,ERREXTR
  ,ХТА,SAVI14
  ,ASN,64+10
  ,ААХ,С3
  ,ATI,12
  ,ХТА,SAVI14
  ,ААХ,=1777
  ,ATI,14
  ,А-Х,=262
  ,UZA,OUTMACRO.ПУСТОЙ
  15,J+М,14
  ,ХТА,SAVAC
  12,UJ,*+1
  :14,ХТА,-100В
  ,UJ,RЕТАС
  :14,АТХ,-100В
  ,UJ,RЕТАС
  :14,АОХ,-100В
  ,UJ,*-1
  :14,ААХ,-100В
  ,UJ,*-2
С---------------  64  -  ЗАПИСЬ "NАМЕ"
  WRNAME:15,UТМ,NАМЕ
  12,ХТА,
  12,XTS,1
  12,XTS,2
  ,XTS,SAVAC
  ,UJ,OUTMACRO
С---------------  65  - ЗАМЕНА ИДЕНТИФ.МЛ
  TAPES:,UZA,*+1
  1,MTJ,11
  :,ХТА,SAVAC
  ,ASN,64+24
  1,VТМ,
  12,VJM,DELTA
  1,VZM,OUTMACRO
  11,VZM,OUTMACRO
  11,XTS,TUNIT-30В
  1,SТХ,TUNIT-30В
  11,АТХ,TUNIT-30В
  ,UJ,OUTMACRO
С-------------- 112  -  УСТАНОВКА "ДЕЛЬТЫ"
  DELTA:15,АТХ,W1
  ,ASN,64+12
  ,ААХ,С77
  12,UZA,
  ,ATI,1
  1,UТМ,ИПЗ+1
  1,ХТА,TUNIT-30В
  12,UZA,.НЕТ МЛ
  15,ХТА,W1
  ,ASN,64-24
  1,АЕХ,TUNIT-30В
  ,ААХ,=:0000 1777
  1,АЕХ,TUNIT-30В
  1,АТХ,TUNIT-30В
  12,UJ,
С---------------  200 - СТАТУС ЛИСТА
  Р/STATUS:,ХТА,. 0 (СВОБОДЕН)
  ,UJ,RЕТАС
С---------------  201 - "2 ===> 2/10"
  ОСТ210:,ХТА,
  15,АТХ,REZAC
  ,ХТА,SAVAC
  ,ААХ,С7777
  DD/LООР:15,АТХ,W1
  ,А*Х,=4001 4631 4631 4632.1/10
  15,АТХ,W2.ЧАСТНОЕ
  ,ASN,64-2
  15,ARX,W2
  ,ASN,64-1
  15,Х-А,W1
  11,ASN,64.ОСТАТОК
  15,АОХ,REZAC
  15,АТХ,REZAC
  11,UТМ,-4
  15,ХТА,W2
  ,ААХ,С7777
  ,U1А,DD/LООР
  15,ХТА,REZAC
  ,UJ,RЕТАС
С-----------------  202 - "2/10 ===> ISO"
  NBTOISO:,ХТА,SAVAC
  ,ASN,64-36
  ,AUX,=6Н'''''''17''17''17'
  ,АОХ,=6Н   000
  ,UJ,RЕТАС
С-----------------  203 -
  NBTOBIN:,ХТА,SAVAC
  ,ААХ,С7777
  RЕТАС:,АТХ,SAVAC
  ,UJ,OUTMACRO
С--------------------
 BL:,ISO,6Н
  ТЕХР:,ISO,6НЕ+00''''
  COEF:,REAL,0.1
  :,REAL,10.0
  ONE:,REAL,1.0
  С1/6:,LOG,4002 5252 5252 5253
  :,BSS,
 ,END,
  MACRO64:,NАМЕ,
С
С*****   НЕРЕЗИДЕНТ ЭКСТРАКОДА ПЕЧАТИ
С
  SAVEMOD:,SUBP,
  OUTMACRO:,SUBP,
  BITS:,EQU,74677В
  BITS:I,BLOCK,(1),BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
  CONST:LС,BLOCK,FULWOR,В24/1
  ,CONT,С77777,С7777,С777,С377,С77,С37,С17,С7,С3
 С1:,EQU,BIT1
 К06131:,EQU,BIT1
 К06457:,EQU,BIT34
 К06135:,EQU,С17
С-----
  ИПЗ:LС,BLOCK,(33)
 ,CONT,SAVAC,SAVSR,SAVAR
 ,CONT,SAVI15,SAVI14,SAVI13(13)
 М:,EQU,100В.
 REGSCAL:,EQU,М.
 АВ:,EQU,9.
 RТ:,EQU,14.
 RВ:,EQU,2.
 NS:,EQU,3.
 С177:,EQU,=177
 К06137:,EQU,С177
 К06141:,EQU,С77777.
 К06133:,EQU,С7.
 С13:,EQU,=13
 К06143:,EQU,С13
 К06365:,EQU,FULWOR.
 К06366:,EQU,С377
С
С     ЯЧЕЙКИ ТИПА РП
С
  *126:В,BLOCK,BBUF,EBUF,ТЕ
  ,CONT,OLDBLS,NSTRI
С
С     ЯЧЕЙКИ ТИПА Р
С
 *5:В,BLOCK,В145,В146,В147,В144
 ,CONT,RR,BLS,EXPPOS
 ,CONT,NEWBLS,В150,PFLAG
 ,CONT,В152,В153,В154,В 71,В156
 ,CONT,В157,В160,В161,В162,В163
 ,CONT,В164,В165,В166,В120,SМВ
 ,CONT,В172,BLANL
С-------------------------
  ,LОС,75022В. <<< 7А12 Н >>>
  14,ХТА,
  ,АТХ,SAVAC
  :,ХТА,*+1
  ,UJ,SAVEMOD
  :,Z00,
  ,Z00,*+1
 :15,VТМ,ИПЗ+1
 15,ХТА,REGSCAL
 14,VZM,SРЕС0.,*64,0
 14,MTJ,6
  6,UТМ,-1
  6,VZM,SРЕС1.,*64,1
 ,ААХ,BIT44
 ,UZA,NON DР
 ,ХТА,DР.ПРОТЯЖКИ В НАЧ.Л
 NON DР:15,АТХ,PFLAG
  15,ХТА,BBUF
  15,АТХ,ТЕ
  ,ATI,9
 ,NTR,0
 15,ХТА,OLDBLS
 ,ASN,64-40.В НАЧАЛО ЛИСТА
 9,АТХ,.В БУФЕР
 ,ХТА,SAVAC
  6,VJM,GIVADR
  15,АТХ,В154.АКОН
  ,ХТА,SAVAC
  ,ASN,64+24
  6,VТМ,AFTGA
  GIVADR:15,АТХ,
  ,ASN,64+20
  ,ААХ,С17
 ,UZA,IND/0
  ,АЕХ,С17
  ,ATI,8
  8,ХТА,SAVI15
 IND/0:,BSS,
  15,ARX,
  ,ААХ,С77777
  ,ATI,8
  6,UJ,
С---
  SРЕС1:,АОХ,BIT44
  ,UJ,SРЕС
  SРЕС0:,АОХ,BIT44
  ,АЕХ,BIT44
  SРЕС:15,АТХ,REGSCAL
  ,UJ,OUTMACRO
С---
  AFTGA:8,MTJ,12.АНАЧ
  14,MTJ,13.ТЕК.ИНФ.СЛОВО
 ,IТА,.
          15,  АТХ  , В150          .
          15,  АТХ  , В152          .
 15,АТХ,EXPPOS.
 15,АТХ,В71.
 15,АТХ,В172.
          15,  АТХ  , В120          .
          15,  АТХ  , В153          .
          15,  АТХ  , BLS           .
 15,АТХ,BL А NL.
 6,VТМ,1.
 5,VТМ,.
 ,ХТА,SAVAC.
 ,ААХ,BIT43.ПРИЗН."COSY"
 ,UZA,L06206.
С     ВХОД ПО COSY ГОСТУ МИНУЯ РЕДАКТИРОВАНИЕ
 6,VТМ,.
 11,VJM,R WORD.
 15,АТХ,В154.
 ,ASN,64+40.
 15,АТХ,NEWBLS.
 15,ARX,OLDBLS.
 15,АТХ,OLDBLS.
 ,NTR,3.
 5,VJM,СНЕКР.КОРРЕКЦИЯ ПРОТЯЖЕК
 ,IТА,.
 15,АТХ,NEWBLS.
 5,VJM,СНЕКР2.УЧЕТ ЛИСТОВАНИЯ
 15,ХТА,OLDBLS.
 15,ARX,RR.
 ,ASN,64-40.
  15,АЕХ,В154
  ,ААХ,=:776
  15,АЕХ,В154
  5,VТМ,-26.МАКС=160 СИМВ.
 L06200:8,UТМ,1.
 15,АТХ,В154.
 9,АТХ,.В БУФЕР
 ,ААХ,С177.
 ,АЕХ,CENDSTR.
 ,UZA,BUFST.КОНЕЦ СТРОКИ
 2,VJM,BUFSTEP.
 11,VJM,R WORD.
 5,VLM,L06200
 9,АТХ,.
 ,UJ,BUFST.
С
С  НАЧАЛО РАЗБОРА
С
 L06206  :15,  ХТА  , В153          .
            ,  U1А  ,L06336         .
            ,  ХТА  ,К06141         .
          15,  АТХ  , В153          .
          11,  VТМ  ,L06212         .
  13,MTJ,10
 L06211  :10,  UТМ  , 00001В        .
 ,UJ,READ.
  L06321:,ХТА,SAVI14
  ,ATI,13.НАЧ.РАЗМЕТКИ
  L06243:11,VТМ,L06246
 R WORD:8,MTJ,10.
 READ:,BSS,.
 10,ХТА,.
          11,   UJ  ,               .
 L06336  :15,  ХТА  , В157          .
          15,  ARX  , В161          .
          15,  АТХ  , В157          .
            ,  ATI  ,  1            .
 L06230  :15,  ХТА  , В160          .
            ,  ATI  ,  5            .
          15,  ХТА  , В156          .
            ,  ААХ  , С3            .
            ,  UZA  ,L06240         .
            ,  АЕХ  ,К06131         .
            ,  U1А  ,L06233         .
           2,  VТМ  , 00027В        .
            ,  IТА  ,  2            .
          15,  АТХ  , В160          .
 L06233  :15,  ХТА  , В157          .
          15,  ARX  , В160          .
            ,  ARX  ,К06142         .
            ,  ASN  ,64+7           .
            ,  UZA  ,L06240         .
          15,  АТХ  , В150          .
          15,  ХТА  , В166          .
          15,  АТХ  , В157          .
            ,  ATI  ,  1            .
            ,  АТХ  ,               .
 L06240  :15,  ХТА  , В162          .
            ,  U1А  ,L06323         .
          15,  АТХ  , В153          .
          15,  ХТА  , В163          .
            ,  U1А  ,L06321         .
   13,VLM,L06243.НА НОВ.СЛ.РАЗМ.
 L06323  :15,  ХТА  , В162          .
            ,  ARX  ,К06142         .
 L06324  :15,  АТХ  , В162          .
            ,  АЕХ  ,К06365         .
            ,  UZA  ,L06324         .
            ,   UJ  ,L06243         .
 L06212  :15,  АТХ  , В165          .
            ,  ASN  ,64+44          .
            ,  ААХ  ,К06133         .
          15,  АТХ  , В156          .
          15,  ХТА  , В165          .
            ,  ASN  ,64+36          .
            ,  ААХ  ,К06137         .
          15,  АТХ  , В157          .
          15,  АТХ  , В166          .
            ,  ATI  ,  1            .
          15,  ХТА  , В165          .
            ,  ASN  ,64+24          .
            ,  ААХ  ,К06137         .
          15,  АТХ  , В160          .
          15,  ХТА  , В165          .
            ,  ASN  ,64+23          .
            ,  ААХ  ,К06131         .
          15,  АТХ  , В163          .
          15,  ХТА  , В165          .
            ,  ASN  ,64+12          .
            ,  ААХ  ,К06137         .
          15,  АТХ  , В161          .
          15,  ХТА  , В165          .
            ,  ААХ  ,К06137         .
          15,  АТХ  , В162          .
            ,   UJ  ,L06230         .*****
 L06246  :15,  АТХ  , В144          .
          15,  ХТА  , В156          .
            ,  ASN  ,64+2           .
            ,  U1А  ,L06250         .
  6,VТМ,L06314
          15,  WТС  , В156          .
            ,   UJ  ,L06306         .*****
 L06250  : 5,  VТМ  , 00070В        .
           6,  VТМ  ,L06260         .
   8,MTJ,12.ЗАПОМИНАЕМ НАЧАЛО ТЕКСТА
 SУМ IN:5,UТМ,-8.
 5,VIM,NО WORD.
С.....   ПРОВЕРКА КОНЦА ТЕКСТА
  ,IТА,12.ЕСЛИ АН = АК ,
 15,АЕХ,В154. ЛОВИМ СИМВОЛЫ
 ,UZA,NО END. '231'/'172'
 ,IТА,8. ДОШЛИ
 15,АЕХ,В154.ДО КОНЦА
 ,UIA,NО END.- НЕТ
 ,ХТА,С231.- КОНЕЦ ПО
 ,UJ,S IS.  АДРЕСУ
 NО END:8,UТМ,1.
 11,VJM,R WORD.
 5,VТМ,48.
 15,АТХ,В144.
 NО WORD:15,ХТА,В144.
 ,ASN,64-8
 15,АТХ,В144
 ,УТА,
 S IS:,BSS,
          15,  АТХ  , В147          .
 ,ATI,11
          15,  ХТА  , В156          .
            ,  ASN  ,64+2           .
 L05303  :  ,  U1А  ,L05305         .
          15,  ХТА  , В147          .
 6,UJ,
 L05305  :15,  ХТА  , В147          .
            ,  ASN  ,64+4           .
            ,  UZA  ,L05303         .
            ,  ААХ  ,BIT1           .
          14,  VТМ  , 00030В        .
            ,  UZA  ,L05311         .
          14,  VТМ  ,               .
            ,  АТХ  ,               .
 L05311  :15,  ХТА  , В147          .
            ,  ААХ  ,К06135         .
            ,  ATI  ,  2            .
          15,  ХТА  , В147          .
            ,  ASN  ,64+6           .
            ,  UZA  ,L05316         .
          14,  UТМ  , 00010В        .
            ,  ААХ  ,BIT1           .
            ,  U1А  ,L05316         .
          14,  UТМ  , 00010В        .
 L05316:2,ХТА,ТАБЛАВТ.
          14,  ASN  ,64             .
            ,  ААХ  ,К06366         .
 15,АТХ,В147
 ,ATI,11
 6,UJ,
 L06260  :15,  АТХ  , В164          .
            ,  ХТА  ,               .
 L06261  :15,  АТХ  , В172          .
 6,VJM,SУМ IN.
 1,MTJ,14
 14,UТМ,-200В
 14,V1М,L02232
          15,  ХТА  , В154          .
            ,  UZA  ,L06277         .
 ,BSS,.
С
С*****   РАЗБОР УПРАВЛЯЮЩИХ СИМВОЛОВ
С
 '    265 , 174 - RЕРЕАТ LAST SYMBOL
 '    214 , 175 - NEW LINE
 '    242 , 017 - BLANK
 '    231 , 172 - END OF INFORMATION
 '    200 , 173 - NUMBER OF POSITION
 '    176 - BLANK
 '    177 - DOUBLE SYMBOL ':='
 '    201 - NEW PAGE
 '    204 - NEW 1/2-PAGE
 '    205 - NEW 1/3-PAGE
 '    206 - NEW 1/4-PAGE
 '    212 - SАМЕ STRING
 '    310 - BLOCK OF PAGING
С
 L02232:,BSS,
 11,UТМ,-265В
 11,VZM,L15773
 11,UТМ,265В-174В
 11,VZM,L15773
          15,  ХТА  , В164          .
            ,  ATI  ,  2            .
 2,UТМ,-17В
 2,VZM,L06540
 ,ARX,BIT6
 ,ASN,64+7
 ,UZA,L16042
 2,UТМ,17В-214В
           2,  VZM  ,L06351         .214
           2,  UТМ  , 00017В        .
           2,  VZM  ,L06351         .175
           2,  UТМ  , 77733В        .
           2,  VZM  ,L06540         .242
 2,UТМ,242В-231В
           2,  VZM  ,L06334         .231
           2,  UТМ  , 00037В        .
           2,  VZM  ,L06334         .172
           2,  UТМ  , 77772В        .
           2,  VZM  ,L06275         .200
           2,  UТМ  , 00005В        .
           2,  VZM  ,L06275         .173
           2,  UТМ  , 77775В        .
           2,  VZM  ,L06540         .176
           2,  UТМ  , 77775В        .
           2,  V1М  ,L16013         .
С.....   РЕАЛИЗАЦИЯ 'NEW PAGE'
 L16001  :15,  ХТА  , NSTRI         .
            ,  АЕХ  , DР            .
            ,  U1А  ,L16005         .
          15,  АТХ  , BLS           .
            ,  ХТА  ,BIT1           .
          15,  АТХ  , В71           .
 L16040:,BSS, .БЫЛО - L16040:15,WТС,В57
           1,  VТМ  ,               .
 L06542  :15,  ХТА  , В147          .
            ,   UJ  ,L06260         .
 L16005  :15,  ХТА  , NSTRI         .
            ,  АЕХ  , FULWOR        .
            ,  ARX  , DР            .
            ,  U1А  ,L16010         .
            ,  ARX  , FPL           .
            ,  АТХ  ,               .
 L16010  :15,  АТХ  , BLS           .
 15,АТХ,В150.
            ,  ХТА  ,               .
          15,  АТХ  , PFLAG         .
            ,   UJ  ,L16040         .*****
 L16013  : 2,  UТМ  , 77775В        .
           2,  V1М  ,L16015         .
 ,ХТА,С41
 L16022  :15,  АТХ  , BLS           .
          15,  ХТА  , NSTRI         .
            ,  АЕХ  , FULWOR        .
            ,  ARX  , DР            .
 L16024  :15,  ARX  , BLS           .
            ,  U1А  ,L16010         .
           2,  VLM  ,L16024         .
            ,   UJ  ,L16001         .
 L16015  : 2,  UТМ  , 77777В        .
           2,  V1М  ,L16020         .
            ,  ХТА  ,BIT5           .
            ,  ARX  , DР            .
           2,  VТМ  , 77777В        .
            ,   UJ  ,L16022         .
 L16020  : 2,  UТМ  , 77777В        .
           2,  V1М  ,L06532         .
            ,  ХТА  ,BIT5           .
           2,  VТМ  , 77776В        .
            ,   UJ  ,L16022         .*****
 L06532  : 2,  UТМ  , 77774В        .
           2,  VZM  ,L06536         .212
           2,  UТМ  , 77702В        .
  ,ХТА,
 2,V1М,L16041
          15,  АТХ  , PFLAG         .
            ,   UJ  ,L06542         .
 L16041:,BSS,
 15,АТХ,В71
 ,UJ,L05400
 L16042:,BSS,
          15,  АТХ  , В71           .
 L06277  :15,  ХТА  , В164          .
          15,  АТХ  , SМВ           .
           4,  VJM  ,L06147         .
 L06302  :15,  ХТА  , В172          .
 ,UZA,L06542.- НЕТ ПОВТОР.
 ,ARX,С77777
 ,ААХ,С77777
          15,  АТХ  , В172          .
 ,UJ,L06277.
С.....   ВЫДАЧА СИМВОЛА
 L06147  :15,  ХТА  , В150          .
            ,  UZA  ,L06345         .
С.....   ПЕРЕХОД НА НОВУЮ СТРОКУ
 NEW STR:,BSS,.
 L06150  :15,  ХТА  , В154          .
            ,  UZA  ,L02101         .
          15,  ХТА  , BLS           .
            ,  U1А  ,L06152         .
            ,  ХТА  ,BIT1           .
            ,  АТХ  ,               .
 L06152  :15,  АТХ  , BLS           .
          15,  ХТА  , В152          .
            ,  UZA  ,L14602         .
          15,  ХТА  , В165          .
            ,  ASN  ,64+20          .
            ,  ААХ  , С7            .
          15,  ARX  , BLS           .
          15,  АТХ  , BLS           .
 L14602  :  ,  ХТА  ,               .
          15,  АТХ  , В150          .
          15,  АТХ  , В120          .
 L06157  :    ,BSS  ,               .
          15,  ХТА  , В71           .
 ,UZA,END STRI
            ,  ХТА  ,               .
          15,  АТХ  , В71           .
          15,  АТХ  , BLS           .
 ,UJ,END STRI
 L02101  :15,  ХТА  , SМВ           .
          15,  АТХ  , BLS           .
            ,  ХТА  ,К06330         .
          15,  АТХ  , SМВ           .
          15,  АТХ  , В152          .
            ,   UJ  ,L06157         .
 L06345  :  ,  IТА  ,  1            .
            ,  ASN  ,64+7           .
            ,  UZA  ,L06000         .
           1,  UТМ  , 77600В        .
            ,   UJ  ,L06150         .
 L06000  :15,  ХТА  , В120          .
            ,  U1А  ,L06005         .
            ,  ХТА  ,L06000         .
          15,  АТХ  , В120          .
            ,  ХТА  ,               .
          15,  АТХ  , EXPPOS        .
 L06003  : 3,  VТМ  , 77730В        .
          15,  АТХ  , BLS           .
          15,  ХТА  , ТЕ            .
            ,  ATI  ,  9            .
С<<<    ЗДЕСЬ МОЖНО СЭКОНОМИТЬ!
 L06005:,BSS,
 ,IТА,1
 15,АЕХ,EXPPOS
 ,UZA,L06013
            ,  NTR  , 00003В        .
            ,  IТА  ,  1            .
          15,  А-Х  , EXPPOS        .
            ,  NTR  , 00020В        .
            ,  U1А  ,L06165         .
            ,  ARX  ,К06137         .
          14,  VJM  , WRTSM         .
 L06013  :15,  ХТА  , SМВ           .
          14,  VJM  , WRTSM         .
           1,  UТМ  , 00001В        .
            ,  IТА  ,  1            .
          15,  АТХ  , EXPPOS        .
           4,   UJ  ,               .
 L06165  :  ,  ХТА  ,               .
            ,   UJ  , ZNB           .
 L05400  :15,  ХТА  , В164          .
 ,АЕХ,С177.СИМВОЛ - ':='
            ,  U1А  ,L05575         . - НЕТ
            ,  ХТА  , С37           .
          15,  АТХ  , SМВ           . ':'
           4,  VJM  ,L06147         .
            ,  ХТА  ,К05405         .
          15,  АТХ  , SМВ           . '='
           4,  VТМ  ,L06302         .
            ,   UJ  ,L06147         .
 L05575  :  ,  ХТА  ,К06245         .
          15,  АТХ  , SМВ           .
 4,VТМ,L06302.
 ,UJ,L06147.
С.....   ПЕЧАТЬ БЕЗ ПРОТЯЖКИ
 L06536  :15,  ХТА  , OLDBLS        .
            ,  UZA  ,L06542         .
            ,  NTR  , 00003В        .
            ,  А-Х  ,BIT1           .
          15,  АТХ  , OLDBLS        .
            ,  ASN  ,64-40          .
          15,  WТС  , ТЕ            .
            ,  АТХ  ,               .
          15,  ХТА  , NSTRI         .
            ,  U1А  ,L14577         .
            ,  ХТА  , FPL           .
 L14577  :  ,  А-Х  ,BIT1           .
          15,  АТХ  , NSTRI         .
            ,  NTR  , 00004В        .
            ,   UJ  ,L06542         .
С.....   НОМЕР ПОЗИЦИИ : СИМВОЛ '200'
 L06275  :15,  ХТА  , В147          .
 ,АЕХ,С231.
 ,UZA,L06334.
 ,IТА,1.
 ,ASN,64+7.
 ,U1А,NEW LIN.
 NON NEWL:,BSS,.
 15,ХТА,В147.
            ,  ATI  ,  1            .
           6,  VТМ  ,L06260         .
 ,UJ,SУМ IN.
 NEW LIN:,BSS,.
 15,АТХ,BL А NL.
 ,UJ,NEW STR.
С.....   КОНЕЦ  Б Ц И
 L06334  : 5,  UТМ  , 77720В        .
           5,  V1М  ,L06314         .
           8,  UТМ  , 77777В        .
 L06314  :  ,  IТА  ,  8            .
           8,  UТМ  , 00001В        .
            ,  АЕХ  ,К06365         .
          15,  ARX  , В154          .
            ,  ASN  ,64+15          .
            ,  UZA  ,L06326         .
          15,  АТХ  , В150          .
          15,  АТХ  , В152          .
            ,   UJ  ,L06150         .
 L06326  :15,  ХТА  , В153          .
            ,  U1А  ,L06206         .
          15,  ХТА  , В163          .
          15,  АОХ  , В150          .
          15,  АТХ  , В150          .
  13,MTJ,10
          11,  VJM  ,L06211         .
            ,  ASN  ,64+36          .
            ,  ААХ  ,К06137         .
          15,  АТХ  , В157          .
            ,  IТА  ,  1            .
            ,  ARX  ,К06142         .
            ,  NTR  , 00003В        .
          15,  А-Х  , В157          .
            ,  NTR  , 00020В        .
            ,  U1А  ,L06206         .
            ,  ХТА  ,К06141         .
          15,  АТХ  , В150          .
            ,   UJ  ,L06206         .
С.....   ГРУППА ПРОБЕЛОВ
 L06540:15,WТС,В172.
           1,  UТМ  , 00001В        .
 15,ХТА,В147
 ,UJ,L06260
 L06351  :15,  ХТА  , BLS           .
            ,  ARX  ,BIT1           .
          15,  ARX  , В172          .
          15,  АТХ  , В150          .
          15,  АТХ  , BLS           .
 ,UJ,L16040.
С.....   СИМВОЛ ПОВТОРЕНИЯ : 256 / 174
 L15773  :15,  ХТА  , В164          .
            ,  ATI  ,  2            .
           2,  UТМ  , 77600В        .
           2,  VZM  ,L06275         . - 200
           2,  UТМ  , 00005В        .
           2,  VZM  ,L06275         . - 173
           2,  UТМ  , 77742В        .
           2,  VZM  ,L06334         . - 231
           2,  UТМ  , 00037В        .
           2,  VZM  ,L06334         . - 172
 6,VJM,SУМ IN.
 ,АЕХ,С231.
 ,UZA,L02232.
 15,ХТА,В147.
 ,UJ,L06261.
 L15774:,BSS,
 ,IТА,1
 ,ААХ,К06137
 ,ATI,1
 ,ХТА,
 ,UJ,L06003
 CONT RED:,BSS,.РЕДАКТИРОВАНИЕ
          15,  ХТА  , NEWBLS        .
 ,UZA,L15774
 15,ХТА,BL А NL.
 ,UZA,N BLL.
 ,ХТА,.
 15,АТХ,BL А NL.
 ,UJ,NON NEWL.
 N BLL:15,ХТА,NEWBLS.
 ,UJ,L06147.
С*****   ПЕРЕКЛЮЧАТЕЛЬ ТИПА ФОРМАТА
 L06306  :  ,   UJ  ,L06250         .
  :,UJ,L06045
  :,UJ,L06033
         : 5,  UТМ  , 77774В        .
            ,  IТА  ,  5            .
С*****
            ,  ААХ  ,К06137         .
          15,  АТХ  , В146          .
С.....   РЕДАКТИРОВАНИЕ ЧИСЕЛ
 15,ХТА,В144
            ,  AVX  ,               .
          15,  АТХ  , В144          .
            ,  ХТА  ,К06134         .
          15,  АТХ  , SМВ           .
           5,  VТМ  , 00001В        .
           4,  VТМ  ,L06101         .
 L06064  :15,  ХТА  , В144          .
            ,  АМХ  ,К06361         .
            ,  U1А  ,L06070         .
           5,  UТМ  , 00012В        .
          15,  ХТА  , В144          .
            ,  А*Х  ,К06360         .
 L06067  :15,  АТХ  , В144          .
            ,   UJ  ,L06064         .
 L06070  :15,  ХТА  , В144          .
            ,  UZA  ,L06344         .
            ,  АМХ  ,К06362         .
            ,  UZA  ,L06107         .
           5,  UТМ  , 77777В        .
          15,  ХТА  , В144          .
            ,  А*Х  ,К06361         .
            ,   UJ  ,L06067         .
 L06344:5,VТМ,
 L06107  :15,  ХТА  , В144          .
            ,  ASN  ,64+40          .
            ,  ААХ  ,К06131         .
            ,  ARX  ,К06134         .
          15,  АТХ  , SМВ           .
           4,  VJM  ,L06147         .
            ,  ХТА  ,К02700         .
          15,  АТХ  , SМВ           .
           4,  VJM  ,L06147         .
          15,  ХТА  , В144          .
          15,  AVX  , В144          .
          15,  АТХ  , В144          .
            ,  NTR  , 00003В        .
            ,  А+Х  ,К06130         .
            ,  ААХ  ,К06135         .
          15,  АТХ  , SМВ           .
            ,  АОХ  ,К06130         .
            ,  NTR  ,               .
            ,  А+Х  ,               .
          15,  Х-А  , В144          .
            ,  А*Х  ,К06361         .
          15,  АТХ  , В144          .
          15,  ХТА  , В146          .
            ,  ARX  ,К06142         .
          15,  АТХ  , В146          .
            ,  ARX  ,К06131         .
            ,  ASN  ,64+7           .
            ,  UZA  ,L06147         .
            ,  ХТА  ,BIT5           .
          15,  АТХ  , SМВ           .
           4,  VJM  ,L06147         .
            ,  ХТА  ,К06134         .
          15,  АТХ  , SМВ           .
           4,  VТМ  ,L06101         .
            ,  IТА  ,  5            .
            ,  ASN  ,64+7           .
            ,  UZA  ,L06147         .
            ,  IТА  ,  5            .
            ,  АЕХ  ,К06141         .
            ,  ARX  ,К06131         .
            ,  ATI  ,  5            .
            ,  ХТА  ,К06143         .
 L06100  :15,  АТХ  , SМВ           .
            ,   UJ  ,L06147         .
С......   РЕДАКТИРОВАНИЕ КОНСТАНТ
 L06033  :  ,  IТА  ,  5            .
           6,  UZA  ,               .
            ,  ARX  ,К06135         .
            ,  ASN  ,64+5           .
            ,  UZA  ,L06036         .
           5,  VТМ  , 00020В        .
 L06036  : 5,  MTJ  ,  2            .
           5,  J+М  ,  2            .
           5,  J+М  ,  2            .
           2,  UТМ  , 00020В        .
 L06040  :15,  ХТА  , В144          .
           2,  ASN  ,               .
          15,  АТХ  , В144          .
            ,  ASN  ,64+45          .
          15,  АТХ  , SМВ           .
           4,  VJM  ,L06147         .
           2,  VТМ  , 00075В        .
           5,  UТМ  , 77777В        .
           5,  V1М  ,L06040         .
           6,   UJ  ,               .
С.....   РЕДАКТИРОВАНИЕ КОМАНД
 L06045  : 2,  VТМ  , 77777В        .
           5,  VТМ  , 77777В        .
 L06046  :15,  ХТА  , В144          .
 2,AUX,К06124+1.
           2,  АОХ  ,К06127         .*****
          15,  АТХ  , В145          .
            ,  ААХ  ,К06457         .
            ,  UZA  ,L06052         .
           2,  VLM  ,L06046         .
 L06052  :15,  ХТА  , В145          .
            ,  ASN  ,64+44          .
          15,  АТХ  , SМВ           .
            ,  ААХ  ,К06127         .
            ,  U1А  ,L06166         .
           4,  VJM  ,L06147         .
          15,  ХТА  , В145          .
            ,  ASN  ,64-4           .
          15,  АТХ  , В145          .
            ,  U1А  ,L06052         .
          15,  ХТА  , В144          .
            ,  ASN  ,64-24          .
          15,  АТХ  , В144          .
           2,  VТМ  , 77777В        .
           5,  VLM  ,L06046         .
           6,   UJ  ,               .
 L06166  : 1,  UТМ  , 00001В        .
           4,   UJ  ,               .
С.....   К РЕДАКТИРОВАНИЮ ЧИСЕЛ
 L06101  :  ,  ХТА  ,               .
          15,  АТХ  , SМВ           .
           5,  UТМ  , 77766В        .
            ,  IТА  ,  5            .
            ,  ARX  ,К06131         .
            ,  ASN  ,64+5           .
            ,  UZA  ,L06144         .
           4,  VJM  ,L06147         .
           5,  UТМ  , 00012В        .
            ,  IТА  ,  5            .
 L06106:6,MTJ,4.
 ,UJ,L06100.
 L06144  :  ,  ХТА  ,К06131         .
           4,  VJM  ,L06100         .
            ,  IТА  ,  5            .
            ,   UJ  ,L06106         .
С....
 ENDSTRI:,BSS,.
С    КОНЕЦ СТРОКИ
 15,ХТА,BLS
 ZNB:15,АТХ,NEWBLS.
 ,NTR,3.
С   <<<<<   ЭКОНОМИМ БУМАГУ   >>>>>
  ,ASN,64+2. < 4
  ,UZA,СНЕКР
  ,ATX,.  ,ХТА,BIT3
  ,ATX,.  15,АТХ,NEWBLS
 СНЕКР:,BSS,.
 :15,ХТА,OLDBLS.
 ,А-Х,FPL.ПОЛНАЯ ДЛИНА ЛИСТА
 ,U1А,СНЕКР1.
 ,А-Х,FPL.
 ,U1А,СНЕКР1.
 ,А+Х,FPL.
 15,АТХ,OLDBLS.
 ,UJ,СНЕКР.
 СНЕКР1:,BSS,.
  6,VZM,INCRN.ОТ COSY-GOST
 СНЕКР2:,BSS,.
 ,ХТА,.
 15,АТХ,RR.
 15,ХТА,NSTRI.
 15,Х-А,PFLAG.
 ,U1А,INCRN.
 15,АТХ,RR.
 15,ARX,NSTRI.
 15,АТХ,NSTRI.
 INCRN:,BSS,.
 15,ХТА,NSTRI.
 15,ARX,NEWBLS.
 СНР:,BSS,.
 15,АТХ,NSTRI.
 ,А-Х,FPL.
 ,UZA,СНР.
 5,UТС,.
 6,VZM,.
  ,NTR,0
 15,ХТА,EXPPOS.
 ,U1А,WRE.
 15,ХТА,OLDBLS.
 15,ARX,NEWBLS.
 15,ARX,RR.
 15,АТХ,OLDBLS.
 15,ХТА,ТЕ.
 ,ATI,АВ.
 ,UJ,CONT.ПРОДОЛЖЕНИЕ РЕДАКТИРОВАНИЯ
С WRE
 WRE:,BSS,.
 15,ХТА,RR.
 ,ASN,64-40.
 15,WТС,ТЕ.
 ,ARX,.
 15,WТС,ТЕ.
 ,АТХ,.
 :,ХТА,CENDSTR.
 14,VТМ,BUFST
С
С  ЗАПИСЬ В МАЛЫЙ БУФЕР И СБРОС:
С
 WRTSM:2,VТМ,WRSMB1
 3,VZM,BUFSTEP
 WRSMB1:3,ASN,64+8
 9,АОХ,
 9,АТХ,
 3,UТМ,8
 14,UJ,
С
 BUFSTEP:,ITS,9
  15,АЕХ,EBUF-1
  :,UZA,*+1.ЦИКЛ НА КОНЦЕ
  9,UТМ,1
  :3,VТМ,-60В
 ,ХТА,
 9,SТХ,
 2,UJ,
С
 BUFST:,BSS,.
 9,ХТА,.
 ,ААХ,=7777 7777 7777 7400
 ,АОХ,CENDSTR.
 9,АТХ,.
 RВ,VJM,BUFSTEP.
 ,IТА,АВ.
 15,АТХ,ТЕ.
 15,ХТА,NEWBLS
 15,АТХ,OLDBLS
С--------------
 CONT:NS,VТМ,-40.
 15,ХТА,OLDBLS.
 ,ASN,64-40
 АВ,АТХ,.
 ,ХТА,.
 15,АТХ,EXPPOS.
С       ВОЗВРАТ НА СЧЕТ ИЛИ РЕДАКТИРОВАНИЕ
 6,V1М,ENDRED.
 15,АТХ,OLDBLS.
  ,UJ,RETURN
  END RED:15,ХТА,В152
  ,UZA,CONT RED
С
С
  RETURN:,BSS,
  ,ХТА,FULWOR
  АВ,АТХ,.КОНЕЦ БУФЕРА!!!
  ,ХТА,SAVAC
  ,UJ,OUTMACRO
С
С
С
С*****   ПАРАМЕТРЫ ФОРМАТА ЛИСТА
 FPL:,LOG,110.ПОЛНАЯ ДЛИНА
 DР:,LOG,6.ПРОМЕЖУТОК
С*****
 CENDSTR:,LOG,176.
 К02700  :  ,LOG, 00000000 00000016
 К05405  :  ,LOG, 00000000 00000025
 К06124:,LOG,05601567 01673560.
        ,LOG,05601560 35673560.
        ,LOG,00100000 40000010.
 К06127  :  ,LOG, 00100010 00000010
  INT0:,BSS,
 К06130  :  ,LOG, 64000000 00000000
 К06134  :  ,LOG, 00000000 00000012
 С41:,LOG,41.
 К06142  :  ,LOG, 77777777 77777776
 К06245  :  ,LOG, 00000000 00000133
 С140:,LOG,140.
 С231:,BSS,.
 К06330  :  ,LOG, 00000000 00000231
 К06360  :  ,LOG, 17555746 77547276
 К06361  :  ,LOG, 42120000 00000000
 К06362  :  ,LOG, 40500000 00000000
 ТАБЛАВТ:,BSS,.
 ,ОСТ,00075177 11236120.
 ,ОСТ,14434405 23023412.
 ,ОСТ,00075527 17622126.
 ,ОСТ,13410532 10420533.
 ,ОСТ,00000130 22034032.
 ,ОСТ,13251426 14635124.
 ,ОСТ,21216415 20032030.
 ,ОСТ,13017016 15235414.
 ,ОСТ,00054515 10014413.
 ,ОСТ,21025423 22633521.
 ,ОСТ,21616004 20624424.
 ,ОСТ,20221427 00076175.
 ,ОСТ,20424117 22236516.
 ,ОСТ,14027522 21437125.
 ,ОСТ,14233037 12410022.
 ,ОСТ,22423025 00015400.
 ,END,
*MADLEN,L=0.
 OCCUPYD:,NАМЕ,
С
С******   ПРОЦЕДУРЫ ЗАКАЗА/ОТКАЗА ДИСКО-
С         ВЫХ РЕСУРСОВ И ЕЩЕ КОЕ-ЧТО.
С
С         ОБРАЩЕНИЕ ЧЕРЕЗ ,*57,-1
С         НА СУММАТОРЕ ПРИ ВХОДЕ:
С          РАЗРЯДЫ 48-30, 24-21 СОДЕРЖАТ
С         КЛЮЧ ДОСТУПА;
С          РАЗРЯДЫ 15-1 - АДРЕС ИНФОРМАЦИОН-
С         НОГО ПОЛЯ;
С          РАЗРЯДЫ 20-16 - КОД ОПЕРАЦИИ;
С          РАЗРЯДЫ 29-25 - ДОПОЛНИТЕЛЬНАЯ
С         ИНФОРМАЦИЯ.
С
С......   КОДЫ ОПЕРАЦИЙ:
С           0В - ЗАКАЗ ПАКЕТОВ;
С           1В - ОТКАЗ ОТ ПАКЕТОВ;
С           2В - ЗАПРОС КООРДИНАТ ФАЙЛОВ;
С           3В - ЗАКАЗ ОБЫЧНЫХ ФАЙЛОВ;
С           4В - ЗАКАЗ SCRATCH ФАЙЛОВ;
С           5В - ОТКАЗ ОТ ФАЙЛОВ;
С           6В - ОТКАЗ ОТ ВСЕХ МД-РЕСУРСОВ;
С          37В - ИЗМЕНЕНИЕ СТАТУСА ФАЙЛА.
С
 TUNIT:,EQU,32.ТАБЛ.УСТРОЙСТВ
 REGSCAL:,EQU,100В
 *УСЫ:LС,BLOCK,ГУС,ДНЗ
 ,CONT,SAVAC,SAVSR,SAVAR
 ,CONT,SAVI15,SAVI14,SAVI13(13)
С
  SWEXT:,SUBP,
С LTF1 :,WEQ,SWEXT+1
  LTF1:,EQU,32
  LTF  :,EQU,LTF1-1
  FАТА :,LС,1
  DNAM:,LС,16
 С76000:,EQU,=76000
 С5:,EQU,=5
 SAVEMOD:,SUBP,
 OUTMACRO:,SUBP,
 BITS:,SUBP,
 BITS:I,BLOCK,(1)
 ,CONT,BIT48,BIT47,BIT46,BIT45
 ,CONT,BIT44,BIT43,BIT42,BIT41
 ,CONT,BIT40,BIT39,BIT38,BIT37
 ,CONT,BIT36,BIT35,BIT34,BIT33
 ,CONT,BIT32,BIT31,BIT30,BIT29
 ,CONT,BIT28,BIT27,BIT26,BIT25
 ,CONT,BIT24,BIT23,BIT22,BIT21
 ,CONT,BIT20,BIT19,BIT18,BIT17
 ,CONT,BIT16,BIT15,BIT14,BIT13
 ,CONT,BIT12,BIT11,BIT10,BIT 9
 ,CONT,BIT 8,BIT 7,BIT 6,BIT 5
 ,CONT,BIT 4,BIT 3,BIT 2,BIT 1
 ,CONT,FULWOR,В24/1
 ,CONT,С77777,С7777,С777,С377,С77,С37,С17,С7,С3
С---------------------
 BGEN:,EQU,BIT42
 BIT30:I,BLOCK,BITW2W(0),BWGEN
 BWMAS:,EQU,BIT8
 WORK:I,BLOCK,REZACC
 ,CONT,MASTER,FILE,INF
 ,CONT,SТЕС
С         ОБОЗНАЧЕНИЕ ИНДЕКС РЕГИСТРОВ
 *1:,BLOCK,TR,МР,АР,NМ
 *5:,BLOCK,К,L,М,N
 *9:,BLOCK,(1),Т,Р,D
 *13:,BLOCK,J,R,S
С-----------------------
 :,АТХ,REZACC.СУММАТ.ВЫХОДА=0
 15,VТМ,SТЕС+1
С         РАСПОКОВКА СУММАТОРА BXODA
 ,ХТА,SAVAC
 ,АТХ,SТЕС
 ,ATI,Р.АДР.ИНФ.ПОЛЯ
 ,ASN,64+15
 ,ААХ,С37
 ,ATI,Т.ТИП ЗАДАНИЯ
  ,XTS,SТЕС.ДОП.ИНФ.
  ,ASN,64+14.В ВИДЕ
  ,ААХ,С76000.АДРЕСА
  ,ATI,АР.РАБ.ЛИСТА
  ,SТХ,INF.ДЛЯ KOORD
С         НЕ ОПЕРАЦИЯ ЛИ ЭТО С ПАКЕТАМИ
 ,А-Х,BIT2
 ,UZA,NOTDJ.НЕТ
С         ОПЕРАЦИЯ С ПАКЕТАМИ
 14,VJM,NEXTWORD.ПРОПУСК ШК.МОНО
 М,VТМ,
 ,ХТА,SТЕС.ОПРЕДЕЛЕНИЕ
 ,ASN,64-20.ЧИСЛА ПАКЕТОВ
 ,ASN,64+44.В ЗАКАЗЕ В ВИДЕ
 ,Х-А,.СЧЕТЧИКА
 ,ATI,N.ДЛЯ VLM
 MLDJ:,BSS,
С   ---   ОСНОВНОЙ ЦИКЛ ПО ИМЕНАМ ПАКЕТОВ
 М,UТМ,3
 13,VJM,NNOFD.ЗА N ПАКЕТА
 ,UZA,EMLDJ
 М,ХТА,BITS.ОТВЕТ:
 ,АОХ,REZACC."ПАКЕТА НЕТ"
 ,АТХ,REZACC
 EMLDJ:,BSS,
С   ---   КОНЕЦ ЦИКЛА ПО ПАКЕТАМ
 N,VLM,MLDJ
 ,UJ,RETURN
 NOTDJ:,BSS,
С......   ОПЕРАЦИЯ НЕ С ПАКЕТАМИ
 N,VТМ,.СЧЕТЧИК НЕУДАЧ
 ,NTR,7
 ,UZA,KOORD.НУЖНА СПРАВКА
 ,А-Х,BIT2
 ,U1А,*NР.ЗАК.ОБЫЧ.ФАЙЛОВ
 ,АЕХ,
 ,U1А,NOTRSCR.КАКАЯ-ТО V-ОП.
С......   ЗАКАЗ SCRATCH ФАЙЛОВ
 АР,VТМ,*QSCF
 *QSCF:,BSS,.ОСНОВНОЙ ЦИКЛ
 14,VJM,NEXTWORD
 ,UZA,SFEND.КОНЕЦ ПОЛЯ
 L,VJM,IFFMN.НЕ ЕСТЬ ЛИ МАТ.N
  ,UZA,FREFU.ЗАНЯТ
С         МАТ. НОМЕР СВОБОДЕН
 ,ХТА,SТЕС
 ,АОХ,В48/43.ДНЗ ПОКА
 ,АТХ,SТЕС.ДЕЛАЕТСЯ 77В
 К,VТМ,-1.ПР. НЕТ МЕСТА
 ,UJ,SETFATA
 SFEND:,BSS,
С         КОНЕЦ ЗАКАЗА SCRATCH ФАЙЛОВ
 N,V1М,FEND.БЫЛИ ОШИБКИ
 SFEEND:,BSS,
 N,VТМ,-1.ОТКАЗ ПО НЕХВАТ-
 ,UJ,FEND.КЕ ЭКСТЕНТОВ
С   ---   ОСНОВНОЙ БЛОК РАЗБОРА
 *NР:,BSS,
С   ...   ВЫБОРКА ИМЕНИ ДИСКА
 13,VJM,NNOFD
 ,АСХ,.М=0, ЕСЛИ
 ,ATI,М.ПАКЕТ ДОСТУПЕН
 *REFF:,BSS,
С   ...   ВЫБОРКА ССЫЛКИ ФАЙЛА
 14,VJM,NEXTWORD
 АР,VТМ,*REFF
 ,UZA,FEND.КОНЕЦ ИНФ.ПОЛЯ
 ,ARX,
 ,UZA,*NР.KON.ГРУППЫ ПАКЕТ
 М,V1М,FREFU.ПАКЕТА ТО НЕТ
 ,ААХ,=77 0040 7777 7777
 L,VJM,IFFMN.
 К,VТМ,-1.ПР.ЗАНЯТ МАТ.N
 ,UZA,FKREF.МАТ.N ЗАНЯТ
С         МАТ. НОМЕР СВОБОДЕН
 К,UТМ,-1.
  13,VТМ,TOSET
 ,IТА,NМ
 ,ASN,64-30
 14,VJM,ORMAT
  FATASEAR:,BSS,
 ,IТА,NМ.УСТАНОВКА НОМЕРА
 ,ASN,64-30.МОДУЛЯ И ПРИЗ-
 ,АОХ,SТЕС .НАКА НЕОКОНЧЕН-
 ,АОХ,В48/43.НОГО ЗАКАЗА=
 ,АТХ,SТЕС.(ДНЗ=77В)
С         НЕ ЗАНЯТ ЛИ ЭТОТ ФАЙЛ
 ,ААХ,BIT30.БИТ ЗАПИСИ
 ,АЕХ,=7740 7777 7777
 ,XTS,SТЕС
 ,АЕХ,BIT30
  ,UJ,SFAMA
  ТО SЕТ:,UZA,FKREF.ЗАНЯТ
 К,UТМ,-1.ПР. НЕТ МЕСТА
 SETFATA:,BSS,
С......    П/П ПОИСКА СВОБОДНОГО МЕСТА В
С         FАТА И РАЗМЕЩЕНИЕ ТУДА КОДА ИЗ
С         SТЕС. ВОЗВРАТ ПО АР.
 ,ХТА,FULWOR.МАСКА
 ,XTS,.ОБРАЗ
 13,VJM,SFAMA
 ,U1А,FKREF.НЕТ МЕСТА
 ,ХТА,SТЕС.ЗА ДНЗ ПОКА 1
 WRF:14,АТХ,FАТА+LTF
  АР,UJ,
 FKREF:,BSS,
С......   П/П ФИКСАЦИИ НЕУДАЧ.ВОЗВРАТ АР.
 К,UТС,
 FREFU:,ХТА,BIT43.
 N,UТМ,1.СЧЕТ НЕУДАЧ
 АР,MTJ,14
 ,UJ,ORMAT
 FEND:,BSS,
С   ---   КОНЕЦ РАБОТЫ С ФАЙЛАМИ
С         БЫЛИ ЗАКАЗЫ ФАЙЛОВ
 CORFA:,BSS,
С         ЦИКЛ ИСПРАВЛЕНИЯ НЕОКОНЧ.СЛОВ FАТА
 ,ХТА,В48/43.
 ,XTS,В48/43
 13,VJM,SFAMA.ПОИСК НЕОКОНЧ.
 ,U1А,RETJF.ИХ БОЛЬШЕ НЕТ
 N,V1М,CRWF.БЫЛИ НЕУДАЧИ
 14,UТМ,LTF1
  ,IТА,14.ИНДЕКС ПО FАТА-
  14,UТМ,-LTF1.-В ТАБЛ.УСТР.
  13,VJM,WRTUNIT
 ,ХТА,ДНЗ.ПРИ ОТСУТСТВИИ
 ,ASN,64+6.НЕУДАЧ НА МЕСТО
 ,УТА,.ДНЗ ПОМЕЩАЕТСЯ
 ,АЕХ,В48/43.ДНЗ ЗАКАЗЧИКА
 14,АЕХ,FАТА+LTF.ВМЕСТО 1
 CRWF:14,АТХ,FАТА+LTF
 ,UJ,CORFA
 RETJF:,IТА,N.СУММАТ.ВЫХОДА =
 ,АТХ,REZACC.ЧИСЛО НЕУДАЧ
 ,UJ,RETURN
 NOTRSCR:,BSS,
С......   НЕ ОТКАЗ ЛИ ЭТО ОТ ФАЙЛОВ:
 ,А-Х,BIT2
 ,UZA,GLORST.НЕЧТО ДРУГОЕ
С......   ОТКАЗ ОТ ФАЙЛОВ
 *FREFIL:,BSS,
 АР,VТМ,*FREFIL
 14,VJM,NEXTWORD
 ,UZA,RETJF.КОНЕЦ ПОЛЯ
 ,XTS,Д Н З
 ,ASN,64+6
 ,УТА,
 15,АОХ,
 ,АТХ,FILE
 ,ХТА,В48/37
 ,XTS,FILE
 13,VJM,SFAMA
 ,U1А,FREFU.ТАКОГО НЕТ
  АР,VТМ,*FREFIL
 KILLFILE:,BSS,
С......   П/П УНИЧТОЖЕНИЯ ФАЙЛА
С         И14=N СЛОВА FАТА-ДЛИНА FАТА,
С         СООТВЕТСТВУЮЩЕЕ НУЖНОМУ ФАЙЛУ
С         ВОЗВРАТ ПО АР.
 ,ХТА,.УНИЧТОЖЕНИЕ
 13,VТМ,KILL1
  WRTUNIT:14,XTS,FАТА+LTF
  ,ASN,64+36
  ,ААХ,С77
  ,STI,МР
  ,WТС,ГУС
  МР,АТХ,TUNIT-30В
  13,UJ,
 KILL1:14,АТХ,FАТА+LTF.ССЫЛКИ
 АР,UJ,
С----------
 KOORD:,BSS,
С......   ПОЛУЧЕНИЕ КООРДИНАТ ФАЙЛА И ПРО-
С         ВЕРКА РЕЖИМА ДОСТУПА. (СЧЕТЧИК
С         НЕУДАЧ N ВЕДЕТСЯ В ОБРАТНОМ КОДЕ)
 13,VJM,NNOFD
 ,U1А,ENKOOR.ДИСКА НЕТ
 N,VТМ,-1.НАЧ.СОСТ.СЧ.
С   ---   ОСНОВНОЙ БЛОК РАЗБОРА
 /GМ:,BSS,
С   ...   ВЫБОРКА ИМЕНИ МАСТЕРА
 14,VJM,NEXTWORD
 ,ARX,
 ,UZA,ENKOOR.КОНЕЦ.ИНФ.ПОЛЯ
 ,АТХ,MASTER.ИМЯ МАСТЕРА
 ,UJ,/GF.ЗА ФАЙЛАМИ
 EMLCP:,BSS,.
С         КОНЕЦ ПРОХОДА КАТАЛОГА
 МР,VLM,NEWPCAT
С         ФАЙЛ НЕ НАЙДЕН
 WRBAD:,BSS,
С         СООБЩЕНИЕ ОБ ОТКАЗЕ В КООРДИНАТАХ
 TR,ХТА,BIT48.ТИП ОТКАЗА
 N,UТМ,-1.СЧЕТ ОТКАЗОВ
С         ЗАПИСЬ РЕЗУЛЬТАТА
 WRINF:14,VJM,ORMAT
 /GF:,BSS,
С   ...   ВЫБОРКА ОПИСАНИЯ ФАЙЛА
 14,VJM,NEXTWORD
 ,ARX,
 ,UZA,/GМ.КОНЕЦ ГР.МАСТЕРА
 ,АТХ,FILE.ИМЯ ФАЙЛА
 TR,VТМ,.ПР.'ПЛОХ.ОПИС.'
 14,VJM,NEXTWORD.2 СЛОВО ОПИС.
  ,АТХ,SТЕС
  К,VТМ,С5.'БЕЗ ЗАПИСИ'
  ,UZA,*70
  ,ААХ,BITW2W
  :,UZA,*+1
  К,VТМ,0.'ЗАПИСЬ'
  *70:,BSS,
 TR,VТМ,1.ПР.'НЕТ ФАЙЛА'
 МР,VТМ,-1.СЧЕТЧИК ПРОХОДОВ
 NEWPCAT:,BSS,
 L,VТМ,4-1024
 14,VJM,GI1Z
 MLCP:,BSS,
С         ЦИКЛ ПРОХОДОВ ПО КАТАЛОГУ
 13,VJM,GIWOCA
 ,UZA,EMLCP.КОНЕЦ КАТАЛОГА
 15,АТХ,.ИМЯ ФАЙЛА
 13,VJM,GIWOCA.
 ,АТХ,SТЕС.ХАРАКТЕРИСТИКА
 ,ASN,64+42
 ,STI,М.ЧИСЛО 'USER'ОВ
 ,АЕХ,FILE.ТОТ ЛИ ФАЙЛ
 ,U1А,НЕ ТОТ
  TR,VТМ,2.ПР.'НЕТ ДОСТУПА'
 МР,V1М,USERS.ПОИСК ПО 'USER'У
С         ПРОВЕРЯЕМ ОБЩИЙ ДОСТУП
 ,ХТА,SТЕС
 ,ААХ,BGEN
 ,UZA,НЕ ТОТ.ОБЩ.ДОСТУПА НЕТ
 ,ХТА,SТЕС.ВЫДЕЛЕНИЕ ПРИЗН.
 ,ААХ,BWGEN.РАЗРЕШЕНИЯ ЗАП.
 REGIM:,BSS,
С         ПРОВЕРКА ДОСТУПА ПО ЗАПИСИ
  К,АОХ,.НЕ 0 - НЕ НУЖЕН
 ,U1А,WRGOOD.ОН ЕСТЬ
 НЕ ТОТ:,BSS,
С         ПЕРЕХОД К СЛЕДУЮЩЕМУ ФАЙЛУ
 М,VZM,MLCP
 13,VJM,GIWOCA.ПРОПУСК 'USER'А
 М,UТМ,-1
 ,UJ,НЕ ТОТ
 USERS:,BSS,
С         ПРОВЕРЯЕМ ИМЯ 'USER'А
 М,VZM,MLCP.НЕТ НАШЕГО
 13,VJM,GIWOCA
 М,UТМ,-1
 ,АТХ,REZACC.ИМЯ
 ,АЕХ,MASTER
 ,ААХ,D8/7F
 ,U1А,USERS.ИМЯ НЕ ТО
 ,ХТА,REZACC.ВЫДЕЛ.ПРИЗН.
 ,ААХ,BWMAS.РАЗРЕШЕНА ЗАПИСЬ
 ,UJ,REGIM
 WRGOOD:,BSS,
С         ПОЛУЧЕНИЕ КООРДИНАТ ФАЙЛА
 ,IТА,NМ
 ,ААХ,BIT6.30:37 - 29 МБ
 ,ASN,64+4.40:47 - 7 МБ
 ,ATI,13.0 ИЛИ 2
 ,ХТА,SТЕС
 ,ASN,64+4
 ,ААХ,В24/1
 ,ARX,BIT3
 13,ASN,64
 ,А-Х,BIT1
 ,АТХ,FILE
  ,АОХ,BIT30
  ,АТХ,SТЕС
  13,VJM,FATASEAR
  ,U1А,FR/FILE
  14,ХТА,FАТА+LTF
  ,ААХ,В48/37
  ,ASN,64+6
  ,АОХ,FILE
  ,UJ,WRINF
  FR/FILE:,ХТА,FILE
 ,UJ,WRINF
 ENKOOR:,BSS,
С   ---   КОНЕЦ ПОЛУЧЕНИЯ КООРДИНАТ
 ,IТА,N.В СУМ.РЕЗУЛЬТАТА
 ,АЕХ,С77777.ЧИСЛО НЕУДАЧ
 ,АТХ,REZACC.В.ПРЯМОМ КОДЕ
 ,UJ,RETURN
 GLORST:,BSS,
С......   ГЛОБАЛЬНЫЙ ОТКАЗ ИЛИ СМЕНА СТАТ.
 ,Х-А,С30
 АР,VТМ,*+1
 :,U1А,RETURN
С......   ОТКАЗ ВСЕХ ДИСКОВЫХ РЕСУРСОВ
 ,ХТА,В48/43.
 ,XTS,ГУС.ПРОЧИСТКА
 АР,MTJ,13.СЛОВ FАТА
  ,UJ,SFAMA.СО СВОИМ ДНЗ
С
С
 RETURN:,BSS,
С......   ОКОГЧАНИЕ ЭКСТРАКОДА.
 ,ХТА,REZACC
  ,UJ,OUTMACRO
С
С
 IFFMN:,BSS,
С......   П/П ОПРЕДЕЛЕНИЯ ЗАНЯТ ЛИ
С         МАТ.НОМЕР. НА ВХОДЕ: АСС=
С         МАТ.N, В РАЗРЯТАХ 42-37. НА
С         ВЫХОДЕ АСС=0.EQ.ЗАНЯТ. АСС ВХОДА
С         С ДНЗ В 48-43Р В SТЕС. ВОЗВРАТ=L
 ,XTS,ГУС
 ,ААХ,В48/43
 15,АОХ,
 ,АТХ,SТЕС
 ,ХТА,В48/37
 ,XTS,SТЕС.С ТЕМ ЖЕ
 13,VJM,SFAMA.МАТ.НОМЕРОМ
 L,UZA,.ЕСТЬ ТАКОЙ
 ,ХТА,В48/37.ПОИСК ФАЙЛА
 ,XTS,SТЕС.С ТЕМ ЖЕ МАТ.N
 ,АОХ,В48/43.ИЗ ЧИСЛА НОВЫХ
 L,MTJ,13
 SFAMA:,BSS,
С......   П/П ПОИСКА В FАТА ОБРАЗА(АСС)
С         ПО МАСКЕ(ВЕРХУШКА СТЕКА).
 14,VТМ,-LTF
  ,WТС,ГУС.БЛОКИРОВКА
  ,XTS,REGSCAL.ПРОВЕРКИ
  ,ААХ,BIT30.ЗАНЯТОСТИ
  ,UZA,LSFM. - НЕТ
  15,ХТА,-1
  ,UZA,LSFM
  15,ХТА,-2
  ,ААХ,В24/1
  ,U1А,RSFM. - ДА
 LSFM:14,ХТА,FАТА+LTF
 15,АЕХ,-1
 15,ААХ,-2
 ,UZA,RSFM
 14,VLM,LSFM
 RSFM:15,UТМ,-2
 13,UJ,
 GI1Z:,BSS,
С......   П/П ЧТЕНИЯ 1-ОЙ ЗОНЫ КАТАЛОГА
 ,IТА,АР.АДРЕС ЛИСТА
 ,ASN,64-8
 ,ITS,NМ.НОМЕР МОДУЛЯ
 15,АОХ,
 ,ASN,64-12.ФОРМИРОВКА
 ,АОХ,CINF.ИНФ.СЛОВА
 ,АЕХ,INF.СТАРОЕ ИНФ.СЛОВО
 14,UZA,.ЗОНА В ПАМЯТИ
 ,АЕХ,INF
 ,UJ,TRAN.НА ОБМЕН
 GI2Z:,BSS,
С......   П/П ЧТЕНИЯ 2-ОЙ ЗОНЫ КАТАЛОГА
 ,ХТА,INF
 ,ARX,BIT1
 TRAN:,BSS,
 ,АТХ,INF.ТЕКУЩЩЩЕЕ ИНФ.
 ,IТА,14.СПАСЕНИЕ
 ,XTS,INF.ВОЗВРАТА
 ,*70,INF
 15,WТС,
 ,UJ,
 ORMAT:,BSS,
С......   П/П НАЛОЖЕНИЯ НА ИНФ.ПОЛЕ
 Р,АОХ,-1
 Р,АТХ,-1
 14,UJ,
 NEXTWORD:,BSS,
С......   П/П ЧТЕНИЯ СЛОВА ИНФ. ПОЛЯ
 Р,ХТА,
 Р,UТМ,1
 14,UJ,
 GIWOCA:,BSS,
С......   П/П ЧТЕНИЯ СЛОВА КАТАЛОГА
 L,V1М,RGWC.НЕ НОВЫЙ ЛИСТ
 14,VJM,GI2Z
 L,VТМ,-1024
 RGWC:,BSS,
 L,UТС,1024
 АР,ХТА,
 L,UТМ,1
 13,UJ,
 NNOFD:,BSS,
С......   П/П ПОИСКА МОДУЛЯ, НА КОТОРОМ
С         СТОИТ ДИСК С ОЧЕРЕДНЫМ ИМЕНЕМ
С         АСС.NЕ.0=НЕТ ДОСТУПА
 14,VJM,NEXTWORD.ИМЯ ДИСКА
 15,АТХ,
 NМ,VТМ,1-16
 LSM:NМ,ХТА,DNAM+15
 15,АЕХ,-1
 ,U1А,ELSM
 NМ,UТМ,15+30В
 RЕТ1:15,UТМ,-1
 13,UJ,
 ELSM:NМ,VLM,LSM
  ,UJ,RЕТ1
 CINF:1,014,2
 ,,7774В
 D8/7F:,GOST,3Н'177''177''177'
       ,CONT,3Н'177''177''177'
 В28/27:,ОСТ,0000 0014
 С30:,LOG,30
 В48/37:,ОСТ,7777
 В48/43:,ОСТ,77
 WORK:,BSS,10
 ,END,
  MACRONEW:,NАМЕ,
  SAVEMOD:,SUBP,
  OUTMACRO:,SUBP,
  ERREXTR:,SUBP,
  OCCUPYD:,SUBP,
  *УСЫ:LС,BLOCK,ГУС,ДНЗ,SAVAC,SAVSR,SAVAR
  ,CONT,SAVI15,SAVI14,SAVI13(13)
  LISMOD:,SUBP,
  SWEXT:,SUBP,
С LTF1:,WEQ,SWEXT+1
  LTF1:,EQU,32
  LTF:,EQU,LTF1-1
  FАТА:,LС,1
  TUNIT:,EQU,32.ТАБЛ.УСТРОЙСТВ
  BITS:,SUBP,
  BITS:I,BLOCK,(1)
  ,CONT,В48,В47,В46,В45,В44,В43,В42,В41
  ,CONT,В40,В39,В38,В37,В36,В35,В34,В33
  ,CONT,В32,В31,В30,В29,В28,В27,В26,В25
  ,CONT,В24,В23,В22,В21,В20,В19,В18,В17
  ,CONT,В16,В15,В14,В13,В12,В11,В10,В9
  ,CONT,В8,В7,В6,В5,В4,В3,В2,В1
  ,CONT,FULWOR,В24/1
  ,CONT,С77777,С7777,С777,С377,С77,С37,С17,С7,С3
С-------
  ,АТХ,SAVAC.СУММАТОР
  :,ХТА,*+1
  ,UJ,SAVEMOD
  :,Z00,
  ,Z00,*+1
  :14,UТМ,1
  14,VZM,OCCUPYD
  ,ХТА,SAVI14
  ,ASN,64+3
  14,UZA,SW57-2. 1-7
  14,UТМ,-14В
  ,ХТА,SAVAC
  14,VZM,WAIT.,*57,13В
  14,UТМ,13В-7777В
  14,VZM,ERREXTR.МЛ ЕС
С
С------  ОПРОС/ЗАКАЗ/ОТКАЗ "МАГНИТНЫХ ЛЕНТ"
С
  ,WТС,ГУС
  15,VТМ,
  ,ХТА,SAVI14
  ,ААХ,В12
  1,VТМ,LISMOD
  ,U1А,REFUSE
С
С---   ПОЛУЧЕНИЕ ВНУТРЕННЕГО НОМЕРА "ЛЕНТЫ"
С
  SLM:1,ХТА,
  1,UТМ,1
  ,UZA,OUTMACRO.НЕТ МЛ
  ,АЕХ,SAVAC
  ,U1А,SLM
  1,UТМ,7-LISMOD.НОМ.МОДЕЛИ=10,11,...,27
С
С---   ПОИСК "ЛЕНТЫ" В ТАБЛИЦЕ ФАЙЛОВ
С
  ,IТА,1
  ,ASN,64-24
  15,АТХ,1
  2,VТМ,-LTF
  SFT:2,ХТА,FАТА+LTF
  15,АЕХ,1
  ,ААХ,=37 0000 0000
  ,UZA,ISTAP
  2,VLM,SFT
  ,ХТА,
  ,UJ,OUTMACRO.НЕ НАШЛИ
С
С----  ПРОБА: НУЖЕН ЛИ ЗАХВАТ
С
  ISTAP:2,UТМ,LTF1.ИНДЕКС ПО FАТА
  ,ХТА,SAVI14
  ,ААХ,В11
  ,UZA,EXIT
  ,IТА,13.МАТ.НОМЕР
  ,ААХ,С77
  ,ARX,ГУС
  ,ATI,3
  3,ХТА,TUNIT-30В
  ,U1А,ERREXTR.ЗАНЯТ МАТ.НОМЕР
  ,ХТА,SAVAC
  ,ASN,64-36.N ТОМА
  ,ITS,2.ИНДЕКС
  15,АОХ,.DELTA=0
  3,АТХ,TUNIT-30В
  EXIT:,IТА,1
  ,UJ,OUTMACRO
С
С      4000-ОТКАЗ,  4040-ЗАПРОС ШКАЛЫ
С
  REFUSE:1,VТМ,-31
  ,WТС,ГУС
  3,VТМ,TUNIT
  ,ХТА,
  REF:3,XTS,
  ,UZA,EREF
  ,ATI,2.ИНДЕКС ПО FАТА
  ,ХТА,SAVI14
  ,ААХ,В6
 :,U1А,*+1.ЗАПРОС ШКАЛЫ
  ,ХТА,SAVAC
 :1,ААХ,В48+31
  1,АЕХ,В48+31
  ,U1А,EREF
  2,ХТА,FАТА-1
  ,ASN,64+42
  ,АЕХ,ДНЗ
  :,U1А,*+1
  2,АТХ,FАТА-1
  :,ХТА,
  3,АТХ,
  EREF:15,АОХ,
  3,UТМ,1
  1,VLM,REF
  ,UJ,OUTMACRO
С-------------------
  SW57:,UJ,ERREXTR.1-CDC
  :,UJ,ERREXTR.2-CALCOMP
  :,ХТА,=R1.0
  ,UJ,WAIT
  :,UJ,ERREXTR.4-МЛ ЕС
  :,ХТА,SAVAC.5-ЗАКАЗ
  ,UJ,OUTMACRO.ЭМУЛЯЦИИ
  :,ХТА,.6-ВРЕМЯ СЧЕТА
  ,UJ,OUTMACRO
  :,UJ,ERREXTR.7-РАБОТА С ОВ
  WAIT:,А-Х,=R0.064
  14,VТМ,1
  :,ATI,
  14,VLM,*
  ,UZA,WAIT
  ,UJ,OUTMACRO
С-------------
  ,END,
  КТ:,NАМЕ,
С*
С**   *MAIN КТ
С*    *EXECUTE
С*       ЧИТАЕТСЯ МБ 20, ПРАВИТСЯ
С*       И ВСЕ ЗАПИСЫВАЕТСЯ НА МЛ 67
С*       В ЗОНЫ:  000-015
С*
  :1,VТМ,-13В
  ,UJ,BEGIN
  :,BSS,4777В
  :,BSS,10В
С-------------------------------------------
С           МОНИТОР ТЕСТОВ.
С   ПО ОКОНЧАНИИ КАЖДОГО ТЕСТА ДЕЛАЕТСЯ
С   ЧТЕНИЕ 15 ТРАКТА МБ 10 В 3 ЛИСТ ОЗУ
С   ЗАТЕМ ПРОИЗВОДИТСЯ П/У НА 6010, ПРИЧЕМ
С   НА И1 ВЫСТАВЛЯЕТСЯ НОМЕР ЗАКОНЧИВШЕГОСЯ
С   ТЕСТА:  1-МОЗУ, 2-АУ/УУ, 3-УУ, 4-ПРЕР.
С          11-ШТИЛЬМАН
С-------------------------------------------
 MONITOR:2,VТМ,-30
  :,ХТА,5
  1,ASN,64
  ,ААХ,=1
  ,U1А,NЕХТ
  1,UТМ,-14
 :1,VZM,*+1.НАЧНЕМ С МОЗУ
  1,UТМ,15
 :2,VLM,MONITOR+1
  1,VТМ,-7
  :1,ХТА,QUEST+7
   1,MOD,7
  1,VLM,*-1
  ,UJ,MONITOR
С
С    В БРЗ :  "КАКОЙ ТЕСТ?"
С
  QUEST:,LOG,4524 4621 1071 4204
  ,LOG,4524 5121 1042 0200
  ,LOG,4564 5131 1042 0204
  ,LOG,5125 1125 1042 0202
  ,LOG,6126 1123 1072 0201
  ,LOG,5125 1121 1042 0211
  ,LOG,4524 5121 1042 0211
  ,LOG,4464 4625 7671 5746
С
С       ЧТЕНИЕ ТЕСТА В ЗАДАННЫЙ ЛИСТ
С       ЕСЛИ ЛИСТ = 37, ПЕРЕПИСЬ В 0-Й
С
  NЕХТ:1,ХТА,TABTES
  ,ATI,2
  1,MTJ,9
  9,UТМ,-3
  9,VIM,ЕХСН
С        ТЕСТ ПРЕРЫВАНИЙ ЗАНИМАЕТ 3 ЗОНЫ !
  ,ХТА,=0141 0020 0142 0024
  7,VТМ,-1
  МЕХСН:,ЕХТ,1.***
  14,VТМ,70000В
  :,ASN,64+24
  ,ASN,64-24
  14,VLM,*-1
  ,ASN,64+24
  7,VLM,МЕХСН
  1,ХТА,TABTES
  ЕХСН:,ASN,64+24
  ,ЕХТ,1.***
  ,ATI,
  ,ASN,64+12
  ,ATI,14
  3,VТМ,70000В
  :,ASN,
  ,АТХ,1
  3,VLM,*-1
  14,UТМ,-177В
  14,VIM,READY
  14,VТМ,1023
  :14,ХТА,-1024
  14,АТХ,
  14,UТМ,-1
  14,VIM,*-1
С
С        ЗАБОЙ ПРОВЕРКИ КС:
С
  READY:1,ХТА,TABKS
  ,ATI,14
  14,АТХ,
  1,ХТА,TABKS2
  ,ATI,14
  14,АТХ,
  14,VТМ,-20
  9,UТМ,3-10
  9,VIM,PUSH
С      ПРАВКА ТЕСТА ШТИЛЬМАНА:
  15,VТМ,10512В
  15,ХТА,
  9,VТМ,-9
  :,XTS,RSTIL
  ,XTS,KYCMON
  9,VLM,*-1
  ,XTS,RSTIL+1
  ,XTS,RSTIL+2
  ,XTS,RSTIL+3
  ,XTS,RSTIL+4
  15,АТХ,
  PUSH:,АТХ,1
  14,VLM,*
  2,UJ,
С
С       ТАБЛИЦА ТЕСТОВ:
С       48:25 - КУС ЧТЕНИЯ
С       15:1  - АДРЕС НАЧАЛА
С       ---------------------
 TABTES:,LOG,0177 0000 0000 0155.МОЗУ
 :,LOG,0177 0004 0000 0010.АУ/УУ
 :,LOG,0177 0010 0000 0010.УУ
 :,LOG,0177 0014 0000 2762.ПРЕР
 :,LOG,0041 4013 0000 3221. 5
 :,LOG,0140 0020 0000 1565. 6
 :,LOG,0141 0034 0000 3152. 7
 :,LOG,0041 0032 0000 2210. 8
 :,LOG,0041 0033 0000 2160. 9
 :,LOG,0040 4037 0000 1172. 10
 :,LOG,0144 0044 0001 0464.ШТИЛЬМАН
 :,LOG,0140 0044 0000 1010. 12
 :,LOG,0141 0050 0000 2410. 13
 :,LOG,0141 0174 0000 2130. 14
 :,LOG,0140 0170 0000 1100. 15
С
С      ТАБЛИЦЫ ЗАБИВКИ ПРОВЕРОК КС В ТЕСТАХ
С        48-25 : КУДА ПЕРЕДАТЬ УПРАВЛЕНИЕ
С        24-1  : АДРЕС ЗАБИВАЕМОЙ КОМАНДЫ
С
 TABKS:,UJ,155В
  ,Z00,317В.МОЗУ
  :,UJ,17В
  ,Z00,15В.АУ/УУ
  :,UJ,1330В
  ,Z00,16В.УУ
  :,UJ,1534В
  ,Z00,17В.ПРЕР
  :,BSS,6
  :,UJ,10460В
  ,Z00,10470В.ШТИЛЬМАН
  :,UJ,2311В
  ,Z00,1645В. 12
  :,BSS,10
 TABKS2:,BSS,3
  :,UJ,27В
  ,Z00,1606В.ПРЕР
  :,BSS,30
С
С         АДРЕСА ВОЗВРАТОВ ИЗ ТЕСТОВ :
С
  ТАВЕХ:1,VТМ,1
  2,VТМ,160В.МОЗУ
  :1,VТМ,2
  2,VТМ,1372В.АУ/УУ
  :1,VТМ,3
  2,VТМ,1336В.УУ
  1,VТМ,4
  2,VТМ,1451В.ПРЕР
  :,BSS,30
С
С         КОПИРОВАНИЕ МБ 20 НА 67000
С
  IR:,014,100В
  ,020,
  IW:,000,100В
  ,067,
  IWOWN:,000,300В
  ,067,15В
С
  BEGIN:,ХТА,=3053 4576 1634 0112
  ,*76,1
  ,*63,512В
  ,ATI,5.CHEKMDFL
  ,ХТА,=7777 7777 7777 7777
  5,*52,
С
  READ:4,VТМ,RETES
  ,*70,IR
С     ЗАМЕНА ,ЕХТ,2 НА ,ЕХТ,1
  2,VТМ,1024
  ,ХТА,IR
  ,ААХ,=37
  ,ATI,3
  SEAR:2,UТМ,-1
  2,ХТА,2000В
  ,АЕХ,=33 0002
  14,VТМ,=3
  ,ААХ,=7777 7777
  ,UZA,CHAN
  14,VТМ,=3 0000 0000
  2,ХТА,2000В
  ,ASN,64+24
  ,АЕХ,=33 0002
  ,U1А,ESEAR
  CHAN:2,ХТА,2000В
  14,АЕХ,
  2,СТХ,2000В
  ,CALL,ОКНО
  ESEAR:2,VIM,SEAR
С      У ТЕСТА МОЗУ ЗАМЕНИМ ВХОД И ВЫХОД
  3,VIM,SETMON
  ,ХТА,TABKS
  ,СТХ,2010В
  ,ХТА,
  ,СТХ,2157В
 SETMON:3,ХТА,ТАВЕХ
  ,UZA,WRIT
  ,ATI,6
  6,СТХ,2000В
  TRAN:4,ХТА,
  ,UZA,WRIT
  4,UТМ,1
  6,СТХ,2001В
  6,UТМ,1
  ,UJ,TRAN
  WRIT:,ХТА,IR
  ,ARX,=1
  ,АТХ,IR
  ,*70,IW
  ,ХТА,IW
  ,ARX,=1
  ,АТХ,IW
  1,VLM,READ
  ,ХТА,
  5,*52,
  ,*70,IWOWN. СЕБЯ !
  ,SJ,
С
С      ВЫХОД ИЗ ТЕСТА ШТИЛЬМАНА :
С
  RSTIL:2,VТМ,6010В
  7,UJ,3432В
  :,ЕХТ,1
  14,VТМ,60000В
  :1,VТМ,11
  7,UJ,3442В
  :,ASN,
  7,UТС,
  :14,VLM,3442В
  2,UJ,
С
С      ОБЫЧНЫЙ  БЛОК ВЫХОДА ИЗ ТЕСТА :
С
  EXIT:2,REL,EXIT
  1,VТМ,1
  2,VТМ,160В
  RETES:,ХТА,KYCMON
  ,ЕХТ,1.***
  3,VТМ,70000В
  WAIT:,ASN,
  ,АТХ,1
  3,VLM,WAIT
  ,UJ,6010В
  KYCMON:,LOG,0143 0064.ТРАКТ=15
  ,LOG,
 ,END,
  JFOCC : ,NАМЕ,
С*
С********** 02.07.81  А.П.САПОЖНИКОВ
С*
С*     FUNCTION  JFOCC (STR,FDB)
С*   ЗАХВАТ ТОМА МАГНИТНОГО НОСИТЕЛЯ,
С*   УКАЗАННОГО В ТЕКСТОВОЙ СТРОКЕ STR
С*   В ОДНОМ ИЗ СЛЕДУЮЩИХ ФОРМАТОВ :
С*
С*  (1)  ПО НОМЕРУ УСТРОЙСТВА :
С*     D(ISK=)31  - МАГНИТНЫЙ ДИСК
С*     Т(АРЕ=)62  - МАГНИТНАЯ ЛЕНТА
С*     Н(ТАРЕ=)63 - МЛ НА ВЫСОКОЙ ПЛОТН.
С*     Е(ТАРЕ=)51 - ЛЕНТА В РЕЖИМЕ ЕС
С*     DRUM=21    - МАГНИТНЫЙ БАРАБАН
С*  (2)  ПО НОМЕРУ БОБИНЫ/ПАКЕТА :
С*     D(ISK=)28   Т(АРЕ=)362  Н(ТАРЕ=)9
С*     Е(ТАРЕ=)510
С*  (3)  ПО ПОЛНОМУ ИМЕНИ ЛЕНТЫ/ДИСКА :
С*     D(ISK=)28/OWN
С*     Т(АРЕ=)362/WORKIN
С*     Н(ТАРЕ=)9/N
С*     Е(ТАРЕ=)510/NО СНЕСК
С*  (4)  ПО ИМЕНИ ФАЙЛА НА ДИСКЕ :
С*     D(ISK=)28/OWN,WORKIN,FТЕХТ
С*  (5)  ПО ИМЕНИ ФАЙЛОВОЙ СИСТЕМЫ :
С*     D(ISK=)D,SITNIK,Х
С*      (ЗДЕСЬ D - ИМЯ СИСТЕМЫ)
С*  (6)  ПО МАТ.НОМЕРУ, УЖЕ ЗАКАЗАННОМУ:
С*     L(UN=)67
С*  (7)  ЗАКАЗ  SCRATCH-ФАЙЛА
С*      S(CRATCH) - ПО УМОЛЧАНИЮ 40 ЗОН
С*      S,W41(200) - НОМЕР=41, 200 ЗОН
С*      S(300) - НОМЕР ВЫБИРАТЬ АВТОМАТ.
С*  (8)  ЗАКАЗ 'ФИКТИВНОГО ТОМА'
С*     Р(IТ)
С*
С*   ПРИ ЗАДАНИИ ЛЕНТЫ ИЛИ ФАЙЛА НА ДИСКЕ
С*   МОЖНО УКАЗЫВАТЬ РЕЖИМ ЧТЕНИЯ/ЗАПИСИ,
С*   А ТАКЖЕ МАТ.НОМЕР, КОТОРЫЙ СЛЕДУЕТ
С*   ПРИСВОИТЬ ЛЕНТЕ/ФАЙЛУ :
С*    DISK=28/OWN,WORKIN,ТЕХТ,R
С*    Т362,W67  - БОБ.362 (ЗАП.) ПОД N 67
С*
С*   ПРИ ОТСУТСТВИИ МАТ.НОМЕРА ОН БЕРЕТСЯ
С*   ИЗ 2-ГО СЛОВА МАССИВА FDB, А ЕСЛИ
С*   ТАМ НОЛЬ, ТО ВЫБИРАЕТСЯ АВТОМАТИЧЕСКИ
С*   ПРИ ОТСУТСТВИИ РЕЖИМА ЧТ/ЗАП
С*   ОН БЕРЕТСЯ ИЗ 7-ГО СЛОВА  FDB.
С*
С*   В КОНЦЕ ОПИСАНИЯ ТОМА МОЖНО
С*   УКАЗЫВАТЬ ЕГО ОБЬЕМ В ЗОНАХ :
С*    ТАРЕ=9/MONSYS(1000)
С*    D1/SYST,JLOB,LIBR,W41(200)
С*   ПРИ НЕУКАЗАНИИ ОБЬЕМА ДЛЯ ФАЙЛОВ
С*   ОН ОПРЕДЕЛЯЕТСЯ АВТОМАТИЧЕСКИ, ДЛЯ
С*   ЛЕНТ - ПОЛАГАЕТСЯ = 1000 ЗОН.
С*
С*    F D В  - ХАРАКТЕРИСТИКА НОСИТЕЛЯ
С*   JFOCC ФОРМИРУЕТ 1-8 СЛОВА ЭТОГО МАССИВА
С*   1 - ТИП НОСИТЕЛЯ :
С*       0 - ЗАКАЗ НЕ ПРОШЕЛ ИЗ-ЗА ОШИБКИ
С*       1 - ЗАКАЗАН ПОД МАТ. НОМЕРОМ
С*       2 - ДИСКОВЫЙ ПАКЕТ
С*       3 - МАГНИТНЫЙ БАРАБАН
С*       4 - ЛЕНТА В РЕЖИМЕ ЕС
С*       5 - ФИКТИВНЫЙ ТОМ
С*   2 - МАТ.НОМЕР ЗАКАЗАННОГО НОСИТЕЛЯ
С*       ИЛИ ИМЯ ДИСКА ИЛИ НОМЕР МБ.
С*   3 - ЗАКАЗАННЫЙ ОБ'ЕМ НОСИТЕЛЯ В ЗОНАХ
С*   4:6 - ТЕКСТ ДИАГНОСТИКИ (,ISO,18Н...)
С*   7 - ТРЕБУЕМЫЙ РЕЖИМ ЧТ/ЗП (1HR ИЛИ 1HW)
С*   8 - 0,ЕСЛИ ДИСК, ИНАЧЕ 1
С*
С*   JFOCC ВОЗВРАЩАЕТ НА СУММАТОРЕ НОЛЬ,
С*   ЕСЛИ ЗАКАЗ ПРОШЕЛ УСПЕШНО, ИНАЧЕ
С*   НОМЕР ДИАГНОСТИКИ (1,2,...), ТЕКСТ
С*   КОТОРОЙ ПОПАЛ В FDB.
С*
С*
С*     FUNCTION JFEXCH ( FDB )
С*   ОБМЕН С УСТРОЙСТВОМ, ЗАХВАЧЕННЫМ
С*   ЧЕРЕЗ  JFOCC.  В 8-М СЛОВЕ  FDB
С*   НЕОБХОДИМО ЗАДАТЬ ИНФОРМ.СЛОВО :
С*    1-12 : НОМЕР ЗОНЫ
С*   31-35 : НОМЕР ЛИСТА
С*    40   : "1"-ЧТЕНИЕ,  "0"-ЗАПИСЬ
С*   ПРОЧИЕ РАЗРЯДЫ НЕСУЩЕСТВЕННЫ.
С*   JFEXCH ВОЗВРАЩАЕТ НА СУММАТОРЕ НОЛЬ,
С*   ЕСЛИ ОБМЕН ПРОШЕЛ НОРМАЛЬНО, ИНАЧЕ
С*   НОМЕР ДИАГНОСТИКИ, ТЕКСТ КОТОРОЙ
С*   ЗАПИСЫВАЕТСЯ В 4-6 СЛОВА  FDB.
С*
С*
С*     FUNCTION JFEX1 ( FDB,LIST,NZON,Т )
С*   МОДИФИКАЦИЯ JFEXCH С БОЛЕЕ ФОРТРАННЫМ
С*   ИНТЕРФЕЙСОМ.  ЗДЕСЬ :
С*   FDB - ХАРАКТЕРИСТИКА ТОМА КАК В JFOCC
С*   LIST - СТРАНИЧНЫЙ МАССИВ ДЛЯ ОБМЕНА
С*   NZON - НОМЕР ЗОНЫ
С*   Т - ТИП ОБМЕНА : 1HW - ЗАПИСЬ,
С*                    1HR - ЧТЕНИЕ.
С*   В ЭТОЙ МОДИФИКАЦИИ 8-Е СЛОВО FDB
С*   ОСТАЕТСЯ ПОСЛЕ JFOCC БЕЗ ИЗМЕНЕНИЙ,
С*   Т.Е. УКАЗЫВАЕТ НА ТИП УСТРОЙСТВА.
С*   В 6-Е СЛОВО FDB ПОСЛЕ ЧТЕНИЯ ПОПАДАЕТ
С*   1-Е (ДИСК) ИЛИ 4-Е (ЛЕНТА) СЛУЖ.СЛОВО
С*   РЕЗУЛЬТАТ JFEX1 ФОРМИРУЕТСЯ ТАК ЖЕ,
С*   КАК И JFEXCH.
С*
С*   ПОРТЯТСЯ  8-14 РЕГИСТРЫ
С*   РЕЖИМ АУ НЕ МЕНЯЕТСЯ.
С*
С******************************************
С*
С
С...   ССЫЛКИ НА ДИСПЕТЧЕР :
С
  АГУС   :,EQU,502В
  А/ИПД  :,EQU,760В
  Ш/СЛУЖ :,EQU,10В
  ADNAM  :,EQU,575В
  ATNAM  :,EQU,505В
  ATAPES:,EQU,504В
  CHEKMDFL:,EQU,512В
  REGSCAL:,EQU,100В
С...   ОПИСАНИЕ  F D В  :
  *0:,BLOCK,ТУР,NUM,VOL,ERR(3)
  ,CONT,REGIM
  ,CONT,IWEXCH
С...   П Р О Ч Е Е :
  А/I0:,LС,1
 LSPN:,EQU,6. СМ. SCSPEC
  SAVP:,EQU,46В
  RESP:,EQU,45В
С...   СИМВОЛЫ  I S О  :
  BLAN  :,EQU,40В
  LBR   :,EQU,50В
  СОММА :,EQU,54В
 SРЕС:,EQU,56В.
  SLASH :,EQU,57В
  TWOP  :,EQU,72В
  EQU   :,EQU,75В
С...   Д И А Г Н О С Т И К А
  *1:,BLOCK,СИНТОШ,НЕПОЛОЖ,ОШНОМЕР
  ,CONT,НЕТПАК,ЗАНПАК,НЕТМЛ
  ,CONT,УБЕРИЗАП
  ,CONT,НЕТЗП,НЕГОТМЛ,МЛЗАНЯТА
  ,CONT,ФАЗАН,НЕТМЕС,НЕТДОС
  ,CONT,НЕТФАЙЛА
  ,CONT,ЗАПРЗП,ПРЕВОБ,НЕБЫЗАК
  ,CONT,ИМЕНМЛ
  ,CONT,ПЛОХОБ
С
С------------------------------
С
  В:8,BASE,В
  ,STI,9.FDB
  ,ATI,12.STR
  10,VJM,TYPETASK
  10,VТМ,40
  ,ХТА,А/I0
  9,АТХ,ТУР
  9,АТХ,VOL
  9,АТХ,IWEXCH
  12,АЕХ,
  ,UZA,F1
  ,IТА,12
  F1:11,VТМ,-4
  14,VТМ,12
  13,VJM,74000В.*********
  ,АТХ,ID
  14,UТМ,-4
  14,VIM,Е1.ОШ.СИНТ.
  14,VТМ,70236В
  13,VJM,74000В.*********
  ,ATI,14
  14,UТМ,-EQU."="
  14,VIM,FS
  10,VТМ,
С.....  "ДЛИННЫЙ" ФОРМАТ
  FL:,ХТА,ID
  10,ASN,64
  ,АЕХ,=6Н
  ,ААХ,=377
  ,U1А,FL1
  10,UТМ,8
  11,VLM,FL
  FL1:,ХТА,
  14,VТМ,12
  13,VJM,74000В.********
  14,UТМ,-2
  14,VZM,FL2
  14,UТМ,2-4
  14,VIM,Е1.ОШ.СИНТ.
   15,АТХ,
  ,ААХ,=377
  ,ATI,14
  ,ХТА,TTF
  ,SТХ,ID
  14,UТМ,-40В
  14,VZM,FS1
  ,UJ,F2
   FL2:13,MTJ,11
  ,CALL,OCTTDEC
  11,MTJ,13
  ,UJ,F2
С.....  "КОРОТКИЙ" ФОРМАТ
  FS:,ХТА,ID
  ,ASN,64-8
  ,АТХ,UNIT
  ,УТА,
  ,ATI,14
  14,UТМ,-123В."S"
  ,ХТА,UNIT
  14,VZM,CHFILE.SCRATCH
  FS1:,ASN,64+8
  ,АОХ,=6Н
  15,АТХ,
  ,АЕХ,=6Н
  ,ААХ,=377
  ,STI,14
  14,VIM,F2
  11,VLM,FS1
С...
  F2:,АТХ,UNIT
  14,VТМ,70236В
  13,VJM,74000В.********
  ,ATI,12
 11,VТМ,-6
С...
  F3:,ХТА,ID
 11,АЕХ,TTF+5
  10,ASN,64
  ,UZA,F4
  11,VLM,F3
  Е1:14,VТМ,СИНТОШ
  ,UJ,ERROR
  Е2:14,VТМ,НЕПОЛОЖ
  ,UJ,ERROR
  Е3:14,VТМ,ОШНОМЕР
  ,UJ,ERROR
  Е4:14,VТМ,НЕТПАК
  ,UJ,ERROR
  Е5:14,VТМ,ЗАНПАК
  ,UJ,ERROR
  Е6:14,VТМ,НЕТМЛ
  ,UJ,ERROR
  Е7:14,VТМ,НЕТЗП
  ,UJ,ERROR
  Е71:14,VТМ,УБЕРИЗАП
  ,UJ,ERROR
  Е8:14,VТМ,НЕГОТМЛ
  ,UJ,ERROR
  Е9:14,VТМ,МЛЗАНЯТА
  ,UJ,ERROR
  :14,VТМ,ИМЕНМЛ
  ,UJ,ERROR
  Е10:14,VТМ,ФАЗАН
  ,UJ,ERROR
  Е11:14,VТМ,НЕТМЕС
  ,UJ,ERROR
  Е12:14,VТМ,НЕТДОС
  ,UJ,ERROR
  Е13:14,VТМ,НЕТФАЙЛА
  ,UJ,ERROR
  ЕЕ1:14,VТМ,ЗАПРЗП
  ,UJ,ERROR
  ЕЕ2:14,VТМ,ПРЕВОБ
  ,UJ,ERROR
  ЕЕ3:14,VТМ,НЕБЫЗАК
  ,UJ,ERROR
  ERROR:14,MTJ,10
  14,J+М,14
  10,J+М,14
  14,UТМ,DIAGN-3
  14,ХТА,
  9,АТХ,ERR
  14,ХТА,1
  9,АТХ,ERR+1
  14,ХТА,2
  9,АТХ,ERR+2
  ,IТА,10
  ,АОХ,А/I0
  RЕТМАТ:,XTS,PHYS
  ,FUN,72100В+REGSCAL
  :,STI,
  ,WТС,SAVI13
  13,VТМ,
  13,UJ,
  SAVI13:,LOG,
С
С.....   ОПРЕД.ТИПА ЗАДАЧИ (СЛУЖ. ИЛИ МАТ.)
С
  TYPETASK:,BSS,
  ,XTS,
 ,АТХ,NSP
  ,IТА,13
  ,АТХ,SAVI13
  ,*63,АГУС
  ,ATI,14
  14,*63,
 15,АТХ,
  ,ASN,64+42
 ,STI,14
 ,ASN,64+15
 ,ААХ,=77
 ,АЕХ,=30
 ,АТХ,NOEDIT
  ,ХТА,В48
  14,ASN,64-1
  15,АТХ,
  ,*63,А/ИПД
  ,ATI,14
  14,*63,Ш/СЛУЖ
  15,ААХ,
  ,АТХ,SLUG
  ,ХТА,FULW
  ,*57,4040В
  ,XTS,FULW
  14,VТМ,4040В
  13,VJM,74007В. *********
  15,АОХ,
  ,ASN,64+16
  ,АТХ,OWN NUM
  ,FUN,70100В+REGSCAL
  ,АТХ,PHYS
  ,АОХ,=:4004.PHYS+СЛ.СЛ
  ,XTS,КЕУ
  ,*76,1
  15,ХТА,
  ,FUN,72100В+REGSCAL
  15,ХТА,
  10,UJ,
С---
  F4:12,UТМ,-SLASH
 11,UТМ,5
  ,ITS,11
  ,АОХ,А/I0
  9,SТХ,IWEXCH
  11,UJ,FSW
С..... ПО ТИПАМ НОСИТЕЛЕЙ :
  :11,VТМ,2.Н-ТАРЕ
  11,UJ,FSW.(IWEXCH=-1)
  FSW:12,VZM,FD/.ИМЯ ДИСКА
  ,UJ,FD.ПАКЕТ/МОДУЛЬ
  :,,
  :12,VZM,FТ/.ИМЯ ЛЕНТЫ
  ,UJ,FТ.БОБИНА/МФ
  :,ХТА,SLUG
   ,UТС,1-3.LUN
  :10,VТМ,3.МБ
 ,UJ,DRLUN
 :10,VТМ,5
 ,ХТА,А/I0
 9,АТХ,NUM
 ,ХТА,=I4032.7700В
 9,АТХ,VOL
 ,UJ,FVOL
 DRLUN:,BSS,
  12,VZM,Е1
  ,U1А,Е2
  ,ХТА,UNIT
  ,АРХ,=6Н'''''''''7''7'
  ,ASN,64+42
  ,АОХ,А/I0
  9,АТХ,NUM
  ,ATI,14
  ,ХТА,В48
  14,ASN,64-10В
   10,MTJ,14
  :14,UТМ,-3
  14,VIM,*+2
  ,XTS,=:7777 74
  ,SТХ,OWNNUM
 :,ААХ,OWN NUM
  ,UZA,Е3
С..... ПРОБА ЧИСЛА ЗОН :
  FVOL:,IТА,10
  ,АОХ,А/I0
  9,АТХ,ТУР
  14,VТМ,70236В
  13,VJM,74000В.********
  ,ATI,12
  12,UТМ,-LBR."("
  13,MTJ,11
  12,VIM,OKRET1
  ,ХТА,
  14,VТМ,12
  13,VJM,74000В.********
 12,VТМ,1
  14,UТМ,-1
  14,VZM,OCTV
  14,UТМ,-1
 14,VZM,INTV
 14,UТМ,-1
  14,VIM,OKRET1.ОШ.ДЛИНА
 ,NTR,7
 ,А+Х,А/I0
 ,NTR,6
 ,UТС,-1
 INTV:8,VТМ,1
 ,CALL,OCTTDEC
 8,MTJ,12
 8,VТМ,В
  ,АРХ,=6Н'7''7''7''7''7''7'
  ,ASN,64+30
  OCTV:15,АТХ,.БОЛЕЕ,ЧЕМ ЕСТЬ,
  ,АЕХ,=7777.ОБЬЕМ
  9,XTS,VOL.УКАЗЫВАТЬ
  ,ААХ,=7777
  :,U1А,*+1
  ,ХТА,=7777
  :15,ARX,
  ,ASN,64+12.НЕ ДАЕМ
  ,STI,14
  14,VZM,OKRET1
  ,АОХ,А/I0
  9,АТХ,VOL
  OKRET1:11,MTJ,13
 12,VZM,SPECIS
 14,VТМ,70236В
  13,VJM,74000В.********
 ,ATI,12
 12,UТМ,-SРЕС
 12,VZM,SPECIS
 9,WТС,IWEXCH
 11,VТМ,1
 11,VIM,NО SРЕС.НЕ ЕС
 SPECIS:,IТА,13
 ,XTS,SCSPEC
 ,UZA,ERRSP
 13,VТМ,NО SРЕС
 ,ANX,
 ,ATI,11
 ,УТА,
 11,ASN,64
 ,АТХ,SCSPEC
 9,ХТА,NUM
 11,АТХ,SPN-1
 ,IТА,11
 ,ASN,64-2
 ,ATI,11
 11,UТМ,SРР-4
 ,ХТА,
 14,VТМ,-3
 :11,АТХ,3
 14,VLM,*
 ,ХТА,=10 0000.ДЛЯ ЕС:
 11,АТХ,2.БУДЕТ REWIND
 12,VIM,RETSP
 ,ХТА,SLUG
 ,UZA,*71
 ,ХТА,NOEDIT
 ,UZA,RETSP
 15,UТС,1
 14,VТМ,
 ,IТА,14
 ,АОХ,=10 0000
 ,*50,205В
 ,UJ,RETSP*
 ERRSP:,BSS,
 13,VТМ,Е11
 ,UJ,RETSP
 *71:,*71,IW71
 RETSP*:14,VТМ,-1
 15,ХТА,1
 11,АТХ,
 15,ХТА,2
 11,АТХ,1
 L1:14,UТС,1
 11,ХТА,
 ,ASN,64+8
 15,АТХ,
 ,УТА,
 ,AUX,=6Н'''110''300''200''200''300'
 15,ARX,
 14,UТС,1
 11,АТХ,
 14,VLM,L1
 RETSP:,BSS,
 13,MTJ,14
 ,STI,
 ,ATI,13
 14,UJ,
 NО SРЕС:,BSS,
  ,IТА,10
  ,ASN,64+4
  ,UZA,NО SCR
С
С...   ЗАКАЗ  SCRATCH-ФАЙЛА
С
  10,VТМ,1
  ,ХТА,=I1
  9,АТХ,ТУР.LOGICAL
  9,ХТА,NUM
  ,ASN,64-36
  ,АОХ,=:0000 004
  9,WТС,VOL
  14,VТМ,37В
  ,ITS,14
  ,ASN,64+5.ЭКСТЕНТЫ
  :,U1А,*+2
  ,ХТА,=I32
  9,АТХ,VOL
  ,ХТА,=1
  :15,АОХ,
  ,АТХ,MONO
  ,ХТА,
  ,АТХ,MONO+1
  ,ХТА,INFSC
  14,VJM,*57D
  ,ATI,14
  14,U1А,Е10-1
  ,ХТА,=6HW
  9,АТХ,REGIM
  NО SCR:10,UТМ,-1
  10,VIM,OKRET
  9,WТС,IWEXCH
 14,VТМ,-5
 14,VZM,RETG
 14,UТМ,5+1.-1
  14,VIM,SETSTA
  ,ХТА,=I4
  9,АТХ,ТУР
 RETG:,BSS,
  ,ХТА,А/I0
  ,UJ,RЕТМАТ
С
С...   УСТАНОВКА СТАТУСА 2
С      ДЛЯ УСТРОЙСТВ ТИПА 1
С
 SETSTA:,BSS,
  9,ХТА,NUM
  ,ASN,64-36
  ,АОХ,=2
  ,АТХ,MONO
  ,ХТА,INFST
  14,VТМ,OKRET
С
С....  ВЫДАЧА ЭКСТРАКОДА ,*57,-1
С      С СОХРАНЕНИЕМ 135-137 СЛОВ ИПЗ
С
  *57D:,ITS,14
  ,ITS,13
  15,АТХ,
  13,VТМ,-2
  :13,FUN,70100В+137В
  :15,АТХ,
  13,VLM,*-1
  15,ХТА,-6
  14,VТМ,-1
  13,VJM,74007В.*********
  15,SТХ,-6
  13,VТМ,3
  :13,UТМ,-1
  13,FUN,72100В+135В
  15,ХТА,
  13,VIM,*-1
  ,STI,13
  ,STI,14
  14,UJ,
С
С....  ПОСЛЕДНЯЯ ПРОБА: ДИСК ИЛИ ЛЕНТА
С
  OKRET:9,ХТА,IWEXCH
  ,ATI,14
  14,VZM,RЕТМАТ.ДИСК
  ,*63,АГУС
  ,ATI,14
  14,*63,
  ,ААХ,=:77
  9,XTS,NUM
  ,ASN,64-36
  15,АОХ,
  ,АТХ,ID
  ,*63,ATAPES
  ,ATI,12
  10,VТМ,-31
  STID:10,UТС,31
  12,*63,
  ,АЕХ,ID
  ,ASN,64+36
  ,ATI,14
  ,ХТА,А/I0
  14,VZM,SТ/VOL.ЛЕНТА
  10,VLM,STID
  9,АТХ,IWEXCH.ДИСК
  ,UJ,RЕТМАТ
  SТ/VOL:9,WТС,VOL
  14,VТМ,
  14,VIM,RЕТМАТ.-ЗАДАНО
  ,XTS,=I4000.
  9,SТХ,VOL.-СТАНДАРТ
  ,UJ,RЕТМАТ
С
С....  ЗАДАН НОМЕР ТОМА ИЛИ УСТР-ВО :
С
  FD:12,UТМ,SLASH-СОММА
  ,ХТА,UNIT
  ,ASN,64-12
  ,АТХ,NАМЕ
  12,VZM,CHFILE
  ,UТС,ADNAM-ATNAM
  FТ:,*63,ATNAM
  ,ATI,14
  12,VТМ,36.БЕЗ ИМЕНИ
  ,ХТА,SLUG
  ,UZA,Е2
  ,ХТА,UNIT
  ,ААХ,=6Н'337''337''337''337''310''310'
  ,U1А,FNV.-ТОМ
  ,ХТА,UNIT
  ,АРХ,=6Н'''''''''7''7'
  ,ASN,64+42
  ,ATI,10
  10,J+М,14
  ,ХТА,В48
  10,ASN,64-30В
  ,UZA,FNV
  ,ASN,64-16
  :11,VZM,*+1
  ,ASN,64-16
  :,U1А,FNV
  14,*63,-30В
  ,АТХ,NАМЕ
  ,UZA,FNV
  ,АЕХ,STNAME
  ,UZA,GIVNCTAP
  11,VIM,GIVTAP
С.....  ЗАКАЗ ПАКЕТА В МОНОПОЛИЮ
  GIVDISM:9,ХТА,REGIM
  ,АЕХ,=6HW
  :,U1А,*+1
  ,UТС,В48
  GIVDIS:,ХТА,
  ,АТХ,MONO
  ,ХТА,INFD
  14,VJM,*57D
  ,ASN,64+45
  ,ATI,14
  14,U1А,Е4-1.ОТС./ЗАН.
  10,VZM,CHRW
  ,ХТА,NАМЕ
  9,АТХ,NUM.ИМЯ ДП
  11,VТМ,.3-Е НАПР.
  ,*63,ADNAM
  ,ATI,10
  12,VТМ,-7
  :10,UТС,
  12,*63,7
  :,АЕХ,NАМЕ
  ,UZA,*+2
  :12,VLM,*-2
  11,VТМ,1.4-Е НАПР.
  :10,VТМ,2
  ,*63,551В
  ,ATI,14.SCDICH
  12,VТМ,7620В.29 МБ
  14,UТС,
  11,*63,3
  :,U1А,*+1
  12,VТМ,1744В.7 МБ
  :,IТА,12
  ,АОХ,А/I0
  9,АТХ,VOL
  ,UJ,FVOL.ЗА ДЛИНОЙ
С
С.....   ПОЛНОЕ ИМЯ :
С
  FТ/:,BSS,
  FD/:,ХТА,
  14,VТМ,12
  13,VJM,74000В.********
  14,UТМ,-4
  14,VIM,Е1
  ,АТХ,NАМЕ
  13,MTJ,10
  ,АЕХ,=6HNO
  ,U1А,ТО ТЕХ
  11,VZM,ТО ТЕХ.ДИСК
  14,VТМ,70236В
  13,VJM,74000В.********
  ,ATI,14
  14,UТМ,-40В
  14,VIM,ТО ТЕХ
  ,ХТА,
  14,VТМ,12
  13,VJM,74000В.**********
  14,UТМ,-4
  14,VIM,Е1
  ,АЕХ,=6НСНЕСК
  ,U1А,Е1
  ,ХТА,=6HNO СНЕ
  ,АТХ,NАМЕ
  ТО ТЕХ:,ХТА,INFK
  ,CALL,ISOTEX
  10,MTJ,13
  ,АТХ,NАМЕ
С.....  ТОЛЬКО НОМЕР БОБ/ПАК
  FNV:,ХТА,UNIT
  ,АРХ,=6Н'''''17''17''17''17'
  ,ASN,64+32
С ,FUN,203В
  14,VТМ,203В
  13,VJM,74000В.**********
  ,АЕХ,NАМЕ
  ,ААХ,=7777
  ,АЕХ,NАМЕ
  ,АТХ,UNIT
  ,АТХ,NАМЕ
  ,ХТА,FULW
  12,ASN,64
  ,АТХ,ID
  11,VZM,CHFILE
  ,*63,ATNAM
  ,ATI,12
  10,VТМ,-47
  БОБ:12,UТМ,1
  12,*63,-17
  ,АТХ,NАМЕ
  ,АЕХ,UNIT
  ,ААХ,ID
  ,UZA,CHFILE
  10,VLM,БОБ
  ,UJ,Е6.НЕТ МЛ
С......
  CHFILE:10,VТМ,1
  14,VТМ,70236В
  13,VJM,74000В.********
  ,ATI,12
  12,UТМ,-СОММА
  12,VZM,CONDEF
  11,VZM,GIVDISM
  ,UJ,GIVTAP
  CONDEF:11,VIM,CHRW
  10,VТМ,-1
  GMF:,ХТА,
  14,VТМ,12
  13,VJM,74000В.********
  14,UТМ,-4
  14,VIM,Е1
  10,АТХ,FILE
  10,VLM,GMF
  14,VТМ,70236В
  13,VJM,74000В.*********
  ,ATI,12
  12,UТМ,-СОММА
  ,UJ,GIVDIS
С.....
С... ПРОСТО МАТ.НОМЕР БЕЗ R/W
  CHINTN:14,UТМ,4-2
  14,VIM,Е1
  ,IТА,13
  ,ITS,11
  ,XTS,ID
  ,CALL,OCTTDEC
  ,АРХ,=6Н'7''7''7''7''7''7'
  ,ASN,64+30
  ,АОХ,А/I0
  9,SТХ,NUM
  ,STI,11
  ,ATI,13
  12,VТМ,
  ,UJ,NО REG
  CHRW:10,VТМ,1
 12,VIM,NО REG
  ,ХТА,
  14,VТМ,12
  13,VJM,74000В.*******
  ,АТХ,ID
  14,UТМ,-4
  14,VIM,CHINTN
  ,АРХ,=6Н'''7''7'''''''
  ,ASN,64+42
  ,UZA,NО LUN
  ,АОХ,А/I0
  9,АТХ,NUM
  NО LUN:,ХТА,ID
  ,ААХ,=:776
  ,АОХ,=6Н''
  9,АТХ,REGIM
  NО REG:11,VIM,GIVTAP
  14,VJM,MAKLUN
  9,ХТА,REGIM.ПРИ ЗАДАНИИ
  ,АЕХ,=6НС
  ,U1А,SINGULAR."С" ВМЕСТО "W"
  ,ХТА,=6HW
  9,АТХ,REGIM.В КАЧЕСТВЕ
  ,ХТА,=:0000 004.РЕЖИМА ЧТ/ЗП
  ,АТХ,R/W. - ПРОВЕРКА НА
  14,VТМ,74100В+REGSCAL.ЗАНЯТОСТЬ ФАЙЛА
  13,VJM,74000В.********
  SINGULAR:,BSS,.НЕ ДЕЛАЕТСЯ !
  ,ХТА,NАМЕ
  ,ASN,64-36
  :,U1А,*+1
  9,ХТА,NUM
  :,ASN,64-36
  ,АОХ,R/W
  ,АТХ,R/W
С.....  ЗА КООРДИНАТАМИ ФАЙЛА :
  ,ХТА,SLUG
  ,U1А,KOOR
  10,VТМ,
  ,DRUM,SAVP
  KOOR:,ХТА,INFK
  14,VJM,*57D
  :10,VIM,*+1
  ,DRUM,RESP
  :,ХТА,R/W
  ,ASN,64+45
  ,U1А,DIAFIL
  ,АТХ,FILE
  ,ХТА,R/W
  ,АЕХ,=7777.-1-R
  15,АТХ,
  ,ASN,64+12
  15,ARX,.L-1-R
  ,АЕХ,=7777.R-L
  ,ARX,=1
  ,ААХ,=7777
  ,АОХ,А/I0
  9,АТХ,VOL
  ,ХТА,R/W
  ,ААХ,=77 7777 7777
  9,XTS,NUM
  ,ASN,64-36
  15,АОХ,
  ,АТХ,MASTER
  ,ХТА,INFF
  14,VJM,*57D
  ,ХТА,MASTER
  ,ASN,64+42
  ,UZA,ISTAKED.ХОР.
  ,ATI,14
  14,UТМ,-1
  14,VZM,Е4
  14,UТМ,1-2
  14,VZM,Е3
  14,UТМ,2-4
  14,VZM,Е10
  ,UJ,Е11
  DIAFIL:,ATI,14
  14,UТМ,-1
  14,VZM,Е12
  14,UТМ,1-2
  14,VZM,Е13
 ,UJ,Е3
С.....   ПОЛУЧЕНИЕ МАТ.НОМЕРА :
  MAKLUN:9,ХТА,NUM
  ,UZA,AUTONUM
  ,АЕХ,А/I0
  ,U1А,REDYNUM
  AUTONUM:,BSS,
  ,ХТА,OWNNUM
  ,АЕХ,FULW
  ,ASN,64-16
  ,UZA,Е11
  ,ANX,=I23
  9,АТХ,NUM
  REDYNUM:,ASN,64+4
  ,ASN,64-10
  ,U1А,LUN
  9,ХТА,NUM
  ,АОХ,=40
  9,АТХ,NUM
  LUN:,ХТА,В48
  9,WТС,NUM
  ,ASN,64-30В
  ,UZA,Е3
  ,ASN,64+16
  ,UZA,Е3
  ,ААХ,OWN NUM
  ,U1А,Е3
  ,АТХ,R/W
 9,ХТА,REGIM
  ,АЕХ,=6HR
  14,UZA,
  9,ХТА,REGIM
  ,АЕХ,=6HW
  14,U1А,
  ,ХТА,=:0000 004
  ,АТХ,R/W
  14,UJ,
С.....   ЗАКАЗ ЛЕНТЫ :
  GIVNCTAP:,IТА,10
  ,ASN,64-3
  ,АОХ,=7777 7777 7777 7000
  ,АТХ,NАМЕ
  GIVTAP:13,MTJ,10
  14,VJM,MAKLUN
  11,MTJ,14
  14,UТМ,4
  14,VZM,FVOL.SCRATCH
  9,WТС,NUM
  13,VТМ,
  14,UТМ,-6
  14,VIM,LOWDENS
  13,UТМ,40000В.HD
  9,WТС,IWEXCH
  14,VТМ,1
  14,VIM,LOWDENS
С...   ЛЕНТА В РЕЖИМЕ ЕС ДОЛЖНА
С      ИМЕТЬ "ИМЯ" = NО СНЕСК
  ,ХТА,NАМЕ
  ,АЕХ,=5657 0043 5045 0000
  ,ASN,64+12
  ,U1А,Е9+1
  LOWDENS:9,ХТА,REGIM
  ,АЕХ,=6HR
  12,VТМ,200В
  ,UZA,*57
  9,ХТА,REGIM
  ,АЕХ,=6HW
  12,VТМ,100В
  ,UZA,*57
  12,VТМ,
С *57:,ХТА,NАМЕ
С 12,*57,2400В
  *57:13,ХТА,
  ,ITS,10
  ,XTS,/JМР/
  13,СТХ,
  12,MTJ,14
  14,UТМ,2400В
  ,ХТА,NАМЕ
  10,VJM,74007В. ***********
  /JМР/:,SТХ,SPN
  10,UJ,1
 :,STI,10
  13,СТХ,
  ,ХТА,SPN
С>>>>>>>>>>>>>
  10,MTJ,13
  ,АЕХ,
  ,UZA,Е6
  12,VZM,NORW
  12,UТМ,-100В
  ,ARX,
  12,VZM,CHWRIT
  ,U1А,Е71
  NORW:,BSS,
  ,АОХ,В48
  CHWRIT:,BSS,
  ,UZA,Е7
  12,VТМ,-2
  :,ASN,64-1
  ,ARX,
  12,UZA,Е8+2
  12,VLM,*-1
  ,ARX,=100
  ,ААХ,=400
  :,UZA,*+1.МОДЕЛЬ
 14,VТМ,7677В.ЛЕНТА
  :14,UТМ,1
  ,IТА,14
  ,АОХ,А/I0
  9,АТХ,VOL
  ISTAKED:,BSS,
  10,VТМ,1
  ,UJ,FVOL
С
С......   ВХОД ДЛЯ ОБМЕНОВ :
С
  JFEX1:,ENTRY,
  ,UТС,150В+1
  JF ЕХСН :,ENTRY,
  :11,VТМ,
  8,BASE,В
  10,VJM,TYPETASK
 :11,VZM,*+2
  ,STI,14
  ,STI,12
  ,STI,10
 :,ATI,9
  9,ХТА,IWEXCH
  ,ААХ,=0010 3700 0000 7777
  11,VZM,READYIW
  :,UZA,*+1.ДИСК
  11,UТМ,4-1.ЛЕНТА
  :,IТА,10
  ,ASN,64-20
  12,XTS,
  ,ААХ,=7777
  15,АОХ,
  14,XTS,
  ,АЕХ,=6HW
  ,ASN,64+40
  :,UZA,*+1
  ,ХТА,=:001
  :15,АОХ,
  READYIW:,АТХ,UNIT
  ,ААХ,=:001
  ,U1А,R*UN
  9,ХТА,REGIM
  ,АЕХ,=6HW
  ,U1А,ЕЕ1
  R*UN:9,ХТА,VOL
  ,ААХ,=7777
  ,UZA,NOCHEKV
  ,ARX,=4
  ,XTS,UNIT
  ,ARX,=4
  ,ААХ,=7777
  ,NTR,3
  15,А-Х,
  ,UZA,ЕЕ2
  NOCHEKV:,NTR,6
  ,*63,ADNAM
  ,АТХ,ID
 ,IТА,11
 ,АТХ,IFF
 10,VJM,GIVSP
  14,VТМ,НЕБЫЗАК
  9,WТС,ТУР
  ,UJ,ESW
С...
  S/DIS:,WТС,ID
  10,*63,15
  9,АЕХ,NUM
  ,UZA,ISDIS
  10,VLM,S/DIS
  ,UJ,Е4
  ISDIS:10,UТМ,15+30В
  14,VТМ,=:0404 0022
  ,ХТА,UNIT
  ,ASN,64+36
  :,U1А,*+1
 14,VJM,IFSPEC
  14,VТМ,=:0404 0020
  :,IТА,10
  ,ASN,64-12
  14,АОХ,
  ,ARX,UNIT
  ,АТХ,UNIT
  12,VТМ,10
С...   ЦИКЛ ПОПЫТОК ЧТЕНИЯ :
  LЕХ:,BSS,
   10,VТМ,
  ,*70,UNIT
  ,АЕХ,
  ,U1А,ОКЕХ
  12,UТМ,-1
  12,VIM,LЕХ
 BADEX:,BSS,
 ,ХТА,=6Н
 BADMV*:,АТХ,ТВЕХ+2
 14,VJM,IFSPEC
 14,VТМ,ПЛОХОБ
  ,ХТА,UNIT
  ,ASN,64-30
  ,AUX,=6Н'7''7''7''7''7''7'
  ,АОХ,=6Н000000
  ,АТХ,ТВЕХ+1
  ,ХТА,UNIT
  ,ААХ,=:001
  :,UZA,*+1
  ,ХТА,=6Н'''''''4''44'''.ОШ.ЧТ
 :,АЕХ,=6НОШ.ЗП
  ,АТХ,ТВЕХ
С......
   ESW:,UJ,ERROR
     :10,VТМ,.МАТ.ОБМЕН
  ,UJ,ЕХСН
  :10,VТМ,-15.ФИЗ.ДИСК
  ,UJ,S/DIS
  :,UJ,Е/DRU
 :,UJ,Е/ЕС
 :,UJ,RETG
С...   ОБМЕН С МЛ В РЕЖИМЕ ЕС
 Е/ЕС:,BSS,
 ,ATI,11
 11,UТМ,SРР-4
 ,UZA,ЕЕ3
 ,ХТА,PHYS
 ,АОХ,=:4
 ,*50,72100В+REGSCAL
 ,ХТА,UNIT
 ,ААХ,=7777
 ,UZA,CHPG
 ,ХТА,UNIT
 ,ARX,=1
 ,АТХ,UNIT
 CHPG:,ХТА,UNIT
 ,ASN,64+20
 ,ATI,14
 14,ХТА,.*****
 ,ХТА,UNIT
 ,ААХ,=:001
 ,U1А,IFMV*
 14,VJM,IFSPEC
 IFMV*:12,VТМ,-7.СЧ. ОШИБОК
 IFMV:,ХТА,UNIT
 ,ААХ,=7777
 ,NTR,7
 11,А-Х,2.ТЕК. NREC
 ,U1А,НАЗАД
 10,VТМ,1.ВПЕРЕД
 MOVE:,АЕХ,
 ,UZA,EXCHES
 11,АТХ,2.
 MOV*:9,ХТА,NUM
 ,ASN,64-12
 10,АОХ,IWES
 ,*57,7777В
 ,АЕХ,=200
 ,ААХ,=10 0234
 ,U1А,BADMOV
 11,ХТА,2
 10,VZM,MIN
 ,А-Х,=1
 ,UJ,MOVE
 MIN:,А+Х,=1
 ,UJ,MOVE
 НАЗАД:,BSS,
С  ПРОВЕРКА - А НЕ ЛУЧШЕ-ЛИ ПРЕДВАРИТЕЛЬНО
С  СМОТАТЬ ЛЕНТУ НА НАЧАЛО
 10,VТМ,
 11,АТХ,2.К-ВО ШЗН (-)
  ,А+Х,=1
  ,UZA,MOV*.1 ЗОНА ==> ШЗН
 ,ХТА,UNIT
 ,ААХ,=7777
 15,АТХ,
 ,ASN,64+2
 15,ARX,
 11,А+Х,2
 ,UZA,MOV*.ЧЕРЕЗ ШЗН
С  ВЫГОДНЕЕ СМОТАТЬ, А ПОТОМ ВПЕРЕД.
 REWIND:9,ХТА,NUM
 ,ASN,64-12
 ,АОХ,=:4007
 15,АТХ,
 ,*57,7777В
 15,ХТА,
 ,*57,7777В
 ,ХТА,
 11,АТХ,2
 ,UJ,IFMV
 EXCHES:,NTR,6
 ,ХТА,UNIT
  ,ASN,64+12
  9,АОХ,NUM
  ,ASN,64-12
  15,АТХ,
  ,ААХ,=:001
  ,U1А,R/ЕС
 12,V1М,W/ЕС
 ,ХТА,=:4012 0000 4.СТИР
 15,АЕХ,-1
 ,*57,7777В
 W/ЕС:,BSS,
 ,ХТА,=4002 0000 4100 0000
  RW/ЕС:15,АЕХ,
  ,*57,7777В
 ,АЕХ,=200.ГТ
 ,ААХ,=17 0237
 ,XTS,UNIT
 ,ААХ,=7777
 ,ARX,=1
 11,SТХ,2
 ,UZA,RETGOOD
 ,ААХ,=10 0200
 ,UZA,BADEXCH
 ,ААХ,=200
 ,U1А,НЕТ ГТ
 ,ХТА,=6Н К Д В
 ,UJ,BADM
 BADEXCH:12,VLM,IFMV
 ,UJ,BADEX
 BADMOV:,ААХ,=200
 ,U1А,НЕТ ГТ
 ,ХТА,=6НПОДВ.''
 BADM:,XTS,=10 0000.БУДЕТ
 11,SТХ,2.REWIND
 ,UJ,BADMV*
 НЕТ ГТ:,BSS,
 9,ХТА,NUM
 ,ASN,64-12
 ,*57,7777В
 ,ААХ,=200
 ,U1А,REWIND
 ,*57,3
 ,UJ,НЕТ ГТ
 R/ЕС:,ХТА,=4011 0000 4100 0000
  ,UJ,RW/ЕС
С---
  Е/DRU:,BSS,
  :,ХТА,UNIT
  ,АОХ,=:0004.ФИЗ.МБ
  ,АТХ,UNIT
  ,ААХ,=7777
  ,ASN,64-7
   ,ARX,UNIT
  ,АТХ,UNIT.ПЕРЕАДРЕСАЦИЯ
  ,ААХ,=:001
  :,U1А,*+1
  ,ХТА,SLUG
  :,UZA,ЕЕ1
  ,*63,CHEKMDFL
  ,ATI,10
  ,ХТА,=:0004
  10,*52,
 ЕХСН:9,ХТА,NUM
  ,ASN,64-12
  ,ARX,UNIT
  ,АТХ,UNIT
 ,ААХ,=:001
 ,U1А,ЕХСН*
 14,VJM,IFSPEC
 ЕХСН*:,BSS,
  ,*70,UNIT
   ОКЕХ: ,ХТА,UNIT
  ,ASN,64+20
  ,ATI,12
  12,ХТА,.ЖДЕМ К/О
   ,ХТА,
  :10,VZM,*+1
  10,*52,.CHEKMDFL
 :,ХТА,IFF
 ,ATI,11
 11,VZM,СНЕКР
  11,FUN,70100В
  9,АТХ,ERR+2
  ,АЕХ,= 7163 4760 3471 6347
  ,U1А,СНЕКР
  9,АТХ,ERR+2
   СНЕКР:,IТА,12
  ,FUN,200В
  ,АЕХ,=2
  ,UZA,BADEX
 RETGOOD:,BSS,
 14,VJM,IFSPEC
  ,ХТА,А/I0
  ,UJ,RЕТМАТ
 GIVSP:,BSS,.П/П
 12,VТМ,1-LSPN
 9,ХТА,NUM
 9,АТХ,NUM
 LCSP:12,ХТА,SPN+LSPN-1
 9,АЕХ,NUM
 ,UZA,OUR
 12,VLM,LCSP
 10,UJ,
 OUR:12,UТМ,LSPN
 ,IТА,12
 ,ASN,64-2
 ,АТХ,NSP
 10,UJ,
 IFSPEC:,BSS,
 ,ХТА,NSP
 14,UZA,
 ,ATI,11
 11,UТМ,SРР-4
 11,ХТА,
 14,UZA,
 ,IТА,14
 ,ITS,1
 ,ITS,2
 ,ITS,3
 ,ITS,13
 ,ITS,
 ,ХТА,UNIT
 ,ASN,64+30
 ,ASN,64-10
 ,ATI,3
 1,VТМ,-1
 L1Р:,BSS,
 2,VТМ,-1023
 ,ХТА,UNIT
 ,ААХ,=7777
 1,UТС,1
 11,ARX,
 15,АТХ,3
 15,UТС,3
 13,VТМ,
 ,ITS,13
 ,CALL,BRAND
 3,MTJ,12
 L2Р:,BSS,
 ,IТА,12
 ,CALL,MIXER
 12,АТХ,
 12,UТМ,1
 2,VLM,L2Р
 ,WТС,NSP
 11,VТМ,SРР-4
 1,VLM,L1Р
 ,STI,
 ,STI,13
 ,STI,3
 ,STI,2
 ,ATI,1
 15,WТС,
 ,UJ,
С
С===========  РАЗНЫЕ ТЕКСТЫ  ===========
С
  :,ISO,6НЕТАРЕ
  TTF   :,ISO,30HDISK  ТАРЕ  НТАРЕ LUN   DRUM
 ,CONT,6HPIT
  DIAGN :,ISO,18НСИНТАКСИЧ.ОШИБКА ''
        :,ISO,18НЭТО ВАМ ЗАПРЕЩЕНО''
        :,ISO,18НОШ.НОМЕР УСТР-ВА ''
        :,ISO,18ННЕТ ПАКЕТА       ''
        :,ISO,18НЗАНЯТ ПАКЕТ      ''
        :,ISO,18ННЕТ ЛЕНТЫ        ''
  :,ISO,18НВЫКЛЮЧИ ЗАПИСЬ   ''
        :,ISO,18НВКЛЮЧИ ЗАПИСЬ    ''
        :,ISO,18ННЕГОТОВ МФ.      ''
        :,ISO,18НЗАНЯТА ЛЕНТА     ''
        :,ISO,18НФАЙЛ ЗАНЯТ       ''
        :,ISO,18ННЕТ МЕСТА В ФАТЕ ''
        :,ISO,18ННЕ ИМЕЕТЕ ПРАВА  ''
        :,ISO,18ННЕТ ТАКОГО ФАЙЛА ''
  :,ISO,18НЗАПИСЬ ЗАПРЕЩЕНА ''
  :,ISO,18НПРЕВЫШЕН ОБЬЕМ   ''
  :,ISO,18ННЕ БЫЛО ЗАКАЗА   ''
  :,ISO,18НИМЕНОВАННАЯ ЛЕНТА''
  ТВЕХ:,BSS,3
С
С==========  ДЛЯ ЗАКАЗА ДИСКОВ  =========
С
  INFD:13,Z07,7240В
  8,Z00,MONO
  INFK:13,Z07,7277В.37 ЛИСТ
  8,Z02,NАМЕ
  INFF:13,Z07,7240В
  8,Z03,NАМЕ
  INFSC:13,Z07,7240В
  8,Z04,MONO
  INFST:13,Z07,7240В
  8,Z37,MONO
  MONO  :,LOG,
  NАМЕ  :,LOG,
  MASTER:,LOG,
  FILE  :,LOG,
  R/W   :,LOG,
  :,ОСТ,4
  В48:,ОСТ,4
 IWES:,ОСТ,4004 0000 4.ВПЛ+ШЗН
 ,ОСТ,4003 0000 4.ВПЛ+ШЗВ
 IW71:15,060,1
 ,,
С
С==========  КОНСТАНТЫ  ==========
С
  FULW   : ,LOG, 7777 7777 7777 7777
  STNAME : ,LOG, 2245 1252 5122 4512
  КЕУ    :,LOG,3053 4576 1634 0112
С     ШКАЛА БУФЕРОВ ДОП. ИНФОРМАЦИИ
 SCSPEC:,ОСТ,77.6 (СМ. LSPN)
С
С=========  РАБ.ЯЧЕЙКИ  ==========
С
  ID      :,BSS,1
  UNIT    :,BSS,1
  SLUG    :,BSS,1
  OWNNUM  :,BSS,1
  PHYS:,BSS,1
 NOEDIT:,BSS,1
 IFF:,BSS,1
 NSP:,BSS,1
 SPN:,BSS,6. СМ. SCSPEC
 SРР:,BSS,24.6*4 (СМ. SPN)
  ,END,
  SCANER:,NАМЕ,
С*
С****** 08/07/81   А.П.САПОЖНИКОВ
С*
С*   ФОРТРАННЫЙ ИНТЕРФЕЙС ЭКСТРАКОДА
С*      ФОРМАТНЫХ ПРЕОБРАЗОВАНИЙ
С*
С*  SCANER(STRI,FRAG,IREG,IТУР,KOD,IPOZ)
С*  PUTH(STRI,ТЕХТ,INOR,N,М,IPOZ)
С*  PUTO(STRI,NUMB,INOR,N,М,IPOZ)
С*  PUTG(STRI,NUMB,INOR,N,М,IPOZ)
С*   ВСЕ ВХОДЫ ТИПА "SUBROUTINE".
С*
С*   SCANER - ВЫБОРКА СИНТАКСИЧЕСКОГО
С*     ФРАГМЕНТА ИЗ ТЕКСТОВОЙ СТРОКИ.
С*   STRI - АДРЕС НАЧАЛА СТРОКИ. ЕСЛИ
С*     STRI=0, ВЫБОРКА НАЧИНАЕТСЯ С ТОГО
С*     СИМВОЛА СТРОКИ, ГДЕ ОСТАНОВИЛИСЬ
С*     ПОСЛЕ ПРЕДЫДУЩЕГО ВХОДА.
С*   FRAG - МАССИВ, КУДА ПОПАДАЕТ ВЫБРАН-
С*     НЫЙ ФРАГМЕНТ
С*   IREG - РЕЖИМ РАБОТЫ SCANER-А :
С*     БИТ 1 : 0-ПРОБЕЛ ЕСТЬ РАЗДЕЛИТЕЛЬ
С*             1-ПРОБЕЛЫ ИГНОРИРУЮТСЯ
С*     БИТ 2 : 0-СТАНДАРТНЫЙ АЛФАВИТ
С*             1-АЛФАВИТ АВТОКОДА MADLEN
С*     БИТ 3 : 0-ВОСЬМЕРИЧНЫЕ ЧИСЛА ЗАДА-
С*               ЮТСЯ С СУФФИКСОМ "В".
С*             1-ВСЕ ЦЕЛЫЕ ЧИСЛА СЧИТАЮТ-
С*               СЯ ВОСЬМЕРИЧНЫМИ.
С*     БИТ 4 : 0-СКАНИРОВАНИЕ ФРАГМЕНТОВ.
С*             1-ПОСИМВОЛЬНОЕ СКАНИРОВАНИЕ
С*     ПРОЧИЕ БИТЫ НЕ СУЩЕСТВЕННЫ.
С*   IТУР - ТИП ПОЛУЧЕННОГО ФРАГМЕНТА :
С*     0 - ОШИБКА, ФРАГМЕНТ НЕ РАСПОЗНАН
С*     1 - ВОСЬМЕРИЧНОЕ ЧИСЛО
С*     2 - ЦЕЛОЕ
С*     3 - ВЕЩЕСТВЕННОЕ
С*     4 - ТЕКСТОВАЯ КОНСТАНТА
С*     5 - ПУСТОЙ ФРАГМЕНТ
С*   KOD - КОД РАЗДЕЛИТЕЛЯ (ЦЕЛОЕ)
С*
С*   ПРИ ПОСИМВОЛЬНОМ СКАНИРОВАНИИ ЗА ОДНО
С*   ОБРАЩЕНИЕ К SCANER-У ВЫБИРАЕТСЯ ОДИН
С*   ОЧЕРЕДНОЙ СИМВОЛ СТРОКИ. ОН ПОМЕЩАЕТСЯ
С*   ВО FRAG В ВИДЕ  1Н<СИМВОЛ> И В KOD В
С*   ВИДЕ ЦЕЛОГО ЧИСЛА.
С*   IТУР СОДЕРЖИТ ТИП ВЫБРАННОГО СИМВОЛА:
С*     0 - КОНЕЦ СТРОКИ
С*     1 - ЦИФРА
С*     2 - БУКВА
С*     3 - РАЗДЕЛИТЕЛЬ
С*
С*   PUTH, PUTO, PUTG - ОПЕРАЦИИ ТИПА
С*   "ENCODE" ПО СПЕЦИФИКАЦИЯМ "Н","О","G"
С*
С*   ЗДЕСЬ STRI - АДРЕС ВЫХОДНОГО ТЕКСТА
С*   ИЛИ 0, ЕСЛИ ОЧЕРЕДНОЙ ТЕКСТОВЫЙ ФРАГ-
С*   МЕНТ ЗАСЫЛАЕТСЯ ВСТЫК К ПРЕДЫДУЩЕМУ
С*
С*   N,М - ЦЕЛЫЕ.  N<32 , М<16
С*
С*   PUTH - ПЕРЕСЫЛКА В ВЫХОДНУЮ СТРОКУ
С*     N СИМВОЛОВ МАССИВА ТЕХТ.
С*     INOR И М - НЕСУЩЕСТВЕННЫ
С*   PUTO - ПРЕОБРАЗОВАНИЕ СЛОВА NUMB
С*     ПО ФОРМАТУ  О<N>  СО ВСТАВКОЙ
С*     ОДНОГО ПРОБЕЛА ПОСЛЕ КАЖДЫХ  М
С*     ВОСЬМЕРИЧНЫХ ЦИФР.
С*   PUTG - ПРЕОБРАЗОВАНИЕ СЛОВА NUMB
С*     ПО ФОРМАТУ  G<N>.<М>  ИЛИ  I<N>
С*     ЕСЛИ М=0
С*   INOR - РЕЖИМ ВЫРАВНИВАНИЯ ТЕКСТА
С*     ВНУТРИ СВОЕГО ПОЛЯ ИЗ N ПОЗИЦИЙ :
С*     0 - ПО ЛЕВОМУ КРАЮ, 1 - ПО ПРАВОМУ
С*
С*   В  IPOZ  ВО ВСЕХ СЛУЧАЯХ ПОМЕЩАЕТСЯ
С*   НОМЕР ТЕКУЩЕЙ ПОЗИЦИИ ПО ВХОДНОЙ
С*   (ВЫХОДНОЙ) СТРОКЕ: 1,2,3,...
С*
  А/I0:,LС,1
  ,UТС,-1
  PUTH:,ENTRY,
  ,UТС,-1
  PUTO:,ENTRY,
  ,UТС,-1
  PUTG:,ENTRY,
  9,VТМ,3
  8,BASE,*
  ,SТХ,IPOZ
  ,SТХ,М
  ,SТХ,N
  ,STI,11
  ,STI,10
  ,ATI,12
  ,IТА,13
  ,АТХ,RЕТ
  12,ХТА,
  ,АЕХ,А/I0
  :,U1А,*+1
  12,VТМ,
  :11,ХТА,
  ,ААХ,=17
  ,ASN,64-15
  9,VZM,MACRO
  ,ААХ,=10 0000
  ,ASN,64-4
  ,WТС,N
  ,XTS,
  ,ААХ,=37
  ,ASN,64-24
  ,WТС,М
  ,XTS,
  ,ААХ,=17
  15,АОХ,
  ,ASN,64-15
  15,АОХ,
  MACRO:,АОХ,IW50
С 9,FUN,12
  9,MTJ,14
  14,UТМ,12
  :14,FUN,
С   :13,VJM,74000В.********
  9,VIM,EXIT
  14,UJ,SW
  SW:,UJ,FIN.ОШИБКА
  :10,АТХ,.OCTAL
  ,UJ,FIN
  :10,АТХ,.INTEGER
  ,UJ,FIN
  :10,АТХ,.REAL
  ,UJ,FIN
  :,,.IDENT
  :,,.LONG
  ,UJ,ID
  :14,VТМ,5.ЕМРТУ
  ,UJ,FIN
  LONG:11,ХТА,
  ,ААХ,=17
  ,ASN,64-15
С ,FUN,12
  14,VТМ,12
  :14,FUN,
С     :13,VJM,74000В.*******
  14,VZM,FIN
  10,UТМ,2
  ID:10,АТХ,
  ,УТА,
  10,АТХ,1
  14,UТМ,-5
  14,VZM,LONG
С ,FUN,70100В+136В.ОГР.
  14,VТМ,70236В
  :14,FUN,
С   :13,VJM,74000В.*********
  15,АТХ,
С ,FUN,70100В+135В.ПОЗ.
  14,VТМ,70235В
  :14,FUN,
С    :13,VJM,74000В.*******
  ,ASN,64+24
  ,ASN,64-9
  15,АОХ,
  14,VТМ,4
  ,АЕХ,
  FIN:,УТА,
  15,АТХ,
  ,ITS,14
  ,АОХ,А/I0
  ,WТС,N
  ,SТХ,
  ,ААХ,=377
  ,АОХ,А/I0
  ,WТС,М
  ,SТХ,
  ,ASN,64+24
  ,ААХ,=377
  EXIT:,АОХ,А/I0
  ,WТС,IPOZ
  ,SТХ,
  ,WТС,RЕТ
  13,VТМ,
  13,UJ,
  RЕТ:,LOG,
  IW50:10,Z00,
  12,Z00,
  IPOZ:,BSS,1
  N   :,BSS,1
  М   :,BSS,1
  ,END,
*ТО PERSO:55004,12, ВЫЖИМКА ИЗ ДИСПЕТЧЕРА БЭСМ И ПРАВКИ В КТ
*CALL LDSHIFT
*EXECUTE
*END F
*NАМЕ TEST
*TIME:24.00
*EXPRESS
*DISC:705/SYSTEM,WORKIN
*FILE:EXTOLD,55,W
*PERSO:55004
*CALL ALLMEMOR
*CALL LDSHIFT
*EXECUTE
*END F
*NАМЕ МАКЕКТ
*TIME:24.00
*EXPRESS
*ТАРЕ:1/ROLLIB,67,W
*DISC:705/SYSTEM,WORKIN
*FILE:EXTOLD,55
*TAPES:67300
*PERSO:55004
*MAIN КТ
*EXECUTE
*END F
