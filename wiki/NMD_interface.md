# Работа с устройствами МД БЭСМ-6

Для работы с МД были выделены направления 3 и 4. 

Для выдачи команд, запускающих операции, были добавлены отсутствующие в ТО адреса команды 033: 0023 и 0024 (на запись).

Для чтения регистра состояния были добавлены адреса команды 033: 4003 и 4004 (на чтение).

## Формат кода управляющего слова (КУС) для команд 00 033 0003 и 00 033 0004

| 27-24 | 23-22 | 21 | 20 | 19 | 18 | 17-13 | 12 | 11 | 10-8 | 7-2 | 1 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| №куба | | счит. только сл. слов |  | признак страничного обмена | 1 - чтение<br>0 - запись | №листа | №половины листа |  | №устройства<sup>*)</sup> | 5 = ??? | №половины зоны(?)<sup>**)</sup> |

Разряды, отмеченные вопросительными знаками, используются ОС ДИСПАК, но их назначение непонятно.

\*) В эмуляторе не используется, номер устройства выбирается командой 00 033 0023 / 00 033 0024

\*\*) В эмуляторе не используется, т. к. половина зоны (также) выбирается командой 00 033 0023 / 00 033 0024

## Формат кодов команд 00 033 0023 и 00 033 0024

| Управляющий разряд | Операция | Значение прочих разрядов |
| --- | --- | --- |
| 12 | Задание адреса дорожки обмена | 7.25 Мб: рр. 11-1 (дорожка = ползоны)<br>29 Мб: рр. 11-1 - №дорожки без младшего разряда |
| 11 | Задание номера устройства | р. 9 - ???, рр. 8...1 - устройство 7...0 в позиционно-приоритетном коде |
| 9 | Возбуждение прерывания, установка №линейки | Если установлен р. 10, то №линейки задан в рр. 2-1; р. 13 - ??? |

Если ни один из рр. 12, 11, 9 не установлен, то рр. 6-1 воспринимаются как команда.

| Команда (8-ричная) | Назначение |
| --- | --- |
| 00 | Выдается в начале загрузки, игнорируется эмулятором |
| 01 | Сброс на 0-й цилиндр (игнорируется эмулятором) |
| 02 | Подвод (игнорируется эмулятором) |
| 03 | Чтение с МД |
| 43 | Чтение резервной дорожки |
| 04 | Запись на МД |
| 44 | Запись резервной дорожки |
| 05 | Разметка |
| 06 | Сравнение (не реализовано в эмуляторе) |
| 07 | Чтение заголовка |
| 47 | Чтение заголовка резервной дорожки |
| 10 | Гашение регистра состояния (РС) |
| 11 | Опрос рр. 12-1 РС выбранного устройства |
| 31 | Опрос рр. 24-13 РС выбранного устройства |
| 50 | Освобождение устройства |

## Регистр состояния

Команды 00 033 4003 и 00 033 4004 выдавали на сумматор половину РС, опрошенную командой 11 или 31.

На текущий момент эмулятор возвращает 0 для отключённых устройств, и фиксированное значение 1400 0400 (8)
для подключённых устройств.

### Формат РС

| 24-23 | 22 | 21 | 20-10 | 9 | 8-1 |
| --- | --- | --- | --- | --- | --- |
|     | ??? | ??? |     | устр-во готово | |


